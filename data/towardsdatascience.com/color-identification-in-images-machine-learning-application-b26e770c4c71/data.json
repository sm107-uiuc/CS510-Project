{"url": "https://towardsdatascience.com/color-identification-in-images-machine-learning-application-b26e770c4c71", "time": 1682994251.127263, "path": "towardsdatascience.com/color-identification-in-images-machine-learning-application-b26e770c4c71/", "webpage": {"metadata": {"title": "Color Identification in Images. Using colors from an Image as a method\u2026 | by Karan Bhanot | Towards Data Science", "h1": "Color Identification in Images", "description": "In this article, I discuss about the process of identifying colors from an image using KMeans algorithm and then using colors as search parameters for searching images."}, "outgoing_paragraph_urls": [{"url": "https://github.com/kb22/Color-Identification-using-Machine-Learning", "anchor_text": "this repository", "paragraph_index": 2}, {"url": "https://unsplash.com/", "anchor_text": "Unsplash", "paragraph_index": 2}], "all_paragraphs": ["I recently started reading about how I could work with Images in Python. When I came across OpenCV which allows import and manipulation of images in Python, I started to wonder if information could be extracted out of those images using Machine Learning and used in some way.", "We\u2019ve all seen that we can search online on the basis of certain filters one of which is color. I got inspired to actually write the code that can extract colors out of images and filter the images based on those colors.", "In this article, I explain how I understood the basics of OpenCV, extracted colors from images using KMeans algorithm and filtered images from a collection of images based on RGB values of colors. The complete notebook is available at this repository. The sample_image.jpg was clicked by me and the other 5 images in the folder images were taken from Unsplash.", "We import the basic libraries including matplotlib.pyplot and numpy. To extract the count, we will use Counter from the collections library. To use OpenCV, we will use cv2. KMeans algorithm is part of the sklearn's cluster subpackage. To compare colors we first convert them to lab using rgb2lab and then calculate similarity using deltaE_cie76. Finally, to combine paths while reading files from a directory, we import os.", "To read any image, we use the method cv2.imread() and specify the complete path of the image which gets imported into the notebook as a Numpy array. We can then plot it using the pyplot\u2019s method imshow().", "The shape of the array is (3456, 4608, 3). The first two values match the pixels of the image. Third value is set to 3 as each pixel is represented as a combination of three colors, Red, Blue and Green.", "The color of the image looks a bit off. This is because, by default, OpenCV reads image in the sequence Blue Green Red (BGR). Thus, to view the actual image we need to convert the rendering to Red Green Blue (RGB).", "The method cvtColor allows us to convert the image rendering to a different color space. To move from BGR color space to RGB, we use the method cv2.COLOR_BGR2RGB.", "In some situations, we might want to have black and white images. In such cases, we can express images as Gray. We now use the conversion space as cv2.COLOR_BGR2GRAY and show the output with the colormap as gray.", "We can also resize the image to a given dimension. We use the method resize provided by cv2. The first argument is the image we want to resize, and the second argument is the width and height defined within parentheses.", "Now let\u2019s move to identifying the colors from an image and displaying the top colors as a pie chart.", "We\u2019d first define a function that will convert RGB to hex so that we can use them as labels for our pie chart.", "On reading the color which is in RGB space, we return a string. {:02x} simply displays the hex value for the respective color.", "Next, we define a method that will help us get an image into Python in the RGB space.", "We supply the path of the image as the argument . First, we read the file using imread and then change its color space before returning it.", "We now define the complete code as a method that we can call to extract the top colors from the image and display them as a pie chart. I\u2019ve named the method as get_colors and it takes 3 arguments:", "Let\u2019s break down this method for better understanding.", "First, we resize the image to the size 600 x 400. It is not required to resize it to a smaller size but we do so to lessen the pixels which\u2019ll reduce the time needed to extract the colors from the image. KMeans expects the input to be of two dimensions, so we use Numpy\u2019s reshape function to reshape the image data.", "KMeans algorithm creates clusters based on the supplied count of clusters. In our case, it will form clusters of colors and these clusters will be our top colors. We then fit and predict on the same image to extract the prediction into the variable labels.", "We use Counter to get count of all labels. To find the colors, we use clf.cluster_centers_. The ordered_colors iterates over the keys present in count, and then divides each value by 255. We could have directly divided each value by 255 but that would have disrupted the order.", "Next, we get the hex and rgb colors. As we divided each color by 255 before, we now multiply it by 255 again while finding the colors. If show_chart is True, we plot a pie chart with each pie chart portion defined using count.values(), labels as hex_colors and colors as ordered_colors. We finally return the rgb_colors which we\u2019ll use at a later stage.", "Let\u2019s just call this method as get_colors(get_image(\u2018sample_image.jpg\u2019), 8, True) and our pie chart appears with top 8 colors of the image.", "This opens the doors for many superior applications such as searching for colors in a Search Engine, or looking for a piece of clothing that has a certain color in it.", "We\u2019ve just identified the majority 8 colors that exist in our image. Let\u2019s try and implement a search mechanism that can filter images based on the color supplied by us.", "We\u2019ll now dive into the code of filtering a set of five images based on the color we\u2019d like. For our use case, we\u2019ll supply the RGB values for the colors Green, Blue and Yellow and let our system filter the images.", "The images are in the folder images. We define COLORS as a dictionary of colors. Then, we read all images in that folder and save their values in the images array.", "We first show all the images in the folder using the below mentioned for loop.", "We split the area into subplots equal to the number of images. The method takes the arguments as number of rows = 1, number of columns = all images i.e. 5 in our case and the index.", "We now define a method match_image_by_color to filter all images that match the selected color.", "We first extract the image colors using our previously defined method get_colors in RGB format. We use the method rgb2lab to convert the selected color to a format we can compare. The for loop simply iterates over all the colors retrieved from the image.", "For each color, the loop changes it to lab, finds the delta (basically difference) between the selected color and the color in iteration and if the delta is less than the threshold, the image is selected as matching with the color. We need to calculate the delta and compare it to the threshold because for each color there are many shades and we cannot always exactly match the selected color with the colors in the image.", "By saying green, the user can mean light green, green or dark green. We need to scan through all possibilities.", "If we extract say 5 colors from an image, even if one color matches with the selected color, we select that image. The threshold basically defines how different can the colors of the image and selected color be.", "Let\u2019s consider the case where we are trying to find images with color Green. If the threshold is too high, we might start seeing blue images in our search. Similarly, on the other hand, if the threshold is too low, then green might not even match images that have dark green in them. It\u2019s all based on what is required in the situation at hand and we can modify the values accordingly. We need to carefully set the threshold value.", "We define a function show_selected_images that iterates over all images, calls the above function to filter them based on color and displays them on the screen using imshow.", "We will now simply call this method and let it plot the results.", "We call the method as follows. We will just replace the variable selected_color with COLORS['GREEN'] for Green, COLORS['BLUE'] for Blue, and COLORS['YELLOW'] for Yellow. We set the threshold value to be 60 and total colors to be extracted from image to be 5.", "In this article, we discussed the methodology to extract colors from an image using KMeans algorithm and then use this to search images based on colors.", "Hope you liked my work. Please feel free to share your thoughts and suggestions.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data science and Machine learning enthusiast. Technical Writer. Passionate Computer Science Engineer."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fb26e770c4c71&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcolor-identification-in-images-machine-learning-application-b26e770c4c71&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcolor-identification-in-images-machine-learning-application-b26e770c4c71&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcolor-identification-in-images-machine-learning-application-b26e770c4c71&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcolor-identification-in-images-machine-learning-application-b26e770c4c71&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----b26e770c4c71--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----b26e770c4c71--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@bhanotkaran22?source=post_page-----b26e770c4c71--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@bhanotkaran22?source=post_page-----b26e770c4c71--------------------------------", "anchor_text": "Karan Bhanot"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F10df94b13417&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcolor-identification-in-images-machine-learning-application-b26e770c4c71&user=Karan+Bhanot&userId=10df94b13417&source=post_page-10df94b13417----b26e770c4c71---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb26e770c4c71&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcolor-identification-in-images-machine-learning-application-b26e770c4c71&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb26e770c4c71&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcolor-identification-in-images-machine-learning-application-b26e770c4c71&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@henryatto?utm_source=medium&utm_medium=referral", "anchor_text": "Henry Lorenzatto"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://github.com/kb22/Color-Identification-using-Machine-Learning", "anchor_text": "this repository"}, {"url": "https://unsplash.com/", "anchor_text": "Unsplash"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----b26e770c4c71---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/programming?source=post_page-----b26e770c4c71---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/tag/data-science?source=post_page-----b26e770c4c71---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/python?source=post_page-----b26e770c4c71---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/data-analysis?source=post_page-----b26e770c4c71---------------data_analysis-----------------", "anchor_text": "Data Analysis"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fb26e770c4c71&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcolor-identification-in-images-machine-learning-application-b26e770c4c71&user=Karan+Bhanot&userId=10df94b13417&source=-----b26e770c4c71---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fb26e770c4c71&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcolor-identification-in-images-machine-learning-application-b26e770c4c71&user=Karan+Bhanot&userId=10df94b13417&source=-----b26e770c4c71---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb26e770c4c71&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcolor-identification-in-images-machine-learning-application-b26e770c4c71&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----b26e770c4c71--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fb26e770c4c71&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcolor-identification-in-images-machine-learning-application-b26e770c4c71&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----b26e770c4c71---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----b26e770c4c71--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----b26e770c4c71--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----b26e770c4c71--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----b26e770c4c71--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----b26e770c4c71--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----b26e770c4c71--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----b26e770c4c71--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----b26e770c4c71--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@bhanotkaran22?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@bhanotkaran22?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Karan Bhanot"}, {"url": "https://medium.com/@bhanotkaran22/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "3K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F10df94b13417&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcolor-identification-in-images-machine-learning-application-b26e770c4c71&user=Karan+Bhanot&userId=10df94b13417&source=post_page-10df94b13417--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fb37e4ce06e02&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcolor-identification-in-images-machine-learning-application-b26e770c4c71&newsletterV3=10df94b13417&newsletterV3Id=b37e4ce06e02&user=Karan+Bhanot&userId=10df94b13417&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}