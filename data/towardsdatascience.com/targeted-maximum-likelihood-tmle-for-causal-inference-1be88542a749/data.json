{"url": "https://towardsdatascience.com/targeted-maximum-likelihood-tmle-for-causal-inference-1be88542a749", "time": 1682996266.057787, "path": "towardsdatascience.com/targeted-maximum-likelihood-tmle-for-causal-inference-1be88542a749/", "webpage": {"metadata": {"title": "Targeted Maximum Likelihood (TMLE) for Causal Inference | by Yao Yang | Towards Data Science", "h1": "Targeted Maximum Likelihood (TMLE) for Causal Inference", "description": "Imagine you have two drugs, A and B, for treating cancer. You test the drugs on different people, now you want to measure which is more effective, how are you going to test it? You will probably\u2026"}, "outgoing_paragraph_urls": [{"url": "https://biostats.bepress.com/ucbbiostat/paper213/", "anchor_text": "van der Laan & Rubin in 2006", "paragraph_index": 8}, {"url": "https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4674449/", "anchor_text": "g-computation", "paragraph_index": 10}, {"url": "https://biostats.bepress.com/cgi/viewcontent.cgi?article=1214&context=ucbbiostat", "anchor_text": "Targeted Maximum Likelihood Learning", "paragraph_index": 15}], "all_paragraphs": ["Imagine you have two drugs, A and B, for treating cancer. You test the drugs on different people, now you want to measure which is more effective, how are you going to test it?", "You will probably first do randomization of the patients, and give half of them drug A, and half drug B, test key metrics over a period of time to compare which drug lowers more of the key metrics. Is that enough?", "No. A common misunderstanding people have is that as long as randomization is fulfilled, we can do infer that different treatments cause different results. This is not right. Randomization cannot guarantee equivalence. And this is where propensity score matching comes to place.", "What is propensity score matching then?", "The idea behind propensity score matching is that by giving each individual in the study a propensity score, we can compare individuals in different treatment groups and try to make the individuals as equivalent as possible so that we can control the confounding factors, the different result would be from the treatment only.", "Now you see that propensity score matching requires proper experiment setup before drugs are used on individuals in the study. We may end up dropping a lot of individual because they don\u2019t have matching counterparts. What if I failed to do the experiments or the number of matched pairs is too little? Can we still use the data we collected?", "Let\u2019s still think of the previous case where we have two groups getting two different drugs A and B. Our aim is to measure Average Treatment Effect (ATE=E[Y(A=1)]\u2212E[Y(A=0)]) in order to compare the treatments. We call patient\u2019s data point X \u2014 it may contain features like patients\u2019 age, gender, occupation, income, exercise, smoke or not, etc; test metrics Y \u2014 the metrics we care about to test for treatment result; treatment A being a binary variable 0 and 1 for two different treatments.", "How do we estimate unbiased Y(A=1) and Y(A=0) to accurately measure treatment effects with the least confounding variables\u2019 influence?", "Here I\u2019ll introduce a state-of-art method targeted maximum likelihood estimation (TMLE). Targeted Learning is proposed by van der Laan & Rubin in 2006 [1] as an automated (as opposed to do-it-yourself) causal inference method. TMLE is used to analyze censored observational data from a non-controlled experiment in a way that allows effect estimation even in the presence of confounding factors.", "Here\u2019s a step-by-step guide of how TMLE works:", "Step 1: Generate an initial estimate of E(Y|A, X). This is what we call g-computation in causal inference, it is a maximum-likelihood-based substitution estimator, it relies on the estimation of the conditional expectation of the outcome given the exposure and covariance. This estimator is used to generate the potential outcome Y\u2081 and Y\u2080, corresponding to A=1 and A=0. As to how do we get the estimator, Mark in paper used \u201csuper learner\u201d, which is essentially an ensemble learning method. I\u2019ll talk more about G-computation and the ensemble method in future posts.", "Now we have the estimator, remember that this method is conditioned on the treatment, and just assumes that the other variables have biases on the estimator that can be ignored. But this is not robust enough \u2014we need to \u2018target\u2019 at the treatment variable and minimize variable bias in a more robust way.", "Step 2. Estimate the exposure mechanism using propensity score P(A=1|X). We calculate the conditional probability of being exposed given the observed cofounders X. This is the same propensity score we mentioned earlier that people use to do matching of individuals. In TMLE, besides the propensity score, we also calculate \u03c0\u2081= P(A=1|X) and \u03c0\u2080 = 1-\u03c0\u2081 for each individual of the study.", "Step 4. Generate targeted estimate of the target parameter. With the new Y\u2081 and Y\u2080 for each individual we get from the last step, we can calculate the targeted estimate ATE=1\\n \u2211|Y\u2081-Y\u2080|.", "I will discuss more how TMLE compares to other causal inference methods, as well as how to implement TMLE in my next posts.", "[1] Van der Laan & Rubin, Targeted Maximum Likelihood Learning, 2006", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "The combination of words, numbers, and stories makes life"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F1be88542a749&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftargeted-maximum-likelihood-tmle-for-causal-inference-1be88542a749&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftargeted-maximum-likelihood-tmle-for-causal-inference-1be88542a749&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftargeted-maximum-likelihood-tmle-for-causal-inference-1be88542a749&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftargeted-maximum-likelihood-tmle-for-causal-inference-1be88542a749&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----1be88542a749--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----1be88542a749--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://yangyao.medium.com/?source=post_page-----1be88542a749--------------------------------", "anchor_text": ""}, {"url": "https://yangyao.medium.com/?source=post_page-----1be88542a749--------------------------------", "anchor_text": "Yao Yang"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F5a719c20527a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftargeted-maximum-likelihood-tmle-for-causal-inference-1be88542a749&user=Yao+Yang&userId=5a719c20527a&source=post_page-5a719c20527a----1be88542a749---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F1be88542a749&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftargeted-maximum-likelihood-tmle-for-causal-inference-1be88542a749&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F1be88542a749&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftargeted-maximum-likelihood-tmle-for-causal-inference-1be88542a749&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://biostats.bepress.com/ucbbiostat/paper213/", "anchor_text": "van der Laan & Rubin in 2006"}, {"url": "https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4674449/", "anchor_text": "g-computation"}, {"url": "https://biostats.bepress.com/cgi/viewcontent.cgi?article=1214&context=ucbbiostat", "anchor_text": "Targeted Maximum Likelihood Learning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----1be88542a749---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/causal-inference?source=post_page-----1be88542a749---------------causal_inference-----------------", "anchor_text": "Causal Inference"}, {"url": "https://medium.com/tag/statistics?source=post_page-----1be88542a749---------------statistics-----------------", "anchor_text": "Statistics"}, {"url": "https://medium.com/tag/towards-data-science?source=post_page-----1be88542a749---------------towards_data_science-----------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/tag/targeted-learning?source=post_page-----1be88542a749---------------targeted_learning-----------------", "anchor_text": "Targeted Learning"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F1be88542a749&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftargeted-maximum-likelihood-tmle-for-causal-inference-1be88542a749&user=Yao+Yang&userId=5a719c20527a&source=-----1be88542a749---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F1be88542a749&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftargeted-maximum-likelihood-tmle-for-causal-inference-1be88542a749&user=Yao+Yang&userId=5a719c20527a&source=-----1be88542a749---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F1be88542a749&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftargeted-maximum-likelihood-tmle-for-causal-inference-1be88542a749&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----1be88542a749--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F1be88542a749&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftargeted-maximum-likelihood-tmle-for-causal-inference-1be88542a749&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----1be88542a749---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----1be88542a749--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----1be88542a749--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----1be88542a749--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----1be88542a749--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----1be88542a749--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----1be88542a749--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----1be88542a749--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----1be88542a749--------------------------------", "anchor_text": ""}, {"url": "https://yangyao.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://yangyao.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Yao Yang"}, {"url": "https://yangyao.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "569 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F5a719c20527a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftargeted-maximum-likelihood-tmle-for-causal-inference-1be88542a749&user=Yao+Yang&userId=5a719c20527a&source=post_page-5a719c20527a--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F7e62ec5a9b17&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftargeted-maximum-likelihood-tmle-for-causal-inference-1be88542a749&newsletterV3=5a719c20527a&newsletterV3Id=7e62ec5a9b17&user=Yao+Yang&userId=5a719c20527a&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}