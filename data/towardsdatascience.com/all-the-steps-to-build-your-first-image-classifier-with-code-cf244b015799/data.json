{"url": "https://towardsdatascience.com/all-the-steps-to-build-your-first-image-classifier-with-code-cf244b015799", "time": 1682995229.252405, "path": "towardsdatascience.com/all-the-steps-to-build-your-first-image-classifier-with-code-cf244b015799/", "webpage": {"metadata": {"title": "All the Steps to Build your first Image Classifier (with code) | by Arthur Arnx | Towards Data Science", "h1": "All the Steps to Build your first Image Classifier (with code)", "description": "If you want to create an image classifier but have no idea where to start, follow this quick guide to understand the concepts and be able to train a convolutional neural network to recognize any\u2026"}, "outgoing_paragraph_urls": [], "all_paragraphs": ["If you want to create an image classifier but have no idea where to start, follow this quick guide to understand the concepts and be able to train a convolutional neural network to recognize any image you want !", "To achieve that, the code provided is written in Python (3.x), and we will mainly use the Keras library.", "First of all, if you have no idea what a neural network is, I can only encourage you to discover this concept with a quick guide. For example, here is the last one I wrote about that :", "Now, we will focus on the convolutional neural network, which keeps the same idea about columns and neurons, inputs and outputs, while simply adding a way to extract information in an image.", "This type of neural network consists of a deep neural network preceded by some operations.", "Overall, keep in mind that an image is just a matrix of numbers, of dimension 2 if the image is only in gray level, and dimension 3 if it contains colors (the third dimension is for all RGB levels).", "First of all, when an image is given to the algorithm, it starts by applying a small filter on the initial image and takes it everywhere on it. This step is called Convolution.", "In Figure 1, the initial image is green, the filter is yellow and multiplies every number of the initial image by the corresponding filter\u2019s one.", "After this operation, a new matrix (red) is obtained. By comparing pixels of the red matrix to a model, the program can determine if there is or not an object corresponding to a model on the first image.", "For example, obtaining big numbers only on a line of pixels means that the initial image contains a line there.", "The next step is called Pooling. It is about taking the highest value of each region and form a new matrix using only those values. It reduces the spatial dimension of the matrix and so helps the neural networks to operates quicker.", "In Figure 2, you can see that the dimension of the image is divided in 4 parts, with each one attributing its highest value. The new formed image is smaller.", "Also, an activation function is used during the process to normalize all the values obtained. In the example below, we will be using ReLU.", "Finally, a last step may be used to increase the accuracy, and is called Dropout. It forces a neural network to randomly disabling some neurons in the learning phase. We will implement this function in our example as well.", "Now that you know the basics of the convolution, we can start building one !", "This part is useful only if you want to use your own data, or data that can\u2019t be found on the web easily, to build a convolutional neural network maybe more adapted to your needs. Otherwise, here is the code to directly use datasets from Keras :", "Here, we simply call the function load_data to set the dataset for training and testing phase. You can replace \u201cmnist\u201d by any dataset you want to use (change it in both lines).", "If you want to create your own dataset, here are the steps :", "First of all, you will need to collect a lot of images. The more there are, the better. Remember to keep approximately the same amount of image for each class. For example, for my piece of 2D chess classifier, I had 160 images for each possible piece (and the empty case), so about 2,000 images in total (which is not that much) but the size of the dataset depends on the projects (my 2D pieces always have the same aspects, while cats have a lot of breeds, different sizes, different postures, \u2026).", "There is also a powerful tool to help you creating more data, called data augmentation. It simply modifies an image and gives back plenty of new and unique images, all based on the first one, by flipping, rotating or cropping it.", "In the end make sure that all your data is classified in a folder meant for that purpose, in which every class has its own subfolder.", "Now in the main folder, we will create a python program to set up all the data.", "In line 14, you can change the list to any classes you need, but keep the same names that you used for the subfolders earlier.", "Finally, after running the program, the data are setup in files and ready to be used.", "If you decided to use an imported dataset, replace lines 9 & 10 by what we saw earlier, and the line 44 by :", "In line 37, modify the parameter of Dense() to the number of classes you have. This is the number of possible output by the neural network.", "For every convolutional layers, you can see that we always firstly add it with its number of neurons and filter size. Then, we involve the activation function, and finally use the Pooling method. We also added a Dropout in line 30 to see how to do it.", "Also, before the first \u201cnormal\u201d hidden layer, we added the function Flatten(), that transforms all information from previous convolutions into inputs for neurons. At this point, the rest simply contains layers and neurons from basic neural network.", "Here it is, you built your own classifier !", "Now, you can use your neural network to predict any image you want. Simply make a little script involving these few lines :", "The function prepare(file) allows us to use an image of any size, since it automatically resize it to the image size we defined in the first program.", "If you modified the image size in the data program, modify it here too.", "That\u2019s it ! You just built your own image classifier adapted to your own images. Of course, do not hesitate to modify any line of code you see, since your neural network accuracy may vary a lot according to those parameters. Here is a non-exhaustive about those :", "With this guide, we covered just enough for you to create and understand your first convolutional neural network. There are many other parameters or aspects that you could discover if you want, so don\u2019t hesitate to go further.", "I hope this little guide was useful, if you have any question and/or suggestion, let me know in the comments.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fcf244b015799&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fall-the-steps-to-build-your-first-image-classifier-with-code-cf244b015799&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fall-the-steps-to-build-your-first-image-classifier-with-code-cf244b015799&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fall-the-steps-to-build-your-first-image-classifier-with-code-cf244b015799&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fall-the-steps-to-build-your-first-image-classifier-with-code-cf244b015799&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----cf244b015799--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----cf244b015799--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@artux51?source=post_page-----cf244b015799--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@artux51?source=post_page-----cf244b015799--------------------------------", "anchor_text": "Arthur Arnx"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F4aa81c733935&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fall-the-steps-to-build-your-first-image-classifier-with-code-cf244b015799&user=Arthur+Arnx&userId=4aa81c733935&source=post_page-4aa81c733935----cf244b015799---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fcf244b015799&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fall-the-steps-to-build-your-first-image-classifier-with-code-cf244b015799&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fcf244b015799&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fall-the-steps-to-build-your-first-image-classifier-with-code-cf244b015799&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@templecerulean?utm_source=medium&utm_medium=referral", "anchor_text": "Temple Cerulean"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://towardsdatascience.com/first-neural-network-for-beginners-explained-with-code-4cfd37e06eaf", "anchor_text": "First neural network for beginners explained (with code)Understand and create a Perceptrontowardsdatascience.com"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----cf244b015799---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/computer-vision?source=post_page-----cf244b015799---------------computer_vision-----------------", "anchor_text": "Computer Vision"}, {"url": "https://medium.com/tag/neural-networks?source=post_page-----cf244b015799---------------neural_networks-----------------", "anchor_text": "Neural Networks"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----cf244b015799---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/guides-and-tutorials?source=post_page-----cf244b015799---------------guides_and_tutorials-----------------", "anchor_text": "Guides And Tutorials"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fcf244b015799&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fall-the-steps-to-build-your-first-image-classifier-with-code-cf244b015799&user=Arthur+Arnx&userId=4aa81c733935&source=-----cf244b015799---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fcf244b015799&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fall-the-steps-to-build-your-first-image-classifier-with-code-cf244b015799&user=Arthur+Arnx&userId=4aa81c733935&source=-----cf244b015799---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fcf244b015799&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fall-the-steps-to-build-your-first-image-classifier-with-code-cf244b015799&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----cf244b015799--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fcf244b015799&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fall-the-steps-to-build-your-first-image-classifier-with-code-cf244b015799&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----cf244b015799---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----cf244b015799--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----cf244b015799--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----cf244b015799--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----cf244b015799--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----cf244b015799--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----cf244b015799--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----cf244b015799--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----cf244b015799--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@artux51?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@artux51?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Arthur Arnx"}, {"url": "https://medium.com/@artux51/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "341 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F4aa81c733935&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fall-the-steps-to-build-your-first-image-classifier-with-code-cf244b015799&user=Arthur+Arnx&userId=4aa81c733935&source=post_page-4aa81c733935--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F4eab07644414&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fall-the-steps-to-build-your-first-image-classifier-with-code-cf244b015799&newsletterV3=4aa81c733935&newsletterV3Id=4eab07644414&user=Arthur+Arnx&userId=4aa81c733935&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}