{"url": "https://towardsdatascience.com/how-to-build-a-baseball-detector-using-detectron2-50b44edec6b7", "time": 1683011437.3327959, "path": "towardsdatascience.com/how-to-build-a-baseball-detector-using-detectron2-50b44edec6b7/", "webpage": {"metadata": {"title": "How to detect a baseball in image and video using Detectron2 with custom dataset | Towards Data Science", "h1": "How to detect a baseball in image and video using Detectron2 with custom dataset", "description": "Train Detectron2 object detection with custom datasets for baseball application"}, "outgoing_paragraph_urls": [{"url": "https://github.com/facebookresearch/detectron2", "anchor_text": "https://github.com/facebookresearch/detectron2", "paragraph_index": 2}, {"url": "https://github.com/tzutalin/labelImg", "anchor_text": "Labelimg", "paragraph_index": 6}, {"url": "https://github.com/Tony607/voc2coco/blob/master/voc2coco.py", "anchor_text": "voc2coco.py", "paragraph_index": 8}, {"url": "https://colab.research.google.com/drive/16jcaJoc6bCFAQ96jDe2HwtXj7BMD_-m5", "anchor_text": "tutorial Colab notebook", "paragraph_index": 10}], "all_paragraphs": ["As an amateur baseball player, I always want to analyze my pitching and swing to quantify my skills during practice. There are actually some commercial tools applying different technologies to do that, however, most of them are quite expensive and required extra equipment.", "I was wondering if I can analyze my motion from a simple video made by phone. To do that, I need to gather information from the video. First I want to detect the baseball and identify its location, then I can do further analysis such as launch velocity and angle.", "In this post, I am going to show how I create a custom baseball dataset and train an object detection model and apply it to baseball video using Detectron2 (https://github.com/facebookresearch/detectron2).", "The baseball detector was build following three steps which will be discussed in details in the post: 1. Create custom baseball dataset in COCO format 2. Play around with Detectron2 and train the model in Colab 3. Load the video/image and apply the trained model to make a detection.", "The baseball image in a real video clip is usually not clear and perfect. It might be a bit blur and distorted as shown below. Therefore, instead of using the pre-trained model provided by Detectron 2. I decided to create a dataset containing the real baseball images in the video for better detection.", "To start, I used some baseball game video on Youtube and got 120 images containing baseball for this first attempt.", "Then I used Labelimg to hand-label the baseball. Labelimg is a convenient tool to label object. Following the instruction in the repo, it can be easily installed and used.", "It took me around 20 minutes to manually label 120 images, after that the annotations were saved in the folder you set in xml.", "Then I used this voc2coco.py script from Tony607's GitHub repo to convert the PascalVOC xml files to one COCO formatted JSON file.", "Now I have to custom baseball dataset with annotations in COCO format ready for training.", "I modified the nice and clear tutorial Colab notebook from Detectron2 and trained the model.", "First I mounted my Google Drive to the notebook and upload the dataset I created to it.", "Then I followed the instruction in the notebook to install and setup detectron2.", "Then I registered the ball dataset to detectron2. Input the annotation file path (COCO json) and the folder path that contains trainings images.", "then I run this cell to see the training image", "I am now ready for training!", "I fine-tune a COCO-pretrained R50-FPN Mask R-CNN model on the the baseball dataset. I got the config and weight using model_zoo method. remember to change cfg.MODEL.ROI_HEADS.NUM_CLASSES to 1 since I only have one class now. It took me several minutes to run 2000 iterations on Colab.", "I can see the training performance in tensorboard", "Now I can run inference with the trained model on the ball validation dataset. First, let\u2019s create a predictor using the model I just trained:", "selected some test images to test the model", "Now I have the trained model, I can load the image/video I want to make the detection.", "I wrote a script to read the video using OpenCV frame by frame and detect the baseball using the model for every frame. So I now have the information for the detected baseball such as location every frame for further analysis. I can also output the baseball detected video!", "Thanks for reading. Feedback and suggestions are welcome!", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F50b44edec6b7&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-build-a-baseball-detector-using-detectron2-50b44edec6b7&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-build-a-baseball-detector-using-detectron2-50b44edec6b7&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-build-a-baseball-detector-using-detectron2-50b44edec6b7&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-build-a-baseball-detector-using-detectron2-50b44edec6b7&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----50b44edec6b7--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----50b44edec6b7--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@c.kuan?source=post_page-----50b44edec6b7--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@c.kuan?source=post_page-----50b44edec6b7--------------------------------", "anchor_text": "C K"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fd655d41bf524&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-build-a-baseball-detector-using-detectron2-50b44edec6b7&user=C+K&userId=d655d41bf524&source=post_page-d655d41bf524----50b44edec6b7---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F50b44edec6b7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-build-a-baseball-detector-using-detectron2-50b44edec6b7&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F50b44edec6b7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-build-a-baseball-detector-using-detectron2-50b44edec6b7&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://github.com/facebookresearch/detectron2", "anchor_text": "https://github.com/facebookresearch/detectron2"}, {"url": "https://github.com/tzutalin/labelImg", "anchor_text": "Labelimg"}, {"url": "https://github.com/Tony607/voc2coco/blob/master/voc2coco.py", "anchor_text": "voc2coco.py"}, {"url": "https://colab.research.google.com/drive/16jcaJoc6bCFAQ96jDe2HwtXj7BMD_-m5", "anchor_text": "tutorial Colab notebook"}, {"url": "https://towardsdatascience.com/detect-and-track-baseball-using-detectron2-and-sort-6dd92a46e6f2", "anchor_text": "Detect and track baseball using Detectron2 and SORTHow I track the baseballs when there are multiple baseballs in the video.towardsdatascience.com"}, {"url": "https://medium.com/tag/baseball?source=post_page-----50b44edec6b7---------------baseball-----------------", "anchor_text": "Baseball"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----50b44edec6b7---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----50b44edec6b7---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----50b44edec6b7---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/computer-vision?source=post_page-----50b44edec6b7---------------computer_vision-----------------", "anchor_text": "Computer Vision"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F50b44edec6b7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-build-a-baseball-detector-using-detectron2-50b44edec6b7&user=C+K&userId=d655d41bf524&source=-----50b44edec6b7---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F50b44edec6b7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-build-a-baseball-detector-using-detectron2-50b44edec6b7&user=C+K&userId=d655d41bf524&source=-----50b44edec6b7---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F50b44edec6b7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-build-a-baseball-detector-using-detectron2-50b44edec6b7&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----50b44edec6b7--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F50b44edec6b7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-build-a-baseball-detector-using-detectron2-50b44edec6b7&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----50b44edec6b7---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----50b44edec6b7--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----50b44edec6b7--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----50b44edec6b7--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----50b44edec6b7--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----50b44edec6b7--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----50b44edec6b7--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----50b44edec6b7--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----50b44edec6b7--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@c.kuan?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@c.kuan?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "C K"}, {"url": "https://medium.com/@c.kuan/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "268 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fd655d41bf524&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-build-a-baseball-detector-using-detectron2-50b44edec6b7&user=C+K&userId=d655d41bf524&source=post_page-d655d41bf524--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fe796e256f1d1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-build-a-baseball-detector-using-detectron2-50b44edec6b7&newsletterV3=d655d41bf524&newsletterV3Id=e796e256f1d1&user=C+K&userId=d655d41bf524&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}