{"url": "https://towardsdatascience.com/infectious-disease-modelling-part-i-understanding-sir-28d60e29fdfc", "time": 1683005444.307125, "path": "towardsdatascience.com/infectious-disease-modelling-part-i-understanding-sir-28d60e29fdfc/", "webpage": {"metadata": {"title": "Infectious Disease Modelling, Part I: Understanding SIR | Towards Data Science", "h1": "Infectious Disease Modelling: Understanding the models that are used to model Coronavirus", "description": "Explaining the background and deriving the formulas of the SIR compartmental model from scratch. Coding and Visualizing the SIR model in Python."}, "outgoing_paragraph_urls": [{"url": "https://medium.com/@hf2000510/infectious-disease-modelling-beyond-the-basic-sir-model-216369c584c4", "anchor_text": "My next article", "paragraph_index": 1}, {"url": "https://medium.com/@hf2000510/infectious-disease-modelling-fit-your-model-to-coronavirus-data-2568e672dbc7", "anchor_text": "Another article", "paragraph_index": 1}, {"url": "https://github.com/henrifroese/infectious_disease_modelling/blob/master/part_one.ipynb", "anchor_text": "You can find the notebook with the whole code for this article here.", "paragraph_index": 2}, {"url": "https://github.com/henrifroese/infectious_disease_modelling/blob/master/part_one.ipynb", "anchor_text": "(You can find the whole code here", "paragraph_index": 20}], "all_paragraphs": ["In the past few weeks, lots of data scientists, hobbyists and enthusiasts have begun to read about infectious disease modelling. Many of them have jumped right into modelling and blindly fitting their models to coronavirus case numbers \u2014 without understanding the background and theory behind the models. Although consisting of seemingly daunting mathematics, the most widely used models \u2014 if explained well \u2014 are not all to difficult to understand.", "This article explains the background and provides an introduction to the topic of modelling infectious diseases. The SIR model equations are derived and explained from scratch with simple examples. At the end, a simple SIR model is coded in Python. My next article is focused on more elaborate variants of the basic SIR model and will enable readers to implement and visualize their own variants and ideas. Another article will be concerned with fitting a model to real-world data and includes Covid-19 as a case study.", "You can find the notebook with the whole code for this article here.", "This series is not meant to quickly show you some plots with lots of colorful curves that are supposed to convince you that my model can perfectly predict coronavirus cases to a tee all over the world; Rather, I\u2019ll explain all the background necessary for you to understand these models, form your own opinion of these models and implement your own ideas. You only need high school level calculus to follow the explanations; You\u2019ll need a solid understanding of python to follow the programming parts.", "We want to model infectious diseases. These diseases can spread from one member of a population to another; we try to gain insights into how quickly they spread, what proportion of a population they infect, what proportion dies, etc. One of the easiest ways to model them (and the way we\u2019re focusing on here) is with a compartmental model. A compartmental model separates the population into several compartments, for example:", "That is, we might have a population of N=1000 (for example 1000 people) and we know that 400 people are infected at time t (for example t=7 days after outbreak of the disease). This is denoted by S(7) = 400. The SIR-Model allows us to, only by inputting some initial parameters, get all values S(t), I(t), R(t) for all days t. I\u2019ll now introduce the necessary variables with an easy example:", "We have a new disease, disease X. For this disease, the probability of an infected person to infect a healthy person is 20%. The average number of people a person is in contact with per day is 5. So, per day, an infected individual meets 5 people and infects each with 20% probability. Thus, we expect this individual to infect 1 person (20% \u22c5 5 = 1) per day. This is \u03b2 (\u201cbeta\u201d), the expected amount of people an infected person infects per day.", "Now one can see that the number of days that an infected person has and can spread the disease is extremely important. We\u2019ll call this number D. If D=7, an infected person walks around for seven days spreading the disease, and infects 1 person per day (because \u03b2=1). So we expect an infected person to infect 1\u22c57 (1 per day times 7 days) = 7 other people. This is the basic reproduction number R\u2080, the total number of people an infected person infects. We just used an intuitive formula: R\u2080 = \u03b2 \u22c5 D.", "We actually don\u2019t need anything else, just one small notation: \u03b3 (\u201cgamma\u201d) will be 1/D, so if you think of D as the number of days an infected person has the disease, you can think of \u03b3 as the rate of recovery, or the proportion of infected recovering per day. For example, if currently 30 people are infected and D=3 (so they\u2019re infected for three days), then per day, 1/3 (so 10) of them will recover, so \u03b3=1/3. With \u03b3 = 1/D, so D = 1/\u03b3 , and R\u2080 = \u03b2 \u22c5 D, it follows that R\u2080 = \u03b2 / \u03b3.", "Here you can see the most important variables and their definitions again:", "We now want to get the number of infected, susceptible and recovered for all days, just from \u03b2, \u03b3 and N. Now, it is difficult to obtain a direct formula for S(t), I(t) and R(t). However, it is quite simple to describe the change per day of S, I, and R, that is, how the number of susceptible/infected/recovered changes depending on the current numbers. Again, we\u2019ll derive the formulas by example:", "We are now on day t after outbreak of disease X. Still, the expected amount of people an infected person infects per day is 1 (so \u03b2=1) and the number of days that an infected person has and can spread the disease is 7 (so \u03b3=1/7 and D=7).", "We have 60 infected people. Each of them infects 1 person per day (that\u2019s \u03b2). However, only 30/100 =30% of people they meet are still susceptible and can be infected (that\u2019s S(t) / N). So, they infect 60 \u22c5 1 \u22c5 30/100 = 18 people (again, think about it until it really makes sense: 60 infected that infect on average 1 person per day, but only 30 of 100 people can still be infected, so they do not infect 60\u22c51 people, but only 60\u22c51\u22c530/100 = 18 people). So, 18 people of the susceptibles get infected, so S(t) changes by minus 18. Plugging in the variables, we just derived the first formula:", "If you\u2019re familiar with calculus, you know we have a term for describing the change of a function: the derivative S\u2019(t) or dS/dt. (After we have derived and understood all the derivatives S\u2019(t), I\u2019(t) and R\u2019(t), we can calculate the values of S(t), I(t) and R(t) for each day.)", "Now, how does the amount of infected change? That\u2019s easy: There are some new people infected, we just saw that. Exactly the amount of people that \u201cleave\u201d S(t) \u201carrive\u201d at I(t). So, we have 18 new infected and we already know that the formula will be similar to this: I\u2019(t) = + \u03b2 \u22c5 I(t) \u22c5 S(t) / N (of course, we can omit the plus, it\u2019s just to show you that we gain the exact amount that S(t) loses, so we just change the sign). There\u2019s just one thing missing: some people recover. Remember, we have \u03b3 for that, it\u2019s the proportion of infected recovering per day, that\u2019s just what we need!", "Again, think about this for a minute; The first part is the newly infected from the susceptibles. The second part is the recoveries.", "Finally, we get to the last formula, the change in recoveries. That\u2019s easy: the newly recovered are exactly the 20 we just calculated; there are no people leaving the \u201crecovered\u201d-compartment. Once recovered, they stay immune:", "Great, we have now derived (and understood) all the formulas we need! Here they are again with a more common notation for the derivative and the \u201c(t)\u201d left out as is often done:", "Such equations are called ordinary differential equations (ODEs) (you won\u2019t need any knowledge about them to follow this series).", "We can now describe the change in the number of people susceptible, infected, and recovered. From these formulas, luckily, we can calculate the numbers we\u2019re really interested in: S(t), I(t) and R(t), the number of people susceptible, infected, and recovered for each day t. Even more luckily, we do not have to do one bit ourselves, python provides many tools for solving ODEs!", "(You can find the whole code here)", "We\u2019ll now code and visualize an example model. Feel free to copy the code and play with the parameters! We first define some parameters:", "We now implement exactly the formulas we derived above:", "Now this is where the magic happens: we get our values S(t), I(t) and R(t) from the function odeint that takes the formulas we defined above, the initial conditions, and our variables N, \u03b2 and \u03b3 and calculates S, I, and R for 50 days.", "Now we just plot the result and arrive at this:", "As you can see, it only takes around 30 days for almost a whole population of 1000 people to get infected. Of course, the disease modeled here has a very high R\u2080 value of 4.0 (recall that R\u2080 = \u03b2 \u22c5 D = 1.0 \u22c5 4.0). Just changing the number of people an infected person infects per day \u03b2 to 0.5 results in a completely different scenario:", "As you can see, these systems of ODEs are extremely sensitive to the initial parameters. That\u2019s also why it\u2019s so hard to correctly model an emerging outbreak of a new disease: we just do not know what the parameters are, and even slight changes result in widely different outcomes.", "You should now have a solid grasp of some of the most important formulas and ideas of infectious disease modelling. This understanding of what R\u2080, \u03b2, \u03b3 etc. mean enables you to not just tweak parameters blindly but to design, refine and extend your own models. You should now be able to follow the next parts, where we\u2019ll focus more on extending existing models and (in part 3) trying to model an emerging outbreak.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F28d60e29fdfc&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finfectious-disease-modelling-part-i-understanding-sir-28d60e29fdfc&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finfectious-disease-modelling-part-i-understanding-sir-28d60e29fdfc&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finfectious-disease-modelling-part-i-understanding-sir-28d60e29fdfc&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finfectious-disease-modelling-part-i-understanding-sir-28d60e29fdfc&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----28d60e29fdfc--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----28d60e29fdfc--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@hf2000510?source=post_page-----28d60e29fdfc--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@hf2000510?source=post_page-----28d60e29fdfc--------------------------------", "anchor_text": "Henri Froese"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F9abcef7cc116&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finfectious-disease-modelling-part-i-understanding-sir-28d60e29fdfc&user=Henri+Froese&userId=9abcef7cc116&source=post_page-9abcef7cc116----28d60e29fdfc---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F28d60e29fdfc&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finfectious-disease-modelling-part-i-understanding-sir-28d60e29fdfc&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F28d60e29fdfc&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finfectious-disease-modelling-part-i-understanding-sir-28d60e29fdfc&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://medium.com/@hf2000510/infectious-disease-modelling-beyond-the-basic-sir-model-216369c584c4", "anchor_text": "My next article"}, {"url": "https://medium.com/@hf2000510/infectious-disease-modelling-fit-your-model-to-coronavirus-data-2568e672dbc7", "anchor_text": "Another article"}, {"url": "https://github.com/henrifroese/infectious_disease_modelling/blob/master/part_one.ipynb", "anchor_text": "You can find the notebook with the whole code for this article here."}, {"url": "https://github.com/henrifroese/infectious_disease_modelling/blob/master/part_one.ipynb", "anchor_text": "(You can find the whole code here"}, {"url": "https://medium.com/tag/data-science?source=post_page-----28d60e29fdfc---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/python?source=post_page-----28d60e29fdfc---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/coronavirus?source=post_page-----28d60e29fdfc---------------coronavirus-----------------", "anchor_text": "Coronavirus"}, {"url": "https://medium.com/tag/epidemiology?source=post_page-----28d60e29fdfc---------------epidemiology-----------------", "anchor_text": "Epidemiology"}, {"url": "https://medium.com/tag/modelling-and-simulation?source=post_page-----28d60e29fdfc---------------modelling_and_simulation-----------------", "anchor_text": "Modelling And Simulation"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F28d60e29fdfc&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finfectious-disease-modelling-part-i-understanding-sir-28d60e29fdfc&user=Henri+Froese&userId=9abcef7cc116&source=-----28d60e29fdfc---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F28d60e29fdfc&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finfectious-disease-modelling-part-i-understanding-sir-28d60e29fdfc&user=Henri+Froese&userId=9abcef7cc116&source=-----28d60e29fdfc---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F28d60e29fdfc&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finfectious-disease-modelling-part-i-understanding-sir-28d60e29fdfc&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----28d60e29fdfc--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F28d60e29fdfc&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finfectious-disease-modelling-part-i-understanding-sir-28d60e29fdfc&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----28d60e29fdfc---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----28d60e29fdfc--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----28d60e29fdfc--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----28d60e29fdfc--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----28d60e29fdfc--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----28d60e29fdfc--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----28d60e29fdfc--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----28d60e29fdfc--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----28d60e29fdfc--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@hf2000510?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@hf2000510?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Henri Froese"}, {"url": "https://medium.com/@hf2000510/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "208 Followers"}, {"url": "http://linkedin.com/in/henrifroese", "anchor_text": "linkedin.com/in/henrifroese"}, {"url": "http://github.com/henrifroese", "anchor_text": "github.com/henrifroese"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F9abcef7cc116&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finfectious-disease-modelling-part-i-understanding-sir-28d60e29fdfc&user=Henri+Froese&userId=9abcef7cc116&source=post_page-9abcef7cc116--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F6fde6b877e65&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finfectious-disease-modelling-part-i-understanding-sir-28d60e29fdfc&newsletterV3=9abcef7cc116&newsletterV3Id=6fde6b877e65&user=Henri+Froese&userId=9abcef7cc116&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}