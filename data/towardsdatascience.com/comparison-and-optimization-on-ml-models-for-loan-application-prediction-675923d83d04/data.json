{"url": "https://towardsdatascience.com/comparison-and-optimization-on-ml-models-for-loan-application-prediction-675923d83d04", "time": 1683010288.529454, "path": "towardsdatascience.com/comparison-and-optimization-on-ml-models-for-loan-application-prediction-675923d83d04/", "webpage": {"metadata": {"title": "Comparison and Optimization on ML Models for Loan Application Prediction | by Luke Sun | Towards Data Science", "h1": "Comparison and Optimization on ML Models for Loan Application Prediction", "description": "In this article, we will elaborate on ML model selection, validation, and optimization using online loan application data. What you will learn is how to create, evaluate, and optimize ML models, focusing on logistic regression, SVM, and Random Forest."}, "outgoing_paragraph_urls": [{"url": "https://towardsdatascience.com/exploratory-data-analysis-on-mobile-app-behavior-data-2777fc937973", "anchor_text": "article", "paragraph_index": 3}, {"url": "https://towardsdatascience.com/logistic-regression-how-to-on-app-behavior-data-8a95802a988f", "anchor_text": "article", "paragraph_index": 13}, {"url": "https://towardsdatascience.com/svm-and-kernel-svm-fed02bef1200", "anchor_text": "article", "paragraph_index": 16}, {"url": "https://towardsdatascience.com/support-vector-machines-svm-c9ef22815589", "anchor_text": "article", "paragraph_index": 16}, {"url": "https://towardsdatascience.com/gini-index-vs-information-entropy-7a7e4fed3fcb", "anchor_text": "article", "paragraph_index": 33}, {"url": "https://github.com/luke4u/Customer_Behaviour_Prediction/tree/main/Loan-prediction", "anchor_text": "Github", "paragraph_index": 39}], "all_paragraphs": ["In this article, we will elaborate on ML model selection, validation, and optimization using online loan application data. What you will learn is how to create, evaluate, and optimize ML models. Specifically, we will focus on Logistic Regression, Support Vector Machine, and Random Forest. It is split into 7 parts.", "We are tasked by a loan lending company to predict quality applicants. The job is to develop a model to predict the interest of applicants, by analyzing applicants\u2019 data entered during the application process. If the applicant is interested, he or she will e-sign the product, otherwise not.", "Quickly looking at the data shown in the video, you can find there are 21 columns with 17,908 rows. With so many features, let\u2019s create a summary of each variable\u2019s explanation, as shown in Figure 1, to enhance our understanding.", "EDA is a must-to-do step before any data processing. Generally, it includes data cleaning, data visualization, and correlation analysis. Here I will not elaborate on EDA. If you want to familiarize yourself with the EDA steps, feel free to read this article.", "During EDA data visualization, you may find for the variable \u2018months_employed\u2019, most applicants have 0-month employment. This does not seem right, so we will drop this un-reliable column.", "Second, two columns, \u2018personal_account_m\u2019 and \u2018personal_account_y\u2019, can be combined into a new variable to represent the total months of the applicant\u2019s account. Specifically,", "We need to convert categorical variables into numerical ones. There is only 1 categorical variable \u2018pay_schedule\u2019. Specifically,", "Above will convert \u2018pay_schedule\u2019 into 4 columns, \u2018pay_schedule_bi-weekly\u2019, \u2018pay_schedule_monthly\u2019, \u2018pay_schedule_semi-monthly\u2019, \u2018pay_schedule_weekly\u2019. Because each column is exclusive with each other, we have to drop one to make them linearly independent. Specifically,", "To get data ready for the model, we split the independent and response variables into test and train sets.", "Finally, we need to scale the independent variables.", "Note, the resulting data from the scaler is a Numpy array, and we converted it to Dataframe to keep the index and column names. Also, we use X_train to train the scaler, and with the trained scaler to directly transform the test data.", "To begin with, let\u2019s experiment with different models to find the best one.", "Let\u2019s create a linear model first. Specifically,", "The above code block will train and test the logistic regression model. Note we used L1 Lasso regularization to penalize the coefficients of the model. If you want to learn more details, please check this article on the regularization.", "In the end, we got an accuracy of 56%, a precision of 57%, and a recall of 70%. This means the out of all positive predictions, only 57% are true and these true positives take 70% of the actual positives \ud83d\ude06.", "Let\u2019s build a Support Vector Machine-based classifier.", "A key concept for SVM is the kernel. A kernel is used for data transformation so that inseparable data in current data space can be separated in higher dimension space. It takes in data as input and transforms it into required forms based on the kernel chosen. Obviously, choosing the right kernel is crucial, because the wrong transformation will make the model perform poorly. If you want to dig into details about SVM, feel free to read this article and this article.", "First, let\u2019s train a linear kernel SVM. Normally, a linear kernel is used when the dataset is linearly separable, namely separable using a single line. It is faster than any other kernel. Specifically,", "In the end, we got an accuracy of 57%, a precision of 58%, and a recall of 73%. This is a slightly better performance compared to the logistic regression model \ud83e\udd2a.", "Radial Basis Function is a non-linear kernel used in SVM. Compared to the linear kernel, RBF is not a parametric model, and its complexity increases with the size of the data. Therefore, it is more expensive to train the model as well as making a prediction. In addition, with more hyperparameters, it is more likely to overfit on a complex model.", "Again, after train and testing, we got an accuracy of 59%, a precision of 60%, and a recall of 69%. Not much improvement compared to the linear kernel \ud83d\ude12.", "Random Forest operates by constructing a multitude of individual decision trees and outputting the mode class for a classification problem or mean prediction for a regression problem. The underlying logic of running many decision trees is that the optimal decision is from the wisdom of the crowd, simple yet powerful.", "Note above, we create 100 decision trees. In the end, we got an accuracy of 62%, a precision of 64%, and a recall of 67%. Summarizing all model performance in Figure 2, we found RF gives the best performance \ud83d\ude01.", "Before optimizing the random forest model, let\u2019s first validate its performance. Here we apply K-fold cross-validation using the training data. Specifically,", "In the end, we got an accuracy of 63% with 3% of the standard deviation. This indicates the Random Forest model is consistently performing well for the training set \ud83d\ude0e.", "Since we know Random Forest performs best compared to other models, let\u2019s aim to optimize the Random Forest model by using parameter tuning.", "Random forest classifier has a few parameters including:", "Here we select the parameters below and set the search range for each.", "We use Grid Search to iterate through all the different combinations of parameters as well as many cross-validations for each. We could also use Random Search. Specifically,", "Note above we use 10-fold cross-validation. In the end, Grid Search found the best parameters are below in Figure 3 with an accuracy of 63% \ud83d\ude03.", "With that, we can either use these parameters to test the model on the test dataset or perform the 2nd round of Grid Search to fine-tune the parameters. If you want a 2nd round, try the parameters below.", "In the end, we got the same accuracy of 63% with the same parameters. This means the results we got from the 1st round are already optimal \ud83d\udc4c.", "Finally, let\u2019s use the optimized model on test data. In the end, we got results in Figure 5. Great results.", "Note above we use \u201centropy\u201d as the splitting criteria. You could also use \u2018Gini\u2019. Entropy and Gini index are a measure of impurity of a node. A node having multiple classes is impure whereas a node with only one class is pure. In general, a decision tree works by recursively splitting variables or features with regard to response variables. It is designed to optimize each split by maximizing the purity of each node. Entropy aims to maximize the information content gained at each split, and the more information expected to gain from splitting a node, the better the split is to be. On the other hand, Gini measures the probability of mislabelling. Depending on which criteria are used, decision tree results can be different. Feel free to read this article if you need more details on this topic.", "Now let\u2019s perform the same Grid Search using \u201cGini\u201d as criteria, keeping the rest parameters unchanged. After 1st round, we got an accuracy of 64%.", "If we perform the 2nd round to fine-tune the above parameters, we got an accuracy of 64% again with the best parameters below.", "With the fine-tuned parameters, let\u2019s test the model. As you can see in Figure 8, there is minor performance difference between entropy and Gini based models.", "We tested 4 different models using the same data, Logistic Regression, SVM (linear), SVM (RBF), and Random Forest. Random forest is proved to perform best with 63% accuracy. Using Grid Search, we improved the model performance by 1\u20133%.", "Commercially speaking, one way to leverage the model is to target those predicted to not sign the loan with the customized onboarding process. This will help the company win more customers and improve its business.", "Great! If you found this post helpful, feel free to hit those \ud83d\udc4f \u2018s! If you need the source code, feel free to visit my Github page \ud83e\udd1e\ud83e\udd1e\ud83e\udd1e.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "ML Enthusiast, Data Scientist, Python Developer. Love to share articles about technology."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F675923d83d04&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcomparison-and-optimization-on-ml-models-for-loan-application-prediction-675923d83d04&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcomparison-and-optimization-on-ml-models-for-loan-application-prediction-675923d83d04&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcomparison-and-optimization-on-ml-models-for-loan-application-prediction-675923d83d04&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcomparison-and-optimization-on-ml-models-for-loan-application-prediction-675923d83d04&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----675923d83d04--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----675923d83d04--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://lukesun.medium.com/?source=post_page-----675923d83d04--------------------------------", "anchor_text": ""}, {"url": "https://lukesun.medium.com/?source=post_page-----675923d83d04--------------------------------", "anchor_text": "Luke Sun"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F7b5b79d21508&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcomparison-and-optimization-on-ml-models-for-loan-application-prediction-675923d83d04&user=Luke+Sun&userId=7b5b79d21508&source=post_page-7b5b79d21508----675923d83d04---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F675923d83d04&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcomparison-and-optimization-on-ml-models-for-loan-application-prediction-675923d83d04&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F675923d83d04&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcomparison-and-optimization-on-ml-models-for-loan-application-prediction-675923d83d04&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://pixabay.com/photos/housebuilding-house-money-expensive-1005491/", "anchor_text": "link"}, {"url": "https://towardsdatascience.com/exploratory-data-analysis-on-mobile-app-behavior-data-2777fc937973", "anchor_text": "article"}, {"url": "https://towardsdatascience.com/logistic-regression-how-to-on-app-behavior-data-8a95802a988f", "anchor_text": "article"}, {"url": "https://towardsdatascience.com/svm-and-kernel-svm-fed02bef1200", "anchor_text": "article"}, {"url": "https://towardsdatascience.com/support-vector-machines-svm-c9ef22815589", "anchor_text": "article"}, {"url": "https://towardsdatascience.com/gini-index-vs-information-entropy-7a7e4fed3fcb", "anchor_text": "article"}, {"url": "https://github.com/luke4u/Customer_Behaviour_Prediction/tree/main/Loan-prediction", "anchor_text": "Github"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----675923d83d04---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/binary-classification?source=post_page-----675923d83d04---------------binary_classification-----------------", "anchor_text": "Binary Classification"}, {"url": "https://medium.com/tag/model-optimization?source=post_page-----675923d83d04---------------model_optimization-----------------", "anchor_text": "Model Optimization"}, {"url": "https://medium.com/tag/data-science?source=post_page-----675923d83d04---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/model-selection?source=post_page-----675923d83d04---------------model_selection-----------------", "anchor_text": "Model Selection"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F675923d83d04&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcomparison-and-optimization-on-ml-models-for-loan-application-prediction-675923d83d04&user=Luke+Sun&userId=7b5b79d21508&source=-----675923d83d04---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F675923d83d04&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcomparison-and-optimization-on-ml-models-for-loan-application-prediction-675923d83d04&user=Luke+Sun&userId=7b5b79d21508&source=-----675923d83d04---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F675923d83d04&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcomparison-and-optimization-on-ml-models-for-loan-application-prediction-675923d83d04&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----675923d83d04--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F675923d83d04&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcomparison-and-optimization-on-ml-models-for-loan-application-prediction-675923d83d04&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----675923d83d04---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----675923d83d04--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----675923d83d04--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----675923d83d04--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----675923d83d04--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----675923d83d04--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----675923d83d04--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----675923d83d04--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----675923d83d04--------------------------------", "anchor_text": ""}, {"url": "https://lukesun.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://lukesun.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Luke Sun"}, {"url": "https://lukesun.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "141 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F7b5b79d21508&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcomparison-and-optimization-on-ml-models-for-loan-application-prediction-675923d83d04&user=Luke+Sun&userId=7b5b79d21508&source=post_page-7b5b79d21508--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F38f46069f6d3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcomparison-and-optimization-on-ml-models-for-loan-application-prediction-675923d83d04&newsletterV3=7b5b79d21508&newsletterV3Id=38f46069f6d3&user=Luke+Sun&userId=7b5b79d21508&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}