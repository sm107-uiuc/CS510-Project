{"url": "https://towardsdatascience.com/face-landmarks-detection-with-mediapipe-facemesh-555fa2e10b06", "time": 1683006714.981079, "path": "towardsdatascience.com/face-landmarks-detection-with-mediapipe-facemesh-555fa2e10b06/", "webpage": {"metadata": {"title": "Face landmarks detection with MediaPipe Facemesh | by Benson Ruan | Towards Data Science", "h1": "Face landmarks detection with MediaPipe Facemesh", "description": "Tensorflow.js released the MediaPipe Facemesh model in March, it is a lightweight machine learning pipeline predicting 486 3D facial landmarks to infer the surface geometry of a human face."}, "outgoing_paragraph_urls": [{"url": "https://github.com/tensorflow/tfjs-models/tree/master/facemesh", "anchor_text": "MediaPipe Facemesh", "paragraph_index": 0}, {"url": "https://github.com/bensonruan/", "anchor_text": "GitHub", "paragraph_index": 36}, {"url": "https://www.linkedin.com/in/benson-ruan/", "anchor_text": "Linkedin", "paragraph_index": 36}], "all_paragraphs": ["Tensorflow.js released the MediaPipe Facemesh model in March, it is a lightweight machine learning pipeline predicting 486 3D facial landmarks to infer the approximate surface geometry of a human face.", "During the pandemic time, I stay at home and play with this facemesh model. I would like to remind people of the importance of wearing a face mask. So I built a virtual face mask fitting room, which can detect face landmarks in an image or webcam stream, and put on the selected face mask on your face.", "Try it yourself in the link below :", "Wearing a face mask is a gesture of concern for one\u2019s community. It prevent the wearer from inadvertently passing the disease along to others. The virtual face mask fitting room utilizes an advanced technique called Face Landmark Detection, which can identify human faces in an image or video stream.", "If you are interested in building a face landmark detection app, please follow me below for the journey of how I implemented it.", "First of all, simply include the script Tensorflow.js and its facemesh model in the <head> section of the html file.", "Or you can install it via npm for use in a TypeScript / ES6 project", "The next thing we will need to do is to add the html <img> or <video> element as the source, so that we can perform face landmark detection on that image or webcam video stream.", "To stream your webcam into the browser, I utilize the npm JavaScript module webcam-easy.js, which provides an easy to use module that can access webcam and take a photo. To find out more details about that, please refer to my previous blog :", "In order to perform face landmark detection, we first need to load the pre-trained Facemesh model, by calling the API of facemesh.load(modelParams). FaceMesh comes with a few optional parameters of the model:", "\u2014 How many frames to go without running the bounding box detector. Only relevant if maxFaces > 1", "\u2014 Threshold for discarding a prediction", "\u2014 The maximum number of faces detected in the input. Should be set to the minimum number for performance", "\u2014 A float representing the threshold for deciding whether boxes overlap too much in non-maximum suppression. Must be between [0, 1]", "\u2014 A threshold for deciding when to remove boxes based on score in non-maximum suppression", "Next, we start to feed the image or webcam stream through the Facemesh model to perform face landmark detection, by calling the API of model.estimateFaces(inputElement). It takes an input image element (Can be a tensor, DOM element image, video, or canvas) and returns an array of facial landmark key points, bounding boxes and confidence level.", "The estimateFaces API comes with a few parameters of the model:", "\u2014 The image to classify. Can be a tensor, DOM element image, video, or canvas.", "\u2014 Whether to return tensors as opposed to values", "\u2014 Whether to flip/mirror the facial keypoints horizontally. Should be true for user facing webcam stream", "Return of predictions would look like:", "For each of the facial landmark key point, it contains the location of the x, y axis and depth.", "In the above function, we get 468 face landmark key points. For our face mask application, I utilize 4 of those landmarks:", "Then we can use those key points to calculate where we should overlay the face mask PNG image. We need to calculate 3 numbers below:", "Here is how I get the mask image with: use the Right Cheek landmark\u2019s x axis value \u2014 Left Cheek landmark\u2019s x axis value", "For the height and top-left corner location, there is a difference between Half mask and Full mask.", "\u2014 Top-left corner: {x: Forehead x axis value; y: Left Cheek y axis value}", "\u2014 Height: [Chin y axis value] \u2014 [Forehead y axis value]", "\u2014 Top-left corner: {x, y : Left landmark\u2019s x,y axis value}", "\u2014 Height: [Chin y axis value] \u2014 [Left Cheek y axis value]", "The last step is to overlay the face mask PNG image to the face.", "That\u2019s pretty much for the code! Now choose your favorite mask and try it on yourself!", "You can download the complete code of the above demo in the link below:", "Facemesh model is designed for front-facing cameras on mobile devices, where faces in view tend to occupy a relatively large fraction of the canvas. MediaPipe Facemesh may struggle to identify far-away faces.", "With fears of spreading the coronavirus at the forefront of everyone\u2019s minds, facial detection & recognition systems may be a safer, cleaner option than traditional bio-metric access control systems. This technology can not only reduce the risk of cross-infection but also improve traffic efficiency by more than 10 times, which will save time and reduce congestion.", "At last, I wish everyone to stay healthy and stay at home during the pandemic, let\u2019s utilize the latest machine learning technology to help us fight against the virus.", "Thank you for reading. If you like this article, please share on Facebook or Twitter. Let me know in the comment if you have any questions. Follow me on GitHub and Linkedin.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Diving into the world of Machine Learning and AI. Turning imagination into reality."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F555fa2e10b06&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fface-landmarks-detection-with-mediapipe-facemesh-555fa2e10b06&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fface-landmarks-detection-with-mediapipe-facemesh-555fa2e10b06&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fface-landmarks-detection-with-mediapipe-facemesh-555fa2e10b06&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fface-landmarks-detection-with-mediapipe-facemesh-555fa2e10b06&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----555fa2e10b06--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----555fa2e10b06--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@bensonruan?source=post_page-----555fa2e10b06--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@bensonruan?source=post_page-----555fa2e10b06--------------------------------", "anchor_text": "Benson Ruan"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fe20fb13f5d6b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fface-landmarks-detection-with-mediapipe-facemesh-555fa2e10b06&user=Benson+Ruan&userId=e20fb13f5d6b&source=post_page-e20fb13f5d6b----555fa2e10b06---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F555fa2e10b06&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fface-landmarks-detection-with-mediapipe-facemesh-555fa2e10b06&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F555fa2e10b06&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fface-landmarks-detection-with-mediapipe-facemesh-555fa2e10b06&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://pixabay.com/illustrations/hand-robot-human-machine-face-1571851/", "anchor_text": "pixabay.com"}, {"url": "https://github.com/tensorflow/tfjs-models/tree/master/facemesh", "anchor_text": "MediaPipe Facemesh"}, {"url": "https://bensonruan.com/face-mask-for-trump-with-face-landmark-detection/", "anchor_text": "Face Mask For Trump - with face landmark detection - Benson TechnologyThe Centers for Disease Control and Prevention (CDC) is recommending Americans wear masks in public to protect against\u2026bensonruan.com"}, {"url": "https://cdn.jsdelivr.net/npm/@tensorflow/tfjs-core", "anchor_text": "https://cdn.jsdelivr.net/npm/@tensorflow/tfjs-core"}, {"url": "https://cdn.jsdelivr.net/npm/@tensorflow/tfjs-converter", "anchor_text": "https://cdn.jsdelivr.net/npm/@tensorflow/tfjs-converter"}, {"url": "https://cdn.jsdelivr.net/npm/@tensorflow-models/facemesh", "anchor_text": "https://cdn.jsdelivr.net/npm/@tensorflow-models/facemesh"}, {"url": "https://medium.com/swlh/how-to-access-webcam-and-take-picture-with-javascript-b9116a983d78", "anchor_text": "How to access a webcam and take a picture with JavaScriptIntroduce webcam-easy npm modulemedium.com"}, {"url": "https://github.com/bensonruan/Face-Mask", "anchor_text": "Face MaskImage and Real time webcam face detection, protect yourself from COVID19 with a virtual face mask. Utilize tensorflowjs\u2026github.c"}, {"url": "https://github.com/bensonruan/", "anchor_text": "GitHub"}, {"url": "https://www.linkedin.com/in/benson-ruan/", "anchor_text": "Linkedin"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----555fa2e10b06---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/face-detection?source=post_page-----555fa2e10b06---------------face_detection-----------------", "anchor_text": "Face Detection"}, {"url": "https://medium.com/tag/computer-vision?source=post_page-----555fa2e10b06---------------computer_vision-----------------", "anchor_text": "Computer Vision"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----555fa2e10b06---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/programming?source=post_page-----555fa2e10b06---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F555fa2e10b06&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fface-landmarks-detection-with-mediapipe-facemesh-555fa2e10b06&user=Benson+Ruan&userId=e20fb13f5d6b&source=-----555fa2e10b06---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F555fa2e10b06&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fface-landmarks-detection-with-mediapipe-facemesh-555fa2e10b06&user=Benson+Ruan&userId=e20fb13f5d6b&source=-----555fa2e10b06---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F555fa2e10b06&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fface-landmarks-detection-with-mediapipe-facemesh-555fa2e10b06&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----555fa2e10b06--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F555fa2e10b06&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fface-landmarks-detection-with-mediapipe-facemesh-555fa2e10b06&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----555fa2e10b06---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----555fa2e10b06--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----555fa2e10b06--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----555fa2e10b06--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----555fa2e10b06--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----555fa2e10b06--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----555fa2e10b06--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----555fa2e10b06--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----555fa2e10b06--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@bensonruan?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@bensonruan?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Benson Ruan"}, {"url": "https://medium.com/@bensonruan/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "132 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fe20fb13f5d6b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fface-landmarks-detection-with-mediapipe-facemesh-555fa2e10b06&user=Benson+Ruan&userId=e20fb13f5d6b&source=post_page-e20fb13f5d6b--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F50a1e735bf91&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fface-landmarks-detection-with-mediapipe-facemesh-555fa2e10b06&newsletterV3=e20fb13f5d6b&newsletterV3Id=50a1e735bf91&user=Benson+Ruan&userId=e20fb13f5d6b&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}