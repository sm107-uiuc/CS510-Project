{"url": "https://towardsdatascience.com/music-tagging-using-convolutional-recurrent-neural-networks-e26a9856f9f5", "time": 1683016928.353933, "path": "towardsdatascience.com/music-tagging-using-convolutional-recurrent-neural-networks-e26a9856f9f5/", "webpage": {"metadata": {"title": "Music Tagging Using Convolutional (Recurrent) Neural Networks | by Tomasz Sala | Towards Data Science", "h1": "Music Tagging Using Convolutional (Recurrent) Neural Networks", "description": "Over the last few years, neural networks have become the go-to technique for various music classification tasks, one of them being automatic genre tagging. Such networks, when trained properly, are\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.aimusic.co.uk/", "anchor_text": "AI Music", "paragraph_index": 0}, {"url": "https://www.upf.edu/web/mtg/irmas", "anchor_text": "IRMAS", "paragraph_index": 3}, {"url": "http://tagatune.org/", "anchor_text": "MagnaTagATune", "paragraph_index": 3}, {"url": "https://www.aimusic.co.uk/newsletter-sign-up", "anchor_text": "newsletter at AI Music", "paragraph_index": 15}], "all_paragraphs": ["Over the last few years, neural networks have become the go-to technique for various music classification tasks, one of them being automatic genre tagging. Such networks, when trained properly, are powerful tools to enrich databases with metadata about audio files, i.e. tempo and musical key. At AI Music we need quick access to tools like these to use in our data pipelines. Examples of what a tagging tool could be used for: determining the bpm of a song in an automated \u2018DJ mix\u2019 in order to select a song of a fitting tempo that follows, or tagging and grouping our catalogue using key, tempo and other features.", "Apart from obtaining musical key and tempo data, neural networks also give the possibility to train a system to detect the genre, mood and instrumentation of a musical piece. More accurately, it is the Convolutional Recurrent Neural Network (CRNN) that has achieved very good results in music classification. Given a big enough, accordingly labeled dataset, a Convolutional Neural Network (CNN) can be trained to be used to achieve a highly accurate music tagging tool.", "In this article we will briefly explore two types of deep neural network architectures: CNN & CRNN and how they perform when trained using our datasets. Both the CNN and CRNN have been trained for the same tasks of classifying genre, mood and instrumentation. This has produced 6 models (3x CNN and 3x CRNN). The parameters of the architectures remained the same for each task, excluding some hyperparameters which have been optimised for each task individually.", "The data that has been used to train both architectures (CNN & CRNN) consists of a large amount of audio recordings with attached metadata containing the ground truths about the genre, mood and instrumentation of each recording. Among others, the IRMAS and MagnaTagATune datasets have been used for training. Each task has a different amount of classes: in our case the models have been trained on 30 different genres, 20 moods and 20 various instrumentation types. Here are some examples of classes for each task:", "Genre: rock, indie, drum and bass, techno", "Instrumentation: tuned percussion instruments, electric guitar, violin, saxophone", "Every class was randomly and evenly sampled to obtain a varied and non-skewed dataset. For faster training of the models, the data has been downsampled to 16,000 kHz and split into 30 second excerpts.", "In order for the model to learn meaningful information from the audio data, it needs various features on which it can base its weight adjustments. The most common form of feature extraction method for audio classification tasks is the mel spectrogram, which is a 2-dimensional matrix containing information about features of the audio which the models can learn from. By using the famous fourier transform algorithm, we can transform the audio signal from the time domain into the frequency domain. By taking the entire frequency spectrum and performing a mathematical operation on it, we convert it to the mel scale, so that equal differences in pitches sound equally different to the listener.", "A certain musical genre can have influences from other musical genres. A musical piece might have more than one mood associated with it. When detecting the most prominent instrument in a recording, you might want to know what the second, or even third detected instruments are. Multi-class classification can be defined as a problem where depending on an input x, the output is a distribution of probabilities for each class in y. By considering the tasks of tagging genres, moods and instruments as multi-label classification problems and assigning more than one ground truth to a high percentage of the audio tracks used for training, it is possible to get the probability values for i.e. the top 3 moods associated with a track.", "Since the rise of neural networks, there have been many different types of network architectures. One of the best-performing is CNN, also known as ConvNet. This architecture resembles the human visual cortex and performs convolution operations which reduce the dimensionality of the incoming data (images, in our case spectrograms) while extracting important features for classification. In short, the architecture is able to capture spatial and temporal dependencies in a spectrogram by applying relevant filters.", "The CRNN makes use of the CNN architecture for the task of feature extraction, while using gated recurrent units (GRU) placed at the end of the architecture to summarise the temporal information of the extracted features. The GRU unit is a simplified version of the long short-term memory unit (LSTM) and has been chosen because of its quicker training time and comparable results. It is a layer which is added on top of the CNN architecture in order to know how much of the past information from previous time steps to pass along to the future, and which information to drop. This makes it possible for the network to focus on features which it deems important. The CRNN is based on the CNN architecture used before, with a smaller convolution kernel size and the GRU units added after the 5th convolution layer.", "Hyperparameter optimisation is an important step in the training process. By doing this we make sure that we choose the right optimisation algorithm for our model and data to achieve the best possible results. In order to determine the best optimisation algorithm for each architecture, grid-based search optimisation has been performed. This has been done for the two most popular optimisers: Adam, which is a variation of the Root Mean Square Propagation (RMSProp) algorithm and the Adaptive Gradient Algorithm (AdaGrad). The second optimiser that was chosen is Stochastic Gradient Descent (SGD). The grid search has been done on different values for both optimisers, which have then been used to train a small subset of the data, outside of the test and training sets. ADAM was chosen for two out of three of the models.", "One would assume that a CRNN, after its good performance in the Natural Language Processing (NLP) field, and its ability to extract and summarise temporal information from spectrograms, would outperform the CNN in all tasks (genre, mood and instrumentation tagging). It turns out that a well-optimised CNN outperforms the CRNN in this case, especially when it comes to genre and mood. One could speculate that during the optimisation process, a better optimiser and set of hyperparameters have been obtained for the CNN. Since the models were not far off each other result-wise, running a few experiments with various optimisation techniques could prove the CRNN to be more effective.", "At AI. Music, in addition to examining the ROC-AUC scores, which are performance measurements, we like to evaluate a model by throwing big amounts of real world data at it. Below is a prediction made on Claude Debussy\u2019s \u2018Claire de Lune\u2019 through our genre, mood and instrumentation taggers. The order of the tags is from the highest to the lowest confidence value.", "Even though the CRNN outperforms the CNN on certain examples, the CNN is better at generalising and performs better on bigger and more varied amounts of data, which is why it has been incorporated into our pipeline. Due to having less layers, the model performs its predictions faster. An interesting thing to note is that the three architectures, even though similar, required different parameters on optimisers in order to achieve good results. The causes of this are yet to be explored in another article.", "Sign up to our newsletter at AI Music, to keep up to date with the research we do here and discover more about the company exploring the ways AI can help shape music production and delivery.", "Keunwoo Choi, Gyorgy Fazekas, Mark Sandler. \u201cAutomatic Tagging Using Deep Convolutional Neural Networks\u201d. (2016) Proceedings of the 17th ISMIR Conference (New York City, USA)", "Yoonchang Han, Jaehun Kim, and Kyogu Lee. \u201cDeep convolutional neural networks for predominant instrument recognition in polyphonic music\u201d. (2016) Journal of LATEX Class Files, VOL.14, NO.8", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Research Engineer at London based music tech start-up, AI. Music."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fe26a9856f9f5&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmusic-tagging-using-convolutional-recurrent-neural-networks-e26a9856f9f5&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmusic-tagging-using-convolutional-recurrent-neural-networks-e26a9856f9f5&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmusic-tagging-using-convolutional-recurrent-neural-networks-e26a9856f9f5&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmusic-tagging-using-convolutional-recurrent-neural-networks-e26a9856f9f5&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----e26a9856f9f5--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----e26a9856f9f5--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://tomasz-53044.medium.com/?source=post_page-----e26a9856f9f5--------------------------------", "anchor_text": ""}, {"url": "https://tomasz-53044.medium.com/?source=post_page-----e26a9856f9f5--------------------------------", "anchor_text": "Tomasz Sala"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fad7ae19203c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmusic-tagging-using-convolutional-recurrent-neural-networks-e26a9856f9f5&user=Tomasz+Sala&userId=ad7ae19203c&source=post_page-ad7ae19203c----e26a9856f9f5---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe26a9856f9f5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmusic-tagging-using-convolutional-recurrent-neural-networks-e26a9856f9f5&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe26a9856f9f5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmusic-tagging-using-convolutional-recurrent-neural-networks-e26a9856f9f5&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://www.aimusic.co.uk/", "anchor_text": "AI Music"}, {"url": "https://www.upf.edu/web/mtg/irmas", "anchor_text": "IRMAS"}, {"url": "http://tagatune.org/", "anchor_text": "MagnaTagATune"}, {"url": "https://medium.com/@RaghavPrabhu/understanding-of-convolutional-neural-network-cnn-deep-learning-99760835f148#:~:text=Convolution%20Layer,and%20a%20filter%20or%20kernel.", "anchor_text": "link"}, {"url": "https://medium.com/@RaghavPrabhu/understanding-of-convolutional-neural-network-cnn-deep-learning-99760835f148#:~:text=Convolution%20Layer,and%20a%20filter%20or%20kernel.", "anchor_text": "link"}, {"url": "https://www.aimusic.co.uk/newsletter-sign-up", "anchor_text": "newsletter at AI Music"}, {"url": "https://medium.com/criteo-labs/hyper-parameter-optimization-algorithms-2fe447525903", "anchor_text": "Hyper-parameter optimization algorithms: a short reviewAt Criteo AI labs, we are using more and more complex machine learning (ML) models every day. This means that we have\u2026medium.com"}, {"url": "https://medium.com/tag/convolution-neural-net?source=post_page-----e26a9856f9f5---------------convolution_neural_net-----------------", "anchor_text": "Convolution Neural Net"}, {"url": "https://medium.com/tag/ai?source=post_page-----e26a9856f9f5---------------ai-----------------", "anchor_text": "AI"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----e26a9856f9f5---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/audio?source=post_page-----e26a9856f9f5---------------audio-----------------", "anchor_text": "Audio"}, {"url": "https://medium.com/tag/recurrent-neural-network?source=post_page-----e26a9856f9f5---------------recurrent_neural_network-----------------", "anchor_text": "Recurrent Neural Network"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fe26a9856f9f5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmusic-tagging-using-convolutional-recurrent-neural-networks-e26a9856f9f5&user=Tomasz+Sala&userId=ad7ae19203c&source=-----e26a9856f9f5---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fe26a9856f9f5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmusic-tagging-using-convolutional-recurrent-neural-networks-e26a9856f9f5&user=Tomasz+Sala&userId=ad7ae19203c&source=-----e26a9856f9f5---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe26a9856f9f5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmusic-tagging-using-convolutional-recurrent-neural-networks-e26a9856f9f5&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----e26a9856f9f5--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fe26a9856f9f5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmusic-tagging-using-convolutional-recurrent-neural-networks-e26a9856f9f5&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----e26a9856f9f5---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----e26a9856f9f5--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----e26a9856f9f5--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----e26a9856f9f5--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----e26a9856f9f5--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----e26a9856f9f5--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----e26a9856f9f5--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----e26a9856f9f5--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----e26a9856f9f5--------------------------------", "anchor_text": ""}, {"url": "https://tomasz-53044.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://tomasz-53044.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Tomasz Sala"}, {"url": "https://tomasz-53044.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "6 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fad7ae19203c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmusic-tagging-using-convolutional-recurrent-neural-networks-e26a9856f9f5&user=Tomasz+Sala&userId=ad7ae19203c&source=post_page-ad7ae19203c--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fusers%2Fad7ae19203c%2Flazily-enable-writer-subscription&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmusic-tagging-using-convolutional-recurrent-neural-networks-e26a9856f9f5&user=Tomasz+Sala&userId=ad7ae19203c&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}