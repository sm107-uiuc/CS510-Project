{"url": "https://towardsdatascience.com/how-to-use-pyspark-for-your-machine-learning-project-19aa138e96ec", "time": 1683015904.535647, "path": "towardsdatascience.com/how-to-use-pyspark-for-your-machine-learning-project-19aa138e96ec/", "webpage": {"metadata": {"title": "How to Use Pyspark For Your Machine Learning Project | by Fran\u00e7ois St-Amant | Towards Data Science", "h1": "How to Use Pyspark For Your Machine Learning Project", "description": "Pyspark is a Python API that supports Apache Spark, a distributed framework made for handling big data analysis. It\u2019s an amazing framework to use when you are working with huge datasets, and it\u2019s\u2026"}, "outgoing_paragraph_urls": [], "all_paragraphs": ["Pyspark is a Python API that supports Apache Spark, a distributed framework made for handling big data analysis. It\u2019s an amazing framework to use when you are working with huge datasets, and it\u2019s becoming a must-have skill for any data scientist.", "In this tutorial, I will present how to use Pyspark to do exactly what you are used to see in a Kaggle notebook (cleaning, EDA, feature engineering and building models).", "I used a database containing information about customers for a telecom company. The objective is to predict which clients will leave (Churn) in the upcoming three months. The CSV file with the data contains more than 800,000 rows and 8 features, as well as a binary Churn variable.", "The goal here is not to find the best solution. It\u2019s rather to show you how to work with Pyspark. Along the way I will try to present many functions that can be used for all stages of your machine learning project!", "Let\u2019s begin by creating a SparkSession, which is the entry point to any Spark functionality.", "Here is how to read a CSV using Pyspark.", "Here is what the dataframe looks like.", "The Pyspark.sql module allows you to do in Pyspark pretty much anything that can be done with SQL.", "For instance, let\u2019s begin by cleaning the data a bit. First, as you can see in the image above, we have some Null values. I will drop all rows that contain a null value.", "Then, thewhen/otherwise functions allow you to filter a column and assign a new value based on what is found in each row. Here for instance, I replace Male and Female with 0 and 1 for the Sex variable.", "Once the data is all cleaned up, many SQL-like functions can help analyze it.", "For instance, the groupBy function allows you to group values and return count, sum or whatever for each category. Let\u2019s see how many data points belong to each class for the churn variable.", "We have imbalanced classes here. While I will not do anything about it in this tutorial, in an upcoming one, I will show you how to deal with imbalanced classes using Pyspark, doing things like undersampling, oversampling and SMOTE.", "Another interesting thing to do is to look at how certain features vary between the two groups (clients that left and the ones that did not). Here is one interesting result I found.", "We see that customers that left had on average a much smaller phone balance, which means their phone was much closer to being paid entirely (which makes it easier to leave a phone company of course).", "Now, let\u2019s look at a correlation matrix. I created it using the correlation function in Pyspark. I also cheated a bit and used Pandas here, just to easily create something much more visual.", "Again, phoneBalance has the strongest correlation with the churn variable.", "Considering the results from above, I decided to create a new variable, which will be the square of thephoneBalance variable. Here is how to do that with Pyspark.", "The withColumn function allows you to add columns to your pyspark dataframe. Super useful!", "The Machine Learning library in Pyspark certainly is not yet to the standard of Scikit Learn. With that being said, you can still do a lot of stuff with it.", "The first thing you have to do however is to create a vector containing all your features. All the methods we will use require it.", "Then, let\u2019s split the data into a training and validation set.", "Alright, now let\u2019s build some models. I will only show a couple models, just to give you an idea of how to do it with Pyspark.", "We can look at the ROC curve for the model. As a reminder, the closer the AUC (area under the curve) is to 1, the better the model is at distinguishing between classes.", "Let\u2019s do one more model, to showcase how easy it can be to fit models once the data is put in the right format for Pyspark, i.e. vectors. Here is how to create a random forest model.", "And here is how to get the AUC for the model:", "Both models are very similiar, but the results suggest that the logistic regression model is slightly better in our case.", "Scikit Learn is fantastic and will perform admirably, for as long as you are not working with too much data. Sadly, the bigger your projects, the more likely it is that you will need Spark. Thankfully, as you have seen here, the learning curve to start using Pyspark really isn\u2019t that steep, especially if you are familiar with Python and SQL. In my mind, the main weakness of Pyspark is data visualization, but hopefully with time that will change!", "There you have it. This article should serve as a great starting point for anyone that wants to do Machine Learning with Pyspark. I hope you liked it and thanks for reading!", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F19aa138e96ec&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-use-pyspark-for-your-machine-learning-project-19aa138e96ec&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-use-pyspark-for-your-machine-learning-project-19aa138e96ec&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-use-pyspark-for-your-machine-learning-project-19aa138e96ec&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-use-pyspark-for-your-machine-learning-project-19aa138e96ec&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----19aa138e96ec--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----19aa138e96ec--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://francoisstamant.medium.com/?source=post_page-----19aa138e96ec--------------------------------", "anchor_text": ""}, {"url": "https://francoisstamant.medium.com/?source=post_page-----19aa138e96ec--------------------------------", "anchor_text": "Fran\u00e7ois St-Amant"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F4f8974d28029&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-use-pyspark-for-your-machine-learning-project-19aa138e96ec&user=Fran%C3%A7ois+St-Amant&userId=4f8974d28029&source=post_page-4f8974d28029----19aa138e96ec---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F19aa138e96ec&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-use-pyspark-for-your-machine-learning-project-19aa138e96ec&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F19aa138e96ec&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-use-pyspark-for-your-machine-learning-project-19aa138e96ec&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/photos/Q1p7bh3SHj8", "anchor_text": "https://unsplash.com/photos/Q1p7bh3SHj8"}, {"url": "https://medium.com/tag/python?source=post_page-----19aa138e96ec---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/pyspark?source=post_page-----19aa138e96ec---------------pyspark-----------------", "anchor_text": "Pyspark"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----19aa138e96ec---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/big-data?source=post_page-----19aa138e96ec---------------big_data-----------------", "anchor_text": "Big Data"}, {"url": "https://medium.com/tag/apache-spark?source=post_page-----19aa138e96ec---------------apache_spark-----------------", "anchor_text": "Apache Spark"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F19aa138e96ec&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-use-pyspark-for-your-machine-learning-project-19aa138e96ec&user=Fran%C3%A7ois+St-Amant&userId=4f8974d28029&source=-----19aa138e96ec---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F19aa138e96ec&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-use-pyspark-for-your-machine-learning-project-19aa138e96ec&user=Fran%C3%A7ois+St-Amant&userId=4f8974d28029&source=-----19aa138e96ec---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F19aa138e96ec&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-use-pyspark-for-your-machine-learning-project-19aa138e96ec&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----19aa138e96ec--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F19aa138e96ec&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-use-pyspark-for-your-machine-learning-project-19aa138e96ec&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----19aa138e96ec---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----19aa138e96ec--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----19aa138e96ec--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----19aa138e96ec--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----19aa138e96ec--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----19aa138e96ec--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----19aa138e96ec--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----19aa138e96ec--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----19aa138e96ec--------------------------------", "anchor_text": ""}, {"url": "https://francoisstamant.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://francoisstamant.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Fran\u00e7ois St-Amant"}, {"url": "https://francoisstamant.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "501 Followers"}, {"url": "https://francoisstamant.medium.com/membership", "anchor_text": "https://francoisstamant.medium.com/membership"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F4f8974d28029&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-use-pyspark-for-your-machine-learning-project-19aa138e96ec&user=Fran%C3%A7ois+St-Amant&userId=4f8974d28029&source=post_page-4f8974d28029--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fc94c3a4f2e83&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-use-pyspark-for-your-machine-learning-project-19aa138e96ec&newsletterV3=4f8974d28029&newsletterV3Id=c94c3a4f2e83&user=Fran%C3%A7ois+St-Amant&userId=4f8974d28029&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}