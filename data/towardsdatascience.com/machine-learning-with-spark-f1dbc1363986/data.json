{"url": "https://towardsdatascience.com/machine-learning-with-spark-f1dbc1363986", "time": 1683013733.715826, "path": "towardsdatascience.com/machine-learning-with-spark-f1dbc1363986/", "webpage": {"metadata": {"title": "Machine Learning With Spark. A distributed Machine Learning\u2026 | by MA Raza, Ph.D. | Towards Data Science", "h1": "Machine Learning With Spark", "description": "This is a comprehensive tutorial on using the Spark distributed machine learning framework to build a scalable ML data pipeline. I will cover the basic machine learning algorithms implemented in\u2026"}, "outgoing_paragraph_urls": [{"url": "https://databricks.com/p/ebook/apache-spark-under-the-hood", "anchor_text": "Apache Spark and Delta Lake Under the Hood", "paragraph_index": 5}, {"url": "https://medium.com/analytics-vidhya/getting-started-spark3-0-0-with-google-colab-9796d350d78", "anchor_text": "Getting Started Spark 3.0.0 in Google Colab", "paragraph_index": 7}, {"url": "https://archive.ics.uci.edu/ml/datasets/iris", "anchor_text": "IRIS data", "paragraph_index": 31}, {"url": "https://archive.ics.uci.edu/ml/datasets/combined+cycle+power+plant", "anchor_text": "Combined Cycle Power Plant", "paragraph_index": 40}], "all_paragraphs": ["This is a comprehensive tutorial on using the Spark distributed machine learning framework to build a scalable ML data pipeline. I will cover the basic machine learning algorithms implemented in Spark MLlib library and through this tutorial, I will use the PySpark in python environment.", "Machine learning is getting popular in solving real-world problems in almost every business domain. It helps solve the problems using the data which is often unstructured, noisy, and in huge size. With the increase in data sizes and various sources of data, solving machine learning problems using standard techniques pose a big challenge. Spark is a distributed processing engine using the MapReduce framework to solve problems related to big data and processing of it.", "Spark framework has its own machine learning module called MLlib. In this article, I will use pyspark and spark MLlib to demonstrate the use of machine learning using distributed processing. Readers will be able to learn the below concept with real examples.", "A working google colab notebook will be provided to reproduce the results.", "Since this article is a hands-on tutorial covering the transformations, classification, clustering, and regression using pyspark in one session, the length of the article is longer than my previous articles. One benefit is that you can go through the basic concepts and implementation in one go.", "According to Apache Spark and Delta Lake Under the Hood", "Apache Spark is a unified computing engine and a set of libraries for parallel data processing on computer clusters. As of the time this writing, Spark is the most actively developed open source engine for this task; making it the de facto tool for any developer or data scientist interested in big data. Spark supports multiple widely used programming languages (Python, Java, Scala and R), includes libraries for diverse tasks ranging from SQL to streaming and machine learning, and runs anywhere from a laptop to a cluster of thousands of servers. This makes it an easy system to start with and scale up to big data processing or incredibly large scale.", "As a first step, I configure the google colab runtime with spark installation. For details, readers may read my article Getting Started Spark 3.0.0 in Google Colab om medium.", "We will install the below programs", "you can install the LATEST version of Spark using the below set of commands.", "After installing the spark and Java, set the environment variables where Spark and Java are installed.", "Let us test the installation of spark in our google colab environment.", "Once, we have set up the spark in google colab and made sure it is running with the correct version i.e. 3.0.1 in this case, we can start exploring the machine learning API developed on top of Spark. PySpark is a higher level Python API to use spark with python. For this tutorial, I assume the readers have a basic understanding of Machine Learning and SK-Learn for model building and training. Spark MLlib used the same fit and predict structure as in SK-Learn.", "In order to reproduce the results, I have uploaded the data to my GitHub and can be accessed easily.", "Learn by Doing: Use the colab notebook to run it yourself", "This section covers the basic steps involved in transformations of input feature data into the format Machine Learning algorithms accept. We will be covering the transformations coming with the SparkML library. To understand or read more about the available spark transformations in 3.0.3, follow the below link.", "MinMaxScaler is one of the favorite classes shipped with most machine learning libraries. It scaled the data between 0 and 1.", "StandardScaler is another well-known class written with machine learning libraries. It normalizes the data between -1 and 1 and converts the data into bell-shaped data. You can demean the data and scale to some variance.", "The real data sets come with various ranges and sometimes it is advisable to transform the data into well-defined buckets before plugging into machine learning algorithms.", "Bucketizer class is handy to transform the data into various buckets.", "Natural Language Processing is one of the main applications of Machine learning. One of the first steps for NLP is tokenizing the text into words or token. We can utilize the Tokenizer class with SparkML to perform this task.", "Term frequency-inverse document frequency (TF-IDF) is a feature vectorization method widely used in text mining to reflect the importance of a term to a document in the corpus. Using the above-tokenized data, Let us apply the TF-IDF", "User can play with various transformations depending on the requirements of the problem in-hand.", "Clustering is a machine learning technique where the data is grouped into a reasonable number of classes using the input features. In this section, we study the basic application of clustering techniques using the spark ML framework.", "Load the clustering data stored in csv format using spark", "Convert the tabular data into vectorized format using VectorAssembler", "Once the data is prepared into the format MLlib can use for models, now we can define and train the clustering algorithm such as K-Means. We can define the number of clusters and initialize the seed as done below.", "After training has been finished, let us print the centers.", "There are various kinds of clustering algorithms implemented in MLlib. Bisecting K-Means Clustering is another popular method.", "To read more about the clustering methods implemented in MLlib, follow the below link.", "Classification is one of the widely used Machine algorithms and almost every data engineer and data scientist must know about these algorithms. Once the data is loaded and prepared, I will demonstrate three classification algorithms.", "We explore the supervised classification algorithms using IRIS data. I have uploaded the data into my GitHub to reproduce the results. Users can download the data using the below command.", "In this section, we will be using the IRIS data to understand the classification. To perform ML models, we apply the preprocessing step on our input data.", "Once the data is prepared, we are ready to apply the first classification algorithm.", "Let us Evaluate the trained classifier", "The second classifier we will be investigating is a Multi-layer perceptron. In this tutorial, I am not going into details of the optimal MLP network for this problem however in practice, you research the optimal network suitable to the problem in hand.", "Another common classifier in the ML family is the Decision Tree Classifier, in this section, we explore this classifier.", "Apart from the above three demonstrated classification algorithms, Spark MLlib has also many other implementations of classification algorithms. Details of the implemented classification algorithms can be found at below link", "It is highly recommended to try some of the classification algorithms to get hands-on.", "In this section, we explore the Machine learning models for regression problems using pyspark. Regression models are helpful in predicting future values using past data.", "We will use the Combined Cycle Power Plant data set to predict the net hourly electrical output (EP). I have uploaded the data to my GitHub so that users can reproduce the results.", "We start with the simplest regression technique i.e. Linear Regression.", "In this section, we explore the Decision Tree Regression commonly used in Machine learning.", "Gradient Boosting is another common choice among ML professionals. Let us try the GBM in this section.", "Apart from the above-demonstrated regression algorithms, Spark MLlib has also many other implementations of regression algorithms. Details of the implemented regression algorithms can be found at the below link.", "It is highly recommended to try some of the regression algorithms to get hands-on and play with the parameters.", "In this tutorial, I have tried to give the readers an opportunity to learn and implement basic Machine Learning algorithms using PySpark. Spark not only provide the benefit of distributed processing but also can handle a large amount of data to be processing. To summarise, we have covered below topics/algorithms", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Engineer | Data Scientist | ML Researcher | Educator"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Ff1dbc1363986&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-with-spark-f1dbc1363986&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-with-spark-f1dbc1363986&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-with-spark-f1dbc1363986&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-with-spark-f1dbc1363986&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----f1dbc1363986--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----f1dbc1363986--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@amjadraza24?source=post_page-----f1dbc1363986--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@amjadraza24?source=post_page-----f1dbc1363986--------------------------------", "anchor_text": "MA Raza, Ph.D."}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F43f78dfb3de3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-with-spark-f1dbc1363986&user=MA+Raza%2C+Ph.D.&userId=43f78dfb3de3&source=post_page-43f78dfb3de3----f1dbc1363986---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ff1dbc1363986&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-with-spark-f1dbc1363986&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ff1dbc1363986&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-with-spark-f1dbc1363986&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://databricks.com/p/ebook/apache-spark-under-the-hood", "anchor_text": "Apache Spark and Delta Lake Under the Hood"}, {"url": "https://medium.com/analytics-vidhya/getting-started-spark3-0-0-with-google-colab-9796d350d78", "anchor_text": "Getting Started Spark 3.0.0 in Google Colab"}, {"url": "https://github.com/minrk/findspark", "anchor_text": "Findspark"}, {"url": "https://spark.apache.org/docs/3.0.1/ml-features.html", "anchor_text": "Extracting, transforming and selecting featuresThis section covers algorithms for working with features, roughly divided into these groups: Extraction: Extracting\u2026spark.apache.org"}, {"url": "https://spark.apache.org/docs/3.0.1/ml-clustering.html", "anchor_text": "ClusteringThis page describes clustering algorithms in MLlib. The guide for clustering in the RDD-based API also has relevant\u2026spark.apache.org"}, {"url": "https://archive.ics.uci.edu/ml/datasets/iris", "anchor_text": "IRIS data"}, {"url": "https://spark.apache.org/docs/3.0.1/ml-classification-regression.html#classification", "anchor_text": "Classification and regression ewcommand{\\R}{\\mathbb{R}} ewcommand{\\E}{\\mathbb{E}} ewcommand{\\x}{\\mathbf{x}} ewcommand{\\y}{\\mathbf{y}}\u2026spark.apache.org"}, {"url": "https://archive.ics.uci.edu/ml/datasets/combined+cycle+power+plant", "anchor_text": "Combined Cycle Power Plant"}, {"url": "https://spark.apache.org/docs/3.0.1/ml-classification-regression.html#regression", "anchor_text": "Classification and regression ewcommand{\\R}{\\mathbb{R}} ewcommand{\\E}{\\mathbb{E}} ewcommand{\\x}{\\mathbf{x}} ewcommand{\\y}{\\mathbf{y}}\u2026spark.apache.org"}, {"url": "https://spark.apache.org/docs/latest/ml-features.html", "anchor_text": "https://spark.apache.org/docs/latest/ml-features.html"}, {"url": "https://spark.apache.org/docs/3.0.1/ml-classification-regression.html#regression", "anchor_text": "https://spark.apache.org/docs/3.0.1/ml-classification-regression.html#regression"}, {"url": "https://spark.apache.org/docs/3.0.1/ml-clustering.html", "anchor_text": "https://spark.apache.org/docs/3.0.1/ml-clustering.html"}, {"url": "https://spark.apache.org/docs/3.0.1/ml-classification-regression.html#classification", "anchor_text": "https://spark.apache.org/docs/3.0.1/ml-classification-regression.html#classification"}, {"url": "https://medium.com/tag/data-science?source=post_page-----f1dbc1363986---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----f1dbc1363986---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/spark?source=post_page-----f1dbc1363986---------------spark-----------------", "anchor_text": "Spark"}, {"url": "https://medium.com/tag/pyspark?source=post_page-----f1dbc1363986---------------pyspark-----------------", "anchor_text": "Pyspark"}, {"url": "https://medium.com/tag/big-data?source=post_page-----f1dbc1363986---------------big_data-----------------", "anchor_text": "Big Data"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Ff1dbc1363986&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-with-spark-f1dbc1363986&user=MA+Raza%2C+Ph.D.&userId=43f78dfb3de3&source=-----f1dbc1363986---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Ff1dbc1363986&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-with-spark-f1dbc1363986&user=MA+Raza%2C+Ph.D.&userId=43f78dfb3de3&source=-----f1dbc1363986---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ff1dbc1363986&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-with-spark-f1dbc1363986&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----f1dbc1363986--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Ff1dbc1363986&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-with-spark-f1dbc1363986&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----f1dbc1363986---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----f1dbc1363986--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----f1dbc1363986--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----f1dbc1363986--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----f1dbc1363986--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----f1dbc1363986--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----f1dbc1363986--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----f1dbc1363986--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----f1dbc1363986--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@amjadraza24?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@amjadraza24?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "MA Raza, Ph.D."}, {"url": "https://medium.com/@amjadraza24/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "176 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F43f78dfb3de3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-with-spark-f1dbc1363986&user=MA+Raza%2C+Ph.D.&userId=43f78dfb3de3&source=post_page-43f78dfb3de3--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F3cd60c3ab90f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-with-spark-f1dbc1363986&newsletterV3=43f78dfb3de3&newsletterV3Id=3cd60c3ab90f&user=MA+Raza%2C+Ph.D.&userId=43f78dfb3de3&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}