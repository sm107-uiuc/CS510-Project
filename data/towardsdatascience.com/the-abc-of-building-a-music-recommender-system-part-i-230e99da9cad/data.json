{"url": "https://towardsdatascience.com/the-abc-of-building-a-music-recommender-system-part-i-230e99da9cad", "time": 1683004050.873816, "path": "towardsdatascience.com/the-abc-of-building-a-music-recommender-system-part-i-230e99da9cad/", "webpage": {"metadata": {"title": "The ABC of building a content-based music recommender system | by Euge Inzaugarat | Towards Data Science", "h1": "The ABC of building a content-based music recommender system", "description": "Content-based methods give recommendations based on two items similarity. Here, you can read the steps to generate a content-based music recommender using keyword matching."}, "outgoing_paragraph_urls": [{"url": "https://www.kaggle.com/mousehead/songlyrics/data#", "anchor_text": "following dataset", "paragraph_index": 43}, {"url": "https://towardsdatascience.com/keras-challenges-the-avengers-541346acb804#c739", "anchor_text": "Twitter sentiment analysis", "paragraph_index": 46}, {"url": "https://towardsdatascience.com/how-to-measure-distances-in-machine-learning-13a396aa34ce", "anchor_text": "cosine similarity, or Euclidean distance", "paragraph_index": 57}, {"url": "https://towardsdatascience.com/how-to-measure-distances-in-machine-learning-13a396aa34ce#06cb", "anchor_text": "cosine similarity", "paragraph_index": 58}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.metrics.pairwise.cosine_similarity.html", "anchor_text": "implementation", "paragraph_index": 58}, {"url": "https://github.com/ugis22/music_recommender", "anchor_text": "GitHub Repo", "paragraph_index": 66}, {"url": "https://www.youtube.com/watch?v=9siFuMMHNIA&list=PLLssT5z_DsK-h9vYZkQkYNWcItqhlRJLN&index=97", "anchor_text": "Lecture", "paragraph_index": 76}], "all_paragraphs": ["I want to wake up in a pleasant world", "This is my dream and of many more", "\u2026 \u201c \u2014 These are the lyrics I remember the most from my first rock concert.", "I was 8 years old. Yes, you read correctly. My father took me to see one of Argentina\u2019s most famous bands. It was its last show.", "Rock music was serious stuff in my family. My house was full of CDs. I still remember the 5-discs CD player we had.", "You could put five CDs and program it to shuffle between songs and CDs. It was awesome at the time.", "In the 90s, little I could imagine that I would be accessing hundreds of thousands of songs one click away.", "Let alone that the app could recommend me different songs based on my preferences and playlists using machine learning.", "Yes. One of the most used machine learning algorithms is recommendation systems.", "In a broad sense, a recommender (or recommendation) system (or engine) is a filtering system which aim is to predict a rating or preference a user would give to an item: a song, in our case.", "There are several types of recommender systems, among which the more used ones are content-based filters and collaborative filters.", "Recommendation systems are used broadly and for many types of items nowadays. But we are going to explain and implement them in terms of song recommendations.", "Content-based methods gives recommendations based on the similarity of two song contents or attributes while collaborative methods make a prediction on posible preferences using a matrix with ratings on different songs.", "We are interested in analyzing how content-based filters work. The word content in the name points to the content or set of attributes of a song that a user likes.", "Recommendations done using content-based recommenders can be seen as a user-specific classification problem. This classifier learns the user\u2019s likes and dislikes from the features of the song.", "Most of the people have a profile in music streaming services. When they created their account, they filled details about them.", "They log-in to their accounts to listen to songs they like or save songs in a playlist to listen later on or repeatedly.", "In this context, there are several ways to build a content-based algorithm to recommend a song to a user.", "The most straightforward approach is keyword matching.", "In a few words, the idea behind is to extract meaningful keywords present in a song description a user likes, search for the keywords in other song descriptions to estimate similarities among them, and based on that, recommend those songs to the user.", "So, a content-based recommendation algorithm has to perform the following two steps.", "First, extract features out of the content of the song descriptions to create an object representation.", "Second, define a similarity function among these object representations which mimics what human understands as an item-item similarity.", "How is this performed, then? \u2014 you might be wondering \u2014", "In our case, because we are working with text and words, Term Frequency-Inverse Document Frequency (TF-IDF) can be used for this matching process.", "TF-IDF is a technique used for information retrieval. It weights a term\u2019s frequency (TF) and its inverse document frequency (IDF); two concepts that we are going to explain later.", "The algorithm finds the score for TF and IDF for each term in the document.", "After that, the product of TF and IDF of each word is obtained. This is called the TF-IDF weight of that term.", "Can we put these is simpler terms? \u2014 yes, of course.", "When we use this technique, we are just counting the occurrence of each keyword in a document, and finding its importance by calculating the TF-IDF score for that document.", "The higher the TF*IDF score, the more strange is that word in that context and thus, the more important the term.", "Now, let\u2019s explain what term frequency means.", "The Term frequency of a word in the current document is solely the number of times that it appears to the total number of words in a document.", "For example, for the word music in the document I love music because it makes me feel like I can fly", "TF(music) = Number of times music appears/Total number of words = 1/12", "Simple, right? But what about inverse document frequency?", "Inverse document frequency of a term is the measure of how significant that term is in the whole corpus.", "It is defined as the total number of documents in a corpus to the frequency occurrence of documents that do contain the term following the formula:", "IDF = log(Total number of documents/Number of documents containing the term)", "If a word is very rare, it means that it has fewer occurrences, and as a consequence, the IDF increases.", "Because the TF-IDF score is used to evaluate how important a word is to a document in a corpus, the importance of that word increases when the number of occurrences increases but it is offset by the frequency of the word in the corpus.", "If we calculate the TF-IDF score for each word, we have a vector that is commonly called the TF-IDF Vector.", "Great! But How do we translate this into Python code?", "So imagine that we have the following dataset.", "This dataset contains name, artist, and lyrics for 57650 songs in English. The data has been acquired from LyricsFreak through scraping.", "We want to build a content-based recommendation system using the TF-IDF technique.", "We have already used the TF-IDF score before. Remember when we performed Twitter sentiment analysis?", "Likewise, we are going to use TfidfVectorizer from the Scikit-learn package.", "And as always, pandas will help us read the dataset into a DataFrame.", "Because of the dataset being so big, we are going to resample only 5000 random songs.", "We can notice also the presence of \\n in the text, so we are going to remove it.", "After that, we use TF-IDF vectorizerthat calculates the TF-IDF score for each song lyric, word-by-word.", "Here, we pay particular attention to the arguments we can specify:", "We create a lyric_matrix variable where we store the matrix containing each word and its TF-IDF score with regard to each song lyric.", "But now, the following question arises:", "\u2014 How do we use this matrix for a recommendation? \u2014", "The answer is a word: similarity. We now need to calculate the similarity of one lyric to another.", "For this aim, we can use different metrics such as cosine similarity, or Euclidean distance, among others.", "For our song recommendation system, we are going to use cosine similarity and particularly, its implementation from Scikit-learn.", "We want to calculate the cosine similarity of each item with every other item in the dataset. So we just pass the lyrics_matrix as argument.", "Once we get the similarities, we\u2019ll store in a dictionary called similarities, the names of the 50 most similar songs for each song in our dataset.", "After that, all the magic happens. We can use that similarity scores to access the most similar items and give a recommendation.", "First, we\u2019ll define our Content-based recommender class.", "And, now we are ready to pick a song from the dataset and make a recommendation.", "And we can pick another random song and recommend again:", "This is a very simple content-based recommendation system, and there is a lot of room for improvement and experimentation.", "If you want to have a better view of the code, you can check my GitHub Repo.", "As you can observe, content-based methods are computationally fast and interpretable. Moreover, they can be scalable and efficiently adapted to new items or users.", "Moreover, the generated recommendations are to some extent not biased towards well-known or popular items.", "However, one of the biggest limitations of content-based recommendation systems is that the model only learns to recommend items of the same type that the user is already using or, in our case, listening to.", "Even though this could be helpful, the value of that recommendation is significantly less because it lacks the surprise component of discovering something completely new.", "Last, this type of recommendation system is not able to capture any contextual or cultural information. Only information that can be derived from the content of a song can be obtained and used to generate recommendations.", "You may say I\u2019m a dreamer", "But I\u2019m not the only one", "\u2026.\u201d \u2014 Another song started to play in my mind.", "Picked by my own mental content-based recommendation system.", "Artificial Intelligence-All in One. Lecture 16.2", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F230e99da9cad&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-abc-of-building-a-music-recommender-system-part-i-230e99da9cad&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-abc-of-building-a-music-recommender-system-part-i-230e99da9cad&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-abc-of-building-a-music-recommender-system-part-i-230e99da9cad&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-abc-of-building-a-music-recommender-system-part-i-230e99da9cad&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----230e99da9cad--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----230e99da9cad--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://eugeniainzaugarat.medium.com/?source=post_page-----230e99da9cad--------------------------------", "anchor_text": ""}, {"url": "https://eugeniainzaugarat.medium.com/?source=post_page-----230e99da9cad--------------------------------", "anchor_text": "Euge Inzaugarat"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F5515433d5913&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-abc-of-building-a-music-recommender-system-part-i-230e99da9cad&user=Euge+Inzaugarat&userId=5515433d5913&source=post_page-5515433d5913----230e99da9cad---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F230e99da9cad&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-abc-of-building-a-music-recommender-system-part-i-230e99da9cad&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F230e99da9cad&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-abc-of-building-a-music-recommender-system-part-i-230e99da9cad&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@mohammad_leo?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Mohammad Metri"}, {"url": "https://unsplash.com/?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://www.kaggle.com/mousehead/songlyrics/data#", "anchor_text": "following dataset"}, {"url": "https://towardsdatascience.com/keras-challenges-the-avengers-541346acb804#c739", "anchor_text": "Twitter sentiment analysis"}, {"url": "https://towardsdatascience.com/how-to-measure-distances-in-machine-learning-13a396aa34ce", "anchor_text": "cosine similarity, or Euclidean distance"}, {"url": "https://towardsdatascience.com/how-to-measure-distances-in-machine-learning-13a396aa34ce#06cb", "anchor_text": "cosine similarity"}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.metrics.pairwise.cosine_similarity.html", "anchor_text": "implementation"}, {"url": "https://github.com/ugis22/music_recommender", "anchor_text": "GitHub Repo"}, {"url": "https://www.youtube.com/watch?v=9siFuMMHNIA&list=PLLssT5z_DsK-h9vYZkQkYNWcItqhlRJLN&index=97", "anchor_text": "Lecture"}, {"url": "https://towardsdatascience.com/introduction-to-two-approaches-of-content-based-recommendation-system-fc797460c18c", "anchor_text": "Content-based algorithm"}, {"url": "https://towardsdatascience.com/recommender-systems-in-practice-cef9033bb23a", "anchor_text": "Recommender Systems in Practice"}, {"url": "https://medium.com/towards-artificial-intelligence/content-based-recommender-system-4db1b3de03e7", "anchor_text": "Content-based recommendation systems"}, {"url": "https://medium.com/tag/data-science?source=post_page-----230e99da9cad---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----230e99da9cad---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/technology?source=post_page-----230e99da9cad---------------technology-----------------", "anchor_text": "Technology"}, {"url": "https://medium.com/tag/education?source=post_page-----230e99da9cad---------------education-----------------", "anchor_text": "Education"}, {"url": "https://creativecommons.org/licenses/by-sa/4.0/", "anchor_text": "Some rights reserved"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F230e99da9cad&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-abc-of-building-a-music-recommender-system-part-i-230e99da9cad&user=Euge+Inzaugarat&userId=5515433d5913&source=-----230e99da9cad---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F230e99da9cad&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-abc-of-building-a-music-recommender-system-part-i-230e99da9cad&user=Euge+Inzaugarat&userId=5515433d5913&source=-----230e99da9cad---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F230e99da9cad&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-abc-of-building-a-music-recommender-system-part-i-230e99da9cad&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----230e99da9cad--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F230e99da9cad&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-abc-of-building-a-music-recommender-system-part-i-230e99da9cad&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----230e99da9cad---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----230e99da9cad--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----230e99da9cad--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----230e99da9cad--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----230e99da9cad--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----230e99da9cad--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----230e99da9cad--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----230e99da9cad--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----230e99da9cad--------------------------------", "anchor_text": ""}, {"url": "https://eugeniainzaugarat.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://eugeniainzaugarat.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Euge Inzaugarat"}, {"url": "https://eugeniainzaugarat.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "640 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F5515433d5913&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-abc-of-building-a-music-recommender-system-part-i-230e99da9cad&user=Euge+Inzaugarat&userId=5515433d5913&source=post_page-5515433d5913--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F1ad8e6e46454&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-abc-of-building-a-music-recommender-system-part-i-230e99da9cad&newsletterV3=5515433d5913&newsletterV3Id=1ad8e6e46454&user=Euge+Inzaugarat&userId=5515433d5913&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}