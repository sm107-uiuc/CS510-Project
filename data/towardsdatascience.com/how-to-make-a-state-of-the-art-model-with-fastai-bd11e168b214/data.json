{"url": "https://towardsdatascience.com/how-to-make-a-state-of-the-art-model-with-fastai-bd11e168b214", "time": 1683018427.4010382, "path": "towardsdatascience.com/how-to-make-a-state-of-the-art-model-with-fastai-bd11e168b214/", "webpage": {"metadata": {"title": "How to Make a State of the Art Model with Fastai | by Yash Prakash | Towards Data Science", "h1": "How to Make a State of the Art Model with Fastai", "description": "When I first started my journey with fastai, I was very excited to build and train a deep learning model that could give amazing results in a short span of time. Now that we\u2019ve seen some under the\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.amazon.com/Deep-Learning-Coders-fastai-PyTorch/dp/1492045527", "anchor_text": "in his book", "paragraph_index": 6}, {"url": "https://yashprakash.substack.com", "anchor_text": "Join my Codecast!", "paragraph_index": 24}, {"url": "https://twitter.com/csandyash", "anchor_text": "Twitter", "paragraph_index": 25}, {"url": "https://www.linkedin.com/in/yashprakash13/", "anchor_text": "LinkedIn", "paragraph_index": 25}, {"url": "https://codecast.substack.com", "anchor_text": "https://codecast.substack.com", "paragraph_index": 27}], "all_paragraphs": ["When I first started my journey with fastai, I was very excited to build and train a deep learning model that could give amazing results in a short span of time. Now that we\u2019ve seen some under the hood training jargon that fastai uses along with some Pytorch essential functions, it is now time to see what results a little more effort into building the model yields.", "I\u2019ll be linking my previous articles in which I document my learning with fastai at the end of this article. :)", "We will need this data to get started. It is from the Rock, Paper, Scissors dataset from Kaggle. This task becomes a multi-class image classification problem with three classes (each with train, valid, test folders) containing RGB colour images of size 300x300.", "Specify the import function for all things fastai vision and set the path variable.", "Now we shall define a datablock for getting the data from the folders. We specify these to make sure our data is available to the model while writing minimal code:", "This will return a dataloader that will give us a batch size of bs and an image size of size.", "As Jeremy Howard says in his book: start training using small images, and end training using large images. Spending most of the epochs training with small images, helps training complete much faster. Completing training using large images makes the final accuracy much higher.", "This is an experimental technique that has been proving to be extremely useful in getting much higher accuracies than when otherwise done with the same sizes of images throughout.", "Let\u2019s now see how can be train in multiple sizes, shall we?", "We\u2019ll get the batch size as 64 and image size as smaller 128x128.", "Now let\u2019s go ahead and calculate what learning rate we should use for this part of the training.", "First, we make a model by utilising transfer learning with the following line.", "Then, we plot a graph to see about finding the learning rate.", "The output looks like this, with a clear visualisation of what our losses will look like if we take a specific value of the learning rate.", "Looks like taking a learning rate of around 1e-3 will be enough to make sure our losses decrease with training. We\u2019ll choose that.", "We see quite remarkable results in the first few epochs itself.", "Note: I trained the model on the GPU which is why it only takes mere seconds with each epoch.", "If you were to train on the CPU only, it\u2019ll take much longer, sometimes even ~10 minutes approx for each epoch.", "Now that we have the model trained on the smaller image sizes, we can proceed to the second part of the training.", "We use the batch size as 128 and our image sizes as 224 for our next fine tuning of the model.", "This, as you can infer, yields us an accuracy of almost 95% in our training and it only takes about three minutes to train on the GPU!", "Fastai enables us with the ability for rapid development of any deep learning task, and as I\u2019ve experimented with it in the previous weeks, I\u2019ve found myself being more and more in love with its super simple approach. If you\u2019re keen to follow along this journey with me, make sure to follow me for continued updates as I explore more deep learning tasks with this amazing library.", "As I promised earlier, here are the other articles I\u2019ve written for fastai. Happy coding! \ud83d\ude01", "Also, here is the GitHub repo link with all of the code:", "Do you want to get one free, clean email from me every week or two weeks containing the best of my curated articles and tutorials that I publish? Join my Codecast!", "Connect with me on Twitter and LinkedIn!", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Top Writer in AI | Telling stories about \u2014 Full stack Python, ML, Go, SQL, and system design | Read my articles: https://codecast.substack.com"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fbd11e168b214&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-make-a-state-of-the-art-model-with-fastai-bd11e168b214&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-make-a-state-of-the-art-model-with-fastai-bd11e168b214&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-make-a-state-of-the-art-model-with-fastai-bd11e168b214&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-make-a-state-of-the-art-model-with-fastai-bd11e168b214&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://me.dm/@ipom", "anchor_text": "Mastodon"}, {"url": "https://towardsdatascience.com/?source=post_page-----bd11e168b214--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----bd11e168b214--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://ipom.medium.com/?source=post_page-----bd11e168b214--------------------------------", "anchor_text": ""}, {"url": "https://ipom.medium.com/?source=post_page-----bd11e168b214--------------------------------", "anchor_text": "Yash Prakash"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F9ba949960063&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-make-a-state-of-the-art-model-with-fastai-bd11e168b214&user=Yash+Prakash&userId=9ba949960063&source=post_page-9ba949960063----bd11e168b214---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fbd11e168b214&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-make-a-state-of-the-art-model-with-fastai-bd11e168b214&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fbd11e168b214&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-make-a-state-of-the-art-model-with-fastai-bd11e168b214&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@amyhirschi?utm_source=medium&utm_medium=referral", "anchor_text": "Amy Hirschi"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://www.amazon.com/Deep-Learning-Coders-fastai-PyTorch/dp/1492045527", "anchor_text": "in his book"}, {"url": "https://towardsdatascience.com/a-fast-introduction-to-fastai-my-experience-b18d4457f6a5", "anchor_text": "A Fast Introduction to FastAI \u2014 My Experience"}, {"url": "https://towardsdatascience.com/fastai-exploring-the-training-process-the-pixel-similarity-approach-74bbdb844509", "anchor_text": "Fastai \u2014 Exploring the Training Process \u2014 the Pixel Similarity approach"}, {"url": "https://towardsdatascience.com/fastai-multi-class-classification-with-stochastic-gradient-descent-from-scratch-8410fe3fea22", "anchor_text": "Fastai \u2014 Multi-class Classification with Stochastic Gradient Descent from Scratch"}, {"url": "https://github.com/yashprakash13/RockPaperScissorsFastAI", "anchor_text": "yashprakash13/RockPaperScissorsFastAIContribute to yashprakash13/RockPaperScissorsFastAI development by creating an account on GitHub.github.com"}, {"url": "https://yashprakash.substack.com", "anchor_text": "Join my Codecast!"}, {"url": "https://twitter.com/csandyash", "anchor_text": "Twitter"}, {"url": "https://www.linkedin.com/in/yashprakash13/", "anchor_text": "LinkedIn"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----bd11e168b214---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/neural-networks?source=post_page-----bd11e168b214---------------neural_networks-----------------", "anchor_text": "Neural Networks"}, {"url": "https://medium.com/tag/image-classification?source=post_page-----bd11e168b214---------------image_classification-----------------", "anchor_text": "Image Classification"}, {"url": "https://medium.com/tag/fastai?source=post_page-----bd11e168b214---------------fastai-----------------", "anchor_text": "Fastai"}, {"url": "https://medium.com/tag/convolutional-network?source=post_page-----bd11e168b214---------------convolutional_network-----------------", "anchor_text": "Convolutional Network"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fbd11e168b214&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-make-a-state-of-the-art-model-with-fastai-bd11e168b214&user=Yash+Prakash&userId=9ba949960063&source=-----bd11e168b214---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fbd11e168b214&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-make-a-state-of-the-art-model-with-fastai-bd11e168b214&user=Yash+Prakash&userId=9ba949960063&source=-----bd11e168b214---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fbd11e168b214&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-make-a-state-of-the-art-model-with-fastai-bd11e168b214&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----bd11e168b214--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fbd11e168b214&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-make-a-state-of-the-art-model-with-fastai-bd11e168b214&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----bd11e168b214---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----bd11e168b214--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----bd11e168b214--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----bd11e168b214--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----bd11e168b214--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----bd11e168b214--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----bd11e168b214--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----bd11e168b214--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----bd11e168b214--------------------------------", "anchor_text": ""}, {"url": "https://ipom.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://ipom.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Yash Prakash"}, {"url": "https://ipom.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "1K Followers"}, {"url": "https://codecast.substack.com", "anchor_text": "https://codecast.substack.com"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F9ba949960063&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-make-a-state-of-the-art-model-with-fastai-bd11e168b214&user=Yash+Prakash&userId=9ba949960063&source=post_page-9ba949960063--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F80ae14e346d7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-make-a-state-of-the-art-model-with-fastai-bd11e168b214&newsletterV3=9ba949960063&newsletterV3Id=80ae14e346d7&user=Yash+Prakash&userId=9ba949960063&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}