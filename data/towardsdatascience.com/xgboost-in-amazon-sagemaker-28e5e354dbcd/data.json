{"url": "https://towardsdatascience.com/xgboost-in-amazon-sagemaker-28e5e354dbcd", "time": 1683001126.4631581, "path": "towardsdatascience.com/xgboost-in-amazon-sagemaker-28e5e354dbcd/", "webpage": {"metadata": {"title": "XGBoost in Amazon SageMaker. A Complete Walkthrough of XGBoost\u2026 | by Jerry Yu | Towards Data Science", "h1": "XGBoost in Amazon SageMaker", "description": "What is SageMaker? SageMaker is Amazon Web Services\u2019 (AWS) machine learning platform that works in the cloud. It is fully-managed and allows one to perform an entire data science workflow on the\u2026"}, "outgoing_paragraph_urls": [{"url": "https://towardsdatascience.com/predicting-hospital-readmission-for-patients-with-diabetes-using-scikit-learn-a2e359b15f0", "anchor_text": "this", "paragraph_index": 1}, {"url": "https://archive.ics.uci.edu/ml/datasets/diabetes+130-us+hospitals+for+years+1999-2008", "anchor_text": "here", "paragraph_index": 1}, {"url": "http://www.twitter.com/datascitips", "anchor_text": "Twitter", "paragraph_index": 34}, {"url": "http://www.instagram.com/datascitips", "anchor_text": "Instagram", "paragraph_index": 34}, {"url": "http://www.facebook.com/datascitips", "anchor_text": "Facebook", "paragraph_index": 34}], "all_paragraphs": ["What is SageMaker? SageMaker is Amazon Web Services\u2019 (AWS) machine learning platform that works in the cloud. It is fully-managed and allows one to perform an entire data science workflow on the platform. And in this post, I will show you how to call your data from AWS S3, upload your data into S3 and bypassing local storage, train a model, deploy an endpoint, perform predictions, and perform hyperparameter tuning.", "The data cleaning and feature engineering code are derived from this blog post, which is written by Andrew Long, who gave full permission to use his code. The dataset can be found here.", "Head over to your AWS dashboard and find SageMaker, and on the left sidebar, click on `Notebook instances`. To create an instance, click the orange button that says `Create notebook instance`. Here you can choose the instance name, the instance type, elastic inference (scales your instance size according to demand and usage), and other security features. Unless you have specific security requirements from your company, I tend to leave those alone and just fill in the instance name. It will take a few minutes to launch, and after it successfully hosts the instance, AWS gives you two options to write your code in; Jupyter Notebook or Jupyter Labs.", "Once you choose either one of the options, you will need to run some code to get your notebook ready.", "It is up to you to import the first half of the packages, but you will need to import the last four packages to start.", "There are several different ways that you can read data from S3, and to keep things as simple as possible, we will use pd.read_csv .", "Note that if the dataset sits in the bucket without a folder, you won\u2019t need a prefix.", "Since this is a SageMaker walkthrough and not a feature engineering post, I will briefly explain what steps I took to get the dataset ready to train our model.", "We are trying to predict whether or not a patient with diabetes will be readmitted to the hospital within 30 days of the last visit. The OUTPUT_LABEL here will be our readmitted column. We label those that has <30 as positive and the rest as negative. We also:", "We end up with 143 features, with 8 numerical and 135 categorical features.", "Something very important here with XGBoost in SageMaker is that, your OUTPUT_LABEL has to be the first column in the training and validation datasets.", "A very helpful code I found, to move your OUTPUT_LABEL to the first column of your dataset is this:", "We split the dataset into 70/15/15. A good practice is to upload these .csv files to S3, under the training and validation folders respectively. You will need both training and validation files.", "If you run out of local notebook instance storage because your files are too big, you can use the following code to bypass the local storage and upload directly to S3.", "Next, you will need to specify your training and validation files with the imported sagemaker library. If you don\u2019t have a prefix (folder within the bucket), you can delete the second {} .", "Notice how we didn\u2019t install and import XGBoost? That is because we will be using the pre-built XGBoost container SageMaker offers. We will import the package, set up our training instance, and set the hyperparameters, then fit the model to our training data.", "That\u2019s it! Congratulations, if you have done the above steps correctly, your model should be training!", "If you don\u2019t care about exploring the top features in your model (bad idea!), you can skip this first paragraph. Plotting the feature importance in the pre-built XGBoost of SageMaker isn\u2019t as straightforward as plotting it from the XGBoost library.", "First, you will need to find the training job name, if you used the code above to start a training job instead of starting it manually in the dashboard, the training job will be something like xgboost-yyyy-mm-dd-##-##-##-### . You can find this here:", "There might be a line of code within SageMaker that you can run to return the latest job name, which would save you the trouble of going to the dashboard to find it. If you find it, please let me know!", "After you find the training job name, you will need to run the code below to download the model artifact from S3 to the notebook instance, then open the artifact with tarfile.open() , extract it, then use pickle to load it. After spending three days at an AWS SageMaker workshop, this was the best workaround we found.", "Then since XGBoost uses headerless dataframes, we have to append the feature names back to the individual columns. To plot the top features, use this code (cols_input are the input variables excluding OUTPUT_LABEL ):", "We will now deploy an endpoint, which is the gateway for you to pass new and unseen data (test set) to get predictions back.", "Your predictions are now stored as predictions as an array.", "To create a confusion matrix with a threshold of your choice:", "You set your threshold in the second line, where anything above that threshold will be classified as positive. The above code will return something like this.", "Last but not least, let\u2019s plot your AUC!", "The hyperparameter tuning job can also be launched from the SageMaker dashboard, but I like to do everything within the notebook. There are many different ways to launch the hyperparameter tuning job from within the notebook, but after trying out many of the codes I believe this is the most straightforward way of doing it.", "The output of the above cell should return InProgress , which means you have successfully launched a Bayesian hyperparameter tuning job. Note that the max_parallel_jobs is set at 10, and you should not go any higher than that when running a Bayesian Optimization algorithm. I believe the maximum is 30, but setting it above 10 will net you many failed jobs, which is a waste of time and money. You also do not need to specify every single parameter in the XGBoost model, if you remove a parameter, the job will still run.", "You will again need to download the model artifact by finding the name of your best performing model. You can find this by going to the \u2018Hyperparameter tuning jobs\u2019 in the dashboard, click on the corresponding tuning job, then sort by the objective metric (which is AUC in this case), and copy the name of the best model and use the same code in which you downloaded the model artifact. Here is the code again:", "In order to host an endpoint, you will need to attach to the model, which is something that we didn\u2019t do with the first training iteration. I\u2019m not sure why this is the case, but you will need to run this line of code before you can host an endpoint for predictions.", "Note that the name of the model is the same as the name that you found for your tuned model.", "In this article, I have shown you:", "This was my first time using SageMaker for a project like this, and I wanted to share what my workflow and experience was like. Thank you for reading this article!", "If you found this content helpful and would like to read my other content, feel free to follow me at:TwitterInstagramFacebookI post data science tips and tricks that you may find useful!", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F28e5e354dbcd&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fxgboost-in-amazon-sagemaker-28e5e354dbcd&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fxgboost-in-amazon-sagemaker-28e5e354dbcd&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fxgboost-in-amazon-sagemaker-28e5e354dbcd&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fxgboost-in-amazon-sagemaker-28e5e354dbcd&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----28e5e354dbcd--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----28e5e354dbcd--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@JerryYu?source=post_page-----28e5e354dbcd--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@JerryYu?source=post_page-----28e5e354dbcd--------------------------------", "anchor_text": "Jerry Yu"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fd75348ad0aa8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fxgboost-in-amazon-sagemaker-28e5e354dbcd&user=Jerry+Yu&userId=d75348ad0aa8&source=post_page-d75348ad0aa8----28e5e354dbcd---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F28e5e354dbcd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fxgboost-in-amazon-sagemaker-28e5e354dbcd&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F28e5e354dbcd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fxgboost-in-amazon-sagemaker-28e5e354dbcd&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://towardsdatascience.com/predicting-hospital-readmission-for-patients-with-diabetes-using-scikit-learn-a2e359b15f0", "anchor_text": "this"}, {"url": "https://archive.ics.uci.edu/ml/datasets/diabetes+130-us+hospitals+for+years+1999-2008", "anchor_text": "here"}, {"url": "http://www.twitter.com/datascitips", "anchor_text": "Twitter"}, {"url": "http://www.instagram.com/datascitips", "anchor_text": "Instagram"}, {"url": "http://www.facebook.com/datascitips", "anchor_text": "Facebook"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----28e5e354dbcd---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/sagemaker?source=post_page-----28e5e354dbcd---------------sagemaker-----------------", "anchor_text": "Sagemaker"}, {"url": "https://medium.com/tag/amazon-sagemaker?source=post_page-----28e5e354dbcd---------------amazon_sagemaker-----------------", "anchor_text": "Amazon Sagemaker"}, {"url": "https://medium.com/tag/cloud-machine-learning?source=post_page-----28e5e354dbcd---------------cloud_machine_learning-----------------", "anchor_text": "Cloud Machine Learning"}, {"url": "https://medium.com/tag/aws?source=post_page-----28e5e354dbcd---------------aws-----------------", "anchor_text": "AWS"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F28e5e354dbcd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fxgboost-in-amazon-sagemaker-28e5e354dbcd&user=Jerry+Yu&userId=d75348ad0aa8&source=-----28e5e354dbcd---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F28e5e354dbcd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fxgboost-in-amazon-sagemaker-28e5e354dbcd&user=Jerry+Yu&userId=d75348ad0aa8&source=-----28e5e354dbcd---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F28e5e354dbcd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fxgboost-in-amazon-sagemaker-28e5e354dbcd&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----28e5e354dbcd--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F28e5e354dbcd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fxgboost-in-amazon-sagemaker-28e5e354dbcd&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----28e5e354dbcd---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----28e5e354dbcd--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----28e5e354dbcd--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----28e5e354dbcd--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----28e5e354dbcd--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----28e5e354dbcd--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----28e5e354dbcd--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----28e5e354dbcd--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----28e5e354dbcd--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@JerryYu?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@JerryYu?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Jerry Yu"}, {"url": "https://medium.com/@JerryYu/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "119 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fd75348ad0aa8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fxgboost-in-amazon-sagemaker-28e5e354dbcd&user=Jerry+Yu&userId=d75348ad0aa8&source=post_page-d75348ad0aa8--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Ffdf590a646b3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fxgboost-in-amazon-sagemaker-28e5e354dbcd&newsletterV3=d75348ad0aa8&newsletterV3Id=fdf590a646b3&user=Jerry+Yu&userId=d75348ad0aa8&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}