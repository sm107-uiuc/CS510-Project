{"url": "https://towardsdatascience.com/the-secret-neural-network-formula-70b41f0da767", "time": 1683015469.073728, "path": "towardsdatascience.com/the-secret-neural-network-formula-70b41f0da767/", "webpage": {"metadata": {"title": "The Secret Neural Network Formula | by Henri Woodcock | Towards Data Science", "h1": "The Secret Neural Network Formula", "description": "Choosing the right architecture for your deep learning model can drastically change the results achieved. Using too few neurons can lead to the model not finding complex relationships in the data\u2026"}, "outgoing_paragraph_urls": [{"url": "https://en.wikipedia.org/wiki/Universal_approximation_theorem", "anchor_text": "Universal Approximation Theorem", "paragraph_index": 1}, {"url": "http://henriwoodcock.github.io", "anchor_text": "henriwoodcock.github.io", "paragraph_index": 19}], "all_paragraphs": ["Choosing the right architecture for your deep learning model can drastically change the results achieved. Using too few neurons can lead to the model not finding complex relationships in the data, whereas using too many neurons can lead to an overfitting effect.", "With tabular data it is usually understood that not many layers are required, one or two will suffice. To help understand why this is enough look at the Universal Approximation Theorem, which proves (in simple terms) that a neural network with one layer and a finite number of neurons can approximate any continuous function.", "However, how do you pick the number of neurons for that neural network?", "The aim is to find the right number of neurons to prevent overfitting and underfitting, of course, this is not the entire solution to prevent overfitting and underfitting but it can help reduce this from happening.", "In machine and deep learning, the degrees of freedom of a model is the number of parameters which can be learned. Increasing the degrees of freedom in your model can give it more flexibility to fit more complex functions, but too much and this flexibility could allow the model to overfit to the data.", "This can be seen in the image below:", "This means one way to reduce overfitting is to limit the degrees of freedom in the model.", "One formula I found during research of this problem is:", "N_h is the number of neurons, N_s the number of training samples, N_i represents the number of input neurons, N_o is the number of output neurons and alpha is a hyperparameter to be selected.", "The degrees of freedom in your dataset is N_s(N_i + N_o), and the aim is to limit the number of free parameters in your model to a small proportion of the degrees of freedom in your data. If your data is a good representation, this should allow the model to generalise well, too many parameters and it means the model can overfit to the training set.", "Alpha represents how many more degrees of freedom there are in your data compared to your model. With alpha = 2, there will be twice as many degrees of freedom in your data than in your model. An alpha value of 2\u201310 is recommended and you could loop through to find an optimal alpha value.", "One method which helped me understand the formula intuitively was to let beta = 1/alpha (keeping alpha between 2 and 10) and then increasing beta represents an increasing complexity. A more nonlinear problem will need a larger beta.", "The main rule is to keep alpha \u2265 1 as this means the model degrees of freedom is never greater than the degrees of freedom in the dataset.", "The example is a Jupyter Notebook and compares the advice given by Jeff Heaton when selecting the number of neurons in a layer. I chose this advice as beginners are likely to follow Jeff Heaton\u2019s advice due to his importance in the field.", "This in no way takes away from Jeff Heaton\u2019s advice but attempts to show how selecting the number of neurons using the formula provided in this blog post, a data scientist can create more complex neural networks without overfitting. Creating more complex neural networks can lead to better results.", "1. The number of hidden neurons should be between the size of the input layer and the size of the output layer.", "2. The number of hidden neurons should be 2/3 the size of the input layer, plus the size of the output layer.", "3. The number of hidden neurons should be less than twice the size of the input layer.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "UK Based Data Scientist \\\\ Personal website: henriwoodcock.github.io \\\\ The opinions expressed are my own views and not my employer. \\\\ @henriwoodcock"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F70b41f0da767&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-secret-neural-network-formula-70b41f0da767&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-secret-neural-network-formula-70b41f0da767&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-secret-neural-network-formula-70b41f0da767&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-secret-neural-network-formula-70b41f0da767&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----70b41f0da767--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----70b41f0da767--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://henriwoodcock.medium.com/?source=post_page-----70b41f0da767--------------------------------", "anchor_text": ""}, {"url": "https://henriwoodcock.medium.com/?source=post_page-----70b41f0da767--------------------------------", "anchor_text": "Henri Woodcock"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fe9ee1187182a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-secret-neural-network-formula-70b41f0da767&user=Henri+Woodcock&userId=e9ee1187182a&source=post_page-e9ee1187182a----70b41f0da767---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F70b41f0da767&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-secret-neural-network-formula-70b41f0da767&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F70b41f0da767&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-secret-neural-network-formula-70b41f0da767&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://startupstockphotos.com/", "anchor_text": "Startup Stock Photos"}, {"url": "https://en.wikipedia.org/wiki/Universal_approximation_theorem", "anchor_text": "Universal Approximation Theorem"}, {"url": "https://stats.stackexchange.com/questions/181/how-to-choose-the-number-of-hidden-layers-and-nodes-in-a-feedforward-neural-netw", "anchor_text": "https://stats.stackexchange.com/questions/181/how-to-choose-the-number-of-hidden-layers-and-nodes-in-a-feedforward-neural-netw"}, {"url": "https://www.heatonresearch.com/2017/06/01/hidden-layers.html", "anchor_text": "https://www.heatonresearch.com/2017/06/01/hidden-layers.html"}, {"url": "https://arxiv.org/abs/2002.04688", "anchor_text": "https://arxiv.org/abs/2002.04688"}, {"url": "https://medium.com/tag/data-science?source=post_page-----70b41f0da767---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----70b41f0da767---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----70b41f0da767---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/mathematics?source=post_page-----70b41f0da767---------------mathematics-----------------", "anchor_text": "Mathematics"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F70b41f0da767&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-secret-neural-network-formula-70b41f0da767&user=Henri+Woodcock&userId=e9ee1187182a&source=-----70b41f0da767---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F70b41f0da767&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-secret-neural-network-formula-70b41f0da767&user=Henri+Woodcock&userId=e9ee1187182a&source=-----70b41f0da767---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F70b41f0da767&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-secret-neural-network-formula-70b41f0da767&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----70b41f0da767--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F70b41f0da767&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-secret-neural-network-formula-70b41f0da767&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----70b41f0da767---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----70b41f0da767--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----70b41f0da767--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----70b41f0da767--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----70b41f0da767--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----70b41f0da767--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----70b41f0da767--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----70b41f0da767--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----70b41f0da767--------------------------------", "anchor_text": ""}, {"url": "https://henriwoodcock.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://henriwoodcock.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Henri Woodcock"}, {"url": "https://henriwoodcock.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "50 Followers"}, {"url": "http://henriwoodcock.github.io", "anchor_text": "henriwoodcock.github.io"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fe9ee1187182a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-secret-neural-network-formula-70b41f0da767&user=Henri+Woodcock&userId=e9ee1187182a&source=post_page-e9ee1187182a--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F8e478f1fd18&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-secret-neural-network-formula-70b41f0da767&newsletterV3=e9ee1187182a&newsletterV3Id=8e478f1fd18&user=Henri+Woodcock&userId=e9ee1187182a&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}