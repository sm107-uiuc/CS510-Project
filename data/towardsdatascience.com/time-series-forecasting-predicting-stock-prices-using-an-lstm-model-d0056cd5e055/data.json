{"url": "https://towardsdatascience.com/time-series-forecasting-predicting-stock-prices-using-an-lstm-model-d0056cd5e055", "time": 1683013856.309407, "path": "towardsdatascience.com/time-series-forecasting-predicting-stock-prices-using-an-lstm-model-d0056cd5e055/", "webpage": {"metadata": {"title": "Time-Series Forecasting: Predicting Stock Prices Using An LSTM Model | by Serafeim Loukas, PhD | Towards Data Science", "h1": "Time-Series Forecasting: Predicting Stock Prices Using An LSTM Model", "description": "Note from Towards Data Science\u2019s editors: While we allow independent authors to publish articles in accordance with our rules and guidelines, we do not endorse each author\u2019s contribution. You should\u2026"}, "outgoing_paragraph_urls": [{"url": "https://towardsdatascience.com/questions-96667b06af5", "anchor_text": "rules and guidelines", "paragraph_index": 0}, {"url": "https://towardsdatascience.com/readers-terms-b5d780a700a4", "anchor_text": "Reader Terms", "paragraph_index": 0}, {"url": "https://aigents.co/learn", "anchor_text": "https://aigents.co/learn", "paragraph_index": 11}], "all_paragraphs": ["Note from Towards Data Science\u2019s editors: While we allow independent authors to publish articles in accordance with our rules and guidelines, we do not endorse each author\u2019s contribution. You should not rely on an author\u2019s works without seeking professional advice. See our Reader Terms for details.", "Traditionally most machine learning (ML) models use as input features some observations (samples / examples) but there is no time dimension in the data.", "Time-series forecasting models are the models that are capable to predict future values based on previously observed values. Time-series forecasting is widely used for non-stationary data. Non-stationary data are called the data whose statistical properties e.g. the mean and standard deviation are not constant over time but instead, these metrics vary over time.", "These non-stationary input data (used as input to these models) are usually called time-series. Some examples of time-series include the temperature values over time, stock price over time, price of a house over time etc. So, the input is a signal (time-series) that is defined by observations taken sequentially in time.", "A time series is a sequence of observations taken sequentially in time.", "Observation: Time-series data is recorded on a discrete time scale.", "Disclaimer (before we move on): There have been attempts to predict stock prices using time series analysis algorithms, though they still cannot be used to place bets in the real market. This is just a tutorial article that does not intent in any way to \u201cdirect\u201d people into buying stocks.", "Long short-term memory (LSTM) is an artificial recurrent neural network (RNN) architecture used in the field of deep learning. Unlike standard feedforward neural networks, LSTM has feedback connections. It can not only process single data points (e.g. images), but also entire sequences of data (such as speech or video inputs).", "LSTM models are able to store information over a period of time.", "In order words, they have a memory capacity. Remember that LSTM stands for Long Short-Term Memory Model.", "This characteristic is extremely useful when we deal with Time-Series or Sequential Data. When using an LSTM model we are free and able to decide what information will be stored and what discarded. We do that using the \u201cgates\u201d. The deep understanding of the LSTM is outside the scope of this post but if you are interested in learning more, have a look at the references at the end of this post.", "If you want to learn Data Science by yourself with the support of interactive roadmaps and an active learning community have a look at this resource: https://aigents.co/learn", "Click on the Download and save the .csv file locally on your computer.", "Modules needed: Keras, Tensorflow, Pandas, Scikit-Learn & Numpy", "We are going to build a multi-layer LSTM recurrent neural network to predict the last value of a sequence of values i.e. the TESLA stock price in this example.", "Let\u2019s load the data and inspect them:", "The next step is to split the data into training and test sets to avoid overfitting and to be able to investigate the generalization ability of our model. To learn more about overfitting read this article:", "The target value to be predicted is going to be the \u201cClose\u201d stock price value.", "It\u2019s a good idea to normalize the data before model fitting. This will boost the performance. You can read more here for the Min-Max Scaler:", "Let\u2019s build the input features with time lag of 1 day (lag 1):", "We have now reshaped the data into the following format (#values, #time-steps, #1 dimensional output).", "Now, it\u2019s time to build the model. We will build the LSTM with 50 neurons and 4 hidden layers. Finally, we will assign 1 neuron in the output layer for predicting the normalized stock price. We will use the MSE loss function and the Adam stochastic gradient descent optimizer.", "Note: the following will take some time (~5min).", "When the fitting is finished you should see something like this:", "Prepare the test data (reshape them):", "Make Predictions using the test set", "Using a lag of 1 (i.e. step of one day):", "Observation: Huge drop in March 2020 due to the COVID-19 lockdown !", "We can clearly see that our model performed very good. It is able to accuretly follow most of the unexcepted jumps/drops however, for the most recent date stamps, we can see that the model expected (predicted) lower values compared to the real values of the stock price.", "The initial selected lag in this article was 1 i.e. using a step of 1 day. This can be easily changed by altering the code that builds the 3D inputs.", "Example: One can change the following 2 blocks of code:", "In that case the results look like this:", "That\u2019s all folks ! Hope you liked this article!", "If you liked and found this article useful, follow me to be able to see all my new posts.", "Questions? Post them as a comment and I will reply as soon as possible.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Senior Data Scientist / Research Scientist @ Natural Cycles (Switzerland). PhD, MSc, M.Eng."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fd0056cd5e055&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftime-series-forecasting-predicting-stock-prices-using-an-lstm-model-d0056cd5e055&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftime-series-forecasting-predicting-stock-prices-using-an-lstm-model-d0056cd5e055&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftime-series-forecasting-predicting-stock-prices-using-an-lstm-model-d0056cd5e055&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftime-series-forecasting-predicting-stock-prices-using-an-lstm-model-d0056cd5e055&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----d0056cd5e055--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----d0056cd5e055--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://seralouk.medium.com/?source=post_page-----d0056cd5e055--------------------------------", "anchor_text": ""}, {"url": "https://seralouk.medium.com/?source=post_page-----d0056cd5e055--------------------------------", "anchor_text": "Serafeim Loukas, PhD"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F325d0d6c848b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftime-series-forecasting-predicting-stock-prices-using-an-lstm-model-d0056cd5e055&user=Serafeim+Loukas%2C+PhD&userId=325d0d6c848b&source=post_page-325d0d6c848b----d0056cd5e055---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fd0056cd5e055&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftime-series-forecasting-predicting-stock-prices-using-an-lstm-model-d0056cd5e055&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fd0056cd5e055&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftime-series-forecasting-predicting-stock-prices-using-an-lstm-model-d0056cd5e055&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://towardsdatascience.com/questions-96667b06af5", "anchor_text": "rules and guidelines"}, {"url": "https://towardsdatascience.com/readers-terms-b5d780a700a4", "anchor_text": "Reader Terms"}, {"url": "https://aigents.co/learn", "anchor_text": "https://aigents.co/learn"}, {"url": "https://finance.yahoo.com/quote/TSLA/history?period1=1436486400&period2=1594339200&interval=1d&filter=history&frequency=1d", "anchor_text": "https://finance.yahoo.com/quote/TSLA/history?period1=1436486400&period2=1594339200&interval=1d&filter=history&frequency=1d"}, {"url": "https://towardsdatascience.com/is-your-model-overfitting-or-maybe-underfitting-an-example-using-a-neural-network-in-python-4faf155398d2", "anchor_text": "Is your model overfitting? Or maybe underfitting? An example using a neural network in pythonOverfitting, underfitting, generalization ability, cross-validation. Everything simply explained. I also provide a\u2026towardsdatascience.com"}, {"url": "https://towardsdatascience.com/everything-you-need-to-know-about-min-max-normalization-in-python-b79592732b79", "anchor_text": "Everything you need to know about Min-Max normalization in PythonIn this post I explain what Min-Max scaling is, when to use it and how to implement it in Python using scikit-learn but\u2026towardsdatascience.com"}, {"url": "https://towardsdatascience.com/time-series-forecasting-predicting-stock-prices-using-facebooks-prophet-model-9ee1657132b5", "anchor_text": "Time-Series Forecasting: Predicting Stock Prices Using Facebook\u2019s Prophet ModelPredict stock prices using a forecasting model publicly available from Facebook: The Prophettowardsdatascience.com"}, {"url": "https://towardsdatascience.com/time-series-forecasting-predicting-stock-prices-using-an-arima-model-2e3b3080bd70", "anchor_text": "Time-Series Forecasting: Predicting Stock Prices Using An ARIMA ModelIn this post I show you how to predict the TESLA stock price using a forecasting ARIMA modeltowardsdatascience.com"}, {"url": "https://colah.github.io/posts/2015-08-Understanding-LSTMs/", "anchor_text": "https://colah.github.io/posts/2015-08-Understanding-LSTMs/"}, {"url": "https://en.wikipedia.org/wiki/Long_short-term_memory", "anchor_text": "https://en.wikipedia.org/wiki/Long_short-term_memory"}, {"url": "https://towardsdatascience.com/time-series-forecasting-predicting-stock-prices-using-facebooks-prophet-model-9ee1657132b5", "anchor_text": "Time-Series Forecasting: Predicting Stock Prices Using Facebook\u2019s Prophet ModelPredict stock prices using a forecasting model publicly available from Facebook: The Prophettowardsdatascience.com"}, {"url": "https://medium.com/@seralouk/the-best-free-data-science-resources-free-books-online-courses-9c4a2df194e5", "anchor_text": "The Best FREE Data Science Resources: FREE Books & Online CoursesThe most useful FREE books and online courses for someone who wants to learn more about Data Science.medium.com"}, {"url": "https://towardsdatascience.com/roc-curve-explained-using-a-covid-19-hypothetical-example-binary-multi-class-classification-bab188ea869c", "anchor_text": "ROC Curve Explained using a COVID-19 hypothetical example: Binary & Multi-Class Classification\u2026In this post I clearly explain what a ROC curve is and how to read it. I use a COVID-19 example to make my point and I\u2026towardsdatascience.com"}, {"url": "https://towardsdatascience.com/support-vector-machines-svm-clearly-explained-a-python-tutorial-for-classification-problems-29c539f3ad8", "anchor_text": "Support Vector Machines (SVM) clearly explained: A python tutorial for classification problems\u2026In this article I explain the core of the SVMs, why and how to use them. Additionally, I show how to plot the support\u2026towardsdatascience.com"}, {"url": "https://towardsdatascience.com/pca-clearly-explained-how-when-why-to-use-it-and-feature-importance-a-guide-in-python-7c274582c37e", "anchor_text": "PCA clearly explained \u2014 How, when, why to use it and feature importance: A guide in PythonIn this post I explain what PCA is, when and why to use it and how to implement it in Python using scikit-learn. Also\u2026towardsdatascience.com"}, {"url": "https://towardsdatascience.com/everything-you-need-to-know-about-min-max-normalization-in-python-b79592732b79", "anchor_text": "Everything you need to know about Min-Max normalization in PythonIn this post I explain what Min-Max scaling is, when to use it and how to implement it in Python using scikit-learn but\u2026towardsdatascience.com"}, {"url": "https://towardsdatascience.com/how-and-why-to-standardize-your-data-996926c2c832", "anchor_text": "How Scikit-Learn\u2019s StandardScaler worksIn this post I am explaining why and how to apply Standardization using scikit-learntowardsdatascience.com"}, {"url": "https://www.linkedin.com/in/serafeim-loukas/", "anchor_text": "https://www.linkedin.com/in/serafeim-loukas/"}, {"url": "https://www.researchgate.net/profile/Serafeim_Loukas", "anchor_text": "https://www.researchgate.net/profile/Serafeim_Loukas"}, {"url": "https://people.epfl.ch/serafeim.loukas", "anchor_text": "https://people.epfl.ch/serafeim.loukas"}, {"url": "https://stackoverflow.com/users/5025009/seralouk", "anchor_text": "https://stackoverflow.com/users/5025009/seralouk"}, {"url": "https://medium.com/tag/forecasting?source=post_page-----d0056cd5e055---------------forecasting-----------------", "anchor_text": "Forecasting"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----d0056cd5e055---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----d0056cd5e055---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/timeseries?source=post_page-----d0056cd5e055---------------timeseries-----------------", "anchor_text": "Timeseries"}, {"url": "https://medium.com/tag/stocks?source=post_page-----d0056cd5e055---------------stocks-----------------", "anchor_text": "Stocks"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fd0056cd5e055&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftime-series-forecasting-predicting-stock-prices-using-an-lstm-model-d0056cd5e055&user=Serafeim+Loukas%2C+PhD&userId=325d0d6c848b&source=-----d0056cd5e055---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fd0056cd5e055&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftime-series-forecasting-predicting-stock-prices-using-an-lstm-model-d0056cd5e055&user=Serafeim+Loukas%2C+PhD&userId=325d0d6c848b&source=-----d0056cd5e055---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fd0056cd5e055&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftime-series-forecasting-predicting-stock-prices-using-an-lstm-model-d0056cd5e055&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----d0056cd5e055--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fd0056cd5e055&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftime-series-forecasting-predicting-stock-prices-using-an-lstm-model-d0056cd5e055&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----d0056cd5e055---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----d0056cd5e055--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----d0056cd5e055--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----d0056cd5e055--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----d0056cd5e055--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----d0056cd5e055--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----d0056cd5e055--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----d0056cd5e055--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----d0056cd5e055--------------------------------", "anchor_text": ""}, {"url": "https://seralouk.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://seralouk.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Serafeim Loukas, PhD"}, {"url": "https://seralouk.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "2.2K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F325d0d6c848b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftime-series-forecasting-predicting-stock-prices-using-an-lstm-model-d0056cd5e055&user=Serafeim+Loukas%2C+PhD&userId=325d0d6c848b&source=post_page-325d0d6c848b--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fe538e6363893&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftime-series-forecasting-predicting-stock-prices-using-an-lstm-model-d0056cd5e055&newsletterV3=325d0d6c848b&newsletterV3Id=e538e6363893&user=Serafeim+Loukas%2C+PhD&userId=325d0d6c848b&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}