{"url": "https://towardsdatascience.com/deep-java-library-djl-a-deep-learning-toolkit-for-java-developers-55d5a45bca7e", "time": 1683001891.194873, "path": "towardsdatascience.com/deep-java-library-djl-a-deep-learning-toolkit-for-java-developers-55d5a45bca7e/", "webpage": {"metadata": {"title": "Deep Java Library(DJL) \u2014 a Deep Learning Toolkit for Java Developers | by Kesha Williams | Towards Data Science", "h1": "Deep Java Library(DJL) \u2014 a Deep Learning Toolkit for Java Developers", "description": "Deep Java Library (DJL), is an open-source library created by Amazon to develop machine learning (ML) and deep learning (DL) models natively in Java while simplifying the use of deep learning\u2026"}, "outgoing_paragraph_urls": [{"url": "https://djl.ai/", "anchor_text": "Deep Java Library (DJL)", "paragraph_index": 0}, {"url": "http://vision.cs.utexas.edu/projects/finegrained/utzap50k/", "anchor_text": "UTZappos50k", "paragraph_index": 3}, {"url": "https://www.utexas.edu/", "anchor_text": "The University of Texas at Austin", "paragraph_index": 3}, {"url": "https://www.zappos.com/", "anchor_text": "Zappos.com", "paragraph_index": 3}, {"url": "https://mxnet.apache.org/", "anchor_text": "Apache MXNet", "paragraph_index": 4}, {"url": "https://aws.amazon.com/ec2/", "anchor_text": "Amazon EC2", "paragraph_index": 5}, {"url": "https://djl-ai.s3.amazonaws.com/java-api/0.1.0/index.html", "anchor_text": "Block", "paragraph_index": 9}, {"url": "https://djl.ai/", "anchor_text": "website", "paragraph_index": 17}, {"url": "https://javadoc.djl.ai/", "anchor_text": "Java Library API Specification", "paragraph_index": 17}, {"url": "http://bit.ly/deep-java", "anchor_text": "GitLab", "paragraph_index": 17}], "all_paragraphs": ["Deep Java Library (DJL), is an open-source library created by Amazon to develop machine learning (ML) and deep learning (DL) models natively in Java while simplifying the use of deep learning frameworks.", "I recently used DJL to develop a footwear classification model and found the toolkit super intuitive and easy to use; it\u2019s obvious a lot of thought went into the design and how Java developers would use it. DJL APIs abstract commonly used functions to develop models and orchestrate infrastructure management. I found the high-level APIs used to train, test and run inference allowed me to use my knowledge of Java and the ML lifecycle to develop a model in less than an hour with minimal code.", "The footwear classification model is a multiclass classification computer vision (CV) model, trained using supervised learning, that classifies footwear in one of four class labels: boots, sandals, shoes, or slippers.", "The most important part of developing an accurate ML model is to use data from a reputable source. The data source for the footwear classification model is the UTZappos50k dataset provided by The University of Texas at Austin and is freely available for academic, non-commercial use. The shoe dataset consists of 50,025 labeled catalog images collected from Zappos.com.", "Training is the process to produce an ML model by giving a learning algorithm training data to study. The term model refers to the artifact produced during the training process; the model contains patterns found in the training data and can be used to make a prediction (or inference). Before I started the training process, I set up my local environment for development. You will need JDK 8 (or later), IntelliJ, an ML engine for training (like Apache MXNet), an environment variable pointed to your engine\u2019s path and the build dependencies for DJL.", "DJL stays true to Java\u2019s motto, \u201cwrite once, run anywhere (WORA)\u201d, by being engine and deep learning framework-agnostic. Developers can write code once that runs on any engine. DJL currently provides an implementation for Apache MXNet, an ML engine that eases the development of deep neural networks. DJL APIs use JNA, Java Native Access, to call the corresponding Apache MXNet operations. From a hardware perspective, training occurred locally on my laptop using a CPU. However, for the best performance, the DJL team recommends using a machine with at least one GPU. If you don\u2019t have a GPU available to you, there is always an option to use Apache MXNet on Amazon EC2. A nice feature of DJL is that it provides automatic CPU/GPU detection based on the hardware configuration to always ensure the best performance.", "The footwear data was saved locally and loaded using DJL ImageFolder dataset, which is a dataset that can retrieve images from a local folder. In DJL terms, a Dataset simply holds the training data. There are dataset implementations that can be used to download data (based on the URL you provide), extract data, and automatically separate data into training and validation sets. The automatic separation is a useful feature as it is important to never use the same data the model was trained with to validate the model\u2019s performance. The training validation dataset is used to find patterns in the data; the validation dataset is used to estimate the footwear model\u2019s accuracy during the training process.", "When structuring the data locally, I didn\u2019t go down to the most granular level identified by the UTZappos50k dataset, such as the ankle, knee-high, mid-calf, over the knee, etc. classification labels for boots. My local data are kept at the highest level of classification, which includes only boots, sandals, shoes, and slippers.", "Now that I have the footwear data separated into training and validation sets, I will use a neural network to train the model.", "Training is started by feeding the training data as input to a Block. In DJL terms, a Block is a composable unit that forms a neural network. You can combine Blocks (just like Lego blocks) to form a complex network. At the end of the training process, a Block represents a fully-trained model. The first step is to get a model instance by calling Models.getModel(NUM_OF_OUTPUT, NEW_HEIGHT, NEW_WIDTH). The getModel() method creates an empty model, constructs the neural network, and sets the neural network to the model.", "The next step is to set up and configure a Trainer by calling the model.newTrainer(config) method. The config object was initialized by calling the setupTrainingConfig(loss) method, which sets the training configuration (or hyperparameters) to determine how the network is trained.", "There are multiple hyperparameters set for training:", "The next step is to set Metrics, a training listener, and initialize the Trainer with the proper input shape. Metrics collect and report key performance indicators (KPIs) during training that can be used to analyze and monitor training performance and stability. Next, I kick off the training process by calling the fit(trainer, trainingDataset, validateDataset, \u201cbuild/logs/training\u201d) method, which iterates over the training data and stores the patterns found in the model.", "At the end of the training, a well-performing validated model artifact is saved locally along with its properties using the model.save(Paths.get(modelParamsPath), modelParamsName)method. The metrics reported during the training process are shown below.", "Now that I have a model, I can use it to perform inference (or prediction) on new data for which I do not know the classification (or target). After setting the necessary paths to the model and the image to be classified, I obtain an empty model instance using the Models.getModel(NUM_OF_OUTPUT, NEW_HEIGHT, NEW_WIDTH) method and initialize it using the model.load(Paths.get(modelParamsPath), modelParamsName) method. This loads the model I trained in the previous step. Next, I\u2019m initializing a Predictor, with a specified Translator, using the model.newPredictor(translator)method. You\u2019ll notice that I\u2019m passing a Translator to the Predictor. In DJL terms, a Translator provides model pre-processing and post-processing functionality. For example, with CV models, images need to be reshaped to grayscale; a Translator can do this for you. The Predictor allows me to perform inference on the loaded Model using the predictor.predict(img) method, passing in the image to classify. I\u2019m doing a single prediction, but DJL also supports batch predictions. The inference is stored in predictResult, which contains the probability estimate per label. The model is automatically closed once inference completes making DJL memory efficient.", "The inferences (per image) are shown below with their corresponding probability scores.", "I\u2019ve been developing Java-based applications since the late \u201990s and started my machine learning journey in 2017. My journey would\u2019ve been much easier had DJL been around back then. I highly recommend that Java developers, looking to transition to machine learning, give DJL a try. In my example, I developed the footwear classification model from scratch; however, DJL also allows developers to deploy pre-trained models with minimal effort. DJL also comes with popular datasets out of the box to allow developers to instantly get started with ML. Before starting with DJL, I would recommend that you have a firm understanding of the ML lifecycle and are familiar with common ML terms. Once you have a basic level understanding of ML, you can quickly come up to speed on DJL APIs.", "Amazon has open-sourced DJL, where further detailed information about the toolkit can be found on the DJL website and Java Library API Specification page. The code for the footwear classification model can be found on GitLab. Good luck on your ML journey and please feel free to reach out to me if you have any questions.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Kesha Williams is an award-winning technology leader. She\u2019s also an AWS Machine Learning Hero, AWS Partner Ambassador, and Alexa Champion."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F55d5a45bca7e&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-java-library-djl-a-deep-learning-toolkit-for-java-developers-55d5a45bca7e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-java-library-djl-a-deep-learning-toolkit-for-java-developers-55d5a45bca7e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-java-library-djl-a-deep-learning-toolkit-for-java-developers-55d5a45bca7e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-java-library-djl-a-deep-learning-toolkit-for-java-developers-55d5a45bca7e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----55d5a45bca7e--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----55d5a45bca7e--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@KeshaWillz?source=post_page-----55d5a45bca7e--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@KeshaWillz?source=post_page-----55d5a45bca7e--------------------------------", "anchor_text": "Kesha Williams"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fe3ec423ec128&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-java-library-djl-a-deep-learning-toolkit-for-java-developers-55d5a45bca7e&user=Kesha+Williams&userId=e3ec423ec128&source=post_page-e3ec423ec128----55d5a45bca7e---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F55d5a45bca7e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-java-library-djl-a-deep-learning-toolkit-for-java-developers-55d5a45bca7e&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F55d5a45bca7e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-java-library-djl-a-deep-learning-toolkit-for-java-developers-55d5a45bca7e&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://towardsdatascience.com/data-science-in-the-real-world/home", "anchor_text": "Data Science in the Real World"}, {"url": "https://djl.ai/", "anchor_text": "Deep Java Library (DJL)"}, {"url": "http://vision.cs.utexas.edu/projects/finegrained/utzap50k/", "anchor_text": "UTZappos50k"}, {"url": "https://www.utexas.edu/", "anchor_text": "The University of Texas at Austin"}, {"url": "https://www.zappos.com/", "anchor_text": "Zappos.com"}, {"url": "https://mxnet.apache.org/", "anchor_text": "Apache MXNet"}, {"url": "https://aws.amazon.com/ec2/", "anchor_text": "Amazon EC2"}, {"url": "https://djl-ai.s3.amazonaws.com/java-api/0.1.0/index.html", "anchor_text": "Block"}, {"url": "https://djl.ai/", "anchor_text": "website"}, {"url": "https://javadoc.djl.ai/", "anchor_text": "Java Library API Specification"}, {"url": "http://bit.ly/deep-java", "anchor_text": "GitLab"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----55d5a45bca7e---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/java?source=post_page-----55d5a45bca7e---------------java-----------------", "anchor_text": "Java"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----55d5a45bca7e---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/amazon-web-services?source=post_page-----55d5a45bca7e---------------amazon_web_services-----------------", "anchor_text": "Amazon Web Services"}, {"url": "https://medium.com/tag/amazon?source=post_page-----55d5a45bca7e---------------amazon-----------------", "anchor_text": "Amazon"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F55d5a45bca7e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-java-library-djl-a-deep-learning-toolkit-for-java-developers-55d5a45bca7e&user=Kesha+Williams&userId=e3ec423ec128&source=-----55d5a45bca7e---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F55d5a45bca7e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-java-library-djl-a-deep-learning-toolkit-for-java-developers-55d5a45bca7e&user=Kesha+Williams&userId=e3ec423ec128&source=-----55d5a45bca7e---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F55d5a45bca7e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-java-library-djl-a-deep-learning-toolkit-for-java-developers-55d5a45bca7e&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----55d5a45bca7e--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F55d5a45bca7e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-java-library-djl-a-deep-learning-toolkit-for-java-developers-55d5a45bca7e&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----55d5a45bca7e---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----55d5a45bca7e--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----55d5a45bca7e--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----55d5a45bca7e--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----55d5a45bca7e--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----55d5a45bca7e--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----55d5a45bca7e--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----55d5a45bca7e--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----55d5a45bca7e--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@KeshaWillz?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@KeshaWillz?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Kesha Williams"}, {"url": "https://medium.com/@KeshaWillz/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "42 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fe3ec423ec128&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-java-library-djl-a-deep-learning-toolkit-for-java-developers-55d5a45bca7e&user=Kesha+Williams&userId=e3ec423ec128&source=post_page-e3ec423ec128--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fusers%2Fe3ec423ec128%2Flazily-enable-writer-subscription&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-java-library-djl-a-deep-learning-toolkit-for-java-developers-55d5a45bca7e&user=Kesha+Williams&userId=e3ec423ec128&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}