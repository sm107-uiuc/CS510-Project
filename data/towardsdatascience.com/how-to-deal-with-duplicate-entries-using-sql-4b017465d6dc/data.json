{"url": "https://towardsdatascience.com/how-to-deal-with-duplicate-entries-using-sql-4b017465d6dc", "time": 1683016858.076865, "path": "towardsdatascience.com/how-to-deal-with-duplicate-entries-using-sql-4b017465d6dc/", "webpage": {"metadata": {"title": "How To Deal with Duplicate Entries Using SQL | by Marie Lefevre | Towards Data Science", "h1": "How To Deal with Duplicate Entries Using SQL", "description": "Duplicates are a recurring problem for any database user. There are several reasons why some duplicates may appear in a data set, and a sanity check is often necessary before any analysis can be\u2026"}, "outgoing_paragraph_urls": [{"url": "https://towardsdatascience.com/3-simple-tricks-to-better-structure-your-sql-queries-f5e3b38d58e2", "anchor_text": "this article", "paragraph_index": 12}, {"url": "https://marie-lefevre.medium.com/membership", "anchor_text": "Become a member", "paragraph_index": 19}], "all_paragraphs": ["Duplicates are a recurring problem for any database user. There are several reasons why some duplicates may appear in a data set, and a sanity check is often necessary before any analysis can be conducted properly. This is why I want to share with you some lessons learned from my experience in dealing with duplicates using SQL.", "Let\u2019s set the scene. You just conducted a brilliant analysis to evaluate how many clients you or your company acquired over the past year. Your conclusion seems to confirm your intuition: the number of clients has tripled over the past 12 months! You are so proud of this result \u2014 although somewhat surprised \u2014 that you want to double-check it before presenting it to your boss. Digging into the data, you suddenly realize that some customers were counted twice\u2026 which clearly questions your previous finding.", "How to deal with possible duplicate entries in your data set? How to work around the problem of duplicates using SQL? Let me guide you through some of the techniques I have been using as a Data Analyst to identify, avoid and remove duplicates from any type of data set.", "Below is the sample table (named customers) that I will use throughout this article to illustrate my points:", "Regardless of how duplicates were created, the first step is to identify them within your data table. The most difficult part here is not technical: it is about acknowledging their existence. Too often one may be tempted to consider that a data table (especially within a company) does not contain any duplicate entry by default. While it is, fortunately, the case for the majority of them, sometimes duplicates were created unknowingly over time.", "A simple SQL query allows you to retrieve all duplicates present in a data table. Looking at some particular examples of duplicate rows is a good way to get started. Five to ten concrete examples will give you a first idea of what is going on in your data, in order to better understand what could have led to the creation of duplicates.", "Based on the example introduced previously, the following query allows to identify possible customers that are present more than once in the data table customers. In this example, I want to ensure that all the customers registered are unique. To do so, I use customers\u2019 email address and date of birth, as they are supposed to be unique to each customer.", "To apply this query to any data table, you simply have to replace the following fields:", "If you get an empty table as an output, congratulations! It means that no duplicates were found in your table, based on the criteria you specified. If you get an output, you must investigate some of the duplicate rows.", "Here, the columns that are not supposed to be unique (in this example, several customers may have the same customer_first_name and/or customer_last_name) will help you identify duplicates. They will pave the way for a better understanding of why there are duplicates in your table. In my example, I see that the customer Sarah Smith, whose email address is sarah.smith@email.com and who is born May 23rd, 1983, has been doubled-counted in my data table.", "As is often the case, the best cure is to avoid getting sick. Therefore, before jumping into the \u201cremoving duplicates\u201d part, you should understand what could have led to the creation of duplicates in a data table. Possible causes can be operational (e.g. a salesperson registered the same customer multiple times), technical (e.g. an IT bug led to customer accounts being created twice) or related to data manipulations (e.g. an intermediary data table is built in such a way that there are duplicate rows).", "Identifying the root cause of the creation of duplicates will help you tackle the problem at the right level. Hence, if the problem comes from operational or technical issues, you may turn to the department in charge (Operations or IT for the two first cases in my example). If the problem comes from data manipulation, there are some actions that you can take to fix this problem on your own. By doing so, not only will your analysis be more reliable, but it will raise your awareness \u2014 and possibly the awareness of your colleagues \u2014 to avoid this problem in the future.", "As a general rule, better structuring your SQL code should prevent the majority of problems in unintentionally creating duplicate rows. In particular, if you clearly visualize your query output before even starting to write your code (as explained in this article), you should be able to avoid the creation of duplicates upfront.", "Now that you have identified the duplicates in your data set and that you have understood how they were created, you want to remove them from your output data table. By doing so, you will be able to conduct a correct analysis and make sure that your findings are reliable.", "Based on my own experience, here are three techniques to remove duplicates from a given data table. Using the previous example, these pieces of code allow me to remove duplicates from the table customers, assuming that each customer is defined by a unique combination of their email address and their date of birth.", "A preliminary query is written to retrieve the unique fields related to each customer (in this example, email_address and date_of_birth). Then this sub-query is placed into a WITH clause and is called list. This becomes the first data source of the main query, which is LEFT JOIN-ed on the initial table customers.", "This technique uses the function FIRST_VALUE combined with the PARTITION BY clause. For the initially defined fields (here, email_address and date_of_birth) these functions take the first value of the field customer_first_name (respectively customer_last_name) encountered within the data table customers.", "Similarly to the previous technique, using the GROUP BY clause enables the user to define in which way the non-unique fields (here, customer_first_name and customer_last_name) must be aggregated for each customer. This technique is particularly useful for numeric fields, but it also works for string fields.", "All three techniques lead to the same result: duplicates are removed from the data set. As they use different logical paths and SQL functions, you may find one method clearer or more practical than the other depending on your background and your proficiency level in SQL. Feel free to use the one you are most comfortable with!", "Did you enjoy reading this article? Become a member and join a growing community of curious minds!", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data x Strategy. Contributor @ Towards Data Science. Sharing tips and lessons learned along my data science journey!"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F4b017465d6dc&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-deal-with-duplicate-entries-using-sql-4b017465d6dc&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-deal-with-duplicate-entries-using-sql-4b017465d6dc&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-deal-with-duplicate-entries-using-sql-4b017465d6dc&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-deal-with-duplicate-entries-using-sql-4b017465d6dc&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://me.dm/@marielefevre", "anchor_text": "Mastodon"}, {"url": "https://towardsdatascience.com/?source=post_page-----4b017465d6dc--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----4b017465d6dc--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://marielefevre.medium.com/?source=post_page-----4b017465d6dc--------------------------------", "anchor_text": ""}, {"url": "https://marielefevre.medium.com/?source=post_page-----4b017465d6dc--------------------------------", "anchor_text": "Marie Lefevre"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F2a04bf49928f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-deal-with-duplicate-entries-using-sql-4b017465d6dc&user=Marie+Lefevre&userId=2a04bf49928f&source=post_page-2a04bf49928f----4b017465d6dc---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F4b017465d6dc&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-deal-with-duplicate-entries-using-sql-4b017465d6dc&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F4b017465d6dc&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-deal-with-duplicate-entries-using-sql-4b017465d6dc&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@vincentvanzalinge?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Vincent van Zalinge"}, {"url": "https://unsplash.com/?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://towardsdatascience.com/3-simple-tricks-to-better-structure-your-sql-queries-f5e3b38d58e2", "anchor_text": "this article"}, {"url": "https://towardsdatascience.com/3-simple-tricks-to-better-structure-your-sql-queries-f5e3b38d58e2", "anchor_text": "3 Simple Tricks to Better Structure Your SQL QueriesAnd a Hands-on Example to Apply Them Right Awaytowardsdatascience.com"}, {"url": "https://marie-lefevre.medium.com/membership", "anchor_text": "Become a member"}, {"url": "https://marie-lefevre.medium.com/membership", "anchor_text": "Join Medium!As a Medium member, a portion of your membership fee goes to writers you read, and you get full access to every story\u2026marie-lefevre.medium.com"}, {"url": "https://medium.com/tag/sql?source=post_page-----4b017465d6dc---------------sql-----------------", "anchor_text": "Sql"}, {"url": "https://medium.com/tag/programming?source=post_page-----4b017465d6dc---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/tag/data-cleaning?source=post_page-----4b017465d6dc---------------data_cleaning-----------------", "anchor_text": "Data Cleaning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----4b017465d6dc---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/data-analysis?source=post_page-----4b017465d6dc---------------data_analysis-----------------", "anchor_text": "Data Analysis"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F4b017465d6dc&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-deal-with-duplicate-entries-using-sql-4b017465d6dc&user=Marie+Lefevre&userId=2a04bf49928f&source=-----4b017465d6dc---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F4b017465d6dc&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-deal-with-duplicate-entries-using-sql-4b017465d6dc&user=Marie+Lefevre&userId=2a04bf49928f&source=-----4b017465d6dc---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F4b017465d6dc&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-deal-with-duplicate-entries-using-sql-4b017465d6dc&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----4b017465d6dc--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F4b017465d6dc&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-deal-with-duplicate-entries-using-sql-4b017465d6dc&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----4b017465d6dc---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----4b017465d6dc--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----4b017465d6dc--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----4b017465d6dc--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----4b017465d6dc--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----4b017465d6dc--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----4b017465d6dc--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----4b017465d6dc--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----4b017465d6dc--------------------------------", "anchor_text": ""}, {"url": "https://marielefevre.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://marielefevre.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Marie Lefevre"}, {"url": "https://marielefevre.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "2.1K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F2a04bf49928f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-deal-with-duplicate-entries-using-sql-4b017465d6dc&user=Marie+Lefevre&userId=2a04bf49928f&source=post_page-2a04bf49928f--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Febadf9747693&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-deal-with-duplicate-entries-using-sql-4b017465d6dc&newsletterV3=2a04bf49928f&newsletterV3Id=ebadf9747693&user=Marie+Lefevre&userId=2a04bf49928f&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}