{"url": "https://towardsdatascience.com/scale-standardize-or-normalize-with-scikit-learn-6ccc7d176a02", "time": 1682995260.00786, "path": "towardsdatascience.com/scale-standardize-or-normalize-with-scikit-learn-6ccc7d176a02/", "webpage": {"metadata": {"title": "Scale, Standardize, or Normalize with Scikit-Learn | by Jeff Hale | Towards Data Science", "h1": "Scale, Standardize, or Normalize with Scikit-Learn", "description": "Many machine learning algorithms work better when features are on a relatively similar scale and close to normally distributed. MinMaxScaler, RobustScaler, StandardScaler, and Normalizer are\u2026"}, "outgoing_paragraph_urls": [{"url": "https://scikit-learn.org/stable/index.html", "anchor_text": "scikit-learn", "paragraph_index": 0}, {"url": "https://en.wikipedia.org/wiki/Scaling_(geometry)", "anchor_text": "Scale", "paragraph_index": 3}, {"url": "https://en.wikipedia.org/wiki/Standard_score", "anchor_text": "Standardize", "paragraph_index": 4}, {"url": "https://en.wikipedia.org/wiki/Normalization_(statistics)", "anchor_text": "Normalize", "paragraph_index": 5}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.MinMaxScaler.html#sklearn.preprocessing.MinMaxScaler", "anchor_text": "MinMaxScaler", "paragraph_index": 16}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.RobustScaler.html", "anchor_text": "RobustScaler", "paragraph_index": 23}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.StandardScaler.html", "anchor_text": "StandardScaler", "paragraph_index": 28}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.Normalizer.html", "anchor_text": "Normalizer", "paragraph_index": 34}, {"url": "https://memorablepython.com", "anchor_text": "Python", "paragraph_index": 45}, {"url": "https://memorabledocker.com", "anchor_text": "Docker", "paragraph_index": 45}, {"url": "https://memorablesql.com", "anchor_text": "SQL", "paragraph_index": 45}, {"url": "https://memorablepandas.com", "anchor_text": "pandas", "paragraph_index": 45}, {"url": "https://medium.com/@jeffhale", "anchor_text": "here", "paragraph_index": 45}, {"url": "https://dataawesome.com", "anchor_text": "https://dataawesome.com", "paragraph_index": 47}], "all_paragraphs": ["Many machine learning algorithms work better when features are on a relatively similar scale and close to normally distributed. MinMaxScaler, RobustScaler, StandardScaler, and Normalizer are scikit-learn methods to preprocess data for machine learning. Which method you need, if any, depends on your model type and your feature values.", "This guide will highlight the differences and similarities among these methods and help you learn when to reach for which tool.", "As often as these methods appear in machine learning workflows, I found it difficult to find information about which of them to use when. Commentators often use the terms scale, standardize, and normalize interchangeably. However, their are some differences and the four scikit-learn functions we will examine do different things.", "Scale generally means to change the range of the values. The shape of the distribution doesn\u2019t change. Think about how a scale model of a building has the same proportions as the original, just smaller. That\u2019s why we say it is drawn to scale. The range is often set at 0 to 1.", "Standardize generally means changing the values so that the distribution\u2019s standard deviation equals one. Scaling is often implied.", "Normalize can be used to mean either of the above things (and more!). I suggest you avoid the term normalize, because it has many definitions and is prone to creating confusion.", "If you use any of these terms in your communication, I strongly suggest you define them.", "Many machine learning algorithms perform better or converge faster when features are on a relatively similar scale and/or close to normally distributed. Examples of such algorithm families include:", "Scaling and standardizing can help features arrive in more digestible form for these algorithms.", "The four scikit-learn preprocessing methods we are examining follow the API shown below. X_train and X_test are the usual numpy ndarrays or pandas DataFrames.", "We\u2019ll look at a number of distributions and apply each of the four scikit-learn methods to them.", "I created four distributions with different characteristics. The distributions are:", "The values all are of relatively similar scale, as can be seen on the x-axis of the Kernel Density Estimate plot (kdeplot) below.", "Then I added a sixth distribution with much larger values (normally distributed) \u2014 normal.", "Now our kdeplot looks like this:", "Squint hard at the monitor and you might notice the tiny green bar of big values to the right. Here are the descriptive statistics for our features.", "For each value in a feature, MinMaxScaler subtracts the minimum value in the feature and then divides by the range. The range is the difference between the original maximum and original minimum.", "MinMaxScaler preserves the shape of the original distribution. It doesn\u2019t meaningfully change the information embedded in the original data.", "Note that MinMaxScaler doesn\u2019t reduce the importance of outliers.", "The default range for the feature returned by MinMaxScaler is 0 to 1.", "Here\u2019s the kdeplot after MinMaxScaler has been applied.", "Notice how the features are all on the same relative scale. The relative spaces between each feature\u2019s values have been maintained.", "MinMaxScaler isn\u2019t a bad place to start, unless you know you want your feature to have a normal distribution or you have outliers and you want them to have reduced influence.", "RobustScaler transforms the feature vector by subtracting the median and then dividing by the interquartile range (75% value \u2014 25% value).", "Like MinMaxScaler, our feature with large values \u2014 normal-big \u2014 is now of similar scale to the other features. Note that RobustScaler does not scale the data into a predetermined interval like MinMaxScaler. It does not meet the strict definition of scale I introduced earlier.", "Note that the range for each feature after RobustScaler is applied is larger than it was for MinMaxScaler.", "Use RobustScaler if you want to reduce the effects of outliers, relative to MinMaxScaler.", "StandardScaler is the industry\u2019s go-to algorithm. \ud83d\ude42", "StandardScaler standardizes a feature by subtracting the mean and then scaling to unit variance. Unit variance means dividing all the values by the standard deviation. StandardScaler does not meet the strict definition of scale I introduced earlier.", "StandardScaler results in a distribution with a standard deviation equal to 1. The variance is equal to 1 also, because variance = standard deviation squared. And 1 squared = 1.", "StandardScaler makes the mean of the distribution approximately 0.", "In the plot above, you can see that all four distributions have a mean close to zero and unit variance. The values are on a similar scale, but the range is larger than after MinMaxScaler.", "Deep learning algorithms often call for zero mean and unit variance. Regression-type algorithms also benefit from normally distributed data with small sample sizes.", "Now let\u2019s have a look at Normalizer.", "Normalizer works on the rows, not the columns! I find that very unintuitive. It\u2019s easy to miss this information in the docs.", "By default, L2 normalization is applied to each observation so the that the values in a row have a unit norm. Unit norm with L2 means that if each element were squared and summed, the total would equal 1. Alternatively, L1 (aka taxicab or Manhattan) normalization can be applied instead of L2 normalization.", "Normalizer does transform all the features to values between -1 and 1 (this text updated July 2019). In our example, normal_big ends up with all its values transformed to .9999999.", "Have you found good use cases for Normalizer? If so, please let me know on Twitter @discdiver.", "In most cases one of the other preprocessing tools above will be more helpful.", "Again, scikit-learn\u2019s Normalizer works on the rows, not the columns.", "Here are plots of the original distributions before and after MinMaxScaler, RobustScaler, and StandardScaler have been applied.", "Note that after any of these three transformations the values are on a similar scale. \ud83c\udf89", "Scaling and standardizing your data is often a good idea. I highly recommend using a StandardScaler prior to feeding the data to a deep learning algorithm or one that depends upon the relative distance of the observations, or that uses L2 regularization. Note that StandardScaling can make interpretation of regression coefficients a bit trickier. \ud83d\ude09", "In this article you\u2019ve seen how scikit-learn can help you scale, standardize, and normalize your data. ***I updated the images and some text this article in August 2021. Thank you to readers for feedback!***", "I hope you found this guide helpful. If you did, please share it on your favorite social media channel. \ud83d\udc4f", "I write about Python, Docker, SQL, pandas, and other data science topics. If any of those topics interest you, read more here and follow me on Medium. \ud83d\ude03", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "I write about data science. Join my Data Awesome mailing list to stay on top of the latest data tools and tips: https://dataawesome.com"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F6ccc7d176a02&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fscale-standardize-or-normalize-with-scikit-learn-6ccc7d176a02&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fscale-standardize-or-normalize-with-scikit-learn-6ccc7d176a02&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fscale-standardize-or-normalize-with-scikit-learn-6ccc7d176a02&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fscale-standardize-or-normalize-with-scikit-learn-6ccc7d176a02&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----6ccc7d176a02--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----6ccc7d176a02--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://jeffhale.medium.com/?source=post_page-----6ccc7d176a02--------------------------------", "anchor_text": ""}, {"url": "https://jeffhale.medium.com/?source=post_page-----6ccc7d176a02--------------------------------", "anchor_text": "Jeff Hale"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F451599b1142a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fscale-standardize-or-normalize-with-scikit-learn-6ccc7d176a02&user=Jeff+Hale&userId=451599b1142a&source=post_page-451599b1142a----6ccc7d176a02---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F6ccc7d176a02&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fscale-standardize-or-normalize-with-scikit-learn-6ccc7d176a02&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F6ccc7d176a02&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fscale-standardize-or-normalize-with-scikit-learn-6ccc7d176a02&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://scikit-learn.org/stable/index.html", "anchor_text": "scikit-learn"}, {"url": "https://www.kaggle.com/discdiver/guide-to-scaling-and-standardizing", "anchor_text": "here"}, {"url": "https://scikit-learn.org/stable/index.html", "anchor_text": "scikit-learn v0.20.3"}, {"url": "https://en.wikipedia.org/wiki/Scaling_(geometry)", "anchor_text": "Scale"}, {"url": "https://en.wikipedia.org/wiki/Standard_score", "anchor_text": "Standardize"}, {"url": "https://en.wikipedia.org/wiki/Normalization_(statistics)", "anchor_text": "Normalize"}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.MinMaxScaler.html#sklearn.preprocessing.MinMaxScaler", "anchor_text": "MinMaxScaler"}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.RobustScaler.html", "anchor_text": "RobustScaler"}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.StandardScaler.html", "anchor_text": "StandardScaler"}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.Normalizer.html", "anchor_text": "Normalizer"}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.QuantileTransformer.html", "anchor_text": "QuantileTransformer(output_distribution='normal')"}, {"url": "https://docs.google.com/spreadsheets/d/1woVi7wq13628HJ-tN6ApaRGVZ85OdmHsDBKLAf5ylaQ/edit?usp=sharing", "anchor_text": "cheat sheet I made in a Google Sheet"}, {"url": "http://scikit-learn.org/stable/modules/preprocessing.html#preprocessing-scaler", "anchor_text": "Here\u2019s a scikit-learn doc"}, {"url": "http://scikit-learn.org/stable/auto_examples/preprocessing/plot_all_scaling.html#sphx-glr-auto-examples-preprocessing-plot-all-scaling-py.", "anchor_text": "Here\u2019s another doc"}, {"url": "https://medium.com/@srowen/common-probability-distributions-347e6b945ce4", "anchor_text": "Here\u2019s a nice guide"}, {"url": "https://medium.com/u/c145ff55eeea?source=post_page-----6ccc7d176a02--------------------------------", "anchor_text": "Sean Owen"}, {"url": "http://benalexkeen.com/feature-scaling-with-scikit-learn/", "anchor_text": "Here\u2019s another guide"}, {"url": "https://memorablepython.com", "anchor_text": "Python"}, {"url": "https://memorabledocker.com", "anchor_text": "Docker"}, {"url": "https://memorablesql.com", "anchor_text": "SQL"}, {"url": "https://memorablepandas.com", "anchor_text": "pandas"}, {"url": "https://medium.com/@jeffhale", "anchor_text": "here"}, {"url": "https://dataawesome.com", "anchor_text": ""}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----6ccc7d176a02---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----6ccc7d176a02---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/python?source=post_page-----6ccc7d176a02---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/towards-data-science?source=post_page-----6ccc7d176a02---------------towards_data_science-----------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/tag/statistics?source=post_page-----6ccc7d176a02---------------statistics-----------------", "anchor_text": "Statistics"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F6ccc7d176a02&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fscale-standardize-or-normalize-with-scikit-learn-6ccc7d176a02&user=Jeff+Hale&userId=451599b1142a&source=-----6ccc7d176a02---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F6ccc7d176a02&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fscale-standardize-or-normalize-with-scikit-learn-6ccc7d176a02&user=Jeff+Hale&userId=451599b1142a&source=-----6ccc7d176a02---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F6ccc7d176a02&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fscale-standardize-or-normalize-with-scikit-learn-6ccc7d176a02&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----6ccc7d176a02--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F6ccc7d176a02&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fscale-standardize-or-normalize-with-scikit-learn-6ccc7d176a02&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----6ccc7d176a02---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----6ccc7d176a02--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----6ccc7d176a02--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----6ccc7d176a02--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----6ccc7d176a02--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----6ccc7d176a02--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----6ccc7d176a02--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----6ccc7d176a02--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----6ccc7d176a02--------------------------------", "anchor_text": ""}, {"url": "https://jeffhale.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://jeffhale.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Jeff Hale"}, {"url": "https://jeffhale.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "18K Followers"}, {"url": "https://dataawesome.com", "anchor_text": "https://dataawesome.com"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F451599b1142a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fscale-standardize-or-normalize-with-scikit-learn-6ccc7d176a02&user=Jeff+Hale&userId=451599b1142a&source=post_page-451599b1142a--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fe7ae6804f27a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fscale-standardize-or-normalize-with-scikit-learn-6ccc7d176a02&newsletterV3=451599b1142a&newsletterV3Id=e7ae6804f27a&user=Jeff+Hale&userId=451599b1142a&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}