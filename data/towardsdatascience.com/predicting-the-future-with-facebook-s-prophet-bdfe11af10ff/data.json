{"url": "https://towardsdatascience.com/predicting-the-future-with-facebook-s-prophet-bdfe11af10ff", "time": 1682995484.7660108, "path": "towardsdatascience.com/predicting-the-future-with-facebook-s-prophet-bdfe11af10ff/", "webpage": {"metadata": {"title": "Predicting the \u2018Future\u2019 with Facebook\u2019s Prophet | by Parul Pandey | Medium", "h1": "Predicting the \u2018Future\u2019 with Facebook\u2019s Prophet", "description": "Forecasting is a technique that uses historical data as inputs to make informed estimates that are predictive in determining the direction of future trends. It is an important and common data science\u2026"}, "outgoing_paragraph_urls": [{"url": "https://peerj.com/preprints/3190.pdf", "anchor_text": "Creators of Prophet", "paragraph_index": 0}, {"url": "https://www.investopedia.com/terms/f/forecasting.asp", "anchor_text": "Forecasting", "paragraph_index": 1}, {"url": "https://facebook.github.io/prophet/", "anchor_text": "Prophet", "paragraph_index": 2}, {"url": "https://github.com/parulnith/Predicting-the-Future-with-Facebook-s-Prophet/blob/master/README.md", "anchor_text": "Github Repository", "paragraph_index": 6}, {"url": "https://medium.com/@parulnith", "anchor_text": "Medium account", "paragraph_index": 7}, {"url": "https://peerj.com/preprints/3190.pdf", "anchor_text": "paper", "paragraph_index": 9}, {"url": "https://code.facebook.com/projects/", "anchor_text": "open source software", "paragraph_index": 14}, {"url": "https://research.fb.com/category/data-science/", "anchor_text": "Core Data Science team", "paragraph_index": 14}, {"url": "https://cran.r-project.org/package=prophet", "anchor_text": "CRAN", "paragraph_index": 14}, {"url": "https://pypi.python.org/pypi/fbprophet/", "anchor_text": "PyPI", "paragraph_index": 14}, {"url": "http://mc-stan.org/", "anchor_text": "Stan", "paragraph_index": 14}, {"url": "http://pystan.readthedocs.io/en/latest/installation_beginner.html", "anchor_text": "installation instructions", "paragraph_index": 14}, {"url": "http://pystan.readthedocs.io/en/latest/windows.html", "anchor_text": "follow the instructions", "paragraph_index": 15}, {"url": "https://visualstudio.microsoft.com/visual-cpp-build-tools/", "anchor_text": "C++ compiler", "paragraph_index": 15}, {"url": "https://towardsdatascience.com/from-r-vs-python-to-r-and-python-aa25db33ce17", "anchor_text": "From \u2018R vs Python\u2019 to \u2018R and Python\u2019", "paragraph_index": 19}, {"url": "https://facebook.github.io/prophet/docs/seasonality,_holiday_effects,_and_regressors.html#modeling-holidays-and-special-events", "anchor_text": "here", "paragraph_index": 35}], "all_paragraphs": ["When hundreds or even thousands of forecasts are made, it becomes important to let machines do the hard work of model evaluation and comparison while efficiently using human feedback to fix performance problems :Creators of Prophet", "Forecasting is a technique that uses historical data as inputs to make informed estimates that are predictive in determining the direction of future trends. It is an important and common data science task in organisations today. Having prior knowledge of any event can help a company tremendously in the formulation of its goals, policies and planning. However, producing high-quality and reliable forecasts comes with challenges of its own. Forecasting is a complex phenomenon both for humans and for machines. It also requires very experienced time series analysts which as a matter of fact are quite rare.", "Prophet is a tool that has been built to address these issues and provides a practical approach to forecasting \u201cat scale\u201d. It intends to automate the common features of business time series by providing simple and tunable methods. Prophet enables the analysts with a variety of backgrounds to make more forecasts than they can do manually.", "Just like Charity should begin at home, Data Science should also follow suit. Today, we are surrounded by so much data right from our smartphones to fitness bands to smart TVs to our activity on the web. We can easily analyse this data to know ourselves better. This would also be better than repeatedly working with the age-old Titanic or Iris database.", "I have been writing on Medium for quite some time now and I thought why not make use of this data. Since Prophet appears so promising, I thought of trying it out to predict the number of views that my articles will get on Medium in the next few days. Not only will this be interesting, but I will also get an idea about the popularity index of my articles in advance.", "I will update this article at the end of April by posting in the actual views that I get compared to the predictions, to check the Prophet\u2019s accuracy.", "The code for this article can be accessed from the associated Github Repository or you can view it on my binder by clicking the image below.", "The data has been taken from the Stats page of my Medium account. I have the data from 2nd July 2018 till 21st March 2019, both dates inclusive.", "Prophet is a procedure for forecasting time series data based on an additive model where non-linear trends are fit with yearly, weekly, and daily seasonality, plus holiday effects. It works best with time series that have strong seasonal effects and several seasons of historical data. Prophet is robust to missing data and shifts in the trend, and typically handles outliers well.", "There is a white paper published by the creators of Prophet library. The paper highlights two main scenarios which were the motivation for the research behind Prophet.", "First, completely automatic forecasting techniques can be hard to tune and are often too inflexible to incorporate useful assumptions or heuristics.", "Second, the analysts responsible for data science tasks throughout an organization typically have deep domain expertise about the specific products or services that they support, but often do not have training in time series forecasting. Analysts who can produce high quality forecasts are thus quite rare because forecasting is a specialized skill requiring substantial experience", "Prophet follows an analyst-in-the-loop approach to business forecasting at scale.", "This approach begins by modelling a time series using the parameters specified by analysts, producing forecasts and then evaluating them. Whenever a performance issue or a need for human intervention crops up, these issues are flagged to human analysts so that they can then inspect the forecast and potentially adjust the model based on this feedback.", "Prophet is an open source software released by Facebook\u2019s Core Data Science team. It is available for download on CRAN and PyPI. The complex statistical modelling is handled by the Stan library and is a prerequisite for Prophet. PyStan has its own installation instructions.", "On Windows, PyStan requires a compiler so you\u2019ll need to follow the instructions. The key step is installing a recent C++ compiler. Go through the installation instructions below to get everything in place properly.", "In this article, I will use the Python API of Prophet so here is how I installed it on my system.", "The input to Prophet is always a dataframe with two columns: ds and y. The ds(datestamp) column should be of a format expected by Pandas, ideally YYYY-MM-DD for a date or YYYY-MM-DD HH:MM: SS for a timestamp. The y column must be numeric and represents the measurement we wish to forecast.", "For this analysis, I shall be using an excel file that contains the total \u2018Views\u2019 that my articles have garnered to date. I roughly started writing on Medium in July 2018 and have published about 53 blogs in this time period.", "The plot shows a more or less upward trend but we will have to do further analysis to arrive at a concrete conclusion. Also, there appears to be a possible outlier around March\u20192019. On inspecting the data, I found that this appears around 8th March which was when I published the article: From \u2018R vs Python\u2019 to \u2018R and Python\u2019. There was a sudden spike on that day with maximum views reaching up to 17,688.", "Since this was just a single day phenomenon, it can be considered as an outlier. We can use natural logarithm for distribution of such data where some values are too large for some periods and other values are too small for other periods. To reduce the impact of these outliers on our data, we take the natural log of the entire distribution (instead of the raw values) to normalize the distribution of the data.", "Let\u2019s convert the data in the format desired by Prophet. We shall rename \u2018Date\u2019: \u2018ds\u2019 and \u2018Views\u2019: \u2018y\u2019", "Prophet follows the sklearn model API wherein an instance of the Prophet class is created and then the fit and predict methods are called. The model is instantiated by a new Prophet object and followed by calling its fit method and passing in the historical dataframe.", "Prophet will by default fit weekly and yearly seasonalities if the time series is more than two cycles long. It will also fit daily seasonality for a sub-daily time series. You can add other seasonalities (monthly, quarterly, hourly)if required.", "By default, Prophet uses a linear model for its forecast but a logistic model can also be used by passing it as an attribute.", "For forecasting, we need to tell Prophet how far to predict in future. For this, we need to make a dataframe for future predictions using make_future_dataframe . I would only like to predict the views for the next 60 days.", "forecast is essentially a pandas dataframe and consists of a lot of fields. The predict method will assign each row in future a predicted value which it names yhat and the range is defined by yhat_lower andyhat_upper . These ranges can be considered as uncertainty levels.", "To see the last 5 predicted values, we need to use the tail function. I will use the Transpose function to transpose the dataframe so that all the columns are visible. The screenshot below shows the predicted values from 16th May\u20192019 to 20th May\u20192019.", "However, we are only interested in the yhat, yhat_lower and y_hat_upper values but I have shown these values above to highlight the Prophet\u2019s ability to infer various values from the given data. Essentially, our desired dataframe will be as follows:", "Since we took the log of Views, let\u2019s convert back to original values", "Visualisation, especially in Time Series data, makes more sense than mere numbers. Let\u2019s plot the forecast by calling the Prophet.plot method and passing in the forecast dataframe.", "We can also see the forecast components, by using the Prophet.plot_components method. This will show us the daily and weekly trends which makes the picture more clear. If you have data pertaining to different years, you can enable the yearly_seasonality to observe the yearly trends also.", "The trend shows an increase in the views with time which is good. Also, more views are garnered from Monday to Friday than at the weekends. The daily trend is more or less constant.", "Holidays and events provide large, somewhat predictable shocks to many business time series and often do not follow a periodic pattern, so their effects are not well modelled by a smooth cycle. Prophet gives the ability to include the fluctuations caused by these holidays or special events in the forecast model.", "I have observed that there is a sudden spike in the views the day I publish my article. This phenomenon lasts for about 4 to 5 days and then there is a decline. So, I can consider the day of publishing my article as a holiday. Also, I will define an upper_window consisting of 5 days for which there is an increased viewership.", "\u201cThe Columns lower_window and upper_window extend the holiday out to [lower_window, upper_window] days around the date. For instance, if you wanted to include Christmas Eve in addition to Christmas you\u2019d include lower_window=-1,upper_window=0. If you wanted to use Black Friday in addition to Thanksgiving, you\u2019d include lower_window=0,upper_window=1\".Read more about holiday effect here.", "I will define a holiday dataframe that contains the dates and the holiday description. We can also pass future dates in the dataframe. Since I will publish this article on 23rd March 2019, I have also included it in the database.", "Once the dataframe has been created, holiday effects can be included in the forecast by passing them in with the holidaysargument and the rest of the forecasting process remain the same as above:", "Let\u2019s plot the components again. This time we will also see the trend for the holidays.", "Now that we have an idea about Prophet and its functionalities, let\u2019s predict the future views that my Medium Blog will get based on the historical data. Let\u2019s predict the views from 23rd\u2019March,2018 to 6th\u2019April, 2019.", "The process remains the same as above except that we shall introduce a parameter called mcmc_samples. By default, Prophet will only return uncertainty in the trend and observation noise. To get uncertainty in seasonality, you must do full Bayesian sampling. This is done using the parameter mcmc.samples (which defaults to 0). There are many other ways to tweak the model and I would encourage you to go through the documentation in detail.", "The model predicts around 5k views on the day of the publishing of this article. However, the actual spike comes on Monday. This is in conformity with our model which predicted that more views are observed on weekdays than on weekends.", "This was an interesting study and it\u2019ll be great to analyse the results when I get the actual views. Having said that, Prophet does make the entire forecasting process easy and intuitive and also gives a lot of options. The actual advantage of this model can only be assessed on large datasets but Prophet does enable forecasting a large number and a variety of time series problems \u2014 which is truly forecasting at scale.", "Principal Data Scientist @H2O.ai | Author of Machine Learning for High-Risk Applications", "Principal Data Scientist @H2O.ai | Author of Machine Learning for High-Risk Applications"], "all_outgoing_urls": [{"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----bdfe11af10ff--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----bdfe11af10ff--------------------------------", "anchor_text": "Parul Pandey"}, {"url": "https://unsplash.com/@imjustintime?utm_source=medium&utm_medium=referral", "anchor_text": "Justin Clark"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://peerj.com/preprints/3190.pdf", "anchor_text": "Creators of Prophet"}, {"url": "https://www.investopedia.com/terms/f/forecasting.asp", "anchor_text": "Forecasting"}, {"url": "https://facebook.github.io/prophet/", "anchor_text": "Prophet"}, {"url": "https://github.com/parulnith/Predicting-the-Future-with-Facebook-s-Prophet/blob/master/README.md", "anchor_text": "Github Repository"}, {"url": "https://mybinder.org/v2/gh/parulnith/Predicting-the-Future-with-Facebook-s-Prophet/master?filepath=Forecasting%20Views%20for%20a%20Medium%20article%20using%20Prophet..ipynb", "anchor_text": ""}, {"url": "https://medium.com/@parulnith", "anchor_text": "Medium account"}, {"url": "https://peerj.com/preprints/3190.pdf", "anchor_text": "paper"}, {"url": "https://peerj.com/preprints/3190.pdf", "anchor_text": "Schematic view of the analyst-in-the-loop approach to forecasting at scale"}, {"url": "https://code.facebook.com/projects/", "anchor_text": "open source software"}, {"url": "https://research.fb.com/category/data-science/", "anchor_text": "Core Data Science team"}, {"url": "https://cran.r-project.org/package=prophet", "anchor_text": "CRAN"}, {"url": "https://pypi.python.org/pypi/fbprophet/", "anchor_text": "PyPI"}, {"url": "http://mc-stan.org/", "anchor_text": "Stan"}, {"url": "http://pystan.readthedocs.io/en/latest/installation_beginner.html", "anchor_text": "installation instructions"}, {"url": "http://pystan.readthedocs.io/en/latest/windows.html", "anchor_text": "follow the instructions"}, {"url": "https://visualstudio.microsoft.com/visual-cpp-build-tools/", "anchor_text": "C++ compiler"}, {"url": "https://facebook.github.io/prophet/docs/installation.html", "anchor_text": "InstallationProphet has two implementations: R and Python. Note the slight name difference for the Python package.facebook.github.io"}, {"url": "https://towardsdatascience.com/from-r-vs-python-to-r-and-python-aa25db33ce17", "anchor_text": "From \u2018R vs Python\u2019 to \u2018R and Python\u2019"}, {"url": "https://facebook.github.io/prophet/docs/seasonality,_holiday_effects,_and_regressors.html#specifying-custom-seasonalities", "anchor_text": "Seasonalities"}, {"url": "https://facebook.github.io/prophet/docs/saturating_forecasts.html#forecasting-growth", "anchor_text": "Forecasting"}, {"url": "https://facebook.github.io/prophet/docs/seasonality,_holiday_effects,_and_regressors.html#modeling-holidays-and-special-events", "anchor_text": "here"}, {"url": "https://github.com/facebookincubator/prophet", "anchor_text": "Prophet repository"}, {"url": "https://facebookincubator.github.io/prophet/docs/quick_start.html", "anchor_text": "Prophet documentation"}, {"url": "https://facebookincubator.github.io/prophet/static/prophet_paper_20170113.pdf", "anchor_text": "\u201cForecasting at scale\u201d"}, {"url": "http://pbpython.com/prophet-overview.html", "anchor_text": "Forecasting Website Traffic Using Facebook\u2019s Prophet Library"}, {"url": "https://medium.com/tag/data-science?source=post_page-----bdfe11af10ff---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----bdfe11af10ff---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/time-series-forecasting?source=post_page-----bdfe11af10ff---------------time_series_forecasting-----------------", "anchor_text": "Time Series Forecasting"}, {"url": "https://medium.com/tag/python?source=post_page-----bdfe11af10ff---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/towards-data-science?source=post_page-----bdfe11af10ff---------------towards_data_science-----------------", "anchor_text": "Towards Data Science"}, {"url": "https://towardsdatascience.com/?source=post_page-----bdfe11af10ff--------------------------------", "anchor_text": "More from Parul Pandey"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F5be6ccf82bc8&operation=register&redirect=https%3A%2F%2Fpandeyparul.medium.com%2Fpredicting-the-future-with-facebook-s-prophet-bdfe11af10ff&newsletterV3=7053de462a28&newsletterV3Id=5be6ccf82bc8&user=Parul+Pandey&userId=7053de462a28&source=-----bdfe11af10ff---------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://medium.com/?source=post_page-----bdfe11af10ff--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----bdfe11af10ff--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----bdfe11af10ff--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----bdfe11af10ff--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----bdfe11af10ff--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----bdfe11af10ff--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----bdfe11af10ff--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/plans?source=upgrade_membership---two_column_layout_sidebar----------------------------------", "anchor_text": "Get unlimited access"}, {"url": "https://towardsdatascience.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Parul Pandey"}, {"url": "https://towardsdatascience.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "20K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F5be6ccf82bc8&operation=register&redirect=https%3A%2F%2Fpandeyparul.medium.com%2Fpredicting-the-future-with-facebook-s-prophet-bdfe11af10ff&newsletterV3=7053de462a28&newsletterV3Id=5be6ccf82bc8&user=Parul+Pandey&userId=7053de462a28&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}