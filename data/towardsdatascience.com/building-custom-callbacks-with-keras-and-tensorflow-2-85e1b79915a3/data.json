{"url": "https://towardsdatascience.com/building-custom-callbacks-with-keras-and-tensorflow-2-85e1b79915a3", "time": 1683018321.7861602, "path": "towardsdatascience.com/building-custom-callbacks-with-keras-and-tensorflow-2-85e1b79915a3/", "webpage": {"metadata": {"title": "Building Custom Callbacks with Keras and TensorFlow 2 | by B. Chen | Towards Data Science", "h1": "Building Custom Callbacks with Keras and TensorFlow 2", "description": "Callbacks are an important type of object in Keras and TensorFlow. They are designed to be able to monitor the model performance in metrics at certain points in the training run and perform some\u2026"}, "outgoing_paragraph_urls": [{"url": "https://github.com/BindiChen/machine-learning/blob/master/tensorflow2/008-keras-custom-callback/keras-custom-callback.ipynb", "anchor_text": "Notebook", "paragraph_index": 4}, {"url": "https://towardsdatascience.com/3-ways-to-create-a-machine-learning-model-with-keras-and-tensorflow-2-0-de09323af4d3", "anchor_text": "3 ways to create a machine learning model with Keras and TensorFlow 2.0", "paragraph_index": 12}, {"url": "https://towardsdatascience.com/learning-rate-schedule-in-practice-an-example-with-keras-and-tensorflow-2-0-2f48b2888a0c", "anchor_text": "learning rate schedules", "paragraph_index": 17}, {"url": "https://towardsdatascience.com/a-practical-introduction-to-keras-callbacks-in-tensorflow-2-705d0c584966", "anchor_text": "any other built-in callbacks", "paragraph_index": 17}, {"url": "https://keras.io/guides/writing_your_own_callbacks/#examples-of-keras-callback-applications", "anchor_text": "Writing your own callbacks", "paragraph_index": 31}, {"url": "https://keras.io/guides/writing_your_own_callbacks/#examples-of-keras-callback-applications", "anchor_text": "Writing your own callbacks", "paragraph_index": 34}, {"url": "https://keras.io/api/callbacks/", "anchor_text": "documentation", "paragraph_index": 37}, {"url": "https://github.com/BindiChen/machine-learning/blob/master/tensorflow2/008-keras-custom-callback/keras-custom-callback.ipynb", "anchor_text": "notebook", "paragraph_index": 38}, {"url": "https://github.com/BindiChen/machine-learning", "anchor_text": "Github", "paragraph_index": 39}], "all_paragraphs": ["Callbacks are an important type of object in Keras and TensorFlow. They are designed to be able to monitor the model performance in metrics at certain points in the training run and perform some actions that might depend on those performances in metric values.", "Keras has provided a number of built-in callbacks, for example, EarlyStopping, CSVLogger, ModelCheckpoint, LearningRateScheduler etc. Apart from these popular built-in callbacks, there is a base class called Callback which allows us to create our own callbacks and perform some custom actions. In this article, you will learn what is the Callback base class, what it can do, and how to build your own callbacks.", "If you want to learn more about those built-in callbacks, please check out the following article:", "Here is the outline of this article.", "Please check out Notebook for the source code.", "In TensorFlow, all callbacks are stored in the tensorflow.keras.callbacks module. Inside that module, there is a base class called Callback which all other callbacks inherit from. You can also subclass the Callback base class yourself to create your own callbacks.", "The base class Callback is constructed with the following methods that will be called at the appropriate time.", "Batch-level method (training, testing, and predicting)", "For the demonstration purpose, we will build an image classifier to tackle Fashion MNIST, which is a dataset that has 70,000 grayscale images of 28-by-28 pixels with 10 classes.", "Keras provides some utility functions to fetch and load common datasets, including Fashion MNIST. Let\u2019s load Fashion MNIST", "The dataset is already split into a training set and a test set. Here is the shape and data type of the training set:", "We are going to train the neural network using Gradient Descent, we must scale the input feature down to the 0\u20131 range. And for faster training on a local machine, let\u2019s just use the first 10,000 images.", "Now let\u2019s build the neural network! There are 3 ways to create a machine learning model with Keras and TensorFlow 2.0. Since we are building a simple fully connected neural network and for simplicity, let\u2019s use the easiest way: Sequential Model with Sequential().", "Our model has the following specifications:", "Firstly, let\u2019s import the base class Callback", "Then, we create a new class TrainningCallback() with the methods that will be called at the training time.", "Next, to use it for training, we just need to pass TrainingCallback() to the callbacks argument in the model.fit() method.", "We can see that TrainingCallback() get passed in a list to the callbacks argument. It is a list because in practice we might be passing a number of callbacks for performing different tasks, for example, debugging, learning rate schedules, or any other built-in callbacks.", "By executing the statement, you should get an output like below:", "Similarly, we can implement a custom callback TestingCallback() for testing.", "To use it for testing, pass it to the callbacks argument in the model.valutate() method.", "By executing the statement, you should get an output like below:", "Similarly, we can implement a custom callback PredictionCallback() for prediction.", "To use it for prediction, we just need to pass it to the callbacks argument in the model.predict() method.", "By executing the statement, you should get an output like below:", "A main application of callback is to perform some actions depend on performance metrics, for example:", "In this section, we are going to show you some examples of Keras custom callback applications.", "This first example shows the creation of a Callback that shows a live, real-time update of loss as your training progresses.", "self.losses=[] is initialized in on_train_begin() for holding losses. The real-time plot is implemented at the end of each epochon_epoch_end() by calling ax.plot(epochs, self.losses, \"b-\") and fig.canvas.draw() .", "To use it for training, we just need to pass it to the callbacks argument in the model.fit() method.", "By executing the statement, you should get a live real-time output like below:", "Note: this example is originally from Keras guide \u201cWriting your own callbacks\u201d, please check out the official documentation for details.", "This example shows the creation of a Callback that stops training when the minimum of loss has been reached, by setting the attribute self.model.stop_training (boolean). Optionally, you can provide an argument patience to specify how many epochs we should wait before stopping after having reached a local minimum.", "In this run, our training was stopped at epoch 28 as the minimum of loss has been reached", "Note: this example is originally from Keras guide \u201cWriting your own callbacks\u201d, please check out the official documentation for details.", "This example shows how a custom Callback can be used to dynamically change the learning rate of the optimizer during the course of training.", "Keras provides a base class called Callback which allows us to subclass it and create our own callbacks. It is really useful for debugging and perform some actions depend on performance metrics.", "I hope this article will help you to save time in creating your own custom callback and perform some custom actions. I recommend you to check out the documentation for the Callbacks API and to know about other things you can do.", "Thanks for reading. Please check out the notebook for the source code and stay tuned if you are interested in the practical aspect of machine learning.", "More can be found from my Github", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F85e1b79915a3&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-custom-callbacks-with-keras-and-tensorflow-2-85e1b79915a3&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-custom-callbacks-with-keras-and-tensorflow-2-85e1b79915a3&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-custom-callbacks-with-keras-and-tensorflow-2-85e1b79915a3&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-custom-callbacks-with-keras-and-tensorflow-2-85e1b79915a3&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----85e1b79915a3--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----85e1b79915a3--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://bindichen.medium.com/?source=post_page-----85e1b79915a3--------------------------------", "anchor_text": ""}, {"url": "https://bindichen.medium.com/?source=post_page-----85e1b79915a3--------------------------------", "anchor_text": "B. Chen"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F563d09da62a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-custom-callbacks-with-keras-and-tensorflow-2-85e1b79915a3&user=B.+Chen&userId=563d09da62a&source=post_page-563d09da62a----85e1b79915a3---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F85e1b79915a3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-custom-callbacks-with-keras-and-tensorflow-2-85e1b79915a3&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F85e1b79915a3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-custom-callbacks-with-keras-and-tensorflow-2-85e1b79915a3&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "http://www.canva.com/", "anchor_text": "www.canva.com"}, {"url": "https://towardsdatascience.com/a-practical-introduction-to-keras-callbacks-in-tensorflow-2-705d0c584966", "anchor_text": "A Practical Introduction to Keras Callbacks in TensorFlow 2A tutorial for most commonly used Keras Callbacks APItowardsdatascience.com"}, {"url": "https://github.com/BindiChen/machine-learning/blob/master/tensorflow2/008-keras-custom-callback/keras-custom-callback.ipynb", "anchor_text": "Notebook"}, {"url": "https://towardsdatascience.com/3-ways-to-create-a-machine-learning-model-with-keras-and-tensorflow-2-0-de09323af4d3", "anchor_text": "3 ways to create a machine learning model with Keras and TensorFlow 2.0"}, {"url": "https://towardsdatascience.com/learning-rate-schedule-in-practice-an-example-with-keras-and-tensorflow-2-0-2f48b2888a0c", "anchor_text": "learning rate schedules"}, {"url": "https://towardsdatascience.com/a-practical-introduction-to-keras-callbacks-in-tensorflow-2-705d0c584966", "anchor_text": "any other built-in callbacks"}, {"url": "https://keras.io/guides/writing_your_own_callbacks/#examples-of-keras-callback-applications", "anchor_text": "Writing your own callbacks"}, {"url": "https://keras.io/guides/writing_your_own_callbacks/#examples-of-keras-callback-applications", "anchor_text": "Writing your own callbacks"}, {"url": "https://keras.io/api/callbacks/", "anchor_text": "documentation"}, {"url": "https://github.com/BindiChen/machine-learning/blob/master/tensorflow2/008-keras-custom-callback/keras-custom-callback.ipynb", "anchor_text": "notebook"}, {"url": "https://towardsdatascience.com/a-practical-introduction-to-keras-callbacks-in-tensorflow-2-705d0c584966", "anchor_text": "A practical introduction to Keras Callbacks in TensorFlow 2"}, {"url": "https://towardsdatascience.com/learning-rate-schedule-in-practice-an-example-with-keras-and-tensorflow-2-0-2f48b2888a0c", "anchor_text": "Learning Rate Schedules in practice"}, {"url": "https://towardsdatascience.com/the-googles-7-steps-of-machine-learning-in-practice-a-tensorflow-example-for-structured-data-96ccbb707d77", "anchor_text": "The Google\u2019s 7 steps of Machine Learning in practice: a TensorFlow example for structured data"}, {"url": "https://towardsdatascience.com/3-ways-to-create-a-machine-learning-model-with-keras-and-tensorflow-2-0-de09323af4d3", "anchor_text": "3 ways to create a Machine Learning Model with Keras and TensorFlow 2.0"}, {"url": "https://towardsdatascience.com/batch-normalization-in-practice-an-example-with-keras-and-tensorflow-2-0-b1ec28bde96f", "anchor_text": "Batch normalization in practice: an example with Keras and TensorFlow 2.0"}, {"url": "https://towardsdatascience.com/a-practical-introduction-to-early-stopping-in-machine-learning-550ac88bc8fd", "anchor_text": "Early stopping in Practice: an example with Keras and TensorFlow"}, {"url": "https://github.com/BindiChen/machine-learning", "anchor_text": "Github"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----85e1b79915a3---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----85e1b79915a3---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/tensorflow?source=post_page-----85e1b79915a3---------------tensorflow-----------------", "anchor_text": "TensorFlow"}, {"url": "https://medium.com/tag/keras?source=post_page-----85e1b79915a3---------------keras-----------------", "anchor_text": "Keras"}, {"url": "https://medium.com/tag/callback?source=post_page-----85e1b79915a3---------------callback-----------------", "anchor_text": "Callback"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F85e1b79915a3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-custom-callbacks-with-keras-and-tensorflow-2-85e1b79915a3&user=B.+Chen&userId=563d09da62a&source=-----85e1b79915a3---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F85e1b79915a3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-custom-callbacks-with-keras-and-tensorflow-2-85e1b79915a3&user=B.+Chen&userId=563d09da62a&source=-----85e1b79915a3---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F85e1b79915a3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-custom-callbacks-with-keras-and-tensorflow-2-85e1b79915a3&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----85e1b79915a3--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F85e1b79915a3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-custom-callbacks-with-keras-and-tensorflow-2-85e1b79915a3&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----85e1b79915a3---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----85e1b79915a3--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----85e1b79915a3--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----85e1b79915a3--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----85e1b79915a3--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----85e1b79915a3--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----85e1b79915a3--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----85e1b79915a3--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----85e1b79915a3--------------------------------", "anchor_text": ""}, {"url": "https://bindichen.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://bindichen.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "B. Chen"}, {"url": "https://bindichen.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "4K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F563d09da62a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-custom-callbacks-with-keras-and-tensorflow-2-85e1b79915a3&user=B.+Chen&userId=563d09da62a&source=post_page-563d09da62a--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F56a3bfbb80dc&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-custom-callbacks-with-keras-and-tensorflow-2-85e1b79915a3&newsletterV3=563d09da62a&newsletterV3Id=56a3bfbb80dc&user=B.+Chen&userId=563d09da62a&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}