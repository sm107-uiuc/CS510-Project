{"url": "https://towardsdatascience.com/sankey-diagram-basics-with-pythons-plotly-7a13d557401a", "time": 1683009720.395046, "path": "towardsdatascience.com/sankey-diagram-basics-with-pythons-plotly-7a13d557401a/", "webpage": {"metadata": {"title": "Sankey Diagram Basics with Python\u2019s Plotly | by Thiago Carvalho | Towards Data Science", "h1": "Sankey Diagram Basics with Python\u2019s Plotly", "description": "They\u2019re a convenient chart for visualizing any kind of measurable flow \u2014 Some examples are the flow of travelers, spellers, and money. The creation of this diagram is credited to the Irish Captain\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.flickr.com/photos/walkingsf/8222524899/in/photostream", "anchor_text": "travelers", "paragraph_index": 1}, {"url": "https://www.reddit.com/r/dataisbeautiful/comments/6a4pb8/how_52_ninthgraders_spell_camouflage_sankey/", "anchor_text": "spellers", "paragraph_index": 1}, {"url": "https://www.behance.net/gallery/16622319/Sankey-diagrams", "anchor_text": "money", "paragraph_index": 1}, {"url": "https://github.com/ropensci/plotly/issues/1118", "anchor_text": "override the CSS", "paragraph_index": 28}, {"url": "https://github.com/Thiagobc23/plotly-sankey", "anchor_text": "here", "paragraph_index": 29}, {"url": "https://thiagobc23.github.io/plotly-sankey/van.html", "anchor_text": "here", "paragraph_index": 29}, {"url": "https://plotly.github.io/plotly.py-docs/generated/plotly.graph_objects.Sankey.html", "anchor_text": "Plotly \u2014 Graph Objects", "paragraph_index": 31}, {"url": "https://plotly.com/python/sankey-diagram/#reference", "anchor_text": "Plotly \u2014 Sankey Diagrams", "paragraph_index": 31}], "all_paragraphs": ["In this article, I\u2019ll go through the basics of using Plotly and Python for drawing Sankey Diagrams.", "They\u2019re a convenient chart for visualizing any kind of measurable flow \u2014 Some examples are the flow of travelers, spellers, and money.", "The creation of this diagram is credited to the Irish Captain Matthew H. P. R. Sankey, who used it to visualize the energy efficiency of steam engines.", "The idea of Sankey\u2019s diagram is similar to a network chart, where links connect nodes.", "The main difference being that in Sankey\u2019s model, the links have different widths that encode a measurable variable they have in common.", "For the following examples, I\u2019ll use Plotly with Jupyter Lab to explore how to create a Sankey.", "There are different ways of building a chart with Plotly; I\u2019ll use Graphical Objects, visualize the graphs with the Jupiter widgets, and export an HTML for the final visualization.", "Building a Sankey can be quite a struggle especially if you have too many nodes and connections, I\u2019ll use lists for the examples to make it simpler, but you can adapt this logic with a JSON file or a Pandas Dataframe.", "We will use go.Sankey to build the chart, which requires a link.", "That link is a dictionary containing data about the connections we want to draw.", "The source and target are lists of indexes for the nodes Plotly will connect, and the value is a list of numbers that will define the width of these connections.", "We saved the Sankey object to a variable called data, and now we can pass that data to a Figure;", "That\u2019s the idea. Let\u2019s try identifying those nodes so we can have a more unobstructed view of what is connecting what.", "We\u2019ll need a dictionary with the node\u2019s data, which should contain a list with the labels. We can also add more parameters such as pad to customize the distance between the nodes, or thickness to define the size of their handles.", "That\u2019s easier to understand. We can read the lists, and visualize how they connect.", "Now let\u2019s try this with some real data, I\u2019ll try to change this visualization from Vancouver\u2019s 2020 Budget.", "I want to see the proportion of money flowing from the operational expenditures, to areas, to services.", "I will start with a node for the total expenditures, that will connect to the four areas, which will then link to their subdivisions \u2014 Let\u2019s make a quick sketch of the idea.", "I\u2019ve used the percentages to find the values, and build the following lists for the links.", "Let\u2019s also define the labels for the nodes.", "Once we have the data ready, all that\u2019s left to do is define our figure and plot.", "There\u2019s another encoding we can use in our diagram, the color.", "We can define the colors of both the node and the links; to do so, we need a list with one color per element.", "Here I\u2019m trying to highlight the area of each expenditure, I\u2019m using similar colors for the nodes and links, with one being a little brighter than the other.", "Almost ready, all that\u2019s left to do is add a title, adjust the details, and export the HTML file.", "We can update the layout of our figure before plotting, and this allows us to change the fonts, background colors, define the information on our tooltip, and much more.", "Once the visualization is ready, we can export it to HTML. That is maybe the most natural part, all we have to do is call .write_html(\u2018filename.html\u2019).", "Here you can see another example, where I added the operating revenues.", "I\u2019ve tried to remove the white text-shadow, but I couldn\u2019t find a solution within Plotly, the best answer I found was to override the CSS.", "You can find the code for this article here, and the webpage with the interactive Sankey here.", "Thanks for taking the time to read my article, I hope you enjoyed it.", "More Resources:Plotly \u2014 Graph Objects Plotly \u2014 Sankey Diagrams", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F7a13d557401a&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsankey-diagram-basics-with-pythons-plotly-7a13d557401a&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsankey-diagram-basics-with-pythons-plotly-7a13d557401a&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsankey-diagram-basics-with-pythons-plotly-7a13d557401a&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsankey-diagram-basics-with-pythons-plotly-7a13d557401a&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----7a13d557401a--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----7a13d557401a--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://thiago-bernardes-carvalho.medium.com/?source=post_page-----7a13d557401a--------------------------------", "anchor_text": ""}, {"url": "https://thiago-bernardes-carvalho.medium.com/?source=post_page-----7a13d557401a--------------------------------", "anchor_text": "Thiago Carvalho"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F7af498f86142&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsankey-diagram-basics-with-pythons-plotly-7a13d557401a&user=Thiago+Carvalho&userId=7af498f86142&source=post_page-7af498f86142----7a13d557401a---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F7a13d557401a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsankey-diagram-basics-with-pythons-plotly-7a13d557401a&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F7a13d557401a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsankey-diagram-basics-with-pythons-plotly-7a13d557401a&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://www.flickr.com/photos/walkingsf/8222524899/in/photostream", "anchor_text": "travelers"}, {"url": "https://www.reddit.com/r/dataisbeautiful/comments/6a4pb8/how_52_ninthgraders_spell_camouflage_sankey/", "anchor_text": "spellers"}, {"url": "https://www.behance.net/gallery/16622319/Sankey-diagrams", "anchor_text": "money"}, {"url": "https://upload.wikimedia.org/wikipedia/commons/1/10/JIE_Sankey_V5_Fig1.png", "anchor_text": "Sankey\u2019s diagram showing the energy efficiency of a steam engine, 1898"}, {"url": "https://vancouver.ca/files/cov/2020-budget-book.PDF", "anchor_text": "Vancouver Budget 2020, pg. 6"}, {"url": "https://thiagobc23.github.io/plotly-sankey/van.html", "anchor_text": "https://thiagobc23.github.io/plotly-sankey/van.html"}, {"url": "https://github.com/ropensci/plotly/issues/1118", "anchor_text": "override the CSS"}, {"url": "https://github.com/Thiagobc23/plotly-sankey", "anchor_text": "here"}, {"url": "https://thiagobc23.github.io/plotly-sankey/van.html", "anchor_text": "here"}, {"url": "https://plotly.github.io/plotly.py-docs/generated/plotly.graph_objects.Sankey.html", "anchor_text": "Plotly \u2014 Graph Objects"}, {"url": "https://plotly.com/python/sankey-diagram/#reference", "anchor_text": "Plotly \u2014 Sankey Diagrams"}, {"url": "https://medium.com/tag/data-visualization?source=post_page-----7a13d557401a---------------data_visualization-----------------", "anchor_text": "Data Visualization"}, {"url": "https://medium.com/tag/data-science?source=post_page-----7a13d557401a---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/python?source=post_page-----7a13d557401a---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/plotly?source=post_page-----7a13d557401a---------------plotly-----------------", "anchor_text": "Plotly"}, {"url": "https://medium.com/tag/sankey-diagram?source=post_page-----7a13d557401a---------------sankey_diagram-----------------", "anchor_text": "Sankey Diagram"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F7a13d557401a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsankey-diagram-basics-with-pythons-plotly-7a13d557401a&user=Thiago+Carvalho&userId=7af498f86142&source=-----7a13d557401a---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F7a13d557401a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsankey-diagram-basics-with-pythons-plotly-7a13d557401a&user=Thiago+Carvalho&userId=7af498f86142&source=-----7a13d557401a---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F7a13d557401a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsankey-diagram-basics-with-pythons-plotly-7a13d557401a&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----7a13d557401a--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F7a13d557401a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsankey-diagram-basics-with-pythons-plotly-7a13d557401a&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----7a13d557401a---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----7a13d557401a--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----7a13d557401a--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----7a13d557401a--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----7a13d557401a--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----7a13d557401a--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----7a13d557401a--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----7a13d557401a--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----7a13d557401a--------------------------------", "anchor_text": ""}, {"url": "https://thiago-bernardes-carvalho.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://thiago-bernardes-carvalho.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Thiago Carvalho"}, {"url": "https://thiago-bernardes-carvalho.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "1.7K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F7af498f86142&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsankey-diagram-basics-with-pythons-plotly-7a13d557401a&user=Thiago+Carvalho&userId=7af498f86142&source=post_page-7af498f86142--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F10a0f4458714&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsankey-diagram-basics-with-pythons-plotly-7a13d557401a&newsletterV3=7af498f86142&newsletterV3Id=10a0f4458714&user=Thiago+Carvalho&userId=7af498f86142&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}