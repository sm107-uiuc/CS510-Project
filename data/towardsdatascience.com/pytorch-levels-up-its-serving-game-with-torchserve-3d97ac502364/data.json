{"url": "https://towardsdatascience.com/pytorch-levels-up-its-serving-game-with-torchserve-3d97ac502364", "time": 1683008005.932815, "path": "towardsdatascience.com/pytorch-levels-up-its-serving-game-with-torchserve-3d97ac502364/", "webpage": {"metadata": {"title": "PyTorch Levels Up Its Serving Game with TorchServe | by Anthony Agnone | Towards Data Science", "h1": "PyTorch Levels Up Its Serving Game with TorchServe", "description": "In recent years, PyTorch has largely overtaken Tensorflow as the machine learning model training framework that is preferred for research-leaning data scientists. There are a few reasons for this\u2026"}, "outgoing_paragraph_urls": [{"url": "https://pureai.com/articles/2019/10/10/machine-learning-framework-popularity.aspx", "anchor_text": "preferred for research-leaning data scientists", "paragraph_index": 0}, {"url": "https://docs.python-guide.org/writing/style/", "anchor_text": "pythonic", "paragraph_index": 0}, {"url": "https://www.tensorflow.org/tfx", "anchor_text": "TFX", "paragraph_index": 3}, {"url": "https://pytorch.org/blog/pytorch-library-updates-new-model-serving-library/", "anchor_text": "1.5 release", "paragraph_index": 4}, {"url": "https://pytorch.org/serve", "anchor_text": "TorchServe", "paragraph_index": 4}, {"url": "https://github.com/pytorch/elastic", "anchor_text": "TorchElastic", "paragraph_index": 4}, {"url": "http://pytorch.org/serve/default_handlers.html", "anchor_text": "default inference handlers", "paragraph_index": 8}, {"url": "https://towardsdatascience.com/densenet-2810936aeebb", "anchor_text": "DenseNet", "paragraph_index": 9}, {"url": "http://pytorch.org/serve/install.html#running-with-docker", "anchor_text": "pre-built docker image", "paragraph_index": 9}, {"url": "https://github.com/aagnone3/pytorch-serve-overview/blob/master/Dockerfile", "anchor_text": "added", "paragraph_index": 9}, {"url": "https://github.com/aagnone3/pytorch-serve-overview#steps", "anchor_text": "commands here", "paragraph_index": 9}, {"url": "https://lilianweng.github.io/lil-log/2018/06/24/attention-attention.html#soft-vs-hard-attention", "anchor_text": "attention techniques", "paragraph_index": 15}, {"url": "https://lifewithdata.org/blog/", "anchor_text": "LifeWithData", "paragraph_index": 18}, {"url": "https://lifewithdata.org/tag/ml-utd/", "anchor_text": "ML UTD", "paragraph_index": 18}, {"url": "https://lifewithdata.org/blog", "anchor_text": "lifewithdata.org/blog", "paragraph_index": 19}, {"url": "https://https//lifewithdata.org/tag/ml-utd", "anchor_text": "lifewithdata.org/tag/ml-utd", "paragraph_index": 19}, {"url": "http://that%27s%20all%20for%20ml%20utd%202.%20however%2C%20things%20are%20happening%20very%20quickly%20in%20academics%20and%20industry%21%20aside%20from%20ml%20utd%2C%20keep%20yourself%20updated%20with%20the%20blog%20at%20lifewithdata./", "anchor_text": "Feedly", "paragraph_index": 19}, {"url": "http://LifeWithData.org", "anchor_text": "LifeWithData.org", "paragraph_index": 21}], "all_paragraphs": ["In recent years, PyTorch has largely overtaken Tensorflow as the machine learning model training framework that is preferred for research-leaning data scientists. There are a few reasons for this, but mainly that Pytorch is built for Python as its first-class language of use, whereas Tensorflow\u2019s architecture stays much closer to its C/C++ core. Although both frameworks do have C/C++ cores, Pytorch does loads more to make its interface \u201c pythonic \u201c. For those unfamiliar with the term, it basically means the code is easy to understand and doesn\u2019t make you feel like an adversarial teacher wrote it for an exam question.", "Pytorch\u2019s cleaner interface has resulted in mass adoption for folks whose main priority is to quickly turn their planned analyses into actionable results. We don\u2019t have time to play with a static computation graph API that makes me feel like a criminal for wanting to place a breakpoint to debug a tensor\u2019s value. We need to prototype something and get moving onto the next experiment.", "However, this advantage comes at a cost. With Pytorch, we can easily churn through experiment after experiment, tossing results over the fence to be put into production at a similar speed. Sadly, getting these models serving in production has been slower than the experimentation throughput due to a lack of production-ready frameworks that encapsulate away API complexity. At least, these frameworks have been missing for Pytorch.", "Tensorflow has long had a truly impressive model serving framework, TFX. Truthfully, there\u2019s not much missing in its framework, provided that you are knee-deep in the Tensorflow ecosystem. If you have a TF model and are using Google Cloud, use TFX until it breathes its last breath. If you are not in that camp, combining TFX and PyTorch has been anything but plug and play.", "Fear no more! PyTorch\u2019s 1.5 release brings the initial version of TorchServe as well as experimental support of TorchElastic with Kubernetes for large-scale model training. Software powerhouses Facebook and AWS continue to supercharge PyTorch\u2019s capabilities and provide a competitive alternative to Google\u2019s Tensorflow-based software pipelines.", "TorchServe is a flexible and easy-to-use library for serving PyTorch models in production performantly at scale. It is cloud and environment agnostic and supports features such as multi-model serving, logging, metrics, and the creation of RESTful endpoints for application integration.", "Let\u2019s parse some of those qualities because they\u2019re worth a focused repetition:", "Any ML model in production that has these characteristics is bound to make your fellow engineers very happy.", "TorchServe provides most things you\u2019d expect from a serving API right out of the box. On top of that, it additionally offers default inference handlers for image-based and text-based models. Due to my audio background, I\u2019d be remiss to not slip in my complaint that once again audio-based models are left out of first-class support. Audio remains the black sheep in the machine learning world for now! Alas, I digress\u2026", "The DenseNet architecture, which yields good results on image classification tasks, is provided as a default model in TorchServe. The PyTorch engineers provide a pre-built docker image, but I added a few things to it for the demonstration below. If you want to re-create for yourself, run the four commands here.", "With a few passed command-line arguments to the torchserve command, we have a production-ready service ready to provide model predictions. Without bogging down the article with the nitty-gritty, you can use a quick driver script to pump an image through the server from either a URL or a local path.", "Cliche time! Cats and dogs, here we go.", "Spot on! Three of the top four as spaniel sub-breeds and around 1% of the not-so-different Papillon breed isn\u2019t anything to clamor about.", "How about a teeny tiny kitten, but with an extra fur hat on? I guess his natural fur and ears weren\u2019t good enough for the photo? Regardless, surely this won\u2019t change too much as far as the network\u2019s predictions\u2026", "There\u2019s certainly a majority vote in the top 4 for cats, but the predictions barely edge out the Marmoset and Patas predictions, which are both classifications for\u2026monkeys.", "A for effort, I guess. For the curious, now\u2019s a great chance to apply attention techniques to debug what parts of the image were used heavily in influencing the classification.", "One step lower, here\u2019s a demo of some raw cURL commands. Keep in mind, all of this API behavior came out of the box. All I provided was the choice of model and the input image.", "I\u2019ve barely touched the surface of TorchServe, and that\u2019s a good thing. If I could demonstrate all of its functionality in a simple blog post, it would be nowhere near production-ready. Maybe allow a few more versions to turn over before putting it behind anything mission-critical. But Facebook and AWS have set an exciting foundation for greasing the skids between PyTorch-based research and production.", "Things move quickly in academics and industry! Keep yourself updated with the general LifeWithData blog as well as the ML UTD newsletter.", "If you\u2019re not a fan of newsletters, but still want to stay in the loop, consider adding lifewithdata.org/blog and lifewithdata.org/tag/ml-utd to a Feedly aggregation setup.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Living the LifeWithData.org | Top writer in AI"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F3d97ac502364&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpytorch-levels-up-its-serving-game-with-torchserve-3d97ac502364&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpytorch-levels-up-its-serving-game-with-torchserve-3d97ac502364&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpytorch-levels-up-its-serving-game-with-torchserve-3d97ac502364&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpytorch-levels-up-its-serving-game-with-torchserve-3d97ac502364&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----3d97ac502364--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----3d97ac502364--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://anthonyagnone.medium.com/?source=post_page-----3d97ac502364--------------------------------", "anchor_text": ""}, {"url": "https://anthonyagnone.medium.com/?source=post_page-----3d97ac502364--------------------------------", "anchor_text": "Anthony Agnone"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F9b9e20d56791&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpytorch-levels-up-its-serving-game-with-torchserve-3d97ac502364&user=Anthony+Agnone&userId=9b9e20d56791&source=post_page-9b9e20d56791----3d97ac502364---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F3d97ac502364&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpytorch-levels-up-its-serving-game-with-torchserve-3d97ac502364&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F3d97ac502364&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpytorch-levels-up-its-serving-game-with-torchserve-3d97ac502364&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://pytorch.org/", "anchor_text": "PyTorch"}, {"url": "https://pureai.com/articles/2019/10/10/machine-learning-framework-popularity.aspx", "anchor_text": "preferred for research-leaning data scientists"}, {"url": "https://docs.python-guide.org/writing/style/", "anchor_text": "pythonic"}, {"url": "https://www.tensorflow.org/tfx", "anchor_text": "TFX"}, {"url": "https://pytorch.org/blog/pytorch-library-updates-new-model-serving-library/", "anchor_text": "1.5 release"}, {"url": "https://pytorch.org/serve", "anchor_text": "TorchServe"}, {"url": "https://github.com/pytorch/elastic", "anchor_text": "TorchElastic"}, {"url": "https://pytorch.org/blog/pytorch-library-updates-new-model-serving-library/", "anchor_text": "PyTorch Docs"}, {"url": "http://pytorch.org/serve/default_handlers.html", "anchor_text": "default inference handlers"}, {"url": "https://towardsdatascience.com/densenet-2810936aeebb", "anchor_text": "DenseNet"}, {"url": "http://pytorch.org/serve/install.html#running-with-docker", "anchor_text": "pre-built docker image"}, {"url": "https://github.com/aagnone3/pytorch-serve-overview/blob/master/Dockerfile", "anchor_text": "added"}, {"url": "https://github.com/aagnone3/pytorch-serve-overview#steps", "anchor_text": "commands here"}, {"url": "https://github.com/aagnone3/pytorch-serve-overview/blob/master/query.sh", "anchor_text": "query.sh"}, {"url": "https://www.fanpop.com/clubs/laura1233214/images/43117566/title/cute-photo", "anchor_text": "Fanpop"}, {"url": "http://images6.fanpop.com/image/photos/43100000/cute-puppy-laura1233214-43117566-736-736.jpg", "anchor_text": "source"}, {"url": "https://github.com/aagnone3/pytorch-serve-overview/blob/master/query.sh", "anchor_text": "query.sh"}, {"url": "http://www.ebay.com", "anchor_text": "eBay"}, {"url": "https://www.ebay.com/c/1972575297", "anchor_text": "source"}, {"url": "https://unsplash.com/@sita2?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Andrew Sit"}, {"url": "https://unsplash.com/s/photos/patas-monkey?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://lilianweng.github.io/lil-log/2018/06/24/attention-attention.html#soft-vs-hard-attention", "anchor_text": "attention techniques"}, {"url": "https://lifewithdata.org/blog/", "anchor_text": "LifeWithData"}, {"url": "https://lifewithdata.org/tag/ml-utd/", "anchor_text": "ML UTD"}, {"url": "https://lifewithdata.org/blog", "anchor_text": "lifewithdata.org/blog"}, {"url": "https://https//lifewithdata.org/tag/ml-utd", "anchor_text": "lifewithdata.org/tag/ml-utd"}, {"url": "http://that%27s%20all%20for%20ml%20utd%202.%20however%2C%20things%20are%20happening%20very%20quickly%20in%20academics%20and%20industry%21%20aside%20from%20ml%20utd%2C%20keep%20yourself%20updated%20with%20the%20blog%20at%20lifewithdata./", "anchor_text": "Feedly"}, {"url": "https://lifewithdata.org/torch-serve/", "anchor_text": "https://lifewithdata.org"}, {"url": "https://medium.com/tag/data-science?source=post_page-----3d97ac502364---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----3d97ac502364---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----3d97ac502364---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/cloud-computing?source=post_page-----3d97ac502364---------------cloud_computing-----------------", "anchor_text": "Cloud Computing"}, {"url": "https://medium.com/tag/software-development?source=post_page-----3d97ac502364---------------software_development-----------------", "anchor_text": "Software Development"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F3d97ac502364&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpytorch-levels-up-its-serving-game-with-torchserve-3d97ac502364&user=Anthony+Agnone&userId=9b9e20d56791&source=-----3d97ac502364---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F3d97ac502364&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpytorch-levels-up-its-serving-game-with-torchserve-3d97ac502364&user=Anthony+Agnone&userId=9b9e20d56791&source=-----3d97ac502364---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F3d97ac502364&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpytorch-levels-up-its-serving-game-with-torchserve-3d97ac502364&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----3d97ac502364--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F3d97ac502364&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpytorch-levels-up-its-serving-game-with-torchserve-3d97ac502364&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----3d97ac502364---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----3d97ac502364--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----3d97ac502364--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----3d97ac502364--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----3d97ac502364--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----3d97ac502364--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----3d97ac502364--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----3d97ac502364--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----3d97ac502364--------------------------------", "anchor_text": ""}, {"url": "https://anthonyagnone.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://anthonyagnone.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Anthony Agnone"}, {"url": "https://anthonyagnone.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "1.3K Followers"}, {"url": "http://LifeWithData.org", "anchor_text": "LifeWithData.org"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F9b9e20d56791&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpytorch-levels-up-its-serving-game-with-torchserve-3d97ac502364&user=Anthony+Agnone&userId=9b9e20d56791&source=post_page-9b9e20d56791--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F51d3f002c6de&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpytorch-levels-up-its-serving-game-with-torchserve-3d97ac502364&newsletterV3=9b9e20d56791&newsletterV3Id=51d3f002c6de&user=Anthony+Agnone&userId=9b9e20d56791&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}