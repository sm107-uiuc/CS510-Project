{"url": "https://towardsdatascience.com/streamlit-use-data-apps-to-better-test-your-model-4a14dad235f5", "time": 1683012989.901153, "path": "towardsdatascience.com/streamlit-use-data-apps-to-better-test-your-model-4a14dad235f5/", "webpage": {"metadata": {"title": "Streamlit \u2014 use data apps to better test your model | by Dipam Vasani | Towards Data Science", "h1": "Streamlit \u2014 use data apps to better test your model", "description": "We use all kinds of techniques from creating a very reliable validation set to using k-fold cross-validation or coming up with all sorts of fancy metrics to determine how good our model performs\u2026"}, "outgoing_paragraph_urls": [{"url": "https://towardsdatascience.com/everything-about-fasterrcnn-6d758f5a6d79", "anchor_text": "wheat object detection using a FasterRCNN", "paragraph_index": 5}], "all_paragraphs": ["We use all kinds of techniques from creating a very reliable validation set to using k-fold cross-validation or coming up with all sorts of fancy metrics to determine how good our model performs. However, nothing beats looking at the raw output. When you look at sample output, you figure out things that none of the other methods can tell you.", "For example, if you are performing object detection on crops, you might see that when the crop is aligned in a certain way because of the wind, our bounding boxes don\u2019t encapsulate the crop properly.", "However, looking at sample outputs is a tedious task. Say we want to test various NMS values, and we also want to test it on a bunch of images. We can always write a function for this, but running it, again and again, is boring.", "Wouldn\u2019t it be nice to have an app where we can upload an image and use a slider to adjust the NMS value? Welcome, Streamlit.", "According to their website, Streamlit is an open-source web framework for data scientists and machine learning engineers to create beautiful, performant apps in just a few hours, all in pure Python.", "For this demo, I will be using the model I trained for wheat object detection using a FasterRCNN. You can go back to that article, train or, download my model and then follow along.", "Streamlit is just a standard python file run from top to bottom. We will start by creating a file called app.py, and writing the following code in it.", "We will run this as follows:", "It will open up our browser with the following output.", "Notice that we used a # inside st.write(). This indicates that we are writing markdown inside it. The first thing we need is a file uploader to upload images to Streamlit. Again, this is as simple as doing:", "We pass the type of files allowed (jpg and png in this case), and when we do attach one, we read it using PIL. When we save app.py now:", "we see that Streamlit identifies that the source file has changed and asks if we want to rerun. And we do. Hence, we select \u201calways rerun\u201d for change to reflect automatically. Now our browser looks like this:", "To display the image, we can use st.image(). However, after generating predictions, we want to replace the input image with our predicted image. To do so, we create an empty container and display everything in it.", "Another thing I like about using a container is that you can set use_column_width = True, and you won\u2019t have to worry about image resizing. Now we can drag and drop images into our app.", "Finally, we can convert our image to a tensor, load our model, generate outputs, and write it to our container.", "To vary NMS values, we can either use a slider or an input box to type the value or use the \u2018+\u2019 and \u2018-\u2019 buttons to increase or decrease the value. I\u2019m going to go with the slider. Our code changes to.", "And that\u2019s it. In about just 50 lines of code, we can create this super useful app to test our model. You can also create templates for various problems like image classification, segmentation, object detection, and so on and use them every time you train a new model.", "Finally, when we change the NMS values using the slider, if we\u2019ve already generated predictions for a particular value, we don\u2019t want to generate them again. Hence you can stick a simple decorator on top of the function:", "and it will cache the results for you. This way it won\u2019t rerun the same threshold every time but just used the cached result. Cool, isn\u2019t it?", "That will be it for this article. I would really recommend everyone to use Streamlit and create data apps. It works well for all kinds of data and caching helps with expensive operations like working with large data frames. Give it a try.", "If you want to learn more about deep learning check out my deep learning series.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F4a14dad235f5&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fstreamlit-use-data-apps-to-better-test-your-model-4a14dad235f5&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fstreamlit-use-data-apps-to-better-test-your-model-4a14dad235f5&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fstreamlit-use-data-apps-to-better-test-your-model-4a14dad235f5&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fstreamlit-use-data-apps-to-better-test-your-model-4a14dad235f5&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----4a14dad235f5--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----4a14dad235f5--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://dipam44.medium.com/?source=post_page-----4a14dad235f5--------------------------------", "anchor_text": ""}, {"url": "https://dipam44.medium.com/?source=post_page-----4a14dad235f5--------------------------------", "anchor_text": "Dipam Vasani"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fdb5934347fa&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fstreamlit-use-data-apps-to-better-test-your-model-4a14dad235f5&user=Dipam+Vasani&userId=db5934347fa&source=post_page-db5934347fa----4a14dad235f5---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F4a14dad235f5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fstreamlit-use-data-apps-to-better-test-your-model-4a14dad235f5&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F4a14dad235f5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fstreamlit-use-data-apps-to-better-test-your-model-4a14dad235f5&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://www.reddit.com/r/wallpaper/comments/8ofb1d/natural_architectural_bridge_at_night_scenery_hd/", "anchor_text": "https://www.reddit.com/r/wallpaper/comments/8ofb1d/natural_architectural_bridge_at_night_scenery_hd/"}, {"url": "https://towardsdatascience.com/everything-about-fasterrcnn-6d758f5a6d79", "anchor_text": "wheat object detection using a FasterRCNN"}, {"url": "https://medium.com/@dipam44/deep-learning-series-30ad108fbe2b", "anchor_text": "Deep learning seriesA systematic list of all my articles on deep learningmedium.com"}, {"url": "https://docs.streamlit.io/en/stable/main_concepts.html", "anchor_text": "https://docs.streamlit.io/en/stable/main_concepts.html"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----4a14dad235f5---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----4a14dad235f5---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----4a14dad235f5---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----4a14dad235f5---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/python?source=post_page-----4a14dad235f5---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F4a14dad235f5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fstreamlit-use-data-apps-to-better-test-your-model-4a14dad235f5&user=Dipam+Vasani&userId=db5934347fa&source=-----4a14dad235f5---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F4a14dad235f5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fstreamlit-use-data-apps-to-better-test-your-model-4a14dad235f5&user=Dipam+Vasani&userId=db5934347fa&source=-----4a14dad235f5---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F4a14dad235f5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fstreamlit-use-data-apps-to-better-test-your-model-4a14dad235f5&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----4a14dad235f5--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F4a14dad235f5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fstreamlit-use-data-apps-to-better-test-your-model-4a14dad235f5&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----4a14dad235f5---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----4a14dad235f5--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----4a14dad235f5--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----4a14dad235f5--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----4a14dad235f5--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----4a14dad235f5--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----4a14dad235f5--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----4a14dad235f5--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----4a14dad235f5--------------------------------", "anchor_text": ""}, {"url": "https://dipam44.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://dipam44.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Dipam Vasani"}, {"url": "https://dipam44.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "698 Followers"}, {"url": "https://github.com/dipam7/", "anchor_text": "https://github.com/dipam7/"}, {"url": "https://www.linkedin.com/in/dipam-vasani-734932104/", "anchor_text": "https://www.linkedin.com/in/dipam-vasani-734932104/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fdb5934347fa&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fstreamlit-use-data-apps-to-better-test-your-model-4a14dad235f5&user=Dipam+Vasani&userId=db5934347fa&source=post_page-db5934347fa--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fe16e216bc3bf&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fstreamlit-use-data-apps-to-better-test-your-model-4a14dad235f5&newsletterV3=db5934347fa&newsletterV3Id=e16e216bc3bf&user=Dipam+Vasani&userId=db5934347fa&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}