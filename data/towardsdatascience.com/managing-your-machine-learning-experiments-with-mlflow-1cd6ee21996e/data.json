{"url": "https://towardsdatascience.com/managing-your-machine-learning-experiments-with-mlflow-1cd6ee21996e", "time": 1683013087.2914371, "path": "towardsdatascience.com/managing-your-machine-learning-experiments-with-mlflow-1cd6ee21996e/", "webpage": {"metadata": {"title": "Managing Your Machine Learning Experiments with MLflow | by Jiahao Weng | Towards Data Science", "h1": "Managing Your Machine Learning Experiments with MLflow", "description": "There was this painful period of time that I still remember when my teammate and I were working on a machine learning (ML) project. Tediously and studiously, we were manually transferring the results\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.reddit.com/r/MachineLearning/comments/bx0apm/d_how_do_you_manage_your_machine_learning/", "anchor_text": "here", "paragraph_index": 3}, {"url": "https://cloud.google.com/free/docs/gcp-free-tier", "anchor_text": "free trial", "paragraph_index": 13}, {"url": "https://console.cloud.google.com/apis/library/compute.googleapis.com?q=compute", "anchor_text": "Compute Engine API", "paragraph_index": 15}, {"url": "https://console.cloud.google.com/compute/", "anchor_text": "Compute Engine page", "paragraph_index": 23}, {"url": "https://cloud.google.com/vpc/docs/special-configurations#developer-console-external-http", "anchor_text": "link", "paragraph_index": 43}, {"url": "https://cloud.google.com/iam/docs/creating-managing-service-account-keys#creating_service_account_keys", "anchor_text": "here", "paragraph_index": 47}, {"url": "https://gist.github.com/jiahao87/e7d9ede444a41161879d7b4845f0a6c0", "anchor_text": "here", "paragraph_index": 53}], "all_paragraphs": ["There was this painful period of time that I still remember when my teammate and I were working on a machine learning (ML) project.", "Tediously and studiously, we were manually transferring the results of our countless experiments to a Google Sheet and organizing our saved models in folders. Of course, we did try to automate the process as much as possible, but managing our ML experiments was still a messy affair.", "If the above situation sounds like something you are in, hopefully, this article will be able to help you out and reduce your pain.", "Being one of the best open source solutions (see other tools here) for managing ML experiments, MLflow will greatly improve your well being (as a data scientist, machine learning specialist, etc.) and let you and your team remain sane while keeping track of your models \ud83d\udcaa.", "With just a few lines of code integrated into your script, you can auto-log your model parameters and metrics into an organized dashboard as shown below.", "Clicking into each of the table rows will show you more details, including the path of the model saved for that run (one run is basically one model training).", "And as mentioned earlier, the important thing is that all these can be automated with just a few additional lines of code in your script.", "In our example code snippet below, we have placed comments above all the lines of code relating to MLflow.", "In general, there are three main sections in our example:", "1. Setup experiment: Here we set an experiment name (mlflow.set_experiment()) and path (mlflow.set_tracking_uri()) to log our run, before starting our run with mlflow.start_run().", "2. Train model: Nothing special here, just normal model training.", "After running the code, you can execute mlflow ui in your terminal and there will be a link to your MLflow dashboard.", "However, what we have shown you so far are in the local environment. What if we would like to collaborate with other teammates? This is where a remote server can come into play and our next section of the article shows you the steps to do that.", "We list down first the general steps to take before detailing each of the steps with screenshots (feel free to click on each step to navigate). Having a Google Cloud account is the only prerequisite for following the steps. Do note that Google Cloud has a free trial for new signups, so you can experiment at no cost.", "Our first step is to set up a Compute Engine VM instance through Google Cloud console.", "a) Enable the Compute Engine API after logging in to your Google Cloud console", "You should see a button similar to the one in red box below in the top right corner of your console page. Click on it and a terminal will pop out. We shall be using this terminal to launch our VM.", "c) Create a Compute Engine VM instance", "Key in the following into Google Cloud Shell to create a VM instance named mlflow-server.", "A brief description of the parameters in the code above:", "This is to allow access on port 5000 to our MLflow server.", "Run the code below in the Google Cloud Shell, replacing <BUCKET_NAME> with a unique name of your choice. This bucket will be where we will store our models later.", "We shall now SSH into our mlflow-server instance.", "Go to the Compute Engine page and click on the SSH button for your instance. A terminal for your VM instance should pop out.", "While the terminal gets ready, take note of the internal and external IPs for your mlflow-server instance that is shown on the Compute Engine page. We will need them later.", "Before launching our MLflow server, let\u2019s do a quick check to ensure that everything has been installed. As our startup script will take a few minutes to finish execution, the packages may not have all been installed if you SSH in too quickly. To check that MLflow has been installed, key in the terminal:", "You should see the version of MLflow if it has been installed. If not, no worries, either wait a while more or execute the commands in our bash script under step 1c to manually install the packages.", "If MLflow has been installed, we can now bring up a new window using tmux by executing:", "And launch our MLflow server by running code below, replacing <BUCKET_NAME> and <INTERNAL_IP> respectively with the bucket name in step 2 and your internal IP address noted earlier.", "If you see something similar to screenshot below, congratulations your MLflow server is up and running \ud83d\ude04. You can now visit <External_IP>:5000 in your browser to view your MLflow dashboard.", "If you don\u2019t mind letting anyone who has your external IP address to view your MLflow dashboard, then you can skip this step. But I am guessing you are not such an exhibitionist right? Or are you? \ud83d\ude31", "To add user authentication, first let\u2019s stop our MLflow server for now by pressing Ctrl+c. And then say out Terminator\u2019s famous line \u201cI\u2019ll be back\u201d before detaching our window by Ctrl+b d.", "a) Install Nginx and Apache Utilities", "In our terminal\u2019s main window, execute:", "Nginx shall set up our web server while Apache Utilities will give us access to the htpasswd command which we will use next to create password file.", "Run the folllowing, replacing <USERNAME> with a cool name.", "If you need a party, just leave out the -c argument to add additional users:", "We need to configure Nginx to let our password file take effect and set up reverse-proxy to our MLflow server. We do this by modifying the default server block file:", "Modify the file by replacing the content under location to the three bold lines:", "Press Ctrl+x y Enter to save changes and exit the editor.", "Restart Nginx for the changes to take effect:", "Create a new session with tmux or re-attach to our earlier tmux session:", "Launch our MLflow server again but this time around, our host is set to localhost:", "Lastly, we enable HTTP traffic for our instance to allow access to our Nginx web server by following the steps in this link. Essentially, when you click on our mlflow-server instance on the Compute Engine page, you can edit and select Allow HTTP traffic and Allow HTTPS traffic under the Firewall section.", "Now if you visit your external IP (leave out :5000, just external IP), you should be prompted for credentials. Key in the username and password that you set earlier and \u201cOpen Sesame\u201d, your MLflow dashboard is back before your eyes again.", "In order for our scripts to log to the server, we need to modify our code by providing some credentials as environment variables.", "a) Create and download the service account json", "Follow the steps here to create new service account key.", "google-cloud-storage package is required to be installed on both the client and server in order to access Google Cloud Storage. We had installed the package on the server through our startup script so you just need to install it locally.", "c) Set up credentials as environment variables", "In your code, add the following in order for your script to access the server, replacing each of them accordingly:", "d) Set external IP as MLflow tracking URI", "You can now easily collaborate with your teammate and log your models to the server. \ud83d\udc4f \ud83d\udc4f \ud83d\udc4f", "Our full example code can be found here for your testing convenience.", "Through the guide above, we hope that you are now able to deploy MLflow both locally as well as on Google Cloud to manage your ML experiments. In addition, after your experimentation, MLflow will remain useful for monitoring your model after you have deployed it into production.", "Thanks for reading and I hope the article was useful :) Please also feel free to comment with any questions or suggestions that you may have.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F1cd6ee21996e&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmanaging-your-machine-learning-experiments-with-mlflow-1cd6ee21996e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmanaging-your-machine-learning-experiments-with-mlflow-1cd6ee21996e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmanaging-your-machine-learning-experiments-with-mlflow-1cd6ee21996e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmanaging-your-machine-learning-experiments-with-mlflow-1cd6ee21996e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----1cd6ee21996e--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----1cd6ee21996e--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@jh.weng.87?source=post_page-----1cd6ee21996e--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@jh.weng.87?source=post_page-----1cd6ee21996e--------------------------------", "anchor_text": "Jiahao Weng"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Feb5be9b213df&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmanaging-your-machine-learning-experiments-with-mlflow-1cd6ee21996e&user=Jiahao+Weng&userId=eb5be9b213df&source=post_page-eb5be9b213df----1cd6ee21996e---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F1cd6ee21996e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmanaging-your-machine-learning-experiments-with-mlflow-1cd6ee21996e&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F1cd6ee21996e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmanaging-your-machine-learning-experiments-with-mlflow-1cd6ee21996e&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@sctgrhm?utm_source=medium&utm_medium=referral", "anchor_text": "Scott Graham"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://www.reddit.com/r/MachineLearning/comments/bx0apm/d_how_do_you_manage_your_machine_learning/", "anchor_text": "here"}, {"url": "https://cloud.google.com/free/docs/gcp-free-tier", "anchor_text": "free trial"}, {"url": "https://console.cloud.google.com/apis/library/compute.googleapis.com?q=compute", "anchor_text": "Compute Engine API"}, {"url": "https://cloud.google.com/compute/docs/machine-types#machine_type_comparison", "anchor_text": "list"}, {"url": "https://cloud.google.com/compute/docs/regions-zones/#available", "anchor_text": "somewhere"}, {"url": "http://0.0.0.0/0", "anchor_text": "0.0.0.0/0"}, {"url": "https://console.cloud.google.com/compute/", "anchor_text": "Compute Engine page"}, {"url": "http://localhost:5000/", "anchor_text": "http://localhost:5000"}, {"url": "https://cloud.google.com/vpc/docs/special-configurations#developer-console-external-http", "anchor_text": "link"}, {"url": "https://cloud.google.com/iam/docs/creating-managing-service-account-keys#creating_service_account_keys", "anchor_text": "here"}, {"url": "http://35.225.50.9:80", "anchor_text": "http://35.225.50.9:80"}, {"url": "https://gist.github.com/jiahao87/e7d9ede444a41161879d7b4845f0a6c0", "anchor_text": "here"}, {"url": "https://www.mlflow.org/docs/latest/quickstart.html", "anchor_text": "QuickstartYou install MLflow by running: Note MLflow works on MacOS. If you run into issues with the default system Python on\u2026www.mlflow.org"}, {"url": "https://karimlahrichi.com/2020/03/13/add-authentication-to-mlflow/", "anchor_text": "Add authentication to MLflowThis is the 3rd installement on MLflow, where we will add an nginx reverse-proxy in front of the MLflow tracking server\u2026karimlahrichi.com"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----1cd6ee21996e---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----1cd6ee21996e---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/mlflow?source=post_page-----1cd6ee21996e---------------mlflow-----------------", "anchor_text": "Mlflow"}, {"url": "https://medium.com/tag/google-cloud-platform?source=post_page-----1cd6ee21996e---------------google_cloud_platform-----------------", "anchor_text": "Google Cloud Platform"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----1cd6ee21996e---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F1cd6ee21996e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmanaging-your-machine-learning-experiments-with-mlflow-1cd6ee21996e&user=Jiahao+Weng&userId=eb5be9b213df&source=-----1cd6ee21996e---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F1cd6ee21996e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmanaging-your-machine-learning-experiments-with-mlflow-1cd6ee21996e&user=Jiahao+Weng&userId=eb5be9b213df&source=-----1cd6ee21996e---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F1cd6ee21996e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmanaging-your-machine-learning-experiments-with-mlflow-1cd6ee21996e&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----1cd6ee21996e--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F1cd6ee21996e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmanaging-your-machine-learning-experiments-with-mlflow-1cd6ee21996e&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----1cd6ee21996e---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----1cd6ee21996e--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----1cd6ee21996e--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----1cd6ee21996e--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----1cd6ee21996e--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----1cd6ee21996e--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----1cd6ee21996e--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----1cd6ee21996e--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----1cd6ee21996e--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@jh.weng.87?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@jh.weng.87?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Jiahao Weng"}, {"url": "https://medium.com/@jh.weng.87/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "277 Followers"}, {"url": "https://www.linkedin.com/in/jiahao-weng/", "anchor_text": "https://www.linkedin.com/in/jiahao-weng/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Feb5be9b213df&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmanaging-your-machine-learning-experiments-with-mlflow-1cd6ee21996e&user=Jiahao+Weng&userId=eb5be9b213df&source=post_page-eb5be9b213df--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fa863ec98252c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmanaging-your-machine-learning-experiments-with-mlflow-1cd6ee21996e&newsletterV3=eb5be9b213df&newsletterV3Id=a863ec98252c&user=Jiahao+Weng&userId=eb5be9b213df&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}