{"url": "https://towardsdatascience.com/representing-a-random-forest-with-few-decision-trees-11283e433dbb", "time": 1683004257.705625, "path": "towardsdatascience.com/representing-a-random-forest-with-few-decision-trees-11283e433dbb/", "webpage": {"metadata": {"title": "Improving the interpretability of the Random Forest classifier | by Ahsan Saeed | Towards Data Science", "h1": "Improving the interpretability of the Random Forest classifier", "description": "Interpretability is often as important as results for data scientists. Facing interpretability vs. accuracy trade-off, we frequently avoid deploying deep learning models and complicated ensembles\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.linkedin.com/in/ahsansaeedakhtar/", "anchor_text": "https://www.linkedin.com/in/ahsansaeedakhtar/", "paragraph_index": 13}], "all_paragraphs": ["Interpretability is often as important as results for data scientists. Facing interpretability vs. accuracy trade-off, we frequently avoid deploying deep learning models and complicated ensembles. One such powerful and commonly used method is the decision tree-based random forest classifier. The idea is to reduce variance in the prediction of several noisy decision trees by averaging their results. In terms of interpretability, most people place it between conventional machine learning models and deep learning. Many consider it a black-box.", "Despite widely used, the random forest is commonly interpreted with only feature importance and proximity plots. These visualizations are very useful but not sufficient. Many researchers are trying to identify ways to represent random forests using decision trees. One interesting method is to approximate a single decision tree, as explained by Zhou and Hooker [1] and Weinberg [2].", "In this article, I propose an alternative and novel solution. I demonstrate that underlying decision trees in a random forest can form clusters giving us the ability to extract representative decision trees from each cluster and use them for interpretation.", "For this analysis, I have used the Scikit-learn implementation of the random forest classifier with n_estimators = 20 and max_depth = 10 for a binary classification problem. The data has 75,800 observations and 372 features [3].", "After training the model, the first step is to extract the underlying decision trees and post-prune them at all levels of depth (0 to 10). Scikit-learn implementation of the random forest allows obtaining underlying trees using .estimators_. However, we need to code for post-pruning, leveraging the binary tree structure of the decision trees. This process yields 11 X 20 = 220 individual decision trees.", "Next, predict the output probability of the test set using each decision tree to get a [220 X (test set size)] matrix of predicted probabilities and perform correlation analysis, t-SNE and hierarchical clustering on this matrix to identify clusters.", "The graph below plots the correlation between the predictions of each tree at varying levels of depth. At low depth, the trees in a random forest tend to be similar, so we see a high positive correlation. The correlation decreases as the depth increases because the trees start to split on different features. Importantly, we see patterns that indicate the potential formation of clusters at each level of depth.", "t-SNE is a non-linear dimensionality reduction algorithm that is very useful to visualize high-dimensional data. The graph below plots the results where each data point represents a decision tree, and the label represents the tree\u2019s ID. The results also demonstrate clusters formation at different levels of depth.", "Last, let\u2019s look at agglomerative clustering. Correlation analysis and t-SNE mapping can give us useful information about the optimal number of clusters. In this particular example, I have selected 2 clusters. Visualizing hierarchical clustering in two-dimensions is not possible for a high dimensional matrix. However, since it is a binary classification problem, we can visualize the results by color coding cluster assignment of each tree on its Receiver Operating Characteristic (ROC) curve. The results below also validate the formation of clusters.", "Observing the tree IDs in the three graphs, you can observe that the clustering is reasonably consistent across the three methods, and trees stay in the same clusters at different levels of depth.", "To summarize, the key idea that I wanted to demonstrate from the above analysis is that underlying decision trees in the random forest can exhibit clusters. Once we are confident about the clusters, the last step is to pick a representative unpruned tree from each cluster and present it to the client. The representative tree could be either the one closest to the cluster center or the one with the highest AUC in the cluster. It\u2019s important to note that pruning was only meant to demonstrate clustering. In the final step, you only need the unpruned tree.", "[2] Weinberg AI, Last M. Selecting a representative decision tree from an ensemble of decision-tree models for fast big data classification. J Big Data. 2019;6(1):23", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Science Specialist @ United Nations NYC. CMU alum. https://www.linkedin.com/in/ahsansaeedakhtar/"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F11283e433dbb&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frepresenting-a-random-forest-with-few-decision-trees-11283e433dbb&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frepresenting-a-random-forest-with-few-decision-trees-11283e433dbb&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frepresenting-a-random-forest-with-few-decision-trees-11283e433dbb&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frepresenting-a-random-forest-with-few-decision-trees-11283e433dbb&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----11283e433dbb--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----11283e433dbb--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@ahsansaeedakhtar?source=post_page-----11283e433dbb--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@ahsansaeedakhtar?source=post_page-----11283e433dbb--------------------------------", "anchor_text": "Ahsan Saeed"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F5c6234b921c1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frepresenting-a-random-forest-with-few-decision-trees-11283e433dbb&user=Ahsan+Saeed&userId=5c6234b921c1&source=post_page-5c6234b921c1----11283e433dbb---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F11283e433dbb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frepresenting-a-random-forest-with-few-decision-trees-11283e433dbb&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F11283e433dbb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frepresenting-a-random-forest-with-few-decision-trees-11283e433dbb&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@patrickian4?utm_source=medium&utm_medium=referral", "anchor_text": "Patrick Fore"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://www.kaggle.com/c/santander-customer-satisfaction/data", "anchor_text": "https://www.kaggle.com/c/santander-customer-satisfaction/data"}, {"url": "https://medium.com/tag/random-forest?source=post_page-----11283e433dbb---------------random_forest-----------------", "anchor_text": "Random Forest"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----11283e433dbb---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----11283e433dbb---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/towards-data-science?source=post_page-----11283e433dbb---------------towards_data_science-----------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----11283e433dbb---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F11283e433dbb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frepresenting-a-random-forest-with-few-decision-trees-11283e433dbb&user=Ahsan+Saeed&userId=5c6234b921c1&source=-----11283e433dbb---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F11283e433dbb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frepresenting-a-random-forest-with-few-decision-trees-11283e433dbb&user=Ahsan+Saeed&userId=5c6234b921c1&source=-----11283e433dbb---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F11283e433dbb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frepresenting-a-random-forest-with-few-decision-trees-11283e433dbb&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----11283e433dbb--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F11283e433dbb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frepresenting-a-random-forest-with-few-decision-trees-11283e433dbb&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----11283e433dbb---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----11283e433dbb--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----11283e433dbb--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----11283e433dbb--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----11283e433dbb--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----11283e433dbb--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----11283e433dbb--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----11283e433dbb--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----11283e433dbb--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@ahsansaeedakhtar?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@ahsansaeedakhtar?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Ahsan Saeed"}, {"url": "https://medium.com/@ahsansaeedakhtar/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "9 Followers"}, {"url": "https://www.linkedin.com/in/ahsansaeedakhtar/", "anchor_text": "https://www.linkedin.com/in/ahsansaeedakhtar/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F5c6234b921c1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frepresenting-a-random-forest-with-few-decision-trees-11283e433dbb&user=Ahsan+Saeed&userId=5c6234b921c1&source=post_page-5c6234b921c1--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fusers%2F5c6234b921c1%2Flazily-enable-writer-subscription&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frepresenting-a-random-forest-with-few-decision-trees-11283e433dbb&user=Ahsan+Saeed&userId=5c6234b921c1&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}