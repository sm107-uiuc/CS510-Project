{"url": "https://towardsdatascience.com/preventing-data-leakage-in-your-machine-learning-model-9ae54b3cd1fb", "time": 1683001275.353141, "path": "towardsdatascience.com/preventing-data-leakage-in-your-machine-learning-model-9ae54b3cd1fb/", "webpage": {"metadata": {"title": "Preventing Data Leakage in Your Machine Learning Model | by Max Tingle | Towards Data Science", "h1": "Preventing Data Leakage in Your Machine Learning Model", "description": "Machine learning algorithms make models that predict and classify data. It is a common best practice to first split up the available dataset into two subsets of training and test data. After which\u2026"}, "outgoing_paragraph_urls": [{"url": "https://towardsdatascience.com/data-leakage-part-i-think-you-have-a-great-machine-learning-model-think-again-ad44921fbf34", "anchor_text": "Data Leakage, Part I: Think You Have a Great Machine Learning Model? Think Again", "paragraph_index": 14}, {"url": "https://towardsdatascience.com/data-leakage-in-machine-learning-10bdd3eec742", "anchor_text": "Data Leakage in Machine Learning", "paragraph_index": 14}], "all_paragraphs": ["Machine learning algorithms make models that predict and classify data. It is a common best practice to first split up the available dataset into two subsets of training and test data. After which, the model is trained using the training set, and its success is measured by comparing its performance against its performance with the test set.", "But what if the model was exposed to test data when it was trained?", "This is the question of data leakage \u2014 when the data used to train a model happens to contain the information trying to be predicted. If a model was exposed to test data, then it will of course perform better in predicting/classifying the test data it was trained to predict/classify.", "If undetected, data leakage can lead to problems, including:", "The point of using machine learning algorithms to make a model is to simulate real-world unseen data and figure out how to consistently predict or classify the data. But if data leakage occurs, a model is not likely to generalize well in a real world context with new data. It is therefore imperative to take steps to prevent data leakage when developing a model.", "It goes without saying that knowledge about the dataset you are working with is necessary in order to be able to perform effective analyses and develop sound models.", "However, what is not often said, with regards to data leakage, is that you should refrain from studying the distributions or basic statistics your dataset until after you split your data into train-validation-test groups (more on splitting your dataset later). If you examine your data before you split it, you will gain insights about rows of data that might end up in your test group, which is effectively data leakage.", "Data cleaning is a necessary step in most, if not all, data science projects. One common data cleaning task is to handle rows with duplicate information. In the context of data leakage, it is important to remove duplicate rows so that duplicates do not end up in both train and test groups.", "The important next step in preventing data leakage is to select features, or independent variables, that are not correlated with the target variable and were available at the time of prediction.", "If a variable is highly correlated with the target variable, it will undoubtedly increase your model\u2019s ability to predict the target. For example, if your target variable is household income and you include household expenses as a feature in your model, then it stands to reason that your model would be better at predicting household income because household expenses are a pretty direct indicator of household income. Therefore, it is best to omit such features from your model in order to prevent data leakage.", "Predicting the past with the future data is a form of data leakage. Time series data, features not available when prediction occurred, or categorical features about future data are all data leakage threats related to the temporal order (sequential timing) of a data.", "When dealing with time series data, the challenge is making sure to not leak information about the future into the past. For example, including 2019 data in a model that was trained to make predictions about 2018. One option to overcome data leakage with time series data is to have a train-validation-test split for each period of time.", "Another option is to remove all data/features not available at the time of prediction. For example, information about whether a customer will be late on a loan payment might not be available until after the customer is actually late and the loan has already been approved. Therefore, if information about late payment status was included in a model that decided whether or not to approve a loan to that customer, there would be data leakage that would render the model unrealistic in a real-world setting.", "Additionally, it is worth examining categorical features that label information about the future. For example, a customer could have been labeled \u201cbig spender\u201d based on a high frequency of purchases, but this information would cause data leakage if a model trying to predict which customers will be frequent return customers.", "For more information about preventing data leakage when working with time series data checkout Rafael Pierre\u2019s \u201cData Leakage, Part I: Think You Have a Great Machine Learning Model? Think Again.\u201d And for a more in-depth explanation of temporal ordering, checkout Devin Soni\u2019s \u201cData Leakage in Machine Learning.\u201d", "Splitting data into two groups, train and test groups, is standard practice. However, I recommend taking it a step further and splitting data into three groups \u2014 train, validation, and test groups. By having three groups you have a validation group to help hyper-tune model parameters as well as a final test group to use after the model is tuned.", "After splitting, do not perform exploratory data analysis on the validation and test sets \u2014 only the train set! Any additional features or model updates generated by insights from examining the validation or test sets are instances of data leakage.", "Partitioning is an important step to consider when splitting a dataset into train, validation, and test groups when there are multiple rows from the same source. Partitioning involves grouping that source\u2019s rows and only including them in one of the split sets, otherwise data from that source would be leaked across multiple sets.", "Many machine learning algorithms require normalization. However, it is important to normalize AFTER splitting data. If you normalize before splitting, the mean and standard deviation used to normalize the data will be based on the full dataset and not the training subset \u2014 therefore leaking information about the test or validation sets into the train set.", "After splitting the data into train, validation, and test sets, the optimal approach is to first normalize the train set, then apply the mean and standard deviation of the train set normalization to the validation and test set normalization.", "However, if you plan to use Grid Search Cross Validation to hyper-tune parameters, scaling the train set will cause data leakage if done before cross validation, because cross validation further divides a train set into additional train and test sets. It is recommended to use Pipeline with GridSearchCV to more appropriately scale your data with data preprocessors such as Standard Scaler. I have included a screenshot below of code that uses a pipeline to appropriately scale data when using GridSearchCV.", "Last, but not least, it is important to have a healthy skepticism when assessing model performance.", "Multiple sources warn data scientists to be weary when a model has high performance scores, because excellent scores can indicate data leakage. What follows are six points to consider when assessing a model\u2019s performance. The answers to these questions could have implications as to whether or not data leakage is occurring.", "When assessing your model, first think about the machine learning algorithm being used. Is the algorithm a weak algorithm performing well on a complex problem? Has the algorithm been used on similar data/problems in the past? How does the algorithm\u2019s performance in past cases compare to your current model\u2019s performance?", "Look back to your baseline model and look for performance that is \u201ctoo good to be true.\u201d", "If your algorithm returns feature importance, try to come up with a logical explanation as to why each important feature is important. If no logical reason exists, there is potential of data leakage. Also try taking features out of your model one at a time, and if there is a dramatic reduction in performance, there could be a chance the eliminated feature contains leakage.", "It is recommended to use multiple measures when assessing a model\u2019s performance. If you are only using one metric (e.g. accuracy), that metric could be hiding data leakages that other metrics would uncover.", "After fitting a model and measuring performance, it would be of benefit to explore the distributions of the train, validation, and test groups to discover differences and any patterns that could explain the results.", "In a final point, if you have the resources, it is always advantageous to retrieve more data to test the model\u2019s performance on new validation sets that are as close to reality as possible.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Engineering Specialist at DC Public Charter School Board in Washington, DC."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F9ae54b3cd1fb&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpreventing-data-leakage-in-your-machine-learning-model-9ae54b3cd1fb&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpreventing-data-leakage-in-your-machine-learning-model-9ae54b3cd1fb&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpreventing-data-leakage-in-your-machine-learning-model-9ae54b3cd1fb&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpreventing-data-leakage-in-your-machine-learning-model-9ae54b3cd1fb&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----9ae54b3cd1fb--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----9ae54b3cd1fb--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@maxtingle?source=post_page-----9ae54b3cd1fb--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@maxtingle?source=post_page-----9ae54b3cd1fb--------------------------------", "anchor_text": "Max Tingle"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F9568612f1fc5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpreventing-data-leakage-in-your-machine-learning-model-9ae54b3cd1fb&user=Max+Tingle&userId=9568612f1fc5&source=post_page-9568612f1fc5----9ae54b3cd1fb---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F9ae54b3cd1fb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpreventing-data-leakage-in-your-machine-learning-model-9ae54b3cd1fb&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F9ae54b3cd1fb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpreventing-data-leakage-in-your-machine-learning-model-9ae54b3cd1fb&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://www.pexels.com/@jibarofoto?utm_content=attributionCopyText&utm_medium=referral&utm_source=pexels", "anchor_text": "Luis Quintero"}, {"url": "https://www.pexels.com/photo/photo-of-gray-faucet-2339722/?utm_content=attributionCopyText&utm_medium=referral&utm_source=pexels", "anchor_text": "Pexels"}, {"url": "https://towardsdatascience.com/data-leakage-part-i-think-you-have-a-great-machine-learning-model-think-again-ad44921fbf34", "anchor_text": "Data Leakage, Part I: Think You Have a Great Machine Learning Model? Think Again"}, {"url": "https://towardsdatascience.com/data-leakage-in-machine-learning-10bdd3eec742", "anchor_text": "Data Leakage in Machine Learning"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----9ae54b3cd1fb---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/data?source=post_page-----9ae54b3cd1fb---------------data-----------------", "anchor_text": "Data"}, {"url": "https://medium.com/tag/data-science?source=post_page-----9ae54b3cd1fb---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/data-leak-prevention?source=post_page-----9ae54b3cd1fb---------------data_leak_prevention-----------------", "anchor_text": "Data Leak Prevention"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F9ae54b3cd1fb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpreventing-data-leakage-in-your-machine-learning-model-9ae54b3cd1fb&user=Max+Tingle&userId=9568612f1fc5&source=-----9ae54b3cd1fb---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F9ae54b3cd1fb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpreventing-data-leakage-in-your-machine-learning-model-9ae54b3cd1fb&user=Max+Tingle&userId=9568612f1fc5&source=-----9ae54b3cd1fb---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F9ae54b3cd1fb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpreventing-data-leakage-in-your-machine-learning-model-9ae54b3cd1fb&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----9ae54b3cd1fb--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F9ae54b3cd1fb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpreventing-data-leakage-in-your-machine-learning-model-9ae54b3cd1fb&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----9ae54b3cd1fb---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----9ae54b3cd1fb--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----9ae54b3cd1fb--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----9ae54b3cd1fb--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----9ae54b3cd1fb--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----9ae54b3cd1fb--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----9ae54b3cd1fb--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----9ae54b3cd1fb--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----9ae54b3cd1fb--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@maxtingle?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@maxtingle?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Max Tingle"}, {"url": "https://medium.com/@maxtingle/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "147 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F9568612f1fc5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpreventing-data-leakage-in-your-machine-learning-model-9ae54b3cd1fb&user=Max+Tingle&userId=9568612f1fc5&source=post_page-9568612f1fc5--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fusers%2F9568612f1fc5%2Flazily-enable-writer-subscription&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpreventing-data-leakage-in-your-machine-learning-model-9ae54b3cd1fb&user=Max+Tingle&userId=9568612f1fc5&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}