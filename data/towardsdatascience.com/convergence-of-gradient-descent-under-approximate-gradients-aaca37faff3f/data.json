{"url": "https://towardsdatascience.com/convergence-of-gradient-descent-under-approximate-gradients-aaca37faff3f", "time": 1682993281.439212, "path": "towardsdatascience.com/convergence-of-gradient-descent-under-approximate-gradients-aaca37faff3f/", "webpage": {"metadata": {"title": "Convergence of Gradient Descent under Approximate Gradients | by Christian Howard | Towards Data Science", "h1": "Convergence of Gradient Descent under Approximate Gradients", "description": "Optimization is a fascinating area with a lot of uses, especially these days with Machine Learning (ML). As those involved with ML know, gradient descent variants have been some of the most common\u2026"}, "outgoing_paragraph_urls": [{"url": "https://christianjhoward.me/blog/index.php/2018/03/15/error-bound-for-gradient-descent-with-approximate-gradient/", "anchor_text": "https://christianjhoward.me", "paragraph_index": 21}, {"url": "http://www.christianjhoward.me", "anchor_text": "www.christianjhoward.me", "paragraph_index": 23}], "all_paragraphs": ["Optimization is a fascinating area with a lot of uses, especially these days with Machine Learning (ML). As those involved with ML know, gradient descent variants have been some of the most common optimization techniques employed for training models of all kinds. For very large data sets, stochastic gradient descent has been especially useful but at a cost of more iterations to obtain convergence. Stochastic gradient descent pays this convergence penalty due to forming an inaccurate gradient estimate that leads to the model parameters taking on a trajectory that is non-optimal as it attempts to find its way to a local minima.", "Of course, stochastic gradient descent is not the only place where a gradient may be computed with some non-trivial errors. In particular, someone could approximate the gradient using a finite difference approximation, particularly if they have some black box quantity where finding a closed gradient expression is hard or impossible, and still arrive at a non-trivial amount of error in their gradient result. So a question we might ask ourselves is:", "How does convergence error get impacted under gradient descent with approximate gradients with bounded errors?", "This is a cool problem to think about with a few potential areas of usefulness! For anyone excited about this stuff, I will go over my analysis and proof for the convergence error of gradient descent under this situation with a particularly nice objective function. Time to dive into the math!", "So first, let us take a look at the recursive gradient descent approach in question. Consider the steepest descent method with bounded error:", "where s is a positive constant stepsize, \u03b5_k is an error term satisfying \u2016\u03b5_k\u2016 \u2264 \u03b4 for all k, and f is the positive definite quadratic form defined as", "Let us then define a parameter q to be", "and assume that q < 1. Using the above gradient descent approach, I will show that for all k, we can bound the distance between the kth iterate and a local optima by the following:", "where x_0 is the starting point for the iterate sequence and x* is the local optima. I will prove this result by first proving two useful lemmas and then using them to prove the main result.", "Given a value 0 \u2264 c < 1 and that", "we can find a bound for \u2016x_k - x*\u2016 to be", "For some symmetric, positive definite matrix A and positive scalar s, the following inequality holds:", "Recall that some positive definite square matrix A = U^T \u039b U where U is a unitary matrix of eigenvectors and \u039b is a diagonal matrix with positive eigenvalues. Recall as well that for a matrix 2-norm for some matrix B, we have", "With that, we can proceed with the proof using the following steps:", "To arrive at our final result, we will make use of some typical analysis inequalities that will give us an opening to use Lemma 1 and Lemma 2. With that said, we can proceed with this final proof as follows:", "Since we assume we choose s to be small enough such that q < 1, we can use Lemma 1 to further show that", "This main result is interesting for a few reasons. First, it is clear that very quickly our convergence rate becomes limited by the gradient approximation error instead of the initial guess error. However, we can somewhat overcome this by choosing a sufficiently small value for the step size s, something that practitioners of stochastic gradient descent are likely used to doing.", "Anyway, now with the theoretical stuff done, we can move on to see how well this inequality holds relative to actual numerical experiments.. time to crunch some numbers!", "I thought it could be cool to do a numerical experiment to see how the bound compares to the convergence in practice. To do this experiment, a noise vector \u03b5 was added onto the exact gradient of the quadratic form for a random, positive definite Q such that \u2016\u03b5\u2016 \u2264 \u03b4 for some \u03b4 > 0 that is specified. Multiple sequences were run with different starting random seeds and the plot below is a visualization of the convergence results against the bound.", "Based on the figure above, it looks like the bound works out nicely! It is certainly a bit conservative relative to the actual experiments but that is okay. Some observations to note are the following. As q \u2192 1, the bound term independent of k in the inequality becomes quite large and the convergence of the q^k term to 0 slows down. This implies that the spectrum of sQ are within a unit ball centered around a value of 1 and that the extreme values of s \u03bb_{min} and s \u03bb_{max} are near the boundary of this ball. q \u2192 1 also means we are approaching a situation where we will diverge as the number of iterations approach infinity, so it makes sense that things would be bounded more and converge more slowly when q is close to 1.", "In any event, we have seen that if we approximate our gradient in a way that is bounded (say using Finite Differences or mini-batch estimates in Machine Learning), it is possible to bound our convergence error and get a clearer idea of what to expect in terms of run-time, long term accuracy, and potentially more! Thus, this is a pretty neat result and something to keep in mind!", "Based on article originally published at https://christianjhoward.me on March 15, 2018.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "PhD student @ UIUC who enjoys the mystical arts of mathematics. Works in Theoretical Computer Science. www.christianjhoward.me"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Faaca37faff3f&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fconvergence-of-gradient-descent-under-approximate-gradients-aaca37faff3f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fconvergence-of-gradient-descent-under-approximate-gradients-aaca37faff3f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fconvergence-of-gradient-descent-under-approximate-gradients-aaca37faff3f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fconvergence-of-gradient-descent-under-approximate-gradients-aaca37faff3f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----aaca37faff3f--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----aaca37faff3f--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@choward1491?source=post_page-----aaca37faff3f--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@choward1491?source=post_page-----aaca37faff3f--------------------------------", "anchor_text": "Christian Howard"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F87a872a79aa0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fconvergence-of-gradient-descent-under-approximate-gradients-aaca37faff3f&user=Christian+Howard&userId=87a872a79aa0&source=post_page-87a872a79aa0----aaca37faff3f---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Faaca37faff3f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fconvergence-of-gradient-descent-under-approximate-gradients-aaca37faff3f&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Faaca37faff3f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fconvergence-of-gradient-descent-under-approximate-gradients-aaca37faff3f&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://www.reddit.com/r/ProgrammerHumor/comments/eez8al/gradient_descent/", "anchor_text": "https://www.reddit.com/r/ProgrammerHumor/comments/eez8al/gradient_descent/"}, {"url": "https://giphy.com/gifs/reaction-BmmfETghGOPrW", "anchor_text": "https://giphy.com/gifs/reaction-BmmfETghGOPrW"}, {"url": "https://makeameme.org/meme/crunch-the-numbers", "anchor_text": "https://makeameme.org/meme/crunch-the-numbers"}, {"url": "https://christianjhoward.me/blog/index.php/2018/03/15/error-bound-for-gradient-descent-with-approximate-gradient/", "anchor_text": "https://christianjhoward.me"}, {"url": "https://medium.com/tag/gradient-descent?source=post_page-----aaca37faff3f---------------gradient_descent-----------------", "anchor_text": "Gradient Descent"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----aaca37faff3f---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/optimization?source=post_page-----aaca37faff3f---------------optimization-----------------", "anchor_text": "Optimization"}, {"url": "https://medium.com/tag/optimization-algorithms?source=post_page-----aaca37faff3f---------------optimization_algorithms-----------------", "anchor_text": "Optimization Algorithms"}, {"url": "https://medium.com/tag/mathematics?source=post_page-----aaca37faff3f---------------mathematics-----------------", "anchor_text": "Mathematics"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Faaca37faff3f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fconvergence-of-gradient-descent-under-approximate-gradients-aaca37faff3f&user=Christian+Howard&userId=87a872a79aa0&source=-----aaca37faff3f---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Faaca37faff3f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fconvergence-of-gradient-descent-under-approximate-gradients-aaca37faff3f&user=Christian+Howard&userId=87a872a79aa0&source=-----aaca37faff3f---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Faaca37faff3f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fconvergence-of-gradient-descent-under-approximate-gradients-aaca37faff3f&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----aaca37faff3f--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Faaca37faff3f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fconvergence-of-gradient-descent-under-approximate-gradients-aaca37faff3f&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----aaca37faff3f---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----aaca37faff3f--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----aaca37faff3f--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----aaca37faff3f--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----aaca37faff3f--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----aaca37faff3f--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----aaca37faff3f--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----aaca37faff3f--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----aaca37faff3f--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@choward1491?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@choward1491?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Christian Howard"}, {"url": "https://medium.com/@choward1491/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "28 Followers"}, {"url": "http://www.christianjhoward.me", "anchor_text": "www.christianjhoward.me"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F87a872a79aa0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fconvergence-of-gradient-descent-under-approximate-gradients-aaca37faff3f&user=Christian+Howard&userId=87a872a79aa0&source=post_page-87a872a79aa0--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F857d246159f3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fconvergence-of-gradient-descent-under-approximate-gradients-aaca37faff3f&newsletterV3=87a872a79aa0&newsletterV3Id=857d246159f3&user=Christian+Howard&userId=87a872a79aa0&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}