{"url": "https://towardsdatascience.com/multi-class-classification-in-text-using-r-e6cf72ef1da3", "time": 1682994316.0770402, "path": "towardsdatascience.com/multi-class-classification-in-text-using-r-e6cf72ef1da3/", "webpage": {"metadata": {"title": "Multi-Class Classification in Text using R | by Shubhanshu Gupta | Towards Data Science", "h1": "Multi-Class Classification in Text using R", "description": "This blog is in continuation to my NLP blog series. In the previous blogs, I discussed data pre-processing steps in R and recognizing emotions present in ted talks. In this blog, I am going to\u2026"}, "outgoing_paragraph_urls": [{"url": "https://medium.com/@shubhanshugupta/data-preprocessing-in-r-2f0e25487bb", "anchor_text": "data pre-processing steps in R", "paragraph_index": 0}, {"url": "https://medium.com/datadriveninvestor/emotions-in-ted-talks-text-analytics-in-r-1b6016f3316e", "anchor_text": "recognizing emotions present in ted talks", "paragraph_index": 0}, {"url": "https://www.kaggle.com/rounakbanik/ted-talks", "anchor_text": "ted talk dataset", "paragraph_index": 1}, {"url": "http://rfunction.com/archives/2354", "anchor_text": "here", "paragraph_index": 3}, {"url": "https://www.rdocumentation.org/packages/RJSONIO/versions/1.3-0/topics/fromJSON", "anchor_text": "fromJSON function", "paragraph_index": 4}, {"url": "https://jennybc.github.io/purrr-tutorial/ls01_map-name-position-shortcuts.html", "anchor_text": "here", "paragraph_index": 4}, {"url": "https://medium.com/@shubhanshugupta/data-preprocessing-in-r-2f0e25487bb", "anchor_text": "blog", "paragraph_index": 10}, {"url": "https://developers.google.com/machine-learning/crash-course/regularization-for-simplicity/l2-regularization", "anchor_text": "L2 regularization", "paragraph_index": 11}, {"url": "https://www.svm-tutorial.com/2014/10/svm-linear-kernel-good-text-classification/", "anchor_text": "SVM with Linear Kernel", "paragraph_index": 11}, {"url": "https://blog.revolutionanalytics.com/2016/03/com_class_eval_metrics_r.html#macro", "anchor_text": "here", "paragraph_index": 13}, {"url": "https://datascience.stackexchange.com/questions/15989/micro-average-vs-macro-average-performance-in-a-multiclass-classification-settin/16001", "anchor_text": "here", "paragraph_index": 13}, {"url": "https://medium.com/@shubhanshugupta/engineering-challenges-of-streaming-a-million-concurrent-json-data-streams-from-product-to-crm-360506b29aca", "anchor_text": "posts", "paragraph_index": 16}, {"url": "https://shubhanshugupta.com/blog/", "anchor_text": "here", "paragraph_index": 16}, {"url": "https://shubhanshugupta.com/", "anchor_text": "https://shubhanshugupta.com/", "paragraph_index": 18}], "all_paragraphs": ["This blog is in continuation to my NLP blog series. In the previous blogs, I discussed data pre-processing steps in R and recognizing emotions present in ted talks. In this blog, I am going to predict the ratings of the ted talks given by viewers. This would require a multi-class classification and quite a bit of data cleaning and preprocessing. We will discuss each step in detail below.", "The ratings column in the ted talk dataset looks like Figure 1.", "The screenshot of the column above, Figure 1signifies how many people have rated a particular talk to be \u201cInspiring\u201d, \u201cBeautiful\u201d, \u201cIngenious\u201d, \u201cPersuasive\u201d, etc. The count key in the JSON signifies the value of the rating given to the talk. So for example, the talk has been rated \u201cInspiring\u201d by 385 people and just 2 people have rated the talk to be \u201cFunny\u201d. Our objective, here, is to get the rating with the highest count for each talk.", "One of the primary concern is to parse the ratings column. I have used the gsub function for replacing the single quote with double quotes. I found the details and explanation about gsub here.", "The next step was to parse the JSON to get a list of id, rating name and rating count. The jsonlite library in R, provides functions to stream, validate and prettify JSON data. The fromJSON function is used to de-serialize JSON objects into R objects. Finally, purrr::map function, applies a function (fromJSON in our case) to each element in the list. The documentation and implementation can be read here.", "The code block above gives us a neat list of parsed rating column. It looks like Figure 2 .", "In the next step, I am going to make a new column \u201chighest_rating\u201d in which I will store the rating with highest count for every talk. Post that, I will convert the column into factor which will effectively give us 13 unique factors (ratings) to deal with. I hope, by this point you must have got a hint that this highest_rating column with 13 factor variables will be used for multi-class classification. In the sense, a binary classification problem has two classes to classify a data point, e.g. True and False. Whereas, in this problem we have to deal with the classification of a data point into one of the 13 classes and hence, this is a multi-class classification problem.", "With the above step, our dataset preparation is now complete.", "We will now split our dataset into training and test. I have divided my dataset in 60:40 ratio.", "I will now apply all the pre-processing steps to my training and test data (separately). Somehow, I was in dual mindset: whether to split the DTM into train and test or split the dataset and then prepare their DTM individually. Somehow, I chose the latter option. You can try with the former option and let me know if it works out fine for you.", "I also took care of sparsity, something which I discussed in good detail in my blog. I also renamed my target variable as \u201cy\u201d instead of highest_rating for better intuitiveness.", "Now that we have our training dataset ready, we can train our model. I am using caret package and svmLinear3 method in caret. svmLinear3 provides L2 regularization in SVM with Linear Kernel. Agreed, that\u2019s a lot of technical jargon which I am purposely not explaining here because that\u2019s for another blog altogether. Meanwhile, I am going to leave some links for you to understand L2 regularization, and SVM with Linear Kernel.", "I will now check the accuracy/performance of our model on test data.", "The top 3 most commonly misclassified ratings are: \u201cInspiring\u201d, \u201cInformative\u201d, \u201cFascinating\u201d. You can read more about micro and macro F1 scores from here and here.", "In this article, we have discussed multi-class classification of text. It was pretty challenging data problem for me to solve, primarily because:", "Finally, the model scores above are heavily reliant on the method we use in the train method. I used SVM with Linear Kernel and L2 regularization which in itself was computationally heavy. There are other methods which you can try, but computational resources could be an issue. Please do let me know what other method(s) you used and the scores (accuracy and F1) that you get.", "That\u2019s all for now. I will discuss a new task related to NLP in my next blog. I have written other posts related to software engineering as well. You might want to check them out here.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Pursuing MS in Data Science from NUS. Worked for 3 years as a Software Development Engineer in Early & Mid age Startups. Read more: https://shubhanshugupta.com/"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fe6cf72ef1da3&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmulti-class-classification-in-text-using-r-e6cf72ef1da3&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmulti-class-classification-in-text-using-r-e6cf72ef1da3&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmulti-class-classification-in-text-using-r-e6cf72ef1da3&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmulti-class-classification-in-text-using-r-e6cf72ef1da3&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----e6cf72ef1da3--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----e6cf72ef1da3--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@shubhanshugupta?source=post_page-----e6cf72ef1da3--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@shubhanshugupta?source=post_page-----e6cf72ef1da3--------------------------------", "anchor_text": "Shubhanshu Gupta"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F269f5616997f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmulti-class-classification-in-text-using-r-e6cf72ef1da3&user=Shubhanshu+Gupta&userId=269f5616997f&source=post_page-269f5616997f----e6cf72ef1da3---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe6cf72ef1da3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmulti-class-classification-in-text-using-r-e6cf72ef1da3&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe6cf72ef1da3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmulti-class-classification-in-text-using-r-e6cf72ef1da3&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@hermez777?utm_source=medium&utm_medium=referral", "anchor_text": "Hermes Rivera"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://medium.com/@shubhanshugupta/data-preprocessing-in-r-2f0e25487bb", "anchor_text": "data pre-processing steps in R"}, {"url": "https://medium.com/datadriveninvestor/emotions-in-ted-talks-text-analytics-in-r-1b6016f3316e", "anchor_text": "recognizing emotions present in ted talks"}, {"url": "https://www.kaggle.com/rounakbanik/ted-talks", "anchor_text": "ted talk dataset"}, {"url": "http://rfunction.com/archives/2354", "anchor_text": "here"}, {"url": "https://www.rdocumentation.org/packages/RJSONIO/versions/1.3-0/topics/fromJSON", "anchor_text": "fromJSON function"}, {"url": "https://jennybc.github.io/purrr-tutorial/ls01_map-name-position-shortcuts.html", "anchor_text": "here"}, {"url": "https://medium.com/@shubhanshugupta/data-preprocessing-in-r-2f0e25487bb", "anchor_text": "blog"}, {"url": "https://developers.google.com/machine-learning/crash-course/regularization-for-simplicity/l2-regularization", "anchor_text": "L2 regularization"}, {"url": "https://www.svm-tutorial.com/2014/10/svm-linear-kernel-good-text-classification/", "anchor_text": "SVM with Linear Kernel"}, {"url": "https://blog.revolutionanalytics.com/2016/03/com_class_eval_metrics_r.html#macro", "anchor_text": "here"}, {"url": "https://datascience.stackexchange.com/questions/15989/micro-average-vs-macro-average-performance-in-a-multiclass-classification-settin/16001", "anchor_text": "here"}, {"url": "https://medium.com/@shubhanshugupta/engineering-challenges-of-streaming-a-million-concurrent-json-data-streams-from-product-to-crm-360506b29aca", "anchor_text": "posts"}, {"url": "https://shubhanshugupta.com/blog/", "anchor_text": "here"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----e6cf72ef1da3---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/nlp?source=post_page-----e6cf72ef1da3---------------nlp-----------------", "anchor_text": "NLP"}, {"url": "https://medium.com/tag/r?source=post_page-----e6cf72ef1da3---------------r-----------------", "anchor_text": "R"}, {"url": "https://medium.com/tag/data-science?source=post_page-----e6cf72ef1da3---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/tedx?source=post_page-----e6cf72ef1da3---------------tedx-----------------", "anchor_text": "Tedx"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fe6cf72ef1da3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmulti-class-classification-in-text-using-r-e6cf72ef1da3&user=Shubhanshu+Gupta&userId=269f5616997f&source=-----e6cf72ef1da3---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fe6cf72ef1da3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmulti-class-classification-in-text-using-r-e6cf72ef1da3&user=Shubhanshu+Gupta&userId=269f5616997f&source=-----e6cf72ef1da3---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe6cf72ef1da3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmulti-class-classification-in-text-using-r-e6cf72ef1da3&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----e6cf72ef1da3--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fe6cf72ef1da3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmulti-class-classification-in-text-using-r-e6cf72ef1da3&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----e6cf72ef1da3---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----e6cf72ef1da3--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----e6cf72ef1da3--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----e6cf72ef1da3--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----e6cf72ef1da3--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----e6cf72ef1da3--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----e6cf72ef1da3--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----e6cf72ef1da3--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----e6cf72ef1da3--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@shubhanshugupta?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@shubhanshugupta?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Shubhanshu Gupta"}, {"url": "https://medium.com/@shubhanshugupta/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "100 Followers"}, {"url": "https://shubhanshugupta.com/", "anchor_text": "https://shubhanshugupta.com/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F269f5616997f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmulti-class-classification-in-text-using-r-e6cf72ef1da3&user=Shubhanshu+Gupta&userId=269f5616997f&source=post_page-269f5616997f--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Ff92b7d8dbcdc&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmulti-class-classification-in-text-using-r-e6cf72ef1da3&newsletterV3=269f5616997f&newsletterV3Id=f92b7d8dbcdc&user=Shubhanshu+Gupta&userId=269f5616997f&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}