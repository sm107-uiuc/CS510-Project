{"url": "https://towardsdatascience.com/data-preprocessing-and-model-comparison-techniques-you-must-know-1347edb319e7", "time": 1682997487.359402, "path": "towardsdatascience.com/data-preprocessing-and-model-comparison-techniques-you-must-know-1347edb319e7/", "webpage": {"metadata": {"title": "Data Preprocessing and Model Comparison Techniques you must know | by Fan Yuan | Towards Data Science", "h1": "Data Preprocessing and Model Comparison Techniques you must know", "description": "As we all know, when doing data science projects, it\u2019s always more than fitting the model on data and getting the model performance. Actually, in terms of good projects, it\u2019s more about exploring the\u2026"}, "outgoing_paragraph_urls": [{"url": "https://archive.ics.uci.edu/ml/datasets/Census+Income", "anchor_text": "UCI Machine Learning Repository", "paragraph_index": 1}], "all_paragraphs": ["As we all know, when doing data science projects, it\u2019s always more than fitting the model on data and getting the model performance. Actually, in terms of good projects, it\u2019s more about exploring the data, cleaning, preprocessing data and finally comparing several models\u2019 perform to get the best one.", "In this post, I\u2019ll use U.S. census data taken from the UCI Machine Learning Repository and go through the full process. At the end of the process, we\u2019ll solve the following several problems:", "Have a quick check on whether there\u2019s any huge missing value in columns or rows which may largely affect the later analysis.", "The result above shows there\u2019s no `null` value in the dataset. But according to data notes provided, unknown data was converted into \u2018?\u2019. Therefore, next, we\u2019ll convert \u2018?\u2019 to NaNs.", "Since the missing data \u2018?\u2019 is in a small volume, here I choose to just remove the unknown data which flagged as \u2018?\u2019 here. But if the missing data is in a large volume, need to consider imputing NaNs with more advanced methods.", "The largest missing percentage by column level is 5% in the dataset, and most columns are complete enough. Therefore, here I\u2019ll remove the NaN values instead of manually imputing.", "The goal is to identify if an individual has an income over 50k or not, so first, have an overlook at how the income distributes in the data set. A cursory investigation of the dataset will determine how many individuals fit into each group and will tell us about the percentage of these individuals making more than $50,000.", "Here I\u2019ll generate some variables to help analysis as below:- The total number of records- The number of individuals making more than $50,000 annually- The number of individuals making at most $50,000 annually- The percentage of individuals making more than $50,000 annually", "Note:Since in EDA process, we don\u2019t need the test data, I\u2019ll combine the train and test data in this section just for getting a better and more general distribution of data", "From the graph above, we can see that most of \u2018>50K\u2019 group are people in middle career and the male is a bit more than female in \u2018>50K\u2019 especially around 50 years old.", "We can see the top three biggest groups for people who have income larger 50K are professional in Exec-managerial, Prof-specialty, and Sales.", "Since the race is a little bit unbalanced in the data set, White accounts most of \u2018>50K\u2019 group. And within each race, \u2018<50K\u2019 population is much larger than \u2018>50K\u2019.", "Then we take a quick view of how education correlates to the income level. We can see the biggest group is Bachelors following by HS-grad and Some-college. And after moving the missing value:", "Before data can be used as input for machine learning algorithms, it often must be cleaned, formatted, and restructured. After processing the missing entries, there are some qualities about certain features that must be adjusted. This preprocessing can help tremendously with the outcome and predictive power of nearly all learning algorithms.", "Skewness may violate model assumptions or may impair the interpretation of feature importance. Therefore, here I will apply the logarithmic transformation on the skewed data.", "As shown in the graph, there seems skewness in \u2018capital-gain\u2019 and \u2018capital-loss\u2019 features. Use the quantitative result to confirm if I need to transform skewness in these two variables.", "In addition to performing transformations on features that are highly skewed, here will perform some type of scaling on numerical features. Applying a scaling to the data does not change the shape of each feature\u2019s distribution (such as \u2018capital-gain\u2019 or \u2018capital-loss\u2019 above); however, it is useful to scale the input attributes for a model that relies on the magnitude of values, such as distance measures used in k-nearest neighbors and in the preparation of coefficients in regression.", "There are several features for each record that are non-numeric. Typically, learning algorithms expect the input to be numeric, which requires that non-numeric features (called *categorical variables*) be converted. Here convert categorical variables by using the **one-hot encoding** scheme.", "Additionally, as with the non-numeric features, I need to convert the non-numeric target label, `\u2019income\u2019` to numerical values for the learning algorithm to work. Since there are only two possible categories for this label (\u201c<=50K\u201d and \u201c>50K\u201d), we can simply encode these two categories as `0` and `1`, respectively. Therefore, we will", "In this section, I will investigate five different algorithms, and determine which is best at modeling the data. Four of these algorithms will be supervised learners, and the fifth algorithm is known as a naive predictor.", "Generate a naive predictor to show what a base model without any intelligence would look like. That is if we chose a model that always predicted an individual made more than $50,000, what would that model\u2019s accuracy and F-score be on this dataset? Here assume that we consider more about to correctly predict individual who has income over 50K.", "Therefore, a model\u2019s ability to precisely predict those that make more than $50,000 is more important than the model\u2019s ability to recall those individuals. We can use F-beta score as a metric that considers both precision and recall:", "Apart from the bench mark model, I\u2019ll choose four other models Logistic Regression, Random Forest, Ensemble Methods (AdaBoost) and Support Vector Machines (SVM) as a candidate to build the predictive model.", "To properly evaluate the performance of each model chosen above more efficiently, it\u2019s helpful to create a training and predicting pipeline that can quickly and effectively train models using various sizes of training data and perform predictions on the testing data.", "The pipeline will: \u2014 Fit the learner to the sampled training data and record the training time. \u2014 Perform predictions on the test data `X_test`, and also on the first 300 training points `X_train[:300]`. \u2014 Record the total prediction time. \u2014 Calculate the accuracy score for both the training subset and the testing set. \u2014 Calculate the F-score for both the training subset and the testing set.", "Next, I will choose from the four supervised learning models the *best* model to use on the test data. I will then perform a grid search optimization for the model over the entire training set (`X_train` and `y_train`) to improve upon the untuned model\u2019s F-score.", "According to the model performance graph above, although the Random Forest performs best on the training set the AdaBoost Classifier finally predicts best on testing data. Although the accuracy of AdaBoost Classifier is quite similar to the performance of other models, F-score of AdaBoost is better on both training and testing data when the model is applied to the whole data set. Also, in contrast to Support Vector Classifier which takes dramatically more time to train and predict, the AdaBoost is faster. In terms of binary classification, AdaBoost will also perform well in this case.", "Fine-tune the chosen model. Use grid search (`GridSearchCV`). Use the entire training set for this.", "The optimized model\u2019s accuracy on testing data is 0.8701 and F-score is 0.7518. Both of those scores are better than the unoptimized model. Also, the optimized model performs much better than the benchmarks", "Generally, it\u2019s useful to know which features provide the most predictive power when performing supervised learning on a dataset like the census data here. In this case, it means we wish to identify a small number of features that most strongly predict whether an individual makes at most or more than $50,000.", "Here will choose a scikit-learn classifier (e.g., adaboost, random forests) that has a `feature_importance_` attribute. Fit this classifier to training set and use this attribute to determine the top 5 most important features for the census dataset.", "From the result, the feature importance put \u2018capital-loss\u2019 the most important feature. It\u2019s probably because the bigger capital loss means that the person has to have that volume of money to invest. The \u2018age\u2019 ranks the second one which may because the elder the people the more salary they will have to the donor. The \u2018hours-per-week\u2019 and \u2018sex_Female\u2019 ranks the forth and fifth which probably because it\u2019s not that sure cases. It\u2019s true since maybe the person works longer but have a lower unit salary.", "From the visualization above, we see that the top five most important features contribute more than half of the importance of all features present in the data. This hints that we can attempt to reduce the feature space and simplify the information required for the model to learn. The code cell below will use the same optimized model found earlier, and train it on the same training set with only the top five important features.", "As a result above show, the model performs a bit worse if I only used important features. The accuracy is 5% lower and the f-score is 7% lower, so in this case, I\u2019ll still choose to use all feature to build the model unless when the time for fitting model matters a lot.", "For a more detailed view of my analysis, feel free to check out my corresponding GitHub repository:", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Passionate at Data Science, Information System Management Master from CMU, Traveling lover, Music lover"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F1347edb319e7&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-preprocessing-and-model-comparison-techniques-you-must-know-1347edb319e7&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-preprocessing-and-model-comparison-techniques-you-must-know-1347edb319e7&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-preprocessing-and-model-comparison-techniques-you-must-know-1347edb319e7&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-preprocessing-and-model-comparison-techniques-you-must-know-1347edb319e7&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----1347edb319e7--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----1347edb319e7--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@yfan941101?source=post_page-----1347edb319e7--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@yfan941101?source=post_page-----1347edb319e7--------------------------------", "anchor_text": "Fan Yuan"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F4212f5e30e7a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-preprocessing-and-model-comparison-techniques-you-must-know-1347edb319e7&user=Fan+Yuan&userId=4212f5e30e7a&source=post_page-4212f5e30e7a----1347edb319e7---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F1347edb319e7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-preprocessing-and-model-comparison-techniques-you-must-know-1347edb319e7&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F1347edb319e7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-preprocessing-and-model-comparison-techniques-you-must-know-1347edb319e7&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@srd844?utm_source=medium&utm_medium=referral", "anchor_text": "Stephen Dawson"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://archive.ics.uci.edu/ml/datasets/Census+Income", "anchor_text": "UCI Machine Learning Repository"}, {"url": "https://github.com/JcFreya/Adult-Census-Income", "anchor_text": "https://github.com/JcFreya/Adult-Census-Income"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----1347edb319e7---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/data-preprocessing?source=post_page-----1347edb319e7---------------data_preprocessing-----------------", "anchor_text": "Data Preprocessing"}, {"url": "https://medium.com/tag/model-compression?source=post_page-----1347edb319e7---------------model_compression-----------------", "anchor_text": "Model Compression"}, {"url": "https://medium.com/tag/supervised-learning?source=post_page-----1347edb319e7---------------supervised_learning-----------------", "anchor_text": "Supervised Learning"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F1347edb319e7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-preprocessing-and-model-comparison-techniques-you-must-know-1347edb319e7&user=Fan+Yuan&userId=4212f5e30e7a&source=-----1347edb319e7---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F1347edb319e7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-preprocessing-and-model-comparison-techniques-you-must-know-1347edb319e7&user=Fan+Yuan&userId=4212f5e30e7a&source=-----1347edb319e7---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F1347edb319e7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-preprocessing-and-model-comparison-techniques-you-must-know-1347edb319e7&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----1347edb319e7--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F1347edb319e7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-preprocessing-and-model-comparison-techniques-you-must-know-1347edb319e7&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----1347edb319e7---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----1347edb319e7--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----1347edb319e7--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----1347edb319e7--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----1347edb319e7--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----1347edb319e7--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----1347edb319e7--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----1347edb319e7--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----1347edb319e7--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@yfan941101?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@yfan941101?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Fan Yuan"}, {"url": "https://medium.com/@yfan941101/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "138 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F4212f5e30e7a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-preprocessing-and-model-comparison-techniques-you-must-know-1347edb319e7&user=Fan+Yuan&userId=4212f5e30e7a&source=post_page-4212f5e30e7a--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F18b53286b4a9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-preprocessing-and-model-comparison-techniques-you-must-know-1347edb319e7&newsletterV3=4212f5e30e7a&newsletterV3Id=18b53286b4a9&user=Fan+Yuan&userId=4212f5e30e7a&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}