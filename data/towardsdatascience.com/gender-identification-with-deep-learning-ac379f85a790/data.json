{"url": "https://towardsdatascience.com/gender-identification-with-deep-learning-ac379f85a790", "time": 1682995906.82924, "path": "towardsdatascience.com/gender-identification-with-deep-learning-ac379f85a790/", "webpage": {"metadata": {"title": "Gender Inference with Deep Learning | by Nate Jermain | Towards Data Science", "h1": "Gender Inference with Deep Learning", "description": "I wanted to build a model to infer gender from images. By fine-tuning the pretrained convolutional neural network VGG16, and training it on images of celebrities, I was able to obtain over 98%\u2026"}, "outgoing_paragraph_urls": [{"url": "https://towardsdatascience.com/a-comprehensive-guide-to-convolutional-neural-networks-the-eli5-way-3bd2b1164a53", "anchor_text": "https://towardsdatascience.com/a-comprehensive-guide-to-convolutional-neural-networks-the-eli5-way-3bd2b1164a53", "paragraph_index": 2}, {"url": "https://towardsdatascience.com/transfer-learning-from-pre-trained-models-f2393f124751", "anchor_text": "https://towardsdatascience.com/transfer-learning-from-pre-trained-models-f2393f124751", "paragraph_index": 19}, {"url": "https://github.com/njermain", "anchor_text": "github.com/njermain", "paragraph_index": 20}], "all_paragraphs": ["I wanted to build a model to infer gender from images. By fine-tuning the pretrained convolutional neural network VGG16, and training it on images of celebrities, I was able to obtain over 98% accuracy on the test set. The exercise demonstrates the utility of engineering the architecture of pretrained models to complement the characteristics of the dataset.", "Typically, a human can distinguish a man and a woman in the photo above with ease, but it\u2019s hard to describe exactly why we can make that decision. Without defined features, this distinction becomes very difficult for traditional machine learning approaches. Additionally, features that are relevant to the task are not expressed in the exact same way every time, every person looks a little different. Deep learning algorithms offer a way to process information without predefined features, and make accurate predictions despite variation in how features are expressed. In this article, we\u2019ll apply a convolutional neural network to images of celebrities with the purpose of predicting gender. (Disclaimer: the author understands appearance does not have a causative relationship with gender)", "Convolution neural networks (ConvNets) offer a means to make predictions from raw images. A hallmark of the algorithm is the ability to reduce the dimensionality of images by using sequences of filters that identify distinguishing features. Additional layers in the model help us emphasize the strength of often nonlinear relationships between the features identified by the filters and the label assigned to the image. We can adjust weights associated with the filters and additional layers to minimize the error between the predicted and observed classifications. Sumit Saha offers a great explanation that is more in-depth: https://towardsdatascience.com/a-comprehensive-guide-to-convolutional-neural-networks-the-eli5-way-3bd2b1164a53", "There are a number of pretrained ConvNets that have been trained to classify a range of images of anything from planes to corgis. We can save computation time and overcome some sampling inadequacy by employing the weights of pretrained models and fine-tuning them for our purpose.", "The CelebA dataset contains over 200K images of celebrities labeled with 20 attributes including gender. The images are from the shoulders up, so most of the information is in the facial features and hair style.", "We\u2019re going to use the VGG16 pretrained model and fine tune it to best identify gender from the celebrity images.", "We use \u201cinclude_top=False\u201d to remove the fully connected layer designed for identifying a range of objects the VGG16 was trained to identify (e.g. apples, corgis, scissors), and we download the weights associated with the ImageNet competition.", "Table 1 below shows the convolutional architecture for VGG16; there are millions of weights for all the convolutions that we can choose to either train or keep frozen at the pretrained values. By freezing all the weights of the model, we risk underfitting it because the pretrained weights were not specifically estimated for our particular task. In contrast, by training all the weights we risk overfitting because the model will begin \u201cmemorizing\u201d the training images given the flexibility from high parameterization. We\u2019ll attempt a compromise by training the last convolutional block:", "The first convolutional blocks in the VGG16 models are identifying more general features like lines or blobs, so we want to keep the associated weights. The final blocks identify more fine scale features (e.g. angles associated with the wing tip of an airplane), so we\u2019ll train those weights given our images of celebrities.", "Following feature extraction by the convolutions, we\u2019ll add two dense layers to the model that enable us to make predictions about the image given the features identified. You could use a single dense layer, but an additional hidden layer allows predictions to be made given a more sophisticated interpretation of the features. Too many dense layers may cause overfitting.", "We added a batch normalization layer that will scale our hidden layer activation values in a way to reduce overfitting and computation time. The last dense layer makes predictions about gender (Table 2).", "Because we are allowing the model to train convolutional layers and dense layers, we\u2019ll be estimating millions of weights (Table 3). Given the depth of the network we built, picking the best constant learning rate for an optimizer like stochastic gradient decent would be tricky; instead we\u2019ll use the ADAM optimizer, that adjusts the learning rate to make smaller steps further into training.", "Using Keras, we\u2019ll set up our data generators to feed our model, and fit the network to our training set.", "After 6 epochs, the model achieved a maximum validation accuracy of 98%. Now to apply to the test set.", "We have a test set of 500 images per gender. The model will give us predicted probabilities for each image fed through the network and we can simply take the maximum value of those probabilities as the predicted gender.", "Our model predicted the gender of celebrities with 98.2% accuracy! That\u2019s pretty comparable to human capabilities.", "Does the model generalize to non-celebrities? Lets try on the author. The model did well with a recent picture of the author.", "The predicted probability for the above image was 99.8% male.", "The model also did well with the author\u2019s younger, mop-head past; it predicted 98.6% male.", "This exercise demonstrates the power of fine-tuning pretrained ConvNets. Each application will require a different approach to optimize the modeling process. Specifically, the architecture of the model needs to be engineered in a way that complements the characteristics of the dataset. Pedro Marcelino offers a great explanation of general rules for adapting the fine-tuning process to any dataset: https://towardsdatascience.com/transfer-learning-from-pre-trained-models-f2393f124751", "I appreciate any feedback and constructive criticism on this exercise. The code associated with the analysis can be found on github.com/njermain", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fac379f85a790&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgender-identification-with-deep-learning-ac379f85a790&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgender-identification-with-deep-learning-ac379f85a790&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgender-identification-with-deep-learning-ac379f85a790&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgender-identification-with-deep-learning-ac379f85a790&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----ac379f85a790--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----ac379f85a790--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@nwjermain?source=post_page-----ac379f85a790--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@nwjermain?source=post_page-----ac379f85a790--------------------------------", "anchor_text": "Nate Jermain"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fc90ac583b8a3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgender-identification-with-deep-learning-ac379f85a790&user=Nate+Jermain&userId=c90ac583b8a3&source=post_page-c90ac583b8a3----ac379f85a790---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fac379f85a790&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgender-identification-with-deep-learning-ac379f85a790&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fac379f85a790&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgender-identification-with-deep-learning-ac379f85a790&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/photos/0lLoXbAZ31o?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Alex Holyoake"}, {"url": "https://unsplash.com/search/photos/couple?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://towardsdatascience.com/a-comprehensive-guide-to-convolutional-neural-networks-the-eli5-way-3bd2b1164a53", "anchor_text": "https://towardsdatascience.com/a-comprehensive-guide-to-convolutional-neural-networks-the-eli5-way-3bd2b1164a53"}, {"url": "https://towardsdatascience.com/transfer-learning-from-pre-trained-models-f2393f124751", "anchor_text": "https://towardsdatascience.com/transfer-learning-from-pre-trained-models-f2393f124751"}, {"url": "https://github.com/njermain", "anchor_text": "github.com/njermain"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----ac379f85a790---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----ac379f85a790---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----ac379f85a790---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/python?source=post_page-----ac379f85a790---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/neural-networks?source=post_page-----ac379f85a790---------------neural_networks-----------------", "anchor_text": "Neural Networks"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fac379f85a790&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgender-identification-with-deep-learning-ac379f85a790&user=Nate+Jermain&userId=c90ac583b8a3&source=-----ac379f85a790---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fac379f85a790&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgender-identification-with-deep-learning-ac379f85a790&user=Nate+Jermain&userId=c90ac583b8a3&source=-----ac379f85a790---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fac379f85a790&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgender-identification-with-deep-learning-ac379f85a790&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----ac379f85a790--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fac379f85a790&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgender-identification-with-deep-learning-ac379f85a790&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----ac379f85a790---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----ac379f85a790--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----ac379f85a790--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----ac379f85a790--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----ac379f85a790--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----ac379f85a790--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----ac379f85a790--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----ac379f85a790--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----ac379f85a790--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@nwjermain?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@nwjermain?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Nate Jermain"}, {"url": "https://medium.com/@nwjermain/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "35 Followers"}, {"url": "http://linkedin.com/in/njermain/", "anchor_text": "linkedin.com/in/njermain/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fc90ac583b8a3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgender-identification-with-deep-learning-ac379f85a790&user=Nate+Jermain&userId=c90ac583b8a3&source=post_page-c90ac583b8a3--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fusers%2Fc90ac583b8a3%2Flazily-enable-writer-subscription&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgender-identification-with-deep-learning-ac379f85a790&user=Nate+Jermain&userId=c90ac583b8a3&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}