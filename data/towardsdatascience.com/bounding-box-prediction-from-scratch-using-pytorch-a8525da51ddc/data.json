{"url": "https://towardsdatascience.com/bounding-box-prediction-from-scratch-using-pytorch-a8525da51ddc", "time": 1683010465.424264, "path": "towardsdatascience.com/bounding-box-prediction-from-scratch-using-pytorch-a8525da51ddc/", "webpage": {"metadata": {"title": "Bounding Box Prediction from Scratch using PyTorch | by Aakanksha NS | Towards Data Science", "h1": "Bounding Box Prediction from Scratch using PyTorch", "description": "Object detection is a very popular task in Computer Vision, where, given an image, you predict (usually rectangular) boxes around objects present in the image and also recognize the types of objects\u2026"}, "outgoing_paragraph_urls": [{"url": "https://arxiv.org/pdf/1506.01497.pdf", "anchor_text": "Faster-RCNN", "paragraph_index": 0}, {"url": "https://pjreddie.com/media/files/papers/YOLOv3.pdf", "anchor_text": "YOLO v3", "paragraph_index": 0}, {"url": "https://jovian.ml/aakanksha-ns/road-signs-bounding-box-prediction", "anchor_text": "https://jovian.ml/aakanksha-ns/road-signs-bounding-box-prediction", "paragraph_index": 2}, {"url": "https://github.com/albumentations-team/albumentations", "anchor_text": "albumentations", "paragraph_index": 20}, {"url": "https://www.linkedin.com/in/aakanksha-ns/", "anchor_text": "https://www.linkedin.com/in/aakanksha-ns/", "paragraph_index": 22}], "all_paragraphs": ["Object detection is a very popular task in Computer Vision, where, given an image, you predict (usually rectangular) boxes around objects present in the image and also recognize the types of objects. There could be multiple objects in your image and there are various state-of-the-art techniques and architectures to tackle this problem like Faster-RCNN and YOLO v3.", "This article talks about the case when there is only one object of interest present in an image. The focus here is more on how to read an image and its bounding box, resize and perform augmentations correctly, rather than on the model itself. The goal is to have a good grasp of the fundamental ideas behind object detection, which you can extend to get a better understanding of the more complex techniques.", "Here\u2019s a link to the notebook consisting of all the code I\u2019ve used for this article: https://jovian.ml/aakanksha-ns/road-signs-bounding-box-prediction", "If you\u2019re new to Deep Learning or PyTorch, or just need a refresher, this might interest you:", "Given an image consisting of a road sign, predict a bounding box around the road sign and identify the type of road sign.", "There are four distinct classes these signs could belong to:", "This is called a multi-task learning problem as it involves performing two tasks \u2014 1) regression to find the bounding box coordinates, 2) classification to identify the type of road sign", "I\u2019ve used the Road Sign Detection Dataset from Kaggle:", "It consists of 877 images. It\u2019s a pretty imbalanced dataset, with most images belonging to the speed limit class, but since we\u2019re more focused on the bounding box prediction, we can ignore the imbalance.", "The annotations for each image were stored in separate XML files. I followed the following steps to create the training dataframe:", "Since training a computer vision model needs images to be of the same size, we need to resize our images and their corresponding bounding boxes. Resizing an image is straightforward but resizing the bounding box is a little tricky because each box is relative to an image and its dimensions.", "Here\u2019s how resizing a bounding box works:", "Data Augmentation is a technique to generalize our model better by creating new training images by using different variations of the existing images. We have only 800 images in our current training set, so data augmentation is very important to ensure our model doesn\u2019t overfit.", "For this problem, I\u2019ve used flip, rotation, center crop and random crop. I\u2019ve talked about various data augmentation techniques in this article:", "The only thing to remember here is ensuring that the bounding box is also transformed the same way as the image. To do this we follow the same approach as resizing \u2014 convert bounding box to a mask, apply the same transformations to the mask as the original image, and extract the bounding box coordinates.", "Now that we have our data augmentations in place, we can do the train-validation split and create our PyTorch dataset. We normalize the images using ImageNet stats because we\u2019re using a pre-trained ResNet model and apply data augmentations in our dataset while training.", "For the model, I\u2019ve used a very simple pre-trained resNet-34 model. Since we have two tasks to accomplish here, there are two final layers \u2014 the bounding box regressor and the image classifier.", "For the loss, we need to take into both classification loss and the bounding box regression loss, so we use a combination of cross-entropy and L1-loss (sum of all the absolute differences between the true value and the predicted coordinates). I\u2019ve scaled the L1-loss by a factor of 1000 because to have both the classification and regression losses in a similar range. Apart from this, it\u2019s a standard PyTorch training loop (using a GPU):", "Now that we\u2019re done with training, we can pick a random image and test our model on it. Even though we had a fairly small number of training images, we end up getting a pretty decent prediction on our test image.", "It\u2019ll be a fun exercise to take a real photo using your phone and test out the model. Another interesting experiment would be to not perform any data augmentations and train the model and compare the two models.", "Now that we\u2019ve covered the fundamentals of object detection and implemented it from scratch, you can extend these ideas to the multi-object case and try out more complex models like RCNN and YOLO! Also, check out this super cool library called albumentations to perform data augmentations easily.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "ML Engineer @ Snap Inc. | MSDS University of San Francisco | CSE NIT Calicut https://www.linkedin.com/in/aakanksha-ns/"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fa8525da51ddc&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbounding-box-prediction-from-scratch-using-pytorch-a8525da51ddc&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbounding-box-prediction-from-scratch-using-pytorch-a8525da51ddc&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbounding-box-prediction-from-scratch-using-pytorch-a8525da51ddc&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbounding-box-prediction-from-scratch-using-pytorch-a8525da51ddc&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----a8525da51ddc--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----a8525da51ddc--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@aakanksha.ns?source=post_page-----a8525da51ddc--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@aakanksha.ns?source=post_page-----a8525da51ddc--------------------------------", "anchor_text": "Aakanksha NS"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Ff30e60797a83&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbounding-box-prediction-from-scratch-using-pytorch-a8525da51ddc&user=Aakanksha+NS&userId=f30e60797a83&source=post_page-f30e60797a83----a8525da51ddc---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa8525da51ddc&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbounding-box-prediction-from-scratch-using-pytorch-a8525da51ddc&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa8525da51ddc&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbounding-box-prediction-from-scratch-using-pytorch-a8525da51ddc&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://arxiv.org/pdf/1506.01497.pdf", "anchor_text": "Faster-RCNN"}, {"url": "https://pjreddie.com/media/files/papers/YOLOv3.pdf", "anchor_text": "YOLO v3"}, {"url": "https://jovian.ml/aakanksha-ns/road-signs-bounding-box-prediction", "anchor_text": "https://jovian.ml/aakanksha-ns/road-signs-bounding-box-prediction"}, {"url": "https://www.kaggle.com/andrewmvd/road-sign-detection", "anchor_text": "Source"}, {"url": "https://www.kaggle.com/andrewmvd/road-sign-detection", "anchor_text": "Road Sign Detection877 images belonging to 4 classes.www.kaggle.com"}, {"url": "https://towardsdatascience.com/image-processing-techniques-for-computer-vision-11f92f511e21", "anchor_text": "Image Processing Techniques for Computer VisionImage Processing is an integral part of Computer vision. We almost always want to resize images, do data augmentation\u2026towardsdatascience.com"}, {"url": "https://github.com/albumentations-team/albumentations", "anchor_text": "albumentations"}, {"url": "https://www.usfca.edu/arts-sciences/graduate-programs/data-science", "anchor_text": "Master\u2019s in Data Science"}, {"url": "https://www.usfca.edu/data-institute/certificates/fundamentals-deep-learning", "anchor_text": "https://www.usfca.edu/data-institute/certificates/fundamentals-deep-learning"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----a8525da51ddc---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/pytorch?source=post_page-----a8525da51ddc---------------pytorch-----------------", "anchor_text": "Pytorch"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----a8525da51ddc---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/computer-vision?source=post_page-----a8525da51ddc---------------computer_vision-----------------", "anchor_text": "Computer Vision"}, {"url": "https://medium.com/tag/object-detection?source=post_page-----a8525da51ddc---------------object_detection-----------------", "anchor_text": "Object Detection"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fa8525da51ddc&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbounding-box-prediction-from-scratch-using-pytorch-a8525da51ddc&user=Aakanksha+NS&userId=f30e60797a83&source=-----a8525da51ddc---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fa8525da51ddc&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbounding-box-prediction-from-scratch-using-pytorch-a8525da51ddc&user=Aakanksha+NS&userId=f30e60797a83&source=-----a8525da51ddc---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa8525da51ddc&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbounding-box-prediction-from-scratch-using-pytorch-a8525da51ddc&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----a8525da51ddc--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fa8525da51ddc&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbounding-box-prediction-from-scratch-using-pytorch-a8525da51ddc&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----a8525da51ddc---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----a8525da51ddc--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----a8525da51ddc--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----a8525da51ddc--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----a8525da51ddc--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----a8525da51ddc--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----a8525da51ddc--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----a8525da51ddc--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----a8525da51ddc--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@aakanksha.ns?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@aakanksha.ns?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Aakanksha NS"}, {"url": "https://medium.com/@aakanksha.ns/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "322 Followers"}, {"url": "https://www.linkedin.com/in/aakanksha-ns/", "anchor_text": "https://www.linkedin.com/in/aakanksha-ns/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Ff30e60797a83&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbounding-box-prediction-from-scratch-using-pytorch-a8525da51ddc&user=Aakanksha+NS&userId=f30e60797a83&source=post_page-f30e60797a83--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fb925b3bc1777&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbounding-box-prediction-from-scratch-using-pytorch-a8525da51ddc&newsletterV3=f30e60797a83&newsletterV3Id=b925b3bc1777&user=Aakanksha+NS&userId=f30e60797a83&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}