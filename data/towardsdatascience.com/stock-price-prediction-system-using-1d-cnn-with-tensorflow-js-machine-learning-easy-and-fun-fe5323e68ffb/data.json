{"url": "https://towardsdatascience.com/stock-price-prediction-system-using-1d-cnn-with-tensorflow-js-machine-learning-easy-and-fun-fe5323e68ffb", "time": 1682995088.829113, "path": "towardsdatascience.com/stock-price-prediction-system-using-1d-cnn-with-tensorflow-js-machine-learning-easy-and-fun-fe5323e68ffb/", "webpage": {"metadata": {"title": "Stock Price Prediction System using 1D CNN with TensorFlow.js-Machine Learning Easy and Fun | by Gavril Ognjanovski | Towards Data Science", "h1": "Stock Price Prediction System using 1D CNN with TensorFlow.js-Machine Learning Easy and Fun", "description": "While I was reading about stock prediction on the web, I saw people talking about using 1D CNN to predict the stock price. This caught my attention since CNN is specifically designed to process pixel\u2026"}, "outgoing_paragraph_urls": [{"url": "https://iextrading.com/developer/docs/#chart", "anchor_text": "link", "paragraph_index": 4}, {"url": "https://en.wikipedia.org/wiki/Convolutional_neural_network", "anchor_text": "But what is CNN ?", "paragraph_index": 12}, {"url": "https://en.wikipedia.org/wiki/Deep_neural_network", "anchor_text": "deep neural networks", "paragraph_index": 12}], "all_paragraphs": ["While I was reading about stock prediction on the web, I saw people talking about using 1D CNN to predict the stock price. This caught my attention since CNN is specifically designed to process pixel data and used in image recognition and processing and it looked like a interesting challenge.", "This solution is frontend only application using Tensorflow.js library and the best part is that it doesn\u2019t require any server side. The data is available via \u201cIEX Developer Platform\u201d API service. The Image 1 above is from this stock prediction application.", "The code is available on my Github repository.", "All the work that need to be done can be set up in 6 steps:", "This data is gathered using the API from IEX. The API description is available on the following link. In this application I\u2019m are using the chart endpoint which has predefined historical period of 1y (1 year). The placeholder %company% is where we replace the company symbol that we input in the application.", "The result from this API is json array with historical data for the requested company. Below is some example from the response data.", "After the data is retrieved we need to process it and prepare the feature set and the label set. While I was researching, mostly I found ideas where they were using date fields as feature. However I didn\u2019t like this because of two reasons. First, the date is constantly increasing as feature. Second, the dates are independent (not directly connected with stock price).", "What I think is more connected with the current stock price is how the stock price changed in the past. So for example the stock price today is dependent on the stock price changes from the last 7 days. For that reason we define 7 features for our test set and each one of them is labeled with the stock price for the next day.", "All this preprocessing of the data is made in processData function defined in helpers.js file. In our case timePortion variable has value 7.", "And what we get for trainX is flat array of values, but later we will reshape it to matrix with format:[number_of_samples - 7, number_of_features]", "Another important thing is that we first normalize our features using minMaxScaler function defined in helpers.js file. This will scale all the values between 0 and 1. This is important so the prediction model better fit our model and to be faster when there is a lot of data. If you want to know more about this min-max normalization you can find references at the end of this blog.", "Next step is creating the CNN model. This is done by buildCnn function in prediction.js file. This step is really simplified using the Tensorflow library. What we need to do is define sequential (linear stack of layers) tensorflow model and then add the predefined layers in order to build our CNN model.", "But what is CNN ? CNN or Convolutional Neural Network is a class of deep neural networks, most commonly applied to analyzing visual imagery. That\u2019s why using it for predicting stock price is unusual and interesting challenge.", "The CNN has 4 important type of layers that makes it different. These are Convolution layer, ReLU layer, Pooling layer and Fully Connected Layer. Each of them has specific task to do. However, I won\u2019t dive deep in explaining CNN here for now.", "Let\u2019s continue building the CNN with Tensorflow. We defined total of 7 layers:", "Below is the code where we define all these layers in sequential tensorflow model.", "After we build our model we proceed to the next step, which is training our model.", "Now that we have created our model, we need to get ready and transform our data. That means transforming our train and label sets into tensor data, since tensorflow works with it\u2019s own type of data known as tensor(s).", "This is pretty simple step. We create the tensors and reshape our features data into [number_of_samples, timePortion, 1]. timePortion is 7 in this case.", "Now that we got our tensors we use them along with the model in cnn function. There, we first set up the optimization algorithm and the loss function. We use the \u201cadam\u201d algorithm as optimizer and \u201cminSquaredError\u201d as loss function.", "Unlike SGD (scholastic gradient descent), Adam optimizer use different learning rate for each weight.", "The last thing we need to do here is to call the fit function on the tensorflow model and send the trainX (features) and trainY (labels) sets. We also set the options for epochs to 100.", "Training your network on each item of the set once is one epoch.", "When the training is over it returns the result and the model is prepared to be used for generating predictions.", "In this step we already have our model prepared for making future predictions. What we will do first is use this model to predict on the same set that we trained our model. The idea behind this is that we can compare (visualize) how well our model fits the training set.", "We create the prediction simply by calling predict function from the model.", "We get the predicted data by calling:", "And since we have previously normalized (scaled) our features we need to run inverse min-max operation in order to get the real feature values. We do that by calling minMaxInverseScaler function from helpers.js where we send the predicted data along with min and max values.", "Now we use the plotData function defined in plot.js so we can visualize both (actual and predicted) data sets. P.S. I used Chart.js library for visualization.", "What\u2019s left to do is generating the test features for making the next day stock price prediction. This features are generated using generateNextDayPrediction function from helpers.js file.", "What this function does is pretty simple. It takes the last 7 stock price values from the given data and create the test feature set (for next day prediction).", "Then we repeat the same steps where we transform this data into tensor data and reshape it into [number_of_samples, number_of_features, 1] which in this case it will be [1, 7, 1] since we have only one test example.", "Next, we call the predict function from our model.", "We get the predicted value and run inverse min-max normalization", "At the end we just add that value at the end of our predicted data (from the train set in the previous \u201cTest the ML Model\u201d section) so it can be visualized on the graph.", "Hopefully this was clear and easy to understand. If you think that some part needs better explanation please feel free to add a comment or suggestion. For any questions feel free to contact me.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Software Engineer, Startup Enthusiast, Tech Lover, Seeker"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Ffe5323e68ffb&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fstock-price-prediction-system-using-1d-cnn-with-tensorflow-js-machine-learning-easy-and-fun-fe5323e68ffb&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fstock-price-prediction-system-using-1d-cnn-with-tensorflow-js-machine-learning-easy-and-fun-fe5323e68ffb&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fstock-price-prediction-system-using-1d-cnn-with-tensorflow-js-machine-learning-easy-and-fun-fe5323e68ffb&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fstock-price-prediction-system-using-1d-cnn-with-tensorflow-js-machine-learning-easy-and-fun-fe5323e68ffb&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----fe5323e68ffb--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----fe5323e68ffb--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@ognjanovski.gavril?source=post_page-----fe5323e68ffb--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@ognjanovski.gavril?source=post_page-----fe5323e68ffb--------------------------------", "anchor_text": "Gavril Ognjanovski"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F6e9aa8156fe7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fstock-price-prediction-system-using-1d-cnn-with-tensorflow-js-machine-learning-easy-and-fun-fe5323e68ffb&user=Gavril+Ognjanovski&userId=6e9aa8156fe7&source=post_page-6e9aa8156fe7----fe5323e68ffb---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ffe5323e68ffb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fstock-price-prediction-system-using-1d-cnn-with-tensorflow-js-machine-learning-easy-and-fun-fe5323e68ffb&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ffe5323e68ffb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fstock-price-prediction-system-using-1d-cnn-with-tensorflow-js-machine-learning-easy-and-fun-fe5323e68ffb&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://github.com/Gago993/StockPredictionCNN", "anchor_text": "Gago993/StockPredictionCNNStock Prediction using Convolutional Neural Network and TensorflowJS - Gago993/StockPredictionCNNgithub.com"}, {"url": "https://iextrading.com/developer/docs/#chart", "anchor_text": "link"}, {"url": "https://en.wikipedia.org/wiki/Convolutional_neural_network", "anchor_text": "But what is CNN ?"}, {"url": "https://en.wikipedia.org/wiki/Deep_neural_network", "anchor_text": "deep neural networks"}, {"url": "https://en.wikipedia.org/wiki/Feature_scaling", "anchor_text": "Feature scaling - WikipediaFeature scaling is a method used to standardize the range of independent variables or features of data. In data\u2026en.wikipedia.org"}, {"url": "https://machinelearningmastery.com/adam-optimization-algorithm-for-deep-learning/", "anchor_text": "Gentle Introduction to the Adam Optimization Algorithm for Deep LearningThe choice of optimization algorithm for your deep learning model can mean the difference between good results in\u2026machinelearningmastery.com"}, {"url": "https://medium.com/tag/data-science?source=post_page-----fe5323e68ffb---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/programming?source=post_page-----fe5323e68ffb---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----fe5323e68ffb---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----fe5323e68ffb---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/technology?source=post_page-----fe5323e68ffb---------------technology-----------------", "anchor_text": "Technology"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Ffe5323e68ffb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fstock-price-prediction-system-using-1d-cnn-with-tensorflow-js-machine-learning-easy-and-fun-fe5323e68ffb&user=Gavril+Ognjanovski&userId=6e9aa8156fe7&source=-----fe5323e68ffb---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Ffe5323e68ffb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fstock-price-prediction-system-using-1d-cnn-with-tensorflow-js-machine-learning-easy-and-fun-fe5323e68ffb&user=Gavril+Ognjanovski&userId=6e9aa8156fe7&source=-----fe5323e68ffb---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ffe5323e68ffb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fstock-price-prediction-system-using-1d-cnn-with-tensorflow-js-machine-learning-easy-and-fun-fe5323e68ffb&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----fe5323e68ffb--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Ffe5323e68ffb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fstock-price-prediction-system-using-1d-cnn-with-tensorflow-js-machine-learning-easy-and-fun-fe5323e68ffb&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----fe5323e68ffb---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----fe5323e68ffb--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----fe5323e68ffb--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----fe5323e68ffb--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----fe5323e68ffb--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----fe5323e68ffb--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----fe5323e68ffb--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----fe5323e68ffb--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----fe5323e68ffb--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@ognjanovski.gavril?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@ognjanovski.gavril?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Gavril Ognjanovski"}, {"url": "https://medium.com/@ognjanovski.gavril/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "634 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F6e9aa8156fe7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fstock-price-prediction-system-using-1d-cnn-with-tensorflow-js-machine-learning-easy-and-fun-fe5323e68ffb&user=Gavril+Ognjanovski&userId=6e9aa8156fe7&source=post_page-6e9aa8156fe7--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F8d1666956212&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fstock-price-prediction-system-using-1d-cnn-with-tensorflow-js-machine-learning-easy-and-fun-fe5323e68ffb&newsletterV3=6e9aa8156fe7&newsletterV3Id=8d1666956212&user=Gavril+Ognjanovski&userId=6e9aa8156fe7&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}