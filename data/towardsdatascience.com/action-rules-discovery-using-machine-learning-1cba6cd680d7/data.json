{"url": "https://towardsdatascience.com/action-rules-discovery-using-machine-learning-1cba6cd680d7", "time": 1683013827.039713, "path": "towardsdatascience.com/action-rules-discovery-using-machine-learning-1cba6cd680d7/", "webpage": {"metadata": {"title": "Action Rules Discovery using Machine Learning | by Haihan Lan | Towards Data Science", "h1": "Action Rules Discovery using Machine Learning", "description": "Suppose you are a Data Magician working at a business and were tasked to come up with a churn prediction model, to predict which customers are at risk of unsubscribing from the service that your\u2026"}, "outgoing_paragraph_urls": [{"url": "https://colab.research.google.com/signup", "anchor_text": "Colab Pro", "paragraph_index": 1}, {"url": "https://github.com/slundberg/shap", "anchor_text": "Shapley values", "paragraph_index": 2}], "all_paragraphs": ["In this article we are going to cover:", "Suppose you are a Data Magician working at a business and were tasked to come up with a churn prediction model, to predict which customers are at risk of unsubscribing from the service that your business offers. You quickly spin up a deep neural network on some P100 GPUs on Colab Pro and get some high prediction accuracies, have a kombucha and then call it a day. The next afternoon your boss calls you over a Zoom and says that although the prediction capabilities are useful, she needs to know what factors contribute to the churn probability and by how much.", "You revise the model and instead of deep neural nets, go with ensembles of LightGBMs combined with Shapley values computed over the individual boosted trees to give factor inference outputs like the following:", "You have another kombucha, satisfied at having discovered (quite robustly too) what factors the model thinks contribute to churn, and call it a day.", "Just before you get off Friday afternoon, your boss Zoom calls you again and tells you that although the factor inference insights are great, we still don\u2019t know if these factors actually cause churn or retention. She reminds you that correlation does not imply causation and that she can\u2019t tell which factors suggested by the model are actually causative vs being coincidences or spurious correlations.", "Being the obsessive Data Magician you are, you scour the interwebs and stumble upon a hidden gem that does everything your boss asked for.", "There is a branch of supervised machine learning called Uplift modelling that deals with answering questions like \u201cHow much will X intervention/action affect outcome Y?\u201d given a dataset of historical records that contain data regarding intervention X and outcome Y. The effect of X on Y is a quantity (typically a percentage if Y is a probability) called uplift. In this article we are going to briefly cover a package called actionrules created by [1] and how to apply it to discover action rules and quantify their impact on an outcome.", "We will cover briefly some definitions regarding classification rules, actions rules, support, confidence and look at how uplift is estimated.", "Classification rules r_n are defined as:", "Where the tuple (X_1, n \u2227 X_2, n \u2227 \u2026 \u2227 X_m, n ) are particular values X_m from n input columns. This tuple is called the antecedent or ant and the outcome Y_n is called the consequent. For For example:", "is a classification rule. Classification rules are further quantified by two numbers called support and confidence. The support is defined as", "which is a the number of classification rules matching the condition (ant \u2192 Yn), or rules matching both the antecedent and the consequent. The confidence is defined as", "or the support of (ant \u2192 Yn) divided by the total number of rules with a matching antecedent only.", "Action rules are an extension of classification rules:", "where f is a set of fixed or unchangeable attributes. For action rules we consider the conjunction of fixed attributes and a change of non-fixed or flexible attributes from initial set X to X\u2019 will change the outcome Y to Y\u2019. A concrete example is", "Meaning in principle if our subject with age fixed, quit smoking and lost weight due to diet/exercise they would no longer be at risk of heart disease. We can again use confidences and supports to quantify the quality of the action rules discovered by some method. The support for an action rules takes into account the two classification rules r_1 = (X\u2192Y) and r_2 = (X\u2019\u2192Y\u2019)that constitute the action rule and is defined as", "and confidence of the action rule is defined as", "Intuitively the support of an action rule can only be as much as the minimum support of one of its classification rules and the confidence of the action will be smaller than or equal to either confidences of the classification rules.", "Finally, the uplift is defined as", "uplift = P(outcome | treatment)-P(outcome | no treatment).", "Any uplift model in general will attempt to estimate the two conditional probabilities above.", "Details of the action rules discovery algorithms can be found in the source [1] but briefly, the actionrules package incorporates a heuristic based classification and action rule discovery algorithm, running in a supervised manner (meaning we must have/specify the targets or outcome labels). We will run the action rules model on a toy customer churn dataset from a Telecom company called telco.csv.", "According to the Kaggle dataset page [2]:", "The data set includes information about:", "First we install the actionrules package using the console:", "Read in the dataset and check the head", "And now instantiate the action rules model and run a fit of the model on the data", "The run took approximately 9 seconds on a MacBook Pro 1.4 GHz Intel Core i5", "Next we count the number of action rules discovered:", "And it turns out there were 8 action rules discovered. Let\u2019s now take a look at what the actual rules are:", "An example of one of the rules we discovered", "We\u2019ve discovered an interesting phenomenon where telecom customers who are single (partner = No) with no internet service are less likely to churn by approximately 5.6%, with decently high support of 6.7% and confidence of 55%.", "This suggests from a business perspective that perhaps we need to tone down on aggressively marketing add-on internet services to single customers (Partner: no) in the short term to reduce churn, but will need to eventually design a better marketing strategy targeting that demographic in the future, as we still want to sell as much additional internet services as possible as a telecom company.", "The notebook with the code example and results above is here:", "Feel free to play around with the flexible attributes and the confidence and support minimums, as modifying those hyper parameters can give different results.", "We saw how classification rules and action rules were defined, confidence and support values for each, the difference between fixed and flexible attributes and an example of how the action rules can be modelled using supervised learning and the actionrules Python package.", "Finding action rules with high support, confidence and high uplift can give business stakeholders new insight on which actions to take in order to maximize a certain outcome.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F1cba6cd680d7&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Faction-rules-discovery-using-machine-learning-1cba6cd680d7&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Faction-rules-discovery-using-machine-learning-1cba6cd680d7&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Faction-rules-discovery-using-machine-learning-1cba6cd680d7&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Faction-rules-discovery-using-machine-learning-1cba6cd680d7&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----1cba6cd680d7--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----1cba6cd680d7--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@hhl60492?source=post_page-----1cba6cd680d7--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@hhl60492?source=post_page-----1cba6cd680d7--------------------------------", "anchor_text": "Haihan Lan"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F70a936a57085&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Faction-rules-discovery-using-machine-learning-1cba6cd680d7&user=Haihan+Lan&userId=70a936a57085&source=post_page-70a936a57085----1cba6cd680d7---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F1cba6cd680d7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Faction-rules-discovery-using-machine-learning-1cba6cd680d7&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F1cba6cd680d7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Faction-rules-discovery-using-machine-learning-1cba6cd680d7&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://images.unsplash.com/photo-1522163182402-834f871fd851?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=1593&q=80", "anchor_text": "https://images.unsplash.com/photo-1522163182402-834f871fd851?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=1593&q=80"}, {"url": "https://towardsdatascience.com/deep-kernels-and-gaussian-processes-for-few-shot-learning-38a4ac0b64db", "anchor_text": "Deep Kernels and Gaussian Processes"}, {"url": "https://towardsdatascience.com/custom-tensorflow-loss-functions-for-advanced-machine-learning-f13cdd1d188a", "anchor_text": "Custom Loss Functions in TensorFlow"}, {"url": "https://towardsdatascience.com/prediction-and-inference-with-boosted-trees-and-shapley-values-4ffef46b969a", "anchor_text": "Prediction and Inference with Boosted Trees"}, {"url": "https://towardsdatascience.com/the-softmax-function-neural-net-outputs-as-probabilities-and-ensemble-classifiers-9bd94d75932", "anchor_text": "Softmax classification"}, {"url": "https://towardsdatascience.com/analyzing-climate-patterns-with-self-organizing-maps-soms-8d4ef322705b", "anchor_text": "Climate analysis"}, {"url": "https://colab.research.google.com/signup", "anchor_text": "Colab Pro"}, {"url": "https://github.com/slundberg/shap", "anchor_text": "Shapley values"}, {"url": "https://github.com/slundberg/shap", "anchor_text": "https://github.com/slundberg/shap"}, {"url": "https://github.com/hhl60492/actionrules/blob/master/notebooks/data/telco.csv", "anchor_text": "https://github.com/hhl60492/actionrules/blob/master/notebooks/data/telco.csv"}, {"url": "https://github.com/hhl60492/actionrules/blob/master/notebooks/Telco%20-%20Action%20Rules.ipynb", "anchor_text": "https://github.com/hhl60492/actionrules/blob/master/notebooks/Telco%20-%20Action%20Rules.ipynb"}, {"url": "http://ceur-ws.org/Vol-2644/paper36.pdf", "anchor_text": "http://ceur-ws.org/Vol-2644/paper36.pdf"}, {"url": "https://www.kaggle.com/blastchar/telco-customer-churn", "anchor_text": "https://www.kaggle.com/blastchar/telco-customer-churn"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----1cba6cd680d7---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----1cba6cd680d7---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/supervised-learning?source=post_page-----1cba6cd680d7---------------supervised_learning-----------------", "anchor_text": "Supervised Learning"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F1cba6cd680d7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Faction-rules-discovery-using-machine-learning-1cba6cd680d7&user=Haihan+Lan&userId=70a936a57085&source=-----1cba6cd680d7---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F1cba6cd680d7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Faction-rules-discovery-using-machine-learning-1cba6cd680d7&user=Haihan+Lan&userId=70a936a57085&source=-----1cba6cd680d7---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F1cba6cd680d7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Faction-rules-discovery-using-machine-learning-1cba6cd680d7&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----1cba6cd680d7--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F1cba6cd680d7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Faction-rules-discovery-using-machine-learning-1cba6cd680d7&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----1cba6cd680d7---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----1cba6cd680d7--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----1cba6cd680d7--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----1cba6cd680d7--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----1cba6cd680d7--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----1cba6cd680d7--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----1cba6cd680d7--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----1cba6cd680d7--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----1cba6cd680d7--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@hhl60492?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@hhl60492?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Haihan Lan"}, {"url": "https://medium.com/@hhl60492/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "371 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F70a936a57085&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Faction-rules-discovery-using-machine-learning-1cba6cd680d7&user=Haihan+Lan&userId=70a936a57085&source=post_page-70a936a57085--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F376c65fc851a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Faction-rules-discovery-using-machine-learning-1cba6cd680d7&newsletterV3=70a936a57085&newsletterV3Id=376c65fc851a&user=Haihan+Lan&userId=70a936a57085&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}