{"url": "https://towardsdatascience.com/how-to-measure-distances-in-machine-learning-13a396aa34ce", "time": 1682996631.195664, "path": "towardsdatascience.com/how-to-measure-distances-in-machine-learning-13a396aa34ce/", "webpage": {"metadata": {"title": "How to measure distances in machine learning | by Euge Inzaugarat | Towards Data Science", "h1": "How to measure distances in machine learning", "description": "\u201cIf you dig a hole here in Germany, you end up in China\u201d \u2014 I laughed so badly when my European friends told me that. Not because I thought it was absurd or something. But because that saying was also\u2026"}, "outgoing_paragraph_urls": [{"url": "https://towardsdatascience.com/using-machine-learning-to-understand-customers-behavior-f41b567d3a50?source=friends_link&sk=191804653e3bc41f52a4fa339ec4931a", "anchor_text": "clustering", "paragraph_index": 64}], "all_paragraphs": ["\u201cIf you dig a hole here in Germany, you end up in China\u201d \u2014 I laughed so badly when my European friends told me that.", "Not because I thought it was absurd or something. But because that saying was also very common in Argentina. I didn\u2019t think that it was a worldwide saying.", "\u201cReally? is it also common there?\u201d \u2014 They were as surprised as me.", "\u201cWait! There is a website that you can discover where you end up if you dig a hole where you are standing\u201d \u2014 My friend said. He always had a website for everything.", "\u201cWhy do you think that is the same here and there?\u201d \u2014 Another friend inquired \u2014 \u201cPerhaps because it indicates a place that is far from where we were born\u201d", "\u201cFor me, Spain is very far away\u201d \u2014 Someone else stated", "From me, my home country was far away. So for me, 13000 km was far. For some of my friends, 2000 km was very far away.", "I started thinking about how complex the concept of distance was if you see it in a subjective way.", "Sometimes you are sitting across someone but that person seems so distant. Other times, a person is kilometers away. And a message is all that it takes to feel that someone very close.", "In some cases, I guess that close and distant depends on the point of view.", "In machine learning, many supervised and unsupervised algorithms use Distance Metrics to understand patterns in the input data. Also, it is used to recognize similarities among the data.", "Choosing a good distance metric will improve how well a classification or clustering algorithms performed.", "A Distance Metric employs distance functions that tell us the distance between the elements in the dataset.", "Luckily, these distances can be measured with a mathematical formula. If the distance is small, the elements are likely similar. If the distance is large, the degree of similarity will be low.", "There are several distance metrics which can be used. It is important to know what they take into account. This will help us choose which one is more appropriated for a model to avoid introducing errors or misinterpretations.", "1Euclidean distance: When we were talking about distances earlier, we mostly think about distances in a more or less straight line.", "If we think of distances between two cities, we think about how many kilometers we have to drive on a highway.", "These examples of distances that we can think of are examples of Euclidean distance. Essentially, it measures the length of a segment that connects two points. Let\u2019s see this in a graph:", "Does this ring any bell? Do you remember the Pythagorean Theorem from Math classes?", "The theorem states that that the square of the hypotenuse (the side opposite the right angle) is equal to the sum of the squares of the other two sides.", "Well, the Euclidean distance can be calculated using it.", "In our example, we have a distance between 2-dimensional points, so the formula is:", "For n-points, the general formula is as follows:", "Where x and y are two vectors.", "Euclidean distance is the most commonly used distance for machine learning algorithms. It is very useful when our data is continuous. It is also called L2-Norm.", "So, is Euclidean distance not enough? Why do we need another type of distances?", "There are some situations where Euclidean distance will fail to give us the proper metric. In those cases, we will need to make use of different distance functions.", "2Manhattan distance: Let\u2019s say that we again want to calculate the distance between two points. But this time, we want to do it in a grid-like path like the purple line in the figure.", "In this case, the relevant metric is Manhattan distance. It is defined as the sum of the absolute differences of their Cartesian coordinates.", "Let\u2019s clarify this. A data point has a set of numerical cartesian coordinates that specify uniquely that point.", "These coordinates are a signed distance from the point to two fixed perpendicular oriented lines such as the one displayed in the figure below. This may also bring some memories to Math classes, right?", "So, in our example, Manhattan distance will be calculated as follows: Get the difference in the (\u0394x = x2-x1) and the difference in the y-axis (\u0394y = y2-y1). Then, get their absolute number, |\u0394x| and finally, sum up both values.", "Manhattan distance metric is also called L1 distance or L1 norm. If you are familiar with machine learning regularization, you probably heard this before.", "It is advisable to use it when dealing with high dimensional data. Also, if you are calculating errors, it is useful when you want to emphasis on outliers due to its linear nature.", "3Minkowski distance: First of all, we will define some mathematical terms in order to define Minkowski distance afterward.", "What does this have to do with Minkowski distance?", "Minkowski distance is defined as the similarity metric between two points in the normed vector space (N-dimensional real space).", "It represents also a generalized metric that includes Euclidean and Manhattan distance.", "How does the formula look like?", "If we pay attention when \u03bb = 1, we have the Manhattan distance. If \u03bb = 2, we are in the presence of Euclidean distance. There is another distance called Chebyshev distance that happens when \u03bb = \u221e.", "Overall, we can change the value of \u03bb to calculate the distance between two points in many ways.", "When do we use it? Minkowski distance is frequently used when the variables of interest are measured on ratio scales with an absolute zero value.", "4Mahalanobis Distance: When we need to calculate the distance of two points in multivariate space, we need to use the Mahalanobis distance.", "We talked before about the Cartesian coordinate system. We drew perpendicular lines. Then we calculated distances according to that axis-system.", "This is very easy to do if our variables are not correlated. Because the distances can be measured with a straight line.", "Let\u2019s say that two or more correlated variables are present. We will also add that we are working with more than 3 dimensions. Now, the problem gets complicated.", "In those cases, Mahalanobis distance comes to rescue us. It measures distance relative to the centroid for the multivariate data. In this point, means from all variables intersect.", "Its formula is the following one:", "where Xa and Xb are a pair of objects and C is the sample covariance matrix.", "5Cosine similarity: Let\u2019s imagine that you need to determine how similar two documents or corpus of text are. Which distance metrics will you use?", "In order to calculate it, we need to measure the cosine of the angle between two vectors. Then, cosine similarity returns the normalized dot product of them.", "A normalized vector is a vector in the same direction but with norm 1.", "The dot product is the operation in which two equal-length vectors are multiplied resulting in a single scalar.", "So, the formula for the cosine similarity is:", "where A and B are vectors, \u2225 A\u2225 and \u2225 B\u2225 are the norm of A and B, and cos\u03b8 is the cosine of the angle between A and B. This can also be written in other terms:", "Cosine similarity is very useful when we are interested in the orientation but not the magnitude of the vectors.", "Two vectors with the same orientation have a cosine similarity of 1. Two vectors at 90\u00b0 have a similarity of 0. Two vectors diametrically opposed have a similarity of -1. All independent of their magnitude.", "6Jaccard distance: Lastly, we will change our focus of attention. Instead of calculating distances between vectors, we will work with sets.", "A set is an unordered collection of objects. So for example, {1, 2, 3, 4} is equal to {2, 4, 3, 1}. We can calculate its cardinality (represented as |set|) which is no other thing than the number of elements contained in the set.", "Let\u2019s say we have two sets of objects, A and B. We wonder how many elements they have in common. This is called Intersection. It is represented mathematically as A \u2229 B.", "Maybe, we want to get all items regardless of the set they belong to. This is called Union. It is represented mathematically as A \u222a B.", "We can picture this better using Venn Diagrams.", "How does this relate to Jaccard similarity? Jaccard similarity is defined as the cardinality of the intersection of defined sets divided by the cardinality of the union of them. It can only be applied to finite sample sets.", "As we stated before, all of these metrics are used in several machine learning algorithms.", "A clear example is clustering algorithms, such as k-means, where we need to determine if two data points are similar. You can read my post about clustering to learn more about that.", "The take-home message is that several distance metrics exist. Each of them has a particular context in which they are more suitable. Learning to choose the correct one will improve the outcome of your machine learning algorithm.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F13a396aa34ce&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-measure-distances-in-machine-learning-13a396aa34ce&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-measure-distances-in-machine-learning-13a396aa34ce&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-measure-distances-in-machine-learning-13a396aa34ce&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-measure-distances-in-machine-learning-13a396aa34ce&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----13a396aa34ce--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----13a396aa34ce--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://eugeniainzaugarat.medium.com/?source=post_page-----13a396aa34ce--------------------------------", "anchor_text": ""}, {"url": "https://eugeniainzaugarat.medium.com/?source=post_page-----13a396aa34ce--------------------------------", "anchor_text": "Euge Inzaugarat"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F5515433d5913&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-measure-distances-in-machine-learning-13a396aa34ce&user=Euge+Inzaugarat&userId=5515433d5913&source=post_page-5515433d5913----13a396aa34ce---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F13a396aa34ce&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-measure-distances-in-machine-learning-13a396aa34ce&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F13a396aa34ce&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-measure-distances-in-machine-learning-13a396aa34ce&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@d0cz?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Bruno Wolff"}, {"url": "https://unsplash.com/?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://towardsdatascience.com/using-machine-learning-to-understand-customers-behavior-f41b567d3a50?source=friends_link&sk=191804653e3bc41f52a4fa339ec4931a", "anchor_text": "clustering"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----13a396aa34ce---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----13a396aa34ce---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/education?source=post_page-----13a396aa34ce---------------education-----------------", "anchor_text": "Education"}, {"url": "https://medium.com/tag/tech?source=post_page-----13a396aa34ce---------------tech-----------------", "anchor_text": "Tech"}, {"url": "https://medium.com/tag/algorithms?source=post_page-----13a396aa34ce---------------algorithms-----------------", "anchor_text": "Algorithms"}, {"url": "https://creativecommons.org/licenses/by-sa/4.0/", "anchor_text": "Some rights reserved"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F13a396aa34ce&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-measure-distances-in-machine-learning-13a396aa34ce&user=Euge+Inzaugarat&userId=5515433d5913&source=-----13a396aa34ce---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F13a396aa34ce&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-measure-distances-in-machine-learning-13a396aa34ce&user=Euge+Inzaugarat&userId=5515433d5913&source=-----13a396aa34ce---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F13a396aa34ce&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-measure-distances-in-machine-learning-13a396aa34ce&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----13a396aa34ce--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F13a396aa34ce&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-measure-distances-in-machine-learning-13a396aa34ce&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----13a396aa34ce---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----13a396aa34ce--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----13a396aa34ce--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----13a396aa34ce--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----13a396aa34ce--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----13a396aa34ce--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----13a396aa34ce--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----13a396aa34ce--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----13a396aa34ce--------------------------------", "anchor_text": ""}, {"url": "https://eugeniainzaugarat.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://eugeniainzaugarat.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Euge Inzaugarat"}, {"url": "https://eugeniainzaugarat.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "640 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F5515433d5913&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-measure-distances-in-machine-learning-13a396aa34ce&user=Euge+Inzaugarat&userId=5515433d5913&source=post_page-5515433d5913--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F1ad8e6e46454&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-measure-distances-in-machine-learning-13a396aa34ce&newsletterV3=5515433d5913&newsletterV3Id=1ad8e6e46454&user=Euge+Inzaugarat&userId=5515433d5913&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}