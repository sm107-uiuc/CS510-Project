{"url": "https://towardsdatascience.com/interactive-power-bi-custom-visuals-with-r-a6a4ac998710", "time": 1683008471.058552, "path": "towardsdatascience.com/interactive-power-bi-custom-visuals-with-r-a6a4ac998710/", "webpage": {"metadata": {"title": "Interactive Power BI Custom Visuals with R | by Freddie Tasker | Towards Data Science", "h1": "Interactive Power BI Custom Visuals with R", "description": "How to create your own Power BI visuals using ggplot and plotly in R, and some of the issues you might encounter."}, "outgoing_paragraph_urls": [{"url": "https://appsource.microsoft.com/en-GB/marketplace/apps?product=power-bi-visuals", "anchor_text": "Microsoft\u2019s AppSource", "paragraph_index": 3}, {"url": "https://github.com/fredwise/PM_timeline/blob/master/pm_timeline_ggplot.R", "anchor_text": "Code here", "paragraph_index": 4}, {"url": "https://benalexkeen.com/creating-a-timeline-graphic-using-r-and-ggplot2/", "anchor_text": "Ben Alex Keen,", "paragraph_index": 4}, {"url": "https://github.com/fredwise/PM_timeline/blob/master/pm_timeline_ggplot_powerbi.R", "anchor_text": "is here", "paragraph_index": 5}, {"url": "https://plotly.com/r/", "anchor_text": "plotly package", "paragraph_index": 7}, {"url": "https://plotly-r.com/improving-ggplotly.html", "anchor_text": "As well as a host of other plotly feature", "paragraph_index": 9}, {"url": "https://github.com/fredwise/PM_timeline/blob/master/fredTimelineVis/script.r", "anchor_text": "script.R", "paragraph_index": 20}, {"url": "https://github.com/microsoft/PowerBI-visuals/blob/master/RVisualTutorial/CreateRHTML.md", "anchor_text": "Microsoft help page for R HTML", "paragraph_index": 24}, {"url": "https://app.powerbi.com/view?r=eyJrIjoiOWEyYjJlYTYtNWQwNi00NGU1LTliNDEtODg2YzhhODQxYzY3IiwidCI6IjMyZTk3MjNkLWY2YjMtNDE5NS05MjlhLTkyZGFkMzIwNmRiMiJ9", "anchor_text": "on the Power BI service", "paragraph_index": 27}, {"url": "https://github.com/fredwise/PM_timeline", "anchor_text": "GitHub.", "paragraph_index": 27}], "all_paragraphs": ["Sometimes the right Power BI visual just isn\u2019t there. Trying to create an executive summary of project management data\u00a0recently\u00a0I\u00a0hit\u00a0just\u00a0this\u00a0wall.", "The idea was a report page that would be a front page to users - a quick signpost before they got into the detail of the other report pages, and something that would easily translate to a slide in a presentation. Attempts at slimmed down Gantt charts were all messy and unwieldly.", "After a bit of hard thought (playing) a basic horizontal timeline seemed to work well. It would focus on the project milestones, use colour to describe the project status and try its best to get the project related text as readable as possible.", "There didn\u2019t seem to be a ready made visual in Microsoft\u2019s AppSource that would do this, so turned to the R Script Visual. With a bit of R knowledge, these are quick to develop and allow the use of the endlessly customisable ggplot to get it looking exactly how you want it (n.b. other R plotting packages are available).", "Here\u2019s how it ended up. Project data has been replaced with the UK\u2019s prime ministers and the project status colour now tells us what party they\u2019re in. It might be handy in your next Zoom quiz. Code here. Thank you to Ben Alex Keen, who has a great article on the construction of this kind of timeline in R.", "The R visual dropped into the report as expected. Moving from accessing the JSON data directly in R to dealing with the data from the Power BI R Script Visual needed some variable renaming and formatting .The Power BI friendly code for the visual is here.", "The only thing these R plots are missing is a bit of interactivity. You can restrict the data going into them with Power BI\u2019s slicers and filters but you can\u2019t hover over and get a tooltip, or zoom in on an interesting bit.", "Thanks to the plotly package , we can turn our ggplot object into some html and add at least some of this interactivity.", "Plotly will also host these charts, and you can push them up from within R.", "As well as a host of other plotly features, we now have a hover over tooltip. Really useful in providing some more information in this fairly compact graph. This was defined using a dummy aesthetic in the geom_text call, named \u2018text\u2019 (ggplot ignores this aesthetic).", "A quick side note on using ggplotly for this task.", "geom_label: In our conversion to plotly from ggplot using ggplotly, geom_label isn\u2019t supported, so the transparent rectangles behind each text label have been replaced with font coloring.", "Legend naming: There was also some strange behaviour with the legend, \u2018Whig\u2019 became \u2018(Whig,1)\u2019 etc. This was caused by the ggplot object having both a colour scale (for text and points) and a fill scale (not used, since no geom_label). The manual fill scale was removed, but it would be annoying if a fill scale was needed. The only solution seemed to be manually adjusting the plotly object json.", "The final step is getting this plotly object into Power BI.", "We can\u2019t just paste our R code directly into the R Script Visual. The ggplotly function outputs an HTML object and Power BI is expecting an R plot object.", "Well it turns out that with not too much work, we can create our own custom visual to import into Power BI. Here\u2019s a quick step by step.", "2 - Install the powerbi-visuals-tools package with Powershell", "3 - Create an rhtml template", "4 - Find the folder and files that this command creates (this depends on the working directory of your Powershell). Then find the script.r file, and replace the ggplot code with your own", "On my computer the rhtml files were output to C:/Users/FredTasker/fredTimelineVis. The script.R has an example ggplot chunk, and a ggplotly line, which I replaced with those above.", "Here\u2019s the script.R file used in this example.", "5 - Add author, description and support URL to the pbiviz.json", "This is important, as package compiling will fail if you don\u2019t. pbviz.json will be in the same directory as your scripts.R file.", "6 -Go back to PowerShell, navigate to your script.r directory and package it all up, ready for Power BI to consume.", "If you run into issues,here\u2019s the Microsoft help page for R HTML.", "Now that the custom visual is packaged, we just need to import it into Power BI and drop our data fields into the visual.", "Well this was all very exciting. A really quick way to build interactive custom visuals in Power BI.", "Have a look at the resulting dashboard on the Power BI service, you\u2019ll see that Power BI\u2019s Publish to Web doesn\u2019t currently support the static R visual. To see the static graph in the PBIX file and all other scripts mentioned here head to GitHub.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "An analyst, I work mainly in Azure creating data products for logistics and aviation companies. I also like building stuff in R."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fa6a4ac998710&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finteractive-power-bi-custom-visuals-with-r-a6a4ac998710&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finteractive-power-bi-custom-visuals-with-r-a6a4ac998710&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finteractive-power-bi-custom-visuals-with-r-a6a4ac998710&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finteractive-power-bi-custom-visuals-with-r-a6a4ac998710&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----a6a4ac998710--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----a6a4ac998710--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://fredtasker.medium.com/?source=post_page-----a6a4ac998710--------------------------------", "anchor_text": ""}, {"url": "https://fredtasker.medium.com/?source=post_page-----a6a4ac998710--------------------------------", "anchor_text": "Freddie Tasker"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fe171f5380924&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finteractive-power-bi-custom-visuals-with-r-a6a4ac998710&user=Freddie+Tasker&userId=e171f5380924&source=post_page-e171f5380924----a6a4ac998710---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa6a4ac998710&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finteractive-power-bi-custom-visuals-with-r-a6a4ac998710&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa6a4ac998710&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finteractive-power-bi-custom-visuals-with-r-a6a4ac998710&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://www.thelancet.com/journals/lancet/article/PIIS0140-6736(03)15259-2/fulltext", "anchor_text": "Molecular epidemiology of the novel coronavirus that causes severe acute respiratory syndrome (The Lancet)"}, {"url": "https://appsource.microsoft.com/en-GB/marketplace/apps?product=power-bi-visuals", "anchor_text": "Microsoft\u2019s AppSource"}, {"url": "https://github.com/fredwise/PM_timeline/blob/master/pm_timeline_ggplot.R", "anchor_text": "Code here"}, {"url": "https://benalexkeen.com/creating-a-timeline-graphic-using-r-and-ggplot2/", "anchor_text": "Ben Alex Keen,"}, {"url": "https://github.com/fredwise/PM_timeline/blob/master/pm_timeline_ggplot_powerbi.R", "anchor_text": "is here"}, {"url": "https://plotly.com/r/", "anchor_text": "plotly package"}, {"url": "https://chart-studio.plotly.com/~fred_tasker/7.embed", "anchor_text": "Whig, Tory, Conservative, Peelite, Liberal, Labour, Whig, Tory, Conservative, Peelite, Liberal\u2026Fred_tasker's interactive graph and data of \"Whig, Tory, Conservative, Peelite, Liberal, Labour, Whig, Tory\u2026chart-studio.plotly.com"}, {"url": "https://plotly-r.com/improving-ggplotly.html", "anchor_text": "As well as a host of other plotly feature"}, {"url": "https://nodejs.org/en/", "anchor_text": "Install node.js"}, {"url": "https://docs.microsoft.com/en-us/power-bi/connect-data/service-r-packages-support", "anchor_text": "need to exist in Power BI online"}, {"url": "https://github.com/fredwise/PM_timeline/blob/master/fredTimelineVis/script.r", "anchor_text": "script.R"}, {"url": "https://medium.com/@fredtasker/interactive-power-bi-custom-visuals-with-r-a6a4ac998710", "anchor_text": "https://medium.com/@fredtasker/interactive-power-bi-custom-visuals-with-r-a6a4ac998710"}, {"url": "https://github.com/fredwise/PM_timeline", "anchor_text": "https://github.com/fredwise/PM_timeline"}, {"url": "https://github.com/microsoft/PowerBI-visuals/blob/master/RVisualTutorial/CreateRHTML.md", "anchor_text": "Microsoft help page for R HTML"}, {"url": "https://app.powerbi.com/view?r=eyJrIjoiOWEyYjJlYTYtNWQwNi00NGU1LTliNDEtODg2YzhhODQxYzY3IiwidCI6IjMyZTk3MjNkLWY2YjMtNDE5NS05MjlhLTkyZGFkMzIwNmRiMiJ9", "anchor_text": "on the Power BI service"}, {"url": "https://github.com/fredwise/PM_timeline", "anchor_text": "GitHub."}, {"url": "https://www.wisetechltd.com/", "anchor_text": "https://www.wisetechltd.com/"}, {"url": "https://medium.com/tag/r?source=post_page-----a6a4ac998710---------------r-----------------", "anchor_text": "R"}, {"url": "https://medium.com/tag/power-bi?source=post_page-----a6a4ac998710---------------power_bi-----------------", "anchor_text": "Power Bi"}, {"url": "https://medium.com/tag/plotly?source=post_page-----a6a4ac998710---------------plotly-----------------", "anchor_text": "Plotly"}, {"url": "https://medium.com/tag/ggplot?source=post_page-----a6a4ac998710---------------ggplot-----------------", "anchor_text": "Ggplot"}, {"url": "https://medium.com/tag/towards-data-science?source=post_page-----a6a4ac998710---------------towards_data_science-----------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fa6a4ac998710&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finteractive-power-bi-custom-visuals-with-r-a6a4ac998710&user=Freddie+Tasker&userId=e171f5380924&source=-----a6a4ac998710---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fa6a4ac998710&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finteractive-power-bi-custom-visuals-with-r-a6a4ac998710&user=Freddie+Tasker&userId=e171f5380924&source=-----a6a4ac998710---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa6a4ac998710&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finteractive-power-bi-custom-visuals-with-r-a6a4ac998710&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----a6a4ac998710--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fa6a4ac998710&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finteractive-power-bi-custom-visuals-with-r-a6a4ac998710&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----a6a4ac998710---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----a6a4ac998710--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----a6a4ac998710--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----a6a4ac998710--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----a6a4ac998710--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----a6a4ac998710--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----a6a4ac998710--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----a6a4ac998710--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----a6a4ac998710--------------------------------", "anchor_text": ""}, {"url": "https://fredtasker.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://fredtasker.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Freddie Tasker"}, {"url": "https://fredtasker.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "41 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fe171f5380924&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finteractive-power-bi-custom-visuals-with-r-a6a4ac998710&user=Freddie+Tasker&userId=e171f5380924&source=post_page-e171f5380924--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fusers%2Fe171f5380924%2Flazily-enable-writer-subscription&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finteractive-power-bi-custom-visuals-with-r-a6a4ac998710&user=Freddie+Tasker&userId=e171f5380924&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}