{"url": "https://towardsdatascience.com/fine-tuning-pre-trained-model-vgg-16-1277268c537f", "time": 1683016236.6309981, "path": "towardsdatascience.com/fine-tuning-pre-trained-model-vgg-16-1277268c537f/", "webpage": {"metadata": {"title": "Fine-Tuning Pre-trained Model VGG-16 | by Muriel Kosaka | Towards Data Science", "h1": "Fine-Tuning Pre-trained Model VGG-16", "description": "In my previous article, I explored using the pre-trained model VGG-16 as a feature extractor for transfer learning on the RAVDESS Audio Dataset. As a newcomer to Data Science, I read through articles\u2026"}, "outgoing_paragraph_urls": [{"url": "https://medium.com/r?url=https%3A%2F%2Ftowardsdatascience.com%2Ftransfer-learning-in-speech-emotion-recognition-d55b6616ba83", "anchor_text": "previous article", "paragraph_index": 0}, {"url": "https://towardsdatascience.com/transfer-learning-from-pre-trained-models-f2393f124751", "anchor_text": "article", "paragraph_index": 0}, {"url": "https://towardsdatascience.com/transfer-learning-in-speech-emotion-recognition-d55b6616ba83", "anchor_text": "here", "paragraph_index": 1}], "all_paragraphs": ["In my previous article, I explored using the pre-trained model VGG-16 as a feature extractor for transfer learning on the RAVDESS Audio Dataset. As a newcomer to Data Science, I read through articles here on Medium and came across this handy article by Pedro Marcelino in which he describes the process of transfer learning, but most insightful was the three strategies in which one can fine-tune their selected pre-trained model. Pedro Marcelino also provides a helpful Size Similarity Matrix to help determine which strategy to use. After reading his article, I\u2019ve come to realize that rather than using pre-trained models as feature extractors, I should be fine-tuning the model by training some layers and leaving other layers frozen as my dataset is small (1,440 files) and not similar to the VGG-16 model dataset. Here I will explore this type of fine-tuning of the VGG-16 pre-trained model on the RAVDESS Audio Dataset and determine its effect on model accuracy.", "After importing the necessary libraries, our train/test set, and preprocessing the data (described here), we dive into modeling:", "2. Next, we set some layers frozen, I decided to unfreeze the last block so that their weights get updated in each epoch", "Perfect, so we will be training our dataset on the last four layers of the pre-trained VGG-16 model.", "3) I used the same model architecture from my previous VGG-16 model as a feature extractor:", "4) Let\u2019s set some callbacks, such as ReduceLROnPlateau and ModelCheckpoint. ReduceLROnPlateau is helpful especially in fine-tuning our model because as described by Pedro Marcelino, high learning rates increase the risk of losing previous knowledge so it is best to set a low learning rate, and with ReduceLROnPlateau, this can help us out with that! ModelCheckpoint is always helpful since it allows us to define where to checkpoint our model weights.", "4) Next, we compile and fit our model", "As we can see the model is largely overfitting to the training data. After 50 epochs, our model achieved an accuracy of 78% which is 9% higher than our previous classifier, where we used the pre-trained VGG-16 model used as a feature extractor, but performed the same as our pre-trained VGG-16 model used as a feature extractor with image augmentation.", "Now let's try fine-tuning VGG-16 model with image augmentation to see if that will improve model accuracy. Using the same VGG-16 model object stored in the transfer_model variable from our previous model and unfreeze the fifth convolution block while keeping the first four blocks frozen.", "Great, so the fifth convolution block is now trainable and we\u2019ve added our own classifier. Now, we will augment our images using ImageDataGenerator of Keras\u2019 image preprocessing module, fit it to our training set, compile the model, then fit the model.", "After 100 epochs, we achieved an accuracy score of 70%, that is an 8% decrease from our previous model and performed the same as our VGG-16 model as a feature extractor (*insert huge sad face here*).", "As can be clearly seen, the model is overfitting to the training data and accuracy seems to plateau after about 40 epochs. With fine-tuning, I did not see much improvement in model accuracy over using the pre-trained model as a feature extractor which I did not expect as per the dissimilarity and smaller dataset I am using compared to the VGG-16 model.", "I have tried to adjust the parameters of the ImageDataGenerator class and was unsuccessful in improving model accuracy. If anyone has any suggestions as to how/if my VGG-19 model fine-tuned with image augmentation can improve, please let me know! Thank you for reading :)", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F1277268c537f&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffine-tuning-pre-trained-model-vgg-16-1277268c537f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffine-tuning-pre-trained-model-vgg-16-1277268c537f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffine-tuning-pre-trained-model-vgg-16-1277268c537f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffine-tuning-pre-trained-model-vgg-16-1277268c537f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----1277268c537f--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----1277268c537f--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://murielsayaka.medium.com/?source=post_page-----1277268c537f--------------------------------", "anchor_text": ""}, {"url": "https://murielsayaka.medium.com/?source=post_page-----1277268c537f--------------------------------", "anchor_text": "Muriel Kosaka"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fc023cd66d94b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffine-tuning-pre-trained-model-vgg-16-1277268c537f&user=Muriel+Kosaka&userId=c023cd66d94b&source=post_page-c023cd66d94b----1277268c537f---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F1277268c537f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffine-tuning-pre-trained-model-vgg-16-1277268c537f&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F1277268c537f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffine-tuning-pre-trained-model-vgg-16-1277268c537f&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@ikukevk", "anchor_text": "Kevin Ku"}, {"url": "https://unsplash.com/", "anchor_text": "Unsplash"}, {"url": "https://medium.com/r?url=https%3A%2F%2Ftowardsdatascience.com%2Ftransfer-learning-in-speech-emotion-recognition-d55b6616ba83", "anchor_text": "previous article"}, {"url": "https://towardsdatascience.com/transfer-learning-from-pre-trained-models-f2393f124751", "anchor_text": "article"}, {"url": "https://towardsdatascience.com/transfer-learning-in-speech-emotion-recognition-d55b6616ba83", "anchor_text": "here"}, {"url": "https://medium.com/tag/transfer-learning?source=post_page-----1277268c537f---------------transfer_learning-----------------", "anchor_text": "Transfer Learning"}, {"url": "https://medium.com/tag/emotion-recognition?source=post_page-----1277268c537f---------------emotion_recognition-----------------", "anchor_text": "Emotion Recognition"}, {"url": "https://medium.com/tag/keras?source=post_page-----1277268c537f---------------keras-----------------", "anchor_text": "Keras"}, {"url": "https://medium.com/tag/python?source=post_page-----1277268c537f---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----1277268c537f---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F1277268c537f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffine-tuning-pre-trained-model-vgg-16-1277268c537f&user=Muriel+Kosaka&userId=c023cd66d94b&source=-----1277268c537f---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F1277268c537f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffine-tuning-pre-trained-model-vgg-16-1277268c537f&user=Muriel+Kosaka&userId=c023cd66d94b&source=-----1277268c537f---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F1277268c537f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffine-tuning-pre-trained-model-vgg-16-1277268c537f&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----1277268c537f--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F1277268c537f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffine-tuning-pre-trained-model-vgg-16-1277268c537f&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----1277268c537f---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----1277268c537f--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----1277268c537f--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----1277268c537f--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----1277268c537f--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----1277268c537f--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----1277268c537f--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----1277268c537f--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----1277268c537f--------------------------------", "anchor_text": ""}, {"url": "https://murielsayaka.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://murielsayaka.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Muriel Kosaka"}, {"url": "https://murielsayaka.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "207 Followers"}, {"url": "https://www.linkedin.com/in/muriel-kosaka-ab9003a5/", "anchor_text": "https://www.linkedin.com/in/muriel-kosaka-ab9003a5/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fc023cd66d94b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffine-tuning-pre-trained-model-vgg-16-1277268c537f&user=Muriel+Kosaka&userId=c023cd66d94b&source=post_page-c023cd66d94b--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F892a68672a65&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffine-tuning-pre-trained-model-vgg-16-1277268c537f&newsletterV3=c023cd66d94b&newsletterV3Id=892a68672a65&user=Muriel+Kosaka&userId=c023cd66d94b&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}