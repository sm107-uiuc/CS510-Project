{"url": "https://towardsdatascience.com/how-to-build-a-movie-recommendation-system-67e321339109", "time": 1683014556.753241, "path": "towardsdatascience.com/how-to-build-a-movie-recommendation-system-67e321339109/", "webpage": {"metadata": {"title": "How to Build a Movie Recommendation System | by Ramya Vidiyala | Towards Data Science", "h1": "How to Build a Movie Recommendation System", "description": "Have you ever wondered how YouTube recommends content, or how Facebook recommends you, new friends? Perhaps you\u2019ve noticed similar recommendations with LinkedIn connections, or how Amazon will\u2026"}, "outgoing_paragraph_urls": [{"url": "https://grouplens.org/datasets/movielens/", "anchor_text": "MovieLens dataset", "paragraph_index": 14}, {"url": "https://datajobs.com/data-science-repo/Recommender-Systems-[Netflix].pdf", "anchor_text": "Matrix factorization", "paragraph_index": 24}, {"url": "https://netflixprize.com/index.html", "anchor_text": "Netflix prize challenge", "paragraph_index": 24}, {"url": "https://xgboost.readthedocs.io/en/latest/", "anchor_text": "XGBoost", "paragraph_index": 46}, {"url": "https://grouplens.org/datasets/movielens/", "anchor_text": "GroupLens", "paragraph_index": 55}, {"url": "https://github.com/RamyaVidiyala/MovieRecommenderSystem", "anchor_text": "Github", "paragraph_index": 55}, {"url": "https://lionbridge.ai/articles/step-by-step-guide-to-building-a-movie-recommendation-system/", "anchor_text": "here", "paragraph_index": 56}, {"url": "https://medium.com/@ramyavidiyala", "anchor_text": "Medium", "paragraph_index": 56}, {"url": "https://twitter.com/ramya_vidiyala", "anchor_text": "ramya_vidiyala", "paragraph_index": 56}, {"url": "https://www.linkedin.com/in/ramya-vidiyala-308ba6139/", "anchor_text": "RamyaVidiyala", "paragraph_index": 56}, {"url": "https://www.linkedin.com/in/ramya-vidiyala/", "anchor_text": "https://www.linkedin.com/in/ramya-vidiyala/", "paragraph_index": 58}], "all_paragraphs": ["Have you ever wondered how YouTube recommends content, or how Facebook recommends you, new friends? Perhaps you\u2019ve noticed similar recommendations with LinkedIn connections, or how Amazon will recommend similar products while you\u2019re browsing. All of these recommendations are made possible by the implementation of recommender systems.", "Recommender systems encompass a class of techniques and algorithms that can suggest \u201crelevant\u201d items to users. They predict future behavior based on past data through a multitude of techniques including matrix factorization.", "In this article, I\u2019ll look at why we need recommender systems and the different types of users online. Then, I\u2019ll show you how to build your own movie recommendation system using an open-source dataset.", "We now live in what some call the \u201cera of abundance\u201d. For any given product, there are sometimes thousands of options to choose from. Think of the examples above: streaming videos, social networking, online shopping; the list goes on. Recommender systems help to personalize a platform and help the user find something they like.", "The easiest and simplest way to do this is to recommend the most popular items. However, to really enhance the user experience through personalized recommendations, we need dedicated recommender systems.", "From a business standpoint, the more relevant products a user finds on the platform, the higher their engagement. This often results in increased revenue for the platform itself. Various sources say that as much as 35\u201340% of tech giants\u2019 revenue comes from recommendations alone.", "Now that we understand the importance of recommender systems, let\u2019s have a look at types of recommendation systems, then build our own with open-sourced data!", "Machine learning algorithms in recommender systems typically fit into two categories: content-based systems and collaborative filtering systems. Modern recommender systems combine both approaches.", "Let\u2019s have a look at how they work using movie recommendation systems as a base.", "Content-based methods are based on the similarity of movie attributes. Using this type of recommender system, if a user watches one movie, similar movies are recommended. For example, if a user watches a comedy movie starring Adam Sandler, the system will recommend them movies in the same genre or starring the same actor, or both. With this in mind, the input for building a content-based recommender system is movie attributes.", "With collaborative filtering, the system is based on past interactions between users and movies. With this in mind, the input for a collaborative filtering system is made up of past data of user interactions with the movies they watch.", "For example, if user A watches M1, M2, and M3, and user B watches M1, M3, M4, we recommend M1 and M3 to a similar user C. You can see how this looks in the figure below for clearer reference.", "This data is stored in a matrix called the user-movie interactions matrix, where the rows are the users and the columns are the movies.", "Now, let\u2019s implement our own movie recommendation system using the concepts discussed above.", "For our own system, we\u2019ll use the open-source MovieLens dataset from GroupLens. This dataset contains 100K data points of various movies and users.", "We will use three columns from the data:", "You can see a snapshot of the data in figure 3, below:", "To obtain recommendations for our users, we will predict their ratings for movies they haven\u2019t watched yet. Movies are then indexed and suggested to users based on these predicted ratings.", "To do this, we will use past records of movies and user ratings to predict their future ratings. At this point, it\u2019s worth mentioning that in the real world, we will likely encounter new users or movies without a history. Such situations are called cold start problems.", "Let\u2019s take a brief look at how cold start problems can be addressed.", "Cold start problems can be handled by recommendations based on meta-information, such as:", "For our recommender system, we\u2019ll use both of the techniques mentioned above: content-based and collaborative filtering. To find the similarity between movies for our content based method, we\u2019ll use a cosine similarity function. For our collaborative filtering method, we\u2019ll use a matrix factorization technique.", "The first step towards this is creating a matrix factorization based model. We\u2019ll use the output of this model and a few handcrafted features to provide inputs to the final model. The basic process will look like this:", "We\u2019ll look at these steps in greater detail below.", "Matrix factorization is a class of collaborative filtering algorithms used in recommender systems. This family of methods became widely known during the Netflix prize challenge due to how effective it was.", "Matrix factorization algorithms work by decomposing the user-movie interaction matrix into the product of two lower dimensionality rectangular matrices, say U and M. The decomposition is done in such a way that the product results in almost similar values to the user-movie interaction matrix. Here, U represents the user matrix, M represents the movie matrix, n is the number of users, and m is the number of movies.", "Each row of the user matrix represents a user and each column of the movie matrix represents a movie.", "Once we obtain the U and M matrices, based on the non-empty cells in the user-movie interaction matrix, we perform the product of U and M and predict the values of non-empty cells in the user-movie interaction matrix.", "To implement matrix factorization, we use a simple Python library named Surprise, which is for building and testing recommender systems. The data frame is converted into a train set, a format of data set to be accepted by the Surprise library.", "Now the model is ready. We\u2019ll store these predictions to pass to the final model as an additional feature. This will help us incorporate collaborative filtering into our system.", "Note that we have to perform the above steps for test data also.", "Let\u2019s convert the data in the data frame format into a user-movie interaction matrix. Matrices used in this type of problem are generally sparse because there\u2019s a high chance users may only rate a few movies.", "The advantages of the sparse matrix format of data, also called CSR format, are as follows:", "scipy.sparse.csr_matrix is a utility function that efficiently converts the data frame into a sparse matrix.", "\u2018train_sparse_matrix\u2019 is the sparse matrix representation of the train_data data frame.", "We\u2019ll create 3 sets of features using this sparse matrix:", "Let\u2019s take a look at how to prepare each in more detail.", "The three global averages we\u2019ll employ are:", "The average rating is given by a user:", "Average ratings are given for a movie:", "In this set of features, we will create the top 5 similar users who rated a particular movie. The similarity is calculated using the cosine similarity between the users.", "In this set of features, we obtain the top 5 similar movies rated by a particular user. This similarity is calculated using the cosine similarity between the movies.", "We append all these features for each movie-user pair and create a data frame. Figure 5 is a snapshot of our data frame.", "Here\u2019s a more detailed breakdown of its contents:", "Once we have these 13 features ready, we\u2019ll add the Matrix Factorization output as the 14th feature. In Figure 6 you can see a snapshot of our data after adding the output from Step 1.", "The last column, named, mf_svd, is the additional column that contains the output of the model performed in Step 1.", "To create our final model, let\u2019s use XGBoost, an optimized distributed gradient boosting library.", "There are two main ways to evaluate a recommender system\u2019s performance: Root Mean Squared Error (RMSE) and Mean Absolute Percentage Error (MAPE). RMSE measures the squared loss, while MAPE measures the absolute loss. Lower values mean lower error rates and thus better performance.", "Both are good as they allow for easy interpretation. Let\u2019s take a look at what each of them is:", "RMSE is the square root of the average of squared errors and is given by the below formula.", "Where:r is the actual rating,r^ is the predicted ratings andN is the total number of predictions", "MAPE measures the error in percentage terms. It is given by the formula below:", "Where:r is the actual rating,r^ is the predicted ratings andN is the total number of predictions", "Our model resulted in 0.67 RMSE, and 19.86 MAPE on the unseen test data, which is a good-to-go model. An RMSE value of less than 2 is considered good, and a MAPE less than 25 is excellent. That said, this model can be further enhanced by adding features that would be recommended based on the top picks dependent on location or genre. We could also test the efficacy of our various models in real-time through A/B testing.", "In this article, we learned the importance of recommender systems, the types of recommender systems being implemented, and how to use matrix factorization to enhance a system. We then built a movie recommendation system that considers user-user similarity, movie-movie similarity, global averages, and matrix factorization. These concepts can be applied to any other user-item interactions systems.", "Thanks for reading! If you would like to experiment with this custom dataset yourself, you can download the annotated data on GroupLens and see my code at Github.", "Thanks for the read. This article is originally published here. I am going to write more beginner-friendly posts in the future too. Follow me up on Medium to be informed about them. I welcome feedback and can be reached out on Twitter ramya_vidiyala and LinkedIn RamyaVidiyala. Happy learning!", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Interested in computers and machine learning. Likes to write about it | https://www.linkedin.com/in/ramya-vidiyala/"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F67e321339109&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-build-a-movie-recommendation-system-67e321339109&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-build-a-movie-recommendation-system-67e321339109&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-build-a-movie-recommendation-system-67e321339109&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-build-a-movie-recommendation-system-67e321339109&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----67e321339109--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----67e321339109--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://ramyavidiyala.medium.com/?source=post_page-----67e321339109--------------------------------", "anchor_text": ""}, {"url": "https://ramyavidiyala.medium.com/?source=post_page-----67e321339109--------------------------------", "anchor_text": "Ramya Vidiyala"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F380da45435d3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-build-a-movie-recommendation-system-67e321339109&user=Ramya+Vidiyala&userId=380da45435d3&source=post_page-380da45435d3----67e321339109---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F67e321339109&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-build-a-movie-recommendation-system-67e321339109&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F67e321339109&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-build-a-movie-recommendation-system-67e321339109&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@imnoom?utm_source=medium&utm_medium=referral", "anchor_text": "Noom Peerapong"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://towardsdatascience.com/tagged/hands-on-tutorials", "anchor_text": "Hands-on Tutorials"}, {"url": "https://grouplens.org/datasets/movielens/", "anchor_text": "MovieLens dataset"}, {"url": "https://datajobs.com/data-science-repo/Recommender-Systems-[Netflix].pdf", "anchor_text": "Matrix factorization"}, {"url": "https://netflixprize.com/index.html", "anchor_text": "Netflix prize challenge"}, {"url": "https://xgboost.readthedocs.io/en/latest/", "anchor_text": "XGBoost"}, {"url": "https://grouplens.org/datasets/movielens/", "anchor_text": "GroupLens"}, {"url": "https://github.com/RamyaVidiyala/MovieRecommenderSystem", "anchor_text": "Github"}, {"url": "https://lionbridge.ai/articles/step-by-step-guide-to-building-a-movie-recommendation-system/", "anchor_text": "here"}, {"url": "https://medium.com/@ramyavidiyala", "anchor_text": "Medium"}, {"url": "https://twitter.com/ramya_vidiyala", "anchor_text": "ramya_vidiyala"}, {"url": "https://www.linkedin.com/in/ramya-vidiyala-308ba6139/", "anchor_text": "RamyaVidiyala"}, {"url": "https://medium.com/tag/data-science?source=post_page-----67e321339109---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----67e321339109---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----67e321339109---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/education?source=post_page-----67e321339109---------------education-----------------", "anchor_text": "Education"}, {"url": "https://medium.com/tag/hands-on-tutorials?source=post_page-----67e321339109---------------hands_on_tutorials-----------------", "anchor_text": "Hands On Tutorials"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F67e321339109&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-build-a-movie-recommendation-system-67e321339109&user=Ramya+Vidiyala&userId=380da45435d3&source=-----67e321339109---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F67e321339109&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-build-a-movie-recommendation-system-67e321339109&user=Ramya+Vidiyala&userId=380da45435d3&source=-----67e321339109---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F67e321339109&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-build-a-movie-recommendation-system-67e321339109&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----67e321339109--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F67e321339109&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-build-a-movie-recommendation-system-67e321339109&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----67e321339109---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----67e321339109--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----67e321339109--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----67e321339109--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----67e321339109--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----67e321339109--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----67e321339109--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----67e321339109--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----67e321339109--------------------------------", "anchor_text": ""}, {"url": "https://ramyavidiyala.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://ramyavidiyala.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Ramya Vidiyala"}, {"url": "https://ramyavidiyala.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "449 Followers"}, {"url": "https://www.linkedin.com/in/ramya-vidiyala/", "anchor_text": "https://www.linkedin.com/in/ramya-vidiyala/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F380da45435d3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-build-a-movie-recommendation-system-67e321339109&user=Ramya+Vidiyala&userId=380da45435d3&source=post_page-380da45435d3--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F51c63443de13&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-build-a-movie-recommendation-system-67e321339109&newsletterV3=380da45435d3&newsletterV3Id=51c63443de13&user=Ramya+Vidiyala&userId=380da45435d3&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}