{"url": "https://towardsdatascience.com/transform-grayscale-images-to-rgb-using-pythons-matplotlib-6a0625d992dd", "time": 1682994968.468224, "path": "towardsdatascience.com/transform-grayscale-images-to-rgb-using-pythons-matplotlib-6a0625d992dd/", "webpage": {"metadata": {"title": "Transform Grayscale Images to RGB Using Python\u2019s Matplotlib | by Matthew Arthur | Towards Data Science", "h1": "Transform Grayscale Images to RGB Using Python\u2019s Matplotlib", "description": "Data pre-processing is critical for computer vision applications, and properly converting grayscale images to the RGB format expected by current deep learning frameworks is an essential technique\u2026"}, "outgoing_paragraph_urls": [{"url": "http://www.github.com/matthewarthur", "anchor_text": "www.github.com/matthewarthur", "paragraph_index": 18}, {"url": "https://www.linkedin.com/in/matt-a-8208aaa/", "anchor_text": "https://www.linkedin.com/in/matt-a-8208aaa/", "paragraph_index": 18}], "all_paragraphs": ["Data pre-processing is critical for computer vision applications, and properly converting grayscale images to the RGB format expected by current deep learning frameworks is an essential technique. What does that mean?", "Most color photos are composed of three interlocked arrays, each responsible for either Red, Green, or Blue values (hence RGB) and the integer values within each array representing a single pixel-value. Meanwhile, black-and-white or grayscale photos have only a single channel, read from one array.", "Using the matplotlib library, let\u2019s look at a color (RGB) image:", "The output of the matplotlib.plot.shape call tells us that the image has height of 525 pixels, width of 1050 pixels, and there are three arrays (channels) of this size.", "The img object is <class \u2018numpy.ndarray\u2019>, so let\u2019s look at the shape and values of each layer:", "All right, what are the print commands above telling us about this image which is composed of 1050 columns (width) each with 525 rows (height)?", "First, we look at the value of the very last pixel, at the last row of the last column and the last channel: 198. This tell us that the file most likely uses values from 0 to 255.", "Next, we look at the values of this pixel across all three channels: [155, 177, 198]. These are the Red, Green & Blue values at that pixel.\u00b3", "And for fun we can look at the values of the last row across all layers and all rows.", "Grayscale images only have one channel! That\u2019s it!", "Quoting the Pytorch documentation:\u00b9 All pre-trained models expect input images normalized in the same way, i.e. mini-batches of 3-channel RGB images of shape (3 x H x W)...", "So trying to ingest your grayscale with many computer vision / deep learning pipelines relying on transfer learning from a standard commodity model such as Resnet18 or -34 will result in a variety of errors.", "Add two additional channels to a grayscale! There are a variety of ways to do this, so my way is below: copy the first layer into new layers of a new 3D array, thus generating a color image (of a black-and-white, so it\u2019ll still be B&W).", "I\u2019ll work with a square image from the Arabic Handwritten Digit Dataset as an example. The shape is (28, 28) which confirms it is a single-channel image.", "Since I want to feed this into a model based on Resnet34, I need three channels.", "The obvious (and less-than-correct) way is to add two arrays of zeros of the same size:", "O is our Original array. We can add two zero arrays of the same shape easily enough but we will get a red-dominated image:", "Whoops! We want to populate the same values across all channels. Before we do, though, let\u2019s see what happens if we roll our original array through each of the non-fully-RGB possibilities:", "Additional code is on my github: www.github.com/matthewarthur. My LinkedIn is https://www.linkedin.com/in/matt-a-8208aaa/. Say hi!", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Former NSA analyst working on compliance & security automation in the cloud. Background in applied mathematics, student of machine learning & neural nets."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F6a0625d992dd&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftransform-grayscale-images-to-rgb-using-pythons-matplotlib-6a0625d992dd&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftransform-grayscale-images-to-rgb-using-pythons-matplotlib-6a0625d992dd&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftransform-grayscale-images-to-rgb-using-pythons-matplotlib-6a0625d992dd&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftransform-grayscale-images-to-rgb-using-pythons-matplotlib-6a0625d992dd&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----6a0625d992dd--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----6a0625d992dd--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@matthewleearthur?source=post_page-----6a0625d992dd--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@matthewleearthur?source=post_page-----6a0625d992dd--------------------------------", "anchor_text": "Matthew Arthur"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fdeaf31292a21&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftransform-grayscale-images-to-rgb-using-pythons-matplotlib-6a0625d992dd&user=Matthew+Arthur&userId=deaf31292a21&source=post_page-deaf31292a21----6a0625d992dd---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F6a0625d992dd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftransform-grayscale-images-to-rgb-using-pythons-matplotlib-6a0625d992dd&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F6a0625d992dd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftransform-grayscale-images-to-rgb-using-pythons-matplotlib-6a0625d992dd&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "http://www.github.com/matthewarthur", "anchor_text": "www.github.com/matthewarthur"}, {"url": "https://www.linkedin.com/in/matt-a-8208aaa/", "anchor_text": "https://www.linkedin.com/in/matt-a-8208aaa/"}, {"url": "https://pytorch.org/docs/stable/torchvision/models.html", "anchor_text": "https://pytorch.org/docs/stable/torchvision/models.html"}, {"url": "https://www.cs.virginia.edu/~vicente/recognition/notebooks/image_processing_lab.html", "anchor_text": "https://www.cs.virginia.edu/~vicente/recognition/notebooks/image_processing_lab.html"}, {"url": "https://docs.scipy.org/doc/numpy-1.10.0/user/basics.indexing.html", "anchor_text": "https://docs.scipy.org/doc/numpy-1.10.0/user/basics.indexing.html"}, {"url": "https://medium.com/tag/computer-vision?source=post_page-----6a0625d992dd---------------computer_vision-----------------", "anchor_text": "Computer Vision"}, {"url": "https://medium.com/tag/matplotlib?source=post_page-----6a0625d992dd---------------matplotlib-----------------", "anchor_text": "Matplotlib"}, {"url": "https://medium.com/tag/python?source=post_page-----6a0625d992dd---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/pytorch?source=post_page-----6a0625d992dd---------------pytorch-----------------", "anchor_text": "Pytorch"}, {"url": "https://medium.com/tag/data?source=post_page-----6a0625d992dd---------------data-----------------", "anchor_text": "Data"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F6a0625d992dd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftransform-grayscale-images-to-rgb-using-pythons-matplotlib-6a0625d992dd&user=Matthew+Arthur&userId=deaf31292a21&source=-----6a0625d992dd---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F6a0625d992dd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftransform-grayscale-images-to-rgb-using-pythons-matplotlib-6a0625d992dd&user=Matthew+Arthur&userId=deaf31292a21&source=-----6a0625d992dd---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F6a0625d992dd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftransform-grayscale-images-to-rgb-using-pythons-matplotlib-6a0625d992dd&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----6a0625d992dd--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F6a0625d992dd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftransform-grayscale-images-to-rgb-using-pythons-matplotlib-6a0625d992dd&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----6a0625d992dd---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----6a0625d992dd--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----6a0625d992dd--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----6a0625d992dd--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----6a0625d992dd--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----6a0625d992dd--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----6a0625d992dd--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----6a0625d992dd--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----6a0625d992dd--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@matthewleearthur?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@matthewleearthur?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Matthew Arthur"}, {"url": "https://medium.com/@matthewleearthur/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "38 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fdeaf31292a21&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftransform-grayscale-images-to-rgb-using-pythons-matplotlib-6a0625d992dd&user=Matthew+Arthur&userId=deaf31292a21&source=post_page-deaf31292a21--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fusers%2Fdeaf31292a21%2Flazily-enable-writer-subscription&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftransform-grayscale-images-to-rgb-using-pythons-matplotlib-6a0625d992dd&user=Matthew+Arthur&userId=deaf31292a21&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}