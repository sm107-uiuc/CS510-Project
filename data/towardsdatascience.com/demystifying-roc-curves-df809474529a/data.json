{"url": "https://towardsdatascience.com/demystifying-roc-curves-df809474529a", "time": 1683002912.8727129, "path": "towardsdatascience.com/demystifying-roc-curves-df809474529a/", "webpage": {"metadata": {"title": "Demystifying ROC Curves. How to interpret and when to use\u2026 | by Ruchi Toshniwal | Towards Data Science", "h1": "Demystifying ROC Curves", "description": "ROC curves are important assistants in evaluating and fine-tuning classification models. But, to some of us, they can be really challenging to understand. I\u2019ll list down all the reasons these curves\u2026"}, "outgoing_paragraph_urls": [{"url": "https://medium.com/@ruchitoshniwal/how-to-select-performance-metrics-for-classification-models-c847fe6b1ea3", "anchor_text": "previous article", "paragraph_index": 0}], "all_paragraphs": ["ROC curves are important assistants in evaluating and fine-tuning classification models. But, to some of us, they can be really challenging to understand. I\u2019ll list down all the reasons these curves are hard to understand for beginners and break the mystery behind them one by one. If you have unsuccessfully attempted to interpret ROC Curves earlier this article will help you understand them finally.In case you aren\u2019t familiar with confusion matrix, sensitivity, specificity, true positive rate etc. please refer to my previous article.", "Reasons why ROC Curves seem a little complicated:", "1. Their intimidating name Receiver Operating Characteristic does not give any literal cue to its meaning", "2. The x-axis being 1-Specificity is a little disorienting when we try to visually inspect the curve.", "3. An ROC curve shows the performance of one classification model at all classification thresholds. It can be used to evaluate the strength of a model. ROC Curves can also be used to compare two models. It becomes confusing when we try to understand/apply all these concepts simultaneously.", "4. What exactly is a random model that the diagonal represents? Is it the worst possible model?", "Let us try to unravel each of these mysteries one by one to understand ROC curves.", "The ROC Curve was first used during World War II for the analysis of radar signals. After the attack on Pearl Harbor, the US army began new research to improve the rate of detection of Japanese aircraft from their radar signals. Needless to say, they did not want to miss any of them. Neither did they wish to waste their resources on false alarms. They measured the ability of a radar receiver operator to make these predictions called the Receiver Operating Characteristic. That is the origin of the name. The purpose of the curve was similar to how we use it to improve our machine learning models now. The aim was to analyse the predictive power of the predictor in ensuring the detection of as many true positives as possible while minimizing false positives.", "The ROC curve is a plot of True Positive Rate (TPR) on the y-axis vs False Positive Rate (FPR) on the x-axis.", "TPR = Sensitivity FPR = 1-Specificity", "It is better to understand ROC Curve in their original form, TPR Vs FPR. Once you understand them, making substitutions using above equations is easy.", "Why do we compare TPR and FPR?", "Say we have a binary classification model that predicts probability of observations belonging to Class YES and NO. We choose a probability threshold = 0.5. Observations with probability >= 0.5 belong to Class Yes and probability <0.5 belong to Class NO. We obtain the following confusion matrix.", "Notice in the figure below that TPR and FPR are derived from two separate rows of the confusion matrix. This ensures that the class distribution in the data (prevalence) does not affect the curve. The YESs and the NOs are being looked at separately.", "The True Positive Rate looks at the actual YESs and the False Positive Rate looks at the actual NOs.So, even though the ROC plot contains information about both classes (YES and NO), these groups don\u2019t interact. Each value, and therefore the curve itself, does not change even if the prevalence/distribution of classes in test data varies. (Do not confuse this with the distribution of classes in the train data which (might) affect the model strength. Here we are talking about having built the model and then evaluating it on the test data. The class distribution of test data does not affect the ROC curve.)", "We are going to discuss the ROC curve in further detail, but for now let\u2019s note that the x-axis in the ROC Curve is False Positive Rate. We can easily replace it with 1-Sensitivity, once we understand the curve and its purpose.", "a) Purpose 1 \u2014 Analysing the strength/predictive power of a classifier", "The job of our classification model is to assign higher probabilities to observations that belong to class YES and lower probabilities to observations that belong to class NO. Basically, if there is a substantial distinction in the probabilities assigned to observations of either class, we will be able to define a threshold and predict the two classes with high confidence.", "The ROC curve of a good classifier is closer to the top left of the graph. WHY? Because in a good classifier, we can achieve high TPR at low FPR (at optimal threshold. The FPR and TPR at different thresholds will be discussed in point b).", "The green curve shows the distribution of Class YES and the red curve shows distribution of Class NO over the probability assigned to each obs by the classifier. Using threshold 0.5 we are able to classify most observations correctly. There is a slight overlap of the distributions. The overlapping cases are the ones that get misclassified at 0.5. If we move the threshold to 0.6, we will be able to classify almost 85% true positives correctly and with 0 false positives. As we lower the threshold from 0.6 to 0.5, the TPR will increase but so will the FPR. (Note that in the ROC curve below we cannot see the thresholds.)", "We can use a color coded ROC curve like below to be able to see each threshold on the curve. The color bar on the right indicates the threshold value at each color.", "Remember we discussed how prevalence/class distribution does not affect ROC curves. The Classifier 1, discussed earlier, will separate classes in an in-balanced dataset as well as it does for the balanced dataset above. The ROC Curve for this classifier will still be the same.", "Even while classifying unbalanced datasets, the ROC Curve for our classifier remains the same.", "A poor classifier (like Classifier 2 below) will not able to distinguish the two classes well and therefore its ROC curve will be closer to the diagonal. Implying lower TPR rates (more false negatives) and higher FPR rates (more false positives). This leads us to the concept of AUC or Area Under the Curve discussed in point c.", "The Random model represented by the blue diagonal in the ROC curve is a random classifier that does not have any ability to distinguish between the two classes i.e. the predicted probabilities of the two classes overlap (Classifier 3).And therefore, TPR = FPR at any threshold.", "b) Purpose 2 \u2014 Determining optimal threshold", "We have a classification model that predicts the probability that an observation belongs to Class YES. This probability can range from 0 to 1. The default threshold of 0.5 that is used to determine the class of this observation is not always the best threshold. The ROC curve helps us find the threshold where the TPR is high and FPR is low i.e. misclassifications are low. Therefore, ROC curves should be used to determine the optimal probability threshold for a classification model.", "Moreover, in a lot of scenarios, the cost of false positives and false negatives is not the same. This is when ROC Curves are extremely useful.", "The ROC curve shows a trade-off between TPR and FPR (or false negatives and false positives). It plots TPR vs FPR at different thresholds. If we lower the classification threshold, we will classify more observations as positive, increasing True Positives. But this will cause even the false positives to increase. The performance of our system would vary as we change this threshold. It can be adjusted to tune the behavior of the model to reduce more of one or another type of error (FP/FN).", "1. In the above curve if you wanted a model with a very low false positive rate, you might pick 0.8 as your threshold of choice. If you favour a low FPR, but you don\u2019t want an abysmal TPR, you might go for 0.5, the point where the curve starts turning hard to the right.", "If you prefer a low false negative rate/high TPR, you might decide that somewhere between 0.2 and 0.1 is the region where you start getting severely diminishing returns for improving the TPR any further.", "2. Notice the graph at threshold 0.5 and 0.4. The TPR at both the thresholds is ~0.6, but FPR is higher at threshold 0.4. It\u2019s clear that if we are happy with TPR = 0.6 we should choose threshold = 0.5.", "c) Purpose 3 \u2014 Comparing two models (using Area Under the Curve)", "In an ROC Curve, the diagonal represents the baseline model/random classifier. The closer an ROC curve comes to the 45-degree diagonal of the ROC space, the less powerful is the model.", "AUC \u2014 AREA UNDER THE CURVE", "The area under the ROC Curve is also known as AUC. AUC provides an aggregate measure of performance of a model across all possible classification thresholds.", "AUC represents a degree or measure of separability. It tells us how much the model is capable of distinguishing between classes. Higher the AUC, better the model is at predicting the probability of class YES higher than the probability of class NO.", "AUC ranges in value from 0 to 1. A model whose predictions are 100% right has an AUC of 1.0; one whose predictions are 100% wrong has an AUC of 0.0.", "AUC is desirable for the following two reasons:", "Greater the AUC the better the classifier/model.", "Not really. A random model is a classifier that predicts an observation as class YES or NO at random. In this case, we are going to have 50% correct predictions. The AUC would be 0.5 and TPR is equal to FPR at all thresholds. But clearly, such a model would not be of much value to us.", "The worst possible model would be a model that predict all the class YES observations as class NO and class NO observations as class YES. The AUC of such a model would be 0.", "\u2022 Whenever you are building a classification model that predicts probability of an observation belonging to a class, plot its ROC curve to visualise its performance. Do not go with the default threshold of 0.5. Use the ROC curve and domain knowledge to figure out the best threshold for a model.", "\u2022 When the class distribution in the data is imbalanced or cost of false positives and false negatives is different, ROC curves are very helpful. They help us visualize a trade-off between TPR and FPR and thus help us to arrive at a threshold that minimizes the mis-classification cost.", "\u2022 The shape of ROC curves contains a lot of information about the predictive power of the model.", "\u2022 The ROC curves of different models can be compared directly in general or for different thresholds.", "\u2022 The area under the curve (AUC) can be used as a summary of the model skill and can be used to compare two models.", "I hope you\u2019ll be able to able to make better use of ROC curves now. Looking forward to hear from you :)", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fdf809474529a&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdemystifying-roc-curves-df809474529a&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdemystifying-roc-curves-df809474529a&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdemystifying-roc-curves-df809474529a&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdemystifying-roc-curves-df809474529a&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----df809474529a--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----df809474529a--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@ruchitoshniwal?source=post_page-----df809474529a--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@ruchitoshniwal?source=post_page-----df809474529a--------------------------------", "anchor_text": "Ruchi Toshniwal"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fc021c92aadf4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdemystifying-roc-curves-df809474529a&user=Ruchi+Toshniwal&userId=c021c92aadf4&source=post_page-c021c92aadf4----df809474529a---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fdf809474529a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdemystifying-roc-curves-df809474529a&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fdf809474529a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdemystifying-roc-curves-df809474529a&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://medium.com/@ruchitoshniwal/how-to-select-performance-metrics-for-classification-models-c847fe6b1ea3", "anchor_text": "previous article"}, {"url": "https://medium.com/tag/roc-curve?source=post_page-----df809474529a---------------roc_curve-----------------", "anchor_text": "Roc Curve"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----df809474529a---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----df809474529a---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/auc?source=post_page-----df809474529a---------------auc-----------------", "anchor_text": "Auc"}, {"url": "https://medium.com/tag/sensitivity?source=post_page-----df809474529a---------------sensitivity-----------------", "anchor_text": "Sensitivity"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fdf809474529a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdemystifying-roc-curves-df809474529a&user=Ruchi+Toshniwal&userId=c021c92aadf4&source=-----df809474529a---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fdf809474529a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdemystifying-roc-curves-df809474529a&user=Ruchi+Toshniwal&userId=c021c92aadf4&source=-----df809474529a---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fdf809474529a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdemystifying-roc-curves-df809474529a&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----df809474529a--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fdf809474529a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdemystifying-roc-curves-df809474529a&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----df809474529a---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----df809474529a--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----df809474529a--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----df809474529a--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----df809474529a--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----df809474529a--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----df809474529a--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----df809474529a--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----df809474529a--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@ruchitoshniwal?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@ruchitoshniwal?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Ruchi Toshniwal"}, {"url": "https://medium.com/@ruchitoshniwal/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "45 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fc021c92aadf4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdemystifying-roc-curves-df809474529a&user=Ruchi+Toshniwal&userId=c021c92aadf4&source=post_page-c021c92aadf4--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fc0deb7885c01&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdemystifying-roc-curves-df809474529a&newsletterV3=c021c92aadf4&newsletterV3Id=c0deb7885c01&user=Ruchi+Toshniwal&userId=c021c92aadf4&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}