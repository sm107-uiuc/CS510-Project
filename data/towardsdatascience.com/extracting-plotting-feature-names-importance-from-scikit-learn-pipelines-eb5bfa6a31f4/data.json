{"url": "https://towardsdatascience.com/extracting-plotting-feature-names-importance-from-scikit-learn-pipelines-eb5bfa6a31f4", "time": 1683013503.853787, "path": "towardsdatascience.com/extracting-plotting-feature-names-importance-from-scikit-learn-pipelines-eb5bfa6a31f4/", "webpage": {"metadata": {"title": "Extracting & Plotting Feature Names & Importance from Scikit-Learn Pipelines | by Kyle Gilde | Towards Data Science", "h1": "Extracting & Plotting Feature Names & Importance from Scikit-Learn Pipelines", "description": "If you have ever been tasked with productionalizing a machine learning model, you probably know that Scikit-Learn library offers one of the best ways \u2014 if not the best way \u2014 of creating\u2026"}, "outgoing_paragraph_urls": [{"url": "https://scikit-learn.org/stable/modules/generated/sklearn.pipeline.Pipeline.html", "anchor_text": "Pipeline", "paragraph_index": 0}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.compose.ColumnTransformer.html", "anchor_text": "ColumnTransformer", "paragraph_index": 0}, {"url": "https://scikit-learn.org/stable/modules/classes.html#module-sklearn.preprocessing", "anchor_text": "preprocessors", "paragraph_index": 0}, {"url": "https://scikit-learn.org/stable/modules/classes.html#module-sklearn.impute", "anchor_text": "imputers", "paragraph_index": 0}, {"url": "https://scikit-learn.org/stable/modules/classes.html#module-sklearn.feature_selection", "anchor_text": "feature selection", "paragraph_index": 0}, {"url": "https://github.com/scikit-learn/scikit-learn/issues/6424", "anchor_text": "asked", "paragraph_index": 1}, {"url": "https://github.com/scikit-learn/scikit-learn/pull/6431", "anchor_text": "the", "paragraph_index": 1}, {"url": "https://github.com/scikit-learn/scikit-learn/pull/12627", "anchor_text": "same", "paragraph_index": 1}, {"url": "https://github.com/scikit-learn/scikit-learn/pull/13307", "anchor_text": "question", "paragraph_index": 1}, {"url": "https://github.com/scikit-learn/scikit-learn/issues/12525", "anchor_text": "partial answer", "paragraph_index": 1}, {"url": "https://www.kaggle.com/kylegilde/feature-importance", "anchor_text": "here", "paragraph_index": 2}, {"url": "https://scikit-learn.org/stable/auto_examples/release_highlights/plot_release_highlights_1_0_0.html#feature-names-support", "anchor_text": "changes in scikit-learn 1.0", "paragraph_index": 3}, {"url": "https://www.kaggle.com/kylegilde/fit-pipeline-ames", "anchor_text": "fit_pipeline_ames.py", "paragraph_index": 5}, {"url": "https://www.kaggle.com/c/house-prices-advanced-regression-techniques/data", "anchor_text": "Ames housing training data from Kaggle", "paragraph_index": 5}, {"url": "https://scikit-learn.org/stable/modules/feature_selection.html", "anchor_text": "sklearn.feature_selection", "paragraph_index": 9}, {"url": "https://www.kaggle.com/kylegilde/extracting-scikit-feature-names-importances", "anchor_text": "here", "paragraph_index": 13}, {"url": "https://www.kaggle.com/kylegilde/feature-importance", "anchor_text": "here", "paragraph_index": 13}], "all_paragraphs": ["If you have ever been tasked with productionalizing a machine learning model, you probably know that Scikit-Learn library offers one of the best ways \u2014 if not the best way \u2014 of creating production-quality machine learning workflows. The ecosystem\u2019s Pipeline, ColumnTransformer, preprocessors, imputers & feature selection classes are powerful tools that transform raw data into model-ready features.", "However, before anyone is going to let you deploy to production, you are going to want to have some rudimentary understanding of how the new model works. The most common way to explain how a black-box model works is by plotting feature names and importance values. If you have ever tried to extract the feature names from a heterogeneous dataset processed by ColumnTransformer, you know that this is no easy task. Exhaustive Internet searches have only brought to my attention where others have asked the same question or offered a partial answer, instead of yielding a comprehensive and satisfying solution.", "To remedy this situation, I have developed a class called FeatureImportance that will extract feature names and importance values from a Pipeline instance. It then uses the Plotly library to plot the feature importance using only a few lines of code. In this post, I will load a fitted Pipeline, demonstrate how to use my class and then give an overview of how it works. The complete code can be found here or at the end of this blog post.", "Note: My class may not work starting with the changes in scikit-learn 1.0.", "There are two things I should note before continuing:", "For the purposes of demonstration, I\u2019ve written a script called fit_pipeline_ames.py. It loads the Ames housing training data from Kaggle and fits a moderately complex Pipeline. I\u2019ve plotted its visual representation below.", "This pipe instance contains the following 4 steps:", "With the help of FeatureImportance, we can extract the feature names and importance values and plot them with 3 lines of code.", "The plot method takes a number of arguments that control the plot's display. The most important ones are the following:", "The FeatureImportance class should be instantiated using a fitted Pipeline instance. (You can also change the verbose argument to True if you want to have all of the diagnostics printed to your console.) My class validates that this Pipeline starts with a ColumnTransformer instance and ends with a regression or classification model that has the feature_importance_ attribute. The Pipeline can have any number of or no instances of classes from sklearn.feature_selection as intermediate steps.", "The FeatureImportance class is composed of 4 methods.", "3. get_feature_importance calls get_selected_features and then creates a Pandas Series where values are the feature importance values from the model and its index is the feature names created by the first 2 methods. This Series is then stored in the feature_importance attribute.", "4. plot calls get_feature_importance and plots the output based upon the specifications.", "The original notebook for this blog post can be found here. The complete code for FeatureImportance is shown below and can be found here.", "If you create a Pipeline that you believe should be supported FeatureImportanceby but is not, please provide a reproducible example, and I will consider making the necessary changes.", "Stay tuned for further posts on training & regularizing models with Scikit-Learn ColumnTransformers and Pipelines. Let me know if you found this post helpful or have any ideas for improvement. Thanks!", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Feb5bfa6a31f4&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fextracting-plotting-feature-names-importance-from-scikit-learn-pipelines-eb5bfa6a31f4&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fextracting-plotting-feature-names-importance-from-scikit-learn-pipelines-eb5bfa6a31f4&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fextracting-plotting-feature-names-importance-from-scikit-learn-pipelines-eb5bfa6a31f4&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fextracting-plotting-feature-names-importance-from-scikit-learn-pipelines-eb5bfa6a31f4&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----eb5bfa6a31f4--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----eb5bfa6a31f4--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@kylegilde?source=post_page-----eb5bfa6a31f4--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@kylegilde?source=post_page-----eb5bfa6a31f4--------------------------------", "anchor_text": "Kyle Gilde"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fff400dfa809a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fextracting-plotting-feature-names-importance-from-scikit-learn-pipelines-eb5bfa6a31f4&user=Kyle+Gilde&userId=ff400dfa809a&source=post_page-ff400dfa809a----eb5bfa6a31f4---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Feb5bfa6a31f4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fextracting-plotting-feature-names-importance-from-scikit-learn-pipelines-eb5bfa6a31f4&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Feb5bfa6a31f4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fextracting-plotting-feature-names-importance-from-scikit-learn-pipelines-eb5bfa6a31f4&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/photos/L0oJ4Dlfyuo", "anchor_text": "https://unsplash.com/photos/L0oJ4Dlfyuo"}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.pipeline.Pipeline.html", "anchor_text": "Pipeline"}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.compose.ColumnTransformer.html", "anchor_text": "ColumnTransformer"}, {"url": "https://scikit-learn.org/stable/modules/classes.html#module-sklearn.preprocessing", "anchor_text": "preprocessors"}, {"url": "https://scikit-learn.org/stable/modules/classes.html#module-sklearn.impute", "anchor_text": "imputers"}, {"url": "https://scikit-learn.org/stable/modules/classes.html#module-sklearn.feature_selection", "anchor_text": "feature selection"}, {"url": "https://github.com/scikit-learn/scikit-learn/issues/6424", "anchor_text": "asked"}, {"url": "https://github.com/scikit-learn/scikit-learn/pull/6431", "anchor_text": "the"}, {"url": "https://github.com/scikit-learn/scikit-learn/pull/12627", "anchor_text": "same"}, {"url": "https://github.com/scikit-learn/scikit-learn/pull/13307", "anchor_text": "question"}, {"url": "https://github.com/scikit-learn/scikit-learn/issues/12525", "anchor_text": "partial answer"}, {"url": "https://www.kaggle.com/kylegilde/feature-importance", "anchor_text": "here"}, {"url": "https://scikit-learn.org/stable/auto_examples/release_highlights/plot_release_highlights_1_0_0.html#feature-names-support", "anchor_text": "changes in scikit-learn 1.0"}, {"url": "https://github.com/scikit-learn/scikit-learn/issues/12525#issuecomment-436217100", "anchor_text": "this thread"}, {"url": "https://scikit-learn.org/stable/auto_examples/compose/plot_column_transformer_mixed_types.html", "anchor_text": "Scikit-Learn example"}, {"url": "https://www.kaggle.com/kylegilde/fit-pipeline-ames", "anchor_text": "fit_pipeline_ames.py"}, {"url": "https://www.kaggle.com/c/house-prices-advanced-regression-techniques/data", "anchor_text": "Ames housing training data from Kaggle"}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.compose.ColumnTransformer.html", "anchor_text": "ColumnTransformer"}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.impute.SimpleImputer.html", "anchor_text": "SimpleImputer"}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.OneHotEncoder.html", "anchor_text": "OneHotEncoder"}, {"url": "http://contrib.scikit-learn.org/category_encoders/glmm.html", "anchor_text": "GLMMEncoder"}, {"url": "https://contrib.scikit-learn.org/category_encoders/", "anchor_text": "category_encoders"}, {"url": "https://towardsdatascience.com/building-columntransformers-dynamically-1-6354bd08aa54", "anchor_text": "previous blog post"}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.feature_selection.VarianceThreshold.html", "anchor_text": "VarianceThreshold"}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.feature_selection.SelectPercentile.html", "anchor_text": "SelectPercentile"}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.feature_selection.f_regression.html", "anchor_text": "f_regression"}, {"url": "https://catboost.ai/docs/concepts/python-reference_catboostregressor.html", "anchor_text": "CatBoostRegressor"}, {"url": "https://scikit-learn.org/stable/modules/feature_selection.html", "anchor_text": "sklearn.feature_selection"}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.impute.MissingIndicator.html", "anchor_text": "MissingIndicator"}, {"url": "https://www.kaggle.com/kylegilde/extracting-scikit-feature-names-importances", "anchor_text": "here"}, {"url": "https://www.kaggle.com/kylegilde/feature-importance", "anchor_text": "here"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----eb5bfa6a31f4---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/programming?source=post_page-----eb5bfa6a31f4---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/tag/data-science?source=post_page-----eb5bfa6a31f4---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Feb5bfa6a31f4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fextracting-plotting-feature-names-importance-from-scikit-learn-pipelines-eb5bfa6a31f4&user=Kyle+Gilde&userId=ff400dfa809a&source=-----eb5bfa6a31f4---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Feb5bfa6a31f4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fextracting-plotting-feature-names-importance-from-scikit-learn-pipelines-eb5bfa6a31f4&user=Kyle+Gilde&userId=ff400dfa809a&source=-----eb5bfa6a31f4---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Feb5bfa6a31f4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fextracting-plotting-feature-names-importance-from-scikit-learn-pipelines-eb5bfa6a31f4&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----eb5bfa6a31f4--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Feb5bfa6a31f4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fextracting-plotting-feature-names-importance-from-scikit-learn-pipelines-eb5bfa6a31f4&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----eb5bfa6a31f4---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----eb5bfa6a31f4--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----eb5bfa6a31f4--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----eb5bfa6a31f4--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----eb5bfa6a31f4--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----eb5bfa6a31f4--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----eb5bfa6a31f4--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----eb5bfa6a31f4--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----eb5bfa6a31f4--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@kylegilde?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@kylegilde?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Kyle Gilde"}, {"url": "https://medium.com/@kylegilde/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "85 Followers"}, {"url": "https://www.linkedin.com/in/kylegilde/", "anchor_text": "https://www.linkedin.com/in/kylegilde/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fff400dfa809a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fextracting-plotting-feature-names-importance-from-scikit-learn-pipelines-eb5bfa6a31f4&user=Kyle+Gilde&userId=ff400dfa809a&source=post_page-ff400dfa809a--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fusers%2Fff400dfa809a%2Flazily-enable-writer-subscription&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fextracting-plotting-feature-names-importance-from-scikit-learn-pipelines-eb5bfa6a31f4&user=Kyle+Gilde&userId=ff400dfa809a&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}