{"url": "https://towardsdatascience.com/ann-classification-model-evaluation-and-parameter-tuning-9174fd5ad0c2", "time": 1683005423.685138, "path": "towardsdatascience.com/ann-classification-model-evaluation-and-parameter-tuning-9174fd5ad0c2/", "webpage": {"metadata": {"title": "Model Evaluation and Parameter Tuning | Towards Data Science", "h1": "Model Evaluation and Parameter Tuning for Neural Network Optimization", "description": "Step-by-step Walk-through on Cross-validation and Grid Search using Keras"}, "outgoing_paragraph_urls": [{"url": "https://medium.com/@vistaxjtu/ann-classification-banking-customer-leave-or-stay-1cba16441185", "anchor_text": "article", "paragraph_index": 0}, {"url": "https://github.com/luke4u/Customer_Behaviour_Prediction", "anchor_text": "Github", "paragraph_index": 21}], "all_paragraphs": ["In the previous article, we built an ANN to solve a binary classification problem. If you remember, one question left for homework is why we used [[]] for new customer data. The answer is we need to put a customer data in a horizontal vector, not a vertical vector because all observations in the input data are in lines not in columns. Hope you got it right\ud83d\ude0e.", "This article focuses on cross-validation and grid search for model optimization, split into 2 parts:", "You may wonder why we have to spend efforts on model evaluation \ud83e\udd14? The problem is if we re-run the ANN, every time the model produces different accuracy not only on the train set and the test set. So evaluating the model performance on one single test is not the most relevant way.", "A typical method is to use K-fold cross-validation. Figure 1 shows how it works.", "We split the training set into K folds (e.g. K=10). Then train the model on 9 folds and test it on the last remaining fold. With 10 folds, we make 10 different combinations with 9 training sets and 1 test set, and train/test the model 10 times. After that, we take an average of 10 evaluations and compute the standard deviation. With that, we can determine which category of the model belongs to as in Figure 2.", "To implement K-fold cross-validation, we use a scikit_learn wrapper in Keras: KerasClassifier. Specifically, we use Keras to build the model and use scikit_learn for cross-validation. First thing is to build a function for the model architecture as the function is a required argument for the Keras wrapper. As you notice below, this is the same ANN architecture as we built before.", "With the classifier built using the above function, we create a KerasClassifier object. Below we specify the batch size of 10 and the number of epochs of 100 which model needs to be trained on.", "Now, let\u2019s apply K-fold cross-validation on the classifier by using cross_val_score() method. This function returns a list of training accuracy. Parameter cv is the fold number we use for cross-validation. Here the classifier will be trained on 10 different training sets, split from the initial training set.", "Here, cross-validation may take a while. In the end, we get an accuracy of 10 evaluation as shown in Figure 2. The average accuracy is 0.843 and the standard deviation is 1.60% \ud83e\udd2a.", "With reliable model accuracy, let\u2019s try to improve it using two techniques.", "One technique we have not mentioned is dropout regularization. This is the solution for over-fitting which is related to high variance. How does dropout work? At each training iteration, some neurons are randomly disabled to prevent them from depending on each other. By overwriting these neurons, neural networks retain a different configuration of neurons each time, helping the neural networks learn independent correlations of the data. This prevents the neurons from over-learn.", "Let\u2019s implement it using Keras. Basically, we add a drop out layer after each hidden layer. Note p=0.1 means 10% of neurons will be disabled each iteration.", "Neural networks have a few hyper-parameters, such as the number of epochs, batch size, and learning rate. Parameter tuning is about finding the best parameter for the model. Here we use grid search to test different combinations of the parameters.", "To implement it, we use a scikit_learn wrapper in Keras: KerasClassifier to wrap the neural network. Then create a grid search object and apply parameter tuning on the wrapped classifier. First, build the classifier function as below.", "Note above, the number of epoch and batch size is not specified, because they are the parameters we plan to tune, which will be specified in the grid search object below.", "Let\u2019s create a dictionary for parameters that contain values we want the model to try on.", "If you notice above, we have an argument optimizer for build_classifier() function. This argument gives a way to tune the optimizer. To implement grid search, we first create an object of GridSearchCV class with the classifier and parameters.", "Finally, let\u2019s fit ANN on the training set while running grid search to find optimal parameters.", "What we are most interested in is the best parameter which produces the highest accuracy. So with below:", "Finally, after a few hours, we got an improved accuracy of 0.849 \u2728\u2728. The optimal parameter is batch size 25, epoch number 500, and optimizer Adam as shown in Figure 3.", "In a summary, through cross-validation, we found the model accuracy is about 0.843. By using random dropout regularization and grid search, we improved the model accuracy to 0.849. Generally, Grid Search can be performed in 2 steps with a step first to find the rough range and another small step to refine the best range.", "Great! That\u2019s all! \u2728\u2728If you need some extra, visit my Github page. (FYI, the repos is actively maintained \ud83d\udc95\ud83d\udc95)", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "ML Enthusiast, Data Scientist, Python Developer. Love to share articles about technology."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F9174fd5ad0c2&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fann-classification-model-evaluation-and-parameter-tuning-9174fd5ad0c2&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fann-classification-model-evaluation-and-parameter-tuning-9174fd5ad0c2&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fann-classification-model-evaluation-and-parameter-tuning-9174fd5ad0c2&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fann-classification-model-evaluation-and-parameter-tuning-9174fd5ad0c2&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----9174fd5ad0c2--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----9174fd5ad0c2--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://lukesun.medium.com/?source=post_page-----9174fd5ad0c2--------------------------------", "anchor_text": ""}, {"url": "https://lukesun.medium.com/?source=post_page-----9174fd5ad0c2--------------------------------", "anchor_text": "Luke Sun"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F7b5b79d21508&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fann-classification-model-evaluation-and-parameter-tuning-9174fd5ad0c2&user=Luke+Sun&userId=7b5b79d21508&source=post_page-7b5b79d21508----9174fd5ad0c2---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F9174fd5ad0c2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fann-classification-model-evaluation-and-parameter-tuning-9174fd5ad0c2&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F9174fd5ad0c2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fann-classification-model-evaluation-and-parameter-tuning-9174fd5ad0c2&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://pixabay.com/photos/seo-sem-google-marketing-793035/", "anchor_text": "link"}, {"url": "https://medium.com/@vistaxjtu/ann-classification-banking-customer-leave-or-stay-1cba16441185", "anchor_text": "article"}, {"url": "https://github.com/luke4u/Customer_Behaviour_Prediction", "anchor_text": "Github"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----9174fd5ad0c2---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/cross-validation?source=post_page-----9174fd5ad0c2---------------cross_validation-----------------", "anchor_text": "Cross Validation"}, {"url": "https://medium.com/tag/parameter-tuning?source=post_page-----9174fd5ad0c2---------------parameter_tuning-----------------", "anchor_text": "Parameter Tuning"}, {"url": "https://medium.com/tag/dropout-regularization?source=post_page-----9174fd5ad0c2---------------dropout_regularization-----------------", "anchor_text": "Dropout Regularization"}, {"url": "https://medium.com/tag/keras?source=post_page-----9174fd5ad0c2---------------keras-----------------", "anchor_text": "Keras"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F9174fd5ad0c2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fann-classification-model-evaluation-and-parameter-tuning-9174fd5ad0c2&user=Luke+Sun&userId=7b5b79d21508&source=-----9174fd5ad0c2---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F9174fd5ad0c2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fann-classification-model-evaluation-and-parameter-tuning-9174fd5ad0c2&user=Luke+Sun&userId=7b5b79d21508&source=-----9174fd5ad0c2---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F9174fd5ad0c2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fann-classification-model-evaluation-and-parameter-tuning-9174fd5ad0c2&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----9174fd5ad0c2--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F9174fd5ad0c2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fann-classification-model-evaluation-and-parameter-tuning-9174fd5ad0c2&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----9174fd5ad0c2---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----9174fd5ad0c2--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----9174fd5ad0c2--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----9174fd5ad0c2--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----9174fd5ad0c2--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----9174fd5ad0c2--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----9174fd5ad0c2--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----9174fd5ad0c2--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----9174fd5ad0c2--------------------------------", "anchor_text": ""}, {"url": "https://lukesun.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://lukesun.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Luke Sun"}, {"url": "https://lukesun.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "141 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F7b5b79d21508&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fann-classification-model-evaluation-and-parameter-tuning-9174fd5ad0c2&user=Luke+Sun&userId=7b5b79d21508&source=post_page-7b5b79d21508--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F38f46069f6d3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fann-classification-model-evaluation-and-parameter-tuning-9174fd5ad0c2&newsletterV3=7b5b79d21508&newsletterV3Id=38f46069f6d3&user=Luke+Sun&userId=7b5b79d21508&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}