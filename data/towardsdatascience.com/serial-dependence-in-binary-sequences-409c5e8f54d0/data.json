{"url": "https://towardsdatascience.com/serial-dependence-in-binary-sequences-409c5e8f54d0", "time": 1683005438.977094, "path": "towardsdatascience.com/serial-dependence-in-binary-sequences-409c5e8f54d0/", "webpage": {"metadata": {"title": "Serial dependence in binary sequences | by Julian Wergieluk | Towards Data Science", "h1": "Serial dependence in binary sequences", "description": "In this blog post, I am going to investigate the serial (aka temporal) dependence phenomenon in random binary sequences. Random binary sequences are sequences of zeros and ones generated by random\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.wergieluk.com/binary-sequences/meixner.py", "anchor_text": "source code", "paragraph_index": 23}, {"url": "https://docs.scipy.org/doc/scipy/reference/optimize.minimize-bfgs.html", "anchor_text": "BFGS", "paragraph_index": 34}, {"url": "https://www.wergieluk.com/binary-sequences/meixner.py", "anchor_text": "meixner.py", "paragraph_index": 38}, {"url": "https://en.wikipedia.org/wiki/Value_at_risk", "anchor_text": "Value-At-Risk", "paragraph_index": 41}], "all_paragraphs": ["In this blog post, I am going to investigate the serial (aka temporal) dependence phenomenon in random binary sequences.", "Random binary sequences are sequences of zeros and ones generated by random processes. Primary outputs generated by most random number generators are binary. Binary sequences often encode the occurrence of random events:", "In many of those situations, it is necessary to ensure that the tracked events occur independently of each other. For example, the occurrence of an incident in a production system should not make the system more incident prone. For that, we need to take a close look at the dependence structure of the binary sequence under consideration.", "In this blog post, I am going to develop and test a scoring method for quantifying the dependence strength in random binary sequences. The Meixner Dependency Score is easy to implement and is based on the orthogonal polynomials associated with Geometric distribution.", "After reading through this blog post, you will know:", "Given a sequence of random variables X = (X[0], X[1], \u2026, X[n]) taking values in the set {0, 1} and a probability p\u2208(0,1), I would like to investigate the serial dependencies between the elements of X. This investigation should be based on a sample x drawn from X, i.e. a finite sequence of zeros and ones (x[0], x[1],..., x[n]). This is a very difficult and deep problem, and in this blog post I am going to focus on collecting evidence to support or reject the following two basic hypotheses:", "If we assume that the elements of x are independent samples from a fixed Bernoulli random variable X[0], then we can estimate the probability p by calculating the average of x[0], x[1], \u2026, x[n]. This is because the expectation of X[0] is \ud835\udd3c X[0] = p.", "To set an appropriate context for the serial dependence detection problem, let me remark that random binary sequences x are often associated with discreet observations of a system with two states. We say that \u201can event\u201d occurred at time i, if x[0] = 1.", "How can we check whether our events occur independently of each other and gather evidence that there is no serial dependence between the event times?", "We often tend to see serial dependence in situations where there is none. Typical examples are the \u201cwinning or lucky streaks\u201d experienced by gamblers in casinos.", "To rigorously investigate the question of serial dependence in the sequence X based on the observation x, we can look at the distribution of waiting times between the events. For example the sequence", "yields the following sequence of waiting times", "Note that the waiting time calculation discards the initial and trailing zeros in the event sequence x.", "For an i.i.d. sequence of Bernoulli random variables, the sequence of waiting times consists of i.i.d. random variables with the geometric distribution. Let\u2019s have a closer look at its properties.", "The probability mass function (PMF) of the geometric distribution with parameter p is given by", "The PMF of the geometric distribution with the parameter p=0.1 looks as follows.", "One way of test whether a waiting times sequence follows the geometric distribution is to look at the orthogonal polynomials generated by that distribution.", "A family of orthogonal polynomials is intimately tied to every probability distribution \u03bc on \u211d. For any such distribution, we can define a scalar product between (square-integrable) real-valued functions f and g as", "where Y is a random variable with distribution \u03bc. For a geometric distribution, the above scalar product takes the form", "We say that the functions f and g are orthogonal (with respect to \u03bc) if and only if \u27e8f,g\u27e9 = 0.", "Finally, a sequence of polynomials (q[i]) with i\u2265 0 is called orthogonal, if and only if, \u27e8q[k], q[i]\u27e9 = 0 for all k \u2260 i, and each q[i] has degree i. As a consequence, we have \ud835\udd3c q[i](Y) = 0 for i>0. This is the tool I am going to use to check whether a given Y follows a geometric distribution.", "The family of orthogonal polynomials M = (M[i](y)) corresponding to the geometric distribution is a special case of the Meixner family derived from the negative binomial distribution (a generalization of the geometric distribution). The members of the Meixner family satisfy the following handy recursive relation:", "with M[1](y) = 1 and M[-1](y) = 0. This relation is used to calculate the sequence M. Also, note that M[k] depends on the value of the parameter p.", "In the companion python source code, the function meixner_poly_eval is used to evaluate Meixner polynomials up to a given degree on a given set of points. I used this function to plot the graphs of these polynomials up to degree 55.", "As mentioned above, for every polynomial M[k](y) in M the equation", "This relation can be used to test whether a given sample of waiting times belongs to the geometric distribution with parameter p. We are going to estimate the expectations \ud835\udd3c M[k](Y) and use the estimates as scores: Values close to zero can be interpreted as evidence speaking for geometric distribution with parameter p. If the values are far from zero, this is a sign that we need to revisit our assumptions and possibly discard the i.i.d. hypothesis about the original event sequence. Note that significant deviations from zero can also occur if the events are independent but the true probability p\u2019 differs significantly the putative p. This can easily be tested as described earlier.", "In order to arrive at a single number (a score) that quantifies the degree of serial dependence in the sense developed above, we will define the Meixner dependency score (MDS) as a mean of expectation estimates for the first k Meixner polynomials evaluated at a sample of waiting times y=(y[1],..,y[m]):", "The idea of using orthogonal polynomials to test the dependence structure assumptions in binary sequences has its roots in the method of moments inference and was developed in the financial literature to backtest Value-at-Risk models. In this blog post I adapt the approach outlined in Candelon et al. See the References section below.", "To find out whether the procedure devised above has a chance to work in practice, I am going to test it using synthetically generated data. This type of a testing procedure is commonly known as Monte-Carlo (MC) study. It doesn\u2019t replace tests with real-world data, but it can help evaluate a statistical method in a controlled environment.", "The experiment we are going to perform consists of the following steps:", "Let\u2019s start with a simple case of simulating an i.i.d. sequence of Bernoulli random variables with success probability p[0]. This can be used as a sanity check and to test whether our implementation of the procedure is correct.", "For a model with a simple form of serial dependence, we select the probabilities 0 < p[1] < p[0] < p[2] < 1 and set the distributions of random variables in the sequence X = (X[0], X[1], X[2], \u2026) as follows. Let X[0] be Bernoulli with success probability p[0]. The distributions of X[i] for i>0 are conditional on X[i-1]:", "In order to compare this model with an i.i.d. Bernoulli model with the successprobability p[0], we need to set p[1] and p[2] such that the unconditional distributions of X[i] are Ber(p[0]).", "In other words, for a given 0 < p[1] < p[0] < 1, we are looking for a p[2]\u2208 (0, 1), such that the random binary sequence defined above satisfies P(X[i] = 1) = p[0].This binary sequence can be represented as a simple Markov chain with the state space {0, 1}, the transition probability matrix P given by", "This basic result can be found in any book about Markov Chains (see the References section below). The task of finding a p[2] such that P(X[i] = 1) is as close to p[0] as possible, can be easily solved with an off-the-shelf optimization algorithm such as BFGS.", "Let\u2019s test the dependency scoring algorithm for the following values p[1] and p[2]. An MC evaluation of the Meixner polynomials leads to the following Meixner dependency scores:", "Again, 5000 simulations of samples of length 1000 yield the following histograms for the expectation estimates.", "As we can see, the histograms are shifted slightly to the left.", "All the results and plots presented in this blog post have been generated using the following Python script: meixner.py", "In this blog post, we learned about the concept of serial dependence in binary sequences. We implemented a serial dependence detection method, the Meixner Dependency Score, based on the Meixner orthogonal polynomials and tested its performance using a simple Markov chain model.", "An important financial use case for dependency testing is the analysis of the Value-at-Risk exceedance event sequence generated by a market risk model. Market Risk models are widely used in the banking industry for regulatory capital requirement calculations and in the asset management industry for portfolio construction and risk management.", "The Value-At-Risk (Var) is a quantile of the loss distribution for a financial asset price over a fixed time horizon. For example, an investor holding a long position in gold may be interested in the 95% VaR over a one-day time horizon for the gold price in USD. For a well-calibrated VaR model, the extreme losses on 5% of the business days observed over an investment period will exceed the 95% VaR score. The VaR exceedance events must not only occur with the expected frequency but must also be independent of each other. Proper calibration of the market risk model that brings the dependency of the exceedance events to a low level is typically much more difficult than simple calibration of the exceedance frequency. But this is especially important in the times of financial distress, because underestimating the risk leads inevitably to underhedging, and, possibly, to more severe losses.", "Many thanks to Sarah Khatry for reading drafts of this blog post and contributing countless improvement ideas and corrections.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Machine Learning Engineer & CEO of LOLML GmbH. I like mathematics, data science, meditation, and cooking."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F409c5e8f54d0&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fserial-dependence-in-binary-sequences-409c5e8f54d0&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fserial-dependence-in-binary-sequences-409c5e8f54d0&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fserial-dependence-in-binary-sequences-409c5e8f54d0&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fserial-dependence-in-binary-sequences-409c5e8f54d0&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----409c5e8f54d0--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----409c5e8f54d0--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@wergieluk?source=post_page-----409c5e8f54d0--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@wergieluk?source=post_page-----409c5e8f54d0--------------------------------", "anchor_text": "Julian Wergieluk"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fdfb294b12f93&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fserial-dependence-in-binary-sequences-409c5e8f54d0&user=Julian+Wergieluk&userId=dfb294b12f93&source=post_page-dfb294b12f93----409c5e8f54d0---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F409c5e8f54d0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fserial-dependence-in-binary-sequences-409c5e8f54d0&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F409c5e8f54d0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fserial-dependence-in-binary-sequences-409c5e8f54d0&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://www.wergieluk.com/binary-sequences/meixner.py", "anchor_text": "source code"}, {"url": "https://docs.scipy.org/doc/scipy/reference/optimize.minimize-bfgs.html", "anchor_text": "BFGS"}, {"url": "https://www.wergieluk.com/binary-sequences/meixner.py", "anchor_text": "meixner.py"}, {"url": "https://en.wikipedia.org/wiki/Value_at_risk", "anchor_text": "Value-At-Risk"}, {"url": "http://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.404.3188&rep=rep1&type=pdf", "anchor_text": "Backtesting Value-at-Risk: A GMM Duration-Based Test"}, {"url": "https://www.nist.gov/publications/nist-handbook-mathematical-functions", "anchor_text": "NIST handbook of mathematical functions hardback and CD-ROM"}, {"url": "https://doi.org/10.1017/CBO9780511810633", "anchor_text": "Markov chains"}, {"url": "https://press.princeton.edu/books/hardcover/9780691166278/quantitative-risk-management", "anchor_text": "Quantitative risk management"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----409c5e8f54d0---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/time-series-analysis?source=post_page-----409c5e8f54d0---------------time_series_analysis-----------------", "anchor_text": "Time Series Analysis"}, {"url": "https://medium.com/tag/correlation?source=post_page-----409c5e8f54d0---------------correlation-----------------", "anchor_text": "Correlation"}, {"url": "https://medium.com/tag/towards-data-science?source=post_page-----409c5e8f54d0---------------towards_data_science-----------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/tag/data-science?source=post_page-----409c5e8f54d0---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F409c5e8f54d0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fserial-dependence-in-binary-sequences-409c5e8f54d0&user=Julian+Wergieluk&userId=dfb294b12f93&source=-----409c5e8f54d0---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F409c5e8f54d0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fserial-dependence-in-binary-sequences-409c5e8f54d0&user=Julian+Wergieluk&userId=dfb294b12f93&source=-----409c5e8f54d0---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F409c5e8f54d0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fserial-dependence-in-binary-sequences-409c5e8f54d0&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----409c5e8f54d0--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F409c5e8f54d0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fserial-dependence-in-binary-sequences-409c5e8f54d0&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----409c5e8f54d0---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----409c5e8f54d0--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----409c5e8f54d0--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----409c5e8f54d0--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----409c5e8f54d0--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----409c5e8f54d0--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----409c5e8f54d0--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----409c5e8f54d0--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----409c5e8f54d0--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@wergieluk?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@wergieluk?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Julian Wergieluk"}, {"url": "https://medium.com/@wergieluk/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "57 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fdfb294b12f93&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fserial-dependence-in-binary-sequences-409c5e8f54d0&user=Julian+Wergieluk&userId=dfb294b12f93&source=post_page-dfb294b12f93--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F80e1eb10c69f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fserial-dependence-in-binary-sequences-409c5e8f54d0&newsletterV3=dfb294b12f93&newsletterV3Id=80e1eb10c69f&user=Julian+Wergieluk&userId=dfb294b12f93&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}