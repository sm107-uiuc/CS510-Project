{"url": "https://towardsdatascience.com/machine-learning-model-regularization-in-practice-an-example-with-keras-and-tensorflow-2-0-52a96746123e", "time": 1683010212.823188, "path": "towardsdatascience.com/machine-learning-model-regularization-in-practice-an-example-with-keras-and-tensorflow-2-0-52a96746123e/", "webpage": {"metadata": {"title": "Machine Learning Model Regularization in Practice: an example with Keras and TensorFlow 2.0 | by B. Chen | Towards Data Science", "h1": "Machine Learning Model Regularization in Practice: an example with Keras and TensorFlow 2.0", "description": "In this article, we will focus on incorporating regularization into our machine learning model and look at an example of how we do this in practice with Keras and TensorFlow 2.0. Let\u2019s avoid Maths\u2026"}, "outgoing_paragraph_urls": [{"url": "https://github.com/BindiChen/machine-learning", "anchor_text": "machine learning repo", "paragraph_index": 10}, {"url": "https://en.wikipedia.org/wiki/Iris_flower_data_set", "anchor_text": "Anderson Iris flower (iris)", "paragraph_index": 11}, {"url": "https://archive.ics.uci.edu/ml/datasets/iris", "anchor_text": "UCI Iris dataset", "paragraph_index": 12}, {"url": "https://towardsdatascience.com/what-is-one-hot-encoding-and-how-to-use-pandas-get-dummies-function-922eb9bd4970", "anchor_text": "one-hot encoding", "paragraph_index": 15}, {"url": "https://towardsdatascience.com/3-ways-to-create-a-machine-learning-model-with-keras-and-tensorflow-2-0-de09323af4d3", "anchor_text": "3 ways to create a machine learning model with Keras and Tensorflow 2", "paragraph_index": 21}, {"url": "https://github.com/BindiChen/machine-learning", "anchor_text": "notebook on my Github", "paragraph_index": 42}], "all_paragraphs": ["In this article, we will focus on incorporating regularization into our machine learning model and look at an example of how we do this in practice with Keras and TensorFlow 2.0.", "Turns out many people are afraid of Maths, especially beginners and people changing career paths to data science.", "Let\u2019s avoid Maths and try to explain regularization in a more gentle way. If you are looking for a complete explanation (with a lot of math expressions) of regularisation, you might find the following articles useful:", "Regularization is a technique to combat the overfitting issue in machine learning. Overfitting, also known as High Variance, refers to a model that learns the training data too well but fail to generalize to new data. For example, the green line below is an overfitted model and the black line represents a regularized model.", "Overfitting can be diagnosed by plotting training and validation loss. For example, in the below graph, training error is shown in blue, validation error in red, both as a function of the number of training epochs. If the validation error increases while the training error steadily decreases, then a situation of overfitting may have occurred.", "Once overfitting is diagnosed, it is time to try different regularization techniques and parameters to see if they help. The most widely used regularization techniques are:", "In the following article, we are going to incorporate L2 regularization and Dropout to reduce overfitting of a neural network model.", "In order to run this tutorial, you need to install", "TensorFlow 2, numpy, pandas, sklean, matplotlib", "They can all be installed directly vis PyPI and I strongly recommend to create a new Virtual Environment. For a tutorial on creating a Python virtual environment", "This is a step by step tutorial and all instructions are in this article. For source code, please check out my Github machine learning repo.", "This tutorial uses the Anderson Iris flower (iris) dataset for demonstration. The dataset contains a set of 150 records under five attributes: sepal length, sepal width, petal length, petal width, and class (known as target from sklearn datasets).", "First, let\u2019s import the libraries and obtain iris dataset from scikit-learn library. You can also download it from the UCI Iris dataset.", "For the purpose of exploring data, let\u2019s load data into a DataFrame", "And the df should look like below:", "We notice the label column is a categorical feature and will need to convert it to one-hot encoding. Otherwise, our machine learning algorithm won\u2019t be able to directly take in that as input.", "Now, the df should look like:", "Next, let\u2019s create X and y. Keras and TensorFlow 2.0 only take in Numpy array as inputs, so we will have to convert DataFrame back to Numpy array.", "Finally, let\u2019s split the dataset into a training set (80%)and a test set (20%) using train_test_split() from sklearn library.", "Great! our data is ready for building a Machine Learning model.", "Before applying regularization, let\u2019s build a neural network without regularization and take a look at the overfitting issue.", "There are 3 ways to create a machine learning model with Keras and Tensorflow 2. Since we are building a simple fully connected Neural Network and for simplicity, let\u2019s use the easiest way: Sequential Model with Sequential().", "Let\u2019s go ahead and create a function called create_model() to return a Sequential model.", "Should print out the model summary.", "In order to train a model, we first have to configure our model using compile() and pass the following arguments:", "After that, we can call model.fit() to fit our model to the training data.", "If all runs smoothly, we should get an output like below", "Once training is complete, it\u2019s time to see if the model is any good with Model Evaluation. The Model Evaluation typically involves", "Let\u2019s create a function plot_metric() for plotting metrics.", "By running plot_metric(history, 'accuracy') to plot the progress on accuracy.", "By running plot_metric(history, 'loss') to plot the progress on loss.", "From the above graph, we can see that the model has overfitted the training data, so it outperforms the validation set.", "To evaluate the model on the test set", "And we should get an output like below", "First, let\u2019s import Dropout and L2 regularization from TensorFlow Keras package", "Then, we create a function called create_regularized_model() and it will return a model similar to the one we built before. But, this time we will add L2 regularization and Dropout layers, so this function takes 2 arguments: a L2 regularization factor and a Dropout rate.", "Let\u2019s create the model with arguments L2 factor 0.0001 and Dropout rate 0.3", "The regularized model can be trained just like the first model we built.", "If all runs smoothly, we should get an output like below", "Now, let\u2019s plot the progress on loss", "From the graph, we can see that the overfitting it not completely fixed, but there is a significant improvement when we compare it to the unregularized model.", "And finally, to evaluate the model on the test set", "Please checkout the notebook on my Github for the source code.", "Stay tuned if you are interested in the practical aspect of machine learning.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F52a96746123e&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-model-regularization-in-practice-an-example-with-keras-and-tensorflow-2-0-52a96746123e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-model-regularization-in-practice-an-example-with-keras-and-tensorflow-2-0-52a96746123e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-model-regularization-in-practice-an-example-with-keras-and-tensorflow-2-0-52a96746123e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-model-regularization-in-practice-an-example-with-keras-and-tensorflow-2-0-52a96746123e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----52a96746123e--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----52a96746123e--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://bindichen.medium.com/?source=post_page-----52a96746123e--------------------------------", "anchor_text": ""}, {"url": "https://bindichen.medium.com/?source=post_page-----52a96746123e--------------------------------", "anchor_text": "B. Chen"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F563d09da62a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-model-regularization-in-practice-an-example-with-keras-and-tensorflow-2-0-52a96746123e&user=B.+Chen&userId=563d09da62a&source=post_page-563d09da62a----52a96746123e---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F52a96746123e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-model-regularization-in-practice-an-example-with-keras-and-tensorflow-2-0-52a96746123e&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F52a96746123e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-model-regularization-in-practice-an-example-with-keras-and-tensorflow-2-0-52a96746123e&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@rocknrollmonkey?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Rock\u2019n Roll Monkey"}, {"url": "https://unsplash.com/s/photos/artificial-intelligence?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://towardsdatascience.com/regularization-in-machine-learning-76441ddcf99a", "anchor_text": "Regularization in Machine Learning"}, {"url": "https://towardsdatascience.com/regularization-an-important-concept-in-machine-learning-5891628907ea", "anchor_text": "Regularization: an important concept in Machine Learning"}, {"url": "https://en.wikipedia.org/wiki/Overfitting", "anchor_text": "Wikipedia"}, {"url": "https://en.wikipedia.org/wiki/Overfitting", "anchor_text": "Wikipedia"}, {"url": "https://towardsdatascience.com/create-virtual-environment-using-virtualenv-and-add-it-to-jupyter-notebook-6e1bf4e03415", "anchor_text": "Create Virtual Environment using \u201cvirtualenv\u201d and add it to Jupyter Notebook"}, {"url": "https://medium.com/analytics-vidhya/create-virtual-environment-using-conda-and-add-it-to-jupyter-notebook-d319a81dfd1", "anchor_text": "Create Virtual Environment using \u201cconda\u201d and add it to Jupyter Notebook"}, {"url": "https://github.com/BindiChen/machine-learning", "anchor_text": "machine learning repo"}, {"url": "https://en.wikipedia.org/wiki/Iris_flower_data_set", "anchor_text": "Anderson Iris flower (iris)"}, {"url": "https://archive.ics.uci.edu/ml/datasets/iris", "anchor_text": "UCI Iris dataset"}, {"url": "https://towardsdatascience.com/what-is-one-hot-encoding-and-how-to-use-pandas-get-dummies-function-922eb9bd4970", "anchor_text": "one-hot encoding"}, {"url": "https://towardsdatascience.com/3-ways-to-create-a-machine-learning-model-with-keras-and-tensorflow-2-0-de09323af4d3", "anchor_text": "3 ways to create a machine learning model with Keras and Tensorflow 2"}, {"url": "https://github.com/BindiChen/machine-learning", "anchor_text": "notebook on my Github"}, {"url": "https://keras.io/api/layers/regularizers/", "anchor_text": "Keras Layer weight regularizers"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----52a96746123e---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/tensorflow?source=post_page-----52a96746123e---------------tensorflow-----------------", "anchor_text": "TensorFlow"}, {"url": "https://medium.com/tag/keras?source=post_page-----52a96746123e---------------keras-----------------", "anchor_text": "Keras"}, {"url": "https://medium.com/tag/regularization?source=post_page-----52a96746123e---------------regularization-----------------", "anchor_text": "Regularization"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----52a96746123e---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F52a96746123e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-model-regularization-in-practice-an-example-with-keras-and-tensorflow-2-0-52a96746123e&user=B.+Chen&userId=563d09da62a&source=-----52a96746123e---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F52a96746123e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-model-regularization-in-practice-an-example-with-keras-and-tensorflow-2-0-52a96746123e&user=B.+Chen&userId=563d09da62a&source=-----52a96746123e---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F52a96746123e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-model-regularization-in-practice-an-example-with-keras-and-tensorflow-2-0-52a96746123e&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----52a96746123e--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F52a96746123e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-model-regularization-in-practice-an-example-with-keras-and-tensorflow-2-0-52a96746123e&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----52a96746123e---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----52a96746123e--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----52a96746123e--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----52a96746123e--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----52a96746123e--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----52a96746123e--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----52a96746123e--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----52a96746123e--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----52a96746123e--------------------------------", "anchor_text": ""}, {"url": "https://bindichen.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://bindichen.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "B. Chen"}, {"url": "https://bindichen.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "4K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F563d09da62a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-model-regularization-in-practice-an-example-with-keras-and-tensorflow-2-0-52a96746123e&user=B.+Chen&userId=563d09da62a&source=post_page-563d09da62a--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F56a3bfbb80dc&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-model-regularization-in-practice-an-example-with-keras-and-tensorflow-2-0-52a96746123e&newsletterV3=563d09da62a&newsletterV3Id=56a3bfbb80dc&user=B.+Chen&userId=563d09da62a&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}