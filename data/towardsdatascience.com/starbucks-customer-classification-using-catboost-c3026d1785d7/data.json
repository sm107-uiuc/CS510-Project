{"url": "https://towardsdatascience.com/starbucks-customer-classification-using-catboost-c3026d1785d7", "time": 1683006277.79376, "path": "towardsdatascience.com/starbucks-customer-classification-using-catboost-c3026d1785d7/", "webpage": {"metadata": {"title": "Starbucks Customer profiling using CatBoost and Bokeh | by Hardik B. | Towards Data Science", "h1": "Starbucks Customer profiling using CatBoost and Bokeh", "description": "In this post, I explore the customer data provided by Starbucks in collaboration with Udacity to understand customer behaviors in light of potential rewards. The Starbucks mobile app sends out\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.starbucks.com/", "anchor_text": "Starbucks", "paragraph_index": 0}, {"url": "https://www.udacity.com/", "anchor_text": "Udacity", "paragraph_index": 0}, {"url": "https://catboost.ai/", "anchor_text": "CatBoost", "paragraph_index": 2}, {"url": "https://docs.bokeh.org/en/latest/index.html", "anchor_text": "Bokeh", "paragraph_index": 2}, {"url": "https://github.com/hardik101/dsnd-capstone-project", "anchor_text": "here", "paragraph_index": 3}, {"url": "https://blog.udacity.com/2018/05/introducing-udacity-data-scientist-nanodegree-program.html", "anchor_text": "DataScience NanoDegree Program", "paragraph_index": 6}, {"url": "https://catboost.ai/docs/concepts/parameter-tuning.html", "anchor_text": "here", "paragraph_index": 57}, {"url": "https://github.com/hardik101/dsnd-capstone-project", "anchor_text": "here", "paragraph_index": 59}], "all_paragraphs": ["In this post, I explore the customer data provided by Starbucks in collaboration with Udacity to understand customer behaviors in light of potential rewards. The Starbucks mobile app sends out different kinds of incentive offers to its customers to keep them engaged with the brand.", "The motivation of this post is to discuss a solution approach taken to analyze the data and machine learning solution that predicts customer responsiveness.", "I have used a machine learning library CatBoost for a multiclass classification problem and Bokeh as a primary visualization tool.", "The GitHub Repo of the project can be found here.", "This data set contains simulated data that mimics customer behavior on the Starbucks rewards mobile app. Once every few days, Starbucks sends out an offer to users of the mobile app. An offer can be merely an advertisement for a drink or an actual offer, such as a discount or BOGO (buy one get one free). Some users might not receive any offers during certain weeks.", "Every offer has a validity period before the offer expires. As an example, a BOGO offer might be valid for only five days. You\u2019ll see in the data set that informational offers have a validity period even though these ads are merely providing information about a product; for example, if an informational offer has seven days of validity, you can assume the customer is feeling the influence of the offer for seven days after receiving the advertisement.", "[Project Overview is taken from Udacity\u2019s Capstone Project for DataScience NanoDegree Program]", "The data is contained in three files:", "portfolio.json \u2014 containing offer ids and metadata about each offer (duration, type)", "profile.json \u2014 demographic data for each customer", "transcript.json \u2014 records for transactions, offers received, offers viewed, and offers complete", "The aim is to analyze individual customer behaviors to identify unusual patterns. The finding of such an analysis should help Starbucks business to re-evaluate its rewards program based on specific outcomes.", "I aim to provide analysis targeting the following business questions:", "Here each offer is always sent via the \u2018email\u2019 channel. Therefore this feature is only informative and may not add any value to the predictive power of any machine learning algorithm.", "It is obvious that \u2018age\u2019 value 118 is a placeholder for the missing value.Further analysis reveals 2175 missing entries for gender, age, and income columns together.", "\u2018became_member_on\u2019 column is a timestamped date, let\u2019s transform it into a more readable format and also extract the number of days since the customer has signed up.", "Let\u2019s create some visualizations to analyze the demographic data", "The left chart shows that there is a steady increase in the number of customers over the years. However, there is a steep fall at the end of 2017. This could also be due to sampling to prepare the dataset.", "Surprisingly, there are many customers who fall into relatively lower-income groups and very few customers who fall into relatively high-income groups.", "The pair chart shows that there are not many female customers, and the female group is relatively older and has a higher income.", "The quick look at the transcript dataset reveals that the \u2018value\u2019 column is encoded as a dictionary. If the event is related to offers, then the \u2018value\u2019 column encode offer id, and in case of transaction event, it encodes the amount of transaction.", "Therefore, it makes sense to decode the \u2018value\u2019 column into separate columns to understand the relationship between offers and the amount spent by the customers.", "First of all, we should calculate the total number of offers completed and the total number of offers viewed by each customer.The data includes \u2018offers completed\u2019 by customers, knowingly or unknowingly. The customers who have unknowingly completed offers should not be sent out further offers. This group represents profitable customers for the company.", "We combine our transcript dataset with the customer demographics (profile) and portfolio data.", "After several preprocessing steps applied to the joint dataset,", "The above chart displays the number of offers viewed against timestamp in hours. There are six peaks where the number of viewed offers increases dramatically.", "I have embedded the number of offers received (correct received offer count is four times the marked one) in the chart. When new offers get received, the count of viewed offer increases and then slowly decreases over time. Generally speaking, most offers are viewed within 24 hours of receipt.", "The above chart shows the number of completed offers against a timestamp in hours. It follows a similar pattern as the graph before because new offers are sent six times in 24 day period, and hence the chart has six peaks.", "Between each peak, the chart decreases gradually, just like viewed offers chart. However, the decrease is not as smooth as for the viewed offer chart. There are some local picks during the decline.", "The above chart combines a number of transactions and offers completed together. There is a local peak between each \u2018offer sent out interval\u2019 for transactions. This implies that when offers are received, customers quickly perform some transactions resulting in offer completion.", "At time stamp 0, there exist around 600 transactions. Around 200 of them contribute to \u2018offer completion\u2019 (number of offers completed at timestamp 0), which is roughly a 25% conversion rate. This figure is roughly in agreement with the ratio of the total number of completed offers to the total number of transactions => 138953/33579)*100 = 24.16%.", "There exist some high-value transactions (above 100 USD). It could be a large order from individuals for special events or from corporate clients. Such a high-value transaction leads to all of the current offers associated with a customer to complete.", "In reality, these transactions were not motivated to complete the offers, and therefore it should be considered side effects. Sending out offers to such high paying customers would not lead to an increase or decrease in their purchasing behavior. Therefore we should remove such high-value transactions from the dataset.", "Next, we should also find out and remove non-responsive customers. I define non-responsive customer = no received offered viewed + no transaction made.", "After some further preprocessing steps, I found 422 customers having made no transaction. Out of them, 412 has received and viewed offers while 10 of them have received and not viewed any offers.", "Similarly, analyzing the transaction amount, the following observations were collected:", "In this section, we look at the customer\u2019s interaction with offers through some advanced visualizations. Based on that, I define some calculated features.", "Here in the above chart, we have a customer who has completed all the offers sent out to him/her. It usually takes more than one transaction to complete an offer if those transactions are low value.", "Sometimes, the customer views the offer instantly while sometimes, he/she views it at a later time.", "Out of 4 offers completed, only 1 (last completed) is not viewed by the customer.", "Here we have two high paying customers side by side who has completed all the received offers.", "Interestingly, for customer \u20189fa\u2019 after completing the first offer, he/she has made five transactions amounting in total around 75 USD without any pending offer to complete. It demonstrates that those transactions were not motivated to complete the offer and show customers spending tendencies in the absence of any offers.", "Based on the above analysis I derive the following custom features1. Percentage of Offers completed by a given customer2. Absolute count of Offers completed by a given customer3. Percentage of Offers viewed by a given customer4. Absolute count of Offers viewed by a given customer5. Total amount spent by a given customer", "Our problem falls into the category of multi-class classification. The multi-class classification problem can be summarised as below:Given a dataset with instances \ud835\udc65\ud835\udc56 together with \ud835\udc41 classes where every instance \ud835\udc65\ud835\udc56 belongs precisely to one class \ud835\udc66\ud835\udc56 is a problem targeted for a multiclass classifier.After the training and testing, we have a table with the correct class \ud835\udc66\ud835\udc56 and the predicted class \ud835\udc4e\ud835\udc56 for every instance \ud835\udc65\ud835\udc56 in the test set. So for every instance, we have either a match (\ud835\udc66\ud835\udc56=\ud835\udc4e\ud835\udc56) or a miss (\ud835\udc66\ud835\udc56\u2260\ud835\udc4e\ud835\udc56).Assuming we have balanced class distribution in our training set, evaluation using a confusion matrix together with the average accuracy score should be sufficient. However, F1-score can also be used for the evaluation of the multi-class problem.", "Since the cost of misclassification is not high in our case (sending an offer to the non-responsive customer doesn\u2019t cost the company extra money), F1-score is not necessary.", "In this project, I prefer to use the confusion matrix and the average score as our evaluation measures.Confusion Matrix:A confusion matrix shows the combination of the actual and predicted classes. Each row of the matrix represents the instances in a predicted class, while each column represents the instances in an actual class. It is a good measure of whether models can account for the overlap in class properties and understand which classes are most easily confused.", "Accuracy:Percentage of total items classified correctly- (TP+TN)/(N+P) TP: True PositiveTN: True Negative N: Negative P: Positive", "For unbalanced class distribution, I have provided weights to each class label, and CatBoost automatically handles it.", "I have created a custom target label indicating customer\u2019s responsiveness.", "For binary classification, it would simply classify the customer based on the percentage of offers completed. If the offer completed percentage is >50 %, a customer belongs to a \u2018responsive\u2019 class. Otherwise, it belongs to the \u2018unresponsive\u2019 class.", "Later, I extend the problem to multiclass classification. For this, I have created 3-class, 4-class, and 5-class labels by assigning the percentage of offers completed to a specific class and assigning an appropriate label to each class.", "For 5-class problem, the label encoding looks like this:", "1. Model Evaluation with fixed values of hyperparameters (Base Model)", "I evaluate CatBoost Classifier with following fixed hyperparameters on all classification problems (class_2, class_3, class_4, class_5)", "and the rest of the parameter values as default provided by CatBoost Classifier.", "2. Model Evaluation with hyperparameters found using GridSearch (Tuned Model)", "In this round of experiments, I wrote a custom GridSearch function, which finds the best values for each given hyperparameter ranges and returns the model hyperparameters with the best average accuracy on training data.", "For CatBoost Multiclassifier, there are numerous hyperparameters to tune. An extensive list can be found here:", "I selected only the following hyperparameters with a specified range(found via some research on CatBoost website and Kaggle) to find the model with the best performance.", "Many thanks for reading the article. If you are interested in more detail about the project, please have a look at the project repository here.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fc3026d1785d7&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fstarbucks-customer-classification-using-catboost-c3026d1785d7&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fstarbucks-customer-classification-using-catboost-c3026d1785d7&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fstarbucks-customer-classification-using-catboost-c3026d1785d7&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fstarbucks-customer-classification-using-catboost-c3026d1785d7&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----c3026d1785d7--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----c3026d1785d7--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@hardikbalar101?source=post_page-----c3026d1785d7--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@hardikbalar101?source=post_page-----c3026d1785d7--------------------------------", "anchor_text": "Hardik B."}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F8fa3a6b38954&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fstarbucks-customer-classification-using-catboost-c3026d1785d7&user=Hardik+B.&userId=8fa3a6b38954&source=post_page-8fa3a6b38954----c3026d1785d7---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc3026d1785d7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fstarbucks-customer-classification-using-catboost-c3026d1785d7&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc3026d1785d7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fstarbucks-customer-classification-using-catboost-c3026d1785d7&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://towardsdatascience.com/machine-learning-multiclass-classification-with-imbalanced-data-set-29f6a177c1a", "anchor_text": "Multiclass"}, {"url": "https://mybinder.org/v2/gh/hardik101/dsnd-capstone-project/master", "anchor_text": "Binder"}, {"url": "https://unsplash.com/@trance?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "TR"}, {"url": "https://unsplash.com/s/photos/starbucks?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://www.starbucks.com/", "anchor_text": "Starbucks"}, {"url": "https://www.udacity.com/", "anchor_text": "Udacity"}, {"url": "https://catboost.ai/", "anchor_text": "CatBoost"}, {"url": "https://docs.bokeh.org/en/latest/index.html", "anchor_text": "Bokeh"}, {"url": "https://github.com/hardik101/dsnd-capstone-project", "anchor_text": "here"}, {"url": "https://blog.udacity.com/2018/05/introducing-udacity-data-scientist-nanodegree-program.html", "anchor_text": "DataScience NanoDegree Program"}, {"url": "https://catboost.ai/docs/concepts/parameter-tuning.html", "anchor_text": "here"}, {"url": "https://github.com/hardik101/dsnd-capstone-project", "anchor_text": "here"}, {"url": "https://medium.com/tag/python?source=post_page-----c3026d1785d7---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/bokeh?source=post_page-----c3026d1785d7---------------bokeh-----------------", "anchor_text": "Bokeh"}, {"url": "https://medium.com/tag/catboost?source=post_page-----c3026d1785d7---------------catboost-----------------", "anchor_text": "Catboost"}, {"url": "https://medium.com/tag/classification?source=post_page-----c3026d1785d7---------------classification-----------------", "anchor_text": "Classification"}, {"url": "https://medium.com/tag/data?source=post_page-----c3026d1785d7---------------data-----------------", "anchor_text": "Data"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fc3026d1785d7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fstarbucks-customer-classification-using-catboost-c3026d1785d7&user=Hardik+B.&userId=8fa3a6b38954&source=-----c3026d1785d7---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fc3026d1785d7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fstarbucks-customer-classification-using-catboost-c3026d1785d7&user=Hardik+B.&userId=8fa3a6b38954&source=-----c3026d1785d7---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc3026d1785d7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fstarbucks-customer-classification-using-catboost-c3026d1785d7&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----c3026d1785d7--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fc3026d1785d7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fstarbucks-customer-classification-using-catboost-c3026d1785d7&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----c3026d1785d7---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----c3026d1785d7--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----c3026d1785d7--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----c3026d1785d7--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----c3026d1785d7--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----c3026d1785d7--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----c3026d1785d7--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----c3026d1785d7--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----c3026d1785d7--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@hardikbalar101?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@hardikbalar101?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Hardik B."}, {"url": "https://medium.com/@hardikbalar101/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "2 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F8fa3a6b38954&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fstarbucks-customer-classification-using-catboost-c3026d1785d7&user=Hardik+B.&userId=8fa3a6b38954&source=post_page-8fa3a6b38954--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fusers%2F8fa3a6b38954%2Flazily-enable-writer-subscription&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fstarbucks-customer-classification-using-catboost-c3026d1785d7&user=Hardik+B.&userId=8fa3a6b38954&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}