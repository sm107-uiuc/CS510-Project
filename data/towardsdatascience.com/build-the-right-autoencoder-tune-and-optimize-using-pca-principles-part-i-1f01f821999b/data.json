{"url": "https://towardsdatascience.com/build-the-right-autoencoder-tune-and-optimize-using-pca-principles-part-i-1f01f821999b", "time": 1682997131.9509492, "path": "towardsdatascience.com/build-the-right-autoencoder-tune-and-optimize-using-pca-principles-part-i-1f01f821999b/", "webpage": {"metadata": {"title": "Build the right Autoencoder \u2014 Tune and Optimize using PCA principles. Part I | by Chitta Ranjan | Towards Data Science", "h1": "Build the right Autoencoder \u2014 Tune and Optimize using PCA principles. Part I", "description": "The availability of Deep Learning APIs, such as Keras and TensorFlow, have made model building and experimentation extremely easy. However, a lack of clear understanding of the fundamentals may put\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.understandingdeeplearning.com", "anchor_text": "Understanding Deep Learning", "paragraph_index": 0}, {"url": "https://medium.com/@cran2367/build-the-right-autoencoder-tune-and-optimize-using-pca-principles-part-ii-24b9cca69bd6", "anchor_text": "Part II", "paragraph_index": 2}, {"url": "https://blog.keras.io/building-autoencoders-in-keras.html", "anchor_text": "Building Autoencoders in Keras", "paragraph_index": 5}, {"url": "https://medium.com/@cran2367/build-the-right-autoencoder-tune-and-optimize-using-pca-principles-part-ii-24b9cca69bd6", "anchor_text": "Part II", "paragraph_index": 9}, {"url": "https://towardsdatascience.com/build-the-right-autoencoder-tune-and-optimize-using-pca-principles-part-ii-24b9cca69bd6", "anchor_text": "Part II", "paragraph_index": 9}, {"url": "https://medium.com/@aptrishu/understanding-principle-component-analysis-e32be0253ef0", "anchor_text": "Understanding PCA", "paragraph_index": 10}, {"url": "https://www.cs.cmu.edu/~mgormley/courses/10701-f16/slides/lecture14-pca.pdf", "anchor_text": "3", "paragraph_index": 11}, {"url": "https://medium.com/@cran2367/build-the-right-autoencoder-tune-and-optimize-using-pca-principles-part-ii-24b9cca69bd6", "anchor_text": "Part II", "paragraph_index": 24}, {"url": "https://github.com/cran2367/pca-autoencoder-relationship/blob/master/pca-autoencoder-relationship.ipynb", "anchor_text": "GitHub repository", "paragraph_index": 25}, {"url": "https://medium.com/@cran2367/build-the-right-autoencoder-tune-and-optimize-using-pca-principles-part-ii-24b9cca69bd6", "anchor_text": "Part II", "paragraph_index": 26}, {"url": "https://github.com/cran2367/pca-autoencoder-relationship/blob/master/pca-autoencoder-relationship.ipynb", "anchor_text": "here", "paragraph_index": 36}, {"url": "https://arxiv.org/pdf/1709.06079.pdf", "anchor_text": "4", "paragraph_index": 38}, {"url": "https://arxiv.org/pdf/1609.07093.pdf", "anchor_text": "5", "paragraph_index": 38}, {"url": "https://medium.com/@cran2367/build-the-right-autoencoder-tune-and-optimize-using-pca-principles-part-ii-24b9cca69bd6", "anchor_text": "Part II", "paragraph_index": 39}, {"url": "https://medium.com/@cran2367/build-the-right-autoencoder-tune-and-optimize-using-pca-principles-part-ii-24b9cca69bd6", "anchor_text": "Go to the sequel, Part II.", "paragraph_index": 40}, {"url": "http://www.understandingdeeplearning.com", "anchor_text": "www.understandingdeeplearning.com", "paragraph_index": 42}], "all_paragraphs": ["<<Download the free book, Understanding Deep Learning, to learn more>>", "The availability of Deep Learning APIs, such as Keras and TensorFlow, have made model building and experimentation extremely easy. However, a lack of clear understanding of the fundamentals may put us in a directionless race to the best model. Reaching the best model in such a race is left to chance.", "Here we will develop an understanding of the fundamental properties required in an Autoencoder. This will provide a well-directed approach for Autoencoder tuning and optimization. In Part I, we will focus on learning the properties and their benefits. In Part II, we will develop custom layer and constraints to incorporate the properties.", "The primary concept that we will learn here and that will enable us to construct a right Autoencoder is, Autoencoders are directly related to Principal Component Analysis (PCA). A \u201cright\u201d Autoencoder mathematically means a well-posed Autoencoder. A well-posed model is easier to tune and optimize.", "Therefore, an Autoencoder should ideally have the properties of PCA. These properties are,", "However, Autoencoders as explained in most tutorials, e.g. Building Autoencoders in Keras [1], do not have these properties. A lack of which makes them sub-optimal.", "Therefore, it is important to incorporate these properties for a well-posed Autoencoder. By incorporating them, we will also", "With a smaller network, we bring Autoencoder closer to Edge Computing.", "This article will elucidate the above concept by showing the", "The article will be continued in Part II with detailed steps to optimize an Autoencoder. In Part II, we find that the optimizations improved the Autoencoder reconstruction error by more than 50%.", "This article assumes the reader has a basic understanding of PCA. If unfamiliar, please refer to Understanding PCA [2].", "For simplicity, we compare a linear single layer Autoencoder with PCA. There are multiple algorithms for PCA modeling. One of them is estimation by minimizing reconstruction error (see [3]). Following this algorithm gives a clearer understanding of the similarities between a PCA and an Autoencoder.", "Figure 1 visualizes a single layer linear Autoencoder. As shown in the bottom of the figure, the Encoding process is similar to PC transformation. PC transformation is projecting the original data on the Principal Components to yield orthogonal features, called Principal Scores. Similarly, the Decoding process is similar to reconstructing the data from the Principal Scores. In both, Autoencoder and PCA, the model weights can be estimated by minimizing the reconstruction error.", "In the following, we will further elaborate Figure 1 by showcasing the key Autoencoder components and their equivalent in PCA.", "Suppose we have data with p features.", "Encoding \u2014 the projection of data on Principal Components.", "That is, for each Encoding node in 1,\u2026,k we have a p-dimensional weight vector. This is equivalent to an eigenvector in PCA.", "x is the input and W is the weight matrix. The function g is an activation function. g(Wx) is the output of the Encoding layer. If the activation is linear, this is equivalent to the Principal Scores in PCA.", "Decoding \u2014 reconstruction of data from the Principal Scores.", "and similarly, in PCA, it is reconstructed as,", "Note that, we have W\u2019 in Eq. 4 and W in Eq. 5. This is because, the weights on the Encoder and Decoder are not the same by default. The Decoder and PCA reconstructions will be the same if the Encoder and Decoder weights are tied, i.e.", "The multi-colors in the Decoder cells indicate that the weights in different cells in the Encoder are present in the same cell in the Decoder.", "This brings us to the mathematical comparisons between Autoencoder and PCA.", "Mathematically a Linear Autoencoder will be similar to PCA if,", "Here we will implement PCA and a typical unconstrained Autoencoder on a random dataset. We will show their outputs differ in every aspect discussed above. This results in a suboptimal Autoencoder. Post this discussion, we will show how we can constrain an Autoencoder for proper estimations (Part II).", "We generate multivariate correlated normal data. The steps for data generation are elaborated in the GitHub repository.", "The test dataset will be used in Part II to compare the Autoencoder reconstruction accuracy.", "We fit a single layer linear Autoencoder with encoding dimension as two. We also fit PCA with two components.", "Visually, the Encoder-Decoder structure developed here is shown in Figure 3 below. The figure helps understand how the Weight matrices are aligned.", "To follow the PCA properties, the Autoencoder in Figure 3 should follow conditions in Eq. 7a-d. Below, we will show that this conventional Autoencoder does not meet any of them.", "As we can see below, the weights on Encoder and Decoder are different.", "As shown below, unlike PCA weights (i.e. the eigenvectors), the weights on Encoder and Decoder are not orthogonal.", "In PCA, the features are uncorrelated.", "But the Encoded features are correlated.", "Weight non-orthogonality and features correlations are undesirable because it brings redundancy in information contained within the Encoded features.", "The unit norm for PCA weights is 1. This is a constraint applied in PCA estimation to yield a proper estimate.", "The complete code is available here.", "As such, an Autoencoder model is ill-posed. An ill-posed model does not have robust estimates. This adversely affects its test accuracy, i.e. reconstruction error on a new data.", "Several recent research advancements are building and utilizing orthogonality conditions to improve Deep Learning model performance. Refer to [4] and [5] for some research directions.", "In the sequel, Part II, we will implement custom constraints to incorporate the abovementioned properties derived from PCA into Autoencoders. We will see that adding the constraints improves the test reconstruction error.", "Go to the sequel, Part II.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Director of Science at ProcessMiner | Book Author | www.understandingdeeplearning.com"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F1f01f821999b&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuild-the-right-autoencoder-tune-and-optimize-using-pca-principles-part-i-1f01f821999b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuild-the-right-autoencoder-tune-and-optimize-using-pca-principles-part-i-1f01f821999b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuild-the-right-autoencoder-tune-and-optimize-using-pca-principles-part-i-1f01f821999b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuild-the-right-autoencoder-tune-and-optimize-using-pca-principles-part-i-1f01f821999b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----1f01f821999b--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----1f01f821999b--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://cranjan.medium.com/?source=post_page-----1f01f821999b--------------------------------", "anchor_text": ""}, {"url": "https://cranjan.medium.com/?source=post_page-----1f01f821999b--------------------------------", "anchor_text": "Chitta Ranjan"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F1c9fae27a83&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuild-the-right-autoencoder-tune-and-optimize-using-pca-principles-part-i-1f01f821999b&user=Chitta+Ranjan&userId=1c9fae27a83&source=post_page-1c9fae27a83----1f01f821999b---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F1f01f821999b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuild-the-right-autoencoder-tune-and-optimize-using-pca-principles-part-i-1f01f821999b&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F1f01f821999b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuild-the-right-autoencoder-tune-and-optimize-using-pca-principles-part-i-1f01f821999b&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://medium.com/@cran2367/build-the-right-autoencoder-tune-and-optimize-using-pca-principles-part-ii-24b9cca69bd6", "anchor_text": "Part II"}, {"url": "https://www.understandingdeeplearning.com", "anchor_text": "Understanding Deep Learning"}, {"url": "https://medium.com/@cran2367/build-the-right-autoencoder-tune-and-optimize-using-pca-principles-part-ii-24b9cca69bd6", "anchor_text": "Part II"}, {"url": "https://blog.keras.io/building-autoencoders-in-keras.html", "anchor_text": "Building Autoencoders in Keras"}, {"url": "https://medium.com/@cran2367/build-the-right-autoencoder-tune-and-optimize-using-pca-principles-part-ii-24b9cca69bd6", "anchor_text": "Part II"}, {"url": "https://towardsdatascience.com/build-the-right-autoencoder-tune-and-optimize-using-pca-principles-part-ii-24b9cca69bd6", "anchor_text": "Part II"}, {"url": "https://medium.com/@aptrishu/understanding-principle-component-analysis-e32be0253ef0", "anchor_text": "Understanding PCA"}, {"url": "https://www.cs.cmu.edu/~mgormley/courses/10701-f16/slides/lecture14-pca.pdf", "anchor_text": "3"}, {"url": "https://medium.com/@cran2367/build-the-right-autoencoder-tune-and-optimize-using-pca-principles-part-ii-24b9cca69bd6", "anchor_text": "Part II"}, {"url": "https://github.com/cran2367/pca-autoencoder-relationship/blob/master/pca-autoencoder-relationship.ipynb", "anchor_text": "here"}, {"url": "https://github.com/cran2367/pca-autoencoder-relationship/blob/master/pca-autoencoder-relationship.ipynb", "anchor_text": "GitHub repository"}, {"url": "https://medium.com/@cran2367/build-the-right-autoencoder-tune-and-optimize-using-pca-principles-part-ii-24b9cca69bd6", "anchor_text": "Part II"}, {"url": "https://github.com/cran2367/pca-autoencoder-relationship/blob/master/pca-autoencoder-relationship.ipynb", "anchor_text": "Github Repository"}, {"url": "https://github.com/cran2367/pca-autoencoder-relationship/blob/master/pca-autoencoder-relationship.ipynb", "anchor_text": "here"}, {"url": "https://github.com/cran2367/pca-autoencoder-relationship/blob/master/pca-autoencoder-relationship.ipynb", "anchor_text": "cran2367/pca-autoencoder-relationshipUnderstand the relationship between PCA and autoencoder - cran2367/pca-autoencoder-relationshipgithub.com"}, {"url": "https://arxiv.org/pdf/1709.06079.pdf", "anchor_text": "4"}, {"url": "https://arxiv.org/pdf/1609.07093.pdf", "anchor_text": "5"}, {"url": "https://medium.com/@cran2367/build-the-right-autoencoder-tune-and-optimize-using-pca-principles-part-ii-24b9cca69bd6", "anchor_text": "Part II"}, {"url": "https://medium.com/@cran2367/build-the-right-autoencoder-tune-and-optimize-using-pca-principles-part-ii-24b9cca69bd6", "anchor_text": "Go to the sequel, Part II."}, {"url": "https://blog.keras.io/building-autoencoders-in-keras.html", "anchor_text": "Building Autoencoders in Keras"}, {"url": "https://medium.com/@aptrishu/understanding-principle-component-analysis-e32be0253ef0", "anchor_text": "Understanding Principal Component Analysis"}, {"url": "https://www.cs.cmu.edu/~mgormley/courses/10701-f16/slides/lecture14-pca.pdf", "anchor_text": "Principal Component Analysis: Algorithm using Reconstruction Error (Page 15)."}, {"url": "https://arxiv.org/pdf/1709.06079.pdf", "anchor_text": "Orthogonal weight normalization: Solution to optimization over multiple dependent stiefel manifolds in deep neural networks."}, {"url": "https://arxiv.org/pdf/1609.07093.pdf", "anchor_text": "Neural photo editing with introspective adversarial networks."}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----1f01f821999b---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----1f01f821999b---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/towards-data-science?source=post_page-----1f01f821999b---------------towards_data_science-----------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F1f01f821999b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuild-the-right-autoencoder-tune-and-optimize-using-pca-principles-part-i-1f01f821999b&user=Chitta+Ranjan&userId=1c9fae27a83&source=-----1f01f821999b---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F1f01f821999b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuild-the-right-autoencoder-tune-and-optimize-using-pca-principles-part-i-1f01f821999b&user=Chitta+Ranjan&userId=1c9fae27a83&source=-----1f01f821999b---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F1f01f821999b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuild-the-right-autoencoder-tune-and-optimize-using-pca-principles-part-i-1f01f821999b&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----1f01f821999b--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F1f01f821999b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuild-the-right-autoencoder-tune-and-optimize-using-pca-principles-part-i-1f01f821999b&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----1f01f821999b---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----1f01f821999b--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----1f01f821999b--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----1f01f821999b--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----1f01f821999b--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----1f01f821999b--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----1f01f821999b--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----1f01f821999b--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----1f01f821999b--------------------------------", "anchor_text": ""}, {"url": "https://cranjan.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://cranjan.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Chitta Ranjan"}, {"url": "https://cranjan.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "1.5K Followers"}, {"url": "http://www.understandingdeeplearning.com", "anchor_text": "www.understandingdeeplearning.com"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F1c9fae27a83&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuild-the-right-autoencoder-tune-and-optimize-using-pca-principles-part-i-1f01f821999b&user=Chitta+Ranjan&userId=1c9fae27a83&source=post_page-1c9fae27a83--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Ffa1c3bb004a0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuild-the-right-autoencoder-tune-and-optimize-using-pca-principles-part-i-1f01f821999b&newsletterV3=1c9fae27a83&newsletterV3Id=fa1c3bb004a0&user=Chitta+Ranjan&userId=1c9fae27a83&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}