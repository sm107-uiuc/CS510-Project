{"url": "https://towardsdatascience.com/koalas-ml-4807f2c56e98", "time": 1683013971.548828, "path": "towardsdatascience.com/koalas-ml-4807f2c56e98/", "webpage": {"metadata": {"title": "Machine Learning with Koalas and Spark | by MA Raza, Ph.D. | Towards Data Science", "h1": "Machine Learning with Koalas and Spark", "description": "Pandas is considered a de-facto data analysis library written in python. Most of the data scientists or machine learning engineers start with Pandas and Numpy before moving to other libraries. No\u2026"}, "outgoing_paragraph_urls": [{"url": "https://koalas.readthedocs.io/en/latest/?badge=latest", "anchor_text": "Koalas", "paragraph_index": 1}, {"url": "https://medium.com/analytics-vidhya/spark-ifying-pandas-databricks-koalas-with-google-colab-93028890db5", "anchor_text": "Spark-ifying Pandas: Databrick\u2019s Koalas with Google Colab", "paragraph_index": 1}, {"url": "https://medium.com/analytics-vidhya/getting-started-spark3-0-0-with-google-colab-9796d350d78", "anchor_text": "Getting Started Spark 3.0.0 in Google Colab", "paragraph_index": 4}, {"url": "https://archive.ics.uci.edu/ml/datasets/combined+cycle+power+plant", "anchor_text": "Combined Cycle Power Plant", "paragraph_index": 11}, {"url": "https://raw.githubusercontent.com/amjadraza/blogs-data/master/spark_ml/ccpp.csv", "anchor_text": "GitHub", "paragraph_index": 11}, {"url": "https://koalas.readthedocs.io/en/latest/?badge=latest", "anchor_text": "Koalas official documentation", "paragraph_index": 14}, {"url": "https://towardsdatascience.com/machine-learning-with-spark-f1dbc1363986", "anchor_text": "Machine Learning With Spark", "paragraph_index": 24}], "all_paragraphs": ["Pandas is considered a de-facto data analysis library written in python. Most of the data scientists or machine learning engineers start with Pandas and Numpy before moving to other libraries. No once can debate around the use of Pandas as a standard data processing library. There are a lot of benefits of using Pandas however one key bottleneck of Pandas API to adapt with distributed processing. Solutions like Modin and Dask solve this problem to some extent.", "When it comes to using distributed processing frameworks, Spark is the de-facto choice for professionals and large data processing hubs. Recently, Databricks\u2019s team open-sourced a library called Koalas to implemented the Pandas API with spark backend. This library is under active development and covering more than 60% of Pandas API. To read more about using Koalas, refer to my earlier article Spark-ifying Pandas: Databrick\u2019s Koalas with Google Colab.", "In this tutorial, I will walk you through to perform exploratory data analysis using Koalas and PySpark to build a regression model using the Spark distributed framework. There are a lot of benefits of using Koalas instead of Pandas API when dealing with large datasets. Some of the key points are", "The objective of this tutorial is to leverage the Spark backend for a complete machine learning development cycle using Koalas. The working google collaboratory will be embedded.", "As a first step, I configure the google colab runtime with spark installation. For details, readers may read my article Getting Started Spark 3.0.0 in Google Colab om medium.", "We will install the below programs", "you can install the LATEST version of Spark using the below set of commands.", "After installing the spark and Java, set the environment variables where Spark and Java are installed.", "Let us test the installation of spark in our google colab environment.", "After installing spark and making sure, it is working, we can now install the databrick\u2019s Koalas using pip.", "The standard practice for developing machine learning models is to perform the exploratory data analysis, perform feature engineering, and build a model. I will try to touch basis on the above point using Koalas. I believe most of the ML engineers/scientists use Pandas API to perform EDA and Feature engineering. I demonstrate the use of Koalas to do the job and use PySpark to build the model.", "I will use the Combined Cycle Power Plant data set to predict the net hourly electrical output (EP). I have uploaded the data to my GitHub so that users can reproduce the results.", "As a first step, I want to explore the given data, its distribution, and dependency using Koalas API. I will include a simple example to demonstrate the idea, users can extend it for the problem in-hand.", "Download the data and saved it locally", "Read the data using the Koalas read_csv method. To read more about the API follow the Koalas official documentation", "Just like Pandas, Koalas has a feature to plot data to understand the variables. In the below example, I plotted the original data and smoother versions of it. This example demonstrates the use of plot and rolling window methods", "Just like the above plotting, users can plot all the columns. See below command", "Plotting all columns using a moving average of 20 data points.", "The below command is to demonstrate the use of describe a method similar to in Pandas API.", "The feature engineering step usually comes in junction with EDA. Users prepare the features with an objective to have the most predictive and nicely distributed feature set. In this article, I will demonstrate the use of Koalas to perform feature engineering.", "To understand the relationship between different variables, paiprplot function seaborn is widely used. Use the below command to plot the pairplot of variables in the dataset. Since Seaborn does not support the Koala dataframe, users have to convert it into a pandas dataframe before calling pairplot.", "By looking at the above figure, we can see a lot of outliers and for some variable relationship with Target is not clear. To remove the outliers, the simplest solution is to calculate the moving average and I demonstrate that using Koalas.", "Looks like the 20-day moving average has a better relationship with the Target variable hence using the 20-day average features makes more sense.", "Once the EDA and Feature engineering done, it is time to build the predictive model. One of the benefits of using the Koalas dataframe is that users can create a Spark dataframe seamlessly. In the below section, I demonstrate the use of PySpark API to build and train Gradient Boosting Machines (GBM).", "Now, build the model using PySpark API. For more details on building models using PySpark refer to my article Machine Learning With Spark.", "Prepare the features compatible with PySpark models", "Create the tarin and test splits", "Converting prediction back to Koalas DataFrame", "Let us plot the actual and predictions from the model.", "Below is the working google colab notebook to recreate the tutorial. Give it a try and develop machine learning algorithms on top of the presented use of Koalas as Pandas replacement where possible.", "In this tutorial, I have demonstrated the use of Koalas to perform exploratory data analysis and feature engineering. For Pandas users, switching to Koalas is straight forward with the benefit of using Spark backend for distributed computations. Below the key points discussed", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Engineer | Data Scientist | ML Researcher | Educator"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F4807f2c56e98&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fkoalas-ml-4807f2c56e98&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fkoalas-ml-4807f2c56e98&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fkoalas-ml-4807f2c56e98&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fkoalas-ml-4807f2c56e98&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----4807f2c56e98--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----4807f2c56e98--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@amjadraza24?source=post_page-----4807f2c56e98--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@amjadraza24?source=post_page-----4807f2c56e98--------------------------------", "anchor_text": "MA Raza, Ph.D."}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F43f78dfb3de3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fkoalas-ml-4807f2c56e98&user=MA+Raza%2C+Ph.D.&userId=43f78dfb3de3&source=post_page-43f78dfb3de3----4807f2c56e98---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F4807f2c56e98&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fkoalas-ml-4807f2c56e98&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F4807f2c56e98&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fkoalas-ml-4807f2c56e98&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://koalas.readthedocs.io/en/latest/?badge=latest", "anchor_text": "Koalas"}, {"url": "https://medium.com/analytics-vidhya/spark-ifying-pandas-databricks-koalas-with-google-colab-93028890db5", "anchor_text": "Spark-ifying Pandas: Databrick\u2019s Koalas with Google Colab"}, {"url": "https://medium.com/analytics-vidhya/getting-started-spark3-0-0-with-google-colab-9796d350d78", "anchor_text": "Getting Started Spark 3.0.0 in Google Colab"}, {"url": "https://github.com/minrk/findspark", "anchor_text": "Findspark"}, {"url": "https://archive.ics.uci.edu/ml/datasets/combined+cycle+power+plant", "anchor_text": "Combined Cycle Power Plant"}, {"url": "https://raw.githubusercontent.com/amjadraza/blogs-data/master/spark_ml/ccpp.csv", "anchor_text": "GitHub"}, {"url": "https://koalas.readthedocs.io/en/latest/?badge=latest", "anchor_text": "Koalas official documentation"}, {"url": "https://towardsdatascience.com/machine-learning-with-spark-f1dbc1363986", "anchor_text": "Machine Learning With Spark"}, {"url": "https://spark.apache.org/docs/latest/ml-features.html", "anchor_text": "https://spark.apache.org/docs/latest/ml-features.html"}, {"url": "https://koalas.readthedocs.io/en/latest/?badge=latest", "anchor_text": "https://koalas.readthedocs.io/en/latest/?badge=latest"}, {"url": "https://towardsdatascience.com/machine-learning-with-spark-f1dbc1363986", "anchor_text": "https://towardsdatascience.com/machine-learning-with-spark-f1dbc1363986"}, {"url": "https://medium.com/analytics-vidhya/getting-started-spark3-0-0-with-google-colab-9796d350d78", "anchor_text": "https://medium.com/analytics-vidhya/getting-started-spark3-0-0-with-google-colab-9796d350d78"}, {"url": "https://medium.com/analytics-vidhya/spark-ifying-pandas-databricks-koalas-with-google-colab-93028890db5", "anchor_text": "https://medium.com/analytics-vidhya/spark-ifying-pandas-databricks-koalas-with-google-colab-93028890db5"}, {"url": "https://medium.com/tag/data-science?source=post_page-----4807f2c56e98---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/python?source=post_page-----4807f2c56e98---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/pyspark?source=post_page-----4807f2c56e98---------------pyspark-----------------", "anchor_text": "Pyspark"}, {"url": "https://medium.com/tag/koalas?source=post_page-----4807f2c56e98---------------koalas-----------------", "anchor_text": "Koalas"}, {"url": "https://medium.com/tag/databricks?source=post_page-----4807f2c56e98---------------databricks-----------------", "anchor_text": "Databricks"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F4807f2c56e98&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fkoalas-ml-4807f2c56e98&user=MA+Raza%2C+Ph.D.&userId=43f78dfb3de3&source=-----4807f2c56e98---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F4807f2c56e98&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fkoalas-ml-4807f2c56e98&user=MA+Raza%2C+Ph.D.&userId=43f78dfb3de3&source=-----4807f2c56e98---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F4807f2c56e98&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fkoalas-ml-4807f2c56e98&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----4807f2c56e98--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F4807f2c56e98&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fkoalas-ml-4807f2c56e98&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----4807f2c56e98---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----4807f2c56e98--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----4807f2c56e98--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----4807f2c56e98--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----4807f2c56e98--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----4807f2c56e98--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----4807f2c56e98--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----4807f2c56e98--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----4807f2c56e98--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@amjadraza24?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@amjadraza24?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "MA Raza, Ph.D."}, {"url": "https://medium.com/@amjadraza24/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "176 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F43f78dfb3de3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fkoalas-ml-4807f2c56e98&user=MA+Raza%2C+Ph.D.&userId=43f78dfb3de3&source=post_page-43f78dfb3de3--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F3cd60c3ab90f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fkoalas-ml-4807f2c56e98&newsletterV3=43f78dfb3de3&newsletterV3Id=3cd60c3ab90f&user=MA+Raza%2C+Ph.D.&userId=43f78dfb3de3&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}