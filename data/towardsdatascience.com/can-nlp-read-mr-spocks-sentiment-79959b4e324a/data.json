{"url": "https://towardsdatascience.com/can-nlp-read-mr-spocks-sentiment-79959b4e324a", "time": 1683004065.0648909, "path": "towardsdatascience.com/can-nlp-read-mr-spocks-sentiment-79959b4e324a/", "webpage": {"metadata": {"title": "Can NLP Read Mr Spock\u2019s Sentiment? | by Doug Foo | Towards Data Science", "h1": "Can NLP Read Mr Spock\u2019s Sentiment?", "description": "Do Vulcans express sentiment without emotion? With the power of Machine Learning, we can find out. We shall evaluate famous Spock Quotes using this (yet another) basic guide to Natural Language\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.nltk.org/", "anchor_text": "NLTK", "paragraph_index": 5}, {"url": "https://github.com/dougfoo/machineLearning/tree/master/nlp", "anchor_text": "here", "paragraph_index": 16}, {"url": "https://github.com/dougfoo/machineLearning/blob/master/nlp/nlp.py", "anchor_text": "nlp.py", "paragraph_index": 21}, {"url": "https://github.com/dougfoo/flaskml3/blob/master/app.py", "anchor_text": "here", "paragraph_index": 23}, {"url": "https://towardsdatascience.com/cross-platform-nlp-gui-on-flutter-75d59170864?source=---------2------------------", "anchor_text": "here", "paragraph_index": 23}, {"url": "http://foostack.ai/nlp", "anchor_text": "http://foostack.ai/nlp", "paragraph_index": 24}, {"url": "https://nlp.stanford.edu/sentiment/", "anchor_text": "https://nlp.stanford.edu/sentiment/", "paragraph_index": 27}, {"url": "https://link.medium.com/onbeDUAzL3", "anchor_text": "https://link.medium.com/onbeDUAzL3", "paragraph_index": 28}, {"url": "http://foostack.ai", "anchor_text": "foostack.ai", "paragraph_index": 30}], "all_paragraphs": ["Do Vulcans express sentiment without emotion? With the power of Machine Learning, we can find out. We shall evaluate famous Spock Quotes using this (yet another) basic guide to Natural Language Processing (NLP) and Sentiment Analysis (SA) methods.", "\u201cOnce you have eliminated the impossible, whatever remains, however improbable, must be the truth\u201d \u2014 Mr Spock & Sherlock Holmes", "The choice of training corpus is very significant. It needs labels and enough breadth and consistency to build a solid model. A few options I found (using google\u2019s new dataset search):", "I went with Twitter for reasons beyond logic. See examples below (typos, swearing, and all):", "Cleaning has a few major steps, most of which are kind of straightforward:", "In the real world, please use NLTK rather than writing your own!", "ML models only take numbers as input. The process of \u2018encoding\u2019 or \u2018embedding\u2019 text as numeric representations is a critical step. Two major methods exist (scalar word counts, and embedding matrices), the latter being state of art today.", "Scalar representation\u2014 A \u201cCount Vector\u201d approach to encoding is to have columns represent words (one column per unique word) and rows represent a sample sentence. The count of the # of occurrences of each word is stored in each column (very sparse, ie \u2014 mostly 0\u2019s per sample sentence given a vocab of 700k words). See examples (top table is a simple count, the bottom is weighted \u201ctfidf\u201d):", "The sentence \u201cLive long and prosper?\u201d (3rd row) is encoded with 0\u2019s for most columns, and a 1 for the \u201clong\u201d column since the word long occurs once. It is very simple. (2nd table is tfidf encoding which is also a word count but accounts for # times it is found in other sentences).", "Vector representations\u200a\u2014\u200aan \u201cembedding matrix\u201d (like Word2Vec[13] and GloVe [19]) is a more complex & powerful representation. Like\u00a0the\u00a0earlier\u00a0method, columns represent individual words (like Count Vectors), however the rows are not individual samples, but a fixed vector of (magic) numbers. The samples quotes are broken down and trained into the n-elem vector of \u201cword features\u201d. (10 elems in this case, while real systems have 50,100,300+ elems).", "The meaning of the #\u2019s is beyond this intro article (and most articles!) \u2014 in short it embeds contextual information that makes it quite powerful to do things like finding similar/related words. A few examples on a 100 dimension embedding trained on the 1.5m Twitter dataset:", "Next step train & detect: \u201cSpock must die\u201d \u2192 Pos/Neg Sentiment score ?!", "The training process takes the word embeddings from step 3, and uses them as input, along with the tweets and sentiment labels from step 1 to train a model. Using Logistic Regression is easiest to explain (which is just like a single layer Neural Network, or Perceptron, not to be confused w/ the Decepticons).", "The process of \u201ctraining\u201d the model sets a weight (value) for each feature (word) to minimize the model\u2019s incorrect guesses\u00a0as a\u00a0whole. It sets higher positive weights on words involved in positive scores, and vice versa. (It loosely follows Hebbian theory[11] of how brain synapses fire). Note the full model has 700k+ features (words), and evaluation of a sentence like \u201cLove is terribly illogical\u201d would activate a sentence/score calculation like the diagram above. Simple example using SKLearn:", "These SKLearn[14] models works great with simple CountVectors or Tfidf, but for a Word2Vec CBOW matrix\u200a\u2014\u200ayou really need a Neural Network with an embedding layer (trainable node per input word). You have to think about it a bit to understand why\u200a\u2014\u200ain CV/tfidf, features are unique words and training creates a table of each unique word \u2192 single value. In W2V each word \u2192 n-unique values, think of it like n-features per word (10 in my example, larger models have 100\u2019s). The amount of \u201cfeatures\u201d per word is what gives it power to find similarities etc.", "A shortcut method to use a W2V embedding into a simple model is to \u201csquash\u201d the words of a sentence by averaging the word vals into a single value like below:", "We could alternatively squash the 100 values per word into one average but that seems worse since you lose all the context info that the vectors hold. If you want to retain both feature dimensions you need a Neural Net with more weights. View the full source of the FooNLP package here.", "Look for more on a NN implementation with full w2v matrices next\u00a0month.", "It is almost impossible to get the best score on the 1st try. Science by its nature requires experimentation. Unless you are Dr. Manhattan and can see the future [20], or use AutoML you should plan to spend significant time here goofing with parameters to make sense of the results.", "Basic evaluation below is that each combination differs alot! some skew results more negative than others. \u201cFascinating\u2026\u201d as Mr Spock would say.", "Word2Vec can be resource intensive, with just 100 vectors on 1.5m tweets it has taken 15min to train a CBOW embedding & Logistic Regression Model. Even with plain Count Vectors it takes 6min to train. However I\u2019m doing this on a Ultra Portable Surface 6 at the airport \u2026 not quite the power of the U.S.S. Enterprise..", "FooStack gets satisfaction from putting the work into production. We plugged in our work wrapped in nlp.py to our existing Python REST app and presto \u2014 our customers now see a few more realtime sentiment scores (along w/ Azure, Google, etc). Mr Spock would be proud (in an emotionless way).", "Given the massive size of each serialized model (250mb for CV/Tfidf, 1.2gb for Word2Vec), and time to train, I pickled the models for 2 trimmed down models (w2v cbow w/ logistic regression, and tfidf w/ naive bayes).", "Full flask code is here. Prior article on building the Sentiment Analyzer here.", "If I paid my Azure bill you can see it in action at http://foostack.ai/nlp [Edit \u2014 down for maint \u2014 had major Azure deployment issues \u2026 and gave up! ]", "The conclusion based on this non-scientific study is that Spock is indeed an emotionless, sentiment-less, heartless being (ie, a Vulcan). Data shows a bit of skew towards negativity \u2014 perhaps human (emotional) social view is negative on lack of emotion!", "Look for my next article on Sentiment Analysis using Neural Networks and the legendary BERT architecture. Till next time, Live Long and Prosper!", "[4] Stanford Movie Sentiment data \u2014 https://nlp.stanford.edu/sentiment/", "[10] embedding matrix \u2014 \u201cEmbeddings: A Matrix of Meaning\u201d by Petuum, Inc. https://link.medium.com/onbeDUAzL3", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Tech Manager by Day, ML Hacker by Night \u2014 founder: foostack.ai"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F79959b4e324a&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcan-nlp-read-mr-spocks-sentiment-79959b4e324a&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcan-nlp-read-mr-spocks-sentiment-79959b4e324a&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcan-nlp-read-mr-spocks-sentiment-79959b4e324a&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcan-nlp-read-mr-spocks-sentiment-79959b4e324a&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----79959b4e324a--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----79959b4e324a--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://doug-foo.medium.com/?source=post_page-----79959b4e324a--------------------------------", "anchor_text": ""}, {"url": "https://doug-foo.medium.com/?source=post_page-----79959b4e324a--------------------------------", "anchor_text": "Doug Foo"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F1eddac375cb9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcan-nlp-read-mr-spocks-sentiment-79959b4e324a&user=Doug+Foo&userId=1eddac375cb9&source=post_page-1eddac375cb9----79959b4e324a---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F79959b4e324a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcan-nlp-read-mr-spocks-sentiment-79959b4e324a&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F79959b4e324a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcan-nlp-read-mr-spocks-sentiment-79959b4e324a&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://www.nltk.org/", "anchor_text": "NLTK"}, {"url": "https://github.com/dougfoo/machineLearning/tree/master/nlp", "anchor_text": "here"}, {"url": "https://github.com/dougfoo/machineLearning/blob/master/nlp/nlp.py", "anchor_text": "nlp.py"}, {"url": "https://github.com/dougfoo/flaskml3/blob/master/app.py", "anchor_text": "here"}, {"url": "https://towardsdatascience.com/cross-platform-nlp-gui-on-flutter-75d59170864?source=---------2------------------", "anchor_text": "here"}, {"url": "http://foostack.ai/'", "anchor_text": "http://foostack.ai/'"}, {"url": "http://foostack.ai/nlp", "anchor_text": "http://foostack.ai/nlp"}, {"url": "https://www.amazon.co.uk/Aquarius-Star-Emotions-Spock-Poster/dp/B009UG1RQG", "anchor_text": "Amazon"}, {"url": "https://commons.wikimedia.org/wiki/File:Leonard_Nimoy_Mr._Spock_Star_Trek.JPG", "anchor_text": "https://commons.wikimedia.org/wiki/File:Leonard_Nimoy_Mr._Spock_Star_Trek.JPG"}, {"url": "https://towardsdatascience.com/understanding-feature-engineering-part-3-traditional-methods-for-text-data-f6f7d70acd41", "anchor_text": "https://towardsdatascience.com/understanding-feature-engineering-part-3-traditional-methods-for-text-data-f6f7d70acd41"}, {"url": "https://towardsdatascience.com/beyond-word-embeddings-part-2-word-vectors-nlp-modeling-from-bow-to-bert-4ebd4711d0ec", "anchor_text": "https://towardsdatascience.com/beyond-word-embeddings-part-2-word-vectors-nlp-modeling-from-bow-to-bert-4ebd4711d0ec"}, {"url": "https://www.win.tue.nl/~mpechen/projects/smm/", "anchor_text": "http://thinknook.com/twitter-sentiment-analysis-training-corpus-dataset-2012-09-22/"}, {"url": "http://thinknook.com/twitter-sentiment-analysis-training-corpus-dataset-2012-09-22/", "anchor_text": "http://thinknook.com/twitter-sentiment-analysis-training-corpus-dataset-2012-09-22/"}, {"url": "https://nlp.stanford.edu/sentiment/", "anchor_text": "https://nlp.stanford.edu/sentiment/"}, {"url": "http://xplordat.com/2018/09/27/word-embeddings-and-document-vectors-part-1-similarity/", "anchor_text": "http://xplordat.com/2018/09/27/word-embeddings-and-document-vectors-part-1-similarity/"}, {"url": "https://datasetsearch.research.google.com/search?query=sentiment%20analysis&docid=0rbimuM78%2B%2Fk2mp2AAAAAA%3D%3D", "anchor_text": "https://datasetsearch.research.google.com/search?query=sentiment%20analysis&docid=0rbimuM78%2B%2Fk2mp2AAAAAA%3D%3D"}, {"url": "https://www.kaggle.com/yelp-dataset/yelp-dataset", "anchor_text": "https://www.kaggle.com/yelp-dataset/yelp-dataset"}, {"url": "https://data.world/crowdflower/sentiment-analysis-in-text", "anchor_text": "https://data.world/crowdflower/sentiment-analysis-in-text"}, {"url": "https://link.medium.com/onbeDUAzL3", "anchor_text": "https://link.medium.com/onbeDUAzL3"}, {"url": "https://en.wikipedia.org/wiki/Hebbian_theory", "anchor_text": "https://en.wikipedia.org/wiki/Hebbian_theory"}, {"url": "https://medium.com/datadriveninvestor/implementing-naive-bayes-for-sentiment-analysis-in-python-951fa8dcd928", "anchor_text": "https://medium.com/datadriveninvestor/implementing-naive-bayes-for-sentiment-analysis-in-python-951fa8dcd928"}, {"url": "https://radimrehurek.com/gensim/models/word2vec.html", "anchor_text": "://radimrehurek.com/gensim/models/word2vec.html"}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.feature_extraction.text.CountVectorizer.html", "anchor_text": "https://scikit-learn.org/stable/modules/generated/sklearn.feature_extraction.text.CountVectorizer.html"}, {"url": "https://towardsdatascience.com/cross-platform-nlp-gui-on-flutter-75d59170864?source=---------2------------------", "anchor_text": "https://towardsdatascience.com/cross-platform-nlp-gui-on-flutter-75d59170864?source=---------2------------------"}, {"url": "https://github.com/dougfoo/flaskml3/", "anchor_text": "https://github.com/dougfoo/flaskml3/"}, {"url": "https://github.com/dougfoo/machineLearning/tree/master/nlp", "anchor_text": "https://github.com/dougfoo/machineLearning/tree/master/nlp"}, {"url": "https://arxiv.org/pdf/1301.3781.pdf", "anchor_text": "https://arxiv.org/pdf/1301.3781.pdf"}, {"url": "https://papers.nips.cc/paper/5021-distributed-representations-of-words-and-phrases-and-their-compositionality.pdf", "anchor_text": "https://papers.nips.cc/paper/5021-distributed-representations-of-words-and-phrases-and-their-compositionality.pdf"}, {"url": "https://nlp.stanford.edu/projects/glove/", "anchor_text": "https://nlp.stanford.edu/projects/glove/"}, {"url": "https://en.wikipedia.org/wiki/Doctor_Manhattan", "anchor_text": "https://en.wikipedia.org/wiki/Doctor_Manhattan"}, {"url": "https://medium.com/tag/nlp?source=post_page-----79959b4e324a---------------nlp-----------------", "anchor_text": "NLP"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----79959b4e324a---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/sentiment-analysis?source=post_page-----79959b4e324a---------------sentiment_analysis-----------------", "anchor_text": "Sentiment Analysis"}, {"url": "https://medium.com/tag/word-embeddings?source=post_page-----79959b4e324a---------------word_embeddings-----------------", "anchor_text": "Word Embeddings"}, {"url": "https://medium.com/tag/word2vec?source=post_page-----79959b4e324a---------------word2vec-----------------", "anchor_text": "Word2vec"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F79959b4e324a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcan-nlp-read-mr-spocks-sentiment-79959b4e324a&user=Doug+Foo&userId=1eddac375cb9&source=-----79959b4e324a---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F79959b4e324a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcan-nlp-read-mr-spocks-sentiment-79959b4e324a&user=Doug+Foo&userId=1eddac375cb9&source=-----79959b4e324a---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F79959b4e324a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcan-nlp-read-mr-spocks-sentiment-79959b4e324a&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----79959b4e324a--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F79959b4e324a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcan-nlp-read-mr-spocks-sentiment-79959b4e324a&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----79959b4e324a---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----79959b4e324a--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----79959b4e324a--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----79959b4e324a--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----79959b4e324a--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----79959b4e324a--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----79959b4e324a--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----79959b4e324a--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----79959b4e324a--------------------------------", "anchor_text": ""}, {"url": "https://doug-foo.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://doug-foo.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Doug Foo"}, {"url": "https://doug-foo.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "1.2K Followers"}, {"url": "http://foostack.ai", "anchor_text": "foostack.ai"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F1eddac375cb9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcan-nlp-read-mr-spocks-sentiment-79959b4e324a&user=Doug+Foo&userId=1eddac375cb9&source=post_page-1eddac375cb9--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F195f71a45f20&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcan-nlp-read-mr-spocks-sentiment-79959b4e324a&newsletterV3=1eddac375cb9&newsletterV3Id=195f71a45f20&user=Doug+Foo&userId=1eddac375cb9&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}