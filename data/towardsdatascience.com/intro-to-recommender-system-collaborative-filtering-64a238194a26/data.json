{"url": "https://towardsdatascience.com/intro-to-recommender-system-collaborative-filtering-64a238194a26", "time": 1682994142.22112, "path": "towardsdatascience.com/intro-to-recommender-system-collaborative-filtering-64a238194a26/", "webpage": {"metadata": {"title": "Introduction to Recommender System | by Shuyu Luo | Towards Data Science", "h1": "Introduction to Recommender System", "description": "Like many machine learning techniques, a recommender system makes prediction based on users\u2019 historical behaviors. Specifically, it\u2019s to predict user preference for a set of items based on past\u2026"}, "outgoing_paragraph_urls": [], "all_paragraphs": ["\u201cWe are leaving the age of information and entering the age of recommendation.\u201d", "Like many machine learning techniques, a recommender system makes prediction based on users\u2019 historical behaviors. Specifically, it\u2019s to predict user preference for a set of items based on past experience. To build a recommender system, the most two popular approaches are Content-based and Collaborative Filtering.", "Content-based approach requires a good amount of information of items\u2019 own features, rather than using users\u2019 interactions and feedbacks. For example, it can be movie attributes such as genre, year, director, actor etc., or textual content of articles that can extracted by applying Natural Language Processing. Collaborative Filtering, on the other hand, doesn\u2019t need anything else except users\u2019 historical preference on a set of items. Because it\u2019s based on historical data, the core assumption here is that the users who have agreed in the past tend to also agree in the future. In terms of user preference, it usually expressed by two categories. Explicit Rating, is a rate given by a user to an item on a sliding scale, like 5 stars for Titanic. This is the most direct feedback from users to show how much they like an item. Implicit Rating, suggests users preference indirectly, such as page views, clicks, purchase records, whether or not listen to a music track, and so on. In this article, I will take a close look at collaborative filtering that is a traditional and powerful tool for recommender systems.", "The standard method of Collaborative Filtering is known as Nearest Neighborhood algorithm. There are user-based CF and item-based CF. Let\u2019s first look at User-based CF. We have an n \u00d7 m matrix of ratings, with user u\u1d62, i = 1, ...n and item p\u2c7c, j=1, \u2026m. Now we want to predict the rating r\u1d62\u2c7c if target user i did not watch/rate an item j. The process is to calculate the similarities between target user i and all other users, select the top X similar users, and take the weighted average of ratings from these X users with similarities as weights.", "While different people may have different baselines when giving ratings, some people tend to give high scores generally, some are pretty strict even though they are satisfied with items. To avoid this bias, we can subtract each user\u2019s average rating of all items when computing weighted average, and add it back for target user, shown as below.", "Two ways to calculate similarity are Pearson Correlation and Cosine Similarity.", "Basically, the idea is to find the most similar users to your target user (nearest neighbors) and weight their ratings of an item as the prediction of the rating of this item for target user.", "Without knowing anything about items and users themselves, we think two users are similar when they give the same item similar ratings . Analogously, for Item-based CF, we say two items are similar when they received similar ratings from a same user. Then, we will make prediction for a target user on an item by calculating weighted average of ratings on most X similar items from this user. One key advantage of Item-based CF is the stability which is that the ratings on a given item will not change significantly overtime, unlike the tastes of human beings.", "There are quite a few limitations of this method. It doesn\u2019t handle sparsity well when no one in the neighborhood rated an item that is what you are trying to predict for target user. Also, it\u2019s not computational efficient as the growth of the number of users and products.", "Since sparsity and scalability are the two biggest challenges for standard CF method, it comes a more advanced method that decompose the original sparse matrix to low-dimensional matrices with latent factors/features and less sparsity. That is Matrix Factorization.", "Beside solving the issues of sparsity and scalability, there\u2019s an intuitive explanation of why we need low-dimensional matrices to represent users\u2019 preference. A user gave good ratings to movie Avatar, Gravity, and Inception. They are not necessarily 3 separate opinions but showing that this users might be in favor of Sci-Fi movies and there may be many more Sci-Fi movies that this user would like. Unlike specific movies, latent features is expressed by higher-level attributes, and Sci-Fi category is one of latent features in this case. What matrix factorization eventually gives us is how much a user is aligned with a set of latent features, and how much a movie fits into this set of latent features. The advantage of it over standard nearest neighborhood is that even though two users haven\u2019t rated any same movies, it\u2019s still possible to find the similarity between them if they share the similar underlying tastes, again latent features.", "To see how a matrix being factorized, first thing to understand is Singular Value Decomposition(SVD). Based on Linear Algebra, any real matrix R can be decomposed into 3 matrices U, \u03a3, and V. Continuing using movie example, U is an n \u00d7 r user-latent feature matrix, V is an m \u00d7 r movie-latent feature matrix. \u03a3 is an r \u00d7 r diagonal matrix containing the singular values of original matrix, simply representing how important a specific feature is to predict user preference.", "To sort the values of \u03a3 by decreasing absolute value and truncate matrix \u03a3 to first k dimensions( k singular values), we can reconstruct the matrix as matrix A. The selection of k should make sure that A is able to capture the most of variance within the original matrix R, so that A is the approximation of R, A \u2248 R. The difference between A and R is the error that is expected to be minimized. This is exactly the thought of Principle Component Analysis.", "When matrix R is dense, U and V could be easily factorized analytically. However, a matrix of movie ratings is super sparse. Although there are some imputation methods to fill in missing values , we will turn to a programming approach to just live with those missing values and find factor matrices U and V. Instead of factorizing R via SVD, we are trying find U and V directly with the goal that when U and V multiplied back together the output matrix R\u2019 is the closest approximation of R and no more a sparse matrix. This numerical approximation is usually achieved with Non-Negative Matrix Factorization for recommender systems since there is no negative values in ratings.", "See the formula below. Looking at the predicted rating for specific user and item, item i is noted as a vector q\u1d62, and user u is noted as a vector p\u1d64 such that the dot product of these two vectors is the predicted rating for user u on item i. This value is presented in the matrix R\u2019 at row u and column i.", "How do we find optimal q\u1d62 and p\u1d64? Like most of machine learning task, a loss function is defined to minimize the cost of errors.", "r\u1d64\u1d62 is the true ratings from original user-item matrix. Optimization process is to find the optimal matrix P composed by vector p\u1d64 and matrix Q composed by vector q\u1d62 in order to minimize the sum square error between predicted ratings r\u1d64\u1d62\u2019 and the true ratings r\u1d64\u1d62. Also, L2 regularization has been added to prevent overfitting of user and item vectors. It\u2019s also quite common to add bias term which usually has 3 major components: average rating of all items \u03bc, average rating of item i minus \u03bc(noted as b\u1d64), average rating given by user u minus u(noted as b\u1d62).", "A few optimization algorithms have been popular to solve Non-Negative Factorization. Alternative Least Square is one of them. Since the loss function is non-convex in this case, there\u2019s no way to reach a global minimum, while it still can reach a great approximation by finding local minimums. Alternative Least Square is to hold user factor matrix constant, adjust item factor matrix by taking derivatives of loss function and setting it equal to 0, and then set item factor matrix constant while adjusting user factor matrix. Repeat the process by switching and adjusting matrices back and forth until convergence. If you apply Scikit-learn NMF model, you will see ALS is the default solver to use, which is also called Coordinate Descent. Pyspark also offers pretty neat decomposition packages that provides more tuning flexibility of ALS itself.", "Collaborative Filtering provides strong predictive power for recommender systems, and requires the least information at the same time. However, it has a few limitations in some particular situations.", "First, the underlying tastes expressed by latent features are actually not interpretable because there is no content-related properties of metadata. For movie example, it doesn\u2019t necessarily to be genre like Sci-Fi in my example. It can be how motivational the soundtrack is, how good the plot is, and so on. Collaborative Filtering is lack of transparency and explainability of this level of information.", "On the other hand, Collaborative Filtering is faced with cold start. When a new item coming in, until it has to be rated by substantial number of users, the model is not able to make any personalized recommendations . Similarly, for items from the tail that didn\u2019t get too much data, the model tends to give less weight on them and have popularity bias by recommending more popular items.", "It\u2019s usually a good idea to have ensemble algorithms to build a more comprehensive machine learning model such as combining content-based filtering by adding some dimensions of keywords that are explainable, but we should always consider the tradeoff between model/computational complexity and the effectiveness of performance improvement.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F64a238194a26&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintro-to-recommender-system-collaborative-filtering-64a238194a26&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintro-to-recommender-system-collaborative-filtering-64a238194a26&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintro-to-recommender-system-collaborative-filtering-64a238194a26&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintro-to-recommender-system-collaborative-filtering-64a238194a26&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----64a238194a26--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----64a238194a26--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@shuyuluo?source=post_page-----64a238194a26--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@shuyuluo?source=post_page-----64a238194a26--------------------------------", "anchor_text": "Shuyu Luo"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fcb3ccfd3ef9d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintro-to-recommender-system-collaborative-filtering-64a238194a26&user=Shuyu+Luo&userId=cb3ccfd3ef9d&source=post_page-cb3ccfd3ef9d----64a238194a26---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F64a238194a26&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintro-to-recommender-system-collaborative-filtering-64a238194a26&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F64a238194a26&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintro-to-recommender-system-collaborative-filtering-64a238194a26&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://dzone.com/articles/recommendation-engine-models", "anchor_text": "https://dzone.com/articles/recommendation-engine-models"}, {"url": "https://medium.com/tiket-com-dev-team/build-recommendation-engine-using-graph-cbd6d8732e46", "anchor_text": "https://medium.com/tiket-com-dev-team/build-recommendation-engine-using-graph-cbd6d8732e46"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----64a238194a26---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/recommender-systems?source=post_page-----64a238194a26---------------recommender_systems-----------------", "anchor_text": "Recommender Systems"}, {"url": "https://medium.com/tag/matrix-factorization?source=post_page-----64a238194a26---------------matrix_factorization-----------------", "anchor_text": "Matrix Factorization"}, {"url": "https://medium.com/tag/collaborative-filtering?source=post_page-----64a238194a26---------------collaborative_filtering-----------------", "anchor_text": "Collaborative Filtering"}, {"url": "https://medium.com/tag/optimization?source=post_page-----64a238194a26---------------optimization-----------------", "anchor_text": "Optimization"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F64a238194a26&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintro-to-recommender-system-collaborative-filtering-64a238194a26&user=Shuyu+Luo&userId=cb3ccfd3ef9d&source=-----64a238194a26---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F64a238194a26&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintro-to-recommender-system-collaborative-filtering-64a238194a26&user=Shuyu+Luo&userId=cb3ccfd3ef9d&source=-----64a238194a26---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F64a238194a26&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintro-to-recommender-system-collaborative-filtering-64a238194a26&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----64a238194a26--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F64a238194a26&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintro-to-recommender-system-collaborative-filtering-64a238194a26&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----64a238194a26---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----64a238194a26--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----64a238194a26--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----64a238194a26--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----64a238194a26--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----64a238194a26--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----64a238194a26--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----64a238194a26--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----64a238194a26--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@shuyuluo?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@shuyuluo?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Shuyu Luo"}, {"url": "https://medium.com/@shuyuluo/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "749 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fcb3ccfd3ef9d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintro-to-recommender-system-collaborative-filtering-64a238194a26&user=Shuyu+Luo&userId=cb3ccfd3ef9d&source=post_page-cb3ccfd3ef9d--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F231ff047054b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintro-to-recommender-system-collaborative-filtering-64a238194a26&newsletterV3=cb3ccfd3ef9d&newsletterV3Id=231ff047054b&user=Shuyu+Luo&userId=cb3ccfd3ef9d&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}