{"url": "https://towardsdatascience.com/a-quick-comparison-of-causal-inference-estimates-d7995592025", "time": 1683006572.494484, "path": "towardsdatascience.com/a-quick-comparison-of-causal-inference-estimates-d7995592025/", "webpage": {"metadata": {"title": "A Quick Comparison of Causal-Inference Estimates | by Rumen Iliev | Towards Data Science", "h1": "A Quick Comparison of Causal-Inference Estimates", "description": "As an experimental behavioral scientist, I always thought that understanding the causal directionality of statistical relationships is at the heart of empirical science. I was trained in classical\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.york.ac.uk/depts/maths/histstat/images/latin_square.gif", "anchor_text": "Latin Square Design", "paragraph_index": 0}, {"url": "http://marcfbellemare.com/wordpress/wp-content/uploads/2019/08/BellemareBloemFDCAugust2019.pdf", "anchor_text": "front door criterion", "paragraph_index": 3}, {"url": "https://ftp.cs.ucla.edu/pub/stat_ser/R195-SS.pdf", "anchor_text": "back door criterion", "paragraph_index": 3}, {"url": "https://en.wikipedia.org/wiki/Instrumental_variables_estimation", "anchor_text": "instrumental variables", "paragraph_index": 3}, {"url": "https://en.wikipedia.org/wiki/Simpson%27s_paradox", "anchor_text": "Simpson\u2019s Paradox", "paragraph_index": 13}, {"url": "https://en.wikipedia.org/wiki/Curse_of_dimensionality", "anchor_text": "curse of dimensionality", "paragraph_index": 16}, {"url": "https://www.tandfonline.com/doi/abs/10.1080/00273171.2011.568786", "anchor_text": "this", "paragraph_index": 16}, {"url": "http://freerangestats.info/blog/2017/04/09/propensity-v-regression", "anchor_text": "this", "paragraph_index": 16}, {"url": "https://www.coursera.org/learn/crash-course-in-causality", "anchor_text": "https://www.coursera.org/learn/crash-course-in-causality", "paragraph_index": 39}], "all_paragraphs": ["As an experimental behavioral scientist, I always thought that understanding the causal directionality of statistical relationships is at the heart of empirical science. I was trained in classical experimental design, where the researcher is assumed to have full control over the environment and whose main worry is how to position different experimental conditions in time or space (e.g. Latin Square Design). Once you leave the safety of the controlled lab experiments, however, inferring causality becomes a major problem which easily jeopardizes the internal validity of your conclusions. Luckily, in the last few decades, there has been tremendous progress in research on statistical causality, both in theory and methods, and now causal inference is becoming a rather common tool in the toolbox of a data scientist. To catch up with current methods I did a quick review and I was somewhat surprised by the plethora of ways for estimating causal effects. In this project I will list the most common methods I found in the literature, apply them to a simplified causal problem, and compare the observed estimates. This comparison is intended as a brief high-level overview and not as a tutorial on causal inferences. For a brief introduction on the topic I recommend Pearl et al. (2016), and for an in-depth coverage an interested reader can check Pearl (2009), Morgan and Winship (2015) or Prof. Jason Roy\u2019s online class (Roy, 2020).", "When using statistical methods to infer causality, typically we are interested in the magnitude of the effect of cause X on an outcome Y. When we are only observing those variables, or if there are challenges with the randomization (e.g. selection bias), we will typically need to account for a broader set of variables. In Figure 1 I present a causal graph for a hypothetical example. The example includes the three main types of additional variables which help us to get an unbiased estimate: backdoor, front door and instrument variables.", "Figure 1. A hypothetical graphical causal model of cause X influencing outcome Y in the presence of other variables. The causal effect of X on Y can be estimated if we measure any of these three sets: {X, Y, BD}, {X, Y, IV}, or {X, Y, FD}", "Suppose that X is a binary variable indicating the effect of exercising at least weekly (x = 1 if exercising; x = 0 otherwise) and Y is life expectancy measured on a continuous scale. The effect of X on Y is fully mediated by a variable FD (front door criterion), which in our example might be a body mass index. Further, both Y and X are influenced by variable BD (back door criterion), which in our case could be some set of genetic factors, which do not affect FD directly. Last, X is also influenced by IV (instrumental variables), which for our illustration could be proximity to a sport facility.", "We can instantiate this causal graph with the following model:", "Model 1: Structural Causal Model instantiating the graphical model in Figure 1. The U components are normally distributed error terms (or inputs from exogenous variables) with mean 0 and SD = 2.", "For the purpose of the current simulation, I randomly generated 10,000 instances from Model 1 and in the next part, I will estimate the causal effect of X on Y using different statistical approaches.", "3. Naive estimate (Observing X and Y)", "A naive estimate of the causal effect of X on Y could simply be obtained from the regression coefficient of X predicting Y. In this example, the causal effect is b_naive = -0.97, surprisingly suggesting that exercise shortens life expectancy by almost one year.", "A naive estimate is useful when a researcher is convinced that there are no BD variables which need to be accounted for (e.g. when X is randomly assigned or as-if randomly assigned). With most observational studies and quasi-experimental designs, however, naive estimates are often not very useful.", "4. Back-door variable adjustment (Observing X, Y and BD)", "If in addition to X and Y you can also measure BD, you can compute an unbiased estimate of the causal effect of X on Y, avoiding the problems that naive estimates have. Here BD is just a single variable, but it could be a set of variables which satisfy the back-door criteria. When reviewing the literature I found the following five methods to estimate causal effects while adjusting for backdoor variables:", "One way to estimate the causal effect of X on Y is to run a regression model, predicting Y from X and including BD as a covariate. For most researchers who have training in linear regression but not in causal inferences, this is often the most intuitive approach.", "Applying this method to the data from our simulation we find that the causal effect of X on Y is b_covariates = 1.01. Based on this analysis, if you exercise you will live one year longer. Notice that this estimate is not only different than the naive estimate, the two estimates actually have opposite signs and lead to conflicting conclusions (check Simpson\u2019s Paradox)", "The covariates adjustment from above can also be accomplished by directly matching treatment and control participants on their BD scores. The main idea is that the matching procedure will remove the influence of BD on the causal estimate by only comparing control and treatment subjects who are already similar on their BD scores:", "When using this method we get b_direct_match = 1.05, which is very close to what we observed when using the covariates method.", "If you have multiple BD variables you need to account for, it might be very challenging to find good matches (check the curse of dimensionality). Instead, you can use propensity score matching, where you first compute the probability for being in the treatment group (a.k.a propensity score, check this paper or this blog post), and then match participants based on those probabilities.", "The causal effect is estimated to be b_ps_match = 1.05 which is virtually the same as the previous adjusting methods.", "4.4 Inverse Probability of Treatment Weighting", "You can also use weighted regression, where the weights are based on the probability of treatment. Control participants with high propensity scores and treatment participants with low propensity scores receive higher weights, adjusting for the treatment/control imbalance due to the BD variable(s).", "The estimate for the simulated data was b_iptw = 0.92, very close to the previous estimates.", "This is a more advanced method which allows more room for misspecification of the model. To get an unbiased estimate of the causal effect it is enough to correctly specify either the propensity score model or the outcome regression model.", "The causal effect is b_doubly_robust = 1.01, again very similar to the previous other adjustment methods.", "5. Instrumental variable (Observing X, Y and IV)", "What if you know that BD exists, but you cannot measure it? If you can measure variable IV instead, you still can estimate the causal effect of X on Y. This approach is known as the Instrumental Variable method, where the effect of the instrument IV on Y is mediated by X and can be used to estimate the effect of X on Y. A common method to run this analysis is called two-stage regression, where at the first stage we regress X on the instrument IV, and on the second stage, we regress the outcome Y on the residuals from the first stage.", "In our example, the instrumental variable method estimates the causal effect of X on Y to be b_iv = 0.96, very close to the BD adjustment methods.", "6. Front-door adjustment (Observing X, Y and FD)", "Even if we can measure neither IV nor BD, it is still possible to compute an unbiased estimate of the causal effect of X on Y. The front-door adjustment allows us to achieve this by measuring the effect of X on FD and FD on Y.", "Using front-door adjustment we estimate the causal effect of X on Y to be b_fd = 1.03.", "While I understand why some of the methods should return equivalent or very close estimates, I still find it both striking and somewhat perplexing that the causal effect of X and Y can be estimated in so many ways. To examine the agreement of the different methods I ran a series of simulations based on the causal graph from Figure 1. I used the same types of relations as the ones outlined in Model 1, but for each simulation, I randomly assigned a random regression coefficient, with absolute values ranging from 0.3 to 3. For reference, for the weaker relationship (coefficients set to 0.3) FD and BD together were explaining 8% of the variance in Y, and the stronger relationship (coefficients set to 3) they were explaining 68% of the variance (based on R\u00b2).", "Figure 2. Correlations between the causal effect estimates from the eight causal inference methods discussed here.", "I ran 2000 simulations, with 2000 rows each. For each simulation I computed eight different estimates of the causal effect of X on Y, using the methods listed above. Figure 2 depicts the agreement between the different methods. As can be seen in the figure, there is substantial agreement between the methods, with Pearson\u2019s correlations well above 0.9. The naive estimate is also positively correlated with the other methods, yet it often underestimates or overestimates the true causal effect.", "The goal of the current project was to provide a quick overarching example for the main methods for estimating causal effects and to demonstrate that those methods largely agree in their results. In its brevity, however, this example brushed over many important details, some of which I will need to mention explicitly:", "I found catching up with the field of causal inferences to be both challenging and exciting. To a novice, the field can seem fragmented, inconsistent and often focused on abstract theories rather than on applications. Yet beyond these initial impressions, it was fascinating to discover that both theories and methods gradually converge and provide researchers with a plethora of creative tools to use in their search for causality. Putting the most common of these tools together helped me to see the convergence of theories and methods and I hope it might be of help to other fellow researchers and data scientists.", "Austin, P. C. (2011). An introduction to propensity score methods for reducing the effects of confounding in observational studies. Multivariate behavioral research, 46(3), 399\u2013424.", "Bellemare, M. F., & Bloem, J. R. (2019). The Paper of How: Estimating Treatment Effects Using the Front-Door Criterion.", "Bound, J., Jaeger, D. A., & Baker, R. M. (1995). Problems with instrumental variables estimation when the correlation between the instruments and the endogenous explanatory variable is weak. Journal of the American statistical association, 90(430), 443\u2013450.", "Bound, J., Jaeger, D. A., & Baker, R. M. (1995). Problems with instrumental variables estimation when the correlation between the instruments and the endogenous explanatory variable is weak. Journal of the American statistical association, 90(430), 443\u2013450.", "Morgan, S. L., & Winship, C. (2015). Counterfactuals and causal inference. Cambridge University Press.", "Roy, J. (retrieved 2020, April 23) A Crash Course in Causality: Inferring Causal Effects from Observational Data. coursera.org, url: https://www.coursera.org/learn/crash-course-in-causality", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Diving deep in the overlap between Behavioral Science and Data Science."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fd7995592025&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-quick-comparison-of-causal-inference-estimates-d7995592025&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-quick-comparison-of-causal-inference-estimates-d7995592025&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-quick-comparison-of-causal-inference-estimates-d7995592025&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-quick-comparison-of-causal-inference-estimates-d7995592025&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----d7995592025--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----d7995592025--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@rumen.i.iliev?source=post_page-----d7995592025--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@rumen.i.iliev?source=post_page-----d7995592025--------------------------------", "anchor_text": "Rumen Iliev"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F33be5d3e528d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-quick-comparison-of-causal-inference-estimates-d7995592025&user=Rumen+Iliev&userId=33be5d3e528d&source=post_page-33be5d3e528d----d7995592025---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fd7995592025&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-quick-comparison-of-causal-inference-estimates-d7995592025&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fd7995592025&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-quick-comparison-of-causal-inference-estimates-d7995592025&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://www.shutterstock.com/g/Fascinadora", "anchor_text": "Fascinadora"}, {"url": "https://www.shutterstock.com/", "anchor_text": "shutterstock"}, {"url": "https://www.york.ac.uk/depts/maths/histstat/images/latin_square.gif", "anchor_text": "Latin Square Design"}, {"url": "http://marcfbellemare.com/wordpress/wp-content/uploads/2019/08/BellemareBloemFDCAugust2019.pdf", "anchor_text": "front door criterion"}, {"url": "https://ftp.cs.ucla.edu/pub/stat_ser/R195-SS.pdf", "anchor_text": "back door criterion"}, {"url": "https://en.wikipedia.org/wiki/Instrumental_variables_estimation", "anchor_text": "instrumental variables"}, {"url": "https://en.wikipedia.org/wiki/Simpson%27s_paradox", "anchor_text": "Simpson\u2019s Paradox"}, {"url": "https://en.wikipedia.org/wiki/Curse_of_dimensionality", "anchor_text": "curse of dimensionality"}, {"url": "https://www.tandfonline.com/doi/abs/10.1080/00273171.2011.568786", "anchor_text": "this"}, {"url": "http://freerangestats.info/blog/2017/04/09/propensity-v-regression", "anchor_text": "this"}, {"url": "https://egap.org/methods-guides/10-things-heterogeneous-treatment-effects", "anchor_text": "heterogeneous treatment effects"}, {"url": "https://www.coursera.org/learn/crash-course-in-causality", "anchor_text": "https://www.coursera.org/learn/crash-course-in-causality"}, {"url": "https://medium.com/tag/causality?source=post_page-----d7995592025---------------causality-----------------", "anchor_text": "Causality"}, {"url": "https://medium.com/tag/causal-inference?source=post_page-----d7995592025---------------causal_inference-----------------", "anchor_text": "Causal Inference"}, {"url": "https://medium.com/tag/backdoor?source=post_page-----d7995592025---------------backdoor-----------------", "anchor_text": "Backdoor"}, {"url": "https://medium.com/tag/frontdoor?source=post_page-----d7995592025---------------frontdoor-----------------", "anchor_text": "Frontdoor"}, {"url": "https://medium.com/tag/instrumental-variable?source=post_page-----d7995592025---------------instrumental_variable-----------------", "anchor_text": "Instrumental Variable"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fd7995592025&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-quick-comparison-of-causal-inference-estimates-d7995592025&user=Rumen+Iliev&userId=33be5d3e528d&source=-----d7995592025---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fd7995592025&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-quick-comparison-of-causal-inference-estimates-d7995592025&user=Rumen+Iliev&userId=33be5d3e528d&source=-----d7995592025---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fd7995592025&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-quick-comparison-of-causal-inference-estimates-d7995592025&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----d7995592025--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fd7995592025&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-quick-comparison-of-causal-inference-estimates-d7995592025&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----d7995592025---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----d7995592025--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----d7995592025--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----d7995592025--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----d7995592025--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----d7995592025--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----d7995592025--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----d7995592025--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----d7995592025--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@rumen.i.iliev?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@rumen.i.iliev?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Rumen Iliev"}, {"url": "https://medium.com/@rumen.i.iliev/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "10 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F33be5d3e528d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-quick-comparison-of-causal-inference-estimates-d7995592025&user=Rumen+Iliev&userId=33be5d3e528d&source=post_page-33be5d3e528d--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F6a59c6d69e13&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-quick-comparison-of-causal-inference-estimates-d7995592025&newsletterV3=33be5d3e528d&newsletterV3Id=6a59c6d69e13&user=Rumen+Iliev&userId=33be5d3e528d&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}