{"url": "https://towardsdatascience.com/practical-sql-select-case-when-7f62e628c96e", "time": 1683017952.779905, "path": "towardsdatascience.com/practical-sql-select-case-when-7f62e628c96e/", "webpage": {"metadata": {"title": "Practical SQL: Select Case When. Hands-on tutorial with MySQL | by Soner Y\u0131ld\u0131r\u0131m | Towards Data Science", "h1": "Practical SQL: Select Case When", "description": "SQL is used by most relational database management systems (RDBMS) to manage data stored in tabular form (i.e. tables). It is a fundamental skill expected from data scientists and analysts. You might\u2026"}, "outgoing_paragraph_urls": [{"url": "https://towardsdatascience.com/sql-queries-for-data-scientists-5260737fc442", "anchor_text": "select", "paragraph_index": 4}, {"url": "https://towardsdatascience.com/practical-sql-designing-and-creating-a-relational-database-de31c40b853f", "anchor_text": "sample sales database", "paragraph_index": 6}, {"url": "http://linkedin.com/in/soneryildirim/", "anchor_text": "linkedin.com/in/soneryildirim/", "paragraph_index": 26}, {"url": "http://twitter.com/snr14", "anchor_text": "twitter.com/snr14", "paragraph_index": 26}], "all_paragraphs": ["SQL is used by most relational database management systems (RDBMS) to manage data stored in tabular form (i.e. tables). It is a fundamental skill expected from data scientists and analysts.", "You might argue that it is the job of a data engineer but the data scientist roles are inclined to being full-stack. Besides, as a data scientist, you wouldn\u2019t want to depend on a data engineer to retrieve data from a database.", "Long story short, having SQL in your skill set will put you one step ahead in searching and securing a job in the field of data science.", "Databases usually contain very large amount of data. We do not need all the data for every task. Thus, we can either retrieve all the data and then filter what we need or only retrieve only what we need. The latter is obviously the better approach.", "We use the select statement to apply some conditions so that we only retrieve what is needed. There are many operators used with the select statement to enhance the filtering capabilities such as where, group by, having and so on.", "In this article, we will focus on a specific operator used along with the select statements. The case operator is a way to put conditions in the queries. It can be considered as a flow control function just like if/else in Python.", "I have previously created a sample sales database that consists of 4 relational tables. We will do the examples using these tables.", "Let us first take a look at the purchase table.", "I have selected only three columns of the purchase table. The columns show the item id and item quantity for each purchase.", "A typical task for the case operator can be classifying the purchases into two groups as purchases with single item and multiple items.", "The query result contains two columns. The first one is the purchase_id column. The second one is derived based on the item_qty column using the case operator. If the value in the item_qty column is greater than 1, the row in the derived column becomes \u201cmultiple items\u201d. Otherwise, it is \u201csingle item\u201d.", "Since we have created a new column using the case operator, we can use it in different operators or clauses. For instance, we may want to see the number of purchases in each group.", "We counted the number of purchases by using the derived column in the group by statement.", "Multiple conditions can be applied in the case operator. We will do an example on the item table in the sales database.", "Consider a case where we need to identify the items that cost higher than a certain amount and are sold at store 2.", "Since our focus is the expensive items at store 2, we do not case the other ones so those can be marked as null.", "If we don\u2019t want to display the null items, we can filter them out by adding the having statement as follows:", "The select statement of SQL is quite flexible and powerful. It can be combined with many additional statements, operators, and aggregations to create highly complex queries.", "I just want to give an example of using different functions with the select statement. Consider the customer table we have previously worked on. We want to sort the customers based on the length of their full names (first name and last name).", "Here is a way to accomplish this task:", "We first combine the first and last names by using the \u201cconcat\u201d function. Then the number of characters is counted with the \u201cchar_length\u201d function. The \u201corder by\u201d statement is used to sort the query results based on the derived name_len column.", "We have seen how the case operator can be implemented in the select statements. The case operator is one of the tools that are used to enhance the capabilities of the select statement.", "By creating complex queries, we can only retrieve the data we need instead of getting all the data and then applying filtering and calculations.", "Since real-life databases contain much more data and many relational tables, it is very important to be able to query the desired data using SQL.", "Thank you for reading. Please let me know if you have any feedback.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Scientist | Top 10 Writer in AI and Data Science | linkedin.com/in/soneryildirim/ | twitter.com/snr14"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F7f62e628c96e&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpractical-sql-select-case-when-7f62e628c96e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpractical-sql-select-case-when-7f62e628c96e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpractical-sql-select-case-when-7f62e628c96e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpractical-sql-select-case-when-7f62e628c96e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----7f62e628c96e--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----7f62e628c96e--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://sonery.medium.com/?source=post_page-----7f62e628c96e--------------------------------", "anchor_text": ""}, {"url": "https://sonery.medium.com/?source=post_page-----7f62e628c96e--------------------------------", "anchor_text": "Soner Y\u0131ld\u0131r\u0131m"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F2cf6b549448&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpractical-sql-select-case-when-7f62e628c96e&user=Soner+Y%C4%B1ld%C4%B1r%C4%B1m&userId=2cf6b549448&source=post_page-2cf6b549448----7f62e628c96e---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F7f62e628c96e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpractical-sql-select-case-when-7f62e628c96e&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F7f62e628c96e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpractical-sql-select-case-when-7f62e628c96e&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@evit?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Evi T."}, {"url": "https://unsplash.com/s/photos/if?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://towardsdatascience.com/sql-queries-for-data-scientists-5260737fc442", "anchor_text": "select"}, {"url": "https://towardsdatascience.com/practical-sql-designing-and-creating-a-relational-database-de31c40b853f", "anchor_text": "sample sales database"}, {"url": "https://medium.com/tag/data-science?source=post_page-----7f62e628c96e---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----7f62e628c96e---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----7f62e628c96e---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/sql?source=post_page-----7f62e628c96e---------------sql-----------------", "anchor_text": "Sql"}, {"url": "https://medium.com/tag/database?source=post_page-----7f62e628c96e---------------database-----------------", "anchor_text": "Database"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F7f62e628c96e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpractical-sql-select-case-when-7f62e628c96e&user=Soner+Y%C4%B1ld%C4%B1r%C4%B1m&userId=2cf6b549448&source=-----7f62e628c96e---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F7f62e628c96e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpractical-sql-select-case-when-7f62e628c96e&user=Soner+Y%C4%B1ld%C4%B1r%C4%B1m&userId=2cf6b549448&source=-----7f62e628c96e---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F7f62e628c96e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpractical-sql-select-case-when-7f62e628c96e&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----7f62e628c96e--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F7f62e628c96e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpractical-sql-select-case-when-7f62e628c96e&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----7f62e628c96e---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----7f62e628c96e--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----7f62e628c96e--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----7f62e628c96e--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----7f62e628c96e--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----7f62e628c96e--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----7f62e628c96e--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----7f62e628c96e--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----7f62e628c96e--------------------------------", "anchor_text": ""}, {"url": "https://sonery.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://sonery.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Soner Y\u0131ld\u0131r\u0131m"}, {"url": "https://sonery.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "21K Followers"}, {"url": "http://linkedin.com/in/soneryildirim/", "anchor_text": "linkedin.com/in/soneryildirim/"}, {"url": "http://twitter.com/snr14", "anchor_text": "twitter.com/snr14"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F2cf6b549448&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpractical-sql-select-case-when-7f62e628c96e&user=Soner+Y%C4%B1ld%C4%B1r%C4%B1m&userId=2cf6b549448&source=post_page-2cf6b549448--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F7cdf5377373a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpractical-sql-select-case-when-7f62e628c96e&newsletterV3=2cf6b549448&newsletterV3Id=7cdf5377373a&user=Soner+Y%C4%B1ld%C4%B1r%C4%B1m&userId=2cf6b549448&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}