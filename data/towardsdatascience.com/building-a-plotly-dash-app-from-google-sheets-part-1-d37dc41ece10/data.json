{"url": "https://towardsdatascience.com/building-a-plotly-dash-app-from-google-sheets-part-1-d37dc41ece10", "time": 1683014407.3016331, "path": "towardsdatascience.com/building-a-plotly-dash-app-from-google-sheets-part-1-d37dc41ece10/", "webpage": {"metadata": {"title": "Building a Plotly Dash App from Google Sheets \u2014 Part 1 | by Derrick Lewis | Towards Data Science", "h1": "Building a Plotly Dash App from Google Sheets \u2014 Part 1", "description": "Dashboards are still an incredibly popular task given to a data scientist or analyst in most firms. In a perfect world, you might connect to big streaming data pipeline or set up an individual Data\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.google.com/forms/about/", "anchor_text": "Google Form", "paragraph_index": 5}, {"url": "https://developers.google.com/apps-script/reference/maps/geocoder", "anchor_text": "Maps class", "paragraph_index": 10}, {"url": "http://willgeary.github.io/data/2016/11/04/Geocoding-with-Google-Sheets.html", "anchor_text": "Will Geary", "paragraph_index": 12}, {"url": "https://developers.google.com/docs/api/quickstart/python", "anchor_text": "Google Docs Quickstar", "paragraph_index": 18}, {"url": "https://cloud.google.com/iam/docs/understanding-service-accounts", "anchor_text": "Google Service Accounts", "paragraph_index": 19}, {"url": "https://medium.com/@denisluiz", "anchor_text": "Denis Luiz", "paragraph_index": 20}, {"url": "https://medium.com/@youngstone89/setting-up-environment-variables-in-mac-os-28e5941c771c", "anchor_text": "Great Tutorial here from \uae40\uc601\uc11d", "paragraph_index": 25}], "all_paragraphs": ["Dashboards are still an incredibly popular task given to a data scientist or analyst in most firms. In a perfect world, you might connect to big streaming data pipeline or set up an individual Data Warehouse with OLAP cubes to feed a complicated set of real time analytics. Then build some beautiful flexibility into the app for the business teams to use for ad-hoc numbers. Maybe you even add in some flare with a few prediction algorithms augmenting the data. That sounds like a lot of fun. This is not that dashboard.", "Alternatively, sometimes you need to build a dashboard around an existing set of processes and do very little to disturb the business. That\u2019s where this dashboard lands. The idea with this project is to support a team of field marketers working for a fictional bicycle company. Each marketer hosts physical events around the country and needs to report on the type, size and frequency to the head of marketing. Additionally, these metrics need to track the progress toward a bonus incentive given to the employees. This fictional big company is one with a lot of red-tape, departments inside of departments and an overworked IT team. So, the head of marketing is game for a very simple solution that can completed in a few days that doesn't require sitting in 3 budget meetings to be approved or training the field staff on a new tool.", "Enter Google Forms and Sheets. Rather than create another production level data store and web form to ingest data, we will use the simple, free and very familiar tools from Google. This allows for quick adjustment and editing of data by the team. And, as you\u2019ll see, Google has given access to some of the same code they use to build the G-Suite in order to make our own customized solutions.", "This project will be broken up into 4 parts.", "Before beginning dashboard and any app, we must first make a list of the important elements we will need to build it.", "To build this project, we are going to create a simple Google Form. These are handy for surveys and quick data entry and they allow for data validation such as dates and required responses just like a typical SQL db. Further, Google Forms will store each response in a Google Sheet which will act as our data source for the Dashboard app.", "Of the above requirements, nearly all can be handled natively in python fast enough to load an app. However, the best method to plot coordinates on a map in Plotly is to use latitude and longitude. I don\u2019t want to complicate the data entry for the marketing team by asking them to look up these coordinates when submitting a Google Form. And at this point I could not find a pre-built Google form solution to incorporate maps to allow for a \u201cDrop a Pin\u201d solution (Perhaps my next project idea?). I discovered that converting an address into coordinates requires calling an API in python and I would like to avoid that while our dashboard is loading.", "However, inside the Google suite of products, there is an internal API to make speedy calls for Longitude and Latitude. Next will write a script inside our new Google Sheet which will append the latitude and longitude to last column in the Google Sheet where the responses are stored.", "Google Apps Script is a very robust tool that allows you to build script functions to perform tasks that don\u2019t yet exist Google Sheets, Docs or Slides. The code.gs name is a clever twist on Node.js as the script language shares a lot with the look and feel of the javascript based language. This tool allows you to write custom functions into your spreadsheet (or ANY g-suite tool!) that can be used just like you use =SUM(A1:A5) in sheets. Or you could use it to connect to your Google Calendar to find meeting requests in a Google Doc. I don\u2019t write in javascript and have really never seen much of the code, but some basic understanding of code can allow you to get something up and running.", "The core of the Sheets scripting language is built on a few classes such as .sheet() or .range() or .cell() This allows the script to find specific information in the sheet, do some transform and return the new value to another specific location. Exactly what we are looking for.", "Further, there are many many classes to use other Google services such as Maps.newGeocoder() in the Maps class. With this class we can use robust Google Maps service right in the script to call for our latitude and longitude from very basic city or zipcode data.", "So, the first task to complete in order to prepare our data for the dashboard will be to run a script to insert the lat and lon.", "With the help of this tutorial from Will Geary, I was able to create a function in code.gs that looks for an address and inserts the lat/lon coordinates:", "If you are familiar with javascript you will likely find much cleaner or better way to write this code. In psuedo code, here is what this function does:", "The Logger.log is a great tool to test steps along the way and see that each varible is stored as it should be.", "The last step in Part 1 of our dashboard build is to configure the trigger to which will run this script. Google has made this super simple. The standard choice is to run the script when the file is opened or the data has been changed, but this only recognizes user changes, not changes made by a Google Form or another script. Simple enough, Google has also set up a specific trigger event based on a Form submission.", "Code.gs was a super cool tool to use here. It has so much potential and will help me in my actual job tremendously. If your company is already using the G-suite, work with your team\u2019s existing processes and add a few custom functions to help them along the way as an mvp step. Many sales teams will be storing their information big spreadsheets for single clients or projects and want just a little data help. Connect sheets with map functionality or email or calendar.", "Next we will look to connect our app directly to the real-time data in that Google Sheet.", "Initial searches led me to the Google Docs Quickstart page. While it is thorough and works great for applications you might run in the command line, it will not work for our ultimate goal of hosting this app on Heroku.", "A better solution is to use Google Service Accounts.", "Thankfully, another Medium post from Denis Luiz perfectly explains what we will we need to do here.", "I wouldn\u2019t be able to write the process better than above link. Instead I\u2019ll highlight the places I stumbled in the process and point out some slight deviations we will make for our app.", "2. Install the Google Client Library \u2014 Like many data science projects, I am using Anaconda as a package manager. I always try to use it to manage dependancies and install with pip as a last option after the other packages have been installed. Thankfully the packages needed to connect to the Google API are also included in Anaconda conda install -c conda-forge google-api-python-client google-auth-httplib2 google-auth-oauthlibUltimately, The packages will be downloaded with pip when we get to the final step loading the app to Heroku, but while I am testing I like to use Anaconda.", "3. Stringify the credentials \u2014 This is an important deviation from the Medium tutorial above if we are going to use the app with Heroku. Instead of the app looking for a credentials.json file in the current working directory, we are going to use set up an environment variable on our machine with the .json file as one big string and convert it to back to a json in our function.", "This is to keep us from passing credentials file and potentially exposing it. Heroku has a built in system to pass environment variables like this to our app in exactly the same way our local system does.", "For now, to test our project locally, we need to add these to .bashrc or .zshrc file. If you have not done this before: Great Tutorial here from \uae40\uc601\uc11d", "4. Find the Sheet ID of the data you will want to connect to. Repeat the steps above to create an environment variable for it as well.", "5. Last one, add the specific range you will need data from on your Sheet as an environment variable", "The first task in our Python code will be to call the Google Sheet API and create a Pandas DataFrame with the latest values.", "Pandas will allow us to do vast amount of manipulations on the data before creating charts and visuals, and will do that at speeds quick enough for this webpage.", "This function requires the three global variables we just mentioned to be defined about what the Google Sheet API should be looking for. In the final Dash App script we will define these ahead of the function above.", "Next, we add a simple function to convert the values from the spreadsheet into a Pandas DataFrame.", "Now we are ready to create a Plotly Dash App with the resulting data.", "Here we have completed the first part of building our Dashboard. We now have a process to get the latest data from our data store before we build a few visualizations and deploy the app to Heroku.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fd37dc41ece10&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-a-plotly-dash-app-from-google-sheets-part-1-d37dc41ece10&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-a-plotly-dash-app-from-google-sheets-part-1-d37dc41ece10&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-a-plotly-dash-app-from-google-sheets-part-1-d37dc41ece10&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-a-plotly-dash-app-from-google-sheets-part-1-d37dc41ece10&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----d37dc41ece10--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----d37dc41ece10--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://derrickjameslewis.medium.com/?source=post_page-----d37dc41ece10--------------------------------", "anchor_text": ""}, {"url": "https://derrickjameslewis.medium.com/?source=post_page-----d37dc41ece10--------------------------------", "anchor_text": "Derrick Lewis"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Ff4d893d1df69&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-a-plotly-dash-app-from-google-sheets-part-1-d37dc41ece10&user=Derrick+Lewis&userId=f4d893d1df69&source=post_page-f4d893d1df69----d37dc41ece10---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fd37dc41ece10&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-a-plotly-dash-app-from-google-sheets-part-1-d37dc41ece10&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fd37dc41ece10&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-a-plotly-dash-app-from-google-sheets-part-1-d37dc41ece10&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://medium.com/p/f35cea7f834c", "anchor_text": "Connect the Google Sheets Data to python"}, {"url": "https://medium.com/p/666c496c8a71", "anchor_text": "Build a Plotly Dash app"}, {"url": "https://www.google.com/forms/about/", "anchor_text": "Google Form"}, {"url": "https://developers.google.com/apps-script/reference", "anchor_text": "https://developers.google.com/apps-script/reference"}, {"url": "https://developers.google.com/apps-script/reference/maps/geocoder", "anchor_text": "Maps class"}, {"url": "http://willgeary.github.io/data/2016/11/04/Geocoding-with-Google-Sheets.html", "anchor_text": "Will Geary"}, {"url": "https://developers.google.com/docs/api/quickstart/python", "anchor_text": "Google Docs Quickstar"}, {"url": "https://cloud.google.com/iam/docs/understanding-service-accounts", "anchor_text": "Google Service Accounts"}, {"url": "https://medium.com/@denisluiz", "anchor_text": "Denis Luiz"}, {"url": "https://medium.com/@denisluiz/python-with-google-sheets-service-account-step-by-step-8f74c26ed28e", "anchor_text": "Python with Google Sheets Service Account: Step by StepA couple days ago I had my first experience with Google Sheets API. I though it would be an easy task but well\u2026 not.medium.com"}, {"url": "https://medium.com/@youngstone89/setting-up-environment-variables-in-mac-os-28e5941c771c", "anchor_text": "Great Tutorial here from \uae40\uc601\uc11d"}, {"url": "https://medium.com/@derrickjameslewis/building-a-plotly-dash-app-from-google-sheets-part-3-666c496c8a71", "anchor_text": "Building a Plotly Dash App from Google Sheets \u2014 Part 3So far we have created a free user friendly data store and connected to it through a Python APImedium.com"}, {"url": "https://medium.com/tag/data-science?source=post_page-----d37dc41ece10---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/plotly?source=post_page-----d37dc41ece10---------------plotly-----------------", "anchor_text": "Plotly"}, {"url": "https://medium.com/tag/dash?source=post_page-----d37dc41ece10---------------dash-----------------", "anchor_text": "Dash"}, {"url": "https://medium.com/tag/dashboard?source=post_page-----d37dc41ece10---------------dashboard-----------------", "anchor_text": "Dashboard"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fd37dc41ece10&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-a-plotly-dash-app-from-google-sheets-part-1-d37dc41ece10&user=Derrick+Lewis&userId=f4d893d1df69&source=-----d37dc41ece10---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fd37dc41ece10&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-a-plotly-dash-app-from-google-sheets-part-1-d37dc41ece10&user=Derrick+Lewis&userId=f4d893d1df69&source=-----d37dc41ece10---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fd37dc41ece10&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-a-plotly-dash-app-from-google-sheets-part-1-d37dc41ece10&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----d37dc41ece10--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fd37dc41ece10&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-a-plotly-dash-app-from-google-sheets-part-1-d37dc41ece10&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----d37dc41ece10---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----d37dc41ece10--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----d37dc41ece10--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----d37dc41ece10--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----d37dc41ece10--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----d37dc41ece10--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----d37dc41ece10--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----d37dc41ece10--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----d37dc41ece10--------------------------------", "anchor_text": ""}, {"url": "https://derrickjameslewis.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://derrickjameslewis.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Derrick Lewis"}, {"url": "https://derrickjameslewis.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "11 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Ff4d893d1df69&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-a-plotly-dash-app-from-google-sheets-part-1-d37dc41ece10&user=Derrick+Lewis&userId=f4d893d1df69&source=post_page-f4d893d1df69--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fusers%2Ff4d893d1df69%2Flazily-enable-writer-subscription&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-a-plotly-dash-app-from-google-sheets-part-1-d37dc41ece10&user=Derrick+Lewis&userId=f4d893d1df69&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}