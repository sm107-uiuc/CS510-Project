{"url": "https://towardsdatascience.com/space-science-with-python-a-very-bright-opposition-62e248abfe62", "time": 1683010998.9639812, "path": "towardsdatascience.com/space-science-with-python-a-very-bright-opposition-62e248abfe62/", "webpage": {"metadata": {"title": "Space Science with Python \u2014 A very bright Opposition | by Thomas Albin | Medium | Towards Data Science", "h1": "Space Science with Python \u2014 A very bright Opposition", "description": "This is the 19th part of my Python tutorial series \u201cSpace Science with Python\u201d. All codes that are shown here are uploaded on GitHub. Enjoy! Today, we will cover another brightness related topic: the\u2026"}, "outgoing_paragraph_urls": [{"url": "https://github.com/ThomasAlbin/SpaceScienceTutorial", "anchor_text": "GitHub", "paragraph_index": 0}, {"url": "https://numpy.org/", "anchor_text": "numpy", "paragraph_index": 12}, {"url": "https://matplotlib.org/", "anchor_text": "matplotlib", "paragraph_index": 12}], "all_paragraphs": ["This is the 19th part of my Python tutorial series \u201cSpace Science with Python\u201d. All codes that are shown here are uploaded on GitHub. Enjoy!", "Today, we will cover another brightness related topic: the computation and determination of the apparent magnitude of asteroids. We cover some more conceptual topics in the next article and then we will start with an asteroid related science project, coming with tutorial #20! If you need some information about the magnitude scale in astronomy, I would recommend to go first with my previous article:", "Did you take a look in the mirror this morning? Probably. But this space science article is not about your perception of yourself; it is about the laws of physics behind it. Plane mirrors and their reflective properties can easily be explained: Entrance Angle of the light = Exit Angle of the light. Done.", "But in space we do not have mirrors or simple geometries that allow us to compute the brightness of e.g., comets, meteors or asteroids. Most equations in this regard are empirically determined and are only valid within a certain solution space. In this article, we will continue with the topic that started some sessions ago: Asteroids.", "If you did not work in academia let me tell you one thing: every scientific project starts with literature work. What did others do? Is there already a solution for a certain complex \u201cniche\u201d problem? Where would you start to search for an \u201cequation or formula that is being used to compute the brightness of asteroids\u201d?", "This task can be challenging since tons of papers, conference proceedings, articles and books are being released every day. Further, if you do not work at the university of any research facility, you will not have access to certain journals. However, most researchers upload their papers on a pre-print server named arXiv (the X is pronounced like the Greek \u201cchi\u201d):", "Further, scientists try to improve the work of others. But are improvements correctly reviewed? Or are older empirical solutions sometimes better? In our case, we search for the so-called H-G magnitude/phase function defined by Bowell et al. (1989). This is an empirical function to compute the brightness of asteroids that are still being used today!", "Even newer versions, e.g., Muinonen et al. (2010), are less commonly known than the older H-G function [1].", "So where do we find the corresponding equation? Luckily, since the H-G function is commonly used it can be found in free accessible papers and articles, like here:", "So let\u2019s deep dive into the equation by extracting the relevant information for us:", "The H-G function provides the apparent/visual brightness V of an asteroid in magnitudes and it depends on:", "Let\u2019s take a look at the equation. As you can see, the distances to the Sun and Earth are embedded within a log10 function. Before, we have a so called reduced magnitude function H(\u237a), with \u237a being the mentioned phase angle. In fact, the function requires also the absolute magnitude H and the slope parameter G.", "Let\u2019s write this equation in Python and let\u2019s also provide a proper doc-string at the beginning. Today, we will only need the packages numpy and matplotlib. The reduced magnitude is another function that is called in line 29 (Part 2/6).", "So how does the phase angle depending reduced magnitude look like?", "The reduced magnitude depends on the absolute magnitude H and other functions that are embedded within log10. \ud835\udf19\u2081 and \ud835\udf19\u2082 are called phase functions and are scaled with the mentioned slope parameter G. Both functions have the same structure, but different coefficients. But first, let\u2019s code also this part in a second Python function:", "Again, the phase functions are similar, and have only different coefficients:", "We can now code both phase functions in one Python function. The coefficients are stored in dictionaries (line 22 to 23 and 25 to 26). The input parameter index is a string that corresponds to the index number as shown in the equation above.", "To keep things simple, let\u2019s compute one example with certain parameters to visualise, analyse and interpret a particular brightness curve. Instead of using SPICE kernels, let\u2019s set some hard coded parameters that correspond with the properties of the dwarf planet Ceres:", "Line 4 and 5 define a fixed distance between the object and the Sun (3.0 AU) and our home planet to the Sun (1.0 AU). Line 8 sets an absolute magnitude of 3.4 and the slope parameter G is set in line 9.", "What do we want to achieve? Well, since almost all parameters are fixed, we will plot the apparent magnitude vs. the phase angle. Here, the required phase angle is the angle as seen from the asteroid. First, let\u2019s set an array with phase angles between the Earth and the asteroid as seen from the Sun (line 13). Now, we can apply trigonometric functions, the compute the distance between the asteroid and Earth, depending on the angle between Earth and asteroid as seen from the Sun (line 17 to 19). Our home planet is fixed and we move the asteroid from 0 degrees to 45 degrees in 1000 steps. Using these results, we can compute the phase angle of the asteroid in line 23 to 24. Finally, in line 27 to 31, we call our apparent magnitude function and compute the phase angle corresponding brightness values.", "Now we can plot the results using matplotlib. We plot the magnitude vs. the phase angle as seen from the asteroid. For a better visualisation, we mirror the phase angles at 0 degrees. The resulting graph will become clearer (line 11 to 14). As already known from the previous tutorial session, we apply some formatting and label setting at the end.", "The resulting plot is shown below. You can see the apparent magnitude vs. the phase angle as seen from the asteroid in degrees. Please remember: a smaller magnitude value corresponds to a brighter object!", "Between 5 degrees and 15 degrees the magnitude changes almost linearly with the phase angle. The reason is quite obvious: a larger phase angle corresponds to a smaller illuminated area of the object as seen from the Earth, similar as the waning and waxing moon phases. However, between 0 and 5 degrees the brightness curve becomes steeper and the apparent magnitude does not follow a simple linear model.", "Is this an actual effect, or some modelling error, due to the empirical nature of the equation?", "What you see is the so called Opposition Effect or Opposition Surge. The brightness increases dramatically for very small phase angles and was also well observed and described by the Dawn mission that orbited the dwarf planet Ceres [2].", "The same effect can also be observed in our daily lives! Go to the beach and stand on the sand with the Sun in your back. Look down to the shadow of your head and you will see a bright halo around your head\u2019s shadow!", "How is this effect explainable? The reason for this effect results from the asteroid\u2019s surface properties (or the sand beach). The top layer is not smooth but has a layer of dust, small rocks, pebbles \u2026 so called regolith. This regolith particles cause a shadow when light shines down to the surface. However, the regolith particles are throwing shadows depending on the illumination angle. Like a tree, whose shadow is way longer during the evening hours (large phase angles) than during noon. Small phase angles, respectively a perpendicular illumination of the surface reduces the \u201cself-shadowing\u201d abruptly! The effective illuminated area increases and causes a sudden brightness surge for small phase angles.", "The shape of this surge between 5 and 0 degrees is defined by the slope parameter G. It is assumed that most asteroids have a value at around 0.15.", "It is up to you now. Get familiar with the H-G function and change the parameters. Check how the opposition surge changes for G=0.1 or G=0.5. Try to create an animation where you dynamically change several settings \u2026", "\u2026 or try to use actual orbit data of asteroids:", "In the last couple of weeks you learned several methods, tools and algorithms. Combine these things to generate new insights! The mixture of examples and basics / fundamental concepts should allow you to become a more and more independent citizen space scientist.", "Next time we will combine the H-G function with actual data and use sky maps. Afterwards, we will start with our asteroid science project! I hope you enjoyed today\u2019s lesson.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Scientist and Engineer. Astrophysicist and Solar System researcher \u2014 Now working in the automotive industry"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F62e248abfe62&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fspace-science-with-python-a-very-bright-opposition-62e248abfe62&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fspace-science-with-python-a-very-bright-opposition-62e248abfe62&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fspace-science-with-python-a-very-bright-opposition-62e248abfe62&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fspace-science-with-python-a-very-bright-opposition-62e248abfe62&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----62e248abfe62--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----62e248abfe62--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://thomas-albin.medium.com/?source=post_page-----62e248abfe62--------------------------------", "anchor_text": ""}, {"url": "https://thomas-albin.medium.com/?source=post_page-----62e248abfe62--------------------------------", "anchor_text": "Thomas Albin"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fe5af1ec51465&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fspace-science-with-python-a-very-bright-opposition-62e248abfe62&user=Thomas+Albin&userId=e5af1ec51465&source=post_page-e5af1ec51465----62e248abfe62---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F62e248abfe62&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fspace-science-with-python-a-very-bright-opposition-62e248abfe62&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F62e248abfe62&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fspace-science-with-python-a-very-bright-opposition-62e248abfe62&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://towardsdatascience.com/tagged/space-science-with-python", "anchor_text": "Space Science with Python"}, {"url": "https://towardsdatascience.com/tagged/space-science-with-python", "anchor_text": "tutorial series"}, {"url": "https://images.nasa.gov/details-PIA21079", "anchor_text": "NASA/JPL-Caltech/UCLA/MPS/DLR/IDA"}, {"url": "https://github.com/ThomasAlbin/SpaceScienceTutorial", "anchor_text": "GitHub"}, {"url": "https://towardsdatascience.com/space-science-with-python-bright-dots-in-the-dark-sky-73909507a0ca", "anchor_text": "Space Science with Python \u2014 Bright Dots in the Dark SkyPart 16 of the tutorial series describes another important basic concept in Space Science: the brightness of objects.towardsdatascience.com"}, {"url": "https://arxiv.org/", "anchor_text": "arXiv.orgarXiv is a free distribution service and an open-access archive for 1,732,878 scholarly articles in the fields of\u2026arxiv.org"}, {"url": "https://towardsdatascience.com/space-science-with-python-did-we-observe-everything-617a8221e750", "anchor_text": "Space Science with Python \u2014 Did we observe everything?Part 11 of the tutorial series is about a Data Scientist\u2019s and Space Scientist\u2019s nightmare: Statistical Bias!towardsdatascience.com"}, {"url": "https://numpy.org/", "anchor_text": "numpy"}, {"url": "https://matplotlib.org/", "anchor_text": "matplotlib"}, {"url": "https://ssd.jpl.nasa.gov/sbdb.cgi?sstr=Ceres", "anchor_text": "JPL Small-Body Database BrowserEdit descriptionssd.jpl.nasa.gov"}, {"url": "https://commons.wikimedia.org/wiki/File:Ceres_opposition_effect.png", "anchor_text": "Wikipedia"}, {"url": "https://towardsdatascience.com/space-science-with-python-supplements-for-papers-4876ec46b418", "anchor_text": "Space Science with Python \u2014 Supplements for PapersPart 10 of the tutorial series is a Supplementary Article on Supplementary Materials. How can we visualise\u2026towardsdatascience.com"}, {"url": "https://towardsdatascience.com/space-science-with-python-uncertain-movements-of-an-asteroid-f651b94f7008", "anchor_text": "Space Science with Python \u2014 Uncertain Movements of an AsteroidPart 17 of the tutorial series. Today (30th June) is Asteroid Day and we will start to deep dive into the science of\u2026towardsdatascience.com"}, {"url": "https://hal.archives-ouvertes.fr/hal-00676207/document", "anchor_text": "https://hal.archives-ouvertes.fr/hal-00676207/document"}, {"url": "https://medium.com/tag/python?source=post_page-----62e248abfe62---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/space?source=post_page-----62e248abfe62---------------space-----------------", "anchor_text": "Space"}, {"url": "https://medium.com/tag/science?source=post_page-----62e248abfe62---------------science-----------------", "anchor_text": "Science"}, {"url": "https://medium.com/tag/data-science?source=post_page-----62e248abfe62---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/space-science-with-python?source=post_page-----62e248abfe62---------------space_science_with_python-----------------", "anchor_text": "Space Science With Python"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F62e248abfe62&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fspace-science-with-python-a-very-bright-opposition-62e248abfe62&user=Thomas+Albin&userId=e5af1ec51465&source=-----62e248abfe62---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F62e248abfe62&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fspace-science-with-python-a-very-bright-opposition-62e248abfe62&user=Thomas+Albin&userId=e5af1ec51465&source=-----62e248abfe62---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F62e248abfe62&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fspace-science-with-python-a-very-bright-opposition-62e248abfe62&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----62e248abfe62--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F62e248abfe62&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fspace-science-with-python-a-very-bright-opposition-62e248abfe62&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----62e248abfe62---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----62e248abfe62--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----62e248abfe62--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----62e248abfe62--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----62e248abfe62--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----62e248abfe62--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----62e248abfe62--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----62e248abfe62--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----62e248abfe62--------------------------------", "anchor_text": ""}, {"url": "https://thomas-albin.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://thomas-albin.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Thomas Albin"}, {"url": "https://thomas-albin.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "432 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fe5af1ec51465&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fspace-science-with-python-a-very-bright-opposition-62e248abfe62&user=Thomas+Albin&userId=e5af1ec51465&source=post_page-e5af1ec51465--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fe56e0e06b404&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fspace-science-with-python-a-very-bright-opposition-62e248abfe62&newsletterV3=e5af1ec51465&newsletterV3Id=e56e0e06b404&user=Thomas+Albin&userId=e5af1ec51465&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}