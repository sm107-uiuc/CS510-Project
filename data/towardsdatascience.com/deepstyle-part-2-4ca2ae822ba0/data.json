{"url": "https://towardsdatascience.com/deepstyle-part-2-4ca2ae822ba0", "time": 1683011619.089189, "path": "towardsdatascience.com/deepstyle-part-2-4ca2ae822ba0/", "webpage": {"metadata": {"title": "DeepStyle (Part 2 ): The Fashion GAN | by Raymond Cheng | Towards Data Science", "h1": "DeepStyle (Part 2 ): The Fashion GAN", "description": "Part 2 Continued: Using DCGAN to generate realistic high-fashion clothing"}, "outgoing_paragraph_urls": [{"url": "https://towardsdatascience.com/deepstyle-f8557ab9e7b", "anchor_text": "Part 1", "paragraph_index": 0}, {"url": "https://github.com/itsuncheng/DeepStyle", "anchor_text": "github repo of this project", "paragraph_index": 2}, {"url": "https://pytorch.org/tutorials/beginner/dcgan_faces_tutorial.html", "anchor_text": "here", "paragraph_index": 8}, {"url": "https://github.com/itsuncheng/DeepStyle/blob/master/full_paper.pdf", "anchor_text": "paper", "paragraph_index": 21}, {"url": "https://github.com/itsuncheng/DeepStyle", "anchor_text": "my github repo", "paragraph_index": 21}, {"url": "https://www.linkedin.com/in/itsuncheng/", "anchor_text": "https://www.linkedin.com/in/itsuncheng/", "paragraph_index": 23}], "all_paragraphs": ["If you haven't read Part 1, please read it first since this article assumes you have read Part 1 already.", "Now assuming you have read Part 1, let\u2019s go on.", "After gathering the Pinterest database, now we can perform inference on these images using our previously trained Faster R-CNN. But before we do that, we need to first add the functionality where we will crop the detected object and save the resulting image, since this functionality is not provided right out of the box. You can do this by going to the github repo of this project and download the vis.py . Then, navigate to detectron/utils and replace the existing vis.py with the downloaded version. The new vis.py is the same with the one already provided but with one major difference \u2014 crop the object detected and save it in a directory.", "The added code predicts the category for the detected object, and if the category is \u201cFull\u201d meaning full-body clothing, then it will crop the image and save it in the directory specified. We only save full-body clothing because we want to be able to generate full-body clothing as well, not only simple shirts or skirts.", "After tiny modifications, we are ready to run our model on the Pinterest dataset! We can run inference on our Faster R-CNN previously trained by:", "The [path/to/image.jpg] is the directory where we store our Pinterest images, --rpn-pkl is where we previously saved our model .pkl file, --rpn-cfg is where we stored our configs file, and finally, --output-dir is where we want to save our predictions. However, this --output-dir is not that important as it will contain the uncropped images with the predictions. Where we want to look for is the directory we specified in vis.py because that\u2019s where the cropped images will be saved.", "After performing inference on the model, we should get the cropped images with the clothing centered, and the model, as well as the background, mostly removed. Even though there is still some noise, what we have is already good enough.", "Now that we finally have our high-quality clothing images, we can start building the DCGAN model!", "Note: The code is based on the official DCGAN tutorial from Pytorch where you access from here. The code won\u2019t be explained in too detail, you can refer to the tutorial for more detailed explanations.", "Let\u2019s begin. First we have to import all the necessary libraries:", "Next, we set up all the variables that we\u2019ll need later on:", "After setting up the variables, we now create the dataset and dataloader which we will feed into our model later. We resize the images, center crop them to the desired image size, and normalize them. Our image size is set to 64 because smaller sizes are normally more consistent.", "We also plot some training images to visualize:", "After that, we define the weights initialization on the generator and discriminator about the be built:", "Then we define the training process. We use BCELoss function because the job of the discriminator is identifying whether an image is real or fake. We setup Adam optimizers for both the generator and the discriminator. Then, we update both networks batch-by-batch:", "This will start the training process. The output is:", "The training process will take a while. After training, we can plot the generator and discriminator loss during training:", "Then after all this work, this is the last step \u2014 to save the images to local hard disk:", "And finally guys, after all this work! We get to see the generated results:", "Now we can plot and compare between the real images from our dataset and generated images, side-by-side.", "Not bad right? The fake images are not that far off from real images. In fact, some actually look quite high-fashion to my eyes \ud83d\ude01.", "And that\u2019s it guys! Hope you all enjoy my article and hope to see you again. Again, the entire code shown in this article as well as the paper I wrote can be accessed in my github repo! If you like my content, please follow me on Medium, I will post regularly about topics on deep learning!", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Master\u2019s Student at Carnegie Mellon, Top Writer in AI, Top 1000 Writer, Blogging on ML | Data Science | NLP. Linkedin: https://www.linkedin.com/in/itsuncheng/"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F4ca2ae822ba0&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeepstyle-part-2-4ca2ae822ba0&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeepstyle-part-2-4ca2ae822ba0&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeepstyle-part-2-4ca2ae822ba0&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeepstyle-part-2-4ca2ae822ba0&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----4ca2ae822ba0--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----4ca2ae822ba0--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://itsuncheng.medium.com/?source=post_page-----4ca2ae822ba0--------------------------------", "anchor_text": ""}, {"url": "https://itsuncheng.medium.com/?source=post_page-----4ca2ae822ba0--------------------------------", "anchor_text": "Raymond Cheng"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F4c697cd55840&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeepstyle-part-2-4ca2ae822ba0&user=Raymond+Cheng&userId=4c697cd55840&source=post_page-4c697cd55840----4ca2ae822ba0---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F4ca2ae822ba0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeepstyle-part-2-4ca2ae822ba0&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F4ca2ae822ba0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeepstyle-part-2-4ca2ae822ba0&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://towardsdatascience.com/deepstyle-f8557ab9e7b", "anchor_text": "Part 1"}, {"url": "https://towardsdatascience.com/deepstyle-f8557ab9e7b", "anchor_text": "DeepStyle: Using State-of-the-Art Deep Learning to Generate Realistic High Fashion Clothing and\u2026With paper and Github code providedtowardsdatascience.com"}, {"url": "https://github.com/itsuncheng/DeepStyle", "anchor_text": "github repo of this project"}, {"url": "https://pixabay.com/photos/fashion-show-fashion-catwalk-model-1746596/", "anchor_text": "Left Source"}, {"url": "https://pixabay.com/photos/fashion-show-fashion-catwalk-model-1746610/", "anchor_text": "Middle Source"}, {"url": "https://pixabay.com/photos/fashion-show-fashion-catwalk-model-1746592/", "anchor_text": "Right Source"}, {"url": "https://pixabay.com/photos/fashion-show-fashion-catwalk-model-1746610/", "anchor_text": "Source"}, {"url": "https://pytorch.org/tutorials/beginner/dcgan_faces_tutorial.html", "anchor_text": "Source"}, {"url": "https://pytorch.org/tutorials/beginner/dcgan_faces_tutorial.html", "anchor_text": "here"}, {"url": "https://github.com/itsuncheng/DeepStyle/blob/master/full_paper.pdf", "anchor_text": "paper"}, {"url": "https://github.com/itsuncheng/DeepStyle", "anchor_text": "my github repo"}, {"url": "https://github.com/facebookresearch/Detectron", "anchor_text": "facebookresearch/DetectronDetectron is deprecated. Please see detectron2, a ground-up rewrite of Detectron in PyTorch. Detectron is Facebook AI\u2026github.com"}, {"url": "https://arxiv.org/abs/1506.01497", "anchor_text": "Faster R-CNN: Towards Real-Time Object Detection with Region Proposal NetworksState-of-the-art object detection networks depend on region proposal algorithms to hypothesize object locations\u2026arxiv.org"}, {"url": "http://mmlab.ie.cuhk.edu.hk/projects/DeepFashion.html", "anchor_text": "DeepFashion DatabaseWe contribute DeepFashion database, a large-scale clothes database, which has several appealing properties: First\u2026mmlab.ie.cuhk.edu.hk"}, {"url": "https://cocodataset.org/#home", "anchor_text": "COCO - Common Objects in ContextEdit descriptioncocodataset.org"}, {"url": "https://arxiv.org/abs/1511.06434", "anchor_text": "Unsupervised Representation Learning with Deep Convolutional Generative Adversarial NetworksIn recent years, supervised learning with convolutional networks (CNNs) has seen huge adoption in computer vision\u2026arxiv.org"}, {"url": "https://pytorch.org/tutorials/beginner/dcgan_faces_tutorial.html", "anchor_text": "DCGAN Tutorial - PyTorch Tutorials 1.5.1 documentationThis tutorial will give an introduction to DCGANs through an example. We will train a generative adversarial network\u2026pytorch.org"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----4ca2ae822ba0---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----4ca2ae822ba0---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----4ca2ae822ba0---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/data-science?source=post_page-----4ca2ae822ba0---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/technology?source=post_page-----4ca2ae822ba0---------------technology-----------------", "anchor_text": "Technology"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F4ca2ae822ba0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeepstyle-part-2-4ca2ae822ba0&user=Raymond+Cheng&userId=4c697cd55840&source=-----4ca2ae822ba0---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F4ca2ae822ba0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeepstyle-part-2-4ca2ae822ba0&user=Raymond+Cheng&userId=4c697cd55840&source=-----4ca2ae822ba0---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F4ca2ae822ba0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeepstyle-part-2-4ca2ae822ba0&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----4ca2ae822ba0--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F4ca2ae822ba0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeepstyle-part-2-4ca2ae822ba0&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----4ca2ae822ba0---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----4ca2ae822ba0--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----4ca2ae822ba0--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----4ca2ae822ba0--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----4ca2ae822ba0--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----4ca2ae822ba0--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----4ca2ae822ba0--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----4ca2ae822ba0--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----4ca2ae822ba0--------------------------------", "anchor_text": ""}, {"url": "https://itsuncheng.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://itsuncheng.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Raymond Cheng"}, {"url": "https://itsuncheng.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "731 Followers"}, {"url": "https://www.linkedin.com/in/itsuncheng/", "anchor_text": "https://www.linkedin.com/in/itsuncheng/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F4c697cd55840&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeepstyle-part-2-4ca2ae822ba0&user=Raymond+Cheng&userId=4c697cd55840&source=post_page-4c697cd55840--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fa637a6d3749b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeepstyle-part-2-4ca2ae822ba0&newsletterV3=4c697cd55840&newsletterV3Id=a637a6d3749b&user=Raymond+Cheng&userId=4c697cd55840&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}