{"url": "https://towardsdatascience.com/pandas-dataframe-group-by-consecutive-certain-values-a6ed8e5d8cc", "time": 1683010353.2453601, "path": "towardsdatascience.com/pandas-dataframe-group-by-consecutive-certain-values-a6ed8e5d8cc/", "webpage": {"metadata": {"title": "Pandas DataFrame Group by Consecutive Certain Values | by Christopher Tao | Towards Data Science", "h1": "Pandas DataFrame Group by Consecutive Certain Values", "description": "Python Pandas DataFrame group by consecutive values, separate certain values appears in random arbitrary rows. Data Analytics, Data Analysis, Data Science"}, "outgoing_paragraph_urls": [], "all_paragraphs": ["It is very common that we want to segment a Pandas DataFrame by consecutive values. However, dealing with consecutive values is almost always not easy in any circumstances such as SQL, so does Pandas.", "Standard SQL provides a bunch of window functions to facilitate this kind of manipulation, but there are not too many window functions handy in Pandas. Fortunately, there are many workarounds in Python and sometimes make it even easier than classic window functions.", "In this article, I\u2019ll demonstrate how to group Pandas DataFrame by certain values that appear arbitrary times.", "If the title is sort of confused to you, the following sample data will make it clear. Let\u2019s create the sample DataFrame first.", "In this example, we want to segment the DataFrame for whatever number of consecutive values 0. The red square indicates that three segments are expected to be separated from this original DataFrame.", "What we are trying to do here is generally two:", "The first step is very easy, but apparently not the second. Let\u2019s have the intuitive steps before coding the solution.", "It is important to clarify that if we cum boolean values in Python, True will be treated as 1, whereas False will be treated as 0.", "I know, it might still be confusing. Let\u2019s have a look at the following DataFrame which is created for this intuition only, not as part of the solution though.", "The green rectangles show the expected groups of rows that we are expected to obtain.", "So, why do we need to perform a cumsum() on the inversed mask column here?", "After the intuition, you might think this is not easy. However, when you see the solution, you may laugh at how easy it is.", "We can verify whether the groups are correct or not.", "That\u2019s exactly what we expected :)", "Indeed, I wouldn\u2019t say that Pandas provides many useful window functions. However, Pandas in Python is a typical \u201cprogramming language\u201d not like SQL. So, it provides a lot more possibilities and sometimes can solve problems in even simpler ways.", "If you feel my articles are helpful, please consider joining Medium Membership to support me and thousands of other writers! (Click the link above)", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fa6ed8e5d8cc&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpandas-dataframe-group-by-consecutive-certain-values-a6ed8e5d8cc&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpandas-dataframe-group-by-consecutive-certain-values-a6ed8e5d8cc&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpandas-dataframe-group-by-consecutive-certain-values-a6ed8e5d8cc&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpandas-dataframe-group-by-consecutive-certain-values-a6ed8e5d8cc&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----a6ed8e5d8cc--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----a6ed8e5d8cc--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://qiuyujx.medium.com/?source=post_page-----a6ed8e5d8cc--------------------------------", "anchor_text": ""}, {"url": "https://qiuyujx.medium.com/?source=post_page-----a6ed8e5d8cc--------------------------------", "anchor_text": "Christopher Tao"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fb8176fabf308&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpandas-dataframe-group-by-consecutive-certain-values-a6ed8e5d8cc&user=Christopher+Tao&userId=b8176fabf308&source=post_page-b8176fabf308----a6ed8e5d8cc---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa6ed8e5d8cc&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpandas-dataframe-group-by-consecutive-certain-values-a6ed8e5d8cc&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa6ed8e5d8cc&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpandas-dataframe-group-by-consecutive-certain-values-a6ed8e5d8cc&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://pixabay.com/users/geralt-9301/", "anchor_text": "geralt"}, {"url": "https://pixabay.com/illustrations/pay-digit-number-fill-count-mass-1036469/", "anchor_text": "Pixabay"}, {"url": "https://pixabay.com/users/geralt-9301/", "anchor_text": "geralt"}, {"url": "https://pixabay.com/illustrations/problem-solution-help-support-3303396/", "anchor_text": "Pixabay"}, {"url": "https://pixabay.com/users/geralt-9301/", "anchor_text": "geralt"}, {"url": "https://pixabay.com/illustrations/board-font-chalk-enlightenment-953154/", "anchor_text": "Pixabay"}, {"url": "https://pixabay.com/users/qimono-1962238/", "anchor_text": "qimono"}, {"url": "https://pixabay.com/illustrations/key-keyhole-lock-security-unlock-2114046/", "anchor_text": "Pixabay"}, {"url": "https://pixabay.com/users/janjf93-3084263/", "anchor_text": "janjf93"}, {"url": "https://pixabay.com/vectors/desk-notes-notebook-album-write-2906792/", "anchor_text": "Pixabay"}, {"url": "https://medium.com/@qiuyujx/membership", "anchor_text": "Join Medium with my referral link \u2014 Christopher TaoAs a Medium member, a portion of your membership fee goes to writers you read, and you get full access to every story\u2026medium.com"}, {"url": "https://medium.com/tag/python?source=post_page-----a6ed8e5d8cc---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/pandas?source=post_page-----a6ed8e5d8cc---------------pandas-----------------", "anchor_text": "Pandas"}, {"url": "https://medium.com/tag/programming?source=post_page-----a6ed8e5d8cc---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/tag/artficial-intelligence?source=post_page-----a6ed8e5d8cc---------------artficial_intelligence-----------------", "anchor_text": "Artficial Intelligence"}, {"url": "https://medium.com/tag/technology?source=post_page-----a6ed8e5d8cc---------------technology-----------------", "anchor_text": "Technology"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fa6ed8e5d8cc&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpandas-dataframe-group-by-consecutive-certain-values-a6ed8e5d8cc&user=Christopher+Tao&userId=b8176fabf308&source=-----a6ed8e5d8cc---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fa6ed8e5d8cc&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpandas-dataframe-group-by-consecutive-certain-values-a6ed8e5d8cc&user=Christopher+Tao&userId=b8176fabf308&source=-----a6ed8e5d8cc---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa6ed8e5d8cc&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpandas-dataframe-group-by-consecutive-certain-values-a6ed8e5d8cc&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----a6ed8e5d8cc--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fa6ed8e5d8cc&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpandas-dataframe-group-by-consecutive-certain-values-a6ed8e5d8cc&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----a6ed8e5d8cc---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----a6ed8e5d8cc--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----a6ed8e5d8cc--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----a6ed8e5d8cc--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----a6ed8e5d8cc--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----a6ed8e5d8cc--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----a6ed8e5d8cc--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----a6ed8e5d8cc--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----a6ed8e5d8cc--------------------------------", "anchor_text": ""}, {"url": "https://qiuyujx.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://qiuyujx.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Christopher Tao"}, {"url": "https://qiuyujx.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "8.7K Followers"}, {"url": "https://www.linkedin.com/in/christopher-tao-5717a274/", "anchor_text": "https://www.linkedin.com/in/christopher-tao-5717a274/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fb8176fabf308&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpandas-dataframe-group-by-consecutive-certain-values-a6ed8e5d8cc&user=Christopher+Tao&userId=b8176fabf308&source=post_page-b8176fabf308--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F1d2af94a683f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpandas-dataframe-group-by-consecutive-certain-values-a6ed8e5d8cc&newsletterV3=b8176fabf308&newsletterV3Id=1d2af94a683f&user=Christopher+Tao&userId=b8176fabf308&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}