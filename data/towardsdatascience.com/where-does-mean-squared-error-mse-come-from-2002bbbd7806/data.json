{"url": "https://towardsdatascience.com/where-does-mean-squared-error-mse-come-from-2002bbbd7806", "time": 1683005288.683576, "path": "towardsdatascience.com/where-does-mean-squared-error-mse-come-from-2002bbbd7806/", "webpage": {"metadata": {"title": "Why use Mean Squared Error (MSE)? | by Rodrigo Castellon | Towards Data Science", "h1": "Why use Mean Squared Error (MSE)?", "description": "If you\u2019re interested in machine learning but have not dived deep into the probability theory behind it, you might wonder where loss functions come from. Are they only used because they work better in\u2026"}, "outgoing_paragraph_urls": [{"url": "http://cs109.stanford.edu", "anchor_text": "CS109 (Probability Theory for Computer Scientists from Stanford)", "paragraph_index": 1}, {"url": "https://www.youtube.com/watch?v=XepXtl9YKwc", "anchor_text": "this great video by the Youtube channel StatQuest", "paragraph_index": 5}, {"url": "https://www.khanacademy.org/math/ap-calculus-ab/ab-diff-analytical-applications-new/ab-5-4/a/applying-the-first-derivative-test-to-find-extrema", "anchor_text": "taking derivatives", "paragraph_index": 15}, {"url": "https://en.wikipedia.org/wiki/Gradient_descent", "anchor_text": "gradient ascent", "paragraph_index": 15}], "all_paragraphs": ["If you\u2019re interested in machine learning but have not dived deep into the probability theory behind it, you might wonder where loss functions come from. Are they only used because they work better in practice?", "I thought I\u2019d share an insight gleaned from CS109 (Probability Theory for Computer Scientists from Stanford), a course I\u2019ve recently gone through. We\u2019ll answer the following questions:", "A quick taste of the answer: it lies in the nature of our reasonable assumptions for how the data could be modeled.", "As you may know, machine learning is intertwined with probability, so we shall introduce some of the relevant concepts here.", "In much of machine learning, you aim to find the best model for your data (whether it is to find the best convnet that classifies images as containing a cat or a dog or some other model). A core concept behind this is maximum likelihood estimation.", "What is maximum likelihood estimation? We shall demonstrate with the following example (adapted from this great video by the Youtube channel StatQuest).", "Let\u2019s say you have a mystery normal distribution that points are being sampled from, and say it represents mouse weight.", "A slightly peculiar thing that statisticians do is to assume that data is sampled from some model. In this case, we can assume that this mouse weight data was sampled from a normal distribution. Now let\u2019s find it! (This may all seem very unrelated to saying something about MSE, but bear with me.)", "Intuitively you\u2019d want the normal distribution to peak around the center of the samples. And you\u2019d also want the normal distribution to spread out according to how far away the samples spread.", "So, you would not want something like this", "But you would want something like this", "It turns out there is a mathematical way of expressing how \u201cgood\u201d a model is (this section is important). We call this the likelihood of the data given the model. It can be expressed as below with the function L where theta is the model, i is the index for the sample, and f is the probability density function (PDF).", "Notice that within the function f the argument contains a bar |. This just means we\u2019re evaluating the function given that we are using the model theta.", "Likelihood essentially contains the product of the probability densities of all of the samples. In other words, an aggregate measure of how probable your dataset is given that you chose a specific model.", "Then, to find the best model, just take the \u201cargmax\u201d of it.", "Practically, this would involve taking derivatives if simple enough or doing some other optimization method such as gradient ascent if more complicated.", "Just to cement a bit of intuition about how likelihood works, consider the dataset where all the samples are x_i=5.0. Then, let\u2019s say your model is a normal distribution concentrated tightly around x=15. Then, the PDF f(x_i|theta) will be extremely small, and multiplying many small values will produce an extremely small value for likelihood.", "In contrast, consider the normal distribution concentrated tightly around x=5.0, exactly where the samples occur. Intuitively, this model should be a lot better than the previous one. Let\u2019s verify this with likelihood: the PDF f(x_i|theta) will be extremely large, and multiplying many large values will produce an extremely large value for likelihood. The better model has a higher likelihood, which coincides with our intuition.", "In practice, we actually modify the above expression for likelihood a bit. First, we take the log of likelihood. Why? Two main reasons:", "Since likelihood usually lies within 0 and 1, then log likelihood (denoted LL(theta)) would lie between negative infinity and 0.", "Now it\u2019s awkward to think about maximizing negative values, so we take the negative of this, call it (aptly named) \u201cnegative log likelihood,\u201d and instead minimize this. This typically becomes our conventional run-of-the-mill loss function we\u2019re all familiar with (cross entropy loss is just negative log likelihood in disguise, but this is a story for another time).", "Now we\u2019ll show where MSE comes from with a demonstrating example.", "To keep it simple, let\u2019s perform linear regression; i.e. finding the best-fit line.", "Now let\u2019s write out how we might model the data (in the mouse weight example, we assumed that it was generated via a normal distribution). This is exactly what leads to MSE.", "Let\u2019s assume that our data is sampled according to the following: given a certain value of X, Y is determined entirely by mx+b perturbed by a random sample from a normal distribution centered at 0 (where \u201cm\u201d is the slope and \u201cb\u201d is the y-intercept). This makes sense because it would be intuitive that given an X, the Y would not be quite always exactly mx+b, but somewhat noisy around mx+b (the real world gets in the way).", "Visually, you can imagine that our model is really just a bunch of normal distributions stacked in a diagonal direction, forming a mountain range-like appearance. For those math-inclined out there, our model can be expressed as", "where \u201cX\u201d is some variable, the parameters are \u201cm\u201d and \u201cb,\u201d and \u201cZ\u201d is some predetermined Gaussian with mean zero and some variance sigma\u00b2.", "Now we want to compute the likelihood for such a model (where the only parameter is theta=m). First, recall the definition of the PDF for a Gaussian:", "Now the likelihood for this model (we can omit the positive constant factor on the outside as it doesn\u2019t affect our optimization) is", "We obtain this simply by substituting our PDF for a Gaussian for the previous definition of likelihood.", "In practice, we want to obtain the negative log likelihood. So, after some algebra, the log likelihood is", "Voila! Negative log likelihood, the loss function we obtain from the assumption that the real data is normally distributed for given x\u2019s, is pretty much exactly mean squared error, which is", "Only off by a constant! Not bad.", "So this is the reason why mean squared error is such a common and great loss function; it is grounded in extremely reasonable probabilistic assumptions: that given the value of some independent variable(s) (a.k.a. some state of the world), the dependent variable(s) are distributed according to a Gaussian distribution. And, it is super clear now where the whole (y_i - y_pred)\u00b2 comes from: the exponentiated term in the PDF for a Gaussian distribution. I think this is a far better way to think about MSE than just simply \u201cwe use it because it is easy to differentiate\u201d (which is albeit somewhat true).", "If you start to generalize this to more complicated inference tasks, you can start to get real intuition for how MSE operates. For example, consider fitting a polynomial to a set of (x,y) points. You could imagine that up and down in the y-direction around the curve, we have Gaussian PDFs sticking out of the page. You can now think of gradient descent using MSE as tuning a bunch of Gaussians up and down in the y-direction to maximize likelihood for each individual x value, and that this entire problem has become reduced to an iterated mouse weight example, where we are figuring out how to place the mean for the normal distribution for every value of x. This intuition translates seamlessly to the case of many values of x (i.e. an x vector).", "Now imagine having multiple y outputs. Then, you\u2019re trying to find the best mean vector of a multivariate Gaussian distribution for each possible x.", "When I first read through the lecture notes from CS109 covering \u201clinear regression lite\u201d (linear regression with no y-intercept) in the context of maximum likelihood estimation, I didn\u2019t realize it could lead to some intuitions and insights about things that I had been using and familiar with for quite a while (MSE). Going back to them, reading them again, and thinking about it really hard turned out to be quite a fruitful experience. Writing about it also filled some holes in my understanding. I recommend doing at least some of these things for the classes you\u2019re interested in; it makes you appreciate the subject a whole lot more.", "Furthermore, this little exploration gave me a far better understanding of the techniques in AI and deep learning. Much of the existing techniques seem like arbitrary constructions at first, but if you dig into the probability theory, it turns out that they all come from the same core ideas. Thus, I think it\u2019s imperative to learn these fundamental concepts: it helps you reason about ML in a much more grounded way, and it might even help you come up with new interesting techniques/algorithms of your own!", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F2002bbbd7806&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhere-does-mean-squared-error-mse-come-from-2002bbbd7806&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhere-does-mean-squared-error-mse-come-from-2002bbbd7806&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhere-does-mean-squared-error-mse-come-from-2002bbbd7806&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhere-does-mean-squared-error-mse-come-from-2002bbbd7806&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----2002bbbd7806--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----2002bbbd7806--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@rjcaste?source=post_page-----2002bbbd7806--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@rjcaste?source=post_page-----2002bbbd7806--------------------------------", "anchor_text": "Rodrigo Castellon"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F6c9d2283e31b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhere-does-mean-squared-error-mse-come-from-2002bbbd7806&user=Rodrigo+Castellon&userId=6c9d2283e31b&source=post_page-6c9d2283e31b----2002bbbd7806---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F2002bbbd7806&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhere-does-mean-squared-error-mse-come-from-2002bbbd7806&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F2002bbbd7806&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhere-does-mean-squared-error-mse-come-from-2002bbbd7806&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@genessapana?utm_source=medium&utm_medium=referral", "anchor_text": "Genessa Panainte"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "http://knowyourmeme.com", "anchor_text": "knowyourmeme.com"}, {"url": "https://i.kym-cdn.com/photos/images/newsfeed/001/461/040/fcd.jpg", "anchor_text": "original url"}, {"url": "http://cs109.stanford.edu", "anchor_text": "CS109 (Probability Theory for Computer Scientists from Stanford)"}, {"url": "https://www.youtube.com/watch?v=XepXtl9YKwc", "anchor_text": "this great video by the Youtube channel StatQuest"}, {"url": "https://www.youtube.com/watch?v=XepXtl9YKwc", "anchor_text": "Youtube/StatQuest"}, {"url": "https://www.youtube.com/watch?v=XepXtl9YKwc", "anchor_text": "Youtube/StatQuest"}, {"url": "https://www.youtube.com/watch?v=XepXtl9YKwc", "anchor_text": "Youtube/StatQuest"}, {"url": "https://www.khanacademy.org/math/ap-calculus-ab/ab-diff-analytical-applications-new/ab-5-4/a/applying-the-first-derivative-test-to-find-extrema", "anchor_text": "taking derivatives"}, {"url": "https://en.wikipedia.org/wiki/Gradient_descent", "anchor_text": "gradient ascent"}, {"url": "https://en.wikipedia.org/wiki/Linear_regression", "anchor_text": "Wikipedia/Linear regression"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----2002bbbd7806---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----2002bbbd7806---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/statistics?source=post_page-----2002bbbd7806---------------statistics-----------------", "anchor_text": "Statistics"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----2002bbbd7806---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----2002bbbd7806---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F2002bbbd7806&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhere-does-mean-squared-error-mse-come-from-2002bbbd7806&user=Rodrigo+Castellon&userId=6c9d2283e31b&source=-----2002bbbd7806---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F2002bbbd7806&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhere-does-mean-squared-error-mse-come-from-2002bbbd7806&user=Rodrigo+Castellon&userId=6c9d2283e31b&source=-----2002bbbd7806---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F2002bbbd7806&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhere-does-mean-squared-error-mse-come-from-2002bbbd7806&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----2002bbbd7806--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F2002bbbd7806&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhere-does-mean-squared-error-mse-come-from-2002bbbd7806&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----2002bbbd7806---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----2002bbbd7806--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----2002bbbd7806--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----2002bbbd7806--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----2002bbbd7806--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----2002bbbd7806--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----2002bbbd7806--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----2002bbbd7806--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----2002bbbd7806--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@rjcaste?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@rjcaste?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Rodrigo Castellon"}, {"url": "https://medium.com/@rjcaste/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "9 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F6c9d2283e31b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhere-does-mean-squared-error-mse-come-from-2002bbbd7806&user=Rodrigo+Castellon&userId=6c9d2283e31b&source=post_page-6c9d2283e31b--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fusers%2F6c9d2283e31b%2Flazily-enable-writer-subscription&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhere-does-mean-squared-error-mse-come-from-2002bbbd7806&user=Rodrigo+Castellon&userId=6c9d2283e31b&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}