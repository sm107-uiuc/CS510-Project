{"url": "https://towardsdatascience.com/how-to-deploy-interpretable-models-on-google-cloud-platform-8da93f2e131d", "time": 1683004192.848296, "path": "towardsdatascience.com/how-to-deploy-interpretable-models-on-google-cloud-platform-8da93f2e131d/", "webpage": {"metadata": {"title": "How to deploy interpretable models on Google Cloud Platform | by Chris Rawles | Towards Data Science", "h1": "How to deploy interpretable models on Google Cloud Platform", "description": "Modern machine learning and AI have demonstrated impressive results to solve very complex problems. However, more complex problems often mean more complex data, which inevitably leads to more complex\u2026"}, "outgoing_paragraph_urls": [{"url": "https://cloud.google.com/asl", "anchor_text": "Advanced Solutions Lab", "paragraph_index": 3}, {"url": "https://cloud.google.com/explainable-ai/", "anchor_text": "Explainable AI", "paragraph_index": 3}, {"url": "https://github.com/GoogleCloudPlatform/training-data-analyst/tree/master/blogs/explainable_ai", "anchor_text": "here", "paragraph_index": 4}, {"url": "https://christophm.github.io/interpretable-ml-book/", "anchor_text": "source", "paragraph_index": 6}, {"url": "https://bigquery.cloud.google.com/table/nyc-tlc:yellow.trips?tab=details&pli=1", "anchor_text": "New York City taxicab dataset", "paragraph_index": 15}, {"url": "https://towardsdatascience.com/how-to-train-machine-learning-models-in-the-cloud-using-cloud-ml-engine-3f0d935294b3", "anchor_text": "this blog post", "paragraph_index": 15}, {"url": "https://www.google.com/search?q=tensorflow+model+format&oq=tensorflow+model+format&aqs=chrome.0.0l2j69i61j69i65j69i60l4.2431j0j7&sourceid=chrome&ie=UTF-8", "anchor_text": "SavedModel", "paragraph_index": 15}, {"url": "https://storage.googleapis.com/cloud-ai-whitepapers/AI%20Explainability%20Whitepaper.pdf", "anchor_text": "Explainable AI Whitepaper.", "paragraph_index": 17}, {"url": "https://github.com/ankurtaly/Integrated-Gradients", "anchor_text": "integrated-gradients", "paragraph_index": 22}, {"url": "https://christophm.github.io/interpretable-ml-book/shapley.html", "anchor_text": "sampled-shapley", "paragraph_index": 22}, {"url": "https://storage.googleapis.com/cloud-ai-whitepapers/AI%20Explainability%20Whitepaper.pdf", "anchor_text": "whitepaper", "paragraph_index": 23}, {"url": "https://github.com/slundberg/shap", "anchor_text": "SHAP", "paragraph_index": 25}, {"url": "https://arxiv.org/pdf/1908.08474.pdf", "anchor_text": "The many Shapley values for model explanation", "paragraph_index": 26}, {"url": "https://arxiv.org/pdf/1908.08474.pdf", "anchor_text": "this paper", "paragraph_index": 30}, {"url": "https://pair-code.github.io/what-if-tool/index.html#features", "anchor_text": "What-If tool", "paragraph_index": 31}], "all_paragraphs": ["Posted by Chris Rawles, Michael Munn, and Michael Abel.", "Modern machine learning and AI have demonstrated impressive results to solve very complex problems. However, more complex problems often mean more complex data, which inevitably leads to more complex models. Truly understanding why a model makes a certain prediction can be as complicated as the original problem itself!", "This can be problematic as many of these ML systems have come to affect use cases ranging from medical interventions, autonomous transportation, criminal justice, risk management and many other areas of society. In many cases, the usefulness and fairness of these AI systems is limited by our ability to understand, explain, and control them. As such, considerable effort and research has gone into unlocking the black box of powerful yet complex ML models, like deep neural networks.", "Explainable AI refers to the collection of methods and techniques which enable a human to understand why a model is giving specific results. Model explainability is a key topic we teach to our customers at Google Cloud\u2019s Advanced Solutions Lab, and in this post, we show how to use Google Cloud\u2019s Explainable AI to deploy interpretable and inclusive machine learning models.", "All of the code used in this post is available here.", "Overview of (post hoc) model explainability methods and examples of different techniques.", "The majority of explainability methods can be separated along three axes [source]:", "Intrinsic vs post-hoc. By intrinsic, we mean models which are inherently interpretable. That is, they are simple enough in structure that we can understand how the model is making predictions by simply looking at the model itself. For example, the learned weights of a linear model or the splits that are learned with a decision tree can be used to interpret why a model makes the predictions it does.", "Post-hoc methods involve using the trained model and data to understand why certain predictions are being made. In some cases, post-hoc methods can be applied to models which have intrinsic explainability as well.", "In this post, we\u2019ll focus on post-hoc model explainability as many advanced methods, such as gradient boosting and neural networks, are best understood using such methods.", "Model-agnostic vs model-specific. Model-agnostic means the explainability method can be applied to any model while a model-specific method can only be used with certain model types. For example, if the method that would only work with neural networks it would be considered model-specific. In contrast, if an explainability method treats the trained model as a black box then it would be considered model-agnostic.", "Local vs global: Local explainability methods aim to explain a single data point or prediction while a global method tries to provide a comprehensive explanation of how the model performs on the whole. All local methods can be turned into global techniques by using aggregations of the local results.", "You can deploy interpretable models on GCP using Explainable AI and make predictions using the gcloud beta ai-platform explain command.", "The steps to train and predict with explanations are", "Below we will show these steps in more detail.", "To start, you\u2019ll need a trained and deployed model on Google Cloud AI Platform (CAIP). We\u2019ll be looking at the New York City taxicab dataset. You can check out this blog post to see how to easily train a model on CAIP. At the time of writing, AI Explanations only supports TensorFlow 1.x, so whatever model you build make sure you use TensorFlow 1.x. Once you have your model in the SavedModel format, we\u2019ll create a new model on CAIP:", "Before we can deploy our model, we must configure an explanations_metadata.json file and copy it to the model directory. In this JSON file, we need to tell AI Explanations the names of the input and output tensors that our model is expecting.", "Additionally, in this file we need to set the input_baselines, which tells the explanations service what the baseline input should be for our model. Understanding baselines is important for effective use of many model explanation techniques. Both supported techniques, Sampled Shapley and Integrated Gradients, compare predictions against baseline feature values and predictions. Choosing appropriate baselines is important because essentially you\u2019re comparing how a model\u2019s prediction compares to the baseline values. To read more about baselines, check out the Explainable AI Whitepaper.", "Generally speaking, for numeric data we recommend that you choose a simple baseline such as the average or median to start. For this example, we will use the median for each feature \u2014 this means the baseline prediction for this model will be the taxi fare our model predicts using the median of each feature in our dataset.", "We can write out this Python dictionary to a JSON file :", "Then in bash, we copy the JSON file to your model\u2019s directory using gsutil.", "Now that we have created our explanations_metadata.json file, we will deploy a new version of the model. This code is very similar to the usual process for creating a model version using gcloud but with some additional flags:", "Using the `explanation-method` flag, you specify the explanation method \u2014 currently both integrated-gradients and sampled-shapley are supported.", "Note: When deciding between Integrated Gradients and Sampled Shapley, we quote the whitepaper:", "Integrated Gradients is recommended for neural networks and differentiable models in general. It offers computational advantages especially for large input feature spaces (e.g. images with thousands of input pixels). Sampled Shapley is recommended for non-differentiable models, which is the case in AutoML Tables models consisting of meta-ensembles of trees and neural networks.", "Additionally, for those wondering how the Sampled Shapley approach differs from the popular SHAP library, we also quote the whitepaper:", "There are many ways to apply the Shapley values that differ in how they reference the model, the training data, and the explanation context. This gives rise to a multiplicity of Shapley values used in explaining a model\u2019s prediction,which is somewhat unfortunate considering Shapley\u2019s uniqueness property. A thorough discussion of this topic can be found in The many Shapley values for model explanation by Mukund Sundararajan and Amir Najmi. Our methods fall into the Baseline Shapley category and support multiple simultaneous baselines across various input data modalities.", "Now that our model is deployed, we can get the local attributions from a Jupyter notebook:", "We can load these into a Pandas DataFrame and plot the attributions for individual examples:", "Finally, we can get global model explainability by aggregating the local attributions:", "For more insight in using Sampled Shapley global attributions, please refer to this paper.", "That\u2019s it! In this post we have shown how to deploy explainable models on Google Cloud Platform using Explainable AI. The Explainable AI tool allows users to get local explanations from a deployed model. These explanations can be combined together to provide global interpretability. In addition to the steps above, you can also check out the What-If tool to inspect and interpret your model.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F8da93f2e131d&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-deploy-interpretable-models-on-google-cloud-platform-8da93f2e131d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-deploy-interpretable-models-on-google-cloud-platform-8da93f2e131d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-deploy-interpretable-models-on-google-cloud-platform-8da93f2e131d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-deploy-interpretable-models-on-google-cloud-platform-8da93f2e131d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----8da93f2e131d--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----8da93f2e131d--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@thecrawles?source=post_page-----8da93f2e131d--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@thecrawles?source=post_page-----8da93f2e131d--------------------------------", "anchor_text": "Chris Rawles"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F7b27ba77e1ee&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-deploy-interpretable-models-on-google-cloud-platform-8da93f2e131d&user=Chris+Rawles&userId=7b27ba77e1ee&source=post_page-7b27ba77e1ee----8da93f2e131d---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F8da93f2e131d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-deploy-interpretable-models-on-google-cloud-platform-8da93f2e131d&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F8da93f2e131d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-deploy-interpretable-models-on-google-cloud-platform-8da93f2e131d&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://pixabay.com/photos/splashing-splash-aqua-water-165192/", "anchor_text": "Pixabay"}, {"url": "https://cloud.google.com/asl", "anchor_text": "Advanced Solutions Lab"}, {"url": "https://cloud.google.com/explainable-ai/", "anchor_text": "Explainable AI"}, {"url": "https://github.com/GoogleCloudPlatform/training-data-analyst/tree/master/blogs/explainable_ai", "anchor_text": "here"}, {"url": "https://christophm.github.io/interpretable-ml-book/", "anchor_text": "source"}, {"url": "https://bigquery.cloud.google.com/table/nyc-tlc:yellow.trips?tab=details&pli=1", "anchor_text": "New York City taxicab dataset"}, {"url": "https://towardsdatascience.com/how-to-train-machine-learning-models-in-the-cloud-using-cloud-ml-engine-3f0d935294b3", "anchor_text": "this blog post"}, {"url": "https://www.google.com/search?q=tensorflow+model+format&oq=tensorflow+model+format&aqs=chrome.0.0l2j69i61j69i65j69i60l4.2431j0j7&sourceid=chrome&ie=UTF-8", "anchor_text": "SavedModel"}, {"url": "https://storage.googleapis.com/cloud-ai-whitepapers/AI%20Explainability%20Whitepaper.pdf", "anchor_text": "Explainable AI Whitepaper."}, {"url": "https://github.com/ankurtaly/Integrated-Gradients", "anchor_text": "integrated-gradients"}, {"url": "https://christophm.github.io/interpretable-ml-book/shapley.html", "anchor_text": "sampled-shapley"}, {"url": "https://storage.googleapis.com/cloud-ai-whitepapers/AI%20Explainability%20Whitepaper.pdf", "anchor_text": "whitepaper"}, {"url": "https://github.com/slundberg/shap", "anchor_text": "SHAP"}, {"url": "https://arxiv.org/pdf/1908.08474.pdf", "anchor_text": "The many Shapley values for model explanation"}, {"url": "https://arxiv.org/pdf/1908.08474.pdf", "anchor_text": "this paper"}, {"url": "https://pair-code.github.io/what-if-tool/index.html#features", "anchor_text": "What-If tool"}, {"url": "https://cloud.google.com/blog/products/ai-machine-learning/explaining-model-predictions-structured-data", "anchor_text": "Explaining Model Predictions with Google AI Platform"}, {"url": "https://sararobinson.dev/2020/01/15/fraud-detection-tensorflow.html", "anchor_text": "Fraud Detection and Explainable AI"}, {"url": "https://storage.googleapis.com/cloud-ai-whitepapers/AI%20Explainability%20Whitepaper.pdf", "anchor_text": "Google AI Explainability Whitepaper"}, {"url": "https://christophm.github.io/interpretable-ml-book/index.html", "anchor_text": "Christopher Molnar\u2019s Interpretable ML"}, {"url": "https://medium.com/tag/explainable-ai?source=post_page-----8da93f2e131d---------------explainable_ai-----------------", "anchor_text": "Explainable Ai"}, {"url": "https://medium.com/tag/google-cloud-platform?source=post_page-----8da93f2e131d---------------google_cloud_platform-----------------", "anchor_text": "Google Cloud Platform"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----8da93f2e131d---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----8da93f2e131d---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----8da93f2e131d---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F8da93f2e131d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-deploy-interpretable-models-on-google-cloud-platform-8da93f2e131d&user=Chris+Rawles&userId=7b27ba77e1ee&source=-----8da93f2e131d---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F8da93f2e131d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-deploy-interpretable-models-on-google-cloud-platform-8da93f2e131d&user=Chris+Rawles&userId=7b27ba77e1ee&source=-----8da93f2e131d---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F8da93f2e131d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-deploy-interpretable-models-on-google-cloud-platform-8da93f2e131d&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----8da93f2e131d--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F8da93f2e131d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-deploy-interpretable-models-on-google-cloud-platform-8da93f2e131d&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----8da93f2e131d---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----8da93f2e131d--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----8da93f2e131d--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----8da93f2e131d--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----8da93f2e131d--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----8da93f2e131d--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----8da93f2e131d--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----8da93f2e131d--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----8da93f2e131d--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@thecrawles?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@thecrawles?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Chris Rawles"}, {"url": "https://medium.com/@thecrawles/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "311 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F7b27ba77e1ee&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-deploy-interpretable-models-on-google-cloud-platform-8da93f2e131d&user=Chris+Rawles&userId=7b27ba77e1ee&source=post_page-7b27ba77e1ee--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F9990fa70976f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-deploy-interpretable-models-on-google-cloud-platform-8da93f2e131d&newsletterV3=7b27ba77e1ee&newsletterV3Id=9990fa70976f&user=Chris+Rawles&userId=7b27ba77e1ee&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}