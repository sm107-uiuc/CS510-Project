{"url": "https://towardsdatascience.com/visualizing-decision-trees-with-python-scikit-learn-graphviz-matplotlib-1c50b4aa68dc", "time": 1683005313.905071, "path": "towardsdatascience.com/visualizing-decision-trees-with-python-scikit-learn-graphviz-matplotlib-1c50b4aa68dc/", "webpage": {"metadata": {"title": "Visualizing Decision Trees with Python (Scikit-learn, Graphviz, Matplotlib) | by Michael Galarnyk | Towards Data Science", "h1": "Visualizing Decision Trees with Python (Scikit-learn, Graphviz, Matplotlib)", "description": "Decision trees are a popular supervised learning method for a variety of reasons. Benefits of decision trees include that they can be used for both regression and classification, they don\u2019t require\u2026"}, "outgoing_paragraph_urls": [{"url": "https://github.com/mGalarnyk/Python_Tutorials/blob/master/Sklearn/CART/Visualization/DecisionTreesVisualization.ipynb", "anchor_text": "GitHub", "paragraph_index": 1}, {"url": "https://towardsdatascience.com/understanding-decision-trees-for-classification-python-9663d683c952", "anchor_text": "Understanding Decision Trees for Classification (Python) tutorial", "paragraph_index": 2}, {"url": "https://towardsdatascience.com/understanding-train-test-split-scikit-learn-python-ea676d5e3d1", "anchor_text": "train test split", "paragraph_index": 5}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.tree.plot_tree.html#sklearn.tree.plot_tree", "anchor_text": "tree.plot_tree", "paragraph_index": 6}, {"url": "https://www.datacamp.com/community/tutorials/installing-anaconda-mac-os-x", "anchor_text": "here", "paragraph_index": 13}, {"url": "https://brew.sh/", "anchor_text": "Homebrew", "paragraph_index": 18}, {"url": "https://medium.com/@GalarnykMichael/how-to-install-and-use-homebrew-80eeb55f73e9", "anchor_text": "here", "paragraph_index": 18}, {"url": "https://medium.com/@GalarnykMichael/install-python-anaconda-on-windows-2020-f8e188f9a63d", "anchor_text": "here", "paragraph_index": 20}, {"url": "https://graphviz.gitlab.io/_pages/Download/Download_windows.html", "anchor_text": "download and install it", "paragraph_index": 24}, {"url": "https://dreampuf.github.io/GraphvizOnline", "anchor_text": "an online converter", "paragraph_index": 25}, {"url": "http://www.webgraphviz.com/", "anchor_text": "other online converters", "paragraph_index": 28}, {"url": "https://youtu.be/urb2wRxnGz4", "anchor_text": "video", "paragraph_index": 29}, {"url": "https://github.com/mGalarnyk/Python_Tutorials/blob/master/Sklearn/CART/Visualization/DecisionTreesVisualization.ipynb", "anchor_text": "GitHub", "paragraph_index": 34}, {"url": "https://www.graphviz.org/pdf/dotguide.pdf", "anchor_text": "dot language", "paragraph_index": 35}, {"url": "https://towardsdatascience.com/beautiful-decision-tree-visualizations-with-dtreeviz-af1a66c1c180", "anchor_text": "dtreeviz", "paragraph_index": 35}, {"url": "https://explained.ai/decision-tree-viz/index.html", "anchor_text": "here", "paragraph_index": 35}, {"url": "https://medium.com/distributed-computing-with-ray/how-to-speed-up-scikit-learn-model-training-aaf17e2d1e1", "anchor_text": "How to Speed up Scikit-Learn Model Training", "paragraph_index": 36}, {"url": "https://twitter.com/GalarnykMichael", "anchor_text": "Twitter", "paragraph_index": 36}], "all_paragraphs": ["Decision trees are a popular supervised learning method for a variety of reasons. Benefits of decision trees include that they can be used for both regression and classification, they don\u2019t require feature scaling, and they are relatively easy to interpret as you can visualize decision trees. This is not only a powerful way to understand your model, but also to communicate how your model works. Consequently, it would help to know how to make a visualization based on your model.", "As always, the code used in this tutorial is available on my GitHub. With that, let\u2019s get started!", "In order to visualize decision trees, we need first need to fit a decision tree model using scikit-learn. If this section is not clear, I encourage you to read my Understanding Decision Trees for Classification (Python) tutorial as I go into a lot of detail on how decision trees work and how to use them.", "The following import statements are what we will use for this section of the tutorial.", "The Iris dataset is one of datasets scikit-learn comes with that do not require the downloading of any file from some external website. The code below loads the iris dataset.", "The code below performs a train test split which puts 75% of the data into a training set and 25% of the data into a test set.", "As of scikit-learn version 21.0 (roughly May 2019), Decision Trees can now be plotted with matplotlib using scikit-learn\u2019s tree.plot_tree without relying on the dot library which is a hard-to-install dependency which we will cover later on in the blog post.", "The code below plots a decision tree using scikit-learn.", "In addition to adding the code to allow you to save your image, the code below tries to make the decision tree more interpretable by adding in feature and class names (as well as setting filled = True).", "Graphviz is open source graph visualization software. Graph visualization is a way of representing structural information as diagrams of abstract graphs and networks. In data science, one use of Graphviz is to visualize decision trees. I should note that the reason why I am going over Graphviz after covering Matplotlib is that getting this to work can be difficult. The first part of this process involves creating a dot file. A dot file is a Graphviz representation of a decision tree. The problem is that using Graphviz to convert the dot file into an image file (png, jpg, etc) can be difficult. There are a couple ways to do this including: installing python-graphviz though Anaconda, installing Graphviz through Homebrew (Mac), installing Graphviz executables from the official site (Windows), and using an online converter on the contents of your dot file to convert it into an image.", "The code below code will work on any operating system as python generates the dot file and exports it as a file named tree.dot.", "Converting the dot file into an image file (png, jpg, etc) typically requires the installation of Graphviz which depends on your operating system and a host of other things. The goal of this section is to help people try and solve the common issue of getting the following error. dot: command not found.", "How to Install and Use on Mac through Anaconda", "To be able to install Graphviz on your Mac through this method, you first need to have Anaconda installed (If you don\u2019t have Anaconda installed, you can learn how to install it here).", "Open a terminal. You can do this by clicking on the Spotlight magnifying glass at the top right of the screen, type terminal and then click on the Terminal icon.", "Type the command below to install Graphviz.", "After that, you should be able to use the dot command below to convert the dot file into a png file.", "How to Install and Use on Mac through Homebrew", "If you don\u2019t have Anaconda or just want another way of installing Graphviz on your Mac, you can use Homebrew. I previously wrote an article on how to install Homebrew and use it to convert a dot file into an image file here (see the Homebrew to Help Visualize Decision Trees section of the tutorial).", "How to Install and Use on Windows through Anaconda", "This is the method I prefer on Windows. To be able to install Graphviz on your Windows through this method, you first need to have Anaconda installed (If you don\u2019t have Anaconda installed, you can learn how to install it here).", "Open a terminal/command prompt and enter the command below to install Graphviz.", "After that, you should be able to use the dot command below to convert the dot file into a png file.", "How to Install and Use on Windows through Graphviz Executable", "If you don\u2019t have Anaconda or just want another way of installing Graphviz on your Windows, you can use the following link to download and install it.", "If all else fails or you simply don\u2019t want to install anything, you can use an online converter.", "In the image below, I opened the file with Sublime Text (though there are many different programs that can open/read a dot file) and copied the content of the file.", "In the image below, I pasted the content from the dot file onto the left side of the online converter. You can then choose what format you want and then save the image on the right side of the screen.", "Keep in mind that there are other online converters that can help accomplish the same task.", "A weakness of decision trees is that they don\u2019t tend to have the best predictive accuracy. This is partially because of high variance, meaning that different splits in the training data can lead to very different trees. The video above covers Bagged Trees which is an ensemble model. This means using multiple learning algorithms to obtain a better predictive performance than could be obtained from any of the constituent learning algorithms alone. In this case, many trees protect each other from their individual errors. The interesting thing is that the thumbnail from the video above could be a diagram for either Bagged Trees or Random Forests (another ensemble model). The differences between how Bagged Trees and Random Forests models work is a subject for another blog, but what is important to note is that for both models we grow N trees where N is the number of decision trees a user specifies. Consequently after you fit a model, it would be nice to look at the individual decision trees that make up your model.", "In order to visualize individual decision trees, we need first need to fit a Bagged Trees or Random Forest model using scikit-learn (the code below fits a Random Forest model).", "You can now view all the individual trees from the fitted model. In this section, I will visualize all the decision trees using matplotlib.", "You can now visualize individual trees. The code below visualizes the first decision tree.", "You can try to use matplotlib subplots to visualize as many of the trees as you like. The code below visualizes the first 5 decision trees. I personally don\u2019t prefer this method as it is even harder to read.", "Keep in mind that if for some reason you want images for all your estimators (decision trees), you can do so using the code on my GitHub. If you just want to see each of the 100 estimators for the Random Forest model fit in this tutorial without running the code, you can look at the video below.", "This tutorial covered how to visualize decision trees using Graphviz and Matplotlib. Note that the way to visualize decision trees using Matplotlib is a newer method so it might change or be improved upon in the future. Graphviz is currently more flexible as you can always modify your dot files to make them more visually appealing like I did using the dot language or even just alter the orientation of your decision tree. One thing we didn\u2019t cover was how to use dtreeviz which is another library that can visualize decision trees. There is an excellent post on it here.", "My next machine learning tutorial goes over How to Speed up Scikit-Learn Model Training. If you have any questions or thoughts on the tutorial, feel free to reach out in the comments below or through Twitter.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F1c50b4aa68dc&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvisualizing-decision-trees-with-python-scikit-learn-graphviz-matplotlib-1c50b4aa68dc&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvisualizing-decision-trees-with-python-scikit-learn-graphviz-matplotlib-1c50b4aa68dc&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvisualizing-decision-trees-with-python-scikit-learn-graphviz-matplotlib-1c50b4aa68dc&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvisualizing-decision-trees-with-python-scikit-learn-graphviz-matplotlib-1c50b4aa68dc&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----1c50b4aa68dc--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----1c50b4aa68dc--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@GalarnykMichael?source=post_page-----1c50b4aa68dc--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@GalarnykMichael?source=post_page-----1c50b4aa68dc--------------------------------", "anchor_text": "Michael Galarnyk"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fc07aac64b6e1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvisualizing-decision-trees-with-python-scikit-learn-graphviz-matplotlib-1c50b4aa68dc&user=Michael+Galarnyk&userId=c07aac64b6e1&source=post_page-c07aac64b6e1----1c50b4aa68dc---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F1c50b4aa68dc&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvisualizing-decision-trees-with-python-scikit-learn-graphviz-matplotlib-1c50b4aa68dc&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F1c50b4aa68dc&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvisualizing-decision-trees-with-python-scikit-learn-graphviz-matplotlib-1c50b4aa68dc&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://towardsdatascience.com/understanding-decision-trees-for-classification-python-9663d683c952", "anchor_text": "Understanding Decision Trees for Classification (Python) Tutorial"}, {"url": "https://github.com/mGalarnyk/Python_Tutorials/blob/master/Sklearn/CART/Visualization/DecisionTreesVisualization.ipynb", "anchor_text": "GitHub"}, {"url": "https://towardsdatascience.com/understanding-decision-trees-for-classification-python-9663d683c952", "anchor_text": "Understanding Decision Trees for Classification (Python) tutorial"}, {"url": "https://towardsdatascience.com/understanding-train-test-split-scikit-learn-python-ea676d5e3d1", "anchor_text": "train test split"}, {"url": "https://twitter.com/GalarnykMichael", "anchor_text": "Michael Galarnyk"}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.tree.plot_tree.html#sklearn.tree.plot_tree", "anchor_text": "tree.plot_tree"}, {"url": "https://www.datacamp.com/community/tutorials/installing-anaconda-mac-os-x", "anchor_text": "here"}, {"url": "https://brew.sh/", "anchor_text": "Homebrew"}, {"url": "https://medium.com/@GalarnykMichael/how-to-install-and-use-homebrew-80eeb55f73e9", "anchor_text": "here"}, {"url": "https://medium.com/@GalarnykMichael/install-python-anaconda-on-windows-2020-f8e188f9a63d", "anchor_text": "here"}, {"url": "https://graphviz.gitlab.io/_pages/Download/Download_windows.html", "anchor_text": "download and install it"}, {"url": "https://datascience.stackexchange.com/questions/37428/graphviz-not-working-when-imported-inside-pydotplus-graphvizs-executables-not", "anchor_text": "There are many Stackoverflow questions based on this particular issue"}, {"url": "https://dreampuf.github.io/GraphvizOnline", "anchor_text": "an online converter"}, {"url": "http://www.webgraphviz.com/", "anchor_text": "other online converters"}, {"url": "https://youtu.be/urb2wRxnGz4", "anchor_text": "video"}, {"url": "https://www.linkedin.com/learning/machine-learning-with-scikit-learn/effective-machine-learning-with-scikit-learn", "anchor_text": "Machine Learning with Scikit-Learn Course"}, {"url": "https://youtu.be/urb2wRxnGz4", "anchor_text": "video"}, {"url": "https://github.com/mGalarnyk/Python_Tutorials/blob/master/Sklearn/CART/Visualization/DecisionTreesVisualization.ipynb", "anchor_text": "GitHub"}, {"url": "https://www.graphviz.org/pdf/dotguide.pdf", "anchor_text": "dot language"}, {"url": "https://towardsdatascience.com/beautiful-decision-tree-visualizations-with-dtreeviz-af1a66c1c180", "anchor_text": "dtreeviz"}, {"url": "https://explained.ai/decision-tree-viz/index.html", "anchor_text": "here"}, {"url": "https://github.com/parrt/dtreeviz", "anchor_text": "dtreeviz library"}, {"url": "https://medium.com/distributed-computing-with-ray/how-to-speed-up-scikit-learn-model-training-aaf17e2d1e1", "anchor_text": "How to Speed up Scikit-Learn Model Training"}, {"url": "https://twitter.com/GalarnykMichael", "anchor_text": "Twitter"}, {"url": "https://medium.com/tag/python?source=post_page-----1c50b4aa68dc---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/matplotlib?source=post_page-----1c50b4aa68dc---------------matplotlib-----------------", "anchor_text": "Matplotlib"}, {"url": "https://medium.com/tag/decision-tree?source=post_page-----1c50b4aa68dc---------------decision_tree-----------------", "anchor_text": "Decision Tree"}, {"url": "https://medium.com/tag/scikit-learn?source=post_page-----1c50b4aa68dc---------------scikit_learn-----------------", "anchor_text": "Scikit Learn"}, {"url": "https://medium.com/tag/graphviz?source=post_page-----1c50b4aa68dc---------------graphviz-----------------", "anchor_text": "Graphviz"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F1c50b4aa68dc&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvisualizing-decision-trees-with-python-scikit-learn-graphviz-matplotlib-1c50b4aa68dc&user=Michael+Galarnyk&userId=c07aac64b6e1&source=-----1c50b4aa68dc---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F1c50b4aa68dc&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvisualizing-decision-trees-with-python-scikit-learn-graphviz-matplotlib-1c50b4aa68dc&user=Michael+Galarnyk&userId=c07aac64b6e1&source=-----1c50b4aa68dc---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F1c50b4aa68dc&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvisualizing-decision-trees-with-python-scikit-learn-graphviz-matplotlib-1c50b4aa68dc&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----1c50b4aa68dc--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F1c50b4aa68dc&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvisualizing-decision-trees-with-python-scikit-learn-graphviz-matplotlib-1c50b4aa68dc&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----1c50b4aa68dc---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----1c50b4aa68dc--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----1c50b4aa68dc--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----1c50b4aa68dc--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----1c50b4aa68dc--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----1c50b4aa68dc--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----1c50b4aa68dc--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----1c50b4aa68dc--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----1c50b4aa68dc--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@GalarnykMichael?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@GalarnykMichael?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Michael Galarnyk"}, {"url": "https://medium.com/@GalarnykMichael/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "11.8K Followers"}, {"url": "https://www.linkedin.com/in/michaelgalarnyk/", "anchor_text": "https://www.linkedin.com/in/michaelgalarnyk/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fc07aac64b6e1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvisualizing-decision-trees-with-python-scikit-learn-graphviz-matplotlib-1c50b4aa68dc&user=Michael+Galarnyk&userId=c07aac64b6e1&source=post_page-c07aac64b6e1--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F71f9c008a22b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvisualizing-decision-trees-with-python-scikit-learn-graphviz-matplotlib-1c50b4aa68dc&newsletterV3=c07aac64b6e1&newsletterV3Id=71f9c008a22b&user=Michael+Galarnyk&userId=c07aac64b6e1&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}