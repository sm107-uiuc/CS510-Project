{"url": "https://towardsdatascience.com/learning-rate-schedule-in-practice-an-example-with-keras-and-tensorflow-2-0-2f48b2888a0c", "time": 1683014558.6843112, "path": "towardsdatascience.com/learning-rate-schedule-in-practice-an-example-with-keras-and-tensorflow-2-0-2f48b2888a0c/", "webpage": {"metadata": {"title": "Learning Rate Schedule in Practice: an example with Keras and TensorFlow 2.0 | by B. Chen | Towards Data Science", "h1": "Learning Rate Schedule in Practice: an example with Keras and TensorFlow 2.0", "description": "One of the painful things about training a neural network is the sheer number of hyperparameters we have to deal with. For example Among them, the most important parameter is the learning rate. If\u2026"}, "outgoing_paragraph_urls": [{"url": "https://github.com/BindiChen/machine-learning/blob/master/tensorflow2/006-learning-rate-schedules/learning-rate-schedules.ipynb", "anchor_text": "my Github repo", "paragraph_index": 5}, {"url": "https://towardsdatascience.com/3-ways-to-create-a-machine-learning-model-with-keras-and-tensorflow-2-0-de09323af4d3", "anchor_text": "3 ways to create a machine learning model with Keras and TensorFlow 2.0", "paragraph_index": 9}, {"url": "https://keras.io/api/optimizers/sgd/", "anchor_text": "SGD optimizer", "paragraph_index": 11}, {"url": "https://arxiv.org/pdf/1206.5533v2.pdf", "anchor_text": "Practical Recommendations for Gradient-based Training of Deep Architectures", "paragraph_index": 26}, {"url": "https://github.com/BindiChen/machine-learning/blob/master/tensorflow2/006-learning-rate-schedules/learning-rate-schedules.ipynb", "anchor_text": "notebook on my Github", "paragraph_index": 28}], "all_paragraphs": ["One of the painful things about training a neural network is the sheer number of hyperparameters we have to deal with. For example", "Among them, the most important parameter is the learning rate. If your learning rate is set to low, training will progress very slowly as you are making very tiny updates to the weights in your network. However, if your learning rate is set too high, it can cause undesirable divergent behavior in your loss function.", "When training a neural network, it is often useful to reduce the learning rate as the training progresses. This can be done by using learning rate schedules or adaptive learning rate. In this article, we will focus on adding and customizing learning rate schedule in our machine learning model and look at examples of how we do them in practice with Keras and TensorFlow 2.0", "Learning Rate Schedules seek to adjust the learning rate during training by reducing the learning rate according to a pre-defined schedule. The popular learning rate schedules include", "For the demonstration purpose, we will build an image classifier to tackle Fashion MNIST, which is a dataset that has 70,000 grayscale images of 28-by-28 pixels with 10 classes.", "Please check out my Github repo for source code.", "Keras provides some utility functions to fetch and load common datasets, including Fashion MNIST. Let\u2019s load Fashion MNIST", "The dataset is already split into a training set and a test set. Here is the shape and data type of the training set:", "We are going to train the neural network using Gradient Descent, we must scale the input feature down to the 0\u20131 range. And for faster training on a local machine, let\u2019s just use the first 10,000 images.", "Now let\u2019s build the neural network! There are 3 ways to create a machine learning model with Keras and TensorFlow 2.0. Since we are building a simple fully connected neural network and for simplicity, let\u2019s use the easiest way: Sequential Model with Sequential().", "Our model has the following specifications:", "The constant learning rate is the default schedule in all Keras Optimizers. For example, in the SGD optimizer, the learning rate defaults to 0.01.", "To use a custom learning rate, simply instantiate an SGD optimizer and pass the argument learning_rate=0.01 .", "And to fit the model to training data:", "Let\u2019s plot the model accuracy and this can serve as a baseline for us to experiment with other learning rate schedules.", "Time-based decay is one of the most popular learning rate schedules. Formally, the time-based decay is defined as:", "where lr is the previous learning rate, decay is a hyperparameter and epoch is the iteration number. When the decay is zero, this has no effect on changing the learning rate. When the decay is specified, it will decrease the learning rate from the previous epoch by the given fixed amount. The value of decay is normally implemented as", "In Keras, one way to implement the time-based decay is by defining a time-based decay function lr_time_based_decay() and pass it to LearningRateScheduler callback.", "And below are the plots of accuracy and learning rate.", "Another popular learning rate schedule is to systematically drop the learning rate at specific times during training. Formally, it is defined as:", "Where initial_lr is the initial learning rate such as 0.01, the drop_rate is the amount that the learning rate is modified each time if it is changed, epoch is the current epoch number, and epochs_drop is how often to change the learning rate such as 10 epochs. Similarly, we can implement this by defining a step decay function lr_step_decay() and pass it to LearningRateScheduler callback.", "And below are the plots of the accuracy and learning rate.", "Another popular learning rate schedule is to drop the learning rate at an exponential rate. Formally, it is defined as:", "Where initial_lr is the initial learning rate such as 0.01, k is a hyperparameter, and epoch is the current epoch number. Similarly, we can implement this by defining an exponential decay function lr_exp_decay() and pass it to LearningRateScheduler callback.", "Finally, let us compare the model accuracy using different learning rate schedules.", "Looks like Constant and Time-based learning rates have better performance than Step decay and Exponential decay for this particular tutorial. Bear in mind that, this tutorial only uses the first 10,000 images with some arbitrary value forinitial_learning_rate=0.01, validation_split=0.2 and batch_size=64 .", "In a real-world application, they are a lot more to consider for tunning the learning rate. Please check out the paper \u201cPractical Recommendations for Gradient-based Training of Deep Architectures\u201d for some best practices.", "Thanks for reading. This article has covered the most popular Learning Rate Schedules. Next time, we will take a look at the Adaptive Learning Rate.", "Please check out the notebook on my Github for the source code.", "Stay tuned if you are interested in the practical aspect of machine learning.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F2f48b2888a0c&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flearning-rate-schedule-in-practice-an-example-with-keras-and-tensorflow-2-0-2f48b2888a0c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flearning-rate-schedule-in-practice-an-example-with-keras-and-tensorflow-2-0-2f48b2888a0c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flearning-rate-schedule-in-practice-an-example-with-keras-and-tensorflow-2-0-2f48b2888a0c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flearning-rate-schedule-in-practice-an-example-with-keras-and-tensorflow-2-0-2f48b2888a0c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----2f48b2888a0c--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----2f48b2888a0c--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://bindichen.medium.com/?source=post_page-----2f48b2888a0c--------------------------------", "anchor_text": ""}, {"url": "https://bindichen.medium.com/?source=post_page-----2f48b2888a0c--------------------------------", "anchor_text": "B. Chen"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F563d09da62a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flearning-rate-schedule-in-practice-an-example-with-keras-and-tensorflow-2-0-2f48b2888a0c&user=B.+Chen&userId=563d09da62a&source=post_page-563d09da62a----2f48b2888a0c---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F2f48b2888a0c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flearning-rate-schedule-in-practice-an-example-with-keras-and-tensorflow-2-0-2f48b2888a0c&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F2f48b2888a0c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flearning-rate-schedule-in-practice-an-example-with-keras-and-tensorflow-2-0-2f48b2888a0c&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@nexgenfx?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Luca Campioni"}, {"url": "https://unsplash.com/s/photos/speed?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://excalidraw.com/", "anchor_text": "https://excalidraw.com/"}, {"url": "https://github.com/BindiChen/machine-learning/blob/master/tensorflow2/006-learning-rate-schedules/learning-rate-schedules.ipynb", "anchor_text": "my Github repo"}, {"url": "https://towardsdatascience.com/3-ways-to-create-a-machine-learning-model-with-keras-and-tensorflow-2-0-de09323af4d3", "anchor_text": "3 ways to create a machine learning model with Keras and TensorFlow 2.0"}, {"url": "https://keras.io/api/optimizers/sgd/", "anchor_text": "SGD optimizer"}, {"url": "https://arxiv.org/pdf/1206.5533v2.pdf", "anchor_text": "Practical Recommendations for Gradient-based Training of Deep Architectures"}, {"url": "https://github.com/BindiChen/machine-learning/blob/master/tensorflow2/006-learning-rate-schedules/learning-rate-schedules.ipynb", "anchor_text": "notebook on my Github"}, {"url": "https://towardsdatascience.com/the-googles-7-steps-of-machine-learning-in-practice-a-tensorflow-example-for-structured-data-96ccbb707d77", "anchor_text": "The Google\u2019s 7 steps of Machine Learning in practice: a TensorFlow example for structured data"}, {"url": "https://towardsdatascience.com/3-ways-to-create-a-machine-learning-model-with-keras-and-tensorflow-2-0-de09323af4d3", "anchor_text": "3 ways to create a Machine Learning Model with Keras and TensorFlow 2.0"}, {"url": "https://towardsdatascience.com/batch-normalization-in-practice-an-example-with-keras-and-tensorflow-2-0-b1ec28bde96f", "anchor_text": "Batch normalization in practice: an example with Keras and TensorFlow 2.0"}, {"url": "https://towardsdatascience.com/a-practical-introduction-to-early-stopping-in-machine-learning-550ac88bc8fd", "anchor_text": "Early stopping in Practice: an example with Keras and TensorFlow"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----2f48b2888a0c---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/tensorflow?source=post_page-----2f48b2888a0c---------------tensorflow-----------------", "anchor_text": "TensorFlow"}, {"url": "https://medium.com/tag/keras?source=post_page-----2f48b2888a0c---------------keras-----------------", "anchor_text": "Keras"}, {"url": "https://medium.com/tag/learning-rate?source=post_page-----2f48b2888a0c---------------learning_rate-----------------", "anchor_text": "Learning Rate"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----2f48b2888a0c---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F2f48b2888a0c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flearning-rate-schedule-in-practice-an-example-with-keras-and-tensorflow-2-0-2f48b2888a0c&user=B.+Chen&userId=563d09da62a&source=-----2f48b2888a0c---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F2f48b2888a0c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flearning-rate-schedule-in-practice-an-example-with-keras-and-tensorflow-2-0-2f48b2888a0c&user=B.+Chen&userId=563d09da62a&source=-----2f48b2888a0c---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F2f48b2888a0c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flearning-rate-schedule-in-practice-an-example-with-keras-and-tensorflow-2-0-2f48b2888a0c&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----2f48b2888a0c--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F2f48b2888a0c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flearning-rate-schedule-in-practice-an-example-with-keras-and-tensorflow-2-0-2f48b2888a0c&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----2f48b2888a0c---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----2f48b2888a0c--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----2f48b2888a0c--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----2f48b2888a0c--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----2f48b2888a0c--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----2f48b2888a0c--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----2f48b2888a0c--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----2f48b2888a0c--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----2f48b2888a0c--------------------------------", "anchor_text": ""}, {"url": "https://bindichen.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://bindichen.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "B. Chen"}, {"url": "https://bindichen.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "4K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F563d09da62a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flearning-rate-schedule-in-practice-an-example-with-keras-and-tensorflow-2-0-2f48b2888a0c&user=B.+Chen&userId=563d09da62a&source=post_page-563d09da62a--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F56a3bfbb80dc&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flearning-rate-schedule-in-practice-an-example-with-keras-and-tensorflow-2-0-2f48b2888a0c&newsletterV3=563d09da62a&newsletterV3Id=56a3bfbb80dc&user=B.+Chen&userId=563d09da62a&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}