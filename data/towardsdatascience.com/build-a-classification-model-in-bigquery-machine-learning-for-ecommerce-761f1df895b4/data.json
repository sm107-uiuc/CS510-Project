{"url": "https://towardsdatascience.com/build-a-classification-model-in-bigquery-machine-learning-for-ecommerce-761f1df895b4", "time": 1683006240.3689458, "path": "towardsdatascience.com/build-a-classification-model-in-bigquery-machine-learning-for-ecommerce-761f1df895b4/", "webpage": {"metadata": {"title": "Build a Classification Model in BigQuery \u2014 Machine learning for E-commerce | by Ahmed Mohamed | Towards Data Science", "h1": "Build a Classification Model in BigQuery \u2014 Machine learning for E-commerce", "description": "The data analyst team at your Company exported the Google Analytics logs for an ecommerce website into BigQuery and created a new table of all the raw ecommerce visitor session data for me to\u2026"}, "outgoing_paragraph_urls": [{"url": "https://github.com/Ahmed0028/Google-Cloud-Platform-BigQuerML-/blob/master/code.txt", "anchor_text": "here", "paragraph_index": 10}, {"url": "https://support.google.com/analytics/answer/3437719?hl=en", "anchor_text": "here", "paragraph_index": 18}, {"url": "https://bigquery.cloud.google.com/table/data-to-insights:ecommerce.web_analytics?tab=preview", "anchor_text": "preview the demo dataset", "paragraph_index": 18}, {"url": "https://www.tensorflow.org/tutorials/", "anchor_text": "TensorFlow", "paragraph_index": 31}], "all_paragraphs": ["The data analyst team at your Company exported the Google Analytics logs for an ecommerce website into BigQuery and created a new table of all the raw ecommerce visitor session data for me to explore. Using this data, I\u2019ll try to answer a few questions.", "Question1: Out of the total visitors who visited our website, what % made a purchase?", "Question2: How many visitors bought on subsequent visits to the website?", "Question3: What are some of the reasons a typical ecommerce customer will browse but not buy until a later visit?", "Question4: Create a Machine Learning model in BigQuery to predict whether or not a new user is likely to purchase in the future. Identifying these high-value users can help the marketing team target them with special promotions and ad campaigns to ensure a conversion while they comparison shop between visits to your ecommerce site.", "1- Select features and create your training dataset.", "2- Create a BigQuery dataset to store models.", "3- Select a BQML model type and specify options.", "5- Improve model performance with Feature Engineering.", "6- Predict which new visitors will come back and purchase.", "Note : all Code are avaiable here .", "Here are the results of Top 5 products :", "Analyzing the results, we can see that (11873 / 741721) = 1.6% of total visitors will return and purchase from the website. This includes the subset of visitors who bought on their very first session and then came back and bought again.", "What are some of the reasons a typical ecommerce customer will browse but not buy until a later visit?", "Although there is no one right answer, one popular reason is comparison shopping between different ecommerce sites before ultimately making a purchase decision. This is very common for luxury goods where significant up-front research and comparison is required by the customer before deciding (think car purchases) but also true to a lesser extent for the merchandise on this site (t-shirts, accessories, etc).", "In the world of online marketing, identifying and marketing to these future customers based on the characteristics of their first visit will increase conversion rates and reduce the outflow to competitor sites.", "Now you will create a Machine Learning model in BigQuery to predict whether or not a new user is likely to purchase in the future. Identifying these high-value users can help your marketing team target them with special promotions and ad campaigns to ensure a conversion while they comparison shop between visits to your ecommerce site.", "1- Select features and create your training dataset.", "Google Analytics captures a wide variety of dimensions and measures about a user\u2019s visit on this ecommerce website. Browse the complete list of fields here and then preview the demo dataset to find useful features that will help a machine learning model understand the relationship between data about a visitor\u2019s first time on your website and whether they will return and make a purchase.", "I have decided to test whether these two fields are good inputs for my classification model:", "Question: What are the risks of only using the above two fields?", "Answer: Machine learning is only as good as the training data that is fed into it. If there isn\u2019t enough information for the model to determine and learn the relationship between the input features and label (in this case, whether the visitor bought in the future) then we will not have an accurate model. While training a model on just these two fields is a start, we will see if they\u2019re good enough to produce an accurate model.", "Question: Which fields are the input features and the label?", "Answer: The inputs are bounces and time_on_site. The label is will_buy_on_return_visit.", "Question: Which two fields are known after a visitor\u2019s first session?", "Answer: bounces and time_on_site are known after a visitor\u2019s first session.", "Question: Which field isn\u2019t known until later in the future?", "Answer: will_buy_on_return_visit is not known after the first visit. Again, you\u2019re predicting for a subset of users who returned to your website and purchased. Since you don\u2019t know the future at prediction time, you cannot say with certainty whether a new visitor come back and purchase. The value of building an ML model is to get the probability of future purchase based on the data gleaned about their first session.", "2- Create a BigQuery dataset to store models.", "3- Select a BQML model type and specify options.", "Now that we have our initial features selected, we are now ready to create your first ML model in BigQuery.", "Note: There are many additional model types used in Machine Learning (like Neural Networks and decision trees) and available using libraries like TensorFlow. At this time of writing, BQML supports the three listed above.", "Which model type should you choose?", "Since we are bucketing visitors into \u201cwill buy in future\u201d or \u201cwon\u2019t buy in future\u201d, we will use logistic_reg in a classification model.", "The following query creates a model and specifies model options. Run this query to train model:", "Note: We cannot feed all of our available data to the model during training since we need to save some unseen data points for model evaluation and testing. To accomplish this, add a WHERE clause condition is being used to filter and train on only the first 9 months of session data in your 12 month dataset.", "We can see the Four main Parameter for any Machine learning Model highlighted above:", "Model type, Loss func type, training data and Evaluation Dataset.", "For classification problems in ML, we want to minimize the False Positive Rate (predict that the user will return and purchase and they don\u2019t) and maximize the True Positive Rate (predict that the user will return and purchase and they do).", "This relationship is visualized with a ROC (Receiver Operating Characteristic) curve like the one shown here, where we try to maximize the area under the curve or AUC:", "5- Improve model performance with Feature Engineering.", "As was hinted at earlier, there are many more features in the dataset that may help the model better understand the relationship between a visitor\u2019s first session and the likelihood that they will purchase on a subsequent visit.", "We will add some new features and create a second machine learning model called classification_model_2:", "Creating the second model by running the below query:", "6- Predict which new visitors will come back and purchase.", "Next you will write a query to predict which new visitors will come back and make a purchase.", "The prediction query below uses the improved classification model to predict the probability that a first-time visitor to the Google Merchandise Store will make a purchase in a later visit:", "Our model now outputs its predictions for those July 2017 ecommerce sessions. We can see three newly added fields:", "3- Pattern Recognition and Machine Learning-Christopher M. Bishop.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Scientist & Living in Google Cloud."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F761f1df895b4&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuild-a-classification-model-in-bigquery-machine-learning-for-ecommerce-761f1df895b4&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuild-a-classification-model-in-bigquery-machine-learning-for-ecommerce-761f1df895b4&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuild-a-classification-model-in-bigquery-machine-learning-for-ecommerce-761f1df895b4&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuild-a-classification-model-in-bigquery-machine-learning-for-ecommerce-761f1df895b4&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----761f1df895b4--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----761f1df895b4--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@A7mad.mohamed?source=post_page-----761f1df895b4--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@A7mad.mohamed?source=post_page-----761f1df895b4--------------------------------", "anchor_text": "Ahmed Mohamed"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F622999265709&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuild-a-classification-model-in-bigquery-machine-learning-for-ecommerce-761f1df895b4&user=Ahmed+Mohamed&userId=622999265709&source=post_page-622999265709----761f1df895b4---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F761f1df895b4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuild-a-classification-model-in-bigquery-machine-learning-for-ecommerce-761f1df895b4&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F761f1df895b4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuild-a-classification-model-in-bigquery-machine-learning-for-ecommerce-761f1df895b4&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://www.en.advertisercommunity.com/t5/Articles/Introducing-the-Google-Analytics-Sample-Dataset-for-BigQuery/ba-p/1676331#", "anchor_text": "ecommerce dataset"}, {"url": "https://shop.googlemerchandisestore.com/", "anchor_text": "Google Merchandise Store"}, {"url": "https://github.com/Ahmed0028/Google-Cloud-Platform-BigQuerML-/blob/master/code.txt", "anchor_text": "here"}, {"url": "https://console.cloud.google.com/bigquery?p=data-to-insights&d=ecommerce&t=web_analytics&page=table&pli=1", "anchor_text": "link"}, {"url": "https://shop.googlemerchandisestore.com/", "anchor_text": "Google Merchandise Store"}, {"url": "https://support.google.com/analytics/answer/3437719?hl=en", "anchor_text": "here"}, {"url": "https://bigquery.cloud.google.com/table/data-to-insights:ecommerce.web_analytics?tab=preview", "anchor_text": "preview the demo dataset"}, {"url": "https://www.tensorflow.org/tutorials/", "anchor_text": "TensorFlow"}, {"url": "https://cloud.google.com/bigquery-ml/docs/bigqueryml-intro", "anchor_text": "https://cloud.google.com/bigquery-ml/docs/bigqueryml-intro"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F761f1df895b4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuild-a-classification-model-in-bigquery-machine-learning-for-ecommerce-761f1df895b4&user=Ahmed+Mohamed&userId=622999265709&source=-----761f1df895b4---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F761f1df895b4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuild-a-classification-model-in-bigquery-machine-learning-for-ecommerce-761f1df895b4&user=Ahmed+Mohamed&userId=622999265709&source=-----761f1df895b4---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F761f1df895b4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuild-a-classification-model-in-bigquery-machine-learning-for-ecommerce-761f1df895b4&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----761f1df895b4--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F761f1df895b4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuild-a-classification-model-in-bigquery-machine-learning-for-ecommerce-761f1df895b4&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----761f1df895b4---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----761f1df895b4--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----761f1df895b4--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----761f1df895b4--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----761f1df895b4--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----761f1df895b4--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----761f1df895b4--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----761f1df895b4--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----761f1df895b4--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@A7mad.mohamed?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@A7mad.mohamed?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Ahmed Mohamed"}, {"url": "https://medium.com/@A7mad.mohamed/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "8 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F622999265709&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuild-a-classification-model-in-bigquery-machine-learning-for-ecommerce-761f1df895b4&user=Ahmed+Mohamed&userId=622999265709&source=post_page-622999265709--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fusers%2F622999265709%2Flazily-enable-writer-subscription&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuild-a-classification-model-in-bigquery-machine-learning-for-ecommerce-761f1df895b4&user=Ahmed+Mohamed&userId=622999265709&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}