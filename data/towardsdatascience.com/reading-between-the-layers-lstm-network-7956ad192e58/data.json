{"url": "https://towardsdatascience.com/reading-between-the-layers-lstm-network-7956ad192e58", "time": 1682995115.497508, "path": "towardsdatascience.com/reading-between-the-layers-lstm-network-7956ad192e58/", "webpage": {"metadata": {"title": "Reading between the layers (LSTM Network) | by Samarth Agrawal | Towards Data Science", "h1": "Reading between the layers (LSTM Network)", "description": "We will refer to the LSTM Architecture that we have seen earlier in our Sentiment Analysis Tutorial. Link to the article here. 0. Tokenize : This is not a layer for LSTM network but a mandatory step\u2026"}, "outgoing_paragraph_urls": [{"url": "http://ai.stanford.edu/~amaas/data/sentiment/", "anchor_text": "IMDB movies review dataset", "paragraph_index": 4}, {"url": "https://towardsdatascience.com/sentiment-analysis-using-lstm-step-by-step-50d074f09948", "anchor_text": "here", "paragraph_index": 4}, {"url": "https://towardsdatascience.com/sentiment-analysis-using-lstm-step-by-step-50d074f09948", "anchor_text": "Sentiment Analysis model using LSTM", "paragraph_index": 4}], "all_paragraphs": ["One of the most crucial part of building a Deep Neural Network is\u2014 to have a clear view on your data as it flows through layers undergoing change in dimensions, alteration in shape, flattening and then re-shaping\u2026", "We will refer to the LSTM Architecture that we have seen earlier in our Sentiment Analysis Tutorial. Link to the article here.", "0. Tokenize : This is not a layer for LSTM network but a mandatory step of converting our words into tokens (integers)", "Before you define the Model Class it will give a good insight to have a closer look at each of the layers. This will help you get more clarity on how to prepare your inputs for Embedding, LSTM, Linear layers of your model architecture", "We are using IMDB movies review dataset, data processing and preparation steps are already done. Click here, if you need to revisit those steps. We are starting off with dataloaders (where we have defined batch_size=50 and sequence length=200). As per my article on building Sentiment Analysis model using LSTM, we are looking at Step 14 with a microscope \u2014", "From the shape of X we can see that X is a tensor of 50 rows (=batch size) & 200 columns (=sequence length). This assures that our process of tokenization is working fine. This X will go as input into Embedding layer", "The module that allows you to use Embedding is torch.nn.Embedding. It takes two parameters : the vocabulary size and the dimensionality of the embedding", "From the output of embedding layer we can see it has created a 3 dimensional tensor as a result of embedding weights. Now it has 50 rows, 200 columns and 30 embedding dimension i.e. for each tokenized word in our review we have added embedding dimension. This data will now go to LSTM Layer", "While defining the LSTM layer we have kept Batch First = True and number of hidden units = 512.", "By looking at the output of LSTM layer we see that our tensor is now has 50 rows, 200 columns and 512 LSTM nodes. Next this data is fetched into Fully Connected layer", "For fully connected layer, number of input features = number of hidden units in LSTM. Output Size = 1 because we only binary outcome (1/0; Positive/Negative)", "Note that before putting the lstm output into fc layer it has to be flattened out.", "This is needed just to turn all output value from fully connected layer into a value between 0 and 1", "This includes two steps: First, to reshape the output such that rows = batch size", "Second, as we see in the Network Architecture \u2014 we only want the output after the last sequence (after the last timestep)", "These outputs are from an untrained network and hence the values might not indicate anything yet. This was just for the sake of illustration and we will use this knowledge to define the model correctly.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "15 years in Data Science. I'm sharing valuable tips, ideas, and code snippets on Machine Learning & Deep Learning"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F7956ad192e58&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Freading-between-the-layers-lstm-network-7956ad192e58&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Freading-between-the-layers-lstm-network-7956ad192e58&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Freading-between-the-layers-lstm-network-7956ad192e58&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Freading-between-the-layers-lstm-network-7956ad192e58&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----7956ad192e58--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----7956ad192e58--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://samarthagrawal86.medium.com/?source=post_page-----7956ad192e58--------------------------------", "anchor_text": ""}, {"url": "https://samarthagrawal86.medium.com/?source=post_page-----7956ad192e58--------------------------------", "anchor_text": "Samarth Agrawal"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F2c9c1e60de25&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Freading-between-the-layers-lstm-network-7956ad192e58&user=Samarth+Agrawal&userId=2c9c1e60de25&source=post_page-2c9c1e60de25----7956ad192e58---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F7956ad192e58&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Freading-between-the-layers-lstm-network-7956ad192e58&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F7956ad192e58&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Freading-between-the-layers-lstm-network-7956ad192e58&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@pawelskor?utm_source=medium&utm_medium=referral", "anchor_text": "Paul Skorupskas"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://towardsdatascience.com/sentiment-analysis-using-lstm-step-by-step-50d074f09948", "anchor_text": "Sentiment Analysis using LSTM Step-by-StepUsing PyTorch framework for Deep Learningtowardsdatascience.com"}, {"url": "http://ai.stanford.edu/~amaas/data/sentiment/", "anchor_text": "IMDB movies review dataset"}, {"url": "https://towardsdatascience.com/sentiment-analysis-using-lstm-step-by-step-50d074f09948", "anchor_text": "here"}, {"url": "https://towardsdatascience.com/sentiment-analysis-using-lstm-step-by-step-50d074f09948", "anchor_text": "Sentiment Analysis model using LSTM"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----7956ad192e58---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----7956ad192e58---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----7956ad192e58---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/nlp?source=post_page-----7956ad192e58---------------nlp-----------------", "anchor_text": "NLP"}, {"url": "https://medium.com/tag/lstm?source=post_page-----7956ad192e58---------------lstm-----------------", "anchor_text": "Lstm"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F7956ad192e58&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Freading-between-the-layers-lstm-network-7956ad192e58&user=Samarth+Agrawal&userId=2c9c1e60de25&source=-----7956ad192e58---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F7956ad192e58&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Freading-between-the-layers-lstm-network-7956ad192e58&user=Samarth+Agrawal&userId=2c9c1e60de25&source=-----7956ad192e58---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F7956ad192e58&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Freading-between-the-layers-lstm-network-7956ad192e58&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----7956ad192e58--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F7956ad192e58&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Freading-between-the-layers-lstm-network-7956ad192e58&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----7956ad192e58---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----7956ad192e58--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----7956ad192e58--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----7956ad192e58--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----7956ad192e58--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----7956ad192e58--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----7956ad192e58--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----7956ad192e58--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----7956ad192e58--------------------------------", "anchor_text": ""}, {"url": "https://samarthagrawal86.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://samarthagrawal86.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Samarth Agrawal"}, {"url": "https://samarthagrawal86.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "491 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F2c9c1e60de25&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Freading-between-the-layers-lstm-network-7956ad192e58&user=Samarth+Agrawal&userId=2c9c1e60de25&source=post_page-2c9c1e60de25--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fd946063b0300&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Freading-between-the-layers-lstm-network-7956ad192e58&newsletterV3=2c9c1e60de25&newsletterV3Id=d946063b0300&user=Samarth+Agrawal&userId=2c9c1e60de25&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}