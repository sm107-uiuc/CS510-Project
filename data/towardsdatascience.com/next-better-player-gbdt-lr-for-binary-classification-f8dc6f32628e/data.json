{"url": "https://towardsdatascience.com/next-better-player-gbdt-lr-for-binary-classification-f8dc6f32628e", "time": 1683001218.61109, "path": "towardsdatascience.com/next-better-player-gbdt-lr-for-binary-classification-f8dc6f32628e/", "webpage": {"metadata": {"title": "Next Better Player? GBDT + LR for Binary Classification | by Sun Weiran | Towards Data Science", "h1": "Next Better Player? GBDT + LR for Binary Classification", "description": "From the paper Practical Lessons from Predicting Clicks on Ads at Facebook released in 2014, Facebook introduced this algorithm by combining decision trees and logistic regression for their click\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.semanticscholar.org/paper/Practical-Lessons-from-Predicting-Clicks-on-Ads-at-He-Pan/daf9ed5dc6c6bad5367d7fd8561527da30e9b8dd", "anchor_text": "Practical Lessons from Predicting Clicks on Ads at Facebook", "paragraph_index": 1}, {"url": "https://archive.ics.uci.edu/ml/datasets/Credit+Approval", "anchor_text": "Credit Approval", "paragraph_index": 8}, {"url": "https://gist.github.com/ianforme/6459aefb61323c529a51026e2e50bc5f", "anchor_text": "Source code", "paragraph_index": 8}, {"url": "https://gist.github.com/ianforme/6459aefb61323c529a51026e2e50bc5f", "anchor_text": "here", "paragraph_index": 18}], "all_paragraphs": ["Stacking Gradient Boosting Decision Tree (GBDT) with logistic regression can be a very effective algorithm in solving binary classification problems, for example. CTR prediction.", "From the paper Practical Lessons from Predicting Clicks on Ads at Facebook released in 2014, Facebook introduced this algorithm by combining decision trees and logistic regression for their click prediction system. This algorithm improves system performance by 3%, which makes a significant impact on the online business.", "In this article, I will be going through the following agenda:", "Both GBDT and logistic regression are well-known classification models. GBDT-LR algorithm combines these two models by taking the index of the prediction leaf node for every tree as the sparse input for the linear classifier, logistic regression.", "Let\u2019s assume we have trained and tuned a GBDT model with 300 trees and each tree with 3 leaf nodes. The second step is to use this model to predict on the training dataset again. However, instead of outputting the label, index of the prediction leaf node is returned for each of the 300 trees.", "In the above example, the first tree returns 3 since the prediction is on the third leaf node. Similarly, the second tree returns 2 and the last tree returns 1. The output from the GBDT model will look like [3,2, \u2026. ,1]. Since the model contains 300 trees, this list should have 300 elements.", "Next, every number in the list is one-hot encoded. For example, 3 becomes [0,0,1], 2 becomes [0,1,0] and 1 becomes [1,0,0]. These one-hot lists are appended together to form the input for the logistic regression model. Since every tree contains 3 leaf nodes, the final list should have 300 * 3 elements.", "Now, we have successfully constructed training dataset for the logistic regression. It is obvious that the input data is very sparse. Hence L1 regularisation is used to address this problem and avoid overfitting.", "Let\u2019s go through the Python implementation with UCI Credit Approval dataset. Source code is available. The dataset contains 15 different nominal and ordinal features (A1 to A15) and a binary target label (A16).", "To quickly process the data, records with missing values are dropped. Categorical features are one-hot encoded.", "Firstly, let\u2019s train one GBDT and one logistic regression model for benchmark purpose. For GBDT, grid search is used to find the most optimal parameters. ROCAUC score is selected as the evaluation metric.", "As you can see from the above script, I use lightgbm to train the GBDT model. Lightgbm classifier is suitable for this algorithm because we can specify number of leaf nodes in each tree by adjusting \u2018num_leaves\u2019 parameter. Number of trees is controlled by \u2018n_estimators\u2019.", "Next, we will use the trained GBDT model to predict on the train and test data. Set \u2018pred_leaf\u2019 to be True in \u2018predict\u2019 function to output the index of prediction leaf node for each tree.", "Lastly, we need to transform GBDT output to one-hot format and use the sparse data to train a logistic regression with L1 regularisation.", "Boom! GBDT-LR algorithm achieves a ROCAUC score of 0.86, which outperforms the baseline GBDT (0.83) and LR (0.82) models.", "So far, everything looks great right? However, this dataset is quite small. It only contains 653 records after processing. Therefore, we are training small trees with only 20 leaf nodes. Imagine we have a much larger dataset with more features that require more leaf nodes and more trees in the GBDT model, the one-hot encoded output can be very huge.", "The size of the matrix can be calculated by records number * leaf nodes number * trees number. We need to handle this matrix carefully when we are solving complex problems. One potential solution is to convert this matrix into a sparse matrix object.", "Note that by converting the one-hot matrix into a sparse matrix, RAM usage reduces from 4,272 bytes to 56 bytes. However, this trick gives more load to CPU computation as processing time increases from 419 ms to 898 ms.", "Again, code used as example above are available @ here.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Ff8dc6f32628e&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnext-better-player-gbdt-lr-for-binary-classification-f8dc6f32628e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnext-better-player-gbdt-lr-for-binary-classification-f8dc6f32628e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnext-better-player-gbdt-lr-for-binary-classification-f8dc6f32628e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnext-better-player-gbdt-lr-for-binary-classification-f8dc6f32628e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----f8dc6f32628e--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----f8dc6f32628e--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@sunwrn?source=post_page-----f8dc6f32628e--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@sunwrn?source=post_page-----f8dc6f32628e--------------------------------", "anchor_text": "Sun Weiran"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fedaaf0105f40&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnext-better-player-gbdt-lr-for-binary-classification-f8dc6f32628e&user=Sun+Weiran&userId=edaaf0105f40&source=post_page-edaaf0105f40----f8dc6f32628e---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ff8dc6f32628e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnext-better-player-gbdt-lr-for-binary-classification-f8dc6f32628e&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ff8dc6f32628e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnext-better-player-gbdt-lr-for-binary-classification-f8dc6f32628e&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://www.semanticscholar.org/paper/Practical-Lessons-from-Predicting-Clicks-on-Ads-at-He-Pan/daf9ed5dc6c6bad5367d7fd8561527da30e9b8dd", "anchor_text": "Practical Lessons from Predicting Clicks on Ads at Facebook"}, {"url": "https://archive.ics.uci.edu/ml/datasets/Credit+Approval", "anchor_text": "Credit Approval"}, {"url": "https://archive.ics.uci.edu/ml/datasets/Credit+Approval", "anchor_text": "Credit Approval"}, {"url": "https://gist.github.com/ianforme/6459aefb61323c529a51026e2e50bc5f", "anchor_text": "Source code"}, {"url": "https://gist.github.com/ianforme/6459aefb61323c529a51026e2e50bc5f", "anchor_text": "here"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----f8dc6f32628e---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----f8dc6f32628e---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/algorithms?source=post_page-----f8dc6f32628e---------------algorithms-----------------", "anchor_text": "Algorithms"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Ff8dc6f32628e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnext-better-player-gbdt-lr-for-binary-classification-f8dc6f32628e&user=Sun+Weiran&userId=edaaf0105f40&source=-----f8dc6f32628e---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Ff8dc6f32628e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnext-better-player-gbdt-lr-for-binary-classification-f8dc6f32628e&user=Sun+Weiran&userId=edaaf0105f40&source=-----f8dc6f32628e---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ff8dc6f32628e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnext-better-player-gbdt-lr-for-binary-classification-f8dc6f32628e&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----f8dc6f32628e--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Ff8dc6f32628e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnext-better-player-gbdt-lr-for-binary-classification-f8dc6f32628e&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----f8dc6f32628e---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----f8dc6f32628e--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----f8dc6f32628e--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----f8dc6f32628e--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----f8dc6f32628e--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----f8dc6f32628e--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----f8dc6f32628e--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----f8dc6f32628e--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----f8dc6f32628e--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@sunwrn?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@sunwrn?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Sun Weiran"}, {"url": "https://medium.com/@sunwrn/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "122 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fedaaf0105f40&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnext-better-player-gbdt-lr-for-binary-classification-f8dc6f32628e&user=Sun+Weiran&userId=edaaf0105f40&source=post_page-edaaf0105f40--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fc88b76ff5c64&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnext-better-player-gbdt-lr-for-binary-classification-f8dc6f32628e&newsletterV3=edaaf0105f40&newsletterV3Id=c88b76ff5c64&user=Sun+Weiran&userId=edaaf0105f40&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}