{"url": "https://towardsdatascience.com/data-preparation-guide-for-detecting-histopathologic-cancer-detection-7b96d6a12004", "time": 1683015721.8577988, "path": "towardsdatascience.com/data-preparation-guide-for-detecting-histopathologic-cancer-detection-7b96d6a12004/", "webpage": {"metadata": {"title": "Data Preparation Guide for Histopathologic Cancer Detection | by Abdul Qadir | Towards Data Science", "h1": "Data Preparation Guide for Histopathologic Cancer Detection", "description": "Kaggle serves as a wonderful host to Data Science and Machine Learning challenges. One of them is the Histopathologic Cancer Detection Challenge. In this challenge, we are provided with a dataset of\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.kaggle.com/c/histopathologic-cancer-detection", "anchor_text": "Histopathologic Cancer Detection Challenge", "paragraph_index": 0}, {"url": "https://www.kaggle.com/qitvision/a-complete-ml-pipeline-fast-ai", "anchor_text": "here", "paragraph_index": 9}, {"url": "https://towardsdatascience.com/methods-for-dealing-with-imbalanced-data-5b761be45a18", "anchor_text": "here.", "paragraph_index": 17}, {"url": "https://towardsdatascience.com/keras-data-generators-and-how-to-use-them-b69129ed779c", "anchor_text": "they also perform image augmentation", "paragraph_index": 18}, {"url": "https://github.com/DarthQadir/Histopathlogic-Cancer-Data-Preprocessing", "anchor_text": "here", "paragraph_index": 22}], "all_paragraphs": ["Kaggle serves as a wonderful host to Data Science and Machine Learning challenges. One of them is the Histopathologic Cancer Detection Challenge. In this challenge, we are provided with a dataset of images on which we are supposed to create an algorithm (it says algorithm and not explicitly a machine learning model, so if you are a genius with an alternate way to detect metastatic cancer in images; go for it!) to detect metastatic cancer.", "This article serves as a guide on how to prepare Kaggle\u2019s dataset and the guide covers the following 4 things:", "Download the kaggle package using the commands below. I ran them in Google\u2019s Colab but you should just be able to do it using your command line/Jupyter Notebook.", "In order to use Kaggle\u2019s API to download the data with your account, you need to do the following two things.", "Then run the code below which uses the json file to grant access, and download the dataset.", "Extract the zipfile. It takes a few minutes because it is around 6\u20137 GB worth of data.", "At this point, you should have two folders, and two csv files.", "What is Data Augmentation and why do we do it? In its essence, data augmentation is a way to increase the size of our image dataset by introducing slight changes to our data. The goal is for our model to generalize to more examples which are introduced through image augmentation. More importantly, image augmentation also allows our model to generalize different versions of different kinds of image.", "Look at the image below. Suppose the terribly drawn cat on the left is from a training dataset, but the cat on the right is in the test dataset. They are, quite literally, the same image except that the image on the right is flipped. A human is able to easily notice that, but a model may not be able to succeed at this task and will fail at identifying it in the test dataset. Ideally, you want your model to not care about variations in images, and correctly classify the image, which is why you introduce augmented versions of images so the model can generalize better.", "Here is code for a function that augments images by applying various transformations to them such as varying the contrast of an image, increasing its brightness, applying random rotations/shifts. The code was referenced from here.", "We then use this function to augment our extracted images in the \u2018train\u2019 folder. The code below generates an X amount of new images (based on a variable called \u2018images_to_generate\u2019 that you can change) by randomly choosing images from our train set, applying the augmentation function above, then saving the image in the train folder with an \u2018augmented\u2019 + its previous ID as the new name. Lastly, we also append the label and name to train_labels csv file and save a new csv file which also contains the ID and labels to the augmented images.", "In machine learning, we want to ensure that our model is able to work well on all types of data we throw at it! One problem that can arise if we blindly use all our available training data is the case of imbalanced class/target distributions. What this means is that your dataset contains more observations of one or more classes than the other classes. If we train our model on this complete dataset, our model will get really good at predicting the class with more data points, while performing poorly at classifying other classes. Let\u2019s see what happens in the case of our cancer detection model!", "If we observe our training dataset, we will realize that it is imbalanced. Running the code below shows that we have around 130000 images without cancer, and around 90000 images with cancer. As mentioned before, training using an imbalanced dataset can cause our model to become awesome at recognizing one class, while failing miserably on other classes. The minority class, in this case, is the one with detected cancer cells, and we really do not want to fail at classifying images with cancer; since doing so results in people going about their lives with undiagnosed cancer, when they should be getting treated!", "To fix this, we can drop images from the no cancer (0) class which is done below. I dropped more than necessary images just for faster training, but we could have simply kept it to a 95000:93099 ratio. The code below drops the images and keeps the distribution of classes equal.", "One more step is that we need to divide our data into a training, test, and validation set. A training set is used to train our model, a validation set is used to tune hyperparameters for our model, and the test set is used to check the performance of the model. The code snippet below does the split in a 60:20:20 ratio for train:test:validation.", "In the example above, we had the luxury of having a meaty dataset from which we could drop data points to balance class distributions; however, what if we don\u2019t have the luxury of dropping data? What if we need as much data as possible?", "There are a few ways to go about this:", "These are just two approaches, and you can find more here.", "Machine learning models use data stored in the computer/server\u2019s memory. Sometimes, the dataset is small enough to fit in the memory; but in most practical cases, it is not. To overcome this, we can use generators (they also perform image augmentation, but I manually performed that above instead) which take our images, and pass them to the machine learning model in batches instead of all at once. To do this, we need our images stored in a specific directory structure. The directory for this example should be in the format below.", "Assuming you are in the project base directory, it should be:", "The training data folder has two sub-folders, which have images of each class. The testing and validation data folders are similarly structured. The code below creates these directories.", "Once we have created the directories, we have the transfer the respective images to these directories. The code below does that. It takes around 30 minutes on colab to do so since we have to transfer 160000 images.", "Great! At this point, you should have your dataset set up to feed into your model. The complete A-Z repository can be found here!", "Hopefully, you found this article and notebook useful in understanding preprocessing data for the challenge, and preprocessing in general.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data for good. Senior @ Minerva Schools at KGI."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F7b96d6a12004&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-preparation-guide-for-detecting-histopathologic-cancer-detection-7b96d6a12004&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-preparation-guide-for-detecting-histopathologic-cancer-detection-7b96d6a12004&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-preparation-guide-for-detecting-histopathologic-cancer-detection-7b96d6a12004&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-preparation-guide-for-detecting-histopathologic-cancer-detection-7b96d6a12004&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----7b96d6a12004--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----7b96d6a12004--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://aq-abdulqadir.medium.com/?source=post_page-----7b96d6a12004--------------------------------", "anchor_text": ""}, {"url": "https://aq-abdulqadir.medium.com/?source=post_page-----7b96d6a12004--------------------------------", "anchor_text": "Abdul Qadir"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F3fe3f6822076&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-preparation-guide-for-detecting-histopathologic-cancer-detection-7b96d6a12004&user=Abdul+Qadir&userId=3fe3f6822076&source=post_page-3fe3f6822076----7b96d6a12004---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F7b96d6a12004&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-preparation-guide-for-detecting-histopathologic-cancer-detection-7b96d6a12004&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F7b96d6a12004&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-preparation-guide-for-detecting-histopathologic-cancer-detection-7b96d6a12004&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@nci?utm_source=medium&utm_medium=referral", "anchor_text": "National Cancer Institute"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://www.kaggle.com/c/histopathologic-cancer-detection", "anchor_text": "Histopathologic Cancer Detection Challenge"}, {"url": "https://www.kaggle.com/qitvision/a-complete-ml-pipeline-fast-ai", "anchor_text": "here"}, {"url": "https://scikit-learn.org/stable/modules/density.html", "anchor_text": "Kernel Density Estimation"}, {"url": "https://towardsdatascience.com/methods-for-dealing-with-imbalanced-data-5b761be45a18", "anchor_text": "here."}, {"url": "https://towardsdatascience.com/keras-data-generators-and-how-to-use-them-b69129ed779c", "anchor_text": "they also perform image augmentation"}, {"url": "https://github.com/DarthQadir/Histopathlogic-Cancer-Data-Preprocessing", "anchor_text": "here"}, {"url": "https://www.kaggle.com/c/histopathologic-cancer-detection", "anchor_text": "https://www.kaggle.com/c/histopathologic-cancer-detection"}, {"url": "https://www.kaggle.com/qitvision/a-complete-ml-pipeline-fast-ai", "anchor_text": "https://www.kaggle.com/qitvision/a-complete-ml-pipeline-fast-ai"}, {"url": "https://towardsdatascience.com/keras-data-generators-and-how-to-use-them-b69129ed779c", "anchor_text": "https://towardsdatascience.com/keras-data-generators-and-how-to-use-them-b69129ed779c"}, {"url": "https://github.com/DarthQadir/Cancer-Data-Preprocessing-Medium-Article/blob/master/Cancer_Detection_Preprocessing.ipynb", "anchor_text": "https://github.com/DarthQadir/Cancer-Data-Preprocessing-Medium-Article/blob/master/Cancer_Detection_Preprocessing.ipynb"}, {"url": "https://scikit-learn.org/stable/modules/density.html", "anchor_text": "https://scikit-learn.org/stable/modules/density.html"}, {"url": "https://towardsdatascience.com/methods-for-dealing-with-imbalanced-data-5b761be45a18", "anchor_text": "https://towardsdatascience.com/methods-for-dealing-with-imbalanced-data-5b761be45a18"}, {"url": "https://medium.com/tag/kaggle-competition?source=post_page-----7b96d6a12004---------------kaggle_competition-----------------", "anchor_text": "Kaggle Competition"}, {"url": "https://medium.com/tag/cancer-detection?source=post_page-----7b96d6a12004---------------cancer_detection-----------------", "anchor_text": "Cancer Detection"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----7b96d6a12004---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/python?source=post_page-----7b96d6a12004---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/keras?source=post_page-----7b96d6a12004---------------keras-----------------", "anchor_text": "Keras"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F7b96d6a12004&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-preparation-guide-for-detecting-histopathologic-cancer-detection-7b96d6a12004&user=Abdul+Qadir&userId=3fe3f6822076&source=-----7b96d6a12004---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F7b96d6a12004&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-preparation-guide-for-detecting-histopathologic-cancer-detection-7b96d6a12004&user=Abdul+Qadir&userId=3fe3f6822076&source=-----7b96d6a12004---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F7b96d6a12004&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-preparation-guide-for-detecting-histopathologic-cancer-detection-7b96d6a12004&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----7b96d6a12004--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F7b96d6a12004&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-preparation-guide-for-detecting-histopathologic-cancer-detection-7b96d6a12004&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----7b96d6a12004---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----7b96d6a12004--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----7b96d6a12004--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----7b96d6a12004--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----7b96d6a12004--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----7b96d6a12004--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----7b96d6a12004--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----7b96d6a12004--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----7b96d6a12004--------------------------------", "anchor_text": ""}, {"url": "https://aq-abdulqadir.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://aq-abdulqadir.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Abdul Qadir"}, {"url": "https://aq-abdulqadir.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "10 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F3fe3f6822076&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-preparation-guide-for-detecting-histopathologic-cancer-detection-7b96d6a12004&user=Abdul+Qadir&userId=3fe3f6822076&source=post_page-3fe3f6822076--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fb7ef92a743a0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-preparation-guide-for-detecting-histopathologic-cancer-detection-7b96d6a12004&newsletterV3=3fe3f6822076&newsletterV3Id=b7ef92a743a0&user=Abdul+Qadir&userId=3fe3f6822076&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}