{"url": "https://towardsdatascience.com/do-you-really-need-trash-cans-6837921d127c", "time": 1683004290.961052, "path": "towardsdatascience.com/do-you-really-need-trash-cans-6837921d127c/", "webpage": {"metadata": {"title": "Do You Really Need Trash Cans?. Predicting The Next Pitch with Machine\u2026 | by Parker Erickson | Towards Data Science", "h1": "Do You Really Need Trash Cans?", "description": "Using machine learning to predict the next baseball pitch."}, "outgoing_paragraph_urls": [{"url": "https://github.com/jldbc/pybaseball", "anchor_text": "pybaseball", "paragraph_index": 4}, {"url": "https://baseballsavant.mlb.com/", "anchor_text": "Statcast", "paragraph_index": 4}, {"url": "https://imbalanced-learn.readthedocs.io/en/stable/generated/imblearn.over_sampling.SMOTE.html", "anchor_text": "SMOTE", "paragraph_index": 5}, {"url": "https://parkererickson.github.io", "anchor_text": "https://parkererickson.github.io", "paragraph_index": 17}], "all_paragraphs": ["The 2019\u20132020 MLB off-season was dominated by the revelation that the Houston Astros stole opposing pitcher\u2019s signs during their 2017 World Series-winning season. This was accomplished by looking at a live camera feed from center field in an area just off the dugout and communicating the next pitch to the batter by banging on a trash can. This got me thinking, \u201cCould machine learning predict what pitch was coming next? Do you even need to be stealing signs, or just a computer?\u201d", "The Astros scheme has been very well covered by now. I won\u2019t delve into the specifics of their cheating, but two specific things are relevant to the goal of predicting the next pitch with machine learning. First, they only seemed to bang the trash can if the next pitch wasn\u2019t going to be a fastball. This means they were not specifying what specific type of pitch it was, but only communicating if the pitch was going to be off-speed. Second is that Rob Arthur from Baseball Prospectus determined that the Astros correctly determined that a non-fastball was coming towards the plate 93% of the time.", "\u201cBy and large, the Astros tended to get the signals right, but it was hardly perfect. They were most accurate when they whacked the can: When they did so, a non-fastball was on the way 93 percent of the time and they were wrong seven percent of the time. \u2026 Based on Adams\u2019 data, the Astros used the trash can frequently and they were relatively accurate, moreso when banging than when silent.\u201d", "So, in order for our machine learning model to be comparable to the Astros\u2019 scheme, it must predict between fastball and non-fastball pitches, and do so with a pretty high degree of accuracy.", "The great thing about applying analytics and machine learning to baseball is that there is a wealth of data freely available and easily accessible. Since I am using Python, I opted to use the pybaseball Python package, which provides a wrapper for Statcast data, which has entries of every pitch thrown in the MLB, including the game state, such as the inning, who is on base, and what the current count is. Also included are what hand the pitcher throws with and the hitter\u2019s stance. Crucially, Statcast also provides what type of pitch is thrown and its velocity. From this, I created a previous pitch and previous pitch velocity column.", "Once the data was pulled from Statcast and massaged a bit, I split it into a training and testing set. A problem that came up during the training process was that the dominant pitch in baseball is the fastball, and therefore there were many more cases of pitchers throwing a fastball then there was of pitchers throwing non-fastballs. This imbalance meant that the machine learning algorithms achieved very good accuracy by predicting the next pitch was always going to be a fastball. Obviously this isn\u2019t very helpful, so to counter this I used SMOTE to create synthetic non-fastball training data, leaving us with a balanced training dataset between all different types of pitches.", "In this analysis, we will use two different datasets, one consisting of Jose Berrios\u2019 pitches from the beginning of the 2017 season through the end of the 2019 season, and a set of all pitches thrown in every MLB game between April 1st, 2019 and April 7th, 2019. These two datasets will allow us to see if individual pitchers\u2019 habits are easier to predict compared to league-wide preferences on deciding what pitch to throw in a given situation.", "With these two different datasets, I also created a version of each that only contains if the pitch thrown was a fastball or a non-fastball. For this version of the data, I considered four-seam fastballs, two-seam fastballs, and cutters as \u201cfastballs\u201d and everything else as a non-fastball. I am taking an educated guess here that this is what the Astros considered a fastball as well.", "I started with some \u201cbasic\u201d machine learning models such as Decision Trees, SVMs and k-Nearest Neighbors. These models all had abysmal accuracy (lower than 50%) on all datasets. I then decided to feed the data into two different neural networks: one for each version of the dataset.", "These models achieved better accuracy than our other approaches, with the multi-pitch classifier achieving 74% accuracy on the test set, and the fastball/no-fastball classifier achieving 58% accuracy. It is unclear to me why there is such a discrepancy between these two classifiers, but lets dive into the confusion matrices they produced.", "Looking at the confusion matrix above, we can see how many of the pitches of a given type matched the predicted type by looking at the diagonal of the matrix. For example, the model correctly predicted 52% of the curveballs thrown. Looking across the rows of the matrix tells you what percentage of the true pitch were misclassified as a different type of pitch. Looking at the curveball row (labelled \u201cCU\u201d), we can see that 52% the model predicted successfully, while 20% of the time it predicted that a changeup was going to be the next pitch. A two-seam fastball was the next most predicted at 18% of the time, followed by a four-seam fastball at about 10% of the time. If you turned this into banging on a trash can, about 30% of the time you would be wrong. While the true accuracy of this model was pretty good, turning its predictions into actionable results would be difficult, and is still far behind the Astros\u2019 accuracy.", "Above is the confusion matrix for the fastball/non-fastball classifier. As you can see, our true positive and true negative rate was very similar, which leads us to the accuracy of about 58%. Unlike the multi-pitch classifier, the outcome was relatively balanced. This is a good thing, as we want to reduce both the number of false positives and false negatives, but both of these percentages result in a worse outcome for our trash can banger: only about 60% of the time they would be correct. Maybe our league-wide data will fare better?", "The league-wide classifier for all pitches was 88% accurate on the testing set, but as before, let's look at the confusion matrix below:", "As you can see, there isn\u2019t that much improvement in terms of improving the trash-can bang\u2019s accuracy compared to the pitcher-specific model. The model predicts correctly that a four-seam fastball is going to be thrown 43% of the time it actually is, with it predicting that a curveball or a slider is going to be thrown about 20% of the time. Including a two-seam fastball\u2019s prediction gets us to correctly predicting that the pitch is going to be either a four or two-seam fastball is only about 51%. Clearly still not good enough accuracy for the batters to gain any benefit from the model. Maybe the fastball/non-fastball classifier will produce better results this time?", "So, obviously this isn\u2019t a great outcome either. The test set accuracy was 57%, and as the confusion matrix shows, the number of false positives was extremely high. This means that our trash-can would bang 54% of the time there was a fastball coming, when it is only supposed to bang on a non-fastball pitch. The classifier did a slightly better job predicting when a non-fastball was coming, but still had a false negative rate of 32%. This means that the trash can wouldn\u2019t be banged 32% of the time a non-fastball was pitched. This model would be of absolutely no help to the batter.", "Coming into this project, I thought that machine learning might be able to predict what the next pitch would be to a high enough accuracy where it might be beneficial to a batter. This is obviously not the case. Even with some models producing an accuracy of greater than 75%, the false positive and false negative rates are great enough that there would be no discernible benefit. Different architectures of neural networks and more data surrounding each pitch could possibly produce better accuracy, but I\u2019m now skeptical if it would help that much. For now, however, the best way to know what the next pitch will be is to cheat.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Student at UMN. Interested in robotics, 3D printing, machine learning, and graph databases. https://parkererickson.github.io"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F6837921d127c&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdo-you-really-need-trash-cans-6837921d127c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdo-you-really-need-trash-cans-6837921d127c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdo-you-really-need-trash-cans-6837921d127c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdo-you-really-need-trash-cans-6837921d127c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----6837921d127c--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----6837921d127c--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@parker.erickson?source=post_page-----6837921d127c--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@parker.erickson?source=post_page-----6837921d127c--------------------------------", "anchor_text": "Parker Erickson"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F2406ce10c3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdo-you-really-need-trash-cans-6837921d127c&user=Parker+Erickson&userId=2406ce10c3&source=post_page-2406ce10c3----6837921d127c---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F6837921d127c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdo-you-really-need-trash-cans-6837921d127c&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F6837921d127c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdo-you-really-need-trash-cans-6837921d127c&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@jblesly?utm_source=medium&utm_medium=referral", "anchor_text": "Lesly Juarez"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://blogs.fangraphs.com/the-most-important-bangs-of-the-astros-scheme/", "anchor_text": "https://blogs.fangraphs.com/the-most-important-bangs-of-the-astros-scheme/"}, {"url": "https://github.com/jldbc/pybaseball", "anchor_text": "pybaseball"}, {"url": "https://baseballsavant.mlb.com/", "anchor_text": "Statcast"}, {"url": "https://imbalanced-learn.readthedocs.io/en/stable/generated/imblearn.over_sampling.SMOTE.html", "anchor_text": "SMOTE"}, {"url": "https://www.daktronics.com/support/kb/Pages/DD3312647.aspx", "anchor_text": "https://www.daktronics.com/support/kb/Pages/DD3312647.aspx"}, {"url": "https://github.com/parkererickson/baseballDataScience/blob/master/nextPitchPrediction.ipynb", "anchor_text": "https://github.com/parkererickson/baseballDataScience/blob/master/nextPitchPrediction.ipynb"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----6837921d127c---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/baseball?source=post_page-----6837921d127c---------------baseball-----------------", "anchor_text": "Baseball"}, {"url": "https://medium.com/tag/data-science?source=post_page-----6837921d127c---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/programming?source=post_page-----6837921d127c---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/tag/towards-data-science?source=post_page-----6837921d127c---------------towards_data_science-----------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F6837921d127c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdo-you-really-need-trash-cans-6837921d127c&user=Parker+Erickson&userId=2406ce10c3&source=-----6837921d127c---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F6837921d127c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdo-you-really-need-trash-cans-6837921d127c&user=Parker+Erickson&userId=2406ce10c3&source=-----6837921d127c---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F6837921d127c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdo-you-really-need-trash-cans-6837921d127c&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----6837921d127c--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F6837921d127c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdo-you-really-need-trash-cans-6837921d127c&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----6837921d127c---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----6837921d127c--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----6837921d127c--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----6837921d127c--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----6837921d127c--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----6837921d127c--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----6837921d127c--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----6837921d127c--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----6837921d127c--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@parker.erickson?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@parker.erickson?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Parker Erickson"}, {"url": "https://medium.com/@parker.erickson/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "46 Followers"}, {"url": "https://parkererickson.github.io", "anchor_text": "https://parkererickson.github.io"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F2406ce10c3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdo-you-really-need-trash-cans-6837921d127c&user=Parker+Erickson&userId=2406ce10c3&source=post_page-2406ce10c3--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fb7104f4a9fa1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdo-you-really-need-trash-cans-6837921d127c&newsletterV3=2406ce10c3&newsletterV3Id=b7104f4a9fa1&user=Parker+Erickson&userId=2406ce10c3&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}