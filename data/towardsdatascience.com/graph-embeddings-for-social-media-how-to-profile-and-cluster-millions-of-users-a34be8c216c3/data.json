{"url": "https://towardsdatascience.com/graph-embeddings-for-social-media-how-to-profile-and-cluster-millions-of-users-a34be8c216c3", "time": 1683016013.9092941, "path": "towardsdatascience.com/graph-embeddings-for-social-media-how-to-profile-and-cluster-millions-of-users-a34be8c216c3/", "webpage": {"metadata": {"title": "Graph Embeddings For Social Media: How to Profile and Cluster Millions of Users | by Roberto | Towards Data Science", "h1": "Graph Embeddings For Social Media: How to Profile and Cluster Millions of Users", "description": "Although many different social media platforms already offer ways to discover similar user, this set of features are mainly built for the final user, meaning that the goal is to actually display them\u2026"}, "outgoing_paragraph_urls": [{"url": "https://en.wikipedia.org/wiki/Apriori_algorithm", "anchor_text": "apriori", "paragraph_index": 8}, {"url": "https://www.kdnuggets.com/2016/04/association-rules-apriori-algorithm-tutorial.html", "anchor_text": "confidence and lift", "paragraph_index": 9}, {"url": "https://projector.tensorflow.org/", "anchor_text": "Tensorflow Embedding projector", "paragraph_index": 13}, {"url": "https://docs.aws.amazon.com/sagemaker/latest/dg/blazingtext.html", "anchor_text": "BlazingText", "paragraph_index": 18}, {"url": "https://docs.aws.amazon.com/sagemaker/latest/dg/blazingtext_hyperparameters.html", "anchor_text": "official documentation", "paragraph_index": 21}, {"url": "https://radimrehurek.com/gensim/models/keyedvectors.html", "anchor_text": "keyedvectors", "paragraph_index": 24}, {"url": "https://radimrehurek.com/gensim/models/keyedvectors.html", "anchor_text": "format", "paragraph_index": 24}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.manifold.TSNE.html", "anchor_text": "TSNE", "paragraph_index": 32}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.decomposition.PCA.html", "anchor_text": "PCA", "paragraph_index": 32}, {"url": "https://projector.tensorflow.org/", "anchor_text": "Tensroflow Embedding Projector", "paragraph_index": 35}, {"url": "https://www.tensorflow.org/tensorboard/tensorboard_projector_plugin", "anchor_text": "here", "paragraph_index": 36}], "all_paragraphs": ["In this article, I want to present some findings in the field of social media mining, describing the implementation of a Word2Vec model applied for indexing an entire user base, providing a tool to find similar users within a community.", "Although many different social media platforms already offer ways to discover similar user, this set of features are mainly built for the final user, meaning that the goal is to actually display them what they want to see and not users that are actually similar to them under a business point of view.", "Algorithms able to target similar users are used behind tools such as Facebook Ads, which gives the advertiser the possibility to target users that are similar to a specific set of conditions such as brands, tastes, or other demographics data.", "Let\u2019s start with an example: we have a set of n users following a specific brand/profile. Each of those users can follow as well as n users. Often, inside a set of users that follow a specific brand, there are relationships among those users. Some users follow each other because they simply know each other, some other users follow a specific user since the latter is an \u201cinfluencer\u201d, some other users, among the same user base might follow a very well known brand.", "Having a \u201cmapped\u201d representation of a user base can help a business to answer different questions, among them:", "The main goal in this study is to create a numerical representation of each user inside a brand\u2019s community, the data available consists of a list of usernames together with a list of profile each user follows:", "If it is possible to numerically represent users inside a space, it is also possible to compute operations between users, such as calculate similarity, discover clusters and trends among a community.", "While in the phase of thinking about how to tackle this challenge, the main idea that came to my mind was to treat each user as a different itemset, similarly to when to shop in a store: we have our shopping basket (social media profile) and we fill this basked with things we want; different shopper do the same with their shopping basked, hence analyzing those data can help understand pattern among customers.", "This kind of task can be accomplished by implementing an algorithm such as apriori. This family of algorithms is commonly used in frequent itemset mining, it is not a machine learning approach but it comes from a set of algorithms called association rule learning.", "The problem in this approach is that it does not give the possibility to measure the similarity between instances, since every instance in the dataset is not transformed into a mathematical representation, but only represented using two fancy metrics: confidence and lift.", "However, the cool thing about apriori is the possibility it gives to represent association rules with graph charts, very useful for evaluation and reporting purposes.", "At that moment, it was necessary to take a step back and focus on the final goal: I need to find a way that lets me encode users in a mathematical way, preserving the relationships among them.", "While taking this step back to analyze the situation at a macro level, I realized that the main issue in this is to \u201ctransform\u201d usernames, into \u201cnumbers\u201d, hence the question was clear: Which algorithm, model, or whatever lets you transform text to number?", "Simultaneously, I realized there is already a very powerful tool called Tensorflow Embedding projector . It allows to project high dimensional data into a 3-dimensional space and automatically performs operations such as PCA (to reduce the number of dimensions) and calculates distances between vectors, hence it can display how much similar is a word to another.", "The main idea was trying to train a Word2Vec model based on user-followers data to test if this model would be able to learn relationships among users.", "Word2Vec is a neural network that is able to generate a dense representation of words. This algorithm, more specifically an unsupervised learning algorithm, try to predict a word based on its neighbors, hence, in this case, the algorithm would predict a follower based on a user.", "Word2Vec can be trained using mainly two different strategies: Skip-gram and CBOW.", "In CBOW a set of surrounding words (users) is combined to predict the word (user) in the middle. Oppositely, Skip-gram takes the word (users) in the middle to predict the context around.", "To actually implement this, I choose to use Amazon SageMaker along with its Word2Vec implementation, called BlazingText.", "The input data consists of a simple .txt file containing, for each user a comma-separated list of the profiles that particular user is following. The total size of the input data consists of around 5,2 million entries.", "The training is performed on a ml.c4.xlarge machine, using hyperparameters close to default, additionally, for budget reasons no hyperparameters optimization has been done.", "As the training strategy skip-gram has been chosen, the training was done for five epochs, using a min_count of 100 users to predict the next one (somewhat a reasonable amount to understand which kind of profiles a user follows.), for each output vector I chose a size of 100 dimensions. The rest of the hyperparameters has been left default. For the complete list of available hyperparameters refer to the official documentation.", "The training phase took around 9 hours.", "Understanding the correct way to evaluate this model is something that goes outside the scope of this article, however, a couple of interesting points surged:", "Once the training complete I ended up with a huge .tar.gz model, once uncompressed there are 2 files: vectors.txt and vectorz.bin which are perfectly compatible with the keyedvectors format provided by gensim .", "Reading the vectors using gensim is as easy and followers, moreover, we can do some manual test on the model using the most_similar method:", "To get an idea of how much precise and how good the model can understand differences between entities, especially when the difference is very subtle I decided to pick 2 well-known brands, Zara and Louis Vuitton.", "Zara is a fast-fashion retailer while Louis Vuitton is (still) considered a French fashion house and luxury goods company.", "Here the most common entities for each of them:", "From the above results, it seems that the model is able to differentiate between some Luxury and Fas Fashion brands, returning results that actually make sense.", "Let\u2019s try it with something different, this time tacking two musicians that belongs to two completely different genres, Lady Gaga and Solomun:", "Surprisingly, the model also learned vectors for different musicians, being able to return different pop/commercial artists for Lady Gaga and more Techno artists for Solomun.", "Going back to the interesting graph visualization mentioned before it is now also possible to do it: the model generates a 100-dimension vector for each entity, in order to plot it on a 2-D space is necessary to reduce the dimension, one way to achieve this is to use scikit-learn TSNE class which converts converting similarities between data points to join probabilities. Another way could be to compute a PCA.", "The following plot consists of the 300 most common vectors visualized using TSNE and matplotlib:", "It is evident that some clusters of data are present, meaning that the model successfully learned similarities across entities. For example, on the top-left corner, we can see some retail brands while on the bottom-right corner celebrities and some musicians.", "Finally, we can also export computed vectors and metadata into .tsv format, making it readable for another tool previously mentioned: Tensroflow Embedding Projector.", "The advantage here is that the embedding projector can compute different types of dimensionality reduction, giving the user the possibility to experiment with a few algorithms. Moreover, it is as simple as exporting the whole vectors and metadata from the Word2Vec model to the embedding projector and just load those files. A simple tutorial on how to do it can be found here.", "The following picture shows a 3-D PCA computed via the embedding projectors, the highlighted words represent the nearest points to the point labeled with \u201cchanelofficial\u201d.", "Another example, using \u201cbmw\u201d as a search query and the mythical dark mode:", "It is possible to see how in both examples the search query returned values that make sense in the context, in addition, comparing the values from the 2-D dimensionality reduction and the 3-D generated by the embedding projector, the latter one seems to be less \u201ccategorical\u201d and more inclusive, returning entities that aren\u2019t strictly part of the same category (Ex. Zara and h&m) but more opened toward a different idea of similarity (Ex. Mercedes and Rolex).", "At the end of this study some considerations can be made: the initial goal to provide a system able to identify similarities between entities seems to be fulfilled, however, the idea of how much one thing is similar to another is only something subjective or domain-oriented, for example, the similarity between two brands in the same domain could be distorted by the presence of other brands operating in completely different domains. Similarly to how the arithmetic means could be misleading the many outliers are in the sample.", "One more consideration is the way the Word2Vec model has been used in this context: vectorizing an entire dataset like the one in this study is helpful as a way to index instances in the dataset, meaning that a new entity (also known as out of vocabulary token) could be positioned vectorized and positioned in the space if, and only if the whole training process is repeated.", "For those reasons, I consider this tool more like an indexer, useful for a brand to discover similar instances in the user base. An example could be when looking for an influencer in the community, the brand manager could have an idea or know some users which could be good, however, a tool like this one could help managers to find other similar users in their community, which thanks to this algorithm have been indexed.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "+500K Views on Medium | Management Consultant | Data Science \ud83e\uddea | Tech \ud83d\udce1 | Entrepreneurship \u26a1| Fullstack development \ud83d\udcbb | Starting a YouTube channel \ud83c\udfa5"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fa34be8c216c3&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgraph-embeddings-for-social-media-how-to-profile-and-cluster-millions-of-users-a34be8c216c3&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgraph-embeddings-for-social-media-how-to-profile-and-cluster-millions-of-users-a34be8c216c3&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgraph-embeddings-for-social-media-how-to-profile-and-cluster-millions-of-users-a34be8c216c3&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgraph-embeddings-for-social-media-how-to-profile-and-cluster-millions-of-users-a34be8c216c3&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----a34be8c216c3--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----a34be8c216c3--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://robsanna.medium.com/?source=post_page-----a34be8c216c3--------------------------------", "anchor_text": ""}, {"url": "https://robsanna.medium.com/?source=post_page-----a34be8c216c3--------------------------------", "anchor_text": "Roberto"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F21007a38b704&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgraph-embeddings-for-social-media-how-to-profile-and-cluster-millions-of-users-a34be8c216c3&user=Roberto&userId=21007a38b704&source=post_page-21007a38b704----a34be8c216c3---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa34be8c216c3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgraph-embeddings-for-social-media-how-to-profile-and-cluster-millions-of-users-a34be8c216c3&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa34be8c216c3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgraph-embeddings-for-social-media-how-to-profile-and-cluster-millions-of-users-a34be8c216c3&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://towardsdatascience.com/tagged/hands-on-tutorials", "anchor_text": "Hands-on Tutorials"}, {"url": "https://en.wikipedia.org/wiki/Apriori_algorithm", "anchor_text": "apriori"}, {"url": "https://www.kdnuggets.com/2016/04/association-rules-apriori-algorithm-tutorial.html", "anchor_text": "confidence and lift"}, {"url": "https://www.kdnuggets.com/2016/04/association-rules-apriori-algorithm-tutorial.html", "anchor_text": "KDNuggets"}, {"url": "https://projector.tensorflow.org/", "anchor_text": "Tensorflow Embedding projector"}, {"url": "https://docs.aws.amazon.com/sagemaker/latest/dg/blazingtext.html", "anchor_text": "BlazingText"}, {"url": "https://docs.aws.amazon.com/sagemaker/latest/dg/blazingtext_hyperparameters.html", "anchor_text": "official documentation"}, {"url": "https://radimrehurek.com/gensim/models/keyedvectors.html", "anchor_text": "keyedvectors"}, {"url": "https://radimrehurek.com/gensim/models/keyedvectors.html", "anchor_text": "format"}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.manifold.TSNE.html", "anchor_text": "TSNE"}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.decomposition.PCA.html", "anchor_text": "PCA"}, {"url": "https://projector.tensorflow.org/", "anchor_text": "Tensroflow Embedding Projector"}, {"url": "https://www.tensorflow.org/tensorboard/tensorboard_projector_plugin", "anchor_text": "here"}, {"url": "https://relentless-creator-2481.ck.page/68d9def351", "anchor_text": "5-bullet Data Science & Tech \ud83d\udce1Edit descriptionrelentless-creator-2481.ck.page"}, {"url": "https://medium.com/tag/marketing?source=post_page-----a34be8c216c3---------------marketing-----------------", "anchor_text": "Marketing"}, {"url": "https://medium.com/tag/data-science?source=post_page-----a34be8c216c3---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/programming?source=post_page-----a34be8c216c3---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/tag/entrepreneurship?source=post_page-----a34be8c216c3---------------entrepreneurship-----------------", "anchor_text": "Entrepreneurship"}, {"url": "https://medium.com/tag/hands-on-tutorials?source=post_page-----a34be8c216c3---------------hands_on_tutorials-----------------", "anchor_text": "Hands On Tutorials"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fa34be8c216c3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgraph-embeddings-for-social-media-how-to-profile-and-cluster-millions-of-users-a34be8c216c3&user=Roberto&userId=21007a38b704&source=-----a34be8c216c3---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fa34be8c216c3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgraph-embeddings-for-social-media-how-to-profile-and-cluster-millions-of-users-a34be8c216c3&user=Roberto&userId=21007a38b704&source=-----a34be8c216c3---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa34be8c216c3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgraph-embeddings-for-social-media-how-to-profile-and-cluster-millions-of-users-a34be8c216c3&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----a34be8c216c3--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fa34be8c216c3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgraph-embeddings-for-social-media-how-to-profile-and-cluster-millions-of-users-a34be8c216c3&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----a34be8c216c3---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----a34be8c216c3--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----a34be8c216c3--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----a34be8c216c3--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----a34be8c216c3--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----a34be8c216c3--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----a34be8c216c3--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----a34be8c216c3--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----a34be8c216c3--------------------------------", "anchor_text": ""}, {"url": "https://robsanna.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://robsanna.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Roberto"}, {"url": "https://robsanna.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "1.1K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F21007a38b704&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgraph-embeddings-for-social-media-how-to-profile-and-cluster-millions-of-users-a34be8c216c3&user=Roberto&userId=21007a38b704&source=post_page-21007a38b704--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F8181ecd3a95f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgraph-embeddings-for-social-media-how-to-profile-and-cluster-millions-of-users-a34be8c216c3&newsletterV3=21007a38b704&newsletterV3Id=8181ecd3a95f&user=Roberto&userId=21007a38b704&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}