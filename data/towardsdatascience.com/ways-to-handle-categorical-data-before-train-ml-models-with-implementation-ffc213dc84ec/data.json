{"url": "https://towardsdatascience.com/ways-to-handle-categorical-data-before-train-ml-models-with-implementation-ffc213dc84ec", "time": 1683013667.782363, "path": "towardsdatascience.com/ways-to-handle-categorical-data-before-train-ml-models-with-implementation-ffc213dc84ec/", "webpage": {"metadata": {"title": "Ways To Handle Categorical Data With Implementation | by Ganesh Dhasade | Towards Data Science", "h1": "Ways To Handle Categorical Data With Implementation", "description": "In my last blogs, I explained types of missing values and different ways to handle Continous and Categorical missing values with implementation. After handle missing values in the dataset, the next\u2026"}, "outgoing_paragraph_urls": [{"url": "https://medium.com/@g.dhasade16/missing-data-its-types-9f59e897843f", "anchor_text": "types of missing values", "paragraph_index": 0}, {"url": "https://medium.com/swlh/ways-to-handle-continous-column-missing-data-its-implementations-4704f52ac9c3", "anchor_text": "Continous", "paragraph_index": 0}, {"url": "https://medium.com/analytics-vidhya/ways-to-handle-categorical-column-missing-data-its-implementations-15dc4a56893", "anchor_text": "Categorical", "paragraph_index": 0}, {"url": "https://www.kaggle.com/c/titanic", "anchor_text": "Kaggle dataset", "paragraph_index": 5}, {"url": "https://github.com/GDhasade/Medium.com_Contents/blob/master/Handle_Categorical_Data.ipynb", "anchor_text": "https://github.com/GDhasade/Medium.com_Contents/blob/master/Handle_Categorical_Data.ipynb", "paragraph_index": 35}], "all_paragraphs": ["In my last blogs, I explained types of missing values and different ways to handle Continous and Categorical missing values with implementation.", "After handle missing values in the dataset, the next step was to handle categorical data. In this blog, I will explain different ways to handle categorical features/columns along with implementation using python.", "Introduction: All Machine Learning models are some kind of mathematical model that needs numbers to work with. Categorical data have possible values (categories) and it can be in text form. For example, Gender: Male/Female/Others, Ranks: 1st/2nd/3rd, etc.", "While working on a data science project after handling the missing value of datasets. The next work is to handle categorical data in datasets before applying any ML models.", "First, let\u2019s understand the types of categorical data:", "The dataset used to explain is Titanic (Kaggle dataset):", "Description: Create dummies or binary type columns for each category in the object/ category type feature. The value for each row is 1 if that category is available in that row else 0. To create dummies use pandas get_dummies() function.", "Hence, This method is only useful when data having less categorical columns with fewer categories.", "Description: When the categorical variables are ordinal, the easiest approach is to replace each label/category by some ordinal number based on the ranks. In our data Pclass is ordinal feature having values First, Second, Third so each category replaced by its rank i.e 1,2,3 respectively.", "Step 1: Create a dictionary with key as category and values with its rank.", "Step 2: Create a new column and map the ordinal column with the created dictionary.", "Step 3: Drop the original column.", "Description: Replace each category with its frequency/number of time that category occurred in that column.", "Step 1. Create Dictionaries with key as category name and value with a count of categories i.e frequency of that category in each categorical column.", "Step 2. Create a new column which acts as a weight for that category and map with its respective dictionary.", "Description: Here, the category of the column has been replaced with its depending join probability ranking with respect to Target column.", "Implementation: To show the implementation I am using Cabin column with respect to Survived target column. The same steps are applicable for any ordinal column in the dataset.", "Step 1. Replace original cabin value with the first character of the cabin name.", "Step 2. Calculate the joint probability of each category based on the target column value.", "Step 3. Create a list with sorted index in ascending order of join probabilities.", "Step 4. Create a dictionary where key as category name in cabin and values as joint probability ranking.", "Step 5. Create a new column and map cabin values with dictionary joint probability ranking.", "Step 6. Delete original cabin column.", "Description: Simillar to target/guided encoding only difference is here we replace category with the mean value with respect to target column. Here also we implement with cabin and survived target column.", "Step 1. Calculate the mean for each category in the cabin column with respect to the target column (Survived).", "Step 2. Create a new column and replace by mean i.e map cabin column categories with its encoded mean dictionary.", "Step 3. Drop original cabin column", "Description: Here category of the column is replaced with a probability ratio with respect to Target variable. Here I am using Cabin as an independent variable and its categories is replaced with a probability ratio of person Survived vs Died in each cabin.", "Step 1. Replace original cabin value with the first character of the cabin name.", "Step 2. Find percentage (%) of people survived in a particular cabin and store into new dataframe.", "Step 3. Create a new column into probability survived dataframe with the probability of people getting dead in a particular cabin.", "Step 4. Create one more new column into probability survived dataframe i.e ratio of survived and died probability.", "Step 5. Create a dictionary with probability ratio column.", "Step 6. Create a new column in Data and replace by mapping cabin column categories with its encoded probability ratio dictionary.", "Step 7. Drop original cabin column.", "Hence, in this blogs, I try to explain about most widely used ways to handle categorical variables while preparing data for machine learning. The actual code notebook available at https://github.com/GDhasade/Medium.com_Contents/blob/master/Handle_Categorical_Data.ipynb", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data - Scientist | Analyst | Engineer | Enthusiast | ML Engineer"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fffc213dc84ec&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fways-to-handle-categorical-data-before-train-ml-models-with-implementation-ffc213dc84ec&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fways-to-handle-categorical-data-before-train-ml-models-with-implementation-ffc213dc84ec&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fways-to-handle-categorical-data-before-train-ml-models-with-implementation-ffc213dc84ec&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fways-to-handle-categorical-data-before-train-ml-models-with-implementation-ffc213dc84ec&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----ffc213dc84ec--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----ffc213dc84ec--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://g-dhasade16.medium.com/?source=post_page-----ffc213dc84ec--------------------------------", "anchor_text": ""}, {"url": "https://g-dhasade16.medium.com/?source=post_page-----ffc213dc84ec--------------------------------", "anchor_text": "Ganesh Dhasade"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F8bc856b7f34c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fways-to-handle-categorical-data-before-train-ml-models-with-implementation-ffc213dc84ec&user=Ganesh+Dhasade&userId=8bc856b7f34c&source=post_page-8bc856b7f34c----ffc213dc84ec---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fffc213dc84ec&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fways-to-handle-categorical-data-before-train-ml-models-with-implementation-ffc213dc84ec&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fffc213dc84ec&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fways-to-handle-categorical-data-before-train-ml-models-with-implementation-ffc213dc84ec&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://medium.com/@g.dhasade16/missing-data-its-types-9f59e897843f", "anchor_text": "types of missing values"}, {"url": "https://medium.com/swlh/ways-to-handle-continous-column-missing-data-its-implementations-4704f52ac9c3", "anchor_text": "Continous"}, {"url": "https://medium.com/analytics-vidhya/ways-to-handle-categorical-column-missing-data-its-implementations-15dc4a56893", "anchor_text": "Categorical"}, {"url": "https://unsplash.com/@altumcode", "anchor_text": "AltumCode"}, {"url": "https://unsplash.com/", "anchor_text": "Unsplash.com"}, {"url": "https://www.kaggle.com/c/titanic", "anchor_text": "Kaggle dataset"}, {"url": "https://github.com/GDhasade/Medium.com_Contents/blob/master/Handle_Categorical_Data.ipynb", "anchor_text": "https://github.com/GDhasade/Medium.com_Contents/blob/master/Handle_Categorical_Data.ipynb"}, {"url": "http://contrib.scikit-learn.org/category_encoders/index.html", "anchor_text": "http://contrib.scikit-learn.org/category_encoders/index.html"}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.OneHotEncoder.html.", "anchor_text": "https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.OneHotEncoder.html."}, {"url": "http://contrib.scikit-learn.org/category_encoders/index.html.", "anchor_text": "http://contrib.scikit-learn.org/category_encoders/index.html."}, {"url": "https://www.youtube.com/watch?v=6WDFfaYtN6s&list=PLZoTAELRMXVPwYGE2PXD3x0bfKnR0cJjN&ab_channel=KrishNaik", "anchor_text": "https://www.youtube.com/watch?v=6WDFfaYtN6s&list=PLZoTAELRMXVPwYGE2PXD3x0bfKnR0cJjN&ab_channel=KrishNaik"}, {"url": "https://medium.com/tag/data-science?source=post_page-----ffc213dc84ec---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/data-preparation?source=post_page-----ffc213dc84ec---------------data_preparation-----------------", "anchor_text": "Data Preparation"}, {"url": "https://medium.com/tag/categorical-data?source=post_page-----ffc213dc84ec---------------categorical_data-----------------", "anchor_text": "Categorical Data"}, {"url": "https://medium.com/tag/data-analysis?source=post_page-----ffc213dc84ec---------------data_analysis-----------------", "anchor_text": "Data Analysis"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----ffc213dc84ec---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fffc213dc84ec&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fways-to-handle-categorical-data-before-train-ml-models-with-implementation-ffc213dc84ec&user=Ganesh+Dhasade&userId=8bc856b7f34c&source=-----ffc213dc84ec---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fffc213dc84ec&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fways-to-handle-categorical-data-before-train-ml-models-with-implementation-ffc213dc84ec&user=Ganesh+Dhasade&userId=8bc856b7f34c&source=-----ffc213dc84ec---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fffc213dc84ec&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fways-to-handle-categorical-data-before-train-ml-models-with-implementation-ffc213dc84ec&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----ffc213dc84ec--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fffc213dc84ec&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fways-to-handle-categorical-data-before-train-ml-models-with-implementation-ffc213dc84ec&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----ffc213dc84ec---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----ffc213dc84ec--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----ffc213dc84ec--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----ffc213dc84ec--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----ffc213dc84ec--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----ffc213dc84ec--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----ffc213dc84ec--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----ffc213dc84ec--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----ffc213dc84ec--------------------------------", "anchor_text": ""}, {"url": "https://g-dhasade16.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://g-dhasade16.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Ganesh Dhasade"}, {"url": "https://g-dhasade16.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "89 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F8bc856b7f34c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fways-to-handle-categorical-data-before-train-ml-models-with-implementation-ffc213dc84ec&user=Ganesh+Dhasade&userId=8bc856b7f34c&source=post_page-8bc856b7f34c--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F3d2b19f0eb26&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fways-to-handle-categorical-data-before-train-ml-models-with-implementation-ffc213dc84ec&newsletterV3=8bc856b7f34c&newsletterV3Id=3d2b19f0eb26&user=Ganesh+Dhasade&userId=8bc856b7f34c&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}