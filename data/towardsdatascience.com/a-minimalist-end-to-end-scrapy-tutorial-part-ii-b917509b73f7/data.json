{"url": "https://towardsdatascience.com/a-minimalist-end-to-end-scrapy-tutorial-part-ii-b917509b73f7", "time": 1683000357.0635478, "path": "towardsdatascience.com/a-minimalist-end-to-end-scrapy-tutorial-part-ii-b917509b73f7/", "webpage": {"metadata": {"title": "A Minimalist End-to-End Scrapy Tutorial (Part II) | by Harry Wang | Towards Data Science", "h1": "A Minimalist End-to-End Scrapy Tutorial (Part II)", "description": "In Part I, you learned how to setup Scrapy project and write a basic spider to extract web pages by following page navigation links. However, the extracted data are merely displayed to the console\u2026"}, "outgoing_paragraph_urls": [{"url": "https://medium.com/@HarryWang/a-minimalist-end-to-end-scrapy-tutorial-part-i-11e350bcdec0?source=friends_link&sk=c9f8e32f28a88c61987ec60f93b93e6d", "anchor_text": "Part I", "paragraph_index": 0}, {"url": "https://towardsdatascience.com/a-minimalist-end-to-end-scrapy-tutorial-part-ii-b917509b73f7?source=friends_link&sk=ebd3a9cee8b2097b3857194fee3821a6", "anchor_text": "Part II", "paragraph_index": 0}, {"url": "https://towardsdatascience.com/a-minimalist-end-to-end-scrapy-tutorial-part-iii-bcd94a2e8bf3?source=friends_link&sk=a1fdde9c9dd5383d8de2e08395ee3f98", "anchor_text": "Part III", "paragraph_index": 0}, {"url": "https://medium.com/@HarryWang/a-minimalist-end-to-end-scrapy-tutorial-part-iv-3290d76a2aef?sk=6f0902f9a15092575814ab533a56f8ef", "anchor_text": "Part IV", "paragraph_index": 0}, {"url": "https://medium.com/@HarryWang/a-minimalist-end-to-end-scrapy-tutorial-part-v-e7743ee9a8ef?source=friends_link&sk=c1c5110f63c7ccbe4eb8c6209ee2f57c", "anchor_text": "Part V", "paragraph_index": 0}, {"url": "https://docs.scrapy.org/en/latest/topics/architecture.html", "anchor_text": "Scrapy Architecture", "paragraph_index": 2}, {"url": "https://medium.com/@HarryWang/a-minimalist-end-to-end-scrapy-tutorial-part-i-11e350bcdec0?source=friends_link&sk=c9f8e32f28a88c61987ec60f93b93e6d", "anchor_text": "Part I", "paragraph_index": 21}, {"url": "https://towardsdatascience.com/a-minimalist-end-to-end-scrapy-tutorial-part-ii-b917509b73f7?source=friends_link&sk=ebd3a9cee8b2097b3857194fee3821a6", "anchor_text": "Part II", "paragraph_index": 21}, {"url": "https://towardsdatascience.com/a-minimalist-end-to-end-scrapy-tutorial-part-iii-bcd94a2e8bf3?source=friends_link&sk=a1fdde9c9dd5383d8de2e08395ee3f98", "anchor_text": "Part III", "paragraph_index": 21}, {"url": "https://medium.com/@HarryWang/a-minimalist-end-to-end-scrapy-tutorial-part-iv-3290d76a2aef?sk=6f0902f9a15092575814ab533a56f8ef", "anchor_text": "Part IV", "paragraph_index": 21}, {"url": "https://medium.com/@HarryWang/a-minimalist-end-to-end-scrapy-tutorial-part-v-e7743ee9a8ef?source=friends_link&sk=c1c5110f63c7ccbe4eb8c6209ee2f57c", "anchor_text": "Part V", "paragraph_index": 21}], "all_paragraphs": ["Part I, Part II, Part III, Part IV, Part V", "In Part I, you learned how to setup Scrapy project and write a basic spider to extract web pages by following page navigation links. However, the extracted data are merely displayed to the console. In Part II, I will introduce the concepts of Item and ItemLoader and explain why you should use them to store the extracted data.", "Let\u2019s first look at Scrapy Architecture:", "As you can see in step 7, and 8, Scrapy is designed around the concept of Item, i.e., the spider will parse the extracted data into Items and then the Items will go through Item Pipelines for further processing. I summarize some key reasons to use Item:", "At the end of Part I, our spider yields the following data:", "You may notice that author and author_name are the same thing (one is from the quote page, one is from the corresponding individual author page). So, we actually extract 6 pieces of data, i.e., quote text, tags, author name, birthday, born location, and bio. Now, let\u2019s define the Item to hold those data.", "Open the auto-generated items.py file and update its content as follows:", "We just define one Scrapy item named \u201cQuoteItem\u201d with 6 fields to store the extracted data. Here, if you designed a relational database before, you may ask: should I have two items QuoteItem and AuthorItem to better represent the data logically? The answer is yes you could but not recommended in this case because items are returned by Scrapy in an asynchronous way and you will have additional logic added to match the quote item with its corresponding item \u2014 it\u2019s much easier to put the related quote and author in one item in this case.", "Now, you can put the extracted data into Item in the spider file like:", "Or a preferred way is to use ItemLoader as follows:", "Hmm, the code with ItemLoader seems more complicated \u2014 why do you want to do that? The quick answer is: the raw data you get from the css selector may need to be further parsed. For example, the extracted quote_content has quotation marks in Unicode that needs to be removed.", "The birthday is a string and needs to be parsed into Python date format:", "The born location has \u201cin\u201d in the extracted string that needs to be removed:", "ItemLoader enables pre/post processing functions to be nicely specified away from the spider code and each field of the Item can have different sets of pre/post processing functions for better code reuse.", "For example, we can create a function to remove the Unicode quotation marks aforementioned as follows:", "MapCompose enables us to apply multiple processing functions to a field (we only have one in this example). ItemLoader returns a list, such as [\u2018death\u2019, \u2018life\u2019] for tags. For author name, although there is one value a list is returned such as [\u2018Jimi Hendrix\u2019] , TakeFirst processor takes the first value of the list. After adding additional processors, items.py looks like:", "The key issue right now is that we load two fields quote_content and tags from the quote page and then issue another request to get the corresponding author page to load author_name, author_birthday, author_bornlocation, and bio . To do this, we need to pass the item quote_item from one page to another as metadata as follows:", "And in the author parsing function, you can get the item:", "Now, after adding Item and ItemLoader, our spider file looks like:", "Run the spider scrapy crawl quotes in the console Scrapy stats, you can find the total number of items extracted:", "Congrats! you have finished Part II of this tutorial.", "Part I, Part II, Part III, Part IV, Part V", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fb917509b73f7&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-minimalist-end-to-end-scrapy-tutorial-part-ii-b917509b73f7&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-minimalist-end-to-end-scrapy-tutorial-part-ii-b917509b73f7&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-minimalist-end-to-end-scrapy-tutorial-part-ii-b917509b73f7&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-minimalist-end-to-end-scrapy-tutorial-part-ii-b917509b73f7&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----b917509b73f7--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----b917509b73f7--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://harrywang.medium.com/?source=post_page-----b917509b73f7--------------------------------", "anchor_text": ""}, {"url": "https://harrywang.medium.com/?source=post_page-----b917509b73f7--------------------------------", "anchor_text": "Harry Wang"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F17a1fba2e2cb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-minimalist-end-to-end-scrapy-tutorial-part-ii-b917509b73f7&user=Harry+Wang&userId=17a1fba2e2cb&source=post_page-17a1fba2e2cb----b917509b73f7---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb917509b73f7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-minimalist-end-to-end-scrapy-tutorial-part-ii-b917509b73f7&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb917509b73f7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-minimalist-end-to-end-scrapy-tutorial-part-ii-b917509b73f7&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@igorson?utm_source=medium&utm_medium=referral", "anchor_text": "Igor Son"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://medium.com/@HarryWang/a-minimalist-end-to-end-scrapy-tutorial-part-i-11e350bcdec0?source=friends_link&sk=c9f8e32f28a88c61987ec60f93b93e6d", "anchor_text": "Part I"}, {"url": "https://towardsdatascience.com/a-minimalist-end-to-end-scrapy-tutorial-part-ii-b917509b73f7?source=friends_link&sk=ebd3a9cee8b2097b3857194fee3821a6", "anchor_text": "Part II"}, {"url": "https://towardsdatascience.com/a-minimalist-end-to-end-scrapy-tutorial-part-iii-bcd94a2e8bf3?source=friends_link&sk=a1fdde9c9dd5383d8de2e08395ee3f98", "anchor_text": "Part III"}, {"url": "https://medium.com/@HarryWang/a-minimalist-end-to-end-scrapy-tutorial-part-iv-3290d76a2aef?sk=6f0902f9a15092575814ab533a56f8ef", "anchor_text": "Part IV"}, {"url": "https://medium.com/@HarryWang/a-minimalist-end-to-end-scrapy-tutorial-part-v-e7743ee9a8ef?source=friends_link&sk=c1c5110f63c7ccbe4eb8c6209ee2f57c", "anchor_text": "Part V"}, {"url": "https://docs.scrapy.org/en/latest/topics/architecture.html", "anchor_text": "Scrapy Architecture"}, {"url": "https://medium.com/@HarryWang/a-minimalist-end-to-end-scrapy-tutorial-part-i-11e350bcdec0?source=friends_link&sk=c9f8e32f28a88c61987ec60f93b93e6d", "anchor_text": "Part I"}, {"url": "https://towardsdatascience.com/a-minimalist-end-to-end-scrapy-tutorial-part-ii-b917509b73f7?source=friends_link&sk=ebd3a9cee8b2097b3857194fee3821a6", "anchor_text": "Part II"}, {"url": "https://towardsdatascience.com/a-minimalist-end-to-end-scrapy-tutorial-part-iii-bcd94a2e8bf3?source=friends_link&sk=a1fdde9c9dd5383d8de2e08395ee3f98", "anchor_text": "Part III"}, {"url": "https://medium.com/@HarryWang/a-minimalist-end-to-end-scrapy-tutorial-part-iv-3290d76a2aef?sk=6f0902f9a15092575814ab533a56f8ef", "anchor_text": "Part IV"}, {"url": "https://medium.com/@HarryWang/a-minimalist-end-to-end-scrapy-tutorial-part-v-e7743ee9a8ef?source=friends_link&sk=c1c5110f63c7ccbe4eb8c6209ee2f57c", "anchor_text": "Part V"}, {"url": "https://medium.com/tag/python?source=post_page-----b917509b73f7---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/web-scraping?source=post_page-----b917509b73f7---------------web_scraping-----------------", "anchor_text": "Web Scraping"}, {"url": "https://medium.com/tag/scrapy?source=post_page-----b917509b73f7---------------scrapy-----------------", "anchor_text": "Scrapy"}, {"url": "https://medium.com/tag/web-crawler?source=post_page-----b917509b73f7---------------web_crawler-----------------", "anchor_text": "Web Crawler"}, {"url": "https://medium.com/tag/data-science?source=post_page-----b917509b73f7---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fb917509b73f7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-minimalist-end-to-end-scrapy-tutorial-part-ii-b917509b73f7&user=Harry+Wang&userId=17a1fba2e2cb&source=-----b917509b73f7---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fb917509b73f7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-minimalist-end-to-end-scrapy-tutorial-part-ii-b917509b73f7&user=Harry+Wang&userId=17a1fba2e2cb&source=-----b917509b73f7---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb917509b73f7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-minimalist-end-to-end-scrapy-tutorial-part-ii-b917509b73f7&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----b917509b73f7--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fb917509b73f7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-minimalist-end-to-end-scrapy-tutorial-part-ii-b917509b73f7&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----b917509b73f7---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----b917509b73f7--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----b917509b73f7--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----b917509b73f7--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----b917509b73f7--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----b917509b73f7--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----b917509b73f7--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----b917509b73f7--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----b917509b73f7--------------------------------", "anchor_text": ""}, {"url": "https://harrywang.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://harrywang.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Harry Wang"}, {"url": "https://harrywang.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "152 Followers"}, {"url": "http://harrywang.me", "anchor_text": "harrywang.me"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F17a1fba2e2cb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-minimalist-end-to-end-scrapy-tutorial-part-ii-b917509b73f7&user=Harry+Wang&userId=17a1fba2e2cb&source=post_page-17a1fba2e2cb--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fb98b5ed4151&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-minimalist-end-to-end-scrapy-tutorial-part-ii-b917509b73f7&newsletterV3=17a1fba2e2cb&newsletterV3Id=b98b5ed4151&user=Harry+Wang&userId=17a1fba2e2cb&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}