{"url": "https://towardsdatascience.com/deformable-convolution-and-its-applications-in-video-learning-e21005cab58e", "time": 1683016024.562986, "path": "towardsdatascience.com/deformable-convolution-and-its-applications-in-video-learning-e21005cab58e/", "webpage": {"metadata": {"title": "Deformable Convolution and Its Applications in Video Learning | by Shuchen Du | Towards Data Science", "h1": "Deformable Convolution and Its Applications in Video Learning", "description": "Convolution layer is the basic layer in convolution neural networks. Although it is widely used in computer vision and deep learning, it has several shortcomings. For example, the kernel weights are\u2026"}, "outgoing_paragraph_urls": [{"url": "https://arxiv.org/pdf/1703.06211.pdf", "anchor_text": "Deformable Convolutional Networks, 2017", "paragraph_index": 14}, {"url": "https://arxiv.org/pdf/1906.04016.pdf", "anchor_text": "Learning Temporal Pose Estimation from Sparsely-Labeled Videos, 2019", "paragraph_index": 14}, {"url": "https://arxiv.org/pdf/1912.04573.pdf", "anchor_text": "Classifying, Segmenting, and Tracking Object Instances in Video with Mask Propagation, 2020", "paragraph_index": 14}], "all_paragraphs": ["Convolution layer is the basic layer in convolution neural networks. Although it is widely used in computer vision and deep learning, it has several shortcomings. For example, the kernel weights are fixed for a certain input feature map and is not adaptable to the local feature changes, thus we need more kernels to model the complicated context of feature maps, which is redundant and not efficient. Moreover, since the receptive field of an output pixel is always a rectangle, as a cumulative effect of layered convolutions, the receptive field is getting bigger in which some context background unrelated to the output pixel will be contained. The unrelated background will bring noise to the training of the output pixel.", "Imagine you want to make a small change to the traditional convolution layer in order to overcome the above problems: the kernel can adapt to local feature changes and the receptive field can converge to the semantic background that corresponds to the output pixel. Fortunately, it is already implemented and the name of the refined convolution layer is called deformable convolution layer.", "In this post, I will introduce these topics:", "Deformable convolution is a convolution layer plus offset learning. As shown above, for each footprint of the convolution kernel, a 2D offset is learned in order to guide the footprint to a place most optimized for the training. The offset learning part is also a convolution layer, whose number of output channels is twice as the number of input channels, as each pixel has two offset coordinates. Based on this method, the kernel can adapt to local feature changes which is efficient for semantic feature learning.", "This is an illustration of offset learning. a is traditional convolution in which the kernel footprint does not move at all. b, c, and d illustrate footprint movements.", "As a result, in deformable convolution, the receptive field of a deep pixel is concentrated to the corresponding object. As shown above, in a, the deep blue pixel (above) belongs to the big sheep. However, its rectangle receptive field (bottom) contains the little sheep at the left-bottom, which may bring ambiguity for tasks like instance segmentation. In b, the receptive field is deformed and concentrates on the big sheep, in which the ambiguity is avoided.", "As discussed above, offset facilitates the kernel adaptation of local features and the concentration of receptive fields. As the name implies, offset is used to deform the kernel footprint locally, thus to deform the receptive field globally as a consequence.", "Now the tricky part comes: since the offset can be learned to adapt to the objects in the current picture, can we adapt objects in the current picture to those in another picture with a provided offset between them ?", "Let \u2018s make it concrete. Suppose we have a video in which each frame is similar to its adjacent frames. Then we choose some frames sparsely and label them in pixel level, such as semantic segmentations or key-points etc. Since these kinds of pixel-level labels are expensive, can we use the unlabeled adjacent frames to improve the accuracy of generalization ? Specifically, with a method to deform the feature maps of unlabeled frames to their adjacent labeled frame, in order to compensate the missing information in the labeled frame ?", "This research is a good solution to what is discussed above. Since labelling is expensive, only a small number of frames is labeled in the video. Nevertheless, the intrinsic problems in a labeled frame image like occlusion, blur etc. hinder the accuracy and efficiency of model training. To solve this, the authors used deformable convolution to deform the feature maps of unlabeled frames to those of their adjacent labeled frames to compensate the intrinsic problems discussed above. The offset is just the optimized feature differences between a labeled frame and its unlabeled adjacent frame. The deformable part is built with multi-resolution feature pyramid, in which different dilations are used. The beauty of this method is, we can leverage adjacent unlabeled frames to enhance the feature learning of labeled frames, thus we need not label each frame of the video because the adjacent frames are similar. This kind of deformable methods, also called \u2018warping\u2019 methods by the authors, is cheaper and more effective than some other video learning methods like optical flow or 3D convolutions etc.", "As shown above, during training, the feature maps of unlabeled frame B is warped to those of its adjacent labeled frame A. During inference, the ground truth of frame A can be propagated using the trained warping model to get the key-point estimation of frame B. Furthermore, more adjacent frames can be warped, with their feature maps aggregated, to improve the accuracy of key-point estimation.", "The authors also proposed mask propagation for instance segmentation by appending a mask propagation head in the existing Mask-RCNN model, in which a predicted instance segmentation at time t can be propagated to its adjacent frame t + \u03b4.", "The network structure is similar to the pose estimation network discussed above, while a little complicated. It has three parts: 1) instance segmentation prediction for frame t; 2) offset optimization and segmentation deformation between frame t and t + \u03b4; 3) feature map aggregation for final prediction of instance segmentation at frame t + \u03b4. Here, the authors also used multiplication layers to filter out noise and only focus on the features where object instances exist. With feature aggregation from adjacent frames, the problems of occlusion, blurring could be alleviated.", "Deformable convolution could be introduced to video learning tasks with given offsets, in which label propagation and feature aggregation are implemented to improve the model performance. Compared to the traditional one-frame to one-label learning manner, the authors proposed multi-frame to one-label learning manner which leverages the feature maps of adjacent frames to enhance representation learning. Thus the model can be trained to see what is occluded or blurred with other eyes from the adjacent frames.", "Deformable Convolutional Networks, 2017Learning Temporal Pose Estimation from Sparsely-Labeled Videos, 2019Classifying, Segmenting, and Tracking Object Instances in Video with Mask Propagation, 2020", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fe21005cab58e&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeformable-convolution-and-its-applications-in-video-learning-e21005cab58e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeformable-convolution-and-its-applications-in-video-learning-e21005cab58e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeformable-convolution-and-its-applications-in-video-learning-e21005cab58e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeformable-convolution-and-its-applications-in-video-learning-e21005cab58e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----e21005cab58e--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----e21005cab58e--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://dushuchen.medium.com/?source=post_page-----e21005cab58e--------------------------------", "anchor_text": ""}, {"url": "https://dushuchen.medium.com/?source=post_page-----e21005cab58e--------------------------------", "anchor_text": "Shuchen Du"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fc54b15dbe11e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeformable-convolution-and-its-applications-in-video-learning-e21005cab58e&user=Shuchen+Du&userId=c54b15dbe11e&source=post_page-c54b15dbe11e----e21005cab58e---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe21005cab58e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeformable-convolution-and-its-applications-in-video-learning-e21005cab58e&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe21005cab58e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeformable-convolution-and-its-applications-in-video-learning-e21005cab58e&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://towardsdatascience.com/tagged/hands-on-tutorials", "anchor_text": "Hands-on Tutorials"}, {"url": "https://www.researchgate.net/figure/The-illustration-of-deformable-convolution-The-offset-ranges-in-the-width-and-the-height_fig1_334104866", "anchor_text": "source"}, {"url": "https://arxiv.org/pdf/1703.06211.pdf", "anchor_text": "Deformable Convolutional Networks, 2017"}, {"url": "https://arxiv.org/pdf/1906.04016.pdf", "anchor_text": "Learning Temporal Pose Estimation from Sparsely-Labeled Videos, 2019"}, {"url": "https://arxiv.org/pdf/1912.04573.pdf", "anchor_text": "Classifying, Segmenting, and Tracking Object Instances in Video with Mask Propagation, 2020"}, {"url": "https://dushuchen.medium.com/membership", "anchor_text": "Join Medium with my referral link - Shuchen DuRead every story from Shuchen Du (and thousands of other writers on Medium). Your membership fee directly supports\u2026dushuchen.medium.com"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----e21005cab58e---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----e21005cab58e---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----e21005cab58e---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/computer-vision?source=post_page-----e21005cab58e---------------computer_vision-----------------", "anchor_text": "Computer Vision"}, {"url": "https://medium.com/tag/hands-on-tutorials?source=post_page-----e21005cab58e---------------hands_on_tutorials-----------------", "anchor_text": "Hands On Tutorials"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fe21005cab58e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeformable-convolution-and-its-applications-in-video-learning-e21005cab58e&user=Shuchen+Du&userId=c54b15dbe11e&source=-----e21005cab58e---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fe21005cab58e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeformable-convolution-and-its-applications-in-video-learning-e21005cab58e&user=Shuchen+Du&userId=c54b15dbe11e&source=-----e21005cab58e---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe21005cab58e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeformable-convolution-and-its-applications-in-video-learning-e21005cab58e&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----e21005cab58e--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fe21005cab58e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeformable-convolution-and-its-applications-in-video-learning-e21005cab58e&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----e21005cab58e---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----e21005cab58e--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----e21005cab58e--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----e21005cab58e--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----e21005cab58e--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----e21005cab58e--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----e21005cab58e--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----e21005cab58e--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----e21005cab58e--------------------------------", "anchor_text": ""}, {"url": "https://dushuchen.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://dushuchen.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Shuchen Du"}, {"url": "https://dushuchen.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "299 Followers"}, {"url": "https://www.linkedin.com/in/shuchen-du-682958132/", "anchor_text": "https://www.linkedin.com/in/shuchen-du-682958132/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fc54b15dbe11e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeformable-convolution-and-its-applications-in-video-learning-e21005cab58e&user=Shuchen+Du&userId=c54b15dbe11e&source=post_page-c54b15dbe11e--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F10055a136a19&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeformable-convolution-and-its-applications-in-video-learning-e21005cab58e&newsletterV3=c54b15dbe11e&newsletterV3Id=10055a136a19&user=Shuchen+Du&userId=c54b15dbe11e&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}