{"url": "https://towardsdatascience.com/introducing-copula-in-monte-carlo-simulation-9ed1fe9f905", "time": 1683002297.8320808, "path": "towardsdatascience.com/introducing-copula-in-monte-carlo-simulation-9ed1fe9f905/", "webpage": {"metadata": {"title": "Introducing Copula in Monte Carlo Simulation | by Rina Buoy | Towards Data Science", "h1": "Introducing Copula in Monte Carlo Simulation", "description": "In the oil and gas industry, uncertainties are everywhere from the surface to the sub-surface. To embed the uncertainties in any estimation, probabilistic approaches are required. One of the simple\u2026"}, "outgoing_paragraph_urls": [{"url": "https://en.wikipedia.org/wiki/Monte_Carlo_method", "anchor_text": "source", "paragraph_index": 2}, {"url": "https://www.lsu.edu/ces/products/stats/index.php", "anchor_text": "here", "paragraph_index": 3}, {"url": "https://en.wikipedia.org/wiki/Copula_(probability_theory)", "anchor_text": "Wikipedia", "paragraph_index": 5}, {"url": "https://twiecki.io/blog/2018/05/03/copulas/", "anchor_text": "Thomas Wiecki", "paragraph_index": 6}], "all_paragraphs": ["In the oil and gas industry, uncertainties are everywhere from the surface to the sub-surface. To embed the uncertainties in any estimation, probabilistic approaches are required.", "One of the simple cases is a volumetric estimation. The formulas to estimate hydrocarbon (oil/gas) initially in place (HCIIP) are given below:", "To probabilistically estimate the HCIIP, a Monte Carlo method is used and it follows the following steps (source):", "A Ms Excel implementation of probabilistic oil and gas prospect evaluation can be obtained here.", "If all inputs are independent random variables or normally distributed, random sampling is rather straightforward. However, the inputs, for example, porosity and HC saturation are correlated to some degree and have different distributions. In such a case, random sampling is difficult. This is when Copula come to our rescue.", "According to Wikipedia, a copula is a multivariate cumulative distribution function for which the marginal probability distribution of each variable is uniform.", "The above definition is abstract and hard to comprehend. However, the implementation is rather easy. Thomas Wiecki wrote an inspiring post which gives a intuitive illustration of copula.", "To fully grab the concept of copula, understanding of random variable transformation is required.", "Let\u2019s start by sampling from a uniform distribution between 0 and 1.", "Instead of being uniform, these samples can be transformed to any probability distribution of interest via the inverse of the cumulative density function (CDF). Let\u2019s say we want these samples to be normally distributed. We can pass these samples to inverse CDF function of a normal distribution ( ex. ppf function in scipy.stats). We will get the following samples which are normally distributed.", "If we plot the uniform samples, the transformed samples, and the inverse CDF curve on the same plot, we get:", "When we want to draw samples from a given distribution, the computer does this transformation under the hood.", "Importantly, the process is reversible; that means that we can transform samples of any distribution back to unform distribution via the same CDF.", "The steps of Gaussian copula are as follows:", "Let\u2019s start by drawing samples from a correlated multivariate normal distribution.", "Next, we transform the marginals to a uniform distribution.", "As we can see, the joint distribution of X1 and X2 are correlated while their marginals are uniform.", "We can, now, transform the marginals to any distribution of interest while preserving the correlation. For example, we want to draw X1 from a triangle distribution and X2 from a normal distribution.", "Now we obtain the desired joint distribution of X1 and X2 which are drawn from different distributions.", "Armed with copula, we are ready to introduce variable correlations to the sampling phase of Monte Carlo. Here is the complete python codes of calculating OIIP:", "For the case of no correlation, the covariance matrix is a diagonal matrix (zeros everywhere except the diagonal cells).", "Running the above codes, we obtain the following OIIP histogram and cumulative probability distribution.", "To illustrate the case of variable correlations, we arbitrarily assign positive correlations among NTG, POR and SHC.", "By observing the OIIP histogram and cumulative distribution, we can see that including variable correlations or dependencies expands the P10-P90 range of the calculated OIIP. This is reasonable since by including correlations, sampling can explore extreme space which may, otherwise, be missed in the case of no correlation. In the next post, we will look at Bayesian decline curve analysis (DCA).", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "An applied NLP researcher at Techo Startup Center (TSC)"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F9ed1fe9f905&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroducing-copula-in-monte-carlo-simulation-9ed1fe9f905&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroducing-copula-in-monte-carlo-simulation-9ed1fe9f905&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroducing-copula-in-monte-carlo-simulation-9ed1fe9f905&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroducing-copula-in-monte-carlo-simulation-9ed1fe9f905&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----9ed1fe9f905--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----9ed1fe9f905--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@rinabuoy13?source=post_page-----9ed1fe9f905--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@rinabuoy13?source=post_page-----9ed1fe9f905--------------------------------", "anchor_text": "Rina Buoy"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F102607c68c46&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroducing-copula-in-monte-carlo-simulation-9ed1fe9f905&user=Rina+Buoy&userId=102607c68c46&source=post_page-102607c68c46----9ed1fe9f905---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F9ed1fe9f905&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroducing-copula-in-monte-carlo-simulation-9ed1fe9f905&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F9ed1fe9f905&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroducing-copula-in-monte-carlo-simulation-9ed1fe9f905&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://thenextweb.com/insights/2019/07/30/quantum-darwinism-may-solve-the-question-of-whether-god-plays-dice-or-not/", "anchor_text": "Source"}, {"url": "http://chapter24.one/hciip%20calculator.html", "anchor_text": "Source"}, {"url": "https://en.wikipedia.org/wiki/Monte_Carlo_method", "anchor_text": "source"}, {"url": "https://www.lsu.edu/ces/products/stats/index.php", "anchor_text": "here"}, {"url": "https://en.wikipedia.org/wiki/Copula_(probability_theory)", "anchor_text": "Wikipedia"}, {"url": "https://twiecki.io/blog/2018/05/03/copulas/", "anchor_text": "Thomas Wiecki"}, {"url": "https://medium.com/tag/statistics?source=post_page-----9ed1fe9f905---------------statistics-----------------", "anchor_text": "Statistics"}, {"url": "https://medium.com/tag/probability?source=post_page-----9ed1fe9f905---------------probability-----------------", "anchor_text": "Probability"}, {"url": "https://medium.com/tag/monte-carlo-simulation?source=post_page-----9ed1fe9f905---------------monte_carlo_simulation-----------------", "anchor_text": "Monte Carlo Simulation"}, {"url": "https://medium.com/tag/engineering?source=post_page-----9ed1fe9f905---------------engineering-----------------", "anchor_text": "Engineering"}, {"url": "https://medium.com/tag/data-science?source=post_page-----9ed1fe9f905---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F9ed1fe9f905&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroducing-copula-in-monte-carlo-simulation-9ed1fe9f905&user=Rina+Buoy&userId=102607c68c46&source=-----9ed1fe9f905---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F9ed1fe9f905&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroducing-copula-in-monte-carlo-simulation-9ed1fe9f905&user=Rina+Buoy&userId=102607c68c46&source=-----9ed1fe9f905---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F9ed1fe9f905&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroducing-copula-in-monte-carlo-simulation-9ed1fe9f905&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----9ed1fe9f905--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F9ed1fe9f905&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroducing-copula-in-monte-carlo-simulation-9ed1fe9f905&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----9ed1fe9f905---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----9ed1fe9f905--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----9ed1fe9f905--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----9ed1fe9f905--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----9ed1fe9f905--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----9ed1fe9f905--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----9ed1fe9f905--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----9ed1fe9f905--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----9ed1fe9f905--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@rinabuoy13?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@rinabuoy13?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Rina Buoy"}, {"url": "https://medium.com/@rinabuoy13/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "299 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F102607c68c46&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroducing-copula-in-monte-carlo-simulation-9ed1fe9f905&user=Rina+Buoy&userId=102607c68c46&source=post_page-102607c68c46--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fusers%2F102607c68c46%2Flazily-enable-writer-subscription&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroducing-copula-in-monte-carlo-simulation-9ed1fe9f905&user=Rina+Buoy&userId=102607c68c46&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}