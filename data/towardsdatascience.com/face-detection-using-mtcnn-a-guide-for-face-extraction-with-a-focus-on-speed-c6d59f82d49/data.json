{"url": "https://towardsdatascience.com/face-detection-using-mtcnn-a-guide-for-face-extraction-with-a-focus-on-speed-c6d59f82d49", "time": 1683006482.217731, "path": "towardsdatascience.com/face-detection-using-mtcnn-a-guide-for-face-extraction-with-a-focus-on-speed-c6d59f82d49/", "webpage": {"metadata": {"title": "Face Detection using MTCNN \u2014 a guide for face extraction with a focus on speed | by Justin G\u00fcse | Towards Data Science", "h1": "Face Detection using MTCNN \u2014 a guide for face extraction with a focus on speed", "description": "MTCNN is a python (pip) library written by Github user ipacz, which implements the paper Zhang, Kaipeng et al. \u201cJoint Face Detection and Alignment Using Multitask Cascaded Convolutional Networks.\u201d\u2026"}, "outgoing_paragraph_urls": [{"url": "https://github.com/ipazc/mtcnn", "anchor_text": "Github user ipacz", "paragraph_index": 0}, {"url": "https://arxiv.org/abs/1604.02878](https://arxiv.org/abs/1604.02878 \"https://arxiv.org/abs/1604.02878", "anchor_text": "paper Zhang, Kaipeng et al. \u201cJoint Face Detection and Alignment Using Multitask Cascaded Convolutional Networks.\u201d IEEE Signal Processing Letters 23.10 (2016): 1499\u20131503. Crossref. Web", "paragraph_index": 0}, {"url": "https://bit.ly/2vo3INw", "anchor_text": "imread function", "paragraph_index": 7}, {"url": "https://pytorch.org/get-started/locally/", "anchor_text": "Pytorch wrote a good tutorial about that part", "paragraph_index": 18}, {"url": "http://DataFortress.cloud", "anchor_text": "DataFortress.cloud", "paragraph_index": 26}], "all_paragraphs": ["MTCNN is a python (pip) library written by Github user ipacz, which implements the paper Zhang, Kaipeng et al. \u201cJoint Face Detection and Alignment Using Multitask Cascaded Convolutional Networks.\u201d IEEE Signal Processing Letters 23.10 (2016): 1499\u20131503. Crossref. Web.", "In this paper, they propose a deep cascaded multi-task framework using different features of \u201csub-models\u201d to each boost their correlating strengths.", "MTCNN performs quite fast on a CPU, even though S3FD is still quicker running on a GPU \u2014 but that is a topic for another post.", "This post uses code from the following two sources, check them out, they are interesting as well:", "Feel free to access the whole notebook via:", "Luckily MTCNN is available as a pip package, meaning we can easily install it using", "Now switching to Python/Jupyter Notebook we can check the installation with an import and quick verification:", "Afterwards, we are ready to load out test image using the matplotlib imread function.", "Now your output will look a lot like this:", "What does this tell us? A lot of it is self-explanatory, but it basically returns coordinates, or the pixel values of a rectangle where the MTCNN algorithm detected faces. The \u201cbox\u201d value above returns the location of the whole face, followed by a \u201cconfidence\u201d level.", "If you want to do more advanced extractions or algorithms, you will have access to other facial landmarks, called \u201ckeypoints\u201d as well. Namely the MTCNN model located the eyes, mouth and nose as well!", "To demonstrate this even better let us draw a box around the face using matplotlib:", "Now let us take a look at the aforementioned \u201ckeypoints\u201d that the MTCNN model returned.", "We will now use these to graph the nose, mouth and eyes as well. We will the add following code snippet to our code above:", "With the full code from above looking like this:", "Now let us come to the interesting part. If you are going to process millions of pictures you will need to speed up MTCNN, otherwise, you will either fall asleep or your CPU will burn before it will be done.", "But what exactly are we talking about? If you are running the above code it will take around one second, meaning we will process around one picture per second. If you are running MTCNN on a GPU and use the sped-up version it will achieve around 60\u2013100 pictures/frames a second. That is a boost of up to 100 times!", "If you are for example going to extract all faces of a movie, where you will extract 10 faces per second (one second of the movie has on average around 24 frames, so every second frame) it will be 10 * 60 (seconds) * 120 (minutes) = 72,000 frames.", "To use MTCNN on a GPU you will need to set up CUDA, cudnn, pytorch and so on. Pytorch wrote a good tutorial about that part.", "Once installed we will do the necessary imports as follows:", "See how we defined the device in the code above? You will be able to run everything on a CPU as well if you do not want or can set up CUDA.", "Next, we will define the extractor:", "In this snippet, we pass along some parameters, where we for example only use half of the image size, which is one of the main impact factors for speeding it up.", "And finally let us run the face extraction script:", "The above image shows the output of the code running on an NVIDIA Tesla P100, so depending on the source material, GPU and processor you might experience better or worse performance.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Justin G\u00fcse is the CEO of DataFortress.cloud. He loves Big-Data, Cloud and Virtual- and Augmented Reality, as well as books on self-reflecting in general."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fc6d59f82d49&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fface-detection-using-mtcnn-a-guide-for-face-extraction-with-a-focus-on-speed-c6d59f82d49&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fface-detection-using-mtcnn-a-guide-for-face-extraction-with-a-focus-on-speed-c6d59f82d49&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fface-detection-using-mtcnn-a-guide-for-face-extraction-with-a-focus-on-speed-c6d59f82d49&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fface-detection-using-mtcnn-a-guide-for-face-extraction-with-a-focus-on-speed-c6d59f82d49&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----c6d59f82d49--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----c6d59f82d49--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://guese-justin.medium.com/?source=post_page-----c6d59f82d49--------------------------------", "anchor_text": ""}, {"url": "https://guese-justin.medium.com/?source=post_page-----c6d59f82d49--------------------------------", "anchor_text": "Justin G\u00fcse"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F5ceff1a6b0a7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fface-detection-using-mtcnn-a-guide-for-face-extraction-with-a-focus-on-speed-c6d59f82d49&user=Justin+G%C3%BCse&userId=5ceff1a6b0a7&source=post_page-5ceff1a6b0a7----c6d59f82d49---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc6d59f82d49&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fface-detection-using-mtcnn-a-guide-for-face-extraction-with-a-focus-on-speed-c6d59f82d49&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc6d59f82d49&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fface-detection-using-mtcnn-a-guide-for-face-extraction-with-a-focus-on-speed-c6d59f82d49&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://github.com/ipazc/mtcnn", "anchor_text": "Github user ipacz"}, {"url": "https://arxiv.org/abs/1604.02878](https://arxiv.org/abs/1604.02878 \"https://arxiv.org/abs/1604.02878", "anchor_text": "paper Zhang, Kaipeng et al. \u201cJoint Face Detection and Alignment Using Multitask Cascaded Convolutional Networks.\u201d IEEE Signal Processing Letters 23.10 (2016): 1499\u20131503. Crossref. Web"}, {"url": "https://machinelearningmastery.com/how-to-perform-face-detection-with-classical-and-deep-learning-methods-in-python-with-keras/", "anchor_text": "https://machinelearningmastery.com/how-to-perform-face-detection-with-classical-and-deep-learning-methods-in-python-with-keras/"}, {"url": "https://www.kaggle.com/timesler/fast-mtcnn-detector-55-fps-at-full-resolution", "anchor_text": "https://www.kaggle.com/timesler/fast-mtcnn-detector-55-fps-at-full-resolution"}, {"url": "https://github.com/JustinGuese/mtcnn-face-extraction-eyes-mouth-nose-and-speeding-it-up", "anchor_text": "https://github.com/JustinGuese/mtcnn-face-extraction-eyes-mouth-nose-and-speeding-it-up"}, {"url": "https://github.com/JustinGuese/mtcnn-face-extraction-eyes-mouth-nose-and-speeding-it-up", "anchor_text": "https://github.com/JustinGuese/mtcnn-face-extraction-eyes-mouth-nose-and-speeding-it-up"}, {"url": "https://bit.ly/2vo3INw", "anchor_text": "imread function"}, {"url": "https://pytorch.org/get-started/locally/", "anchor_text": "Pytorch wrote a good tutorial about that part"}, {"url": "https://www.datafortress.cloud/blog/face-detection-using-mtcnn/", "anchor_text": "https://www.datafortress.cloud/blog/face-detection-using-mtcnn/"}, {"url": "https://medium.com/tag/data-science?source=post_page-----c6d59f82d49---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----c6d59f82d49---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/face-recognition?source=post_page-----c6d59f82d49---------------face_recognition-----------------", "anchor_text": "Face Recognition"}, {"url": "https://medium.com/tag/convolution-neural-net?source=post_page-----c6d59f82d49---------------convolution_neural_net-----------------", "anchor_text": "Convolution Neural Net"}, {"url": "https://medium.com/tag/computer-vision?source=post_page-----c6d59f82d49---------------computer_vision-----------------", "anchor_text": "Computer Vision"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fc6d59f82d49&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fface-detection-using-mtcnn-a-guide-for-face-extraction-with-a-focus-on-speed-c6d59f82d49&user=Justin+G%C3%BCse&userId=5ceff1a6b0a7&source=-----c6d59f82d49---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fc6d59f82d49&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fface-detection-using-mtcnn-a-guide-for-face-extraction-with-a-focus-on-speed-c6d59f82d49&user=Justin+G%C3%BCse&userId=5ceff1a6b0a7&source=-----c6d59f82d49---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc6d59f82d49&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fface-detection-using-mtcnn-a-guide-for-face-extraction-with-a-focus-on-speed-c6d59f82d49&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----c6d59f82d49--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fc6d59f82d49&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fface-detection-using-mtcnn-a-guide-for-face-extraction-with-a-focus-on-speed-c6d59f82d49&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----c6d59f82d49---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----c6d59f82d49--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----c6d59f82d49--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----c6d59f82d49--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----c6d59f82d49--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----c6d59f82d49--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----c6d59f82d49--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----c6d59f82d49--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----c6d59f82d49--------------------------------", "anchor_text": ""}, {"url": "https://guese-justin.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://guese-justin.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Justin G\u00fcse"}, {"url": "https://guese-justin.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "139 Followers"}, {"url": "http://DataFortress.cloud", "anchor_text": "DataFortress.cloud"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F5ceff1a6b0a7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fface-detection-using-mtcnn-a-guide-for-face-extraction-with-a-focus-on-speed-c6d59f82d49&user=Justin+G%C3%BCse&userId=5ceff1a6b0a7&source=post_page-5ceff1a6b0a7--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F5adf1d9db03d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fface-detection-using-mtcnn-a-guide-for-face-extraction-with-a-focus-on-speed-c6d59f82d49&newsletterV3=5ceff1a6b0a7&newsletterV3Id=5adf1d9db03d&user=Justin+G%C3%BCse&userId=5ceff1a6b0a7&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}