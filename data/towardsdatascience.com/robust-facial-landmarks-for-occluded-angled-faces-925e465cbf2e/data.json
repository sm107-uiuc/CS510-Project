{"url": "https://towardsdatascience.com/robust-facial-landmarks-for-occluded-angled-faces-925e465cbf2e", "time": 1683011993.4203331, "path": "towardsdatascience.com/robust-facial-landmarks-for-occluded-angled-faces-925e465cbf2e/", "webpage": {"metadata": {"title": "Facial Landmark Detection for Occluded Angled Faces | Towards Data Science", "h1": "Facial Landmark Detection for Occluded Angled Faces", "description": "Dlib provides a good facial landmark detector, but it does not work very well when the face is at a steep angle. Learn how to use a model that can."}, "outgoing_paragraph_urls": [{"url": "https://github.com/vardanagarwal/Proctoring-AI/tree/master/models", "anchor_text": "repository", "paragraph_index": 6}, {"url": "https://github.com/yinguobing/cnn-facial-landmark", "anchor_text": "repo", "paragraph_index": 8}, {"url": "https://github.com/vardanagarwal/Proctoring-AI/tree/master/models", "anchor_text": "here", "paragraph_index": 8}, {"url": "https://yinguobing.com/facial-landmark-localization-by-deep-learning-background/", "anchor_text": "here", "paragraph_index": 8}, {"url": "https://github.com/vardanagarwal/Proctoring-AI/", "anchor_text": "here", "paragraph_index": 15}], "all_paragraphs": ["Facial landmarks detection or facial keypoints detection has a lot of uses in computer vision like face alignment, drowsiness detection, Snapchat filters to name a few. The most widely known model for this task is Dlib\u2019s 68 keypoints landmark predictor which gives very good results in real-time. But the problem starts when the face is occluded or at an angle to the camera. Getting accurate results at angles is crucial for tasks like head pose estimation. So in this article, I will introduce a lesser-known Tensorflow model that can achieve this mission.", "Now, this is finding drawbacks just because I want to but in essence, installing Dlib in Windows is a little tough and one needs to install Cmake and some other applications to do so. If you are using Anaconda and try using conda install, then the version for Windows is outdated as well and does not support Python>3.5. If you are using any other operating system then you will be fine.", "Instead of writing what\u2019s wrong, I\u2019ll just show it to you.", "All right enough of maligning Dlib let\u2019s move on to the real stuff.", "We will require Tensorflow 2 and OpenCV for this task.", "Our first step is to find the faces in the images on which we can find facial landmarks. For this task, we will be using a Caffe model of OpenCV\u2019s DNN module. If you are wondering how it fares against other models like Haar Cascades or Dlib\u2019s frontal face detector or you want to know more about it in-depth then you can refer to this article:", "You can download the required models from my GitHub repository.", "Load the network using cv2.dnn.readNetFromCaffe and pass the model's layers and weights as its arguments. It performs best on images resized to 300x300.", "We will be using a facial landmark detector provided by Yin Guobing in this Github repo. It also gives 68 landmarks and it is a Tensorflow CNN trained on 5 datasets! The pre-trained model can be found here. The author has also written a series of posts explaining the background, dataset, preprocessing, model architecture, training, and deployment that can be found here. I have provided their outlines here, but I would strongly encourage you to read them.", "In the first of those series, he describes the problem of stability of facial landmarks in videos followed by labeling out the existing solutions like OpenFace and Dlib\u2019s facial landmark detection along with the datasets available. The third article is all about data preprocessing and making it ready to use. In the next two articles, the work is to extract the faces and apply facial landmarks on it to make it ready to train a CNN and store them as TFRecord files. In the sixth article, a model is trained using Tensorflow. In the final article, the model is exported as an API and shown how to use it in Python.", "We need the coordinates of the faces that acts as the region of interest and is extracted from the image. Then it is converted to a square shape of size 128x128 and passed to the model which returns the 68 key points which can then be normalized to the dimensions of the original image.", "The complete code used for this piece of work:", "Now, that you know it can perform well on side-faces it can be utilized to make a head-pose estimator. If you want to do you can refer to this article:", "One of the major selling points of Dlib was its speed. Let\u2019s see how they compare on my i5 processor (yeah \ud83d\ude14).", "So if speed is the main concern and occluded or angled faces not so much then Dlib might be better suited for you otherwise I feel that the Tensorflow model reigns supreme without compromising a lot on speed.", "You find the properly documented code for both face detection and landmark detection here on GitHub, where I have tried to make an AI for online proctoring.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F925e465cbf2e&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frobust-facial-landmarks-for-occluded-angled-faces-925e465cbf2e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frobust-facial-landmarks-for-occluded-angled-faces-925e465cbf2e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frobust-facial-landmarks-for-occluded-angled-faces-925e465cbf2e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frobust-facial-landmarks-for-occluded-angled-faces-925e465cbf2e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----925e465cbf2e--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----925e465cbf2e--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@vardanagarwal16?source=post_page-----925e465cbf2e--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@vardanagarwal16?source=post_page-----925e465cbf2e--------------------------------", "anchor_text": "Vardan Agarwal"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fe0b122513e3b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frobust-facial-landmarks-for-occluded-angled-faces-925e465cbf2e&user=Vardan+Agarwal&userId=e0b122513e3b&source=post_page-e0b122513e3b----925e465cbf2e---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F925e465cbf2e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frobust-facial-landmarks-for-occluded-angled-faces-925e465cbf2e&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F925e465cbf2e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frobust-facial-landmarks-for-occluded-angled-faces-925e465cbf2e&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@ancientwanderer?utm_source=medium&utm_medium=referral", "anchor_text": "Terence Burke"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://towardsdatascience.com/face-detection-models-which-to-use-and-why-d263e82c302c", "anchor_text": "Face Detection Models: Which to Use and Why?A complete tutorial on implementing different face detection models in Python followed, by comparison, to find out best\u2026towardsdatascience.com"}, {"url": "https://github.com/vardanagarwal/Proctoring-AI/tree/master/models", "anchor_text": "repository"}, {"url": "https://github.com/yinguobing/cnn-facial-landmark", "anchor_text": "repo"}, {"url": "https://github.com/vardanagarwal/Proctoring-AI/tree/master/models", "anchor_text": "here"}, {"url": "https://yinguobing.com/facial-landmark-localization-by-deep-learning-background/", "anchor_text": "here"}, {"url": "https://towardsdatascience.com/real-time-head-pose-estimation-in-python-e52db1bc606a", "anchor_text": "Real-Time Head Pose Estimation in PythonCreate a head pose estimator that can tell where the head is facing in degrees using Python and OpenCV with this\u2026towardsdatascience.com"}, {"url": "https://github.com/vardanagarwal/Proctoring-AI/", "anchor_text": "here"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----925e465cbf2e---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/computer-vision?source=post_page-----925e465cbf2e---------------computer_vision-----------------", "anchor_text": "Computer Vision"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----925e465cbf2e---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----925e465cbf2e---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----925e465cbf2e---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F925e465cbf2e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frobust-facial-landmarks-for-occluded-angled-faces-925e465cbf2e&user=Vardan+Agarwal&userId=e0b122513e3b&source=-----925e465cbf2e---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F925e465cbf2e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frobust-facial-landmarks-for-occluded-angled-faces-925e465cbf2e&user=Vardan+Agarwal&userId=e0b122513e3b&source=-----925e465cbf2e---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F925e465cbf2e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frobust-facial-landmarks-for-occluded-angled-faces-925e465cbf2e&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----925e465cbf2e--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F925e465cbf2e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frobust-facial-landmarks-for-occluded-angled-faces-925e465cbf2e&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----925e465cbf2e---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----925e465cbf2e--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----925e465cbf2e--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----925e465cbf2e--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----925e465cbf2e--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----925e465cbf2e--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----925e465cbf2e--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----925e465cbf2e--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----925e465cbf2e--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@vardanagarwal16?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@vardanagarwal16?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Vardan Agarwal"}, {"url": "https://medium.com/@vardanagarwal16/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "399 Followers"}, {"url": "https://www.linkedin.com/in/vardan-agarwal-6bb123168/", "anchor_text": "https://www.linkedin.com/in/vardan-agarwal-6bb123168/"}, {"url": "https://www.buymeacoffee.com/vardan", "anchor_text": "https://www.buymeacoffee.com/vardan"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fe0b122513e3b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frobust-facial-landmarks-for-occluded-angled-faces-925e465cbf2e&user=Vardan+Agarwal&userId=e0b122513e3b&source=post_page-e0b122513e3b--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F4ce0157411b4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frobust-facial-landmarks-for-occluded-angled-faces-925e465cbf2e&newsletterV3=e0b122513e3b&newsletterV3Id=4ce0157411b4&user=Vardan+Agarwal&userId=e0b122513e3b&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}