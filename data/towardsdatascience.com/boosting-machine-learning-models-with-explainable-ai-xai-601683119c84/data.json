{"url": "https://towardsdatascience.com/boosting-machine-learning-models-with-explainable-ai-xai-601683119c84", "time": 1683004303.434261, "path": "towardsdatascience.com/boosting-machine-learning-models-with-explainable-ai-xai-601683119c84/", "webpage": {"metadata": {"title": "Boosting Machine Learning Models with Explainable AI (XAI) | by Sean Wang | Towards Data Science", "h1": "Boosting Machine Learning Models with Explainable AI (XAI)", "description": "With a typical machine learning model, the traditional correlation of feature importance analysis often has limited value. In a data scientist\u2019s toolkit, are there reliable, systematic, model\u2026"}, "outgoing_paragraph_urls": [{"url": "https://arxiv.org/abs/1802.03888", "anchor_text": "SHAP paper", "paragraph_index": 7}, {"url": "https://arxiv.org/abs/1602.04938", "anchor_text": "\u201cWhy should I Trust You\u201d", "paragraph_index": 9}, {"url": "https://github.com/seanxwang/XAI-airbnb-booking", "anchor_text": "https://github.com/seanxwang/XAI-airbnb-booking", "paragraph_index": 28}, {"url": "https://www.linkedin.com/in/seanxwang", "anchor_text": "https://www.linkedin.com/in/seanxwang", "paragraph_index": 31}], "all_paragraphs": ["With a typical machine learning model, the traditional correlation of feature importance analysis often has limited value. In a data scientist\u2019s toolkit, are there reliable, systematic, model agnostic methods that measure feature impact accurate to the prediction? The answer is yes.", "Here we use a model built on Airbnb data to illustrate:", "As AI gains traction with more applications, Explainable AI (XAI) is an increasingly critical component to explain with clarity and deploy with confidence. XAI technologies are becoming more mature for both machine learning and deep learning. Here are a couple of algorithm neutral methods that are practical to use today:", "SHAP (SHapley Additive exPlanations) is developed by Scott Lundberg at the University of Washington. SHAP computes Shapley values from game theory, by assuming that each feature value of the instance is a \u201cplayer\u201d in a game where the prediction is the payout. Then a prediction can be explained by computing the contribution of each feature to the prediction. Note SHAP has these desirable properties:", "1. Local accuracy: the sum of the feature attributions is equal to the output of the model we are trying to explain", "2. Missingness: features that are already missing have no impact", "3. Consistency: changing a model so a feature has a larger impact on the model will never decrease the attribution assigned to that feature.", "SHAP supports tree ensemble, deep learning and other models. It can be used for both global and local explanation. Please refer to Scott Lundberg\u2019s SHAP paper.", "Local Interpretable Model-Agnostic Explanations (LIME) is based on the concept of surrogate models. When interpreting a black box model, LIME tests what happens to the predictions with variations of data, and trains local surrogate models with weighted features. Finally, individual predictions for \u201cblack box\u201d models can be explained with local, interpretable, surrogate models.", "Please refer to LIME paper: \u201cWhy should I Trust You\u201d", "The model used here predicts Airbnb booking rate. It is trained with data for Los Angeles area listings, obtained from insideairbnb.com. For simplicity, I use a subset of features to train an XGBoost model.", "SHAP summary shows top feature contributions. It also shows data point distribution and provides visual indicators of how feature values affect predictions. Here red indicates higher feature value, blue indicates lower feature value. On the x-axis, higher SHAP value to the right corresponds to higher prediction value (more likely listing gets booked), lower SHAP value to the left corresponds to lower prediction value (less likely listing gets booked).", "Here are a few insights gained with global feature analysis:", "Using Dependence Plots, we can examine the relationship between feature values and predicted outcome. In the first diagram, as the number of listings a host has increases, we see a decreasing trend of SHAP values. In the second diagram, the x-axis shows host listings count, the color shows listings count of \u201centire home\u201d.", "We can probably derive these type of hosts:", "Given the choice, should a host charge more on nightly price or cleaning fee? The dependence plot shows feature interaction between price and cleaning fee. The red color indicates a higher cleaning fee. Along the x-axis, as price increases, predicted booking rate decreases, which is expected. Further, we see listing with higher cleaning fee (red dots) tends to stay above those with lower cleaning fee (blue dots).", "Therefore, a listing with a higher cleaning fee is actually favorable when it comes to predicted booking rate. A host who shifts costs more to the cleaning fee probably wins by encouraging guests to stay longer and makes listing price seems cheaper on the front page.", "In the diagram, we see an increase in review rating (x-axis) leads to higher booking rate. An increase in the number of reviews, however, does not correspond to better booking rate (red dots are scattered vertically). A host is much better off getting a few good reviews than having a lot of mediocre reviews.", "SHAP force plot can be used to explain individual predictions.", "For example, we can see that there is a base value (bias term) of 0.01249, with features in red pushes that value to the right, and features in blue pushes that value to the left, with a combined output of 0.58. Therefore, the effect of top feature is quantified on the prediction with local accuracy. The particular listing has a number of strong features values (superhost, low price, entire home, recent calendar updates) which makes it favorable for booking.", "The listing below has a number of feature values (high price of $390, long minimum stay of 30 days, long time calendar hasn\u2019t been updated) that makes it less likely to be booked.", "LIME method can be used to explain individual predictions as well, it quantitively shows the effect of top features (orange is positive, blue is negative).", "The first example shows a listing with mostly positive feature values (it is an entire home offered by a superhost, with lots of reviews).", "The second example shows a listing with negative feature values (it requires a minimum stay of 30 nights and charges a cleaning fee of $150).", "By examining the global and local impact of features, we can often reveal unexpected patterns of data and gain new insights. With further analysis, we may find the root cause to be one of the following:", "The diagram below shows there are mainly two types of listings with high \u201ccalendar_updated\u201d value (red dots). One group, on the left most side of x-axis, who has 0 reviews last twelve month, are essentially stale listing with negative SHAP value and therefore low predicted booking rate. The other red dots are scattered in the upper area which indicates they have higher SHAP value and more likely to get booked. Those are listings that are consistently available and require few calendar updates from hosts. This provides a clue for feature engineering with the goal to distinguish stable listing from training data.", "Another example shown here is Skater Partial Dependence Plot which shows the interaction of latitude and longitude features, with vertical axis indicating their effect on prediction. Visually, this 3D diagram can be superimposed on a map of the LA area, which clearly shows central and north area being more popular, and south being the least likely to be booked. This insight can not be gained with analysis of individual features.", "Making corrections, adjustments, and gaining new knowledge is part of the iterative model lifecycle which should lead to incremental improvements. XAI can uncover hidden clues and provide critical evidence for that.", "A simplified version of the model and XAI code can be found here: https://github.com/seanxwang/XAI-airbnb-booking", "Airbnb listings have rich and informative features such as image and text. Incorporating those into models can greatly enhance predictive performance. XAI with deep learning and vision should be both challenging and rewarding as well.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Science & ML Lead, Data Hacker https://www.linkedin.com/in/seanxwang"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F601683119c84&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fboosting-machine-learning-models-with-explainable-ai-xai-601683119c84&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fboosting-machine-learning-models-with-explainable-ai-xai-601683119c84&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fboosting-machine-learning-models-with-explainable-ai-xai-601683119c84&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fboosting-machine-learning-models-with-explainable-ai-xai-601683119c84&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----601683119c84--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----601683119c84--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@wang.sean.x?source=post_page-----601683119c84--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@wang.sean.x?source=post_page-----601683119c84--------------------------------", "anchor_text": "Sean Wang"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fbdd73728c7f1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fboosting-machine-learning-models-with-explainable-ai-xai-601683119c84&user=Sean+Wang&userId=bdd73728c7f1&source=post_page-bdd73728c7f1----601683119c84---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F601683119c84&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fboosting-machine-learning-models-with-explainable-ai-xai-601683119c84&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F601683119c84&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fboosting-machine-learning-models-with-explainable-ai-xai-601683119c84&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://arxiv.org/abs/1802.03888", "anchor_text": "SHAP paper"}, {"url": "https://arxiv.org/abs/1602.04938", "anchor_text": "\u201cWhy should I Trust You\u201d"}, {"url": "https://towardsdatascience.com/predicting-market-rank-for-airbnb-listings-59009a886d6", "anchor_text": "https://towardsdatascience.com/predicting-market-rank-for-airbnb-listings-59009a886d6"}, {"url": "https://github.com/seanxwang/XAI-airbnb-booking", "anchor_text": "https://github.com/seanxwang/XAI-airbnb-booking"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----601683119c84---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/explainable-ai?source=post_page-----601683119c84---------------explainable_ai-----------------", "anchor_text": "Explainable Ai"}, {"url": "https://medium.com/tag/xai?source=post_page-----601683119c84---------------xai-----------------", "anchor_text": "Xai"}, {"url": "https://medium.com/tag/airbnb?source=post_page-----601683119c84---------------airbnb-----------------", "anchor_text": "Airbnb"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F601683119c84&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fboosting-machine-learning-models-with-explainable-ai-xai-601683119c84&user=Sean+Wang&userId=bdd73728c7f1&source=-----601683119c84---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F601683119c84&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fboosting-machine-learning-models-with-explainable-ai-xai-601683119c84&user=Sean+Wang&userId=bdd73728c7f1&source=-----601683119c84---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F601683119c84&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fboosting-machine-learning-models-with-explainable-ai-xai-601683119c84&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----601683119c84--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F601683119c84&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fboosting-machine-learning-models-with-explainable-ai-xai-601683119c84&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----601683119c84---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----601683119c84--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----601683119c84--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----601683119c84--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----601683119c84--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----601683119c84--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----601683119c84--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----601683119c84--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----601683119c84--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@wang.sean.x?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@wang.sean.x?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Sean Wang"}, {"url": "https://medium.com/@wang.sean.x/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "17 Followers"}, {"url": "https://www.linkedin.com/in/seanxwang", "anchor_text": "https://www.linkedin.com/in/seanxwang"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fbdd73728c7f1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fboosting-machine-learning-models-with-explainable-ai-xai-601683119c84&user=Sean+Wang&userId=bdd73728c7f1&source=post_page-bdd73728c7f1--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F789e978d1d48&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fboosting-machine-learning-models-with-explainable-ai-xai-601683119c84&newsletterV3=bdd73728c7f1&newsletterV3Id=789e978d1d48&user=Sean+Wang&userId=bdd73728c7f1&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}