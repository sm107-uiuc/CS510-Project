{"url": "https://towardsdatascience.com/using-bayesian-statistics-to-compare-wines-ef2477047cb5", "time": 1683008735.2887921, "path": "towardsdatascience.com/using-bayesian-statistics-to-compare-wines-ef2477047cb5/", "webpage": {"metadata": {"title": "Using Bayesian Statistics to compare Wines | by Divyanshu Marwah | Towards Data Science", "h1": "Using Bayesian Statistics to compare Wines", "description": "comparing two groups of wines using Bayesian Statistics. Using Gibbs sampler to estimate model parameters and interpreting the outputs."}, "outgoing_paragraph_urls": [{"url": "https://www.kaggle.com/zynicide/wine-reviews", "anchor_text": "Kaggle wines reviews", "paragraph_index": 1}, {"url": "https://www.linkedin.com/in/divyanshumarwah/", "anchor_text": "LinkedIn", "paragraph_index": 23}, {"url": "https://github.com/divyanshumarwah", "anchor_text": "GitHub", "paragraph_index": 24}], "all_paragraphs": ["Most people, when asked which wine they prefer, reply either Red or White (or Rose in some cases). Even when we finalize the colour of wine there are thousands of varieties of wines available (and they all taste very different). Someone who is an avid wine drinker can easily differentiate between these wines and is very choosy with regards to country and variety of wines when picking up one. In this blog, we are going to use statistics to help us chose which wine is better.", "We will be considering Kaggle wines reviews dataset for this blog. This dataset contains reviews of different wines produced worldwide by some wine tasters. The rating of the wine is given by the points column on the scale of 1 to 100. Let us assume, one of my friends like Sauvignon Blanc from South Africa and another one like Chardonnay from Chile. And both of them agree that $15 is the right amount to spend on a bottle of wine. Now let\u2019s finalize this through without tasting either of them.", "Let\u2019s start this journey by having a look at the dataset:", "The dataset has 129971 data points with 14 columns. There are three numeric columns, \u2014 X, points, price; where X is the index. And the remaining 11 columns are of character type.", "Now, we need to decide between South African Sauvignon Blanc and Chilean Chardonnay, so let\u2019s filter these data points from the dataset.", "CAUTION: Both countries produce both varieties of wine. So we need to use this kind of combined filter conditions to select data instead of filtering varieties and countries in different filters.", "We get only 51 rows on selecting the data with our specific conditions. Let\u2019s do a sneak peek into the selected dataset and form our hypothesis. Firstly, the boxplot of the two wines is plotted to have an estimate of the median and range of values for points.", "It can be seen from that the values for \u201cChardonnay\u201d ranges from 81 to 88 with a median of around 85. Values for \u201cSauvignon Blanc\u201d ranges from 85 to 90 with a median of around 87. It is also evident from the median of the groups that Sauvignon Blanc has better points than Chardonnay, this can be used to form our hypothesis. Looking at the mean, median and standard deviation of these values:", "Well, it is quite evident that Sauvignon Blanc is rated better than the Chardonnay, but we cannot be sure on this since there are very few data points. Let\u2019s perform a two-sample t-test to form a hypothesis.", "Interpreting these results and forming our null and alternate hypothesis. The null hypothesis suggests that the difference between the two groups is zero. The p-value is 0.00203 which is less than 0.05, it signifies that we are 95% confident that Sauvignon Blanc is better, or we can also state it as there is 0.2% chance that the difference is zero. It is significant that the difference between the two means is not 0. Based on this t-test, we form our hypothesis that Sauvignon Blanc is better rated than Chardonnay. We will try to find this difference using the Bayesian inference method.", "We will now use a Gibbs Sampler to explicitly model the difference between the two groups of wines. This is used in order to perform a full conditional update for the mean and standard deviation (or precision) values. Gibbs Sampler simplifies our task of updating multiple parameters using the MCMC methods by dividing the process into updating one parameter at a time, using a potentially convenient full conditional probability. To perform the update for one particular parameter we substitute in the current values of all the other parameters. There are three parameters, which we are trying to estimate using the Gibbs Sampler,", "We assume that the range of data is covered in mu + 2d, with a common precision of tau. Hence, the two groups can be reparametrized as mu+del and mu-del. The hierarchical model of this is shown below:", "For prior values to the Gibbs Sampler, we take the best guess as follows: the points vary from 80 to 95, with a median value of around 85\u201387, so the best estimate for mu will be 85. We assume a standard deviation of around 10 and so the prior estimate for tau is 1/100. We give the starting value of del as 0 since as per the null hypothesis the difference in groups is 0. This prior guess will converge at their original values from data after the burn-in period of the sampler. We run the sampler for 5000 iterations. For a normal likelihood, mean follows a normal distribution with parameters mu0 and \ud835\udf0e2, standard deviation \ud835\udf0e2 follows an inverse gamma distribution (hence tau follows the Gamma distribution) and del is also following a normal distribution. These distributions are used to update the parameters in our Gibbs sampler.", "After generating samples from the Gibbs method, we create the plots using MCMC fit method to analyze the convergence of the estimated parameters (mu, del and tau).", "From this figure, it is observed that the simulated Markov chain has converged to its posterior distribution for all three parameters and the posterior parameter estimate values for mu, del and tau follow a normal distribution. Since the posterior estimate of mu, del and tau also follow the normal distribution, our guess prior to the Gibbs method is considered as the conjugate prior for the normal likelihood function. This full conditional update on the parameters gives us the following posterior values as follows:", "Let\u2019s calculate the mean for group 1 (which is \u201cChilean Chardonnay\u201d in our case) as mu+del, we get 85.084, and mean for group 2 (\u201cSouth African Sauvignon Blanc\u201d) as mu-del, we get 87.204 with a standard deviation of 2.778. Based on these values, we can reject the null hypothesis and accept that the difference in points between the two wines is not zero.", "So, we have a winner in our case, South African Sauvignon Blanc is better rated than the Chilean Chardonnay by 2.1198 points.", "Ahhh, but my friends seem to be adamant, so we decided to buy both the wines for $15 each. Now let\u2019s see what\u2019s the probability that South African Sauvignon Blanc will be better.", "We can again use the same Gibbs Sampler for the predictive task on the unobserved data. From the Gibbs Sampling fit model used in the last part, we create two more simulations of 5000 each, first representing the \u201cChardonnay\u201d with the mean estimate in the last part of (mu + del) and second group of \u201cSauvignon Blanc\u201d with the mean estimate of (mu \u2014 del) with the common standard deviation. The same Gibbs sampler output fit received in the last part is used as the simulation parameter for this part.", "We plot the posterior distribution received from this simulation and it follows a normal distribution curve,", "These samples help us in checking whether the mean of one wine is better than others or not. Each sample of one wine is checked against each sample of other wine. This generates a probability which tells us which wine is better and by how much.", "This kind of modelling and comparison can also be extended to multiple groups, estimating within group means, across group means, precision, etc.", "The dataset used in this quite interesting and can be used for regression modelling for point estimates, text analysis and NLP(since there are alot of textual columns) and many more\u2026", "Connect and chat with me over such ideas on LinkedIn.", "Find other exciting projects on GitHub.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Scientist | MS in Computer Science \u2014 Data Science"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fef2477047cb5&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-bayesian-statistics-to-compare-wines-ef2477047cb5&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-bayesian-statistics-to-compare-wines-ef2477047cb5&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-bayesian-statistics-to-compare-wines-ef2477047cb5&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-bayesian-statistics-to-compare-wines-ef2477047cb5&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----ef2477047cb5--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----ef2477047cb5--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@divyanshu.marwah?source=post_page-----ef2477047cb5--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@divyanshu.marwah?source=post_page-----ef2477047cb5--------------------------------", "anchor_text": "Divyanshu Marwah"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F7e38c6c1516a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-bayesian-statistics-to-compare-wines-ef2477047cb5&user=Divyanshu+Marwah&userId=7e38c6c1516a&source=post_page-7e38c6c1516a----ef2477047cb5---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fef2477047cb5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-bayesian-statistics-to-compare-wines-ef2477047cb5&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fef2477047cb5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-bayesian-statistics-to-compare-wines-ef2477047cb5&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@chuttersnap?utm_source=medium&utm_medium=referral", "anchor_text": "chuttersnap"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://www.kaggle.com/zynicide/wine-reviews", "anchor_text": "Kaggle wines reviews"}, {"url": "https://github.com/divyanshumarwah/wine-reviews-statistical-modeling-analysis/blob/master/wine-comparison.Rmd", "anchor_text": "https://github.com/divyanshumarwah/wine-reviews-statistical-modeling-analysis/blob/master/wine-comparison.Rmd"}, {"url": "https://www.linkedin.com/in/divyanshumarwah/", "anchor_text": "LinkedIn"}, {"url": "https://github.com/divyanshumarwah", "anchor_text": "GitHub"}, {"url": "https://medium.com/tag/bayesian-statistics?source=post_page-----ef2477047cb5---------------bayesian_statistics-----------------", "anchor_text": "Bayesian Statistics"}, {"url": "https://medium.com/tag/statistical-modeling?source=post_page-----ef2477047cb5---------------statistical_modeling-----------------", "anchor_text": "Statistical Modeling"}, {"url": "https://medium.com/tag/gibbs-sampling?source=post_page-----ef2477047cb5---------------gibbs_sampling-----------------", "anchor_text": "Gibbs Sampling"}, {"url": "https://medium.com/tag/data-analytics?source=post_page-----ef2477047cb5---------------data_analytics-----------------", "anchor_text": "Data Analytics"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fef2477047cb5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-bayesian-statistics-to-compare-wines-ef2477047cb5&user=Divyanshu+Marwah&userId=7e38c6c1516a&source=-----ef2477047cb5---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fef2477047cb5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-bayesian-statistics-to-compare-wines-ef2477047cb5&user=Divyanshu+Marwah&userId=7e38c6c1516a&source=-----ef2477047cb5---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fef2477047cb5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-bayesian-statistics-to-compare-wines-ef2477047cb5&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----ef2477047cb5--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fef2477047cb5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-bayesian-statistics-to-compare-wines-ef2477047cb5&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----ef2477047cb5---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----ef2477047cb5--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----ef2477047cb5--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----ef2477047cb5--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----ef2477047cb5--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----ef2477047cb5--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----ef2477047cb5--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----ef2477047cb5--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----ef2477047cb5--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@divyanshu.marwah?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@divyanshu.marwah?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Divyanshu Marwah"}, {"url": "https://medium.com/@divyanshu.marwah/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "2 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F7e38c6c1516a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-bayesian-statistics-to-compare-wines-ef2477047cb5&user=Divyanshu+Marwah&userId=7e38c6c1516a&source=post_page-7e38c6c1516a--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fec73c0259dfd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-bayesian-statistics-to-compare-wines-ef2477047cb5&newsletterV3=7e38c6c1516a&newsletterV3Id=ec73c0259dfd&user=Divyanshu+Marwah&userId=7e38c6c1516a&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}