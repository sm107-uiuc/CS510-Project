{"url": "https://towardsdatascience.com/model-based-micro-data-reinforcement-learning-cabe95990664", "time": 1683017533.089063, "path": "towardsdatascience.com/model-based-micro-data-reinforcement-learning-cabe95990664/", "webpage": {"metadata": {"title": "Model-based micro-data reinforcement learning | by Bal\u00e1zs K\u00e9gl | Towards Data Science", "h1": "Model-based micro-data reinforcement learning", "description": "Joint work with Gabriel Hurtado and Albert Thomas. This research is part of a broader theme to build AI autopilots for engineering systems. The corresponding research paper. Open source code to\u2026"}, "outgoing_paragraph_urls": [{"url": "https://gabriel-hurtado.github.io/", "anchor_text": "Gabriel Hurtado", "paragraph_index": 0}, {"url": "https://albertcthomas.github.io/", "anchor_text": "Albert Thomas", "paragraph_index": 0}, {"url": "https://balazskegl.medium.com/building-autopilots-for-engineering-systems-using-ai-86a4f312c1f2", "anchor_text": "AI autopilots for engineering systems", "paragraph_index": 0}, {"url": "https://openreview.net/forum?id=p5uylG94S68", "anchor_text": "research paper", "paragraph_index": 0}, {"url": "https://github.com/ramp-kits/rl_simulator", "anchor_text": "Open source code", "paragraph_index": 0}, {"url": "https://t.co/IxNIVOnUsR", "anchor_text": "Video teaser", "paragraph_index": 0}, {"url": "https://arxiv.org/abs/1805.12114", "anchor_text": "excellent", "paragraph_index": 4}, {"url": "https://arxiv.org/abs/1708.02596", "anchor_text": "model-based", "paragraph_index": 4}, {"url": "http://mlg.eng.cam.ac.uk/yarin/PDFs/DeepPILCO.pdf", "anchor_text": "techniques", "paragraph_index": 4}, {"url": "https://www.cs.toronto.edu/~tingwuwang/mbrl.html", "anchor_text": "horizontal study", "paragraph_index": 4}, {"url": "https://gym.openai.com/envs/Acrobot-v1/", "anchor_text": "Acrobot system", "paragraph_index": 6}, {"url": "http://underactuated.mit.edu/acrobot.html#section1", "anchor_text": "underactuated double pendulum", "paragraph_index": 6}, {"url": "https://ieeexplore.ieee.org/document/454357", "anchor_text": "chaotic at the top equilibrium", "paragraph_index": 6}, {"url": "https://ieeexplore.ieee.org/document/454357", "anchor_text": "Acrobot behaves chaotically", "paragraph_index": 8}, {"url": "https://publications.aston.ac.uk/id/eprint/373/1/NCRG_94_004.pdf", "anchor_text": "mixture density models", "paragraph_index": 16}, {"url": "https://arxiv.org/abs/1605.08803", "anchor_text": "Flows", "paragraph_index": 20}, {"url": "https://arxiv.org/abs/1312.6114", "anchor_text": "variational", "paragraph_index": 20}, {"url": "https://arxiv.org/abs/1505.05770", "anchor_text": "autoencoders", "paragraph_index": 20}, {"url": "https://arxiv.org/abs/1605.08803", "anchor_text": "flows", "paragraph_index": 23}, {"url": "https://arxiv.org/abs/1312.6114", "anchor_text": "variational", "paragraph_index": 23}, {"url": "https://arxiv.org/abs/1505.05770", "anchor_text": "autoencoders", "paragraph_index": 23}, {"url": "https://arxiv.org/abs/1306.0186", "anchor_text": "RNADE", "paragraph_index": 24}, {"url": "https://publications.aston.ac.uk/id/eprint/373/1/NCRG_94_004.pdf", "anchor_text": "mixture density net", "paragraph_index": 25}, {"url": "https://arxiv.org/abs/1805.12114", "anchor_text": "PETS", "paragraph_index": 26}, {"url": "http://www.ramp.studio", "anchor_text": "http://www.ramp.studio", "paragraph_index": 28}], "all_paragraphs": ["Joint work with Gabriel Hurtado and Albert Thomas. This research is part of a broader theme to build AI autopilots for engineering systems.The corresponding research paper.Open source code to reproduce all our results.Video teaser.", "One of our main research objectives at the Noah\u2019s Ark Lab in Huawei France is to build AI autopilots for engineering systems.", "We can improve various metrics: making the systems better, cheaper, more reliable, safer, or more energy efficient. Typical systems we are working on include the cooling system of data centers, the system that manages the connections in the wireless antenna, or your local Wi-Fi network. The applications of the technology we are developing are countless: given that engineering systems are the backbone of most industry and transportation, making AI useful in this domain is arguably a multi-trillion dollar endeavor.", "What makes engineering systems special: they are physical, not getting faster with time, unlike computers, and they are tightly controlled by system engineers. This means that we need to learn a good control policy based on small offline data and iterate with systems engineers slowly: a typical iteration of policy validation and data taking may take several weeks even months. Model-based RL (MBRL) is considered the best approach for this micro-data regime, and it fits well the human work process we can hope to implement within the constraints of a real engineering system. In addition, systems engineers can validate the learned simulator on its own, increasing their trust in the process.", "Scanning the literature, we found excellent model-based techniques and this immensely useful horizontal study on the best known models compared on many systems. The MBRL research field seems to operate in an engineering paradigm where the main objective is to design end-to-end systems that beat the state of the art on some benchmark systems. Our goal is to learn generalizable principles and state and rigorously test hypotheses, while also attempting to obtain good performance on benchmark systems. More pragmatically, we would like to develop", "so that the data scientist (and eventually the systems engineer) can make informed decisions given his or her system to automate. For this, we started with a systematic study on models and proper ways to compare and tune them. We defined a set of criteria to compare models, not only on their performance but also on their practical usability. We designed rigorous and fair experiments, tested and (in)validated hypotheses, and found some curious experimental facts that we cannot yet explain.", "We made a choice to do a vertical study: instead of running the methods on several environments, we chose one, the relatively simple yet challenging Acrobot system. Unlike the name suggests, Acrobot mimics a gymnast on the horizontal bar rather than an acrobat. It is an underactuated double pendulum (the only action is a discrete torque at the second joint: the gymnast can kick his legs forward, backward, or no action). It is noiseless but chaotic at the top equilibrium. We use Acrobot with continuous (dense) reward (height of the tip) since it is closer to what we have in engineering systems than Acrobot with the (sparse) 0/1 reward (height > 3 on our scale, the horizontal line in the video below).", "We used two setups to test the different aspects of the models. The \u201csincos\u201d system predicts the sine and cosine of the two angles, eliminating the discontinuities at \u00b1\u03c0, while introducing strong (functional) y-interdependence between the observables. This is the usual setup in the literature.", "The \u201craw angles\u201d system keeps the angles as the prediction targets, challenging the models at \u00b1\u03c0 where the angle trajectories jump and Acrobot behaves chaotically (small differences in the initial conditions lead to qualitatively different futures).", "Choosing a single system definitely limits the generality of our findings. On the other hand, it allowed us to pay attention to the specifics of the system and find solutions that turned out to be better than the state of the art by multiple folds (in terms of sample complexity). Above all, it made us learn a lot, both about Acrobot and the models we tested.", "We defined seven discrete-valued (binary or ternary) requirements on which the models can be compared. They go from hard \u201cmust have\u201d model properties to softer ones that a practicing data scientist may find important. We can complete them by gray-scale computational complexities at training and simulation time.", "We have introduced a rigorous experimental framework.", "Models can be tested on static data sets, using various metrics: log likelihood, precision (R2), outlier rate, and calibratedness. Some of these metrics can be computed using Monte-Carlo simulation several steps ahead.", "Models can be tested fairly on the dynamical system. We fixed the planning agent to random shooting with fixed hyperparameters (optimized to do well on the real system). We introduced", "We report rigorous confidence intervals based both on random seeds and on running the systems for a long time after convergence.", "The sincos system requires no multimodality, so essentially", "all deep mixture density models do well, improving the current state of the art sample complexity by two to four fold.", "To our biggest surprise, we do not even need probabilistic models:", "deterministic models (forecasting the mean of the posterior predictive) are optimal, but only if we use a heteroscedastic log-likelihood metrics at training time.", "A deterministic neural net trained with the classical MSE target one step ahead is suboptimal both on the dynamic scores and on the static scores ten steps ahead. We have no verified explanation for this; our current hypothesis is that heteroscedasticity allows the model to downweight certain training points that are hard to predict.", "Flows (RealNVP) and variational autoencoders (VAE) are suboptimal even on the sincos system.", "This system requires multimodal posterior predictives at \u00b1\u03c0.", "The only models that do well are those that use explicit mixture densities.", "In principle flows (RealNVP) and variational autoencoders (VAE) can model multi-modal posterior predictives but in our experiments on the raw angles Acrobot system we were not able to tune them to do so.", "Overall, our preferred model is the deep autoregressive mixture density net, we call it DARMDN (\u201cdarm-dee-en\u201d; similar to RNADE). Not only it performs optimally on both Acrobot systems, but autoregressivity means that we can model one variable at a time, so DARMDN is easy-to-adapt to engineering systems which come with heterogeneous system observables.", "The classical non-autoregressive mixture density net (DMDN) uses a mixture of axis-aligned multivariate Gaussians. It also nails the two Acrobot systems but the practicing data scientist has less control over individual observable models, in case they are discrete/continuous or have heavy tail.", "The bagged single-Gaussian DMDN(1) is equivalent to what the PETS algorithm is using. It is a mixture density model, but it is learned using ensembling instead of directly optimizing log-likelihood. Ensembling is a variance reduction technique which improves sample complexity at the extreme low-data regime, but it cannot learn multi-modal posterior predictives, so it remains suboptimal on the raw angles system.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Head of AI research, Huawei France, previously head of the Paris-Saclay Center for Data Science, co-creator of RAMP (http://www.ramp.studio)."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fcabe95990664&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmodel-based-micro-data-reinforcement-learning-cabe95990664&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmodel-based-micro-data-reinforcement-learning-cabe95990664&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmodel-based-micro-data-reinforcement-learning-cabe95990664&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmodel-based-micro-data-reinforcement-learning-cabe95990664&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----cabe95990664--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----cabe95990664--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://balazskegl.medium.com/?source=post_page-----cabe95990664--------------------------------", "anchor_text": ""}, {"url": "https://balazskegl.medium.com/?source=post_page-----cabe95990664--------------------------------", "anchor_text": "Bal\u00e1zs K\u00e9gl"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fcc524271ea2b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmodel-based-micro-data-reinforcement-learning-cabe95990664&user=Bal%C3%A1zs+K%C3%A9gl&userId=cc524271ea2b&source=post_page-cc524271ea2b----cabe95990664---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fcabe95990664&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmodel-based-micro-data-reinforcement-learning-cabe95990664&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fcabe95990664&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmodel-based-micro-data-reinforcement-learning-cabe95990664&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://gabriel-hurtado.github.io/", "anchor_text": "Gabriel Hurtado"}, {"url": "https://albertcthomas.github.io/", "anchor_text": "Albert Thomas"}, {"url": "https://balazskegl.medium.com/building-autopilots-for-engineering-systems-using-ai-86a4f312c1f2", "anchor_text": "AI autopilots for engineering systems"}, {"url": "https://openreview.net/forum?id=p5uylG94S68", "anchor_text": "research paper"}, {"url": "https://github.com/ramp-kits/rl_simulator", "anchor_text": "Open source code"}, {"url": "https://t.co/IxNIVOnUsR", "anchor_text": "Video teaser"}, {"url": "https://arxiv.org/abs/1805.12114", "anchor_text": "excellent"}, {"url": "https://arxiv.org/abs/1708.02596", "anchor_text": "model-based"}, {"url": "http://mlg.eng.cam.ac.uk/yarin/PDFs/DeepPILCO.pdf", "anchor_text": "techniques"}, {"url": "https://www.cs.toronto.edu/~tingwuwang/mbrl.html", "anchor_text": "horizontal study"}, {"url": "https://gym.openai.com/envs/Acrobot-v1/", "anchor_text": "Acrobot system"}, {"url": "http://underactuated.mit.edu/acrobot.html#section1", "anchor_text": "underactuated double pendulum"}, {"url": "https://ieeexplore.ieee.org/document/454357", "anchor_text": "chaotic at the top equilibrium"}, {"url": "https://ieeexplore.ieee.org/document/454357", "anchor_text": "Acrobot behaves chaotically"}, {"url": "https://publications.aston.ac.uk/id/eprint/373/1/NCRG_94_004.pdf", "anchor_text": "mixture density models"}, {"url": "https://arxiv.org/abs/1605.08803", "anchor_text": "Flows"}, {"url": "https://arxiv.org/abs/1312.6114", "anchor_text": "variational"}, {"url": "https://arxiv.org/abs/1505.05770", "anchor_text": "autoencoders"}, {"url": "https://arxiv.org/abs/1605.08803", "anchor_text": "flows"}, {"url": "https://arxiv.org/abs/1312.6114", "anchor_text": "variational"}, {"url": "https://arxiv.org/abs/1505.05770", "anchor_text": "autoencoders"}, {"url": "https://arxiv.org/abs/1306.0186", "anchor_text": "RNADE"}, {"url": "https://publications.aston.ac.uk/id/eprint/373/1/NCRG_94_004.pdf", "anchor_text": "mixture density net"}, {"url": "https://arxiv.org/abs/1805.12114", "anchor_text": "PETS"}, {"url": "https://medium.com/tag/reinforcement-learning?source=post_page-----cabe95990664---------------reinforcement_learning-----------------", "anchor_text": "Reinforcement Learning"}, {"url": "https://medium.com/tag/dynamic-systems?source=post_page-----cabe95990664---------------dynamic_systems-----------------", "anchor_text": "Dynamic Systems"}, {"url": "https://medium.com/tag/autopilot?source=post_page-----cabe95990664---------------autopilot-----------------", "anchor_text": "Autopilot"}, {"url": "https://medium.com/tag/heteroscedasticity?source=post_page-----cabe95990664---------------heteroscedasticity-----------------", "anchor_text": "Heteroscedasticity"}, {"url": "https://medium.com/tag/model-based-rl?source=post_page-----cabe95990664---------------model_based_rl-----------------", "anchor_text": "Model Based Rl"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fcabe95990664&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmodel-based-micro-data-reinforcement-learning-cabe95990664&user=Bal%C3%A1zs+K%C3%A9gl&userId=cc524271ea2b&source=-----cabe95990664---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fcabe95990664&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmodel-based-micro-data-reinforcement-learning-cabe95990664&user=Bal%C3%A1zs+K%C3%A9gl&userId=cc524271ea2b&source=-----cabe95990664---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fcabe95990664&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmodel-based-micro-data-reinforcement-learning-cabe95990664&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----cabe95990664--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fcabe95990664&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmodel-based-micro-data-reinforcement-learning-cabe95990664&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----cabe95990664---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----cabe95990664--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----cabe95990664--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----cabe95990664--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----cabe95990664--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----cabe95990664--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----cabe95990664--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----cabe95990664--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----cabe95990664--------------------------------", "anchor_text": ""}, {"url": "https://balazskegl.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://balazskegl.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Bal\u00e1zs K\u00e9gl"}, {"url": "https://balazskegl.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "698 Followers"}, {"url": "http://www.ramp.studio", "anchor_text": "http://www.ramp.studio"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fcc524271ea2b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmodel-based-micro-data-reinforcement-learning-cabe95990664&user=Bal%C3%A1zs+K%C3%A9gl&userId=cc524271ea2b&source=post_page-cc524271ea2b--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fd2d5ee40e315&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmodel-based-micro-data-reinforcement-learning-cabe95990664&newsletterV3=cc524271ea2b&newsletterV3Id=d2d5ee40e315&user=Bal%C3%A1zs+K%C3%A9gl&userId=cc524271ea2b&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}