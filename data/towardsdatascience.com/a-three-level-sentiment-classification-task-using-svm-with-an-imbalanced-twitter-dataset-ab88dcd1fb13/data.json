{"url": "https://towardsdatascience.com/a-three-level-sentiment-classification-task-using-svm-with-an-imbalanced-twitter-dataset-ab88dcd1fb13", "time": 1683014182.19644, "path": "towardsdatascience.com/a-three-level-sentiment-classification-task-using-svm-with-an-imbalanced-twitter-dataset-ab88dcd1fb13/", "webpage": {"metadata": {"title": "Three level sentiment classification using SVM with an imbalanced Twitter dataset | by Alan Coyne | Towards Data Science", "h1": "Three level sentiment classification using SVM with an imbalanced Twitter dataset", "description": "As a news addict, I love seeing how politics can garner such emotive responses across social media and wondered if this anecdotal sense of passion could translate into machine learning\u2026"}, "outgoing_paragraph_urls": [{"url": "https://data.world/crowdflower/first-gop-debate", "anchor_text": "h", "paragraph_index": 0}, {"url": "https://arxiv.org/pdf/1106.1813.pdf", "anchor_text": "read it here!", "paragraph_index": 16}, {"url": "https://github.com/apcoyne/SVM-GOP-TWEETS", "anchor_text": "here", "paragraph_index": 41}], "all_paragraphs": ["As a news addict, I love seeing how politics can garner such emotive responses across social media and wondered if this anecdotal sense of passion could translate into machine learning classification. I found a dataset of Tweets made in reaction to the first Republican Presidential debate in 2016 (here) and wanted to create a three level sentiment classifier that could interpret emotions from the text of the Tweets. This article is part of a suite of methodologies and techniques I put together, for now I will just be focusing on one aspect; the humble Support Vector Machine. As a secondary task, I noticed the dataset was severely imbalanced so wanted to try and upsample the minority classes in an effort to improve the usefulness of the classifier across all labels (this will hopefully help the classifier improve across all categories).", "From looking at the raw figures in the breakdown of the dataset we immediately see an issue in the spread of the Tweets. Negative Tweets are prevalent and are over twice the rate of neutral and positive Tweets combined. This could have ramifications on how well the classifier works in practise. (Most likely, if trained like this, the classifier will be great at understanding a negative tweet but won\u2019t have much practise identifying anything else!)", "The first step of \u2018cleaning\u2019 the data was to convert all letters to lowercase, then punctuation, numbers and URLs and usernames were removed from the Tweets.", "Stop-words were removed from the tweets using the \u2018NLTK\u2019 stop-words corpus and white space was taken from the tweets, and each word was tokenised so as to represent an individual chunk of data to be considered as such.", "Duplicate tweets were then omitted. A decision was made to remove duplicates after the other pre-processing steps as, due to the nature of Twitter which consists of \u2018retweets\u2019, replies to other users or remarksusernames may have the exact same content. This left 9,836 total unique tweets prepared for classification. Negative: 5692, Neutral: 2521 and Positive: 1623. The dataset was split into 80% for training and 20% for testing", "For the purposes of most mathematical modelling performed on text and for the purposes of this experimentation different processes of \u2018vectorisation\u2019 were implemented.", "Text content alone is not capable of being altered and coerced into mathematical space without being transitioned into numbers for the purposes of being read by a machine learning algorithm.", "That is why for the purposes of the supervised methods in this project different types of vectorisation were used to convert qualitative data to quantitative data in order for it to be mathematically manipulated. These vectors become embedded features for the models.", "This was the vectorisation technique used for the Support Vector Machine model. TF/IDF was deployed on the training data with a unigram approach which counts each individual word as a term. \u2018Term frequency\u2019 amounts to how frequently a certain word appears in the text, \u2018inverse document frequency\u2019 refers to reducing the significance of words which appear most often across all of the text.", "This serves to make words that are seen frequently in a given document but not necessarily all of the documents.", "Data balancing in the form of Random Oversampling, Synthetic Minority Oversampling and a real world unbalanced method were all utilised and compared.", "It is crucial to take data balancing issues and protocols into consideration as every action should be undertaken to reduce bias and increase true performance but also try and reduce overfitting and have a more nuanced representation of the model\u2019s potential. It is important to consider upsampling techniques as it can make it easier for models to outline its decision boundary. It was decided not to use under sampling techniques as it was felt this would do little to improve performance in this case due to the fact the dataset was quite small initially and was again reduced further due to preprocessing measures and training splits.", "Classes may be left unbalanced with models being trained on exactly how the tweets would appear in a real life context. It would be naive to assume that models may not perform as well without upsampling previously. If data in a given domain are naturally severely unbalanced, then training on unbalanced data may produce optimal outputs.", "Random over-sampling is a process of taking duplicate examples from the two minority classes and adding these to the training set. Examples are chosen at random from the minority classes in the training set and then duplicated and added to the training set where they have the potential to be chosen again.", "Because the duplicates are exact and there is the potential for duplicate examples to appear multiple times, there is a risk of overfitting the minority classes with this approach and for models implementing this technique to suffer from increased generalisation of data.", "For the purposes of this experiment, the minority classes were both up-sampled to the same value as the majority negative class so that each class had 5,692 examples after upsampling was applied.", "Researchers; Chawla, Bowyer, Hall, and Kegelmeyer created this upsampling technique in their paper named for the technique titled \u201cSMOTE: Synthetic Minority Over-sampling Technique.\u201d(read it here!)", "SMOTE is another useful upsampling method. As opposed to random oversampling which creates exact duplicates of data points from the minority class, SMOTE uses a type of data augmentation in order to \u2018synthesise\u2019 completely new and unique examples. SMOTE is implemented by choosing instances that are close to each other in the feature space and creating a boundary between these examples and creating a new sample at a certain point along that boundary. This approach tends to be effective, as the new synthetic tweets are closer to other examples in the feature space so are potentially closer in their polarity than the randomly up-sampled examples and because they are not exactly the same examples as in random over sampling, the likelihood of overfitting is reduced.", "Experimental evaluation metrics vary and are usually dependent on the nature of the task being conducted. Some of the typically used evaluation metrics for analytics for analytical procedures include, but are not limited to; accuracy, precision, recall, Mean Squared Error, analysis of the Loss Function, Area Under the Curve, F1-Score. Different models in different domains will result in different results for each metric and suitable ones must be decided upon and must meet evaluation criteria necessary.", "Accuracy is one of the most frequently measured evaluation metrics in classification tasks and is most often defined as the number of correctly classified labels in proportion to the number of predictions in total.", "The \u2018F1 Score\u2019, \u2018F-Score\u2019 or the \u2018F-Measure\u2019, is a common metric used for the evaluation of Natural Language based tasks. It is often said to be \u2018The Harmonic Mean of Precision and Recall\u2019, or conveys the balance between precision and recall.", "The F-Measure expresses the balance between the precision and the recall. As accuracy only gives the percentage of correct results of the model but does not show how adept the model is at finding true positive results, both measures have merit, depending on the need.", "The ROC is a graph which displays the performance of a classification model in terms of its True Positive Rate (TPR) and its False Positive Rate (FPR). TPR is defined as the collective number of true positives output by the model divided by the number of true positives plus the total number of false negatives.", "The AUC statistic is a measure of the dimensional space underneath the ROC curve. This figure gives the aggregated score of model performance across all of the potential classification thresholds. An interpretation of this would be that the model positions a positive random example higher than an example which is randomly negative. The AUC is always a figure between 0 and 1.", "The ROC metrics is useful as it has invariance to prior class probabilities or class prevalence in the data, along with the AUC. This is important for this study as the classes are severely unequal. The large presence of the negative class indicates the probability of the models correctly classifying a positive tweet randomly is increased.", "The following is the results obtained from the Support Vector Machine trained with Term Frequency/Inverse Document Frequency vectors with various oversampling techniques to the minority classes.", "The figure below shows the results for the Support Vector Machine model, trained on unbalanced training data. The overall accuracy of the model here is 60% but looking at the precision, recall and f1 score for this approach we see how the model has poor performance when categorising the smaller classes here. The model understands the negative class but fails to learn much from the smaller classes as is clear from a quite low 18% and 19% \u2018f1\u2019 for the neutral and positive classes.", "From the ROC curve and AUC shown below we see a more rounded perspective of the model\u2019s performance. The true positive rate of all three classes was almost the same except for a 1% lower AUC for neutral compared to the other classes. The model\u2019s overall ability at classification is not particularly apparent even though the model has an overall accuracy of 60% true positive rate.", "From the confusion matrix shown we see the actual predicted values of the SVM model. The model clearly shows its best performance when classifying the negative class.", "1086 correct predictions in this class. However, we see only 37 correct predictions of the negative class which is slightly less than 10% of correct predictions here. The neutral class has 55 correct predictions, a slight improvement on the negative class here. It is interesting to note how this model incorrectly labeled a tweet as negative substantially more than any other class. Showing how the model relied heavily on the negative class to influence its decision making.", "Support Vector Machine TF/IDF Randomly Oversampled Classes", "The classification report displayed below shows the results of the SVM TF/IDF model when the random oversampling technique is applied to up-sample the minority classes. It is noteworthy that the overall accuracy for this approach does not differ from the same approach with unbalanced classes but the models performance in correctly classifying the smaller classes does improve slightly, as shown by the improved f1-score on the negative classes.", "Shown below is a representation of the ROC curve and AUC figure for the SVM model with random oversampling. The true positive rate of this model across all classes is an improvement of at least 4% across all classes. Not only did the model improve its classification of negative classes by increasing samples of the minority classes but the model improved considerably across all classes. The model is still best at finding the negative class, but it also did not lose any of this knowledge when presented with more diverse training examples.", "The figure below shows a confusion matrix for the SVM ROS model. It is noteworthy that the classifier is marginally worse at correctly classifying the negative when compared with the unbalanced dataset (1086 versus 977 respectively) but almost doubles its correct classification of the positive class (37 versus 70). The number of correct predictions of the neutral class improved considerably (from 55 to 140). It is also relevant to point out that the total number of incorrectly classified negative examples was reduced significantly.", "The figure below shows the classification report of the SVM-TF/IDF with the SMOTE upsampling technique applied. The overall accuracy of the model remains static at 60% however we do see an improved f1 score for the two minority classes when compared to the unbalanced approach but not the randomly up-sampled method.", "The figure below displays the ROC curve and AUC number for the SVM with SMOTE. It is clear by comparing the two graphs and metrics that follow, that there is a clear drop in true positive numbers when compared to the ROS approach. This approach is only marginally improved when assessed next to the unbalanced approach. Classification of the negative class had an improvement of 2% when compared to no upsampling and generally the model is between 1% to 2% less capable of classifying any of the classes.", "Finally, the plot below shows the confusion matrix for the SVM with SMOTE. The negative class is still the label that the classifier correctly identities but it is interesting to note how the correct predictions for the neutral class drop almost by half when using this technique compared to ROS (72 versus 140). The classifier here also misclassifies Tweets as negative a lot more using this technique compared to ROS. Rather than diversifying the range of predictions that it makes, the classifier relies heavily on the negative class label in this instance. It is also worth noting how this model not only misclassified the positive class more than the ROS model but makes far less total predictions for this label.", "The Support Vector Machine found it extremely difficult to make correct classifications when trained on imbalanced training data. Not using a parameter tuning technique and just a simple linear approach may have caused issues also.", "SVM\u2019s are sensitive to imbalanced data and work best with naturally balanced classes. That may have caused decreased performance. It also explains how the unbalanced experimentation yielded less useful results.", "In terms of overall accuracy in a general sense, all three upsampling techniques gave the same accuracy metrics but it is clear intuitively that the best performance was consistently on labelling the negative class.", "Referring to the \u2018F1-Measure\u2019 of the classifier, the Randomly upsampled model gave the best results. However it must be remembered that randomly oversampling data creates exact recreations of instances, which has the potential to lead to overfitting.", "Jupyter Notebooks with all of the python code to accompany this report can be found on the GitHub repo here! :)", "Report and code made by Alan Coyne, Freelance Data Scientist based in Dublin, Ireland", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Technical Content Bro in Dublin, Ireland. Data science and Software. DATA$LUT"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fab88dcd1fb13&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-three-level-sentiment-classification-task-using-svm-with-an-imbalanced-twitter-dataset-ab88dcd1fb13&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-three-level-sentiment-classification-task-using-svm-with-an-imbalanced-twitter-dataset-ab88dcd1fb13&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-three-level-sentiment-classification-task-using-svm-with-an-imbalanced-twitter-dataset-ab88dcd1fb13&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-three-level-sentiment-classification-task-using-svm-with-an-imbalanced-twitter-dataset-ab88dcd1fb13&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----ab88dcd1fb13--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----ab88dcd1fb13--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@apcoyne100?source=post_page-----ab88dcd1fb13--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@apcoyne100?source=post_page-----ab88dcd1fb13--------------------------------", "anchor_text": "Alan Coyne"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F9ecb3ce48bc1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-three-level-sentiment-classification-task-using-svm-with-an-imbalanced-twitter-dataset-ab88dcd1fb13&user=Alan+Coyne&userId=9ecb3ce48bc1&source=post_page-9ecb3ce48bc1----ab88dcd1fb13---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fab88dcd1fb13&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-three-level-sentiment-classification-task-using-svm-with-an-imbalanced-twitter-dataset-ab88dcd1fb13&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fab88dcd1fb13&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-three-level-sentiment-classification-task-using-svm-with-an-imbalanced-twitter-dataset-ab88dcd1fb13&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@historyhd?utm_source=medium&utm_medium=referral", "anchor_text": "History in HD"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://data.world/crowdflower/first-gop-debate", "anchor_text": "h"}, {"url": "https://arxiv.org/pdf/1106.1813.pdf", "anchor_text": "read it here!"}, {"url": "https://github.com/apcoyne/SVM-GOP-TWEETS", "anchor_text": "here"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----ab88dcd1fb13---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/classification-algorithms?source=post_page-----ab88dcd1fb13---------------classification_algorithms-----------------", "anchor_text": "Classification Algorithms"}, {"url": "https://medium.com/tag/twitter?source=post_page-----ab88dcd1fb13---------------twitter-----------------", "anchor_text": "Twitter"}, {"url": "https://medium.com/tag/python?source=post_page-----ab88dcd1fb13---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/data-science?source=post_page-----ab88dcd1fb13---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fab88dcd1fb13&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-three-level-sentiment-classification-task-using-svm-with-an-imbalanced-twitter-dataset-ab88dcd1fb13&user=Alan+Coyne&userId=9ecb3ce48bc1&source=-----ab88dcd1fb13---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fab88dcd1fb13&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-three-level-sentiment-classification-task-using-svm-with-an-imbalanced-twitter-dataset-ab88dcd1fb13&user=Alan+Coyne&userId=9ecb3ce48bc1&source=-----ab88dcd1fb13---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fab88dcd1fb13&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-three-level-sentiment-classification-task-using-svm-with-an-imbalanced-twitter-dataset-ab88dcd1fb13&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----ab88dcd1fb13--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fab88dcd1fb13&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-three-level-sentiment-classification-task-using-svm-with-an-imbalanced-twitter-dataset-ab88dcd1fb13&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----ab88dcd1fb13---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----ab88dcd1fb13--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----ab88dcd1fb13--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----ab88dcd1fb13--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----ab88dcd1fb13--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----ab88dcd1fb13--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----ab88dcd1fb13--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----ab88dcd1fb13--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----ab88dcd1fb13--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@apcoyne100?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@apcoyne100?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Alan Coyne"}, {"url": "https://medium.com/@apcoyne100/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "24 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F9ecb3ce48bc1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-three-level-sentiment-classification-task-using-svm-with-an-imbalanced-twitter-dataset-ab88dcd1fb13&user=Alan+Coyne&userId=9ecb3ce48bc1&source=post_page-9ecb3ce48bc1--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F7bdf0dbfa05a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-three-level-sentiment-classification-task-using-svm-with-an-imbalanced-twitter-dataset-ab88dcd1fb13&newsletterV3=9ecb3ce48bc1&newsletterV3Id=7bdf0dbfa05a&user=Alan+Coyne&userId=9ecb3ce48bc1&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}