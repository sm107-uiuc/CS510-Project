{"url": "https://towardsdatascience.com/execute-hiveql-script-with-email-notifications-86bc0967a454", "time": 1683002068.672009, "path": "towardsdatascience.com/execute-hiveql-script-with-email-notifications-86bc0967a454/", "webpage": {"metadata": {"title": "Automatic Email Notifications for HiveQL/SQL Script Completion | by Andrew Young | Towards Data Science", "h1": "Automatic Email Notifications for HiveQL/SQL Script Completion", "description": "This bash script is very useful for executing HiveQL files (.hql)or SQL files (.sql). For instance, rather than having to periodically check when a CREATE TABLE or JOINhas finished, this script\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.jetmore.org/john/code/swaks/", "anchor_text": "waks", "paragraph_index": 11}], "all_paragraphs": ["If you find this article helpful in any way, please comment or click the applause button at the left to give me free virtual encouragement!", "This bash script is very useful for executing HiveQL files (.hql)or SQL files (.sql). For instance, rather than having to periodically check when a CREATE TABLE or JOINhas finished, this script provides email notifications as well as a record for the clock time needed for the Hive/SQL operation(s) involved. This is especially useful for completing a series of Hive/SQL JOINs overnight for analysis the next day.", "A s a practicing data scientist, I dislike overexplained fluff pieces when I\u2019m just looking for code to recycle and modify for my purposes so please find the script below. If you would like more explanation of the script beyond the code comments, please see the appendix at the end. A sufficient explanation of bash , its transformations at the bit-level, HiveQL/SQL and database engines is beyond the scope of this article. As it is written, the script below will only work for HiveQL when copy-pasted. You will have to make slight modifications for it to work with your SQL distribution. For example, changing hive -f to mysql source if you are using MySQL. It is also possible to have the script send emails to more than one email address.", "H ere I will explain the code for each section of the script.", "chmod is a bash command that stands for \u201cchange mode.\u201d I am using it to change the permissions of the file. It ensures that you, the owner, is allowed to execute your own file on the node/machine you are using.", "In this section, I use the command ls -l to list all files in the same directory (i.e. \u201cfolder\u201d) as the .sh file you saved my script to. The read -p is used to save the user input, i.e. the name of the .hql or .sql file you want to run, to a variable that is used later on in the script.", "This is where the system\u2019s clock time is recorded. We save two versions to two different variables: startand starttime.", "start=\"$(date)\" saves the system time and date. starttime=$(date +%s) saves the system time and date in number seconds offset from 1900. The first version is later used in the email to show the timestamp and date of when the HiveQL/SQL script began execution. The second is used to calculate the number of seconds and minutes that have elapsed. This provides a handy record for the amount of time it took to build the table(s) in the HiveQL/SQL script you supplied.", "This is a complicated section to decode. Basically, it is a lot of code that does something very simple: finding the difference between start and end time, both in seconds, then converting that elapsed time in seconds to minutes and seconds. For example, if the job took 605 seconds, we transform that to 10 minutes 5 seconds and save it to a variable called timeelapsed to be used in the email we have sent to ourselves and/or various stakeholders.", "In this section, I again record system time in two different formats as two different variables. I actually only use one of these variables. I decided to keep the unused variable, endtime for potential future extensions to this script. The variable $end is used in the email notification to report the system time and date for when the HiveQL/SQL file completed.", "I define a variable subject that, unsurprisingly, becomes the subject line of the email. I commented out the message variable because I couldn\u2019t get the printf command to correctly replace \\n with new lines in the message body of the email. I left it in place because I wanted to leave you with the option of editing it for your own purposes.", "mail is a program that sends emails. You will probably have it or something like it. There are other options to mail, like mailx, sendmail, smtp-cli, ssmtp, Swaks and a number of others. Some of these programs are subsets or derivatives of each other.", "I n the spirit of collaboration and furthering this effort, here are some ideas for future work:", "Andrew Young is an R&D Data Scientist Manager at Neustar. For context, Neustar is an information services company that ingests structured and unstructured text and picture data from hundreds of companies in the domains of aviation, banking, government, marketing, social media and telecommunications to name several. Neustar combines these data ingredients then sells a finished dish with added value to enterprise clients for purposes like consulting, cyber security, fraud detection and marketing. In this context, Mr. Young is a hands-on lead architect on a small R&D data science team that builds the system feeding all products and services responsible for $1+ billion in annual revenue for Neustar.", "A pre-requisite to running the shell script above is to have a HiveQL or SQL script for it to run. Here is an example HiveQL script, example.hql:", "Note that you can have one or more CREATE TABLE commands in a single HiveQL/SQL script. They will be executed in sequence. If you have access to a cluster of nodes, you can also benefit from parallelization of your queries. I may explain that in another article.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F86bc0967a454&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fexecute-hiveql-script-with-email-notifications-86bc0967a454&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fexecute-hiveql-script-with-email-notifications-86bc0967a454&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fexecute-hiveql-script-with-email-notifications-86bc0967a454&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fexecute-hiveql-script-with-email-notifications-86bc0967a454&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----86bc0967a454--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----86bc0967a454--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://andrew-young.medium.com/?source=post_page-----86bc0967a454--------------------------------", "anchor_text": ""}, {"url": "https://andrew-young.medium.com/?source=post_page-----86bc0967a454--------------------------------", "anchor_text": "Andrew Young"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F6a9f152f0cc3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fexecute-hiveql-script-with-email-notifications-86bc0967a454&user=Andrew+Young&userId=6a9f152f0cc3&source=post_page-6a9f152f0cc3----86bc0967a454---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F86bc0967a454&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fexecute-hiveql-script-with-email-notifications-86bc0967a454&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F86bc0967a454&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fexecute-hiveql-script-with-email-notifications-86bc0967a454&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://www.jetmore.org/john/code/swaks/", "anchor_text": "waks"}, {"url": "https://stackoverflow.com/questions/7069682/how-to-get-arguments-with-flags-in-bash", "anchor_text": "options above accessible via flags"}, {"url": "https://cygwin.com/install.html", "anchor_text": "here"}, {"url": "https://medium.com/tag/technology?source=post_page-----86bc0967a454---------------technology-----------------", "anchor_text": "Technology"}, {"url": "https://medium.com/tag/data-science?source=post_page-----86bc0967a454---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/best-practices?source=post_page-----86bc0967a454---------------best_practices-----------------", "anchor_text": "Best Practices"}, {"url": "https://medium.com/tag/programming?source=post_page-----86bc0967a454---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/tag/automation?source=post_page-----86bc0967a454---------------automation-----------------", "anchor_text": "Automation"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F86bc0967a454&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fexecute-hiveql-script-with-email-notifications-86bc0967a454&user=Andrew+Young&userId=6a9f152f0cc3&source=-----86bc0967a454---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F86bc0967a454&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fexecute-hiveql-script-with-email-notifications-86bc0967a454&user=Andrew+Young&userId=6a9f152f0cc3&source=-----86bc0967a454---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F86bc0967a454&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fexecute-hiveql-script-with-email-notifications-86bc0967a454&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----86bc0967a454--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F86bc0967a454&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fexecute-hiveql-script-with-email-notifications-86bc0967a454&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----86bc0967a454---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----86bc0967a454--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----86bc0967a454--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----86bc0967a454--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----86bc0967a454--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----86bc0967a454--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----86bc0967a454--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----86bc0967a454--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----86bc0967a454--------------------------------", "anchor_text": ""}, {"url": "https://andrew-young.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://andrew-young.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Andrew Young"}, {"url": "https://andrew-young.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "159 Followers"}, {"url": "https://www.linkedin.com/in/andrewyoung16/", "anchor_text": "https://www.linkedin.com/in/andrewyoung16/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F6a9f152f0cc3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fexecute-hiveql-script-with-email-notifications-86bc0967a454&user=Andrew+Young&userId=6a9f152f0cc3&source=post_page-6a9f152f0cc3--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fa260025821b7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fexecute-hiveql-script-with-email-notifications-86bc0967a454&newsletterV3=6a9f152f0cc3&newsletterV3Id=a260025821b7&user=Andrew+Young&userId=6a9f152f0cc3&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}