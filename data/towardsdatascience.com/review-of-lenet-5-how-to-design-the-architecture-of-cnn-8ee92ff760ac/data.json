{"url": "https://towardsdatascience.com/review-of-lenet-5-how-to-design-the-architecture-of-cnn-8ee92ff760ac", "time": 1683006133.651669, "path": "towardsdatascience.com/review-of-lenet-5-how-to-design-the-architecture-of-cnn-8ee92ff760ac/", "webpage": {"metadata": {"title": "Review of LeNet-5: How to design the architecture of CNN | by Sheng Fang | Towards Data Science", "h1": "Review of LeNet-5: How to design the architecture of CNN", "description": "This post is a review of an old, difficult, and inspiring paper: Gradient-Based Learning Applied to Document Recognition\u201d[1] by Yann LeCun as the first author. You can find many reviews of this\u2026"}, "outgoing_paragraph_urls": [{"url": "https://sheng-fang.github.io/2020-04-19-review_lenet/#2", "anchor_text": "[2]", "paragraph_index": 5}, {"url": "https://cs231n.github.io/understanding-cnn/", "anchor_text": "Understanding and Visualizing Convolutional Neural Networks", "paragraph_index": 20}, {"url": "https://sheng-fang.github.io", "anchor_text": "https://sheng-fang.github.io", "paragraph_index": 23}], "all_paragraphs": ["This post is a review of an old, difficult, and inspiring paper: Gradient-Based Learning Applied to Document Recognition\u201d[1] by Yann LeCun as the first author. You can find many reviews of this paper. Most of them only focus on the architecture of the Convolution Neural Network (CNN) LeNet-5. However, I\u2019d like to talk about some other interesting points:", "In fact, there are 2 networks mentioned in this paper. The first one is CNN, named LeNet-5 and the second one is called Graph Transformer Network (GTN). I talk only about the LeNet-5 in this post.", "A system usually includes several modules. From the perspective of back-propagation, if all the modules are differentiable and the connections between the modules are also differential, in other words, the back propagation of gradients can go back from the loss function at the end to the input, it is a globally trainable system. Sometimes, we also name it as end-to-end solution for machine learning problem.", "Let me give an example: we want to mark the gender of all the faces in one image? First solution is to detect the positions of all the faces and then classify the gender with the sub-image with one face. Second solution is to create a model, which takes the image as input and outputs the localization of faces as well as the corresponding gender. In the first solution, the error from the localization influence the performance of the gender classification. But we can\u2019t use the loss function of gender classification to optimize the performance of localization if the 2 modules are separate. In the second end-to-end solution, the localization and gender detection are globally optimized.", "As partially mentioned before, we optimize all the modules together. If we have enough data, the system can achieve better performance relative to the non-globally-trainable-system.", "Another more important advantage is: let the machine learn from data. If you are familiar with CNN, you probably hear that the first several hidden layers of CNN can learn the strong local pattern of image. Here are some examples in Image 1 from paper[2].", "In the traditional solution, we often feed the machine learning model with the hand-design the features, as SIFT, HOG, etc. With globally trainable system, we can let the data tell us which are the most important features for a certain task.", "In order to get self-learned features from neural network, we have to design a good architecture for the neural network. Yann LuCun indicated in his paper that no learning technique can succeed without a minimal amount of prior knowledge about the task. \u2026. a good way to incorporate with knowledge is to tailor its architecture to the task. Now let\u2019s focus on how to incorporate with knowledge when designing an architecture of CNN.", "In 1962, Hubel and Wiesel[3] revealed that locally-sensitive, orientation-selective neuron in the cat\u2019s visual systems. With the constrains of local connections, the neuron can learn some basic visual features, which could be reused or grouped to form new features in the following neuron. A convolution kernel can perfectly realize this constrains of receptive field.", "Until here, we find a good tool, convolution kernel, to simulate the locally-sensitive, orientation-selective neuron. Then how can we overcome some common difficulties of image classification: shift, scale and distortion invariance.", "Let\u2019s first check how human being realize image classification. We maybe act like this:", "To realize the step 1, we can fix the weights of convolution kernel for the same feature map and generate several feature maps.", "To realize the step 2, we consider the exact position of the feature are less important than the relative position of the feature to other features. So we can progressively reduce the spatial resolution (Sub-sampling). However, we lose information when reducing the image resolution. That\u2019s why we need to increase the number of feature maps to keep the useful information as much as possible.", "With all these knowledge, we have the general principle to design a CNN.", "Image 2[1]shows the architecture of LeNet-5.", "LeNet-4 is a simplified LeNet-5. It contains 4 first-level feature maps, followed by 16 sub-sampling map. We consider LeNet-4 is a weaker classifier compared to LeNet-5. Yann LuCun applied the boosting technique to LeNet-4, marked boosted LeNet-4. The boosting method reaches better performance than LeNet-5 of accuracy.", "In the domain of research of machine learning, we always mention the three key aspects to develop new methods. Yann LuCun also mentioned these in his paper:", "We should also consider these factors in our own products.", "In this post, I shared my understanding of how to design a neural network. I believe it\u2019s helpful in the practice of implementing and modifying a CNN.", "[1] LeCun, Yann and Bottou, L\u00e9on and Bengio, Yoshua and Haffner, Patrick Gradient-Based Learning Applied to Document Recognition IEEE, 1998", "[2] Understanding and Visualizing Convolutional Neural Networks", "[3] D. H. Hubel, T. N. Wiesel Receptive fields, binocular interaction and functional architecture in the cat\u2019s visual cortex The Journal of Physiology, 1962", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Ph.D in robotics, computer vision and machine learning. More in my blog: https://sheng-fang.github.io"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F8ee92ff760ac&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Freview-of-lenet-5-how-to-design-the-architecture-of-cnn-8ee92ff760ac&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Freview-of-lenet-5-how-to-design-the-architecture-of-cnn-8ee92ff760ac&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Freview-of-lenet-5-how-to-design-the-architecture-of-cnn-8ee92ff760ac&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Freview-of-lenet-5-how-to-design-the-architecture-of-cnn-8ee92ff760ac&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----8ee92ff760ac--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----8ee92ff760ac--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@shengfang?source=post_page-----8ee92ff760ac--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@shengfang?source=post_page-----8ee92ff760ac--------------------------------", "anchor_text": "Sheng Fang"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fe19717fcc1a2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Freview-of-lenet-5-how-to-design-the-architecture-of-cnn-8ee92ff760ac&user=Sheng+Fang&userId=e19717fcc1a2&source=post_page-e19717fcc1a2----8ee92ff760ac---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F8ee92ff760ac&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Freview-of-lenet-5-how-to-design-the-architecture-of-cnn-8ee92ff760ac&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F8ee92ff760ac&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Freview-of-lenet-5-how-to-design-the-architecture-of-cnn-8ee92ff760ac&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://sheng-fang.github.io/2020-04-19-review_lenet/#2", "anchor_text": "[2]"}, {"url": "https://cs231n.github.io/understanding-cnn/", "anchor_text": "https://cs231n.github.io/understanding-cnn/"}, {"url": "http://vision.stanford.edu/cs598_spring07/papers/Lecun98.pdf", "anchor_text": "http://vision.stanford.edu/cs598_spring07/papers/Lecun98.pdf"}, {"url": "https://cs231n.github.io/understanding-cnn/", "anchor_text": "Understanding and Visualizing Convolutional Neural Networks"}, {"url": "https://medium.com/tag/convolutional-network?source=post_page-----8ee92ff760ac---------------convolutional_network-----------------", "anchor_text": "Convolutional Network"}, {"url": "https://medium.com/tag/computer-vision?source=post_page-----8ee92ff760ac---------------computer_vision-----------------", "anchor_text": "Computer Vision"}, {"url": "https://medium.com/tag/image-classification?source=post_page-----8ee92ff760ac---------------image_classification-----------------", "anchor_text": "Image Classification"}, {"url": "https://medium.com/tag/model-design?source=post_page-----8ee92ff760ac---------------model_design-----------------", "anchor_text": "Model Design"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F8ee92ff760ac&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Freview-of-lenet-5-how-to-design-the-architecture-of-cnn-8ee92ff760ac&user=Sheng+Fang&userId=e19717fcc1a2&source=-----8ee92ff760ac---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F8ee92ff760ac&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Freview-of-lenet-5-how-to-design-the-architecture-of-cnn-8ee92ff760ac&user=Sheng+Fang&userId=e19717fcc1a2&source=-----8ee92ff760ac---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F8ee92ff760ac&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Freview-of-lenet-5-how-to-design-the-architecture-of-cnn-8ee92ff760ac&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----8ee92ff760ac--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F8ee92ff760ac&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Freview-of-lenet-5-how-to-design-the-architecture-of-cnn-8ee92ff760ac&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----8ee92ff760ac---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----8ee92ff760ac--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----8ee92ff760ac--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----8ee92ff760ac--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----8ee92ff760ac--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----8ee92ff760ac--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----8ee92ff760ac--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----8ee92ff760ac--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----8ee92ff760ac--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@shengfang?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@shengfang?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Sheng Fang"}, {"url": "https://medium.com/@shengfang/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "20 Followers"}, {"url": "https://sheng-fang.github.io", "anchor_text": "https://sheng-fang.github.io"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fe19717fcc1a2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Freview-of-lenet-5-how-to-design-the-architecture-of-cnn-8ee92ff760ac&user=Sheng+Fang&userId=e19717fcc1a2&source=post_page-e19717fcc1a2--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fusers%2Fe19717fcc1a2%2Flazily-enable-writer-subscription&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Freview-of-lenet-5-how-to-design-the-architecture-of-cnn-8ee92ff760ac&user=Sheng+Fang&userId=e19717fcc1a2&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}