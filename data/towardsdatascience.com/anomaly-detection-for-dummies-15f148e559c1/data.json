{"url": "https://towardsdatascience.com/anomaly-detection-for-dummies-15f148e559c1", "time": 1682996933.485924, "path": "towardsdatascience.com/anomaly-detection-for-dummies-15f148e559c1/", "webpage": {"metadata": {"title": "Anomaly Detection for Dummies. Unsupervised Anomaly Detection for\u2026 | by Susan Li | Towards Data Science", "h1": "Anomaly Detection for Dummies", "description": "Anomaly detection is the process of identifying unexpected items or events in data sets, which differ from the norm. And anomaly detection is often applied on unlabeled data which is known as\u2026"}, "outgoing_paragraph_urls": [{"url": "https://en.wikipedia.org/wiki/Anomaly_detection", "anchor_text": "Anomaly detection", "paragraph_index": 0}, {"url": "https://community.tableau.com/docs/DOC-1236", "anchor_text": "Super Store Sales data set", "paragraph_index": 2}, {"url": "https://community.tableau.com/docs/DOC-1236", "anchor_text": "here", "paragraph_index": 2}, {"url": "https://dzone.com/articles/spotting-outliers-with-isolation-forest-using-skle", "anchor_text": "tutorial", "paragraph_index": 8}, {"url": "https://pyod.readthedocs.io/en/latest/", "anchor_text": "PyOD", "paragraph_index": 18}, {"url": "https://www.yuezhao.me/", "anchor_text": "Yue Zhao", "paragraph_index": 18}, {"url": "https://pyod.readthedocs.io/en/latest/index.html", "anchor_text": "PyOD library", "paragraph_index": 21}, {"url": "https://pyod.readthedocs.io/en/latest/pyod.models.html#module-pyod.models.cblof", "anchor_text": "the CBLOF implementation", "paragraph_index": 21}, {"url": "https://github.com/yzhao062/pyod/blob/master/notebooks/Compare%20All%20Models.ipynb", "anchor_text": "PyOD tutorial", "paragraph_index": 22}, {"url": "https://www.analyticsvidhya.com/blog/2019/02/outlier-detection-python-pyod/", "anchor_text": "this article", "paragraph_index": 22}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.ensemble.IsolationForest.html", "anchor_text": "Scikit-learn Isolation Forest", "paragraph_index": 25}, {"url": "https://github.com/susanli2016/Machine-Learning-with-Python/blob/master/Anomaly_Detection_for_Dummies.ipynb", "anchor_text": "Jupyter notebook", "paragraph_index": 32}, {"url": "https://github.com/susanli2016/Machine-Learning-with-Python/blob/master/Anomaly_Detection_for_Dummies.ipynb", "anchor_text": "Github", "paragraph_index": 32}, {"url": "https://www.linkedin.com/in/susanli/", "anchor_text": "https://www.linkedin.com/in/susanli/", "paragraph_index": 34}], "all_paragraphs": ["Anomaly detection is the process of identifying unexpected items or events in data sets, which differ from the norm. And anomaly detection is often applied on unlabeled data which is known as unsupervised anomaly detection. Anomaly detection has two basic assumptions:", "Before we get to Multivariate anomaly detection, I think its necessary to work through a simple example of Univariate anomaly detection method in which we detect outliers from a distribution of values in a single feature space.", "We are using the Super Store Sales data set that can be downloaded from here, and we are going to find patterns in Sales and Profit separately that do not conform to expected behavior. That is, spotting outliers for one variable at a time.", "The Superstore\u2019s sales distribution is far from a normal distribution, and it has a positive long thin tail, the mass of the distribution is concentrated on the left of the figure. And the tail sales distribution far exceeds the tails of the normal distribution.", "There are one region where the data has low probability to appear which is on the right side of the distribution.", "The Superstore\u2019s Profit distribution has both a positive tail and negative tail. However, the positive tail is longer than the negative tail. So the distribution is positive skewed, and the data are heavy-tailed or profusion of outliers.", "There are two regions where the data has low probability to appear: one on the right side of the distribution, another one on the left.", "Isolation Forest is an algorithm to detect outliers that returns the anomaly score of each sample using the IsolationForest algorithm which is based on the fact that anomalies are data points that are few and different. Isolation Forest is a tree-based model. In these trees, partitions are created by first randomly selecting a feature and then selecting a random split value between the minimum and maximum value of the selected feature.", "The following process shows how IsolationForest behaves in the case of the Susperstore\u2019s sales, and the algorithm was implemented in Sklearn and the code was largely borrowed from this tutorial", "According to the above results and visualization, It seems that Sales that exceeds 1000 would be definitely considered as an outlier.", "This purchase seems normal to me expect it was a larger amount of sales compared with the other orders in the data.", "According to the above results and visualization, It seems that Profit that below -100 or exceeds 100 would be considered as an outlier, let\u2019s visually examine one example each that determined by our model and to see whether they make sense.", "Any negative profit would be an anomaly and should be further investigate, this goes without saying", "Our model determined that this order with a large profit is an anomaly. However, when we investigate this order, it could be just a product that has a relatively high margin.", "The above two visualizations show the anomaly scores and highlighted the regions where the outliers are. As expected, the anomaly score reflects the shape of the underlying distribution and the outlier regions correspond to low probability areas.", "However, Univariate analysis can only get us thus far. We may realize that some of these anomalies that determined by our models are not the anomalies we expected. When our data is multidimensional as opposed to univariate, the approaches to anomaly detection become more computationally intensive and more mathematically complex.", "Most of the analysis that we end up doing are multivariate due to complexity of the world we are living in. In multivariate anomaly detection, outlier is a combined unusual score on at least two variables.", "So, using the Sales and Profit variables, we are going to build an unsupervised multivariate anomaly detection method based on several models.", "We are using PyOD which is a Python library for detecting anomalies in multivariate data. The library was developed by Yue Zhao.", "When we are in business, we expect that Sales & Profit are positive correlated. If some of the Sales data points and Profit data points are not positive correlated, they would be considered as outliers and need to be further investigated.", "From the above correlation chart, we can see that some of the data points are obvious outliers such as extreme low and extreme high values.", "The CBLOF calculates the outlier score based on cluster-based local outlier factor. An anomaly score is computed by the distance of each instance to its cluster center multiplied by the instances belonging to its cluster. PyOD library includes the CBLOF implementation.", "The following code are borrowed from PyOD tutorial combined with this article.", "HBOS assumes the feature independence and calculates the degree of anomalies by building histograms. In multivariate anomaly detection, a histogram for each single feature can be computed, scored individually and combined at the end. When using PyOD library, the code are very similar with the CBLOF.", "Isolation Forest is similar in principle to Random Forest and is built on the basis of decision trees. Isolation Forest isolates observations by randomly selecting a feature and then randomly selecting a split value between the maximum and minimum values of that selected feature.", "The PyOD Isolation Forest module is a wrapper of Scikit-learn Isolation Forest with more functionalities.", "KNN is one of the simplest methods in anomaly detection. For a data point, its distance to its kth nearest neighbor could be viewed as the outlier score.", "The anomalies predicted by the above four algorithms were not very different.", "We may want to investigate each of the outliers that determined by our model, for example, let\u2019s look in details for a couple of outliers that determined by KNN, and try to understand what make them anomalies.", "For this particular order, a customer purchased 5 products with total price at 294.62 and profit at lower than -766, with 80% discount. It seems like a clearance. We should be aware of the loss for each product we sell.", "For this purchase, it seems to me that the profit at around 4.7% is too small and the model determined that this order is an anomaly.", "For the above order, a customer purchased 6 product at 4305 in total price, after 20% discount, we still get over 33% of the profit. We would love to have more of these kind of anomalies.", "Jupyter notebook for the above analysis can be found on Github. Enjoy the rest of the week.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Changing the world, one post at a time. Sr Data Scientist, Toronto Canada. https://www.linkedin.com/in/susanli/"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F15f148e559c1&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fanomaly-detection-for-dummies-15f148e559c1&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fanomaly-detection-for-dummies-15f148e559c1&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fanomaly-detection-for-dummies-15f148e559c1&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fanomaly-detection-for-dummies-15f148e559c1&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----15f148e559c1--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----15f148e559c1--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://actsusanli.medium.com/?source=post_page-----15f148e559c1--------------------------------", "anchor_text": ""}, {"url": "https://actsusanli.medium.com/?source=post_page-----15f148e559c1--------------------------------", "anchor_text": "Susan Li"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F731d8566944a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fanomaly-detection-for-dummies-15f148e559c1&user=Susan+Li&userId=731d8566944a&source=post_page-731d8566944a----15f148e559c1---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F15f148e559c1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fanomaly-detection-for-dummies-15f148e559c1&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F15f148e559c1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fanomaly-detection-for-dummies-15f148e559c1&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://en.wikipedia.org/wiki/Anomaly_detection", "anchor_text": "Anomaly detection"}, {"url": "https://community.tableau.com/docs/DOC-1236", "anchor_text": "Super Store Sales data set"}, {"url": "https://community.tableau.com/docs/DOC-1236", "anchor_text": "here"}, {"url": "https://dzone.com/articles/spotting-outliers-with-isolation-forest-using-skle", "anchor_text": "tutorial"}, {"url": "https://pyod.readthedocs.io/en/latest/", "anchor_text": "PyOD"}, {"url": "https://www.yuezhao.me/", "anchor_text": "Yue Zhao"}, {"url": "https://pyod.readthedocs.io/en/latest/index.html", "anchor_text": "PyOD library"}, {"url": "https://pyod.readthedocs.io/en/latest/pyod.models.html#module-pyod.models.cblof", "anchor_text": "the CBLOF implementation"}, {"url": "https://github.com/yzhao062/pyod/blob/master/notebooks/Compare%20All%20Models.ipynb", "anchor_text": "PyOD tutorial"}, {"url": "https://www.analyticsvidhya.com/blog/2019/02/outlier-detection-python-pyod/", "anchor_text": "this article"}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.ensemble.IsolationForest.html", "anchor_text": "Scikit-learn Isolation Forest"}, {"url": "https://github.com/susanli2016/Machine-Learning-with-Python/blob/master/Anomaly_Detection_for_Dummies.ipynb", "anchor_text": "Jupyter notebook"}, {"url": "https://github.com/susanli2016/Machine-Learning-with-Python/blob/master/Anomaly_Detection_for_Dummies.ipynb", "anchor_text": "Github"}, {"url": "https://medium.com/tag/data-science?source=post_page-----15f148e559c1---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----15f148e559c1---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/anomaly-detection?source=post_page-----15f148e559c1---------------anomaly_detection-----------------", "anchor_text": "Anomaly Detection"}, {"url": "https://medium.com/tag/machine-learning-tutorial?source=post_page-----15f148e559c1---------------machine_learning_tutorial-----------------", "anchor_text": "Machine Learning Tutorial"}, {"url": "https://medium.com/tag/unsupervised-learning?source=post_page-----15f148e559c1---------------unsupervised_learning-----------------", "anchor_text": "Unsupervised Learning"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F15f148e559c1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fanomaly-detection-for-dummies-15f148e559c1&user=Susan+Li&userId=731d8566944a&source=-----15f148e559c1---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F15f148e559c1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fanomaly-detection-for-dummies-15f148e559c1&user=Susan+Li&userId=731d8566944a&source=-----15f148e559c1---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F15f148e559c1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fanomaly-detection-for-dummies-15f148e559c1&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----15f148e559c1--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F15f148e559c1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fanomaly-detection-for-dummies-15f148e559c1&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----15f148e559c1---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----15f148e559c1--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----15f148e559c1--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----15f148e559c1--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----15f148e559c1--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----15f148e559c1--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----15f148e559c1--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----15f148e559c1--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----15f148e559c1--------------------------------", "anchor_text": ""}, {"url": "https://actsusanli.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://actsusanli.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Susan Li"}, {"url": "https://actsusanli.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "27K Followers"}, {"url": "https://www.linkedin.com/in/susanli/", "anchor_text": "https://www.linkedin.com/in/susanli/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F731d8566944a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fanomaly-detection-for-dummies-15f148e559c1&user=Susan+Li&userId=731d8566944a&source=post_page-731d8566944a--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F1f2b19329694&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fanomaly-detection-for-dummies-15f148e559c1&newsletterV3=731d8566944a&newsletterV3Id=1f2b19329694&user=Susan+Li&userId=731d8566944a&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}