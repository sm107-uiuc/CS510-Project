{"url": "https://towardsdatascience.com/simplify-machine-learning-workflows-e9d4f404aaeb", "time": 1683010227.384833, "path": "towardsdatascience.com/simplify-machine-learning-workflows-e9d4f404aaeb/", "webpage": {"metadata": {"title": "Pipelines and Custom Transformers | Towards Data Science", "h1": "Simplify Machine Learning Workflows", "description": "How to use Pipelines and custom transformers to standardize data preprocessing, data transformation, and modeling steps of a machine learning workflow."}, "outgoing_paragraph_urls": [{"url": "https://github.com/david-hurley/kaggle-comps", "anchor_text": "GitHub", "paragraph_index": 0}, {"url": "https://www.kaggle.com/c/house-prices-advanced-regression-techniques/data", "anchor_text": "Kaggle competition page", "paragraph_index": 7}, {"url": "http://zacstewart.com/2014/08/05/pipelines-of-featureunions-of-pipelines.html", "anchor_text": "is a great source", "paragraph_index": 9}, {"url": "https://machinelearningmastery.com/stacking-ensemble-machine-learning-with-python/", "anchor_text": "is a great resource", "paragraph_index": 15}, {"url": "https://www.linkedin.com/in/hurleydavid/", "anchor_text": "https://www.linkedin.com/in/hurleydavid/", "paragraph_index": 19}], "all_paragraphs": ["This article provides an overview of how to using custom transformers and Scikit-Learn Pipelines to bundle data preprocessing, data transformation, and modeling steps of a machine learning workflow. A detailed Notebook which includes exploratory data analysis (EDA) can be found on my GitHub.", "The results of the tutorial is an example using Pipelines on the Kaggle Ames Housing dataset in which we get scores in the top 20% of the leaderboard!", "Though there are many ways to structure a machine learning (ML) workflow, a basic structure can be thought of as the following steps:", "Even a simple ML workflow can become complicated. For example, imagine you have 10 preprocessing/transformation steps applied to both train and test data. Additionally, you want to test multiple models and perform Cross-Validation and hyperparameter tuning. Some data scientists may piece together messy blocks of code and attempt to manually keep track of each step. However, there are several reasons why this quickly becomes impractical and even detrimental to your modeling effort.", "Challenges when performing ML workflows outside of a Pipeline:", "Pipelines are an easy way to bundle data preprocessing, transformation, and modeling code allowing you to apply the \u201cbundle\u201d as if it were a single step. This means no more Train-Test contamination or forgotten preprocessing/transformation steps. As long as you split the data prior to applying the Pipeline each dataset will receive identical and independent preprocessing/transformation. It also makes Cross-Validation, model tuning, and model deployment simpler and cleaner.", "This section presents an example of using a Scikit-Learn Pipeline with custom transformers to Cross-Validate and compare several models.", "I will be using the Ames housing dataset from the Kaggle competition House Prices: Advanced Regression Techniques. The dataset has 79 features, a mixture of numerical and categorical, and includes variables such as square footage of various sections of a house, neighborhood, and year built and sold. The data can be accessed through the Kaggle competition page.", "First things first, we need to define the Pipeline steps. I am going to perform very basic data preprocessing/transformation and feature engineering. Basically it\u2019s just enough plus a little extra to wrangle our data into something a Scikit-Learn model can accept.", "First, the numerical and categorical data columns need to be defined (preprocessing and transforming for these involve different steps). Then we want to define a Pipeline class and include applicable data transformation classes (i.e. data preprocessing/transformation steps) in nested Pipelines. We can concatenate the results from multiple transformation classes and nested Pipelines by including them in a FeatureUnion class. Here is a great source for further info on constructing Pipelines and FeatureUnions. The feature dataset is passed into a Pipeline that does the following:", "Numeric Columns: Extracts numeric columns, imputes missing values, generates a new feature Total Square Footage, and log transforms the data.", "Categorical Columns: Extracts the categorical columns, imputes missing values, encodes categorical data", "Standardize: A FeatureUnion combines the processed/transformed numerical and categorical data and that data is standardized.", "Sometimes we need a transformer that doesn\u2019t come with Scikit-Learn. For example, we may want to create a new feature or want an existing Scikit-Learn transformer to return a Pandas DataFrame. Luckily Scikit-Learn and Python make this easy with the TransformerMixin and class inheritance.", "Here is a brief summary of each custom transformer:", "Now that we have defined the Pipeline we can put it all together. First, we define a helper function that takes a Pipeline and performs an X folds Cross-Validation for a particular model and return the Root Mean Square Error (RMSE) on the Log of the house Sale Price. Next, we define the models we want to train and create a for loop where each loop defines the \u201cFull-Pipeline\u201d which is a combination of the preprocessing/transformation steps (i.e. last section) and a select model. The results of the for loop is Cross-Validation RMSE scores for each model and a boxplot comparison of model scores and standard deviations. Here is a great resource for making boxplots with Cross-Validation.", "In this tutorial, we defined and created a Pipeline to preprocesses/transform the Kaggle Ames Housing dataset and evaluated the models with an X folds Cross-Validation RMSE score. The results are an easy to follow and debug Pipeline that returns RMSE scores in the top 20% of the Kaggle leaderboard.", "Add Pipelines to your data science arsenal and stay organized and efficient!", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Scientist in the energy industry | https://www.linkedin.com/in/hurleydavid/"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fe9d4f404aaeb&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsimplify-machine-learning-workflows-e9d4f404aaeb&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsimplify-machine-learning-workflows-e9d4f404aaeb&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsimplify-machine-learning-workflows-e9d4f404aaeb&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsimplify-machine-learning-workflows-e9d4f404aaeb&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----e9d4f404aaeb--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----e9d4f404aaeb--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@davidhurley_48402?source=post_page-----e9d4f404aaeb--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@davidhurley_48402?source=post_page-----e9d4f404aaeb--------------------------------", "anchor_text": "David Hurley"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F995c0a4ee38f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsimplify-machine-learning-workflows-e9d4f404aaeb&user=David+Hurley&userId=995c0a4ee38f&source=post_page-995c0a4ee38f----e9d4f404aaeb---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe9d4f404aaeb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsimplify-machine-learning-workflows-e9d4f404aaeb&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe9d4f404aaeb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsimplify-machine-learning-workflows-e9d4f404aaeb&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@jeremybishop?utm_source=medium&utm_medium=referral", "anchor_text": "Jeremy Bishop"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://github.com/david-hurley/kaggle-comps", "anchor_text": "GitHub"}, {"url": "https://www.kaggle.com/c/house-prices-advanced-regression-techniques/data", "anchor_text": "Kaggle competition page"}, {"url": "http://zacstewart.com/2014/08/05/pipelines-of-featureunions-of-pipelines.html", "anchor_text": "is a great source"}, {"url": "https://machinelearningmastery.com/stacking-ensemble-machine-learning-with-python/", "anchor_text": "is a great resource"}, {"url": "https://medium.com/tag/data-science?source=post_page-----e9d4f404aaeb---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----e9d4f404aaeb---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/pipeline?source=post_page-----e9d4f404aaeb---------------pipeline-----------------", "anchor_text": "Pipeline"}, {"url": "https://medium.com/tag/python?source=post_page-----e9d4f404aaeb---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/towards-data-science?source=post_page-----e9d4f404aaeb---------------towards_data_science-----------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fe9d4f404aaeb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsimplify-machine-learning-workflows-e9d4f404aaeb&user=David+Hurley&userId=995c0a4ee38f&source=-----e9d4f404aaeb---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fe9d4f404aaeb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsimplify-machine-learning-workflows-e9d4f404aaeb&user=David+Hurley&userId=995c0a4ee38f&source=-----e9d4f404aaeb---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe9d4f404aaeb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsimplify-machine-learning-workflows-e9d4f404aaeb&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----e9d4f404aaeb--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fe9d4f404aaeb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsimplify-machine-learning-workflows-e9d4f404aaeb&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----e9d4f404aaeb---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----e9d4f404aaeb--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----e9d4f404aaeb--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----e9d4f404aaeb--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----e9d4f404aaeb--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----e9d4f404aaeb--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----e9d4f404aaeb--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----e9d4f404aaeb--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----e9d4f404aaeb--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@davidhurley_48402?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@davidhurley_48402?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "David Hurley"}, {"url": "https://medium.com/@davidhurley_48402/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "76 Followers"}, {"url": "https://www.linkedin.com/in/hurleydavid/", "anchor_text": "https://www.linkedin.com/in/hurleydavid/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F995c0a4ee38f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsimplify-machine-learning-workflows-e9d4f404aaeb&user=David+Hurley&userId=995c0a4ee38f&source=post_page-995c0a4ee38f--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fusers%2F995c0a4ee38f%2Flazily-enable-writer-subscription&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsimplify-machine-learning-workflows-e9d4f404aaeb&user=David+Hurley&userId=995c0a4ee38f&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}