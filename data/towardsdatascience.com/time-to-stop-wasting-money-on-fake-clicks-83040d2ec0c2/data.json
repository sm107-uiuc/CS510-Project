{"url": "https://towardsdatascience.com/time-to-stop-wasting-money-on-fake-clicks-83040d2ec0c2", "time": 1682999794.7955651, "path": "towardsdatascience.com/time-to-stop-wasting-money-on-fake-clicks-83040d2ec0c2/", "webpage": {"metadata": {"title": "Time to stop wasting money on fake clicks! | by Jinyi Zhu | Towards Data Science", "h1": "Time to stop wasting money on fake clicks!", "description": "Hidden behind a 300\u00d7250px banner is a complex digital advertising ecosystem. Compared to traditional ad industry, the new business model in the Internet era involves the advertising commissioner\u2026"}, "outgoing_paragraph_urls": [{"url": "https://github.com/jystacy/Click_Fraud", "anchor_text": "https://github.com/jystacy/Click_Fraud", "paragraph_index": 2}, {"url": "https://www.kaggle.com/c/talkingdata-adtracking-fraud-detection/overview", "anchor_text": "TalkingData AdTracking Fraud Detection Challenge", "paragraph_index": 2}, {"url": "http://jmlr.org/papers/volume9/vandermaaten08a/vandermaaten08a.pdf", "anchor_text": "t-Distributed Stochastic Neighbor Embedding", "paragraph_index": 14}, {"url": "http://jmlr.org/papers/volume9/vandermaaten08a/vandermaaten08a.pdf", "anchor_text": "minimize the divergence between two distributions: a distribution that measures pairwise similarities of the input objects and a distribution that measures pairwise similarities of the corresponding low-dimensional points in the embedding", "paragraph_index": 14}, {"url": "https://github.com/jystacy/Click_Fraud", "anchor_text": "https://github.com/jystacy/Click_Fraud", "paragraph_index": 25}], "all_paragraphs": ["Hidden behind a 300\u00d7250px banner is a complex digital advertising ecosystem. Compared to traditional ad industry, the new business model in the Internet era involves the advertising commissioner (also known as ad network), acting as a broker between advertisers and content publishers.", "An advertiser plans a budget, provides the commissioner with advertisements, and agrees on a commission for every customer action (e.g., clicking an ad, filling a form, bidding in an auction, etc). A content publisher contracts with the commissioner to display advertisements on their websites, and gets commissions based on the traffic it drives to the advertisers. This model, however, may incentivize dishonest publishers to generate illegitimate clicks on their sites \u2014 a major issue known as click fraud.", "This article describes my personal machine learning project on click fraud prediction for a mobile app ad. All the source code can be found on my Github: https://github.com/jystacy/Click_Fraud. This project is derived from Kaggle\u2019s TalkingData AdTracking Fraud Detection Challenge, aiming to predict whether a user will download an app after clicking a mobile app ad. The entire time frame of this artificial dataset encompasses a range of 27 minutes.", "Each row of the dataset contains a click record, with the following features:", "It is always critical to check the distribution of the labelled feature. This is an extremely imbalanced dataset whose 99.65% of clicks failed to lead to an app download. To avoid the situation where even random guessing can reach a more than 99% accuracy, I\u2019ll deal with the challenge of imbalance after the data split.", "The data was clean and no techniques were applied as all data records with seven features were complete. However, it\u2019s worth noting that the categorical features (app, device, os, and channel) with more than 100 distinct values could be very predictive while pose an issue for inclusion in predictive models.", "An elegant and simple way to include such high cardinality attributes is by transforming the nominal variable to a single continuous one, whose values are correlated with the target label. I chose supervised ratio to transform these categorical features: substituting the nominal denoted values with the percentage of positive instances (is_attributed = 1) in a category .", "Given the limit information original variables can provide, feature generation would have a strong impact on the model performance. The click-count-oriented revenue-sharing system provides fertile ground for the fake clicks, so I tried to create a series of features to catch the abnormal behavior patterns of click actions. Click counts from an ip, a device, an os, on an app, or through a channel within a certain period of time all could be good predictors. I utilized (and removed afterwards) the click records within first 60 seconds to generate additional predictors for all the samples.", "I created 25 (=5*5) features by calculating the click count within 1, 3, 10, 30, and 60 seconds ahead of the click record made by a specified ip, os, or device, or through a specific app or channel. For each combination of these five original categorical features (ip, os, app, channel, and device), 40 (=5*(5\u20131)*2) more created interactive time window count features focus on time interval of 10 and 3 seconds ahead of each click record. For example, ip_channel_10s represents the count of unique ip\u2019s contributing the click on a specific channel in the past 10 seconds, while channel_ip_10s the count of channels a specific ip has clicked on in the past 10 seconds.", "The implementation process of feature engineer for more than 100 million values has been optimized by over 10,000% through parallel computing using multiprocessing library in python. The code is also available on my Github.", "I performed an 80/20 train-test split, using the first 80% of click for training and the last 20% as test data, as there\u2019s no time-series patterns of click and fraud (shown in the first two graphs of EDA part). Then, I randomly downsampled the majority to make up a balanced training dataset. After balancing the data, I output the class distributions once more to visualize the difference.", "The range of numeric features highly varies in this project. If a feature in the dataset is big in scale compared to others, this big scaled feature will become dominating and needs to be normalized for the algorithms where Euclidean distance is measured, such as KNN and SVC. I used StandardScaler from scikit-learn library to conduct data scaling.", "I started EDA from the time series distribution of click record and fraud click. However, the duration of data collection is too short to indicate time-series patterns in this case. Thus, I didn\u2019t extract hour or minute attribute from the click time feature. Instead, I split the dataset according to the time series without the concern of bias.", "After the generation of millions of click count-based numerical variables, it is necessary to check the correlation between attributes. From the correlation heat map, there are highly positive correlations between these accumulative count attributes, such as the click count an app or a channel got in the past 1 second and 3 seconds. In the period of model training of linear models, therefore, Principal Components Analysis (PCA) would be helpful for a better model performance.", "As the last step of visual exploration, let\u2019s check the separability of data. In order to visualize the high dimensional dataset, I chose t-Distributed Stochastic Neighbor Embedding (t-SNE), another technique for dimensionality reduction more suitable for visualization than PCA, seeking to \u201cminimize the divergence between two distributions: a distribution that measures pairwise similarities of the input objects and a distribution that measures pairwise similarities of the corresponding low-dimensional points in the embedding\u201d.", "The scatter plot of the balanced training data with two resulting dimensions can provide hints in terms of model selection. For example, the graph indicates the highly likely bad performance of SVM in this case.", "How to evaluate the performance of models should match the goal of the project. The aim in this case is to detect fake clicks from an imbalanced dataset as well as predict whether a user will download an app after clicking a mobile app ad. Thus, I made use of the ROC-AUC (Receiver Operating Characteristics-Area Under the Curve) performance measure. ROC is a probability curve and AUC (a value between zero and one) represents degree or measure of separability. It tells how much model is capable of distinguishing between classes. If an algorithm has a ROC-AUC score of above 0.5, it is achieving a higher performance than random guessing.", "The models taken into consideration in this project include the most popular classification algorithms:", "The input data for model selection is all the numerical count features. I used 10-fold cross validation to evaluate model performance on training dataset. I customized the input data for different types of classification models. I fed 13 features generated by PCA, retaining 95% of the variance, to linear models \u2014 logistic regression and LDA. For distance-based algorithm (KNN and SVC), all the input data was standardized.", "Since it is the ability to predict fraud click rather than the interpretability that is emphasized in the case of click fraud, XGBoost unquestionably outperforms other models in terms of its ROC-AUC score. In addition, the ROC-AUC score of SVM verified the guess generated from the t-SNE visualization.", "XGBoost is by nature immune to feature magnitude and multicollinearity. My strategy of performance improvement of XGBoost includes adding transformed high-cardinality categorical variables to the model to increase the amount of information categorical features provide, tuning hyper-parameters carefully with validation dataset to make a trade off between over- and under-fitting, and optimizing the number of input features according to feature importance analysis.", "I finally chose the well tuned XGBoost model with 20 most important attributes including numerical click count variables and transformed high-cardinality categorical features. The ROC-AUC score on test dataset reached 0.969132, while the overfitting was avoided.", "The finding that features in terms of channel where a click is recorded rank highest in feature importance indicates that dishonest mobile ad publishers tend to centralize rather than decentralize fraud clicks on certain channels in order to demand higher premiums for high click count.", "When speaking of categorical features, there are several techniques dealing with feature inclusion. Due to the computational inefficiency and potential sparsity issue of one-hot coding for high-cardinality features, more and more attention has been paid on a new technique derived from neural network \u2014 entity embedding.", "Entity embedding shares the similar principle with the transformation method (supervised ratio) I used in the project that the resulting embedded vectors are representations of categories where similar categories \u2014 relative to the task \u2014 are closer to one another, while entity embedding is more flexible in the dimension of the embedded vectors. The latter characteristic improves the ability to reveal the intrinsic continuity of categorical variables, and meanwhile can retain more difference among different cardinalities. So I plan to apply entity embedding to the transformation of categorical features as the next step of improvement.", "Please feel free to check all the codes on my Github for reference: https://github.com/jystacy/Click_Fraud.", "All the feedback and discussions are warmly welcomed. \ud83d\ude0a", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F83040d2ec0c2&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftime-to-stop-wasting-money-on-fake-clicks-83040d2ec0c2&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftime-to-stop-wasting-money-on-fake-clicks-83040d2ec0c2&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftime-to-stop-wasting-money-on-fake-clicks-83040d2ec0c2&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftime-to-stop-wasting-money-on-fake-clicks-83040d2ec0c2&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----83040d2ec0c2--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----83040d2ec0c2--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@jinyizhu?source=post_page-----83040d2ec0c2--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@jinyizhu?source=post_page-----83040d2ec0c2--------------------------------", "anchor_text": "Jinyi Zhu"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F850b0a0d1b2d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftime-to-stop-wasting-money-on-fake-clicks-83040d2ec0c2&user=Jinyi+Zhu&userId=850b0a0d1b2d&source=post_page-850b0a0d1b2d----83040d2ec0c2---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F83040d2ec0c2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftime-to-stop-wasting-money-on-fake-clicks-83040d2ec0c2&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F83040d2ec0c2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftime-to-stop-wasting-money-on-fake-clicks-83040d2ec0c2&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://www.bankinfosecurity.com/click-fraud-kingpin-receives-7-year-sentence-a-9072", "anchor_text": "https://www.bankinfosecurity.com/click-fraud-kingpin-receives-7-year-sentence-a-9072"}, {"url": "https://github.com/jystacy/Click_Fraud", "anchor_text": "https://github.com/jystacy/Click_Fraud"}, {"url": "https://www.kaggle.com/c/talkingdata-adtracking-fraud-detection/overview", "anchor_text": "TalkingData AdTracking Fraud Detection Challenge"}, {"url": "http://jmlr.org/papers/volume9/vandermaaten08a/vandermaaten08a.pdf", "anchor_text": "t-Distributed Stochastic Neighbor Embedding"}, {"url": "http://jmlr.org/papers/volume9/vandermaaten08a/vandermaaten08a.pdf", "anchor_text": "minimize the divergence between two distributions: a distribution that measures pairwise similarities of the input objects and a distribution that measures pairwise similarities of the corresponding low-dimensional points in the embedding"}, {"url": "https://github.com/jystacy/Click_Fraud", "anchor_text": "https://github.com/jystacy/Click_Fraud"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----83040d2ec0c2---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/classification?source=post_page-----83040d2ec0c2---------------classification-----------------", "anchor_text": "Classification"}, {"url": "https://medium.com/tag/data-mining?source=post_page-----83040d2ec0c2---------------data_mining-----------------", "anchor_text": "Data Mining"}, {"url": "https://medium.com/tag/fraud?source=post_page-----83040d2ec0c2---------------fraud-----------------", "anchor_text": "Fraud"}, {"url": "https://medium.com/tag/towards-data-science?source=post_page-----83040d2ec0c2---------------towards_data_science-----------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F83040d2ec0c2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftime-to-stop-wasting-money-on-fake-clicks-83040d2ec0c2&user=Jinyi+Zhu&userId=850b0a0d1b2d&source=-----83040d2ec0c2---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F83040d2ec0c2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftime-to-stop-wasting-money-on-fake-clicks-83040d2ec0c2&user=Jinyi+Zhu&userId=850b0a0d1b2d&source=-----83040d2ec0c2---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F83040d2ec0c2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftime-to-stop-wasting-money-on-fake-clicks-83040d2ec0c2&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----83040d2ec0c2--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F83040d2ec0c2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftime-to-stop-wasting-money-on-fake-clicks-83040d2ec0c2&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----83040d2ec0c2---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----83040d2ec0c2--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----83040d2ec0c2--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----83040d2ec0c2--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----83040d2ec0c2--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----83040d2ec0c2--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----83040d2ec0c2--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----83040d2ec0c2--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----83040d2ec0c2--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@jinyizhu?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@jinyizhu?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Jinyi Zhu"}, {"url": "https://medium.com/@jinyizhu/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "21 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F850b0a0d1b2d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftime-to-stop-wasting-money-on-fake-clicks-83040d2ec0c2&user=Jinyi+Zhu&userId=850b0a0d1b2d&source=post_page-850b0a0d1b2d--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fusers%2F850b0a0d1b2d%2Flazily-enable-writer-subscription&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftime-to-stop-wasting-money-on-fake-clicks-83040d2ec0c2&user=Jinyi+Zhu&userId=850b0a0d1b2d&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}