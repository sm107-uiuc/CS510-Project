{"url": "https://towardsdatascience.com/image-classification-pipeline-with-intel-neural-compute-stick-2-ncs2-2a69aab8b570", "time": 1683013642.801718, "path": "towardsdatascience.com/image-classification-pipeline-with-intel-neural-compute-stick-2-ncs2-2a69aab8b570/", "webpage": {"metadata": {"title": "Image Classification Pipeline with Intel Neural Compute Stick 2 (NCS2) | by Oleksii Sheremet | Towards Data Science", "h1": "Image Classification Pipeline with Intel Neural Compute Stick 2 (NCS2)", "description": "In the past few years, there has been an active introduction of machine learning for industrial tasks solvings. Machine learning allows you to solve problems that humans cannot cope with. This can be\u2026"}, "outgoing_paragraph_urls": [{"url": "https://ark.intel.com/content/www/us/en/ark/products/140109/intel-neural-compute-stick-2.html", "anchor_text": "NCS2", "paragraph_index": 2}, {"url": "http://ai-labs.org/", "anchor_text": "AI Labs", "paragraph_index": 3}, {"url": "https://docs.openvinotoolkit.org/", "anchor_text": "OpenVINO", "paragraph_index": 4}, {"url": "https://software.intel.com/content/www/us/en/develop/tools/openvino-toolkit/choose-download/linux.html", "anchor_text": "here", "paragraph_index": 4}, {"url": "https://docs.openvinotoolkit.org/latest/openvino_docs_install_guides_installing_openvino_linux.html", "anchor_text": "here", "paragraph_index": 4}, {"url": "https://www.kaggle.com/alessiocorrado99/animals10", "anchor_text": "Animals-10", "paragraph_index": 12}, {"url": "https://www.tensorflow.org/api_docs/python/tf/keras/preprocessing/image/ImageDataGenerator", "anchor_text": "ImageDataGenerator", "paragraph_index": 18}, {"url": "https://docs.openvinotoolkit.org/latest/openvino_docs_MO_DG_prepare_model_convert_model_Convert_Model_From_TensorFlow.html", "anchor_text": "tutorial", "paragraph_index": 23}, {"url": "https://arxiv.org/pdf/1704.04861.pdf", "anchor_text": "MobileNets: Efficient Convolutional Neural Networks for Mobile Vision Applications", "paragraph_index": 34}, {"url": "https://www.researchgate.net/profile/Oleksii_Sheremet", "anchor_text": "https://www.researchgate.net/profile/Oleksii_Sheremet", "paragraph_index": 36}], "all_paragraphs": ["What we\u2019ll cover in this story:", "In the past few years, there has been an active introduction of machine learning for industrial tasks solvings. Machine learning allows you to solve problems that humans cannot cope with. This can be work in hard-to-reach places, in hazardous chemical production, in conditions of increased radiation, etc. Machine learning is applicable in areas where human intelligence can also be applied, but is ineffective: predicting critical failures, preventing sudden equipment failures, condition-based maintenance, predicting the remaining life of equipment.", "Often, in industrial enterprises there is no opportunity to use workstations for data analysis and processing. Therefore, special devices that can be easily connected to existing equipment (most often an industrial microcomputer) are in demand. The computational module NCS2 is one of such devices.", "Our company AI Labs periodically receives requests for solving some industrial problems related to machine learning. Not so long ago, we had the opportunity to take advantage of the opportunities provided by NCS2. As a result, I developed a pipeline for image classification using NCS2. I would like to share the results of this work with the readers.", "First of all, you need to download and install the current version of OpenVINO. You can get OpenVINO from here. You can find a detailed installation guide here. Quick installation guide:", "2. Unpack the .tgz file (where <version> is the version of the downloaded archive, you will see it in the file name):", "4. Run the installation script as root:", "5. Follow the instructions on your screen.", "6. Set environment variables by editing the .bashrc file. Go to the user directory and open .bashrc file for editing (for example, with nano):", "Add the following line to the end of the .bashrc file, save it and reload:", "That\u2019s all. All the necessary functionality for local work with NCS2 has been prepared. You can perform data preprocessing and model training.", "Data preprocessing and model training with Google Colab", "Animals-10 dataset was used to solve the classification problem. To simplify the problem, 5 classes (species of animals) were selected from Animals-10: cat, dog, chicken, horse, sheep. Images related to each of the classes are grouped into corresponding folders (\u2018cat\u2019, \u2018dog\u2019, \u2018chicken\u2019, \u2018horse\u2019, \u2018sheep\u2019). The model was trained in Google Colab. Let\u2019s take a closer look.", "First of all, you need to install a version of TensorFlow suitable for working with NCS2:", "Mount the Google Drive (with dataset) to Google Colab:", "Go to the directory where the data was uploaded (\u2018animals\u2019):", "The folder structure should be as follows:", "Create a list of classes (labels):", "Set the size of the images (224 x 224). We use ImageDataGenerator to create a flow of images from folders when training the model.", "We can get predictions and their classes:", "Saving a TensorFlow model to protocol buffer (pb) format", "As a result, the trained model is saved to the animals.pb file.", "Converting a TensorFlow model to intermediate representation", "There is a detailed tutorial on converting TensorFlow models. To convert the trained model, you need to perform the operations described below.", "Go to the model_optimizer folder (you need mo_tf.py):", "Run mo_tf.py with following command (please note that you must use a scaling factor of 255, the same as in the image preprocessing stage):", "If the conversion is successful, you will see the following messages in the console:", "Thus, as a result of the conversion, we get 3 files: animals.xml and animals.bin, animals.mapping. It is advisable to copy these files to a separate folder (for example, test_folder).", "Running a trained model and prediction obtaining with NCS2 device", "To check the performance of the model on NCS2, you can use the classification_sample.py script, which is included in OpenVINO (/home/user_name/intel/openvino/deployment_tools/inference_engine/samples/python/classification_sample/classification_sample.py). Copy this script to the folder with 3 trained model files (animals.xml, animals.bin, animals.mapping). Also, to check the functionality, you can copy several images (for example, 001.jpeg and 002.jpeg) to the same folder.", "Connect NCS2 to USB, go to the test_folder and run (MYRIAD key to run the model on NCS2):", "Test image and output from NCS2 in console:", "As you can see from the examples presented, the classification is correct. Image 001.jpeg shows a horse (classid=3), and image 002.jpeg shows a chicken (classid=1).", "The presented pipeline allows you to quickly go through all the stages from data preprocessing and model training to its testing based on the NCS2 module. As practice has shown, NCS2 copes well with the task of image classification and can be recommended for solving simple industrial classification tasks.", "MobileNets: Efficient Convolutional Neural Networks for Mobile Vision Applications", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Doctor of Engineering, Professor. Data Scientist at AI Labs | https://www.researchgate.net/profile/Oleksii_Sheremet"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F2a69aab8b570&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimage-classification-pipeline-with-intel-neural-compute-stick-2-ncs2-2a69aab8b570&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimage-classification-pipeline-with-intel-neural-compute-stick-2-ncs2-2a69aab8b570&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimage-classification-pipeline-with-intel-neural-compute-stick-2-ncs2-2a69aab8b570&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimage-classification-pipeline-with-intel-neural-compute-stick-2-ncs2-2a69aab8b570&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----2a69aab8b570--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----2a69aab8b570--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@dynamic_phlox_coyote_991?source=post_page-----2a69aab8b570--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@dynamic_phlox_coyote_991?source=post_page-----2a69aab8b570--------------------------------", "anchor_text": "Oleksii Sheremet"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fc3f778e21722&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimage-classification-pipeline-with-intel-neural-compute-stick-2-ncs2-2a69aab8b570&user=Oleksii+Sheremet&userId=c3f778e21722&source=post_page-c3f778e21722----2a69aab8b570---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F2a69aab8b570&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimage-classification-pipeline-with-intel-neural-compute-stick-2-ncs2-2a69aab8b570&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F2a69aab8b570&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimage-classification-pipeline-with-intel-neural-compute-stick-2-ncs2-2a69aab8b570&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://www.adobe.com/ru/products/photoshop.html", "anchor_text": "Adobe Photoshop"}, {"url": "https://ark.intel.com/content/www/us/en/ark/products/140109/intel-neural-compute-stick-2.html", "anchor_text": "NCS2"}, {"url": "http://ai-labs.org/", "anchor_text": "AI Labs"}, {"url": "https://docs.openvinotoolkit.org/", "anchor_text": "OpenVINO"}, {"url": "https://software.intel.com/content/www/us/en/develop/tools/openvino-toolkit/choose-download/linux.html", "anchor_text": "here"}, {"url": "https://docs.openvinotoolkit.org/latest/openvino_docs_install_guides_installing_openvino_linux.html", "anchor_text": "here"}, {"url": "https://www.kaggle.com/alessiocorrado99/animals10", "anchor_text": "Animals-10"}, {"url": "https://en.wikipedia.org/wiki/Tree_(command)", "anchor_text": "tree"}, {"url": "https://www.tensorflow.org/api_docs/python/tf/keras/preprocessing/image/ImageDataGenerator", "anchor_text": "ImageDataGenerator"}, {"url": "https://matplotlib.org/", "anchor_text": "matplotlib"}, {"url": "https://docs.openvinotoolkit.org/latest/openvino_docs_MO_DG_prepare_model_convert_model_Convert_Model_From_TensorFlow.html", "anchor_text": "tutorial"}, {"url": "https://www.adobe.com/ru/products/photoshop.html", "anchor_text": "Adobe Photoshop"}, {"url": "https://www.adobe.com/ru/products/photoshop.html", "anchor_text": "Adobe Photoshop"}, {"url": "https://ark.intel.com/content/www/us/en/ark/products/140109/intel-neural-compute-stick-2.html", "anchor_text": "Intel\u00ae Neural Compute Stick 2"}, {"url": "https://docs.openvinotoolkit.org/", "anchor_text": "OpenVINO toolkit"}, {"url": "https://arxiv.org/pdf/1704.04861.pdf", "anchor_text": "MobileNets: Efficient Convolutional Neural Networks for Mobile Vision Applications"}, {"url": "https://github.com/fchollet/deep-learning-models/releases/tag/v0.6", "anchor_text": "MobileNet"}, {"url": "https://medium.com/tag/image-classification?source=post_page-----2a69aab8b570---------------image_classification-----------------", "anchor_text": "Image Classification"}, {"url": "https://medium.com/tag/neural-compute-stick?source=post_page-----2a69aab8b570---------------neural_compute_stick-----------------", "anchor_text": "Neural Compute Stick"}, {"url": "https://medium.com/tag/mobilenet?source=post_page-----2a69aab8b570---------------mobilenet-----------------", "anchor_text": "Mobilenet"}, {"url": "https://medium.com/tag/openvino?source=post_page-----2a69aab8b570---------------openvino-----------------", "anchor_text": "Openvino"}, {"url": "https://medium.com/tag/pipeline?source=post_page-----2a69aab8b570---------------pipeline-----------------", "anchor_text": "Pipeline"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F2a69aab8b570&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimage-classification-pipeline-with-intel-neural-compute-stick-2-ncs2-2a69aab8b570&user=Oleksii+Sheremet&userId=c3f778e21722&source=-----2a69aab8b570---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F2a69aab8b570&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimage-classification-pipeline-with-intel-neural-compute-stick-2-ncs2-2a69aab8b570&user=Oleksii+Sheremet&userId=c3f778e21722&source=-----2a69aab8b570---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F2a69aab8b570&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimage-classification-pipeline-with-intel-neural-compute-stick-2-ncs2-2a69aab8b570&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----2a69aab8b570--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F2a69aab8b570&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimage-classification-pipeline-with-intel-neural-compute-stick-2-ncs2-2a69aab8b570&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----2a69aab8b570---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----2a69aab8b570--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----2a69aab8b570--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----2a69aab8b570--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----2a69aab8b570--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----2a69aab8b570--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----2a69aab8b570--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----2a69aab8b570--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----2a69aab8b570--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@dynamic_phlox_coyote_991?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@dynamic_phlox_coyote_991?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Oleksii Sheremet"}, {"url": "https://medium.com/@dynamic_phlox_coyote_991/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "41 Followers"}, {"url": "https://www.researchgate.net/profile/Oleksii_Sheremet", "anchor_text": "https://www.researchgate.net/profile/Oleksii_Sheremet"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fc3f778e21722&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimage-classification-pipeline-with-intel-neural-compute-stick-2-ncs2-2a69aab8b570&user=Oleksii+Sheremet&userId=c3f778e21722&source=post_page-c3f778e21722--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F19953c66acb8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimage-classification-pipeline-with-intel-neural-compute-stick-2-ncs2-2a69aab8b570&newsletterV3=c3f778e21722&newsletterV3Id=19953c66acb8&user=Oleksii+Sheremet&userId=c3f778e21722&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}