{"url": "https://towardsdatascience.com/generating-music-with-artificial-intelligence-9ce3c9eef806", "time": 1682995326.645155, "path": "towardsdatascience.com/generating-music-with-artificial-intelligence-9ce3c9eef806/", "webpage": {"metadata": {"title": "Generating Music With Artificial Intelligence | by Alex Yu | Towards Data Science", "h1": "Generating Music With Artificial Intelligence", "description": "I started playing piano when I was five years old. I used to practice for about an hour every day and let me tell you, an hour felt like forever. I didn\u2019t stop thought, and I kept on practicing\u2026"}, "outgoing_paragraph_urls": [{"url": "https://towardsdatascience.com/getting-a-machine-to-do-my-english-homework-for-me-5d339470fe42", "anchor_text": "my article", "paragraph_index": 4}, {"url": "https://magenta.tensorflow.org/onsets-frames", "anchor_text": "here", "paragraph_index": 17}, {"url": "https://arxiv.org/abs/1710.11153", "anchor_text": "here", "paragraph_index": 17}, {"url": "https://colab.research.google.com/notebook#fileId=/v2/external/notebooks/magenta/onsets_frames_transcription/onsets_frames_transcription.ipynb", "anchor_text": "here", "paragraph_index": 17}, {"url": "https://magenta.tensorflow.org/music-transformer", "anchor_text": "blog post", "paragraph_index": 23}, {"url": "https://arxiv.org/abs/1809.04281", "anchor_text": "research paper", "paragraph_index": 23}, {"url": "https://deepmind.com/blog/wavenet-generative-model-raw-audio/", "anchor_text": "here", "paragraph_index": 27}, {"url": "https://arxiv.org/abs/1609.03499", "anchor_text": "here", "paragraph_index": 27}, {"url": "https://storage.googleapis.com/magentadata/papers/maestro/index.html", "anchor_text": "here", "paragraph_index": 28}], "all_paragraphs": ["I started playing piano when I was five years old. I used to practice for about an hour every day and let me tell you, an hour felt like forever. I didn\u2019t stop thought, and I kept on practicing though, because I really liked music.", "Fast forward a few years and I started doing some really advanced stuff. My hands were literally flying all over the keyboard and I could play with my eyes closed. Just kidding. I wasn\u2019t actually that good but I hope that for a second you thought I was a piano prodigy or something. \ud83d\ude09", "I loved almost every aspect of playing the piano. The sound of the music, the feel of the keys\u2026 everything except for music theory. It\u2019s like if you took an old dude obsessed with rules and you combined him with musical creativity and ingenuity. Musical grammar, rules to follow when analyzing and writing music, key signatures and time signatures. It\u2019s all a bunch of random stuff floating across the page that you need to remember.", "But wait, a ton of data? Lots of rules and patterns? Sequences and sequences of notes? This sounds like a perfect job for (dramatic piano music) machine learning!", "Note: if you need a refresher, feel free to check out my article on generating text with RNNs.", "A super quick overview of Recurrent Neural Nets:", "So after learning about Recurrent Neural Networks, I thought that this would totally be the best solution for creating an ML model that could generate new types of music. I was close.", "After doing some research and learning more about using Recurrent Neural Networks to generate music, I found that it works pretty well. And it\u2019s actually super sick.", "But it still doesn\u2019t have that oomph to it if you get what I mean. I don\u2019t think this will be replacing the Mozart on my Spotify playlist any time soon. Although it\u2019s super cool that this piece of music was generated entirely by a neural network, given the context, I think most people would be able to tell that it was either composed by either a machine or by me.", "So that made me want to learn more and go deeper into the topic, and here\u2019s a super interesting thing that I found.", "After looking into some more resources, I found a research paper that introduces a new dataset called MAESTRO (which stands for MIDI and Audio Edited for Synchronous TRacks and Organization). It also proposes a new architecture, Wave2Midi2Wave which basically combines three state of the art algorithms and trains them together on the MAESTRO dataset.", "MIDI is basically a technical standard that includes a bunch of protocols for computers to interface with different kinds of audio devices. This is useful because the information that is transferred contains information about the note, pitch, velocity, and tempo.", "The main reason why this new dataset is so important is that it contains a lot more data than all the other previous datasets. To put it into perspective, the MAESTRO dataset contains 172 hours of audio and MIDI transcriptions. The MAPS dataset only contains 17.9 hours and the MusicNet dataset is only 15.3 hours.", "As I mentioned before, Wave2Midi2Wave is basically a combination of three different state of the art models and they each perform a different task. First, Wave2Midi is used to transcribe audio to a symbolic representation (MIDI). Then the Midi portion of the network generates new content. All of this is synthesized by Midi2Wave to get realistic sounding music.", "The first network in Wave2Midi2Wave uses a state of the art architecture called Onsets and Frames which automatically turns your recordings into notes represented in MIDI. So if you were improvising you could know exactly what you played!", "Using CNNs and LSTMs, researchers were able to \u201cpredict pitch onset events and then [use] those predictions to condition framewise pitch predictions.\u201d What this basically means is that one neural network in the model is used to predict when the note is played (i.e. the onset). And the other neural network predicts how long the note is played (every frame that the note is active).", "Looking at the image above, you can see that an arrow goes from the output of the onset predictor to the BiLSTM layer in the frame predictor. This is useful because each frame prediction that doesn\u2019t have a corresponding onset prediction is removed. It\u2019s like the neural network is double checking its predictions.", "If you\u2019re interested in learning more about this super cool model, you can check out the TensorFlow Magenta blog post here, the research paper here, and a Colab notebook here!", "For the second network in Wave2Midi2Wave, a special type of Transformer is used to generate entirely new sequences of music with long term coherence. The output of the network makes a lot more structural sense when compared to other neural nets.", "In a regular Transformer, self-attention is used to model relationships between words because in sentences, the meaning of a word is not only based on the words that came before it, but on the context of the entire sentence.", "Transformers aggregate information from all other parts of the network and generate a representation for each word based on the entire context. This process is repeated for every word to generate new representations.", "The takeaway here is that using Transformers we can attribute information to different pieces of data based on the context of the entire network. So let\u2019s go back to the topic of music generation.", "One problem with the original Transformer is that it relies on absolute positions for self-attention. When applying this to music, Transformers struggle with distances, order, and repetition. By using relative attention instead, the music Transformer model can focus on relational features and generate sequences beyond what was given in the training examples.", "If you want to learn more about the Music Transformer, there\u2019s also an accompanying blog post and research paper!", "The last part of the network takes a WaveNet model and trains it on the dataset to generate music that literally sounds like a recording. WaveNet is a model architecture that is based on the PixelCNN and is specialized to synthesize audio.", "The architecture makes use of convolutional layers. Since convolutions don\u2019t use recurrent connections like those in RNNs which means that they\u2019re usually a lot easier to train than RNNs. But one issue is that to increase the receptive field (the amount of data that the model can cover) a ton of layers or super large filters are required, increasing the computational cost.", "To get around this, dilated convolutions are used. This basically means that filters can be applied over a larger area if certain input values are skipped. You get almost the same effect as a larger filter if you dilated it with zeros, but it\u2019s a lot more efficient.", "Training WaveNet, a state of the art model for speech synthesis, on the MAESTRO dataset gives some pretty incredible results. I\u2019ve linked a WaveNet blog article and the research paper here and here.", "Note: there are a lot more audio recordings on the TensorFlow Magenta page for Wave2Midi2Wave. You can check it out here.", "When you compare this to the example from before, it\u2019s pretty clear that the audio is a lot more realistic. To me, it literally sounds like it was a recording of an actual person playing the piano. I\u2019d also say that although some parts might not sound too pleasant the overall effect is a much more coherent piece of music.", "Looking at the actual structure of the songs, it becomes even clearer how much more effective the Music Transformer is at generating new pieces that make sense structurally.", "While looking into generating music with different types of neural networks, I learned a ton about all the different methods and models that can be used to transcribe, generate, and synthesize audio. There are a lot of resources and architectures that I haven\u2019t seen yet and it\u2019ll be super exciting to what generated music sounds like in the next year or so.", "Thanks for reading! If you enjoyed it, please:", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "High school student passionate about tech, business, and making cool things."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F9ce3c9eef806&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgenerating-music-with-artificial-intelligence-9ce3c9eef806&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgenerating-music-with-artificial-intelligence-9ce3c9eef806&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgenerating-music-with-artificial-intelligence-9ce3c9eef806&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgenerating-music-with-artificial-intelligence-9ce3c9eef806&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----9ce3c9eef806--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----9ce3c9eef806--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@alexjy?source=post_page-----9ce3c9eef806--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@alexjy?source=post_page-----9ce3c9eef806--------------------------------", "anchor_text": "Alex Yu"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fc29545804005&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgenerating-music-with-artificial-intelligence-9ce3c9eef806&user=Alex+Yu&userId=c29545804005&source=post_page-c29545804005----9ce3c9eef806---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F9ce3c9eef806&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgenerating-music-with-artificial-intelligence-9ce3c9eef806&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F9ce3c9eef806&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgenerating-music-with-artificial-intelligence-9ce3c9eef806&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@skytta?utm_source=medium&utm_medium=referral", "anchor_text": "Oleg Kuzmin"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://towardsdatascience.com/getting-a-machine-to-do-my-english-homework-for-me-5d339470fe42", "anchor_text": "my article"}, {"url": "https://www.analyticsvidhya.com/blog/2017/12/introduction-to-recurrent-neural-networks/", "anchor_text": "Source."}, {"url": "http://www.hexahedria.com/2015/08/03/composing-music-with-recurrent-neural-networks/", "anchor_text": "Source."}, {"url": "https://magenta.tensorflow.org/maestro-wave2midi2wave", "anchor_text": "Source."}, {"url": "https://magenta.tensorflow.org/onsets-frames", "anchor_text": "Source."}, {"url": "https://magenta.tensorflow.org/onsets-frames", "anchor_text": "Source."}, {"url": "https://magenta.tensorflow.org/onsets-frames", "anchor_text": "here"}, {"url": "https://arxiv.org/abs/1710.11153", "anchor_text": "here"}, {"url": "https://colab.research.google.com/notebook#fileId=/v2/external/notebooks/magenta/onsets_frames_transcription/onsets_frames_transcription.ipynb", "anchor_text": "here"}, {"url": "https://magenta.tensorflow.org/music-transformer", "anchor_text": "Source."}, {"url": "https://ai.googleblog.com/2017/08/transformer-novel-neural-network.html", "anchor_text": "Source."}, {"url": "https://magenta.tensorflow.org/music-transformer", "anchor_text": "blog post"}, {"url": "https://arxiv.org/abs/1809.04281", "anchor_text": "research paper"}, {"url": "https://arxiv.org/pdf/1609.03499.pdf", "anchor_text": "Source."}, {"url": "https://arxiv.org/pdf/1609.03499.pdf", "anchor_text": "Source."}, {"url": "https://deepmind.com/blog/wavenet-generative-model-raw-audio/", "anchor_text": "here"}, {"url": "https://arxiv.org/abs/1609.03499", "anchor_text": "here"}, {"url": "https://storage.googleapis.com/magentadata/papers/maestro/index.html", "anchor_text": "here"}, {"url": "https://www.linkedin.com/in/alexjy/", "anchor_text": "LinkedIn"}, {"url": "https://alexyu.ca", "anchor_text": "personal website"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----9ce3c9eef806---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----9ce3c9eef806---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----9ce3c9eef806---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/music?source=post_page-----9ce3c9eef806---------------music-----------------", "anchor_text": "Music"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F9ce3c9eef806&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgenerating-music-with-artificial-intelligence-9ce3c9eef806&user=Alex+Yu&userId=c29545804005&source=-----9ce3c9eef806---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F9ce3c9eef806&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgenerating-music-with-artificial-intelligence-9ce3c9eef806&user=Alex+Yu&userId=c29545804005&source=-----9ce3c9eef806---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F9ce3c9eef806&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgenerating-music-with-artificial-intelligence-9ce3c9eef806&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----9ce3c9eef806--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F9ce3c9eef806&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgenerating-music-with-artificial-intelligence-9ce3c9eef806&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----9ce3c9eef806---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----9ce3c9eef806--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----9ce3c9eef806--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----9ce3c9eef806--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----9ce3c9eef806--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----9ce3c9eef806--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----9ce3c9eef806--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----9ce3c9eef806--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----9ce3c9eef806--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@alexjy?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@alexjy?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Alex Yu"}, {"url": "https://medium.com/@alexjy/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "243 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fc29545804005&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgenerating-music-with-artificial-intelligence-9ce3c9eef806&user=Alex+Yu&userId=c29545804005&source=post_page-c29545804005--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fe68b5bffb66e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgenerating-music-with-artificial-intelligence-9ce3c9eef806&newsletterV3=c29545804005&newsletterV3Id=e68b5bffb66e&user=Alex+Yu&userId=c29545804005&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}