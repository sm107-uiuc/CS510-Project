{"url": "https://towardsdatascience.com/pandas-query-method-saves-double-handling-of-variables-9293d703b804", "time": 1683002818.924921, "path": "towardsdatascience.com/pandas-query-method-saves-double-handling-of-variables-9293d703b804/", "webpage": {"metadata": {"title": "Pandas query method saves double handling of variables | by Alexis Lucattini | Towards Data Science", "h1": "Pandas query method saves double handling of variables", "description": "Using .query() can save us from having to type the variable name of a dataframe multiple times over a single line of code when selecting data."}, "outgoing_paragraph_urls": [], "all_paragraphs": ["Standard methods to retrieve rows with certain conditions in a pandas DataFrame object requires \u2018double handling\u2019; it\u2019s not particularly elegant.", "For example, we want to retrieve rows where column A is greater than 1, this is the standard way to do it using the .loc attribute.", "Here we obtain the Boolean series of rows where column A is greater than 0 for that given row. The .loc is used to pull out rows set to True. Note that the variable my_df is used twice here in a single line of code.It is fortunate that this variable name is not very long. I find this \u2018double handling\u2019 of the variable syntactically similar to base methods in R, particularly intimidating when nested and overall quite unnecessary.", "Some other languages can perform this filtering in a much more readable format:", "For python, we can do this simpler (and similar to the SQL / R-Tidyverse structure above) with pandas \u2018query\u2019 method. query returns only the rows that match the given condition, all columns remain present in the dataframe.", "Let's see six more examples where query is an appropriate replacement to the .loc approach", "Given an external list, obtain rows of the dataframe where a certain column matches an element in that list", "Compare two columns \u2014 this requires triple handling in the .loc example.", "Filter using multiple conditions over potentially multiple columns. Both & and | bitwise operators are allowed.", "Query recognises dates and can compare them to strings. All strings inside a query quote must be quoted.", "You can perform a function on a given column prior to comparison.Note that the output of the dataframe still contains the C_str column in its original format?", "7. Column names containing spacesInitially forbidden with pandas query, this has been resolved as of 0.25.2.Quote the column with backticks. Other special characters in the column may not work.", "In the latest release of pandas (0.25.3 at the time of writing), the .item() method was deprecated. Combined with the query function, item was a highly useful tool to obtain a single value from a given column when it was appropriate to assume that only one row would be returned. This would convert the column from a type pd.Series to that of the series\u2019 datatype i.e int, str, float etc. If more than one row was returned, a ValueError is raised by the method.", "We can use the squeeze method as an alternative with some small changes in the code. Like item, squeeze will convert a pandas series from series type to the datatype when the filtered series is only one row long. However, a ValueError is not raised if multiple values exist in the series, instead just the same series is returned. We can exploit this by checking if the returned value is still of a series type.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Bioinformatician / Research Software Engineer \u2014 University of Melbourne Centre for Cancer Research, Melbourne, Australia"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F9293d703b804&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpandas-query-method-saves-double-handling-of-variables-9293d703b804&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpandas-query-method-saves-double-handling-of-variables-9293d703b804&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpandas-query-method-saves-double-handling-of-variables-9293d703b804&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpandas-query-method-saves-double-handling-of-variables-9293d703b804&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----9293d703b804--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----9293d703b804--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@awlucattini_60867?source=post_page-----9293d703b804--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@awlucattini_60867?source=post_page-----9293d703b804--------------------------------", "anchor_text": "Alexis Lucattini"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F5b91b179ba57&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpandas-query-method-saves-double-handling-of-variables-9293d703b804&user=Alexis+Lucattini&userId=5b91b179ba57&source=post_page-5b91b179ba57----9293d703b804---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F9293d703b804&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpandas-query-method-saves-double-handling-of-variables-9293d703b804&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F9293d703b804&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpandas-query-method-saves-double-handling-of-variables-9293d703b804&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://pixabay.com/photos/panda-family-pandas-cute-bamboo-3811734/", "anchor_text": "https://pixabay.com/photos/panda-family-pandas-cute-bamboo-3811734/"}, {"url": "https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.query.html", "anchor_text": "Pandas Query API"}, {"url": "https://medium.com/tag/python?source=post_page-----9293d703b804---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/pandas-dataframe?source=post_page-----9293d703b804---------------pandas_dataframe-----------------", "anchor_text": "Pandas Dataframe"}, {"url": "https://medium.com/tag/data-science?source=post_page-----9293d703b804---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/code?source=post_page-----9293d703b804---------------code-----------------", "anchor_text": "Code"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F9293d703b804&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpandas-query-method-saves-double-handling-of-variables-9293d703b804&user=Alexis+Lucattini&userId=5b91b179ba57&source=-----9293d703b804---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F9293d703b804&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpandas-query-method-saves-double-handling-of-variables-9293d703b804&user=Alexis+Lucattini&userId=5b91b179ba57&source=-----9293d703b804---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F9293d703b804&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpandas-query-method-saves-double-handling-of-variables-9293d703b804&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----9293d703b804--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F9293d703b804&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpandas-query-method-saves-double-handling-of-variables-9293d703b804&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----9293d703b804---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----9293d703b804--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----9293d703b804--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----9293d703b804--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----9293d703b804--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----9293d703b804--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----9293d703b804--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----9293d703b804--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----9293d703b804--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@awlucattini_60867?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@awlucattini_60867?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Alexis Lucattini"}, {"url": "https://medium.com/@awlucattini_60867/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "46 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F5b91b179ba57&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpandas-query-method-saves-double-handling-of-variables-9293d703b804&user=Alexis+Lucattini&userId=5b91b179ba57&source=post_page-5b91b179ba57--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F634536c55e38&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpandas-query-method-saves-double-handling-of-variables-9293d703b804&newsletterV3=5b91b179ba57&newsletterV3Id=634536c55e38&user=Alexis+Lucattini&userId=5b91b179ba57&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}