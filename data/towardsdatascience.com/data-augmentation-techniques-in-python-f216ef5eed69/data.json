{"url": "https://towardsdatascience.com/data-augmentation-techniques-in-python-f216ef5eed69", "time": 1683001946.935043, "path": "towardsdatascience.com/data-augmentation-techniques-in-python-f216ef5eed69/", "webpage": {"metadata": {"title": "Data Augmentation techniques in python | by Renu Khandelwal | Towards Data Science", "h1": "Data Augmentation techniques in python", "description": "In this article, we will explore different data augmentation techniques in Python using imgaug library Image augmentation is a very powerful technique used to artificially create variations in\u2026"}, "outgoing_paragraph_urls": [], "all_paragraphs": ["In this article, we will explore different data augmentation techniques in Python using imgaug library", "Image augmentation is a very powerful technique used to artificially create variations in existing images to expand an existing image data set. This creates new and different images from the existing image data set that represents a comprehensive set of possible images.", "This is done by applying different transformation techniques like zooming the existing image, rotating the existing image by a few degrees, shearing or cropping the existing set of images etc.", "Deep learning Convolutional Neural Networks(CNN) need a huge number of images for the model to be trained effectively. This helps to increase the performance of the model by generalizing better and thereby reducing overfitting. Most popular data sets for classification and object detection data sets have a few thousand to millions of images.", "Generalizing refers to a model\u2019s performance when evaluated on previously seen data during training against the test or validation data it has never seen before.", "A CNN, due to its in-variance property, can classify objects even when visible in different sizes, orientations or different illumination. Hence, we can take the small dataset of images and transform the objects to different sizes by zooming in or zooming out, flipping them vertically or horizontally or changing the brightness whatever makes sense for the object. This way we create a rich, diverse data set with variations.", "Image Augmentation creates a rich, diverse set of images from a small set of images for image classification, object detection or image segmentation.", "Augmentation strategies to increase the size of the training data set need to be applied after carefully understanding the problem domain.", "If we are classifying different types of cars, then applying image augmentation by flipping a car vertically is not useful for the problem domain or when we are doing an image classification of handwritten digits flipping digit 6 vertically does not add value", "Image augmentation can be applied as a pre-processing step before we train the model or can be applied in real time.", "Augmentation is applied as a pre-processing step to increase the size of the data set. This is usually done when we have a small training data set that we want to expand.", "Generating augmentation on smaller data set is helpful but we need to consider the disk space when applying on larger data sets", "As the name suggests, augmentation is applied in real time. This is usually applied for larger data sets as we do not need to save the augmented images on the disk.", "In this case, we apply transformations in mini-batches and then feed it to the model.", "Online augmentation model will see different images at each epoch. In Offline augmentation, augmented image is part of the training set, it views the augmented image multiple times depending on the number of epochs.", "The model generalizes better with online augmentation as it sees more samples during training with online data augmentation.", "We will be using imgaug class for demonstrating Image Augmentation.", "imgaug supports a wide range of data augmentation techniques", "We will now explore these data augmentation techniques using imgaug library", "imgaug is a library for image augmentation along with key points/landmarks, bounding boxes, heat maps and segmentation maps.", "In some cases we get an error with Shapely, in that case, we can try the below command", "We will take an image and transform it using basic data augmentation techniques.", "We display the original image using imageio", "We can rotate the image by specifying the rotation in degrees. We are rotating the image by -50 degrees to 30 degrees", "We add different noise values sampled from Gaussian distributions element wise to images.", "Cropping removes columns/rows of pixels at the sides of images. In the example below, we are cropping one side of the image by 30%", "Shearing the image by 0 to 40 degrees", "We can flip the image vertically or horizontally. Fliplr flips image horizontally", "We adjust the image brightness using GammaContrast by scaling pixel values. Values in the range gamma=(0.5, 2.0) seem to be sensible. We can use SigmoidContrast or LinearContrast also for changing the brightness of the image", "We can zoom in or zoom out images using scale. We have scaled the image below to 150% to 80% of the image height/width. We can scale each axis independently", "We draw bounding boxes for object detection. When we augment the image we want the bounding boxes also to be updated accordingly.", "imgaug offers support for bounding boxes. When we rotate, shear or crop the image, bounding box around the object is also updated accordingly.", "Initializing the bounding box around the original image", "Displaying the bounding box on top of the original image", "In the code below, we move the image using translate_percentage, augment the bounding box and apply it over the image", "The bounding box may sometime go outside the image and we need additional code to handle such a scenario", "We rotate the image and try to draw the bounding box around the object", "Portions of the bounding box are outside the image. In the code below we will", "We create a padding function to pad the image with a 1 pixel white and 1 pixel black borders:", "We then draw the bounding boxes on the image. We first extend the image plane by BORDER pixels and then mark the bounding boxes inside the image plane", "We now apply the same rotation to the image and draw the bounding box", "In the next article, we will explore Keras ImageDataGenerator for image augmentation", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "A Technology Enthusiast who constantly seeks out new challenges by exploring cutting-edge technologies to make the world a better place!"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Ff216ef5eed69&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-augmentation-techniques-in-python-f216ef5eed69&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-augmentation-techniques-in-python-f216ef5eed69&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-augmentation-techniques-in-python-f216ef5eed69&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-augmentation-techniques-in-python-f216ef5eed69&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----f216ef5eed69--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----f216ef5eed69--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://arshren.medium.com/?source=post_page-----f216ef5eed69--------------------------------", "anchor_text": ""}, {"url": "https://arshren.medium.com/?source=post_page-----f216ef5eed69--------------------------------", "anchor_text": "Renu Khandelwal"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F31b07253bc35&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-augmentation-techniques-in-python-f216ef5eed69&user=Renu+Khandelwal&userId=31b07253bc35&source=post_page-31b07253bc35----f216ef5eed69---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ff216ef5eed69&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-augmentation-techniques-in-python-f216ef5eed69&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ff216ef5eed69&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-augmentation-techniques-in-python-f216ef5eed69&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://imgaug.readthedocs.io/en/latest/index.html", "anchor_text": "imgaug - imgaug 0.3.0 documentationimgaug is a library for image augmentation in machine learning experiments. It supports a wide range of augmentation\u2026imgaug.readthedocs.io"}, {"url": "https://blog.keras.io/building-powerful-image-classification-models-using-very-little-data.html", "anchor_text": "https://blog.keras.io/building-powerful-image-classification-models-using-very-little-data.html"}, {"url": "https://nanonets.com/blog/data-augmentation-how-to-use-deep-learning-when-you-have-limited-data-part-2/", "anchor_text": "https://nanonets.com/blog/data-augmentation-how-to-use-deep-learning-when-you-have-limited-data-part-2/"}, {"url": "https://github.com/Lexie88rus/augmentation-packages-overview/blob/master/data-augmentation-packages-overview.ipynb", "anchor_text": "https://github.com/Lexie88rus/augmentation-packages-overview/blob/master/data-augmentation-packages-overview.ipynb"}, {"url": "https://link.springer.com/content/pdf/10.1186%2Fs40537-019-0197-0.pdf", "anchor_text": "https://link.springer.com/content/pdf/10.1186%2Fs40537-019-0197-0.pdf"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----f216ef5eed69---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/convolutional-network?source=post_page-----f216ef5eed69---------------convolutional_network-----------------", "anchor_text": "Convolutional Network"}, {"url": "https://medium.com/tag/image-augmentation?source=post_page-----f216ef5eed69---------------image_augmentation-----------------", "anchor_text": "Image Augmentation"}, {"url": "https://medium.com/tag/object-detection?source=post_page-----f216ef5eed69---------------object_detection-----------------", "anchor_text": "Object Detection"}, {"url": "https://medium.com/tag/computer-vision?source=post_page-----f216ef5eed69---------------computer_vision-----------------", "anchor_text": "Computer Vision"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Ff216ef5eed69&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-augmentation-techniques-in-python-f216ef5eed69&user=Renu+Khandelwal&userId=31b07253bc35&source=-----f216ef5eed69---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Ff216ef5eed69&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-augmentation-techniques-in-python-f216ef5eed69&user=Renu+Khandelwal&userId=31b07253bc35&source=-----f216ef5eed69---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ff216ef5eed69&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-augmentation-techniques-in-python-f216ef5eed69&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----f216ef5eed69--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Ff216ef5eed69&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-augmentation-techniques-in-python-f216ef5eed69&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----f216ef5eed69---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----f216ef5eed69--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----f216ef5eed69--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----f216ef5eed69--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----f216ef5eed69--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----f216ef5eed69--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----f216ef5eed69--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----f216ef5eed69--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----f216ef5eed69--------------------------------", "anchor_text": ""}, {"url": "https://arshren.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://arshren.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Renu Khandelwal"}, {"url": "https://arshren.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "5.9K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F31b07253bc35&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-augmentation-techniques-in-python-f216ef5eed69&user=Renu+Khandelwal&userId=31b07253bc35&source=post_page-31b07253bc35--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fb1cb44d62203&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-augmentation-techniques-in-python-f216ef5eed69&newsletterV3=31b07253bc35&newsletterV3Id=b1cb44d62203&user=Renu+Khandelwal&userId=31b07253bc35&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}