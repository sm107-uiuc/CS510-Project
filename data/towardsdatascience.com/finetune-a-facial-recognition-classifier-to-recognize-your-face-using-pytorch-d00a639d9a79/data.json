{"url": "https://towardsdatascience.com/finetune-a-facial-recognition-classifier-to-recognize-your-face-using-pytorch-d00a639d9a79", "time": 1683005674.046391, "path": "towardsdatascience.com/finetune-a-facial-recognition-classifier-to-recognize-your-face-using-pytorch-d00a639d9a79/", "webpage": {"metadata": {"title": "Finetune a Facial Recognition Classifier to Recognize your Face using PyTorch | by Mike Chaykowsky | Towards Data Science", "h1": "Finetune a Facial Recognition Classifier to Recognize your Face using PyTorch", "description": "This is part of a series I am writing on tricking facial recognition systems using adversarial attacks with GANs. However, before we trick a facial recognition classifier we need to build one to\u2026"}, "outgoing_paragraph_urls": [{"url": "https://github.com/timesler/facenet-pytorch/tree/master/models", "anchor_text": "PyTorch facenet implementation", "paragraph_index": 2}, {"url": "http://www.robots.ox.ac.uk/~vgg/data/vgg_face2/", "anchor_text": "VGGFace2", "paragraph_index": 3}, {"url": "https://github.com/davidsandberg/facenet", "anchor_text": "David Sandberg\u2019s Tensorflow implementation", "paragraph_index": 9}, {"url": "https://github.com/pytorch/vision/blob/3d5610391eaef38ae802ffe8b693ac17b13bd5d1/torchvision/models/resnet.py#L203", "anchor_text": "Check resnet implementation", "paragraph_index": 17}, {"url": "http://linkedin.com/in/chaykowsky", "anchor_text": "linkedin.com/in/chaykowsky", "paragraph_index": 21}], "all_paragraphs": ["This is part of a series I am writing on tricking facial recognition systems using adversarial attacks with GANs.", "However, before we trick a facial recognition classifier we need to build one to trick. I personally want to build one that can recognize my own face. Instead of training a neural network from scratch I can start with a pre-trained network and then finetune it to recognize my face. Finetuning is greatly beneficial as we can start with the model weights already trained on a large-scale face database and then update some of them to reflect the new tasks we want it to perform. These weights already understand how to recognize faces, but the only difference is it does not know my face. So to have this pretrained model learn my own face is much easier to train as the model weights already contain much of the needed information to perform the task.", "models directory is from the PyTorch facenet implementation based on the Tensorflow implementation linked above.", "This inception_resnet_v1.py file is where we will pull in the pretrained model. The Inception Resnet V1 model is pretrained on VGGFace2 where VGGFace2 is a large-scale face recognition dataset developed from Google image searches and \u201chave large variations in pose, age, illumination, ethnicity and profession.\u201d", "Each layer\u2019s weights in the model have an attribute called requires_grad that can be set to True or False . When you run loss.backward() in the training loop these weights are updated and this is what contains all of the information needed to perform the predictions. When finetuning the network we freeze all of the layers up through the last convolutional block by setting the requires_grad attributes to False and then only update the weights on the remaining layers \u2014 which intuitively you can imagine the earlier layers as containing the base-level information needed to recognize face attributes and base level characteristics so we keep all of that performance while updating the final layers to include another face (mine).", "All train directories have 11 or 12 images of each individual and all val directories have 4 or 5 images of each individual. Michael_Chaykowsky is a directory of my face where I used various poses, lighting, and angles. To collect these images I took videos with a standard iPhone in various spaces and then transformed these videos to image and used MTCNN on each to perform face-alignment and cropping to appropriate size (160 x 160 pixels).", "Capture the frames of the video as .png files and rotate/crop/align.", "The images come in rotated so I use imagemagick to make them right-side up. Make sure to brew install imagemagick first. I think there\u2019s another way to install the library but if I recall it was a nightmare \u2014 so definitely suggest brew install .", "Autocrop has a nice feature where they do some resizing of face images and you can specify the face percentage. You can forgo this if you are doing the full MTCNN method (prefferred), but if not you can do this which is quite a bit easier.", "Now using the align_dataset_mtcnn.py script from David Sandberg\u2019s Tensorflow implementation of facenet we can apply this to the directory of face images.", "Now you have a directory with all of your faces aligned and cropped appropriately for modeling.", "When we load in the data we will perform some random transforms to the images to improve training. Different transforms can be attempted and you may try various ones, like", "Here I use random horizontal flip. All of these transforms make the model more generalizable and prevent overfitting.", "Recall earlier I mentioned that we will freeze up through the last conv block. To find where that is we can iterate through this list using -n, -n-1, ... until we find the block.", "Remove the last layers after conv block and place in layer_list .", "Put all beginning layers in an nn.Sequential . model_ft is now a torch model but without the final linear, pooling, batchnorm, and sigmoid layers.", "Re-attach the last 5 layers which automatically sets requires_grad = True .", "This linear layer Linear(in_features=1792, out_features=512, bias=False) actually requires writing two custom classes which is not entirely obvious by looking at it, but if you look at the data input/output you can see that there is a Flatten and normalize class within the layer. Check resnet implementation for reason of reshaping in last_linear layer.", "Then you can apply the final layers back to the new Sequential model.", "Keep an eye out for more from this series where I will describe how to trick this classifier using adversarial attacks with GANs.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Scientist at Rivian. x- RAND Researcher. Based out of Los Angeles. @ChaykowskyMike linkedin.com/in/chaykowsky"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fd00a639d9a79&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffinetune-a-facial-recognition-classifier-to-recognize-your-face-using-pytorch-d00a639d9a79&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffinetune-a-facial-recognition-classifier-to-recognize-your-face-using-pytorch-d00a639d9a79&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffinetune-a-facial-recognition-classifier-to-recognize-your-face-using-pytorch-d00a639d9a79&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffinetune-a-facial-recognition-classifier-to-recognize-your-face-using-pytorch-d00a639d9a79&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----d00a639d9a79--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----d00a639d9a79--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://jchaykow.medium.com/?source=post_page-----d00a639d9a79--------------------------------", "anchor_text": ""}, {"url": "https://jchaykow.medium.com/?source=post_page-----d00a639d9a79--------------------------------", "anchor_text": "Mike Chaykowsky"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fecd046b688e1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffinetune-a-facial-recognition-classifier-to-recognize-your-face-using-pytorch-d00a639d9a79&user=Mike+Chaykowsky&userId=ecd046b688e1&source=post_page-ecd046b688e1----d00a639d9a79---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fd00a639d9a79&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffinetune-a-facial-recognition-classifier-to-recognize-your-face-using-pytorch-d00a639d9a79&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fd00a639d9a79&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffinetune-a-facial-recognition-classifier-to-recognize-your-face-using-pytorch-d00a639d9a79&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://github.com/timesler/facenet-pytorch/tree/master/models", "anchor_text": "PyTorch facenet implementation"}, {"url": "http://www.robots.ox.ac.uk/~vgg/data/vgg_face2/", "anchor_text": "VGGFace2"}, {"url": "https://github.com/davidsandberg/facenet", "anchor_text": "David Sandberg\u2019s Tensorflow implementation"}, {"url": "https://github.com/pytorch/vision/blob/3d5610391eaef38ae802ffe8b693ac17b13bd5d1/torchvision/models/resnet.py#L203", "anchor_text": "Check resnet implementation"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----d00a639d9a79---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----d00a639d9a79---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----d00a639d9a79---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/facial-recognition?source=post_page-----d00a639d9a79---------------facial_recognition-----------------", "anchor_text": "Facial Recognition"}, {"url": "https://medium.com/tag/pytorch?source=post_page-----d00a639d9a79---------------pytorch-----------------", "anchor_text": "Pytorch"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fd00a639d9a79&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffinetune-a-facial-recognition-classifier-to-recognize-your-face-using-pytorch-d00a639d9a79&user=Mike+Chaykowsky&userId=ecd046b688e1&source=-----d00a639d9a79---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fd00a639d9a79&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffinetune-a-facial-recognition-classifier-to-recognize-your-face-using-pytorch-d00a639d9a79&user=Mike+Chaykowsky&userId=ecd046b688e1&source=-----d00a639d9a79---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fd00a639d9a79&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffinetune-a-facial-recognition-classifier-to-recognize-your-face-using-pytorch-d00a639d9a79&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----d00a639d9a79--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fd00a639d9a79&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffinetune-a-facial-recognition-classifier-to-recognize-your-face-using-pytorch-d00a639d9a79&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----d00a639d9a79---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----d00a639d9a79--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----d00a639d9a79--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----d00a639d9a79--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----d00a639d9a79--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----d00a639d9a79--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----d00a639d9a79--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----d00a639d9a79--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----d00a639d9a79--------------------------------", "anchor_text": ""}, {"url": "https://jchaykow.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://jchaykow.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Mike Chaykowsky"}, {"url": "https://jchaykow.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "130 Followers"}, {"url": "http://linkedin.com/in/chaykowsky", "anchor_text": "linkedin.com/in/chaykowsky"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fecd046b688e1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffinetune-a-facial-recognition-classifier-to-recognize-your-face-using-pytorch-d00a639d9a79&user=Mike+Chaykowsky&userId=ecd046b688e1&source=post_page-ecd046b688e1--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Ff4584d6cb9db&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffinetune-a-facial-recognition-classifier-to-recognize-your-face-using-pytorch-d00a639d9a79&newsletterV3=ecd046b688e1&newsletterV3Id=f4584d6cb9db&user=Mike+Chaykowsky&userId=ecd046b688e1&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}