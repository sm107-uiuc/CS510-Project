{"url": "https://towardsdatascience.com/add-this-single-word-to-make-your-pandas-apply-faster-90ee2fffe9e8", "time": 1683001830.5249548, "path": "towardsdatascience.com/add-this-single-word-to-make-your-pandas-apply-faster-90ee2fffe9e8/", "webpage": {"metadata": {"title": "Add this single word to make your Pandas Apply faster | by Rahul Agarwal | Towards Data Science", "h1": "Add this single word to make your Pandas Apply faster", "description": "We as data scientists have got laptops with quad-core, octa-core, turbo-boost. We work with servers with even more cores and computing power. Sometimes we get limited by the limitation of tools at\u2026"}, "outgoing_paragraph_urls": [{"url": "https://towardsdatascience.com/make-your-own-super-pandas-using-multiproc-1c04f41944a1", "anchor_text": "multiprocessing", "paragraph_index": 3}, {"url": "https://github.com/jmcarpenter2/swifter", "anchor_text": "swifter", "paragraph_index": 3}, {"url": "https://towardsdatascience.com/apply-and-lambda-usage-in-pandas-b13a1ea037f7", "anchor_text": "apply-lambda", "paragraph_index": 9}, {"url": "https://amzn.to/2XPSiiG", "anchor_text": "Python", "paragraph_index": 24}, {"url": "https://coursera.pxf.io/e45JOX", "anchor_text": "Intermediate level Python", "paragraph_index": 24}, {"url": "https://medium.com/@rahul_agarwal", "anchor_text": "Medium", "paragraph_index": 25}, {"url": "https://mlwhiz.ck.page/a9b8bda70c", "anchor_text": "blog", "paragraph_index": 25}, {"url": "https://twitter.com/MLWhiz", "anchor_text": "@mlwhiz", "paragraph_index": 25}, {"url": "http://ko-fi.com/rahulagarwal", "anchor_text": "ko-fi.com/rahulagarwal", "paragraph_index": 28}], "all_paragraphs": ["We as data scientists have got laptops with quad-core, octa-core, turbo-boost. We work with servers with even more cores and computing power.", "But do we really utilize the raw power we have at hand?", "Sometimes we get limited by the limitation of tools at our disposal. And sometimes we are not willing to write all that extraneous code to save a couple of minutes. And end up realizing only later that time optimization would have helped in the long run.", "Previously, I had written on how to make your apply function faster-using multiprocessing, but thanks to the swifter library, it is even more trivial now.", "This post is about using the computing power we have at hand and applying it to Pandas DataFrames using Swifter.", "We have got a huge pandas data frame, and we want to apply a complex function to it which takes a lot of time.", "For this post, I will generate some data with 25M rows and 4 columns.", "Can use parallelization easily to get extra performance out of our code?", "Let\u2019s set up a simple experiment.", "We will try to create a new column in our dataframe. We can do this simply by using apply-lambda in Pandas.", "The above code takes ~10 Minutes to run. And we are just doing a simple calculation on 2 columns here.", "Can we do better and what would it take?", "Yes, we can do better just by adding a \u201cmagic word\u201d \u2014 Swifter.", "But first, you need to install swifter, which is as simple as:", "You can then just import and append swifter keyword before the apply to use it.", "Yes. It does. We get a 2x improvement in run time vs. just using the function as it is.", "Swifter chooses the best way to implement the apply possible for your function by either vectorizing your function or using Dask in the backend to parallelize your function or by maybe using simple pandas apply if the dataset is small.", "In this particular case, Swifter is using Dask to parallelize our apply functions with the default value of npartitions = cpu_count()*2.", "For the MacBook I am working on the CPU Count is 6 and the hyperthreading is 2. Thus CPU Count is 12 and that makes npartitions=24.", "We could also choose to set n_partitions ourselves. Though I have observed the default value works just fine in most cases sometimes you might be able to tune this as well to gain additional speedups.", "For example: Below I set n_partitions=12 and we get a 2x speedup again. Here reducing our number of partitions results in smaller run times as the data movement cost between the partitions is high.", "Parallelization is not a silver bullet; it is buckshot.", "Parallelization won\u2019t solve all your problems, and you would still have to work on optimizing your functions, but it is a great tool to have in your arsenal.", "Time never comes back, and sometimes we have a shortage of it. At these times we need parallelization to be at our disposal with a single word.", "Also if you want to learn more about Python 3, I would like to call out an excellent course on Learn Intermediate level Python from the University of Michigan. Do check it out.", "I am going to be writing more beginner-friendly posts in the future too. Follow me up at Medium or Subscribe to my blog to be informed about them. As always, I welcome feedback and constructive criticism and can be reached on Twitter @mlwhiz.", "Also, a small disclaimer \u2014 There might be some affiliate links in this post to relevant resources, as sharing knowledge is never a bad idea.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "4M Views. Bridging the gap between Data Science and Intuition. MLE@FB, Ex-WalmartLabs, Citi. Connect on Twitter @mlwhiz \u2615\ufe0f ko-fi.com/rahulagarwal"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F90ee2fffe9e8&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fadd-this-single-word-to-make-your-pandas-apply-faster-90ee2fffe9e8&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fadd-this-single-word-to-make-your-pandas-apply-faster-90ee2fffe9e8&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fadd-this-single-word-to-make-your-pandas-apply-faster-90ee2fffe9e8&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fadd-this-single-word-to-make-your-pandas-apply-faster-90ee2fffe9e8&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----90ee2fffe9e8--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----90ee2fffe9e8--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://mlwhiz.medium.com/?source=post_page-----90ee2fffe9e8--------------------------------", "anchor_text": ""}, {"url": "https://mlwhiz.medium.com/?source=post_page-----90ee2fffe9e8--------------------------------", "anchor_text": "Rahul Agarwal"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fe8cce06956c9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fadd-this-single-word-to-make-your-pandas-apply-faster-90ee2fffe9e8&user=Rahul+Agarwal&userId=e8cce06956c9&source=post_page-e8cce06956c9----90ee2fffe9e8---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F90ee2fffe9e8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fadd-this-single-word-to-make-your-pandas-apply-faster-90ee2fffe9e8&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F90ee2fffe9e8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fadd-this-single-word-to-make-your-pandas-apply-faster-90ee2fffe9e8&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://pixabay.com/users/kaboompics-1013994/?utm_source=link-attribution&utm_medium=referral&utm_campaign=image&utm_content=791149", "anchor_text": "Karolina Grabowska"}, {"url": "https://pixabay.com/?utm_source=link-attribution&utm_medium=referral&utm_campaign=image&utm_content=791149", "anchor_text": "Pixabay"}, {"url": "https://towardsdatascience.com/make-your-own-super-pandas-using-multiproc-1c04f41944a1", "anchor_text": "multiprocessing"}, {"url": "https://github.com/jmcarpenter2/swifter", "anchor_text": "swifter"}, {"url": "https://towardsdatascience.com/apply-and-lambda-usage-in-pandas-b13a1ea037f7", "anchor_text": "apply-lambda"}, {"url": "https://github.com/jmcarpenter2/swifter", "anchor_text": "Source"}, {"url": "https://github.com/jmcarpenter2/swifter", "anchor_text": "swifter"}, {"url": "https://amzn.to/2XPSiiG", "anchor_text": "Python"}, {"url": "https://coursera.pxf.io/e45JOX", "anchor_text": "Intermediate level Python"}, {"url": "https://medium.com/@rahul_agarwal", "anchor_text": "Medium"}, {"url": "https://mlwhiz.ck.page/a9b8bda70c", "anchor_text": "blog"}, {"url": "https://twitter.com/MLWhiz", "anchor_text": "@mlwhiz"}, {"url": "https://medium.com/tag/python?source=post_page-----90ee2fffe9e8---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/programming?source=post_page-----90ee2fffe9e8---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/tag/data-science?source=post_page-----90ee2fffe9e8---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----90ee2fffe9e8---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----90ee2fffe9e8---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F90ee2fffe9e8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fadd-this-single-word-to-make-your-pandas-apply-faster-90ee2fffe9e8&user=Rahul+Agarwal&userId=e8cce06956c9&source=-----90ee2fffe9e8---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F90ee2fffe9e8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fadd-this-single-word-to-make-your-pandas-apply-faster-90ee2fffe9e8&user=Rahul+Agarwal&userId=e8cce06956c9&source=-----90ee2fffe9e8---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F90ee2fffe9e8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fadd-this-single-word-to-make-your-pandas-apply-faster-90ee2fffe9e8&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----90ee2fffe9e8--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F90ee2fffe9e8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fadd-this-single-word-to-make-your-pandas-apply-faster-90ee2fffe9e8&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----90ee2fffe9e8---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----90ee2fffe9e8--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----90ee2fffe9e8--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----90ee2fffe9e8--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----90ee2fffe9e8--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----90ee2fffe9e8--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----90ee2fffe9e8--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----90ee2fffe9e8--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----90ee2fffe9e8--------------------------------", "anchor_text": ""}, {"url": "https://mlwhiz.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://mlwhiz.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Rahul Agarwal"}, {"url": "https://mlwhiz.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "13.9K Followers"}, {"url": "http://ko-fi.com/rahulagarwal", "anchor_text": "ko-fi.com/rahulagarwal"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fe8cce06956c9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fadd-this-single-word-to-make-your-pandas-apply-faster-90ee2fffe9e8&user=Rahul+Agarwal&userId=e8cce06956c9&source=post_page-e8cce06956c9--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Ff41165c9f72f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fadd-this-single-word-to-make-your-pandas-apply-faster-90ee2fffe9e8&newsletterV3=e8cce06956c9&newsletterV3Id=f41165c9f72f&user=Rahul+Agarwal&userId=e8cce06956c9&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}