{"url": "https://towardsdatascience.com/creating-custom-aggregations-to-use-with-pandas-groupby-e3f5ef8cb43e", "time": 1683016115.0893729, "path": "towardsdatascience.com/creating-custom-aggregations-to-use-with-pandas-groupby-e3f5ef8cb43e/", "webpage": {"metadata": {"title": "Creating Custom Aggregations to Use with Pandas groupby | by Rose Day | Towards Data Science", "h1": "Creating Custom Aggregations to Use with Pandas groupby", "description": "Pandas groupby is a function you can utilize on dataframes to split the object, apply a function, and combine the results. This function is useful when you want to group large amounts of data and\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.kaggle.com/sootersaalu/amazon-top-50-bestselling-books-2009-2019", "anchor_text": "Amazon Top 50 Bestselling Books", "paragraph_index": 1}, {"url": "https://thedaywriter.com/membership", "anchor_text": "https://thedaywriter.com/membership", "paragraph_index": 13}], "all_paragraphs": ["Pandas groupby is a function you can utilize on dataframes to split the object, apply a function, and combine the results. This function is useful when you want to group large amounts of data and compute different operations for each group. If you are using an aggregation function with your groupby, this aggregation will return a single value for each group per function run. After forming your groups, you can run one or many aggregations on the grouped data.", "The dataset I am using today is Amazon Top 50 Bestselling Books on Kaggle. This dataset has some nice numeric columns and categories that we can work with. Importing that dataset, we can quickly look at one example of the data using head(1) to grab the first row and .T to transpose the data. Here we can see that Genre is a great category column to groupby, and we can aggregate the user ratings, reviews, price, and year.", "Now that we have taken a quick look at the columns, we can use groupby to group Genre\u2019s data. Before applying groupby, we can see two Genre categories in this dataset, Non-Fiction, and Fiction, meaning we will have two groups of data to work with. We can play around with the groups if we wanted to consider the author or book title, but we will stick with Genre for now.", "After setting up our groups, we can begin to create custom aggregations. I have used custom aggregations in functions like this to filter specific values out before performing calculations or aggregations under different conditions. When I am testing out aggregation functions, I like to start with a small series to validate the output, such as the one below.", "Once we have a series of data to test with, we can begin creating our aggregation functions. Below I have created three aggregation functions. The first and second functions are non_nan_mean, and standard_deviation which validate the series is not empty, remove any NA values, and perform a mean or standard deviation calculation. The last aggregation is a mean_lower_rating, which eliminates any upper values greater than five and calculates the mean on the lower values.", "Once you have defined your aggregation functions, as many or little as you need, you can apply your series to them to test. I printed my values out to look them over, like below.", "After understanding the dataset you are working with and testing out the aggregation functions using a small series of data, you can apply the aggregation functions created using the agg function mentioned earlier. This function works on dataframes, which allows us to aggregate data over a specified axis. A simple way to apply these aggregations is to create a list and pass that list as an argument. This method will apply your aggregations to all numeric columns within your group dataframe, as shown in example one below. In this example, you can see I am calling ex, which is the grouped output from earlier.", "As can be seen with the output, the mean_lower_rating aggregation does not perform well on specific columns, caused by the function designed for a particular column in mind, which was User Rating. Considering this, we can look at different ways to pass aggregation arguments into the agg function, which will clean this output up.", "Another way to pass arguments to agg is to develop a dictionary. The dictionary maps the column names to aggregation functions to run. An example of this method is seen in example two.", "This method is preferred if you do not want to apply all aggregations across all columns, as mentioned previously, with the mean_lower_rating aggregation. The process of defining which columns your aggregation applies to can be very beneficial for large datasets as it cleans up the output, providing you just the data you want to see. This method of applying the aggregations allowed me to specify the mean_lower_rating aggregation only for User Rating, and the other aggregations to their respective columns.", "Using Pandas groupby with the agg function will allow you to group your data into different categories and aggregate your numeric columns into one value per aggregation function. If you have use cases to create custom aggregation functions, you can write those functions to take in a series of data and then pass them to agg using a list or dictionary. You can pass a list if you want all aggregations applied to all numeric columns, and you can pass a dictionary if you\u2019re going to specify what aggregations apply to what columns. You can also use lambda functions to create your aggregations if you prefer, which I did not cover in this article.", "If you would like to read more, check out some of my other articles below!", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "I want to share with you what I have learned during my life and career thus far. Want to hear more? https://thedaywriter.com/membership"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fe3f5ef8cb43e&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreating-custom-aggregations-to-use-with-pandas-groupby-e3f5ef8cb43e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreating-custom-aggregations-to-use-with-pandas-groupby-e3f5ef8cb43e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreating-custom-aggregations-to-use-with-pandas-groupby-e3f5ef8cb43e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreating-custom-aggregations-to-use-with-pandas-groupby-e3f5ef8cb43e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----e3f5ef8cb43e--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----e3f5ef8cb43e--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://thedaywriter.com/?source=post_page-----e3f5ef8cb43e--------------------------------", "anchor_text": ""}, {"url": "https://thedaywriter.com/?source=post_page-----e3f5ef8cb43e--------------------------------", "anchor_text": "Rose Day"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fa7f2e8e50135&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreating-custom-aggregations-to-use-with-pandas-groupby-e3f5ef8cb43e&user=Rose+Day&userId=a7f2e8e50135&source=post_page-a7f2e8e50135----e3f5ef8cb43e---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe3f5ef8cb43e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreating-custom-aggregations-to-use-with-pandas-groupby-e3f5ef8cb43e&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe3f5ef8cb43e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreating-custom-aggregations-to-use-with-pandas-groupby-e3f5ef8cb43e&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@djmle29n", "anchor_text": "Debbie Molle"}, {"url": "https://unsplash.com/", "anchor_text": "Unsplash"}, {"url": "https://www.kaggle.com/sootersaalu/amazon-top-50-bestselling-books-2009-2019", "anchor_text": "Amazon Top 50 Bestselling Books"}, {"url": "https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.groupby.html", "anchor_text": "pandas.DataFrame.groupby"}, {"url": "https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.core.groupby.DataFrameGroupBy.aggregate.html", "anchor_text": "pandas.core.groupby.DataFrameGroupBy.aggregate"}, {"url": "https://pandas.pydata.org/pandas-docs/stable/user_guide/groupby.html", "anchor_text": "Group by: split-apply-combine"}, {"url": "https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.agg.html", "anchor_text": "pandas.DataFrame.agg"}, {"url": "https://towardsdatascience.com/top-8-skills-for-every-data-scientist-79e6b1faf3e1", "anchor_text": "Top 8 Skills for Every Data ScientistAs I attend university talks, the most common question I get asked is \u201cWhat skills do I need to have?\u201dtowardsdatascience.com"}, {"url": "https://towardsdatascience.com/stop-wasting-your-time-and-consult-a-subject-matter-expert-f6ee9bffd0fe", "anchor_text": "Stop Wasting Your Time and Consult a Subject Matter ExpertWhen working on data science projects, it may help pull in a subject matter expert to review your work.towardsdatascience.com"}, {"url": "https://towardsdatascience.com/keys-to-success-when-adopting-a-pre-existing-data-science-project-9f1225fb0275", "anchor_text": "Keys to Success when Adopting a Pre-Existing Data Science ProjectThe code may not have been yours originally, but it is yours now. So what next?towardsdatascience.com"}, {"url": "https://towardsdatascience.com/dont-be-too-proud-to-ask-for-help-76f21d16f318", "anchor_text": "Don\u2019t be too Proud to Ask For HelpIf you are stuck on a bug or feel overwhelmed, you can ask for the help you need.towardsdatascience.com"}, {"url": "https://towardsdatascience.com/top-3-articles-for-data-visualization-956a08a54b04", "anchor_text": "Top 3 Articles for Data VisualizationThese articles are helpful if you want to get better at structuring your data visualizations.towardsdatascience.com"}, {"url": "https://medium.com/tag/data-science?source=post_page-----e3f5ef8cb43e---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/python?source=post_page-----e3f5ef8cb43e---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/software-development?source=post_page-----e3f5ef8cb43e---------------software_development-----------------", "anchor_text": "Software Development"}, {"url": "https://medium.com/tag/data?source=post_page-----e3f5ef8cb43e---------------data-----------------", "anchor_text": "Data"}, {"url": "https://medium.com/tag/technology?source=post_page-----e3f5ef8cb43e---------------technology-----------------", "anchor_text": "Technology"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fe3f5ef8cb43e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreating-custom-aggregations-to-use-with-pandas-groupby-e3f5ef8cb43e&user=Rose+Day&userId=a7f2e8e50135&source=-----e3f5ef8cb43e---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fe3f5ef8cb43e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreating-custom-aggregations-to-use-with-pandas-groupby-e3f5ef8cb43e&user=Rose+Day&userId=a7f2e8e50135&source=-----e3f5ef8cb43e---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe3f5ef8cb43e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreating-custom-aggregations-to-use-with-pandas-groupby-e3f5ef8cb43e&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----e3f5ef8cb43e--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fe3f5ef8cb43e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreating-custom-aggregations-to-use-with-pandas-groupby-e3f5ef8cb43e&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----e3f5ef8cb43e---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----e3f5ef8cb43e--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----e3f5ef8cb43e--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----e3f5ef8cb43e--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----e3f5ef8cb43e--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----e3f5ef8cb43e--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----e3f5ef8cb43e--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----e3f5ef8cb43e--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----e3f5ef8cb43e--------------------------------", "anchor_text": ""}, {"url": "https://thedaywriter.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://thedaywriter.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Rose Day"}, {"url": "https://thedaywriter.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "875 Followers"}, {"url": "https://thedaywriter.com/membership", "anchor_text": "https://thedaywriter.com/membership"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fa7f2e8e50135&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreating-custom-aggregations-to-use-with-pandas-groupby-e3f5ef8cb43e&user=Rose+Day&userId=a7f2e8e50135&source=post_page-a7f2e8e50135--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fba3cf98cd729&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreating-custom-aggregations-to-use-with-pandas-groupby-e3f5ef8cb43e&newsletterV3=a7f2e8e50135&newsletterV3Id=ba3cf98cd729&user=Rose+Day&userId=a7f2e8e50135&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}