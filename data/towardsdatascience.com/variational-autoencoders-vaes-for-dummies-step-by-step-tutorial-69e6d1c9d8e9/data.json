{"url": "https://towardsdatascience.com/variational-autoencoders-vaes-for-dummies-step-by-step-tutorial-69e6d1c9d8e9", "time": 1683005244.7877681, "path": "towardsdatascience.com/variational-autoencoders-vaes-for-dummies-step-by-step-tutorial-69e6d1c9d8e9/", "webpage": {"metadata": {"title": "Variational Autoencoders (VAEs) for Dummies - Step By Step Tutorial | Towards Data Science", "h1": "Variational Autoencoders (VAEs) for Dummies \u2014 Step By Step Tutorial", "description": "The Ultimate Tutorial for building Variational Autoencoders (VAEs). Step-by-step guide with Python code for training VAEs on images. How To generate unseen images."}, "outgoing_paragraph_urls": [{"url": "https://www.forbes.com/sites/tomcoughlin/2018/11/27/175-zettabytes-by-2025/#6af1bdb35459", "anchor_text": "IDC", "paragraph_index": 1}, {"url": "http://mmlab.ie.cuhk.edu.hk/projects/CelebA.html", "anchor_text": "CelebFaces A", "paragraph_index": 4}, {"url": "https://towardsdatascience.com/why-deep-learning-works-289f17cab01a", "anchor_text": "denoising images", "paragraph_index": 15}, {"url": "https://arxiv.org/pdf/1710.11041.pdf", "anchor_text": "unsupervised machine translation", "paragraph_index": 15}, {"url": "https://towardsdatascience.com/wild-wide-ai-responsible-data-science-16b860e1efe9", "anchor_text": "applied responsibly", "paragraph_index": 37}, {"url": "https://github.com/Harvard-IACS/2019-computefest/blob/master/Wednesday/auto_encoder/VAE_Solutions.ipynb", "anchor_text": "awesome code", "paragraph_index": 38}, {"url": "https://casser.io/autoencoder/", "anchor_text": "his blog", "paragraph_index": 38}, {"url": "https://towardsdatascience.com/understanding-variational-autoencoders-vaes-f70510919f73", "anchor_text": "Understanding Variational Autoencoders (VAEs)", "paragraph_index": 39}], "all_paragraphs": ["This article introduces everything you need to take off with generative models. We provide a step-by-step guide on how to train conditional VAEs on large image datasets and use them to generate new labeled images.", "Why do we need to generate new data when there is already so much data? According to IDC, there are more than 18 zettabytes of data out there.", "Most machine learning tasks require labeled data. Getting high-quality, labeled data is difficult. If we are generating that data ourselves, we can make as much of it as we like. New data can give us ideas and options.", "In this article, you will learn what is a Variational Autoencoder and how to create your own for generating new and unseen images. We explain the underlying concepts and intuition without math.", "We will be using a subset of the well-known Celebrity dataset to help us build a facial generative model. The dataset can be downloaded as described on the CelebFaces A website. It provides a large-scale face attributes dataset with more than 200K celebrity images, each with 40 attribute annotations.", "Below we pick random faces from the celebrity dataset and display their metadata (attributes). The images are 218px height, 178px width with 3 color channels.", "By looking at thousands of celebrity faces, a neural network could learn to generate faces of humans who do not exist.", "Neural networks are one of the many possible methods we can use to obtain a function approximation. A reason why they became popular is their ability to learn representations. Networks can learn the specific representations that matter when classifying an image as a dog or cat, assuming we provide them with the correct labels. This is supervised learning.", "In some cases, we do not have these labels. Nevertheless, we can train two networks, one that learns the representation, and one that reconstructs from the representation by minimizing the reconstruction loss function. This is an autoencoder. It gets that name because it automatically finds the best way to encode the input so that the decoded version is as close as possible to the input.", "An Autoencoder is made of a pair of two connected neural networks: an encoder model and a decoder model. Its goal is to find a way to encode the celebrity faces into a compressed form (latent space) in such a way that the reconstructed version is as close as possible to the input.", "The encoder model turns the input x into a small dense representation z, similar to how a convolutional neural network works by using filters to learn representations.", "The decoder model can be seen as a generative model which is able to generate specific features x\u2019.", "Both encoder and decoder are usually trained as a whole. The loss function penalizes the network for creating output faces that differ from input faces.", "Therefore the encoder learns to preserve as much of the relevant information needed in the limitation of the latent space, and cleverly discard irrelevant parts, e.g. noise.", "The decoder learns to take the compressed latent information and reconstruct it into a full celebrity face.", "An Autoencoder can be also useful for dimensionality reduction and denoising images, but can also be successful in unsupervised machine translation.", "Typically, the latent space z produced by the encoder is sparsely populated, meaning that it is difficult to predict the distribution of values in that space. Values are scattered and space will appear to be well utilized in a 2D representation.", "This is a very good property for compression systems. However, for generating new celebrity images this sparsity is an issue because finding a latent value for which the decoder will know how to produce a valid image is almost impossible.", "Furthermore, if space has gaps between clusters, and the decoder receives a variation from there, it will lack the knowledge to generate something useful.", "Variational Autoencoder works by making the latent space more predictable, more continuous, less sparse. By forcing latent variables to become normally distributed, VAEs gain control over the latent space.", "Instead of forwarding the latent values to the decoder directly, VAEs use them to calculate a mean and a standard deviation. The input to the decoder is then sampled from the corresponding normal distribution.", "During training, VAEs force this normal distribution to be as close as possible to the standard normal distribution by including the Kullback\u2013Leibler divergence in the loss function. VAE will be altering, or exploring variations on the faces, and not just in a random way, but in a desired, specific direction.", "Conditional Variational Autoencoders allow modeling the input based on both the latent variable z and additional information such as metadata of the face (smile, glasses, skin color, etc.).", "Let\u2019s build a (conditional) VAE that can learn on celebrity faces. We use a custom Keras memory-efficient generator to deal with our large dataset (202599 images, ca. 10KB each). The idea behind this is to get batches of images on the fly during the training process.", "We want the encoder to be a convolutional neural network that takes an image and outputs the parameters of the distribution Q(z|[x, c]) where x is the input image of the face, c is the conditioning variable (attributes of the face) and z is the latent variable. For this article, we use a simple architecture made of two convolutional layers and a pooling layer.", "The decoder is a convolutional neural network built the other way around. It is a generative network that outputs parameters to the likelihood distribution P([x,c]|z).", "The architecture of the whole VAE network is created as follows.", "The learning process for VAE models on the images in the celebA dataset is illustrated below. The code ran approximately 8 hours on an AWS instance using 1 GPU.", "After training, we can now pick an image randomly from our dataset and use the trained encoder to create a latent representation of the image.", "Using the latent representation, a vector of 16 real numbers, we can visualize how the decoder reconstructed the original image.", "Although the reconstructed image is blurry, we can see a strong similarity with the original image: gender, clothes color, hairs, smile, skin color.", "Conditional VAEs are capable of altering the latent space to generate new data. Specifically, we can generate a random count of unseen images using the decoder while conditioning it on given attributes.", "Although our variational autoencoder produces blurry and non-photorealistic faces, we can recognize the gender, skin color, smile, glasses, hair color of those humans, who never existed.", "Conditional VAEs can interpolate between attributes, and to make a face smile or to add glasses where there was none before. Below, we choose a random celebrity face from the dataset and take advantage of alterations of the latent representation to morph it from a female face into a male face. We also alter the faces to display a smile that was originally not there.", "In this article, we introduced Conditional Variational Autoencoders and demonstrated how they can learn how to generate new labeled data.", "We provided Python code for training VAEs on large celebrity image datasets. The approach and code can be extended to multiple other use cases.", "Generative Adversarial Networks (GANs) tend to produce even nicer-looking images because they learn to differentiate what is photorealistic to humans and what is not.", "The ethical aspect of using VAE/GAN technologies to generate fake images, videos or news should be considered seriously and their usage should be applied responsibly.", "Many thanks to Vincent Casser for his awesome code with a more advanced approach of implementing convolutional autoencoders for image manipulation provided in his blog. I obtained an explicit authorization from Vincent to adapt his VAE code for this article. Building a working VAE from scratch is rather tricky. Credits go to Vincent Casser.", "I recommend follow-up reading from Joseph Rocca: Understanding Variational Autoencoders (VAEs).", "Thanks to Anne Bonner for her editorial notes.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Husband & Dad. Mental health advocate. Top Medium Writer. 20 years in IT. AI Expert @Harvard. Empowering human-centered organizations with high-tech."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F69e6d1c9d8e9&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvariational-autoencoders-vaes-for-dummies-step-by-step-tutorial-69e6d1c9d8e9&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvariational-autoencoders-vaes-for-dummies-step-by-step-tutorial-69e6d1c9d8e9&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvariational-autoencoders-vaes-for-dummies-step-by-step-tutorial-69e6d1c9d8e9&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvariational-autoencoders-vaes-for-dummies-step-by-step-tutorial-69e6d1c9d8e9&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----69e6d1c9d8e9--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----69e6d1c9d8e9--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://michel-kana.medium.com/?source=post_page-----69e6d1c9d8e9--------------------------------", "anchor_text": ""}, {"url": "https://michel-kana.medium.com/?source=post_page-----69e6d1c9d8e9--------------------------------", "anchor_text": "Michel Kana, Ph.D"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fcb0b01fe20d2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvariational-autoencoders-vaes-for-dummies-step-by-step-tutorial-69e6d1c9d8e9&user=Michel+Kana%2C+Ph.D&userId=cb0b01fe20d2&source=post_page-cb0b01fe20d2----69e6d1c9d8e9---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F69e6d1c9d8e9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvariational-autoencoders-vaes-for-dummies-step-by-step-tutorial-69e6d1c9d8e9&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F69e6d1c9d8e9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvariational-autoencoders-vaes-for-dummies-step-by-step-tutorial-69e6d1c9d8e9&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://pixabay.com/images/id-4899802/", "anchor_text": "Pixabay"}, {"url": "https://www.forbes.com/sites/tomcoughlin/2018/11/27/175-zettabytes-by-2025/#6af1bdb35459", "anchor_text": "IDC"}, {"url": "http://mmlab.ie.cuhk.edu.hk/projects/CelebA.html", "anchor_text": "CelebFaces A"}, {"url": "https://towardsdatascience.com/why-deep-learning-works-289f17cab01a", "anchor_text": "denoising images"}, {"url": "https://arxiv.org/pdf/1710.11041.pdf", "anchor_text": "unsupervised machine translation"}, {"url": "https://towardsdatascience.com/generative-adversarial-network-gan-for-dummies-a-step-by-step-tutorial-fdefff170391", "anchor_text": "Generative Adversarial Network (GAN) for Dummies \u2014 A Step By Step TutorialThe ultimate beginner guide for understanding, building and training GANs with bulletproof Python code.towardsdatascience.com"}, {"url": "https://towardsdatascience.com/wild-wide-ai-responsible-data-science-16b860e1efe9", "anchor_text": "applied responsibly"}, {"url": "https://pixabay.com/photos/girl-face-colorful-colors-artistic-2696947/", "anchor_text": "Pixabay"}, {"url": "https://github.com/Harvard-IACS/2019-computefest/blob/master/Wednesday/auto_encoder/VAE_Solutions.ipynb", "anchor_text": "awesome code"}, {"url": "https://casser.io/autoencoder/", "anchor_text": "his blog"}, {"url": "https://towardsdatascience.com/understanding-variational-autoencoders-vaes-f70510919f73", "anchor_text": "Understanding Variational Autoencoders (VAEs)"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----69e6d1c9d8e9---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----69e6d1c9d8e9---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----69e6d1c9d8e9---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/programming?source=post_page-----69e6d1c9d8e9---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/tag/towards-data-science?source=post_page-----69e6d1c9d8e9---------------towards_data_science-----------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F69e6d1c9d8e9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvariational-autoencoders-vaes-for-dummies-step-by-step-tutorial-69e6d1c9d8e9&user=Michel+Kana%2C+Ph.D&userId=cb0b01fe20d2&source=-----69e6d1c9d8e9---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F69e6d1c9d8e9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvariational-autoencoders-vaes-for-dummies-step-by-step-tutorial-69e6d1c9d8e9&user=Michel+Kana%2C+Ph.D&userId=cb0b01fe20d2&source=-----69e6d1c9d8e9---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F69e6d1c9d8e9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvariational-autoencoders-vaes-for-dummies-step-by-step-tutorial-69e6d1c9d8e9&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----69e6d1c9d8e9--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F69e6d1c9d8e9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvariational-autoencoders-vaes-for-dummies-step-by-step-tutorial-69e6d1c9d8e9&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----69e6d1c9d8e9---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----69e6d1c9d8e9--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----69e6d1c9d8e9--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----69e6d1c9d8e9--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----69e6d1c9d8e9--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----69e6d1c9d8e9--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----69e6d1c9d8e9--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----69e6d1c9d8e9--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----69e6d1c9d8e9--------------------------------", "anchor_text": ""}, {"url": "https://michel-kana.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://michel-kana.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Michel Kana, Ph.D"}, {"url": "https://michel-kana.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "5.4K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fcb0b01fe20d2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvariational-autoencoders-vaes-for-dummies-step-by-step-tutorial-69e6d1c9d8e9&user=Michel+Kana%2C+Ph.D&userId=cb0b01fe20d2&source=post_page-cb0b01fe20d2--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F69e95067d2a1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvariational-autoencoders-vaes-for-dummies-step-by-step-tutorial-69e6d1c9d8e9&newsletterV3=cb0b01fe20d2&newsletterV3Id=69e95067d2a1&user=Michel+Kana%2C+Ph.D&userId=cb0b01fe20d2&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}