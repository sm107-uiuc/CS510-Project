{"url": "https://towardsdatascience.com/scraping-nfl-stats-to-compare-quarterback-efficiencies-4989642e02fe", "time": 1683007549.1013749, "path": "towardsdatascience.com/scraping-nfl-stats-to-compare-quarterback-efficiencies-4989642e02fe/", "webpage": {"metadata": {"title": "Using Python to Scrape NFL Stats and Compare Quarterback Efficiencies | by Naveen Venkatesan | Towards Data Science", "h1": "Using Python to Scrape NFL Stats and Compare Quarterback Efficiencies", "description": "Scraping NFL stats to compare quarterback efficiencies using BeautifulSoup and Matplotlib"}, "outgoing_paragraph_urls": [{"url": "https://towardsdatascience.com/web-scraping-nba-stats-4b4f8c525994", "anchor_text": "here", "paragraph_index": 0}, {"url": "https://www.pro-football-reference.com/", "anchor_text": "Pro Football Reference", "paragraph_index": 1}, {"url": "https://www.pro-football-reference.com/years/2019/passing.htm", "anchor_text": "here", "paragraph_index": 4}, {"url": "https://www.crummy.com/software/BeautifulSoup/bs4/doc/", "anchor_text": "documentation", "paragraph_index": 6}, {"url": "https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.rank.html", "anchor_text": "online documentation", "paragraph_index": 25}, {"url": "https://teamcolorcodes.com/nfl-team-color-codes/", "anchor_text": "this link", "paragraph_index": 30}, {"url": "https://github.com/venkatesannaveen/medium-articles", "anchor_text": "Github repository", "paragraph_index": 45}, {"url": "https://twitter.com/naveenv_92", "anchor_text": "Twitter", "paragraph_index": 46}, {"url": "https://www.linkedin.com/in/naveenvenkatesan/", "anchor_text": "LinkedIn", "paragraph_index": 46}], "all_paragraphs": ["I have always been apprehensive about trying to scrape my own data, and the fact that websites like Kaggle aggregate such high quality datasets has made learning this skill less of a need. However, the abundance of educational articles on data science on this platform have helped me make progress towards collecting my own datasets. A lot of the inspiration and methods for scraping data came from here.", "In this article, I will pull quarterback stats from the 2019\u201320 NFL season from Pro Football Reference, and use them to create radar charts to assess QB efficiency.", "To open the webpage and scrape the data, we will use two modules, urllib.request to open the URL, and BeautifulSoup to parse through the HTML.", "In addition to these packages, we will need some packages to manipulate data, numpy and pandas, and plot our data, matplotlib.", "The data we are going to import is the NFL passing data from the 2019 season, which can be found here. We open the site and pass it to BeautifulSoup with the following:", "Note that we can easily adapt all of this analysis to previous years by changing the 2019 in URL to the year of your choosing.", "The two BeautifulSoup functions we will use to scrape the page are findAll() and getText(), which return values based on the HTML of the page we are scraping. I present simplified use cases below \u2014 for all possibilities you should refer to the documentation.", "For these to be effective, we have to determine patterns in the page source. In our, case the data is nicely formatted in a table, so we can find all the table rows (tr) and columns (td) and extract the text directly from the cells.", "First, we need to collect the column headers so we can use them later in our DataFrame. To do this, we find the first tr element in page and collect the text from all the table headers (th):", "We index the first element because this is the row that contains the column headers. We can view our result:", "To collect the actual data, we will first collect all the table rows (tr) and store them in an array. Then, we iterate through each row and collect the text in each column (td) with getText() :", "We skip the first row because these are the column headers that we just collected previously. When we examine the first row of our qb_stats list:", "Now we can combine our headers and stats into a pandas DataFrame. If you haven\u2019t used pandas before, it\u2019s essentially an Excel spreadsheet that you can manipulate programmatically, so it\u2019s great for handling larger datasets. We notice above that the Rk column does not have corresponding data in our qb_stats list \u2014 this is because those values were all table headers, so our findAll() function did not pull their data. Regardless \u2014 this data is frivolous for our analysis so we will omit it when creating the DataFrame.", "columns \u2014 the column titles for our DataFrame (we are omitting Rk)", "Now, let\u2019s take a look at the first five rows of our DataFrame:", "Now, we can manipulate the data in this DataFrame to get what we need to make our radar charts. First, let\u2019s look at all the columns in the set:", "We see one issue immediately \u2014 there are two columns titled Yds; one is for passing yards, and the other is yards lost due to being sacked. We can easily remedy this by renaming the latter:", "Now, let\u2019s view our columns again:", "We have successfully renamed the column to Yds_Sack and no longer have a conflict in our column names! Next, let\u2019s identify which statistical categories we are interested in for our visualization. We will choose:", "Now let\u2019s create a new DataFrame as a subset of our original data, only with the data from our chosen categories. Additionally, we will add the player name and team.", "Now that we have our subset of data, let\u2019s check the data type, because we scraped the values as text from the URL:", "All of our numerical data have been stored as objects, so we can\u2019t manipulate them. So before we proceed further, we must convert all this data to numerical values. To do so, we use a function called pandas.to_numeric.", "Now, let\u2019s check our data types once again:", "We have one last piece of data cleaning to do. On the original website, they put ornamental characters next to players that had end-of-season achievements, such as a Pro Bowl (*) or All-Pro (+) selection. We will remove these using str.replace():", "Let\u2019s filter our data down to only the quarterbacks who threw for more than 1500 yards:", "Now, for our radar chart, we want to calculate the each quarterback\u2019s statistical rank by percentile, which is easily done in pandas with DataFrame.rank(pct=True). The rank() function can take other arguments to rank based on other parameters for which you can look up the online documentation.", "Additionally, we want to flip our interceptions rank, as we don\u2019t want the QB with the most interceptions to have the highest percentile!", "Now we examine our new data:", "Great! We can now make our visualizations!", "We will start by editing some general plot parameters. We are going to be generating a polar plot, so the x-ticks correspond to the angle around the circle \u2014 we are increasing the padding between the axis and tick labels:", "For colors in our chart, we will use the HEX codes of the NFL team colors, which were collected from this link.", "The angles at which we plot all our points will be dependent on the number of statistical categories we have. In our example, we have 6 categories, so we will plot our points every 2\u03c0/6 radians, or 60 degrees. We can calculate this as follows, using numpy.linspace() :", "We are adding the offset term to adjust where the labels appear on the circle (instead of the first label at 0 radians, it now appears at \u03c0/6).", "When we plot the data, we need to actually duplicate the first category, so that the shape closes itself. If you notice when we calculated the angles, we have 7 data points, and the first and last angles correspond to the same point on the circle. So when we plot the data, we use the following (we will turn this into a function, so player_data represents a row of player-specific data that we will pass):", "The above code works because our categories are the last 6 columns of our DataFrame, so len(angles) \u2014 1 corresponds to the first of these categories (since angles has an extra element). We then append the value of the first category onto the end of this array so that we can close the shape.", "Now we can set the labels for the category names (since we have one less category than angles, we omit the last element):", "Finally, we will add the player name on top of the radar chart \u2014 we place the text object at (\u03c0/2, 1.7), in absolute plot coordinates so that it appears above the axis:", "We can put this all together to make a helper function to generate our radar charts as follows:", "Let\u2019s also make another helper function to return a numpy array of QB data when given a team input:", "Since I\u2019m a huge 49ers fan, let\u2019s start by looking at the radar charts for QBs in the NFC West:", "The data seems to support what we see from the eye test :", "The MVP race (at QB) came down Russell Wilson and Lamar Jackson (who eventually won):", "From a pure passer standpoint, Russell Wilson has more balanced stats, but Lamar Jackson clearly had the more \u201cbang-for-buck\u201d passing yards, as shown by his number of passing TDs and quarterback rating. Additionally, Lamar Jackson set the QB rushing record for a season, which is not captured in this chart.", "Teams who drafted 1st round QBs", "Four quarterbacks were taken in the 1st round of the 2020 NFL Draft: Joe Burrow (CIN), Tua Tagovailoa (MIA), Justin Herbert (LAC), and (surprisingly) Jordan Love (GB). Let\u2019s visualize the stats of the quarterbacks that these draft picks would replace.", "As you can see, the possibilities are endless \u2014 and this framework can be easily adapted for other stats such as rushing and receiving metrics. The Jupyter notebook used for this article can be found at this Github repository.", "Thank you for reading! I appreciate any feedback, and you can find me on Twitter and connect with me on LinkedIn for more updates and articles.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Scientist \u2022 Materials Scientist \u2022 Musician \u2022 Golfer"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F4989642e02fe&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fscraping-nfl-stats-to-compare-quarterback-efficiencies-4989642e02fe&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fscraping-nfl-stats-to-compare-quarterback-efficiencies-4989642e02fe&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fscraping-nfl-stats-to-compare-quarterback-efficiencies-4989642e02fe&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fscraping-nfl-stats-to-compare-quarterback-efficiencies-4989642e02fe&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----4989642e02fe--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----4989642e02fe--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://naveenvenkatesan.medium.com/?source=post_page-----4989642e02fe--------------------------------", "anchor_text": ""}, {"url": "https://naveenvenkatesan.medium.com/?source=post_page-----4989642e02fe--------------------------------", "anchor_text": "Naveen Venkatesan"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F7779ee5bf58d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fscraping-nfl-stats-to-compare-quarterback-efficiencies-4989642e02fe&user=Naveen+Venkatesan&userId=7779ee5bf58d&source=post_page-7779ee5bf58d----4989642e02fe---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F4989642e02fe&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fscraping-nfl-stats-to-compare-quarterback-efficiencies-4989642e02fe&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F4989642e02fe&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fscraping-nfl-stats-to-compare-quarterback-efficiencies-4989642e02fe&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@rileyhphotos?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Riley McCullough"}, {"url": "https://unsplash.com/s/photos/american-football?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://towardsdatascience.com/web-scraping-nba-stats-4b4f8c525994", "anchor_text": "here"}, {"url": "https://www.pro-football-reference.com/", "anchor_text": "Pro Football Reference"}, {"url": "https://www.pro-football-reference.com/years/2019/passing.htm", "anchor_text": "here"}, {"url": "https://www.crummy.com/software/BeautifulSoup/bs4/doc/", "anchor_text": "documentation"}, {"url": "https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.rank.html", "anchor_text": "online documentation"}, {"url": "https://teamcolorcodes.com/nfl-team-color-codes/", "anchor_text": "this link"}, {"url": "https://github.com/venkatesannaveen/medium-articles", "anchor_text": "Github repository"}, {"url": "https://twitter.com/naveenv_92", "anchor_text": "Twitter"}, {"url": "https://www.linkedin.com/in/naveenvenkatesan/", "anchor_text": "LinkedIn"}, {"url": "https://medium.com/tag/data-science?source=post_page-----4989642e02fe---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/data-visualization?source=post_page-----4989642e02fe---------------data_visualization-----------------", "anchor_text": "Data Visualization"}, {"url": "https://medium.com/tag/python?source=post_page-----4989642e02fe---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/nfl?source=post_page-----4989642e02fe---------------nfl-----------------", "anchor_text": "NFL"}, {"url": "https://medium.com/tag/statistics?source=post_page-----4989642e02fe---------------statistics-----------------", "anchor_text": "Statistics"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F4989642e02fe&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fscraping-nfl-stats-to-compare-quarterback-efficiencies-4989642e02fe&user=Naveen+Venkatesan&userId=7779ee5bf58d&source=-----4989642e02fe---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F4989642e02fe&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fscraping-nfl-stats-to-compare-quarterback-efficiencies-4989642e02fe&user=Naveen+Venkatesan&userId=7779ee5bf58d&source=-----4989642e02fe---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F4989642e02fe&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fscraping-nfl-stats-to-compare-quarterback-efficiencies-4989642e02fe&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----4989642e02fe--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F4989642e02fe&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fscraping-nfl-stats-to-compare-quarterback-efficiencies-4989642e02fe&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----4989642e02fe---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----4989642e02fe--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----4989642e02fe--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----4989642e02fe--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----4989642e02fe--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----4989642e02fe--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----4989642e02fe--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----4989642e02fe--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----4989642e02fe--------------------------------", "anchor_text": ""}, {"url": "https://naveenvenkatesan.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://naveenvenkatesan.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Naveen Venkatesan"}, {"url": "https://naveenvenkatesan.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "487 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F7779ee5bf58d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fscraping-nfl-stats-to-compare-quarterback-efficiencies-4989642e02fe&user=Naveen+Venkatesan&userId=7779ee5bf58d&source=post_page-7779ee5bf58d--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fe736f4929535&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fscraping-nfl-stats-to-compare-quarterback-efficiencies-4989642e02fe&newsletterV3=7779ee5bf58d&newsletterV3Id=e736f4929535&user=Naveen+Venkatesan&userId=7779ee5bf58d&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}