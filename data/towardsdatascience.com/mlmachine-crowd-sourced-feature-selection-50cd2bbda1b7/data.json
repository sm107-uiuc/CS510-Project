{"url": "https://towardsdatascience.com/mlmachine-crowd-sourced-feature-selection-50cd2bbda1b7", "time": 1683006255.594411, "path": "towardsdatascience.com/mlmachine-crowd-sourced-feature-selection-50cd2bbda1b7/", "webpage": {"metadata": {"title": "mlmachine - Crowd-Sourced Feature Selection | by Tyler Peterson | Towards Data Science", "h1": "mlmachine - Crowd-Sourced Feature Selection", "description": "mlmachine is a Python library that organizes and accelerates notebook-based machine learning experiments. In this article, we use mlmachine to accomplish actions that would otherwise take\u2026"}, "outgoing_paragraph_urls": [{"url": "https://github.com/petersontylerd/mlmachine/blob/master/notebooks/mlmachine_part_3.ipynb", "anchor_text": "Jupyter Notebook", "paragraph_index": 2}, {"url": "https://github.com/petersontylerd/mlmachine", "anchor_text": "project", "paragraph_index": 3}, {"url": "https://github.com/petersontylerd/mlmachine", "anchor_text": "GitHub repository", "paragraph_index": 39}], "all_paragraphs": ["mlmachine is a Python library that organizes and accelerates notebook-based machine learning experiments.", "In this article, we use mlmachine to accomplish actions that would otherwise take considerable coding and effort, including:", "Check out the Jupyter Notebook for this article.", "Check out the project on GitHub.", "And check out past mlmachine articles:", "Here is a non-exhaustive list of feature importance estimation techniques:", "This battery of techniques stems from several different libraries. Ideally, we use all of these techniques (where applicable) to get a broad understanding of the role each feature plays in a machine learning problem. This is a cumbersome series of tasks.", "Even if we took the time to execute each method, disparate execution leads to disparate variables, making a holistic assessment tedious to compile.", "mlmachine\u2019s FeatureSelector() class makes it easy to run all of the feature importance estimation techniques listed above. Further, we can do this for a variety of estimators, and a variety of metrics, simultaneously. Let\u2019s see mlmachine in action.", "First, we apply data preprocessing techniques to clean up our data. We\u2019ll start by creating two Machine() objects - one for the training data and a second for the validation data:", "Now we process the data by imputing nulls and applying various binning and encoding techniques:", "Here is the output, still in a DataFrame:", "Our DataFrame has been imputed, encoded in a variety of ways, and has several new features. We\u2019re ready for FeatureSelector().", "To instantiate a FeatureSelector() object, we pass the training data, labels and a list of estimators. This list of estimators can contain estimator class names, variables of instantiated models, or a combination of the two. In this example, we pass the class names for LogisticRegression() and XGBClassifier(), which leverages the default settings of the estimators.", "Our FeatureSelector() object contains built-in methods for each feature importance technique described above, along with a method called feature_selector_suite(), which combines all techniques into a single execution.", "To execute feature_selector_suite(), we pass \u201caccuracy\u201d to the parameter sequential_scoring and 0 to the parameter sequential_n_folds. These parameters influence the sequential backward/forward algorithms. We also set save_to_csv to True to save the resulting DataFrame to a CSV. Here is our result:", "In the DataFrame, some of the columns capture the value of the metric, including F-value, P-value, variance, target correlation and Tree-based Feature Importance. The remaining columns capture the order in which a feature was selected or eliminated, depending on the underlying algorithm.", "Here is another example. This time, we instantiate FeatureSelector() using a list of estimators containing the RandomForestClassifier() class and three instantiated models. Each RandomForestClassifier() is instantiated with a different value for the max_depth hyperparameter. Lastly, we pass \u201croc_auc\u201d to sequential_scoring instead of \u201caccuracy\u201d as our scoring metric.", "Notice that in this DataFrame we have columns for Recursive Feature Elimination and Tree-based Feature Importance named specifically for the instantiated models in our estimators list.", "We\u2019ve already compiled a tidy summary describing feature importance, but we\u2019re just getting started.", "The value of having all of this information in one place is obvious, but to enable a crowd-sourced, ensemble-like assessment of feature importance we first need to normalize these values. This facilitates ranking.", "In addition to bringing the values on to the same scale, we need to ensure that we consistently handle the directionality of the values. For example, high F-values suggest important features, whereas with p-values it is the low values that suggest important features.", "mlmachine makes this easy to do. FeatureSelector() contains a method called feature_selector_stats() which applies this ranking, column by column. As an added bonus, feature_selector_stats() adds several summary statistic columns describing each feature\u2019s ranks, and automatically sorts the features by best rank.", "Notice 3 key differences in this updated DataFrame (which extends off-screen):", "According to this summary, the top three most important features in these models are \u201cFare\u201d, the mean target encoded version of \u201cSex\u201d, and \u201cAge\u201d.", "In this example, we executed feature_selector_stats() as a second step, but we can skip this by setting the add_stats parameter in feature_selector_suite() to True.", "Feature importance alone is a good start, but our ultimate goal to select only the most meaningful features for our forthcoming model training phase.", "Our ranked and sorted feature importance summary is the cornerstone of this next step. To evaluate each subset, FeatureSelector() uses an approach similar to Recursive Feature Elimination:", "To determine \u2018least important\u2019, we rely on the ranked and sorted feature importance summary. Each time we remove features, we remove the lowest ranked features from those remaining.", "Our FeatureSelector() object contains a method called feature_selector_cross_val(). This executes the iterative feature subset evaluation and stores the result. Let\u2019s review the parameters:", "On each row of the DataFrame, we see the performance of a single estimator on a certain feature subset based on a specific scoring metric. The column \u201cfeatures dropped\u201d describes how many features have been removed from the full feature set. Remember, after each iteration, feature_selector_cross_val() removes (1 x step) of the least important features, where importance is based on how feature_selection_summary is ranked and sorted.", "FeatureSelector() also has a built-in method for visualizing the training and validation scores for each subset:", "Here we see the training and validation accuracy scores trended for each of our 4 RandomForestClassifier() models. Each chart header clearly informs us of the best validation accuracy score, as well as how many features were removed from the full feature set when achieving that score.", "Lastly, there are a couple of utilities within FeatureSelector() that help us summarize and utilize the results of our cross validation procedure.", "First, the method create_cross_val_features_df() presents a summary of the features used by each model when achieving its best validation score:", "Our features form the index of this DataFrame, and our estimators are represented as columns. At the intersection of each feature/estimator pair, an X indicates if that feature was used in the subset that achieved the best validation score. The \u201ccount\u201d column totals the number of estimators that used a feature, and the DataFrame is ranked descending on this column.", "Second, the method create_cross_val_features_df() compiles the best feature subsets for each model and returns the results in a dictionary. The estimators are the keys and the associated values are list containing the best feature subset for each estimator.", "This dictionary facilitates quick utilization of these feature subsets in the model training phase.", "mlmachine makes it easy to execute a wide variety of feature importance estimation techniques and facilitates a thorough winnowing process to determine an optimal feature subset for a variety of estimators.", "Check out the GitHub repository, and stay tuned for additional column entries.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Senior Director, Data Intelligence & Interoperability at Vizient, Inc"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F50cd2bbda1b7&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmlmachine-crowd-sourced-feature-selection-50cd2bbda1b7&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmlmachine-crowd-sourced-feature-selection-50cd2bbda1b7&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmlmachine-crowd-sourced-feature-selection-50cd2bbda1b7&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmlmachine-crowd-sourced-feature-selection-50cd2bbda1b7&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----50cd2bbda1b7--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----50cd2bbda1b7--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@petersontylerd?source=post_page-----50cd2bbda1b7--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@petersontylerd?source=post_page-----50cd2bbda1b7--------------------------------", "anchor_text": "Tyler Peterson"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fd34516b410ae&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmlmachine-crowd-sourced-feature-selection-50cd2bbda1b7&user=Tyler+Peterson&userId=d34516b410ae&source=post_page-d34516b410ae----50cd2bbda1b7---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F50cd2bbda1b7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmlmachine-crowd-sourced-feature-selection-50cd2bbda1b7&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F50cd2bbda1b7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmlmachine-crowd-sourced-feature-selection-50cd2bbda1b7&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://pixabay.com/users/qimono-1962238/?utm_source=link-attribution&amp;utm_medium=referral&amp;utm_campaign=image&amp;utm_content=1872665", "anchor_text": "Arek Socha"}, {"url": "https://pixabay.com/?utm_source=link-attribution&amp;utm_medium=referral&amp;utm_campaign=image&amp;utm_content=1872665", "anchor_text": "Pixabay"}, {"url": "https://github.com/petersontylerd/mlmachine/blob/master/notebooks/mlmachine_part_3.ipynb", "anchor_text": "Jupyter Notebook"}, {"url": "https://github.com/petersontylerd/mlmachine", "anchor_text": "project"}, {"url": "https://towardsdatascience.com/mlmachine-clean-ml-experiments-elegant-eda-pandas-pipelines-daba951dde0a", "anchor_text": "mlmachine - Clean ML Experiments, Elegant EDA & Pandas PipelinesThis new Python package accelerates notebook-based machine learning experimentationtowardsdatascience.com"}, {"url": "https://towardsdatascience.com/mlmachine-groupbyimputer-kfoldencoder-and-skew-correction-357f202d2212", "anchor_text": "mlmachine - GroupbyImputer, KFoldEncoder, and Skew CorrectionThis new Python package accelerates notebook-based machine learning experimentationtowardsdatascience.com"}, {"url": "https://github.com/petersontylerd/mlmachine", "anchor_text": "GitHub repository"}, {"url": "https://medium.com/tag/python?source=post_page-----50cd2bbda1b7---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/data-science?source=post_page-----50cd2bbda1b7---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----50cd2bbda1b7---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/mlmachine?source=post_page-----50cd2bbda1b7---------------mlmachine-----------------", "anchor_text": "Mlmachine"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F50cd2bbda1b7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmlmachine-crowd-sourced-feature-selection-50cd2bbda1b7&user=Tyler+Peterson&userId=d34516b410ae&source=-----50cd2bbda1b7---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F50cd2bbda1b7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmlmachine-crowd-sourced-feature-selection-50cd2bbda1b7&user=Tyler+Peterson&userId=d34516b410ae&source=-----50cd2bbda1b7---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F50cd2bbda1b7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmlmachine-crowd-sourced-feature-selection-50cd2bbda1b7&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----50cd2bbda1b7--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F50cd2bbda1b7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmlmachine-crowd-sourced-feature-selection-50cd2bbda1b7&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----50cd2bbda1b7---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----50cd2bbda1b7--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----50cd2bbda1b7--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----50cd2bbda1b7--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----50cd2bbda1b7--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----50cd2bbda1b7--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----50cd2bbda1b7--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----50cd2bbda1b7--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----50cd2bbda1b7--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@petersontylerd?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@petersontylerd?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Tyler Peterson"}, {"url": "https://medium.com/@petersontylerd/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "40 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fd34516b410ae&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmlmachine-crowd-sourced-feature-selection-50cd2bbda1b7&user=Tyler+Peterson&userId=d34516b410ae&source=post_page-d34516b410ae--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fusers%2Fd34516b410ae%2Flazily-enable-writer-subscription&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmlmachine-crowd-sourced-feature-selection-50cd2bbda1b7&user=Tyler+Peterson&userId=d34516b410ae&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}