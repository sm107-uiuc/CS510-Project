{"url": "https://towardsdatascience.com/foreground-image-segmentation-with-fgsegnet-9ecbe3d194ab", "time": 1683012529.9413571, "path": "towardsdatascience.com/foreground-image-segmentation-with-fgsegnet-9ecbe3d194ab/", "webpage": {"metadata": {"title": "Foreground Image Segmentation with FgSegNet | by Richard So | Towards Data Science", "h1": "Foreground Image Segmentation with FgSegNet", "description": "A tough challenge that remains to be solved robustly is foreground image segmentation (or background subtraction in a different perspective). The task may sound trivial: create a binary mask where\u2026"}, "outgoing_paragraph_urls": [{"url": "http://changedetection.net/", "anchor_text": "CDnet2014 dataset", "paragraph_index": 10}, {"url": "https://arxiv.org/abs/1801.02225", "anchor_text": "here", "paragraph_index": 12}, {"url": "https://arxiv.org/abs/1801.02225", "anchor_text": "Foreground Segmentation Using a Triplet Convolutional Neural Network for Multiscale Feature Encoding", "paragraph_index": 18}, {"url": "https://ieeexplore.ieee.org/document/784637", "anchor_text": "Adaptive Background Mixture Models for Real-Time Tracking", "paragraph_index": 19}, {"url": "https://sorichard.com", "anchor_text": "https://sorichard.com", "paragraph_index": 21}], "all_paragraphs": ["A tough challenge that remains to be solved robustly is foreground image segmentation (or background subtraction in a different perspective). The task may sound trivial: create a binary mask where only the pixels of a moving/important object are marked. However, this can become particularly difficult when real-world variabilities are introduced into the picture (no pun intended). For example, a truly robust image segmentation model must account for all the following:", "One of the first few approaches to this task which was reasonably robust (in its time) is statistical by nature. Specifically, it involved the use of multiple Gaussian models to map the distributions of each color\u2019s values (i.e. RGB), for each pixel of the input. If a pixel\u2019s color values did not match its Gaussian distributions in a particular frame, it could be determined that the pixel holds a foreground object. However, this method still was very susceptible to the above challenges, but was nonetheless a breakthrough for robust image segmentation in its time (1999) [2].", "Fast-forward to recent times, and now we have enough computing power and data for Convolutional Neural Networks (CNNs) and other complex models to operate rather accurately, let alone simple feedforward networks. Without surprise, there has been more deep learning-based methods of background subtraction right now than ever.", "We\u2019ll take a look at Foreground Segmentation Network, or FgSegNet, a recently proposed and top-performing neural network architecture which uses multiple CNNs and a Transposed CNN (TCNN) to achieve background subtraction. [1]", "FgSegNet uses 3 Convolutional Neural Networks (CNNs) and a single Transposed CNN (TCNN) within its architecture. Specifically, the architecture uses a pre-trained VGG-16 model for each of its CNN.", "As a recap, a CNN is widely used for image feature extraction and thus works well in image classification. The premise of how a convolution layer works within a CNN is via kernels (small 2D matrices with initialized, but changeable, values/weights) that trace through the image input and aggregates the products between values of the kernel and the corresponding input pixel. In other words, kernels convolve through the input as it operates, hence the C in CNNs. Convolutional layers are better understood when seen in action, so here\u2019s a sweet GIF of the kernel operation.", "So what\u2019s a Transposed CNN? Think of it as the exact opposite of what a CNN is supposed to do. A CNN naturally produces output that are generally smaller than its input; this is the reverse for TCNNs, since its kernels perform the reverse operation of that in CNNs.", "From the architecture diagram above, FgSegNet feeds the input into three CNNs first, concatenates the three outputs, and feeds that as an input to the TCNN. The final output is a binary mask.", "The paper calls FgSegNet an \u201cencoder-decoder type network model\u201d, and it\u2019s rightfully so. For starters, the architecture resembles that of an autoencoder: an input is first funneled/bottlenecked into a smaller feature map (encoding), then expanded back to its original shape by the end of the second half of the model (decoding). CNNs are encoders by nature too, since they extract features via their kernel operations. With that said, it would be also true to say that TCNNs (being the opposite of CNNs) would be decoders.", "I presume the point of having encoders in a task such as foreground extraction is to pinpoint the \u201cimportant\u201d features of the image frame that are subject to change, and use that condensed information to output a mask with the TCNN, to put it in layman\u2019s terms. Having 3 CNNs of different shapes working in parallel also supports this notion, and allows the model to be more versatile with different sizes of foreground objects.", "One prominent dataset for foreground extractor models is the CDnet2014 dataset. CDnet2014 includes 11 different challenging scenarios for the model (i.e. bad weather, camera jitter, night videos, etc.), each scenario containing 4 to 6 video sequences. The dataset includes ground-truth images/masks, marking all foreground objects and shadows for each frame. FgSegNet was tested on multiple image datasets, one of which is CDnet2014.", "FgSegNet was built using the Keras and Tensorflow frameworks. All of its layers (except the last) uses the ReLU activation layer, and multiple pooling layers of the VGG-16 CNNs are replaced with dropout layers instead. In addition to dropout, the model utilizes L2 weight regularization. RMSProp was used as the optimizer with a learning rate reducer, which activates when validation loss stops improving for 6 epochs. Finally, the model allows the choice to train with 50 or 200 image frames.", "To learn more about the implementation of the model, please follow here to read its paper.", "FgSegNet was among one of the best performing models during evaluation with the CDnet2014 dataset. When trained with 200 frames, the average F-score achieved was 0.9734 (score ranges from 0 [worse] to 1 [best]), and 0.9545 with 50 frames. Below is an example of the categories of scenarios, along with the ground-truths and the masks generated by the model.", "As you can see, the model-generated masks are quite impressive, especially for the three classes following baseline.", "On the left, you can find some instances where the model performed unexpectedly. However, these samples look quite troublesome even for a human to segment.", "Overall, FgSegNet is very impressive and is a great take on the foreground extraction task.", "If you\u2019d like to take a look, here\u2019s the github repo to the FgSegNet source code:", "[1] L. Ang Lim and H. Yalim Keles, Foreground Segmentation Using a Triplet Convolutional Neural Network for Multiscale Feature Encoding (2018), arXiv-1801.", "[2] C. Stauffer and W. E. L. Grimson, Adaptive Background Mixture Models for Real-Time Tracking (1999), IEEE Computer Society Conference.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "https://sorichard.com | CS @ Georgia Tech, Class of \u201924. Pursuing everything code. Always learning!"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F9ecbe3d194ab&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fforeground-image-segmentation-with-fgsegnet-9ecbe3d194ab&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fforeground-image-segmentation-with-fgsegnet-9ecbe3d194ab&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fforeground-image-segmentation-with-fgsegnet-9ecbe3d194ab&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fforeground-image-segmentation-with-fgsegnet-9ecbe3d194ab&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----9ecbe3d194ab--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----9ecbe3d194ab--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://richardso21.medium.com/?source=post_page-----9ecbe3d194ab--------------------------------", "anchor_text": ""}, {"url": "https://richardso21.medium.com/?source=post_page-----9ecbe3d194ab--------------------------------", "anchor_text": "Richard So"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F94b97ebc1395&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fforeground-image-segmentation-with-fgsegnet-9ecbe3d194ab&user=Richard+So&userId=94b97ebc1395&source=post_page-94b97ebc1395----9ecbe3d194ab---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F9ecbe3d194ab&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fforeground-image-segmentation-with-fgsegnet-9ecbe3d194ab&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F9ecbe3d194ab&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fforeground-image-segmentation-with-fgsegnet-9ecbe3d194ab&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "http://changedetection.net/", "anchor_text": "CDnet2014 dataset"}, {"url": "https://arxiv.org/abs/1801.02225", "anchor_text": "here"}, {"url": "https://github.com/lim-anggun/FgSegNet", "anchor_text": "lim-anggun/FgSegNetThis repository contains source codes and training sets for the following paper: \"Foreground Segmentation Using\u2026github.com"}, {"url": "https://arxiv.org/abs/1801.02225", "anchor_text": "Foreground Segmentation Using a Triplet Convolutional Neural Network for Multiscale Feature Encoding"}, {"url": "https://ieeexplore.ieee.org/document/784637", "anchor_text": "Adaptive Background Mixture Models for Real-Time Tracking"}, {"url": "https://arxiv.org/abs/1603.07285", "anchor_text": "A guide to convolution arithmetic for deep learning"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----9ecbe3d194ab---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----9ecbe3d194ab---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/towards-data-science?source=post_page-----9ecbe3d194ab---------------towards_data_science-----------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----9ecbe3d194ab---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/image?source=post_page-----9ecbe3d194ab---------------image-----------------", "anchor_text": "Image"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F9ecbe3d194ab&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fforeground-image-segmentation-with-fgsegnet-9ecbe3d194ab&user=Richard+So&userId=94b97ebc1395&source=-----9ecbe3d194ab---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F9ecbe3d194ab&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fforeground-image-segmentation-with-fgsegnet-9ecbe3d194ab&user=Richard+So&userId=94b97ebc1395&source=-----9ecbe3d194ab---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F9ecbe3d194ab&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fforeground-image-segmentation-with-fgsegnet-9ecbe3d194ab&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----9ecbe3d194ab--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F9ecbe3d194ab&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fforeground-image-segmentation-with-fgsegnet-9ecbe3d194ab&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----9ecbe3d194ab---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----9ecbe3d194ab--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----9ecbe3d194ab--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----9ecbe3d194ab--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----9ecbe3d194ab--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----9ecbe3d194ab--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----9ecbe3d194ab--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----9ecbe3d194ab--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----9ecbe3d194ab--------------------------------", "anchor_text": ""}, {"url": "https://richardso21.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://richardso21.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Richard So"}, {"url": "https://richardso21.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "966 Followers"}, {"url": "https://sorichard.com", "anchor_text": "https://sorichard.com"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F94b97ebc1395&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fforeground-image-segmentation-with-fgsegnet-9ecbe3d194ab&user=Richard+So&userId=94b97ebc1395&source=post_page-94b97ebc1395--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fd1d3caf01b63&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fforeground-image-segmentation-with-fgsegnet-9ecbe3d194ab&newsletterV3=94b97ebc1395&newsletterV3Id=d1d3caf01b63&user=Richard+So&userId=94b97ebc1395&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}