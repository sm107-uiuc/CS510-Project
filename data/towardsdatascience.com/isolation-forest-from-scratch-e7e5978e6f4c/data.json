{"url": "https://towardsdatascience.com/isolation-forest-from-scratch-e7e5978e6f4c", "time": 1683007857.6739259, "path": "towardsdatascience.com/isolation-forest-from-scratch-e7e5978e6f4c/", "webpage": {"metadata": {"title": "Isolation Forest from Scratch. Implementation of Isolation forest from\u2026 | by Carlos Mougan | Towards Data Science", "h1": "Isolation Forest from Scratch", "description": "Lately, I have been reading about Isolation Forest and its performance in outlier/anomaly detection. After carefully reading about the algorithm (and not finding any vanilla tutorial of my taste). I\u2026"}, "outgoing_paragraph_urls": [{"url": "https://cs.nju.edu.cn/zhouzh/zhouzh.files/publication/icdm08b.pdf?q=isolation-forest", "anchor_text": "Isolation forest for the pseudo-code", "paragraph_index": 2}, {"url": "https://arxiv.org/abs/1811.02141", "anchor_text": "Extended Isolation Forest paper for the visualizations", "paragraph_index": 2}, {"url": "https://towardsdatascience.com/outlier-detection-with-extended-isolation-forest-1e248a3fe97b", "anchor_text": "blog post", "paragraph_index": 2}, {"url": "https://github.com/SebastianMantey/Random-Forest-from-Scratch", "anchor_text": "Random Forest implementation", "paragraph_index": 2}, {"url": "https://www.youtube.com/channel/UCCtkE-r-0Mvp7PwAvxzSdvw", "anchor_text": "Sebastian Mantey", "paragraph_index": 2}, {"url": "https://cs.nju.edu.cn/zhouzh/zhouzh.files/publication/icdm08b.pdf?q=isolation-forest", "anchor_text": "Isolation forest", "paragraph_index": 18}, {"url": "https://arxiv.org/abs/1811.02141", "anchor_text": "Extended Isolation Forest,", "paragraph_index": 25}], "all_paragraphs": ["Lately, I have been reading about Isolation Forest and its performance in outlier/anomaly detection. After carefully reading about the algorithm (and not finding any vanilla tutorial of my taste). I decided to code it from scratch in the simplest possible way in order to grasp the algorithm better.", "The goal of this post is that after reading it you can understand Isolation Forest in-depth, its strength, weakness, parameters and you are able to use it whenever you consider with knowledge of the algorithm.", "For this blog/implementation, I have used this paper about Isolation forest for the pseudo-code, this Extended Isolation Forest paper for the visualizations (that corresponds with this other blog post) and using this youtube tutorial example of Random Forest implementation from Sebastian Mantey", "Before getting to the code I believe that there is the need for a bit of theory.", "This method isolates anomalies from normal instances, for doing this the following assumptions for anomalies are made:", "In other words, anomalies are \u201cfew and different.\u201d", "Because of these first two assumptions, anomalies are susceptible to be isolated and this makes them fall closer to the root of the tree.", "Isolation Forest builds an ensemble of Binary Trees for a given dataset. Anomalies, due to their nature, they have the shortest path in the trees than normal instances.", "Isolation Forest converges quickly with a very small number of trees and subsampling enables us to achieve good results while being computationally efficient.", "The overall code strategy will be the following. First coding a tree, then doing a forest of trees (ensembling) and finally measuring how far a certain instance goes in each tree and determining whether it is or not an outlier.", "The input will be a sample of the data, the current tree height, and the maximum depth.", "For the output, we will have a built tree.", "To make it easier to follow I am working with pandas data frames, even if it is not optimal in terms of performance, makes it easier to follow for regular users.", "The idea is the following: selecting a feature, a value of the feature, and splitting the data. If there is only one data point in the branch or the tree has reached the maximum depth: stop.", "Once we have our tree, we have to make a forest of them. The pseudo-code is the following:", "Given an input data, a number of trees and a sampling size (how many data is fed to each tree), we fit as many trees as desired and return a forest.", "After having built an Isolation Forest, we have to evaluate instances, for that we define Path Length", "Given an instance and an Isolation Tree, we compute how many nodes does each instance goes through before being isolated or reaching maximum depth.", "The pseudo code is extracted from Isolation forest paper.", "This is just counting how many nodes an instance goes through given how data has been stored before.", "Let\u2019s play a little bit around to see", "We will train and evaluate with our data.", "We select one normal instance of the data (selected at random) and an outlier (remember that we hardcoded an outlier at the beginning as the first row). we see how far in the tree does it fall and plot the results.", "In blue a random normal sample, in red an outlier.", "We can see that there is a visual and statistical difference between the normal sample and the outlier in how deep instance falls in each tree.", "From the paper of Extended Isolation Forest, there is another visualization in a radial form that provides a clear intuition of the outlier", "A more formal way to evaluate the forest is using the anomaly score (s) of an instance (x):", "Using this method we can get a mathematical definition of what is an outlier, but I believe that stopping here already allows you to have an intuition of how does the algorithm work, what are the parameters, and for which cases it might be successful.", "Feel free to drop any comments or to DM message me with suggestions or anything else.", "This blog has been done following", "The full code, notebook, and images can be seen in this repository", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fe7e5978e6f4c&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fisolation-forest-from-scratch-e7e5978e6f4c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fisolation-forest-from-scratch-e7e5978e6f4c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fisolation-forest-from-scratch-e7e5978e6f4c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fisolation-forest-from-scratch-e7e5978e6f4c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----e7e5978e6f4c--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----e7e5978e6f4c--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@carmougan?source=post_page-----e7e5978e6f4c--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@carmougan?source=post_page-----e7e5978e6f4c--------------------------------", "anchor_text": "Carlos Mougan"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fd5344df58d03&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fisolation-forest-from-scratch-e7e5978e6f4c&user=Carlos+Mougan&userId=d5344df58d03&source=post_page-d5344df58d03----e7e5978e6f4c---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe7e5978e6f4c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fisolation-forest-from-scratch-e7e5978e6f4c&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe7e5978e6f4c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fisolation-forest-from-scratch-e7e5978e6f4c&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://cs.nju.edu.cn/zhouzh/zhouzh.files/publication/icdm08b.pdf?q=isolation-forest", "anchor_text": "Isolation forest for the pseudo-code"}, {"url": "https://arxiv.org/abs/1811.02141", "anchor_text": "Extended Isolation Forest paper for the visualizations"}, {"url": "https://towardsdatascience.com/outlier-detection-with-extended-isolation-forest-1e248a3fe97b", "anchor_text": "blog post"}, {"url": "https://github.com/SebastianMantey/Random-Forest-from-Scratch", "anchor_text": "Random Forest implementation"}, {"url": "https://www.youtube.com/channel/UCCtkE-r-0Mvp7PwAvxzSdvw", "anchor_text": "Sebastian Mantey"}, {"url": "https://cs.nju.edu.cn/zhouzh/zhouzh.files/publication/icdm08b.pdf?q=isolation-forest", "anchor_text": "Isolation forest"}, {"url": "https://arxiv.org/abs/1811.02141", "anchor_text": "Extended Isolation Forest,"}, {"url": "https://cs.nju.edu.cn/zhouzh/zhouzh.files/publication/icdm08b.pdf?q=isolation-forest", "anchor_text": "Isolation forest paper for the pseudo-code"}, {"url": "https://arxiv.org/abs/1811.02141", "anchor_text": "Extended isolation forest"}, {"url": "https://towardsdatascience.com/outlier-detection-with-extended-isolation-forest-1e248a3fe97b", "anchor_text": "blog post"}, {"url": "https://github.com/SebastianMantey/Random-Forest-from-Scratch", "anchor_text": "Random Forest implementation"}, {"url": "https://www.youtube.com/channel/UCCtkE-r-0Mvp7PwAvxzSdvw", "anchor_text": "Sebastian Mantey"}, {"url": "https://github.com/cmougan/IsolationForest", "anchor_text": "cmougan/IsolationForestIsolation forest repository. Contribute to cmougan/IsolationForest development by creating an account on GitHub.github.com"}, {"url": "https://medium.com/tag/isolation-forests?source=post_page-----e7e5978e6f4c---------------isolation_forests-----------------", "anchor_text": "Isolation Forests"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----e7e5978e6f4c---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/unsupervised-learning?source=post_page-----e7e5978e6f4c---------------unsupervised_learning-----------------", "anchor_text": "Unsupervised Learning"}, {"url": "https://medium.com/tag/outliers?source=post_page-----e7e5978e6f4c---------------outliers-----------------", "anchor_text": "Outliers"}, {"url": "https://medium.com/tag/towards-data-science?source=post_page-----e7e5978e6f4c---------------towards_data_science-----------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fe7e5978e6f4c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fisolation-forest-from-scratch-e7e5978e6f4c&user=Carlos+Mougan&userId=d5344df58d03&source=-----e7e5978e6f4c---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fe7e5978e6f4c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fisolation-forest-from-scratch-e7e5978e6f4c&user=Carlos+Mougan&userId=d5344df58d03&source=-----e7e5978e6f4c---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe7e5978e6f4c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fisolation-forest-from-scratch-e7e5978e6f4c&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----e7e5978e6f4c--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fe7e5978e6f4c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fisolation-forest-from-scratch-e7e5978e6f4c&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----e7e5978e6f4c---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----e7e5978e6f4c--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----e7e5978e6f4c--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----e7e5978e6f4c--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----e7e5978e6f4c--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----e7e5978e6f4c--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----e7e5978e6f4c--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----e7e5978e6f4c--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----e7e5978e6f4c--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@carmougan?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@carmougan?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Carlos Mougan"}, {"url": "https://medium.com/@carmougan/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "84 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fd5344df58d03&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fisolation-forest-from-scratch-e7e5978e6f4c&user=Carlos+Mougan&userId=d5344df58d03&source=post_page-d5344df58d03--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fa3e30d558f9a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fisolation-forest-from-scratch-e7e5978e6f4c&newsletterV3=d5344df58d03&newsletterV3Id=a3e30d558f9a&user=Carlos+Mougan&userId=d5344df58d03&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}