{"url": "https://towardsdatascience.com/synthetic-instrumental-variables-968b12f68772", "time": 1683013691.4339788, "path": "towardsdatascience.com/synthetic-instrumental-variables-968b12f68772/", "webpage": {"metadata": {"title": "Synthetic Instrumental Variables. Causal Inference with Unmeasured\u2026 | by Wicaksono Wijono | Towards Data Science", "h1": "Synthetic Instrumental Variables", "description": "I love papers that make you go \u201cThis is obvious in hindsight. Why did nobody try it before?\u201d Some NLP folks made this remark about Transformers (\u201cAttention Is All You Need\u201d). To me, \u201cThe Blessings of\u2026"}, "outgoing_paragraph_urls": [{"url": "https://arxiv.org/pdf/1706.03762.pdf", "anchor_text": "Attention Is All You Need", "paragraph_index": 0}, {"url": "https://arxiv.org/pdf/1805.06826.pdf", "anchor_text": "The Blessings of Multiple Causes", "paragraph_index": 0}, {"url": "https://towardsdatascience.com/beyond-a-b-testing-primer-on-causal-inference-d8e462d90a0b", "anchor_text": "my previous article on causality", "paragraph_index": 1}, {"url": "https://stats.stackexchange.com/questions/2691/making-sense-of-principal-component-analysis-eigenvectors-eigenvalues", "anchor_text": "wonderful and intuitive explanation", "paragraph_index": 2}, {"url": "https://en.wikipedia.org/wiki/Instrumental_variables_estimation", "anchor_text": "Instrumental variables", "paragraph_index": 3}, {"url": "https://arxiv.org/pdf/1805.06826.pdf", "anchor_text": "The Blessings of Multiple Causes", "paragraph_index": 9}, {"url": "https://en.wikipedia.org/wiki/Factor_analysis", "anchor_text": "factor analysis", "paragraph_index": 21}, {"url": "https://www.math.mcgill.ca/dstephens/SISCER2020/Articles/HIrano-Imbens-2004.pdf", "anchor_text": "generalized propensity score", "paragraph_index": 22}, {"url": "https://en.wikipedia.org/wiki/Bias%E2%80%93variance_tradeoff", "anchor_text": "bias-variance tradeoff", "paragraph_index": 23}, {"url": "https://en.wikipedia.org/wiki/Occam%27s_razor", "anchor_text": "Occam\u2019s razor", "paragraph_index": 24}], "all_paragraphs": ["I love papers that make you go \u201cThis is obvious in hindsight. Why did nobody try it before?\u201d Some NLP folks made this remark about Transformers (\u201cAttention Is All You Need\u201d). To me, \u201cThe Blessings of Multiple Causes\u201d evokes a similar feeling: why didn\u2019t people create synthetic instruments?", "This article assumes basic familiarity with causal DAGs and causal inference. If you are unfamiliar with those terms, read the last third of my previous article on causality to get a brief overview.", "Additionally, while there are many ways of creating synthetic instruments, this article uses probabilistic PCA as it\u2019s one of the most generic methods. If you don\u2019t know much about PCA, I suggest reading this wonderful and intuitive explanation.", "Instrumental variables have been around for a long time and can be said to be one of the backbones of econometrics. We are concerned with this DAG:", "U is an unobserved confounder. We want to estimate the causal effect of Y on Z, Y \u2192 Z. By this DAG, we can estimate X \u2192 Y and X \u2192 Z. Assuming linearity, we have X \u2192 Z = (X \u2192 Y) (Y \u2192 Z) and we can solve for Y \u2192 Z algebraically.", "In this setup, we call X an instrumental variable if:", "In practice, finding an instrument is difficult. If X is only weakly correlated with Y, then the causal effect estimates can be severely biased. The second condition cannot be tested or verified, so we can only debate the reasonableness of assumptions, such as \u201cis mayonnaise an instrument?\u201d", "Innovation requires us to rethink existing approaches. The cleverness:", "If finding instruments is hard, why not create instruments?", "The original paper is titled \u201cThe Blessings of Multiple Causes\u201d because multiple causation is the necessary condition to create our own instruments. The DAG looks something like:", "We want to infer the causal effect of each Y on Z in the presence of a shared unobserved confounder U. Think of the Y\u2019s as the column names, predictors in the regression model. We assume no interference and no interaction \u2014 an oversimplification for sure, but pragmatic.", "This DAG looks restrictive, but it\u2019s reasonable enough for many real-world processes (refer to the paper for examples). More importantly, counter to intuition, the problem is much easier than the single case:", "This \u201csimpler\u201d DAG is impossible to solve. We can\u2019t get an unbiased estimate of the causal effect.", "Moreover, the problem assumes there is no unobserved single-cause confounder. The existence of an unobserved V can mess up our estimates:", "However, as the paper notes, assuming that no such V exists is a more comfortable assumption than ignorability. Most causal analysis using covariate adjustment assume that we have no unmeasured confounders at all. Here we assume some unmeasured common confounder, just no unmeasured single cause confounders.", "Now we will see why multiple causation is necessary. We want to create a common instrument X. This X is a local variable, i.e. each observation has a unique X vector (more on this in a minute).", "For example, we can fit PCA and select the first few principal components as our X. By construction, exclusion restriction is satisfied because the PCA does not use Z. We don\u2019t have to squabble over this assumption.", "However, if the PCA is trained using the entire dataset, we don\u2019t know whether or not X is a good instrument. We can get principal components out of random noise but X won\u2019t be a good predictor of Y. Furthermore, reusing the Y\u2019s to estimate both the instrument and causal effect is philosophically problematic and will lead to overfitting.", "One avenue of thought is to split the dataset into two, fit PCA on one half, and perform inference on the other half. This leads to a dead end. On unseen data (the second half), our best guess for each observation is X = the zero vector, which reduces to OLS regression. The whole point of figuring out new methodology is because we know OLS doesn\u2019t work.", "The paper approaches the problem by deleting random Y\u2019s for each observation (say, half). Classical PCA cannot handle missing values. Probabilistic PCA (PPCA), its Bayesian counterpart, handles missing values just fine.", "PCA models the y vector of each observation using y = Wx, where W is the weight matrix and x is the vector of latent variables. PPCA assumes the existence of a Gaussian error term \u03b5 such that y = Wx + \u03b5. The generative model:", "As \u03c3\u00b2 \u2192 0, we get PCA. And if we replace \u03c3\u00b2I with a diagonal matrix that allows the diagonal values to vary, we get factor analysis.", "If X has good predictive performance, then we have a valid instrument that\u2019s created synthetically from the Y\u2019s (specifically, in the case of PPCA, the residuals are the instruments). Alternatively, because of the probabilistic nature of X, we can then use generalized propensity score to fit a potential outcome model and obtain the causal effect estimates.", "Does this sound too good to be true? Perhaps. But the synthetic controls do come with a cost: the bias-variance tradeoff.", "The Bayesian model to create the synthetic instrument has its own estimation uncertainty, thus increasing the variance while eliminating bias. The authors suggest following Occam\u2019s razor. In the case of PPCA, each additional principal component increases variance, so we want to keep the fewest number of components that still results in \u201cgood\u201d predictive performance.", "While this article uses PPCA, latent variable models will generally work as long as they can handle missing values. For instance, PPCA is inappropriate for count data as it assumes Gaussian errors.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Bayesian data scientist. Alternates between light reading and more in-depth articles about applied statistics and machine learning."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F968b12f68772&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsynthetic-instrumental-variables-968b12f68772&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsynthetic-instrumental-variables-968b12f68772&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsynthetic-instrumental-variables-968b12f68772&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsynthetic-instrumental-variables-968b12f68772&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----968b12f68772--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----968b12f68772--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@wwijono?source=post_page-----968b12f68772--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@wwijono?source=post_page-----968b12f68772--------------------------------", "anchor_text": "Wicaksono Wijono"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F5e69e4814607&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsynthetic-instrumental-variables-968b12f68772&user=Wicaksono+Wijono&userId=5e69e4814607&source=post_page-5e69e4814607----968b12f68772---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F968b12f68772&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsynthetic-instrumental-variables-968b12f68772&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F968b12f68772&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsynthetic-instrumental-variables-968b12f68772&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://arxiv.org/pdf/1706.03762.pdf", "anchor_text": "Attention Is All You Need"}, {"url": "https://arxiv.org/pdf/1805.06826.pdf", "anchor_text": "The Blessings of Multiple Causes"}, {"url": "https://towardsdatascience.com/beyond-a-b-testing-primer-on-causal-inference-d8e462d90a0b", "anchor_text": "my previous article on causality"}, {"url": "https://stats.stackexchange.com/questions/2691/making-sense-of-principal-component-analysis-eigenvectors-eigenvalues", "anchor_text": "wonderful and intuitive explanation"}, {"url": "https://en.wikipedia.org/wiki/Instrumental_variables_estimation", "anchor_text": "Instrumental variables"}, {"url": "https://pxhere.com/en/photo/1620864", "anchor_text": "Maria Polna"}, {"url": "https://arxiv.org/pdf/1805.06826.pdf", "anchor_text": "The Blessings of Multiple Causes"}, {"url": "https://en.wikipedia.org/wiki/Factor_analysis", "anchor_text": "factor analysis"}, {"url": "https://www.math.mcgill.ca/dstephens/SISCER2020/Articles/HIrano-Imbens-2004.pdf", "anchor_text": "generalized propensity score"}, {"url": "https://en.wikipedia.org/wiki/Bias%E2%80%93variance_tradeoff", "anchor_text": "bias-variance tradeoff"}, {"url": "https://en.wikipedia.org/wiki/Occam%27s_razor", "anchor_text": "Occam\u2019s razor"}, {"url": "https://medium.com/tag/data-science?source=post_page-----968b12f68772---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/statistics?source=post_page-----968b12f68772---------------statistics-----------------", "anchor_text": "Statistics"}, {"url": "https://medium.com/tag/causality?source=post_page-----968b12f68772---------------causality-----------------", "anchor_text": "Causality"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----968b12f68772---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/analytics?source=post_page-----968b12f68772---------------analytics-----------------", "anchor_text": "Analytics"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F968b12f68772&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsynthetic-instrumental-variables-968b12f68772&user=Wicaksono+Wijono&userId=5e69e4814607&source=-----968b12f68772---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F968b12f68772&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsynthetic-instrumental-variables-968b12f68772&user=Wicaksono+Wijono&userId=5e69e4814607&source=-----968b12f68772---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F968b12f68772&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsynthetic-instrumental-variables-968b12f68772&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----968b12f68772--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F968b12f68772&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsynthetic-instrumental-variables-968b12f68772&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----968b12f68772---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----968b12f68772--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----968b12f68772--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----968b12f68772--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----968b12f68772--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----968b12f68772--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----968b12f68772--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----968b12f68772--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----968b12f68772--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@wwijono?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@wwijono?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Wicaksono Wijono"}, {"url": "https://medium.com/@wwijono/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "785 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F5e69e4814607&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsynthetic-instrumental-variables-968b12f68772&user=Wicaksono+Wijono&userId=5e69e4814607&source=post_page-5e69e4814607--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fd2f99368ce0a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsynthetic-instrumental-variables-968b12f68772&newsletterV3=5e69e4814607&newsletterV3Id=d2f99368ce0a&user=Wicaksono+Wijono&userId=5e69e4814607&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}