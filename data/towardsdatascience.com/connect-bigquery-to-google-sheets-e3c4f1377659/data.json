{"url": "https://towardsdatascience.com/connect-bigquery-to-google-sheets-e3c4f1377659", "time": 1683003024.362729, "path": "towardsdatascience.com/connect-bigquery-to-google-sheets-e3c4f1377659/", "webpage": {"metadata": {"title": "Connect BigQuery to Google Sheets | by Richard Peterson | Towards Data Science", "h1": "Connect BigQuery to Google Sheets", "description": "One of my friends is the president of a non-profit that is (thankfully) experiencing growing pains. A group of electrical and mechanical engineers in their early 20s hatched a plan to attach solar\u2026"}, "outgoing_paragraph_urls": [{"url": "https://globaldatalab.org/shdi/", "anchor_text": "UN Human Development Report \u2014 Subnational Indexes", "paragraph_index": 4}, {"url": "https://data.worldbank.org/indicator/NY.GDP.MKTP.CD", "anchor_text": "GDP data from the World Bank", "paragraph_index": 15}], "all_paragraphs": ["One of my friends is the president of a non-profit that is (thankfully) experiencing growing pains. A group of electrical and mechanical engineers in their early 20s hatched a plan to attach solar panels to schools in Uganda, and hard work and generous donations have fueled success that has lead to larger plans. But, alas, their data was scattered between different Drive accounts in the form of Google Sheets, and understanding their impact or visualizing their future was impossible with the data in its current state. I was lucky enough to get involved in the organization through my friend, who complained about how their data collection sucked, and they were trying to gather all their information into a database. Being an academic data scientist pursuing a Master\u2019s in Public Policy, I couldn\u2019t believe they had such valuable data as school-level data for student health and education before and after the installation of solar panels on schools in rural Uganda, and begged to lend a hand.", "Over donuts and coffee in an apartment conference room, I witnessed firsthand the least tidy data set imaginable. Production and solar panel part tables lived in one person\u2019s drive, school surveys and installation procedures lived in another. They did not even know where all the data was.", "The first step was gathering all the data in one place. We agreed to meet in 2 weeks with all the data in one location, and I would handle the cloud integration. What they wanted was very simple: query multiple sheets using SQL syntax. I gave a slick presentation showing a prototype of a dash website with SQL database to generate reports, but that went out the window when I asked \u201cHow will the data be updated?\u201d and they responded, \u201cWe will copy and paste to a Google Sheet.\u201d It was immediately apparent to me that I was the only person in the room with SQL or cloud engineering knowledge, but rather than being an advantage, this was a liability to the non-profit, as it could not afford to ever lose access to the database in lieu of my absence or disengagement.", "Due to the fact that the database would be randomly accessed and updated via Google Sheets, I decided to hold off on the Airflow + SQL + Flask app I originally had in mind for this database project. Due to budget constraints and the reluctance of the organization to set up a complicated cloud process, I would need to build something native in Google that was cheap and easy. BigQuery and Data Studio immediately jumped out at me.", "Before the next meeting, I wanted to have a prototype of what BigQuery could do for their organization, and decided to use UN Human Development Report \u2014 Subnational Indexes to build a mock database.", "In the Google Cloud Platform, create a New Project. I have chosen \u201cHDR-SubnatIndex\u201d as my project name.", "Next, enable the Sheets API for your new project. Notice that my project at the top is HDR-SubnatIndex.", "Navigate to the BigQuery Console and select CREATE DATASET.", "Give your dataset a name and configure expiration and encryption. Click Create Dataset.", "Find the sheet that you would like to connect to BigQuery and copy its shareable link.", "Select your new dataset under your project in the bottom left, and then select CREATE TABLE.", "Select Create table from: Drive, paste the entire Sheets URI into Select Drive URI, select CSV (I\u2019ve noticed some issues with selecting Google Sheet where it does not recognize the column names), input Table Name, and in this case, we can auto detect schema and parameters.", "The beauty of BigQuery is its ability to execute SQL queries on ANYTHING. To make sure the connection to the sheet has been properly allowed, run a test query. Here I select the top 10 rows of the dataset.", "Now let\u2019s run a slightly more advanced query that pulls subnational data for region, year, health index, income index, and education index for Uganda only.", "But this is all information that could be easily gleaned from filters applied in Google Sheets, right? The benefit of this approach is that you now have a query you can save and run at any time without having to copy the dataset and recreate the filter steps. Where BigQuery truly stands out, however, is in its ability to execute JOINS between multiple Sheets.", "I followed the same steps above to add a second BigQuery table from a google sheet in my google drive that contains GDP data from the World Bank. Combining these two datasets using Google Sheets and linking them would be much more difficult without the aid of BigQuery and SQL JOINS. Here I have queried both tables to create a report of each country\u2019s yearly National Human Development Index and GDP.", "This is an important comparison to make when analyzing multi-dimensional poverty, as Gross Domestic Product (GDP) does not tell the full story. The UN Human Development Report established the Human Development Index to take into account variables such as health, education, life expectancy, mean years of schooling, expected years of schooling, and population, which gives a much more dynamic understanding of a particular\u2019s country\u2019s needs or type of poverty experienced.", "Your BigQuery dataset is essentially an abstraction above your Sheets that allows you to run SQL queries on multiple sources of data housed in dynamic Sheets. Now you have a query that you can save and run whenever needed or export to Data Studio by clicking Explore Data. Also, from Data Studio, you can create a report and use this same query on your BigQuery dataset as your data source for the report.", "Now that you have seen the power of BigQuery to collect data from google sheets and standardize reporting, let\u2019s try to speed up that query, shall we? Google BI Engine is essentially purchasing accelerated compute resources for a project.", "On the left side of the BigQuery console, select BI Engine. Enable it, if needed. Select CREATE RESERVATION. Select the region where the resource will be located. We will be using less than 1 GB of storage with our small queries.", "You will now see your new BI Engine listed under BI Engines. After running the same query, we only saw a decrease in time of 2.3 seconds. But where BI Engine truly shines is in Google Data Studio, with noticeably faster updates while you play with charts to find the perfect way to visualize your analysis.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "SQL CSI by day and Northwestern University Master\u2019s in Public Policy Student by night"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fe3c4f1377659&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fconnect-bigquery-to-google-sheets-e3c4f1377659&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fconnect-bigquery-to-google-sheets-e3c4f1377659&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fconnect-bigquery-to-google-sheets-e3c4f1377659&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fconnect-bigquery-to-google-sheets-e3c4f1377659&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----e3c4f1377659--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----e3c4f1377659--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://desertdata.medium.com/?source=post_page-----e3c4f1377659--------------------------------", "anchor_text": ""}, {"url": "https://desertdata.medium.com/?source=post_page-----e3c4f1377659--------------------------------", "anchor_text": "Richard Peterson"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F11303b53d014&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fconnect-bigquery-to-google-sheets-e3c4f1377659&user=Richard+Peterson&userId=11303b53d014&source=post_page-11303b53d014----e3c4f1377659---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe3c4f1377659&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fconnect-bigquery-to-google-sheets-e3c4f1377659&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe3c4f1377659&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fconnect-bigquery-to-google-sheets-e3c4f1377659&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://cloud.google.com/blog/products/gcp/how-to-crunch-your-business-data-from-sheets-in-bigquery", "anchor_text": "Google blog post"}, {"url": "https://unsplash.com/@linusmimietz?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Linus Mimietz"}, {"url": "https://unsplash.com/s/photos/flags?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://globaldatalab.org/shdi/", "anchor_text": "UN Human Development Report \u2014 Subnational Indexes"}, {"url": "https://data.worldbank.org/indicator/NY.GDP.MKTP.CD", "anchor_text": "GDP data from the World Bank"}, {"url": "https://medium.com/tag/bigquery?source=post_page-----e3c4f1377659---------------bigquery-----------------", "anchor_text": "Bigquery"}, {"url": "https://medium.com/tag/google-cloud-platform?source=post_page-----e3c4f1377659---------------google_cloud_platform-----------------", "anchor_text": "Google Cloud Platform"}, {"url": "https://medium.com/tag/google-sheets?source=post_page-----e3c4f1377659---------------google_sheets-----------------", "anchor_text": "Google Sheets"}, {"url": "https://medium.com/tag/sql?source=post_page-----e3c4f1377659---------------sql-----------------", "anchor_text": "Sql"}, {"url": "https://medium.com/tag/public-data?source=post_page-----e3c4f1377659---------------public_data-----------------", "anchor_text": "Public Data"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fe3c4f1377659&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fconnect-bigquery-to-google-sheets-e3c4f1377659&user=Richard+Peterson&userId=11303b53d014&source=-----e3c4f1377659---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fe3c4f1377659&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fconnect-bigquery-to-google-sheets-e3c4f1377659&user=Richard+Peterson&userId=11303b53d014&source=-----e3c4f1377659---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe3c4f1377659&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fconnect-bigquery-to-google-sheets-e3c4f1377659&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----e3c4f1377659--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fe3c4f1377659&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fconnect-bigquery-to-google-sheets-e3c4f1377659&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----e3c4f1377659---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----e3c4f1377659--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----e3c4f1377659--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----e3c4f1377659--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----e3c4f1377659--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----e3c4f1377659--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----e3c4f1377659--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----e3c4f1377659--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----e3c4f1377659--------------------------------", "anchor_text": ""}, {"url": "https://desertdata.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://desertdata.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Richard Peterson"}, {"url": "https://desertdata.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "557 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F11303b53d014&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fconnect-bigquery-to-google-sheets-e3c4f1377659&user=Richard+Peterson&userId=11303b53d014&source=post_page-11303b53d014--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F28110602750b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fconnect-bigquery-to-google-sheets-e3c4f1377659&newsletterV3=11303b53d014&newsletterV3Id=28110602750b&user=Richard+Peterson&userId=11303b53d014&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}