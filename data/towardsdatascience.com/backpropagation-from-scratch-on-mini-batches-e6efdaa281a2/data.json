{"url": "https://towardsdatascience.com/backpropagation-from-scratch-on-mini-batches-e6efdaa281a2", "time": 1683006059.52747, "path": "towardsdatascience.com/backpropagation-from-scratch-on-mini-batches-e6efdaa281a2/", "webpage": {"metadata": {"title": "Backpropagation from scratch on Mini-Batches | by Aayush Bajaj | Towards Data Science", "h1": "Backpropagation from scratch on Mini-Batches", "description": "You must be thinking, another Backprop from scratch blog? Well kinda yes but I thought this through and came up with something that you can use to tinker around along with easy to understand\u2026"}, "outgoing_paragraph_urls": [{"url": "https://github.com/theAayushbajaj/Backpropagation_MiniBatches", "anchor_text": "here", "paragraph_index": 13}], "all_paragraphs": ["You must be thinking, another Backprop from scratch blog? Well kinda yes but I thought this through and came up with something that you can use to tinker around along with easy to understand equations that you usually write down to understand the algorithm.", "This blog will focus on implementing the Backpropagation algorithm step-by-step on mini-batches of the dataset. There are plenty of tutorials and blogs to demonstrate the backpropagation algorithm in detail and all the logic behind calculus and algebra happening. So I\u2019ll skip that part and cut to equations in math and implementation using Python (coz why not).", "This has been a long time community question as to why we should implement an algorithm from scratch even if it\u2019s been readily available to put to use by almost all frameworks. Evidently while using certain high-level frameworks you can\u2019t even notice backpropagation doing its magic. To understand it upside down, in and out completely you should once try to make your hands dirty with this stuff. Backpropagation is something on which experimentation can be done while playing around.", "The reason behind mini-batches is simple. It saves memory and processing time by dividing data into mini-batches and supply the algorithm a fraction of the dataset on each iteration of the training loop. Feeding a 10000x10000 matrix at once would not only blow up memory but would take a long time to run. Instead, bringing it down to 50 per iteration would not only reduce memory usage but you can track progress.", "Note- This is different from the stochastic method where we take a stratified sample from data for each class and train on that assuming the model would generalize.", "This is the head of the data I\u2019ll be using for this implementation.", "The target variable here is Occupancy which is a categorical variable (0/1). This will be the architecture we\u2019ll be coding.", "3. Gradient Descent and weight update step:", "As previously mentioned this will be a 3-layer network. We are keeping the number of layers concise in order to identify the gradient and error equations in a much better and easy way.After this, we\u2019ll define a function that will be used as a forwarding propagator in the network.", "One thing to note here is I\u2019ve considered the Input layer to be my 0th layer. There may be other blogs/tutorials where it's considered as 1st. So it's absolutely your choice to index how you want.", "So, now after initializing weights and biases and defining a forward propagation function, we\u2019ll define the backpropagation function on mini-batches of size= Size-of-dataset/N. You can tweak N to adjust your desired batch size.", "Let\u2019s break it down loop by loop", "This is it!! You\u2019ve finally completed the implementation of mini-batch backpropagation by yourself. One thing to note here is I\u2019ve used a matrix variable for each layer in the network, this is kind of a dumb move when your network grows in size but again this was done only to understand how the thing actually works. If you want to increase the number of Hidden Layers you can simply use 3d matrices for your error and gradient calculations in which the 3rd dimension would hold the layer values. Eg. dim(\u0394) = (2,3,2) which will signify that you are calculating the gradient for W(2,3) in the 2nd hidden layer.Also, I\u2019m working on one with Bayesian initialization and hopefully come with such kind of blog soon.", "Edit: You can find the used dataset along with ipython notebook in the Github repo here.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "ML Engineer who writes about how machines will take over the world."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fe6efdaa281a2&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbackpropagation-from-scratch-on-mini-batches-e6efdaa281a2&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbackpropagation-from-scratch-on-mini-batches-e6efdaa281a2&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbackpropagation-from-scratch-on-mini-batches-e6efdaa281a2&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbackpropagation-from-scratch-on-mini-batches-e6efdaa281a2&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----e6efdaa281a2--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----e6efdaa281a2--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@theAayushbajaj?source=post_page-----e6efdaa281a2--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@theAayushbajaj?source=post_page-----e6efdaa281a2--------------------------------", "anchor_text": "Aayush Bajaj"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F1fe2e9ea371d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbackpropagation-from-scratch-on-mini-batches-e6efdaa281a2&user=Aayush+Bajaj&userId=1fe2e9ea371d&source=post_page-1fe2e9ea371d----e6efdaa281a2---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe6efdaa281a2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbackpropagation-from-scratch-on-mini-batches-e6efdaa281a2&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe6efdaa281a2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbackpropagation-from-scratch-on-mini-batches-e6efdaa281a2&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@foustinthehouse?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "john foust"}, {"url": "https://unsplash.com/s/photos/conveyerbelt?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://github.com/theAayushbajaj/Backpropagation_MiniBatches", "anchor_text": "here"}, {"url": "https://medium.com/tag/neural-networks?source=post_page-----e6efdaa281a2---------------neural_networks-----------------", "anchor_text": "Neural Networks"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----e6efdaa281a2---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/backpropagation?source=post_page-----e6efdaa281a2---------------backpropagation-----------------", "anchor_text": "Backpropagation"}, {"url": "https://medium.com/tag/python?source=post_page-----e6efdaa281a2---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----e6efdaa281a2---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fe6efdaa281a2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbackpropagation-from-scratch-on-mini-batches-e6efdaa281a2&user=Aayush+Bajaj&userId=1fe2e9ea371d&source=-----e6efdaa281a2---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fe6efdaa281a2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbackpropagation-from-scratch-on-mini-batches-e6efdaa281a2&user=Aayush+Bajaj&userId=1fe2e9ea371d&source=-----e6efdaa281a2---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe6efdaa281a2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbackpropagation-from-scratch-on-mini-batches-e6efdaa281a2&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----e6efdaa281a2--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fe6efdaa281a2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbackpropagation-from-scratch-on-mini-batches-e6efdaa281a2&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----e6efdaa281a2---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----e6efdaa281a2--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----e6efdaa281a2--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----e6efdaa281a2--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----e6efdaa281a2--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----e6efdaa281a2--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----e6efdaa281a2--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----e6efdaa281a2--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----e6efdaa281a2--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@theAayushbajaj?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@theAayushbajaj?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Aayush Bajaj"}, {"url": "https://medium.com/@theAayushbajaj/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "53 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F1fe2e9ea371d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbackpropagation-from-scratch-on-mini-batches-e6efdaa281a2&user=Aayush+Bajaj&userId=1fe2e9ea371d&source=post_page-1fe2e9ea371d--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F4b4b4603f627&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbackpropagation-from-scratch-on-mini-batches-e6efdaa281a2&newsletterV3=1fe2e9ea371d&newsletterV3Id=4b4b4603f627&user=Aayush+Bajaj&userId=1fe2e9ea371d&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}