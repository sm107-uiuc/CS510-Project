{"url": "https://towardsdatascience.com/loading-csv-data-into-azure-synapse-analytics-by-using-polybase-5ae942ce3059", "time": 1683016299.8336399, "path": "towardsdatascience.com/loading-csv-data-into-azure-synapse-analytics-by-using-polybase-5ae942ce3059/", "webpage": {"metadata": {"title": "Loading CSV data into Azure Synapse Analytics by using PolyBase | by Dhyanendra Singh Rathore | Towards Data Science", "h1": "Loading CSV data into Azure Synapse Analytics by using PolyBase", "description": "Building an Azure Functions App to return JSON results from Azure Synapse Analytics with Node.js"}, "outgoing_paragraph_urls": [{"url": "https://portal.azure.com/", "anchor_text": "Azure Portal", "paragraph_index": 6}, {"url": "https://raw.githubusercontent.com/CSSEGISandData/COVID-19/master/csse_covid_19_data/UID_ISO_FIPS_LookUp_Table.csv", "anchor_text": "here", "paragraph_index": 15}, {"url": "https://www.linkedin.com/in/dhyans/", "anchor_text": "LinkedIn", "paragraph_index": 28}, {"url": "https://dhyanintech.medium.com/membership", "anchor_text": "Medium", "paragraph_index": 28}], "all_paragraphs": ["Azure Synapse Analytics SQL pool supports various data loading methods. The fastest and most scalable way to load data is through PolyBase. PolyBase is a data virtualization technology that can access external data stored in Hadoop or Azure Data Lake Storage via the T-SQL language.", "PolyBase shifts the data loading paradigm from ETL to ELT. The data is first loaded into a staging table followed by the transformation steps and finally loaded into the production tables.", "In this article, we load a CSV file from an Azure Data Lake Storage Gen2 account to an Azure Synapse Analytics data warehouse by using PolyBase. We will look at the detailed steps to carry out the loading procedure.", "Caution: Microsoft Azure is a paid service, and following this article can cause financial liability to you or your organization.", "To use PolyBase, you need to define external tables in your SQL pool before loading. PolyBase uses external tables to define and access the data from the Azure storage. The external table contains the table schema and points to data that is stored outside the SQL pool. Defining external tables involves specifying three objects: data source, the format of the text files, and the table definitions.", "External tables are in-memory tables that don\u2019t persist onto the physical disk. External tables can be queried like any other table.", "The external data source object provides the connection information required to connect to the external data source itself, in our case, the ADLS account. Let\u2019s begin by collecting the URL and the access key. Sign in to the Azure Portal, and navigate to your storage account. Click on Access Keys and copy the Key and the Storage account name to a notepad.", "The next step is to create a database scoped credential to secure the credentials to the ADLS account. Create a database master key if one does not already exist, and then encrypt the database-scoped credential named ADLS_Credential using the master key.", "The database master key is used to encrypt the private keys of certificates and keys that are present in the database.", "A database scoped credential contains the authentication information required to connect to an external resource.", "You can run the below T-SQL statements in SSMS or a tool of your choice or Query editor (preview) from the Common Tasks section of your Synapse instance in the Azure portal. Replace the storage account name, storage account key, and password accordingly.", "Follow our article for instructions on how to connect and access Azure Synapse Analytics from SSMS:", "Further reading on the database master key and the database scoped credentials:", "Use the database-scoped credential to create an external data source named AzureStorage. The location URL point to the container named csvstore in the ADLS Gen2 account. The type Hadoop is used for both Hadoop-based and Azure Blob storage-based external sources. Modify the location to refer to your storage account and the container.", "Further reading on creating external data source:", "The external file format object contains how the data in a file is structured and defines how rows are defined and what column separators are used. Run the below query to define the external file format named csvFile. For this exercise, we\u2019re using a CSV file available here. This file has 4,167 data rows and a header row.", "FORMAT_TYPE indicates to PolyBase that the format of the text file is DelimitedText. FIELD_TERMINATOR specifies column separator. STRING_DELIMITER specifies the field terminator for string type data. FIRST_ROW specifies the row number that is read first during the PolyBase load. If the value is set to two, the header row is skipped when the data is loaded. USE_TYPE_DEFAULT specifies how to handle missing values; FALSE means store all missing values as NULL. ENCODING specifies the encoding of the external file.", "Further reading on creating an external file format:", "The external table object uses the external data source and external file format objects to define the external table structure within Azure Synapse Analytics. You can then use the external table as a basis for loading data into your data warehouse.", "Create an external table named dbo.FIPSLOOKUP_EXT with the column definition corresponding to your CSV file. Use a WITH clause to call the external data source definition (AzureStorage) and the external file format (csvFile) we created in the previous steps. The location denotes that the file to load is in the root folder of the data source.", "Run the query and refresh the Object Explorer in SSMS. At this point, we can see all the three external objects we have created so far.", "Let\u2019s run a quick SELECT query to see the data from our external table and test our external objects.", "Further reading on creating an external table:", "We have set up our PolyBase correctly; however, the data is not yet physically stored in our data warehouse. The data still exists only in the ADLS account. We need to load this data into a physical table to persist in our data warehouse physically.", "Create a physical table in the Azure Synapse Analytics. The table will have a clustered column store index defined on all the columns with a round-robin table geometry because round-robin is the best table geometry to use for loading the data.", "Let\u2019s quickly examine the number of rows loaded into the physical table. The total number of rows loaded is 4,167, meaning none of the rows were discarded during the load.", "That\u2019s all, folks. You\u2019ve successfully loaded a CSV file into your Azure Synapse Analytics data warehouse using PolyBase. If you need to transform or cleanse the data you\u2019ve just loaded, the best spot to do it is to introduce the cleansing and transformation query during the load from the external table to the physical table. This is the ETL to ELT paradigm shift enabled by the PolyBase we discussed earlier.", "We loaded CSV data into our Azure Synapse Analytics data warehouse by using PolyBase. We created three external objects and loaded a file stored in ADLS Gen2 account to a physical data table.", "Let\u2019s be friends! You can find me on LinkedIn or join me on Medium.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Analytics Expert. Data and BI Professional. Owner of Everyday BI. Private consultation - dhyan.singh@everydaybi.com"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F5ae942ce3059&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Floading-csv-data-into-azure-synapse-analytics-by-using-polybase-5ae942ce3059&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Floading-csv-data-into-azure-synapse-analytics-by-using-polybase-5ae942ce3059&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Floading-csv-data-into-azure-synapse-analytics-by-using-polybase-5ae942ce3059&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Floading-csv-data-into-azure-synapse-analytics-by-using-polybase-5ae942ce3059&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----5ae942ce3059--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----5ae942ce3059--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://dhyanintech.medium.com/?source=post_page-----5ae942ce3059--------------------------------", "anchor_text": ""}, {"url": "https://dhyanintech.medium.com/?source=post_page-----5ae942ce3059--------------------------------", "anchor_text": "Dhyanendra Singh Rathore"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fb038ca7c0471&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Floading-csv-data-into-azure-synapse-analytics-by-using-polybase-5ae942ce3059&user=Dhyanendra+Singh+Rathore&userId=b038ca7c0471&source=post_page-b038ca7c0471----5ae942ce3059---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F5ae942ce3059&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Floading-csv-data-into-azure-synapse-analytics-by-using-polybase-5ae942ce3059&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F5ae942ce3059&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Floading-csv-data-into-azure-synapse-analytics-by-using-polybase-5ae942ce3059&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://towardsdatascience.com/tagged/making-sense-of-big-data", "anchor_text": "Making Sense of Big Data"}, {"url": "https://unsplash.com/@markuswinkler?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Markus Winkler"}, {"url": "https://unsplash.com/photos/tzfD-clzUTU?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://dhyanintech.medium.com/disclaimer-disclosure-terms-of-use-fb3bfbd1e0e5", "anchor_text": "https://dhyanintech.medium.com/disclaimer-disclosure-terms-of-use-fb3bfbd1e0e5"}, {"url": "https://portal.azure.com/", "anchor_text": "Azure Portal"}, {"url": "https://medium.com/swlh/a-credential-safe-way-to-connect-and-access-azure-synapse-analytics-in-azure-databricks-1b008839590a", "anchor_text": "A Credential-Safe Way to Connect and Access Azure Synapse Analytics in Azure DatabricksA guide on how to setup SQL Server firewall and connect from Databricks using Secret Scopes in PySpark.medium.com"}, {"url": "https://docs.microsoft.com/en-us/sql/t-sql/statements/create-master-key-transact-sql", "anchor_text": "CREATE MASTER KEY (Transact-SQL) - SQL ServerApplies to: SQL Server (all supported versions) Azure SQL Database Azure SQL Managed Instance Azure Synapse Analytics\u2026docs.microsoft.com"}, {"url": "https://docs.microsoft.com/en-us/sql/t-sql/statements/create-database-scoped-credential-transact-sql", "anchor_text": "CREATE DATABASE SCOPED CREDENTIAL (Transact-SQL) - SQL ServerApplies to: SQL Server (all supported versions) Azure SQL Database Azure SQL Managed Instance Azure Synapse Analytics\u2026docs.microsoft.com"}, {"url": "https://docs.microsoft.com/en-us/sql/t-sql/statements/create-external-data-source-transact-sql?view=azure-sqldw-latest&tabs=dedicated", "anchor_text": "CREATE EXTERNAL DATA SOURCE (Transact-SQL) - SQL ServerCreates an external data source for querying using SQL Server, SQL Database, Azure Synapse Analytics, or Analytics\u2026docs.microsoft.com"}, {"url": "https://raw.githubusercontent.com/CSSEGISandData/COVID-19/master/csse_covid_19_data/UID_ISO_FIPS_LookUp_Table.csv", "anchor_text": "here"}, {"url": "https://docs.microsoft.com/en-us/sql/t-sql/statements/create-external-file-format-transact-sql?view=azure-sqldw-latest&tabs=delimited", "anchor_text": "CREATE EXTERNAL FILE FORMAT (Transact-SQL) - SQL ServerApplies to: SQL Server 2016 (13.x) and later Azure SQL Managed Instance Azure Synapse Analytics Parallel Data Warehouse\u2026docs.microsoft.com"}, {"url": "https://docs.microsoft.com/en-us/sql/t-sql/statements/create-external-table-transact-sql?view=azure-sqldw-latest", "anchor_text": "CREATE EXTERNAL TABLE (Transact-SQL) - SQL ServerCreates an external table This article provides the syntax, arguments, remarks, permissions, and examples for whichever\u2026docs.microsoft.com"}, {"url": "https://www.linkedin.com/in/dhyans/", "anchor_text": "LinkedIn"}, {"url": "https://dhyanintech.medium.com/membership", "anchor_text": "Medium"}, {"url": "https://medium.com/tag/polybase?source=post_page-----5ae942ce3059---------------polybase-----------------", "anchor_text": "Polybase"}, {"url": "https://medium.com/tag/t-sql?source=post_page-----5ae942ce3059---------------t_sql-----------------", "anchor_text": "T Sql"}, {"url": "https://medium.com/tag/csv-import?source=post_page-----5ae942ce3059---------------csv_import-----------------", "anchor_text": "Csv Import"}, {"url": "https://medium.com/tag/azure-synapse-analytics?source=post_page-----5ae942ce3059---------------azure_synapse_analytics-----------------", "anchor_text": "Azure Synapse Analytics"}, {"url": "https://medium.com/tag/making-sense-of-big-data?source=post_page-----5ae942ce3059---------------making_sense_of_big_data-----------------", "anchor_text": "Making Sense Of Big Data"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F5ae942ce3059&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Floading-csv-data-into-azure-synapse-analytics-by-using-polybase-5ae942ce3059&user=Dhyanendra+Singh+Rathore&userId=b038ca7c0471&source=-----5ae942ce3059---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F5ae942ce3059&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Floading-csv-data-into-azure-synapse-analytics-by-using-polybase-5ae942ce3059&user=Dhyanendra+Singh+Rathore&userId=b038ca7c0471&source=-----5ae942ce3059---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F5ae942ce3059&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Floading-csv-data-into-azure-synapse-analytics-by-using-polybase-5ae942ce3059&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----5ae942ce3059--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F5ae942ce3059&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Floading-csv-data-into-azure-synapse-analytics-by-using-polybase-5ae942ce3059&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----5ae942ce3059---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----5ae942ce3059--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----5ae942ce3059--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----5ae942ce3059--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----5ae942ce3059--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----5ae942ce3059--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----5ae942ce3059--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----5ae942ce3059--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----5ae942ce3059--------------------------------", "anchor_text": ""}, {"url": "https://dhyanintech.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://dhyanintech.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Dhyanendra Singh Rathore"}, {"url": "https://dhyanintech.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "258 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fb038ca7c0471&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Floading-csv-data-into-azure-synapse-analytics-by-using-polybase-5ae942ce3059&user=Dhyanendra+Singh+Rathore&userId=b038ca7c0471&source=post_page-b038ca7c0471--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fbd8cfa4cf694&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Floading-csv-data-into-azure-synapse-analytics-by-using-polybase-5ae942ce3059&newsletterV3=b038ca7c0471&newsletterV3Id=bd8cfa4cf694&user=Dhyanendra+Singh+Rathore&userId=b038ca7c0471&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}