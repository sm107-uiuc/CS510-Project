{"url": "https://towardsdatascience.com/using-kdtree-to-detect-similarities-in-a-multidimensional-dataset-4be276dcf616", "time": 1683009307.0346959, "path": "towardsdatascience.com/using-kdtree-to-detect-similarities-in-a-multidimensional-dataset-4be276dcf616/", "webpage": {"metadata": {"title": "Using KDTree to detect similarities in a multidimensional dataset | by Thomas Vie | Towards Data Science", "h1": "Using KDTree to detect similarities in a multidimensional dataset", "description": "Most of data science is oriented towards the Train, Test, Predict paradigm. Who doesn\u2019t want to guess the future! But there are some cases where other implementations are needed like unsupervised\u2026"}, "outgoing_paragraph_urls": [{"url": "https://scikit-learn.org/stable/modules/generated/sklearn.neighbors.KDTree.html", "anchor_text": "KD Tree", "paragraph_index": 6}, {"url": "https://en.wikipedia.org/wiki/K-d_tree", "anchor_text": "wikipedia article", "paragraph_index": 6}, {"url": "https://scikit-learn.org/stable/", "anchor_text": "sklearn", "paragraph_index": 7}, {"url": "https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.pivot_table.html", "anchor_text": "pivot_table", "paragraph_index": 16}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.neighbors.KDTree.html#sklearn.neighbors.KDTree.query", "anchor_text": "documentation", "paragraph_index": 27}, {"url": "https://jovian.ml/zeerobug/article-calculate-skills-similarity", "anchor_text": "here", "paragraph_index": 31}], "all_paragraphs": ["Most of data science is oriented towards the Train, Test, Predict paradigm. Who doesn\u2019t want to guess the future! But there are some cases where other implementations are needed like unsupervised classification or discovering patterns in existing data. In other words, how to take advantage of the data which is already owned.", "I think this aspect is a little bit disregarded and the literature about it is scarcer, compared to other branches of data science. Hence the reason for this little contribution.", "Here\u2019s the story: A client of ours needed a way to find similar items (neighbours) for a given entity, according to a fixed number of parameters. Practically, the dataset is composed of votes from Human Resources Professionals who could attribute up to 5 skills to an arbitrary amount of World universities. It means that Edouard from HR could vote for MIT as a good institution for Digitalisation, Oxford for Internationality and La Sorbonne for Soft Skills.", "I prepared the data, output a Spiderweb chart where the client could choose any Institution and compare it with the others, here is an example for three random universities:", "At that point, it seemed interesting to search for universities that would have been voted the same way, maybe to compare their actions and study what they were doing good and what wrong.", "The data came in a spss file, with one row by vote, and according to our brief, the output had to be fast, because it was meant to be used as a Backend service, with near real time responses.", "After some research, I thought that the best processing format for that would be a KD Tree for its multi-dimensional nature and its relatively easy and fast processing possibilities. I won\u2019t explain in detail what KD Trees are but you can refer to the wikipedia article.", "It is fully integrated into the sklearn module, and very easy to use as we\u2019ll see below.", "But first, let's do some prep!", "Our dataset, as property of the client, has been anonymised. The names of the universities have been taken away, but the values are real.", "We\u2019ll start by importing the libraries:", "We already converted the spss file to a csv file, so we just have to import it using pandas read_csv method and display its first rows:", "Each row corresponds to a vote where:", "Our next step consists in grouping by institution and skill (response). We do it with the excellent groupby method that generates a SeriesGroupBy object that we can use to count the number of similar pairs of (univid, response) in the dataset.", "We use reset_index, to get a DataFrame back from the series which is output by the count() function, and to create the \u201cvalue\u201d column that contains that count. Here is our table now:", "Even if a lot more readable, this format is useless for our goal. It is difficult to distinguish between institutions as the number of rows is arbitrary (some skills may have not been voted), and lots of tools work best with row values instead of columns values.", "Luckily, Pandas offers a very powerful tool which swaps rows and columns: pivot_table. Its arguments are self explanatory so I won\u2019t enter into details.", "Our data is almost ready for processing, but we still have an issue: To be comparable, each row must be in the same range and if we calculate the sum of values in a row, the total is far from being similar from one row to another:", "This is because universities like Harvard have had a lot more votes that some remote and unknown university. It could be interesting to use that parameter in some other calculation but for the present problem, we need to get rid of that disparity. We comply by using percentages instead of absolute values.", "So we have to sum each line and divide each value by that sum. This is done in a one-liner, and then we get rid of some Nan values to finish polishing the dataset.", "Our dataset is now clean, ready, the values are in the same range, we can start playing with some more interesting processing.", "So our algorithm has to detect amongst all the universities in our dataset which ones have the closest values to our 5 variables at the same time. We can immediately think of a brute force algorithm with nested loops that would compare value by value until it finds the 5 closest values for each variable but that would be far from optimal and not fast enough for our appplication!", "The KD Tree algorithm is way more effective, it consists of a geometrical approach of the data, which, by subsequent divisions of a n-dimensional space, generates a tree that re-organises the data in a way that allows complex queries to run very fast. So let\u2019s generate a tree with that method:", "Our tree is ready to be queried. The first step consists in choosing a university to start with, for example the row of index 9 (univSkills[9:10]), we want a result set of the 5 closest universities (k=5) and the \"query\" function applied to our tree will return a tuple of 2 numpy arrays (dist, index), which will be respectively the distance and the index of the result, sorted from the closest to the furthest.", "And then we can display the values of our neighbors:", "We notice right away that the values are very close, we can confirm it with a new Radar chart:", "You can try with different starting row, in most of the cases, the radar charts will remain very similar in shape.", "You can also play with the other KDTree method variables that you will find in the documentation. Let me know if your experiments lead to better results.", "I think there are a lot of other applications of this algorithm. It can be used in recommender systems, dating sites, and generally any processing that relies on proximity between multidimensional matrices", "Relationship, for example: by determining a maximum distance and apply the query function to each row of the whole dataset, we could spot unseen relations and generate a GraphQL-like database.", "Due to its speed, simplicity and effectivity, the KDTree can also be employed in some simple cases as a replacement for far more complicated libraries like TensorFlow or Pytorch. We\u2019ll look into that in my next article.", "Et voil\u00e0! I hope that this article will be of use to someone. You can find the complete notebook here. Don\u2019t hesitate to leave a comment and send me an email, or message for any inquiry.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Senior programmer and technological partner, I work with data since 1997 in projects related to analytics and data visualisation."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F4be276dcf616&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-kdtree-to-detect-similarities-in-a-multidimensional-dataset-4be276dcf616&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-kdtree-to-detect-similarities-in-a-multidimensional-dataset-4be276dcf616&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-kdtree-to-detect-similarities-in-a-multidimensional-dataset-4be276dcf616&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-kdtree-to-detect-similarities-in-a-multidimensional-dataset-4be276dcf616&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----4be276dcf616--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----4be276dcf616--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@thomasvie?source=post_page-----4be276dcf616--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@thomasvie?source=post_page-----4be276dcf616--------------------------------", "anchor_text": "Thomas Vie"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F740396385849&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-kdtree-to-detect-similarities-in-a-multidimensional-dataset-4be276dcf616&user=Thomas+Vie&userId=740396385849&source=post_page-740396385849----4be276dcf616---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F4be276dcf616&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-kdtree-to-detect-similarities-in-a-multidimensional-dataset-4be276dcf616&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F4be276dcf616&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-kdtree-to-detect-similarities-in-a-multidimensional-dataset-4be276dcf616&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@alinnnaaaa?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Alina Grubnyak"}, {"url": "https://towardsdatascience.com/s/photos/network?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.neighbors.KDTree.html", "anchor_text": "KD Tree"}, {"url": "https://en.wikipedia.org/wiki/K-d_tree", "anchor_text": "wikipedia article"}, {"url": "https://scikit-learn.org/stable/", "anchor_text": "sklearn"}, {"url": "https://scikit-learn.org/stable/", "anchor_text": "scikit-learn"}, {"url": "https://bitbucket.org/zeerobug/material/raw/12301e73580ce6b623a7a6fd601c08549eed1c45/datasets/votes_skills_anon.csv", "anchor_text": "https://bitbucket.org/zeerobug/material/raw/12301e73580ce6b623a7a6fd601c08549eed1c45/datasets/votes_skills_anon.csv"}, {"url": "https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.pivot_table.html", "anchor_text": "pivot_table"}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.neighbors.KDTree.html#sklearn.neighbors.KDTree.query", "anchor_text": "documentation"}, {"url": "https://jovian.ml/zeerobug/article-calculate-skills-similarity", "anchor_text": "here"}, {"url": "https://medium.com/tag/data-science?source=post_page-----4be276dcf616---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/sklearn?source=post_page-----4be276dcf616---------------sklearn-----------------", "anchor_text": "Sklearn"}, {"url": "https://medium.com/tag/python?source=post_page-----4be276dcf616---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/technology?source=post_page-----4be276dcf616---------------technology-----------------", "anchor_text": "Technology"}, {"url": "https://medium.com/tag/pandas?source=post_page-----4be276dcf616---------------pandas-----------------", "anchor_text": "Pandas"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F4be276dcf616&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-kdtree-to-detect-similarities-in-a-multidimensional-dataset-4be276dcf616&user=Thomas+Vie&userId=740396385849&source=-----4be276dcf616---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F4be276dcf616&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-kdtree-to-detect-similarities-in-a-multidimensional-dataset-4be276dcf616&user=Thomas+Vie&userId=740396385849&source=-----4be276dcf616---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F4be276dcf616&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-kdtree-to-detect-similarities-in-a-multidimensional-dataset-4be276dcf616&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----4be276dcf616--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F4be276dcf616&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-kdtree-to-detect-similarities-in-a-multidimensional-dataset-4be276dcf616&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----4be276dcf616---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----4be276dcf616--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----4be276dcf616--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----4be276dcf616--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----4be276dcf616--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----4be276dcf616--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----4be276dcf616--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----4be276dcf616--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----4be276dcf616--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@thomasvie?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@thomasvie?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Thomas Vie"}, {"url": "https://medium.com/@thomasvie/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "24 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F740396385849&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-kdtree-to-detect-similarities-in-a-multidimensional-dataset-4be276dcf616&user=Thomas+Vie&userId=740396385849&source=post_page-740396385849--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fusers%2F740396385849%2Flazily-enable-writer-subscription&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-kdtree-to-detect-similarities-in-a-multidimensional-dataset-4be276dcf616&user=Thomas+Vie&userId=740396385849&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}