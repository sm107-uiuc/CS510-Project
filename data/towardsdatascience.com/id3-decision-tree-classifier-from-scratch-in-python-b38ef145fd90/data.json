{"url": "https://towardsdatascience.com/id3-decision-tree-classifier-from-scratch-in-python-b38ef145fd90", "time": 1683017668.12484, "path": "towardsdatascience.com/id3-decision-tree-classifier-from-scratch-in-python-b38ef145fd90/", "webpage": {"metadata": {"title": "ID3 Decision Tree Classifier from scratch in Python | by Bernardo Garcia del Rio | Towards Data Science", "h1": "ID3 Decision Tree Classifier from scratch in Python", "description": "In my last article, I showed how you could have some fun growing a Random Forest using Sklearn\u2019s DecisionTreeClassifier. You can check it out below: If you are new to Machine Learning (ML) or are in\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.w3schools.com/python/python_lists_comprehension.asp", "anchor_text": "Python\u2019s lists comprehensions", "paragraph_index": 9}, {"url": "https://www.linkedin.com/in/bernardo-garc%C3%ADa-del-r%C3%ADo-b4a988", "anchor_text": "https://www.linkedin.com/in/bernardo-garc%C3%ADa-del-r%C3%ADo-b4a988", "paragraph_index": 38}], "all_paragraphs": ["In my last article, I showed how you could have some fun growing a Random Forest using Sklearn\u2019s DecisionTreeClassifier. You can check it out below:", "If you are new to Machine Learning (ML) or are in the process of becoming a Data Scientist or ML practitioner like me, you will probably get something out of it. In my case, preparing the material for the article helped me gain a good understanding of how Random Forests and Decision Trees work under the hood without getting into complex code.", "In that article, I mentioned that there are many algorithms that can be used to build a Decision Tree. One of them is ID3 (Iterative Dichotomiser 3) and we are going to see how to code it from scratch using ONLY Python to build a Decision Tree Classifier.", "All the code can be found in a public repository that I have attached below:", "A Decision Tree is formed by nodes: root node, internal nodes and leaf nodes. We can create a Python class that will contain all the information of all the nodes of the Decision Tree.", "The class Node will contain the following information:", "We create now our main class called DecisionTreeClassifier and use the __init__ constructor to initialise the attributes of the class and some important variables that are going to be needed.", "Note that I have provided many annotations in the code snippets that help understand the code.", "In order to calculate the entropy note we are using the private function _get_entropy( ). The code for this function is provided below:", "We pass the instances id\u2019s or indexes to this function. For doing this, we need to generate an unique number for each instance. Python\u2019s lists comprehensions come in very handy for this task as you can see.", "We are going to code an ID3 algorithm that uses the information gain to find the feature that maximises it and make a split based on that feature. The information gain is based on entropy.", "As this article is about coding the ID3 algorithm, I am not going to go into the details but entropy is a measure of uncertainty about a random variable. If we minimise the entropy, then we increase the certainty about the variable. In other words, if the random variable can take only one value the entropy reaches its minimum whereas if all the values are equiprobable the entropy is maximum.", "The algorithm will try to minimise the entropy or, equivalently, maximising the information gain.", "We can compute the entropy with the following formula:", "where pi is the proportion of each category i=1,\u2026,N.", "We said that we would compute the information gain to choose the feature that maximises it and then make the split based on that feature. The information gain is a concept based on entropy. It is defined as the total entropy minus the entropy if we chose a particular feature j.", "So we create another private function that computes the information gain:", "_get_information_gain( ) takes the instances ids and the feature id of the selected featured to be evaluated. Then it calculates the total entropy, the entropy if we selected the feature specified in feature_id and finally the information gain.", "This ID3 algorithm chooses the feature that maximise the information gain at each split. That is if the amount information in the feature is large, the entropy will be small, and therefore the second term of the information gain formula will be also small, increasing the information gain.", "_get_information_gain( ) only calculates the information gain for a given set and feature but, at each split, we need to figure out which is the feature that maximises the information gain. We need to create another function to find the feature that maximises the information gain.", "Ok..so we have a private function (_get_feature_max_information_gain( )) that find the feature that maximises the information gain, that uses another private function (_get_information_gain( )) that calculates the information gain, that uses another private function (_get_entropy()) that computes the entropy. We are all set! We can start coding the ID3 algorithm that will create our ID3 Decision Tree for classification problems.", "We create a function that initialises the algorithm and then uses a private function to call the algorithm recursively to build our tree.", "Note how we call _id3_recv( ) function in self.node. This function returns an instance of the class Node with information of all the nodes (decisions) in the Decision Tree.", "_id3_recv_( ) is the trickiest function to code so let\u2019s spend some time understanding what is does.", "I have generated a small toy dataset so we can work on a small example and actually visualise the resulting tree. This will help us understand the algorithm as well.", "Let\u2019s imagine that we love surfing waves and would like to have a model to predict if there will be good waves in our favourite spot.", "And our target is simply a binary categorial variable that tells us if there were/will be good waves based on the information provided in our features:", "Let\u2019s generate some synthetic data using random sampling:", "Now that we have some data to work with it will be easier to understand _id3_recv ( ) function. Below is the code with some annotations:", "The function takes two lists containing instances ids and feature ids and an instance of the class Node. Firstly, it checks if the node attribute is None and if it is, it initialises an instance of the class Node.", "Then, at each split the algorithm checks if some of the following conditions are met:", "If none of the above conditions are met, it chooses the feature that maximises the information gain and stores it in the node value. In this case, the node value is the feature with which it is making the split.", "The ID3 algorithm creates a branch for each value of the selected feature and finds the instances in the training set that takes that branch. Note each branch is represented with a new instance of the class node that also contains the the next node.", "For the next node, it computes the information gain for the remaining features and instances and chooses the one that maximises it to make another split until all the instances have the same class or there not more features to compute, returning the most probable category in this case. All of this is done in the last part of the function:", "And here we have the Decision Tree Classifier that the ID3 algorithm has built using our synthetic data:", "It seems that our \u201csynthetic\u201d beach only works well when the wind blows from the South. If there is a large swell, it is likely that there will be good waves regardless of the tide but if the swell is medium, we will usually find better surfing conditions during low tide.", "I would like to give credit to the Professors of the MSc in Machine Learning, Deep Learning and AI by Big Data International Campus for providing a version of the source code, that inspired me to write this article.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "AI / NLP Engineer building the future of writing at Flowrite. Connect with me on LinkedIn \u2014 https://www.linkedin.com/in/bernardo-garc%C3%ADa-del-r%C3%ADo-b4a988"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fb38ef145fd90&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fid3-decision-tree-classifier-from-scratch-in-python-b38ef145fd90&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fid3-decision-tree-classifier-from-scratch-in-python-b38ef145fd90&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fid3-decision-tree-classifier-from-scratch-in-python-b38ef145fd90&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fid3-decision-tree-classifier-from-scratch-in-python-b38ef145fd90&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----b38ef145fd90--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----b38ef145fd90--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://bernardogarciadelrio.medium.com/?source=post_page-----b38ef145fd90--------------------------------", "anchor_text": ""}, {"url": "https://bernardogarciadelrio.medium.com/?source=post_page-----b38ef145fd90--------------------------------", "anchor_text": "Bernardo Garcia del Rio"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F9b5db1c122af&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fid3-decision-tree-classifier-from-scratch-in-python-b38ef145fd90&user=Bernardo+Garcia+del+Rio&userId=9b5db1c122af&source=post_page-9b5db1c122af----b38ef145fd90---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb38ef145fd90&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fid3-decision-tree-classifier-from-scratch-in-python-b38ef145fd90&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb38ef145fd90&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fid3-decision-tree-classifier-from-scratch-in-python-b38ef145fd90&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@fabulu75?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Fabrice Villard"}, {"url": "https://unsplash.com/s/photos/tree?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://bernardogarciadelrio.medium.com/growing-a-random-forest-using-sklearns-decisiontreeclassifier-24e048e8bd84", "anchor_text": "Growing a Random Forest using Sklearn\u2019s DecisionTreeClassifierUnderstanding Decision Trees and Random Forests with a hands-on examplebernardogarciadelrio.medium.com"}, {"url": "https://github.com/bergr7/ID3_From_Scratch", "anchor_text": "bergr7/ID3_From_ScratchAll the code is in a public repository at the link below: Installation Project Motivation File Descriptions Results\u2026github.com"}, {"url": "https://www.w3schools.com/python/python_lists_comprehension.asp", "anchor_text": "Python\u2019s lists comprehensions"}, {"url": "https://medium.com/tag/decision-tree?source=post_page-----b38ef145fd90---------------decision_tree-----------------", "anchor_text": "Decision Tree"}, {"url": "https://medium.com/tag/decision-tree-classifier?source=post_page-----b38ef145fd90---------------decision_tree_classifier-----------------", "anchor_text": "Decision Tree Classifier"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----b38ef145fd90---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/id3-algorithm?source=post_page-----b38ef145fd90---------------id3_algorithm-----------------", "anchor_text": "Id3 Algorithm"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----b38ef145fd90---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fb38ef145fd90&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fid3-decision-tree-classifier-from-scratch-in-python-b38ef145fd90&user=Bernardo+Garcia+del+Rio&userId=9b5db1c122af&source=-----b38ef145fd90---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fb38ef145fd90&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fid3-decision-tree-classifier-from-scratch-in-python-b38ef145fd90&user=Bernardo+Garcia+del+Rio&userId=9b5db1c122af&source=-----b38ef145fd90---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb38ef145fd90&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fid3-decision-tree-classifier-from-scratch-in-python-b38ef145fd90&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----b38ef145fd90--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fb38ef145fd90&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fid3-decision-tree-classifier-from-scratch-in-python-b38ef145fd90&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----b38ef145fd90---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----b38ef145fd90--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----b38ef145fd90--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----b38ef145fd90--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----b38ef145fd90--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----b38ef145fd90--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----b38ef145fd90--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----b38ef145fd90--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----b38ef145fd90--------------------------------", "anchor_text": ""}, {"url": "https://bernardogarciadelrio.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://bernardogarciadelrio.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Bernardo Garcia del Rio"}, {"url": "https://bernardogarciadelrio.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "42 Followers"}, {"url": "https://www.linkedin.com/in/bernardo-garc%C3%ADa-del-r%C3%ADo-b4a988", "anchor_text": "https://www.linkedin.com/in/bernardo-garc%C3%ADa-del-r%C3%ADo-b4a988"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F9b5db1c122af&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fid3-decision-tree-classifier-from-scratch-in-python-b38ef145fd90&user=Bernardo+Garcia+del+Rio&userId=9b5db1c122af&source=post_page-9b5db1c122af--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F1a973d390662&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fid3-decision-tree-classifier-from-scratch-in-python-b38ef145fd90&newsletterV3=9b5db1c122af&newsletterV3Id=1a973d390662&user=Bernardo+Garcia+del+Rio&userId=9b5db1c122af&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}