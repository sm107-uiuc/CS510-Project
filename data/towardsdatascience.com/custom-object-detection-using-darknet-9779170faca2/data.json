{"url": "https://towardsdatascience.com/custom-object-detection-using-darknet-9779170faca2", "time": 1683008536.042016, "path": "towardsdatascience.com/custom-object-detection-using-darknet-9779170faca2/", "webpage": {"metadata": {"title": "Custom Object Detection using Darknet | Towards Data Science", "h1": "Custom Object Detection using Darknet", "description": "A guide to create a Custom Object Detector using Darknet Part - 1"}, "outgoing_paragraph_urls": [{"url": "https://medium.com/u/c7445a0614a3?source=post_page-----9779170faca2--------------------------------", "anchor_text": "Shauryasikt Jena", "paragraph_index": 2}], "all_paragraphs": ["In this article you will get your hands dirty using Darknet and training the model for mask detection.", "This article can be referred to train any custom object detector", "Citations: The video output feed is available on YouTube by Bloomberg Quicktake, images downloaded for training are available as open source on Kaggle. The images are the screenshots of my personal computer. Huge thanks to my colleague Shauryasikt Jena", "Instead of training your own model from scratch, you can build on existing models and fine-tune them for your own purpose without requiring as much computing power. I was using Google Colab for training and CPU (local machine) for testing.", "Darknet is an open source neural network framework. It is a fast and highly accurate (accuracy for custom trained model depends on training data, epochs, batch size and some other factors) framework for real time object detection (also can be used for images). The most important reason it is fast because it is written in C and CUDA.", "To get an idea how fast C is \u2014", "For more comparison stats please visit this page \u2014", "So let\u2019s get started its pretty easy and simple. Just go through the article and follow the steps. Thanks :)", "We are going to train our model on Google colab so there is no extra library you are going to require to install", "But if you are testing the model on your local machine, here are the libraries you need \u2014", "Please install these libraries on your local system using conda or pip available on anaconda cloud or Pypi respectively.", "Note: ffmpeg is used to save the output video file hence, the specific version is required.", "You can get the images from this link by clicking the download \u2014", "Note: This link contains a zip file in which the images and their labels/annotations are already present but ensure that the they are correct(with respect to the coordinates of masked/non masked). Just to be sure I labelled it manually so that I do not need to train the model again.", "The downloaded file would have only around 700 images which is not enough to get a good accuracy. You can get them from these links too..", "You can get masked and non masked images from here \u2014", "So now you have collected 1300+ images (If possible you can add more images, it would surely increase the accuracy), here comes a little tedious step but an important one.", "After collecting so many images which is around 1300 or more you have to manually label them. Yes, this is a very tedious task but it\u2019s very important to correctly label the images or else it would reflect on the model and the accuracy would not be so satisfying!", "To label the images, you can use a very well known tool Labelimg.", "You can clone this link on your system \u2014", "Note: After cloning I would recommend to see installation steps as you have to write two or three lines on your command prompt", "For installation guidance you can watch any labelimg installation video. Don\u2019t worry the installation is easy but the labeling part is uh\u2026 you know what I mean.", "2. Click on the create\\nRectBox and start labeling masked images", "3. Drag on the area around the mask and type masked", "4. We also need non masked hence the same procedure click on the create/nRectBox and drag on non masked face and label it not_masked", "5. After labeling every face save and move to next image", "Honestly you will require 2 to 3 hours to do this depending on your speed. So good luck ;)", "You can directly clone this GitHub Repository on google colab for training \u2014", "Note: Along with this repository there is another repository which is forked version of pjreddie. I used pjreddie because at my first attempt it worked fine for me.", "In the file search for [yolo] using ctrl + f and make these changes everywhere (There will be three [yolo] blocks).", "Note: The changes will be in the each [yolo] and the [convolutional] block just above [yolo] and that\u2019s it for .cfg, don\u2019t forget to save it!", "Let\u2019s understand briefly what we just did..", "We changed the classes=2 as we have two classes masked and not_masked and in [convolutional], filters=21", "Formulae for number of filters is \u2014", "3. Create a new file in data folder named as yolo.names using notepad and just copy these lines..", "..and done, save it. (We are gonna need this file for testing)", "4. Create another two files train.txt and val.txt and divide your images in training 95% Validation-5%.", "Now here comes the tricky part.. the images you have downloaded should be put in images folder in darknet and the annotations/labels in labels folder. In train.txt and val.txt you have to give the path to every image like this..", "Tip: You can write a simple python code to do this which takes only takes 2 mins, no need to write the entire thing manually", "5. Create a file \u2018yolo.data\u2019 using notepad and paste this in the file..", "The most awaited part is finally here. From here you don\u2019t need to do anything just run some codes and wait for the training to be completed.", "Now just upload your darknet folder on google drive and we are almost there.", "Tip: If in any case google colab disconnects you automatically because your GPU runtime has exceeded, you can save checkpoints of your generated weight files so that you can continue from that epoch and also test which weight file gives the best results. You can go to detector.c file in examples folder and make these changes so that you get weight files after every 100 epochs and after 1000 epochs you will get the weights after every 1000 epochs", "Create a folder \u2018backup\u2019 outside your darknet folder in My Drive", "Now that we are almost there, just make sure you have everything you need to train the model because you don\u2019t wanna do everything again.", "Okay.. now let\u2019s train the model (yeah.. finally)", "The easiest step is here, but first make sure the paths you are giving are correct. Run these codes cell by cell and done. Change the colab runtime to GPU", "Note: The commands below will work only for linux, hence we are using Google Colab", "Note: When you are starting the training from a checkpoint let\u2019s say after 2000 epochs, just change the training command to this..", "That\u2019s it!! Thank you for going through the entire article", "For more information about darknet visit this link \u2014", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "AI enthusiast | Exploring stuff | MS in CS Conc. Applied Artificial Intelligence @ uOttawa"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F9779170faca2&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcustom-object-detection-using-darknet-9779170faca2&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcustom-object-detection-using-darknet-9779170faca2&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcustom-object-detection-using-darknet-9779170faca2&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcustom-object-detection-using-darknet-9779170faca2&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----9779170faca2--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----9779170faca2--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://tejas-khare99.medium.com/?source=post_page-----9779170faca2--------------------------------", "anchor_text": ""}, {"url": "https://tejas-khare99.medium.com/?source=post_page-----9779170faca2--------------------------------", "anchor_text": "Tejas Khare"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fd29109a93a63&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcustom-object-detection-using-darknet-9779170faca2&user=Tejas+Khare&userId=d29109a93a63&source=post_page-d29109a93a63----9779170faca2---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F9779170faca2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcustom-object-detection-using-darknet-9779170faca2&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F9779170faca2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcustom-object-detection-using-darknet-9779170faca2&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://medium.com/u/c7445a0614a3?source=post_page-----9779170faca2--------------------------------", "anchor_text": "Shauryasikt Jena"}, {"url": "https://benchmarksgame-team.pages.debian.net/benchmarksgame/fastest/python3-gcc.html", "anchor_text": "Python 3 vs C gcc - Which programs are fastest? | Computer Language Benchmarks GamePython 3 C gcc - Which programs are fastest?benchmarksgame-team.pages.debian.net"}, {"url": "https://www.kaggle.com/vtech6/medical-masks-dataset", "anchor_text": "Medical Masks DatasetPictures of people wearing medical maskswww.kaggle.com"}, {"url": "https://www.kaggle.com/shreyashwaghe/face-mask-dataset", "anchor_text": "Face mask datasetKaggle is the world's largest data science community with powerful tools and resources to help you achieve your data\u2026www.kaggle.com"}, {"url": "https://www.kaggle.com/ahmetfurkandemr/mask-datasets-v1", "anchor_text": "Mask Datasets V1People wearing and not wearing masks.www.kaggle.com"}, {"url": "https://github.com/tzutalin/labelImg", "anchor_text": "tzutalin/labelImgLabelImg is a graphical image annotation tool. It is written in Python and uses Qt for its graphical interface\u2026github.com"}, {"url": "https://github.com/pjreddie/darknet", "anchor_text": "pjreddie/darknetDarknet is an open source neural network framework written in C and CUDA. It is fast, easy to install, and supports CPU\u2026github.com"}, {"url": "https://pjreddie.com/media/files/darknet53.conv.74", "anchor_text": "here"}, {"url": "https://towardsdatascience.com/real-time-custom-object-detection-a95d955cecda", "anchor_text": "Real Time Custom Object DetectionTesting a custom trained Darknet model for object detectiontowardsdatascience.com"}, {"url": "https://pjreddie.com/darknet/", "anchor_text": "Darknet: Open Source Neural Networks in CDarknet: Open Source Neural Networks in C.pjreddie.com"}, {"url": "https://medium.com/tag/object-detection?source=post_page-----9779170faca2---------------object_detection-----------------", "anchor_text": "Object Detection"}, {"url": "https://medium.com/tag/yolo?source=post_page-----9779170faca2---------------yolo-----------------", "anchor_text": "Yolo"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----9779170faca2---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/convolutional-network?source=post_page-----9779170faca2---------------convolutional_network-----------------", "anchor_text": "Convolutional Network"}, {"url": "https://medium.com/tag/custom?source=post_page-----9779170faca2---------------custom-----------------", "anchor_text": "Custom"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F9779170faca2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcustom-object-detection-using-darknet-9779170faca2&user=Tejas+Khare&userId=d29109a93a63&source=-----9779170faca2---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F9779170faca2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcustom-object-detection-using-darknet-9779170faca2&user=Tejas+Khare&userId=d29109a93a63&source=-----9779170faca2---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F9779170faca2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcustom-object-detection-using-darknet-9779170faca2&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----9779170faca2--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F9779170faca2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcustom-object-detection-using-darknet-9779170faca2&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----9779170faca2---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----9779170faca2--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----9779170faca2--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----9779170faca2--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----9779170faca2--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----9779170faca2--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----9779170faca2--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----9779170faca2--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----9779170faca2--------------------------------", "anchor_text": ""}, {"url": "https://tejas-khare99.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://tejas-khare99.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Tejas Khare"}, {"url": "https://tejas-khare99.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "48 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fd29109a93a63&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcustom-object-detection-using-darknet-9779170faca2&user=Tejas+Khare&userId=d29109a93a63&source=post_page-d29109a93a63--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F139e2e5a9031&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcustom-object-detection-using-darknet-9779170faca2&newsletterV3=d29109a93a63&newsletterV3Id=139e2e5a9031&user=Tejas+Khare&userId=d29109a93a63&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}