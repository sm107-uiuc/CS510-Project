{"url": "https://towardsdatascience.com/the-art-of-forecasting-d2a8806b7aa0", "time": 1683000134.543626, "path": "towardsdatascience.com/the-art-of-forecasting-d2a8806b7aa0/", "webpage": {"metadata": {"title": "The Art of Forecasting. What Really Happens Under The Hood When\u2026 | by Tony Yiu | Towards Data Science", "h1": "The Art of Forecasting", "description": "Data science is a mix of many disciplines \u2014 statistical inference, analytics, visualization, classification, and forecasting. The one that people generally find most fascinating is forecasting\u2026"}, "outgoing_paragraph_urls": [{"url": "https://en.wikipedia.org/wiki/Ordinary_least_squares", "anchor_text": "ordinary least squares", "paragraph_index": 27}, {"url": "https://en.wikipedia.org/wiki/K-nearest_neighbors_algorithm", "anchor_text": "k-nearest neighbors", "paragraph_index": 31}, {"url": "https://towardsdatascience.com/is-the-data-science-profession-at-risk-of-automation-ae162b5f052f", "anchor_text": "Are Data Scientists at Risk of Automation", "paragraph_index": 36}, {"url": "https://tonester524.medium.com/membership", "anchor_text": "https://tonester524.medium.com/membership", "paragraph_index": 38}], "all_paragraphs": ["Data science is a mix of many disciplines \u2014 statistical inference, analytics, visualization, classification, and forecasting. The one that people generally find most fascinating is forecasting.", "Forecasting the future sounds like magic whether it be detecting in advance the intent of a potential customer to purchase your product or figuring out where the price of a stock is headed. If we can reliably predict the future of something, then we own a massive advantage.", "Machine learning has only served to amplify this magic and mystery. As forecasting models increase in complexity (at the expense of losing interpretability), they are able to uncover previously unnoticed correlations as well as capitalize on previously hard to use data.", "But forecasting, at its heart, is actually pretty simple. Today we will introduce a mental model for thinking about forecasting that will hopefully demystify this art and encourage you to add forecasting to your quantitative toolkit.", "One of the first models we learn in statistics is linear regression. It\u2019s versatile, interpretable, and surprisingly powerful. And it is a great tool for illustrating how forecasts work.", "The non-math description of how linear regression works is that it seeks to fit a line as optimally as possible through the dots that represent your data. This line attempts to capture the trend in your data. The plot below shows what this line of best fit (in blue) looks like. Let\u2019s unpack what is going on:", "So what\u2019s this have to do with forecasting the future? Let\u2019s imagine that we are trying to forecast U.S. GDP (economic) growth. We hypothesize that there is a relationship between GDP growth and corporate profit margins (how profitable companies are). We plot them and see the following relationship (all data is made up by me and for illustrative purposes only):", "Strong positive correlation! So do high corporate profit margins predict high GDP growth? Not so fast, this is where the little voice in your head should be whispering:", "It\u2019s true that periods of economic expansion are generally accompanied by fat corporate profits (and fat margins). But we are trying to understand whether profit margins predict economic growth. To do this, we need to modify our analysis:", "This distinction is key. We are not trying to find features that are concurrently correlated to GDP growth. Rather, we want to find features that predict future GDP growth. That is, we want to find features correlated to next period\u2019s GDP growth (our target is the change in GDP growth over the next year). Let\u2019s redo our scatter plot with this in mind:", "Where did our positive correlation go? Predicting the future is hard. Strong concurrent correlations between variables generally vanish when we switch one of the variables to its future state (and measure predictive correlation).", "That doesn\u2019t mean that all hope is lost. Usually, if we look hard enough and think creatively, we can still find some truly predictive relationships. But do not expect these relationships to be strong \u2014 in my experience (trying to predict the future in financial markets), predictive correlations of 0.20\u20130.30 are already quite good.", "Let\u2019s say we continue to diligently test features against future GDP growth and eventually stumble upon the following relationship:", "We have found a relationship between future GDP growth and the currently observed growth in the working young (people aged 25\u201335 years). It\u2019s not as strongly positive as the concurrent relationship (GDP growth and profit margins) we saw earlier, but this is a predictive relationship that we can use to build a forecasting model (again, I emphasize that this is all data I made up in order to illustrate how forecasting works).", "So how do we build the model? Well actually it is already done \u2014 the blue line of best fit is our model. We make our prediction by simply seeing what the current change in the working young population is (let\u2019s say it is the value denoted by the gold dashed line). We then look at the value along the y-axis (vertical axis) where the gold dashed line intersects with our blue line of best fit (the green dashed line) \u2014 that value is our prediction.", "Ok cool, that\u2019s pretty easy. And the process is the same with more features or even with more complicated forecasting algorithms.", "But at a more fundamental level, what does our forecast really mean? Every forecast, regardless of how complicated the model that produced it is, can be thought of as a conditional expectation. A conditional expectation is nothing more than an a type of expected value, a.k.a an average.", "So am I telling you that the value produced by your fancy XGBoost regressor is nothing more than an average, quite literally the first concept you learn in a beginner statistics class?", "Pretty much (with a few caveats). Don\u2019t believe me? Let\u2019s conduct a thought exercise. If I asked you to predict what the weather will be tomorrow (without checking the internet), how would you do it? You would do something like the following, \u201cyesterday it was hot, and it\u2019s August right now, and we are in San Jose, so I predict tomorrow to be sunny and hot.\u201d", "Why did you come to that conclusion? It\u2019s because, maybe even without consciously realizing it, you did a mental inventory of all the days within your memory where you were in San Jose, it was summer, and the weather of the previous few days had been hot. And the weather on average for each of those days in your mental inventory that were relevant, was sunny and hot.", "So you made your prediction by filtering down to just the relevant observations (summer days in San Jose that had been preceded by hot weather) and taking the average of those observations. That\u2019s generally how we, as people, intuitively make predictions \u2014 so why should we expect models and machines to be any different? The answer is that they aren\u2019t different, except that they can process much more data and do so in a less biased manner.", "So my suggestion for understanding how forecasting the future works is to think of each prediction as derived from an average of the most relevant previously observed observations. Forecasts of the future are just answering the following question:", "When I saw something similar to this happen in the past, what typically occurs next?", "Let\u2019s use our previous example to visualize what we mean when we say that a prediction is a conditional average. The plot below shows how I tend to visualize linear regressions and more generally, the outputs of predictive models. Each gold rectangle is a slice of the sample (our observations) conditioned upon the the feature variable being between certain values. For example, the first gold rectangle on the left might be just those observations of GDP growth (our target, on the Y axis) where the growth rate of the working young population (our feature, on the X axis) is between 0% and 0.1%.", "Notice how the blue prediction line (the line of best fit) falls in the middle of each of those gold rectangles? That\u2019s by design \u2014 the middle of each rectangle is the average of that particular slice (recall that each rectangle represents one slice). And as we take smaller and smaller slices (as we increase the number of rectangles while at the same time decreasing the width of each rectangle), the series of conditional averages (represented by the middle of each rectangle) converges to the regression line.", "\u201cBut hold on a second!\u201d you are thinking. The middle of some of these rectangles is clearly not the average of the observations within that slice. For example, that first gold rectangle includes only one observation, and it is above our prediction line. So how can I say that the prediction line is the conditional average, a.k.a. the average within that slice?", "For simple linear regression, the conditional averages don\u2019t match the averages of the observations in each slice because the regression algorithm enforces a linear relationship between target and feature. But all is not lost! Our mental model is still valid.", "OLS (ordinary least squares), the method linear regression uses to find the line of best fit, is like taking a bunch of conditional averages but with a twist. We can use a voting analogy to see what I mean:", "The net result is that each precinct does its best to push and pull the line towards its own average. At the same time, each precinct feels and is affected by every push and pull made by the other precincts, especially the ones with a lot of observations. Ultimately, the prediction line settles in such a way where:", "So while the prediction made by a linear regression is not a conditional average in the strictest sense, it is similar to one thanks to the way each precinct tugs the prediction line towards its own average.", "How do conditional averages help us better understand forecasting? Well, they are the underlying backbone of every forecast. No matter how complicated, every algorithm at its most basic level tries to identify observations that are similar in nature to the ones it is trying to make predictions for. And the predictions it makes are derivatives of the average values of the target among those most similar observations.", "There are even certain algorithms, like k-nearest neighbors or linear regression using only non-ordinal categorical features, that predict explicitly via the conditional average.", "So there is nothing magical about a forecast \u2014 neither algorithms nor humans can transform current data into precise forecasts of the future. Rather, we are all just using what occurred in the past as a rough guide for what may happen in the future.", "We should keep two things in mind when building predictive algorithms. First, since we use the past to inform our predictions of the future, context is critical. If we are in an environment that is significantly different from the available history that our model was trained with, then we cannot expect our predictions to perform well.", "Second, this mental model is useful for thinking about over-fitting. We can build a model that generalizes reasonably well by following these 2 principles:", "More Data Science and Analytics Related Posts By Me:", "Are Data Scientists at Risk of Automation", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data scientist. Founder Alpha Beta Blog. Doing my best to explain the complex in plain English. Support my writing: https://tonester524.medium.com/membership"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fd2a8806b7aa0&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-art-of-forecasting-d2a8806b7aa0&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-art-of-forecasting-d2a8806b7aa0&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-art-of-forecasting-d2a8806b7aa0&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-art-of-forecasting-d2a8806b7aa0&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----d2a8806b7aa0--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----d2a8806b7aa0--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://tonester524.medium.com/?source=post_page-----d2a8806b7aa0--------------------------------", "anchor_text": ""}, {"url": "https://tonester524.medium.com/?source=post_page-----d2a8806b7aa0--------------------------------", "anchor_text": "Tony Yiu"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F840a3210fbe7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-art-of-forecasting-d2a8806b7aa0&user=Tony+Yiu&userId=840a3210fbe7&source=post_page-840a3210fbe7----d2a8806b7aa0---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fd2a8806b7aa0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-art-of-forecasting-d2a8806b7aa0&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fd2a8806b7aa0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-art-of-forecasting-d2a8806b7aa0&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://www.pexels.com/@dphot?utm_content=attributionCopyText&utm_medium=referral&utm_source=pexels", "anchor_text": "Emmanuel Holveck-Lafay"}, {"url": "https://www.pexels.com/photo/close-up-photo-of-person-holding-lensball-2626979/?utm_content=attributionCopyText&utm_medium=referral&utm_source=pexels", "anchor_text": "Pexels"}, {"url": "https://en.wikipedia.org/wiki/Ordinary_least_squares", "anchor_text": "ordinary least squares"}, {"url": "https://en.wikipedia.org/wiki/K-nearest_neighbors_algorithm", "anchor_text": "k-nearest neighbors"}, {"url": "https://towardsdatascience.com/what-do-data-scientists-do-13526f678129", "anchor_text": "What Do Data Scientists Do?"}, {"url": "https://towardsdatascience.com/is-the-data-science-profession-at-risk-of-automation-ae162b5f052f", "anchor_text": "Are Data Scientists at Risk of Automation"}, {"url": "https://towardsdatascience.com/got-data-science-jobs-552e39d48da2", "anchor_text": "Got Data Science Jobs?"}, {"url": "https://towardsdatascience.com/understanding-pca-fae3e243731d?source=post_page---------------------------", "anchor_text": "Understanding PCA"}, {"url": "https://towardsdatascience.com/understanding-random-forest-58381e0602d2?source=post_page---------------------------", "anchor_text": "Understanding Random Forest"}, {"url": "https://towardsdatascience.com/understanding-neural-networks-19020b758230?source=post_page---------------------------", "anchor_text": "Understanding Neural Nets"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----d2a8806b7aa0---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----d2a8806b7aa0---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/technology?source=post_page-----d2a8806b7aa0---------------technology-----------------", "anchor_text": "Technology"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----d2a8806b7aa0---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/analytics?source=post_page-----d2a8806b7aa0---------------analytics-----------------", "anchor_text": "Analytics"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fd2a8806b7aa0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-art-of-forecasting-d2a8806b7aa0&user=Tony+Yiu&userId=840a3210fbe7&source=-----d2a8806b7aa0---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fd2a8806b7aa0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-art-of-forecasting-d2a8806b7aa0&user=Tony+Yiu&userId=840a3210fbe7&source=-----d2a8806b7aa0---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fd2a8806b7aa0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-art-of-forecasting-d2a8806b7aa0&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----d2a8806b7aa0--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fd2a8806b7aa0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-art-of-forecasting-d2a8806b7aa0&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----d2a8806b7aa0---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----d2a8806b7aa0--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----d2a8806b7aa0--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----d2a8806b7aa0--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----d2a8806b7aa0--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----d2a8806b7aa0--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----d2a8806b7aa0--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----d2a8806b7aa0--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----d2a8806b7aa0--------------------------------", "anchor_text": ""}, {"url": "https://tonester524.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://tonester524.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Tony Yiu"}, {"url": "https://tonester524.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "102K Followers"}, {"url": "https://tonester524.medium.com/membership", "anchor_text": "https://tonester524.medium.com/membership"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F840a3210fbe7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-art-of-forecasting-d2a8806b7aa0&user=Tony+Yiu&userId=840a3210fbe7&source=post_page-840a3210fbe7--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F78d3e392d884&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-art-of-forecasting-d2a8806b7aa0&newsletterV3=840a3210fbe7&newsletterV3Id=78d3e392d884&user=Tony+Yiu&userId=840a3210fbe7&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}