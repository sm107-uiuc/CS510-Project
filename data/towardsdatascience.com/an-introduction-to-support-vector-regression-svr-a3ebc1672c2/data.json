{"url": "https://towardsdatascience.com/an-introduction-to-support-vector-regression-svr-a3ebc1672c2", "time": 1683004404.422067, "path": "towardsdatascience.com/an-introduction-to-support-vector-regression-svr-a3ebc1672c2/", "webpage": {"metadata": {"title": "An Introduction to Support Vector Regression (SVR) | by Tom Sharp \ud83d\udcbb | Towards Data Science", "h1": "An Introduction to Support Vector Regression (SVR)", "description": "Support Vector Machines (SVMs) are well known in classification problems. The use of SVMs in regression is not as well documented, however. These types of models are known as Support Vector\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.aspiringdatascientist.com/", "anchor_text": "Aspiring Data Scientist", "paragraph_index": 21}, {"url": "https://github.com/tomsharp/SVR/blob/master/SVR.ipynb", "anchor_text": "GitHub", "paragraph_index": 22}], "all_paragraphs": ["Support Vector Machines (SVMs) are well known in classification problems. The use of SVMs in regression is not as well documented, however. These types of models are known as Support Vector Regression (SVR).", "In this article, I will walk through the usefulness of SVR compared to other regression models, do a deep-dive into the math behind the algorithm, and provide an example using the Boston Housing Price dataset.", "In most linear regression models, the objective is to minimize the sum of squared errors. Take Ordinary Least Squares (OLS) for example. The objective function for OLS with one predictor (feature) is as follows:", "where y\u1d62 is the target, w\u1d62 is the coefficient, and x\u1d62 is the predictor (feature).", "Lasso, Ridge, and ElasticNet are all extensions of this simple equation, with an additional penalty parameter that aims to minimize complexity and/or reduce the number of features used in the final model. Regardless, the aim \u2014 as with many models \u2014 is to reduce the error of the test set.", "However, what if we are only concerned about reducing error to a certain degree? What if we don\u2019t care how large our errors are, as long as they fall within an acceptable range?", "Take housing prices for example. What if we are okay with the prediction being within a certain dollar amount \u2014 say $5,000? We can then give our model some flexibility in finding the predicted values, as long as the error is within that range.", "Enter Support Vector Regression. SVR gives us the flexibility to define how much error is acceptable in our model and will find an appropriate line (or hyperplane in higher dimensions) to fit the data.", "In contrast to OLS, the objective function of SVR is to minimize the coefficients \u2014 more specifically, the l2-norm of the coefficient vector \u2014 not the squared error. The error term is instead handled in the constraints, where we set the absolute error less than or equal to a specified margin, called the maximum error, \u03f5 (epsilon). We can tune epsilon to gain the desired accuracy of our model. Our new objective function and constraints are as follows:", "Let\u2019s try the simple SVR on our dataset. The plot below shows the results of a trained SVR model on the Boston Housing Prices data. The red line represents the line of best fit and the black lines represent the margin of error, \u03f5, which we set to 5 ($5,000).", "You may quickly realize that this algorithm doesn\u2019t work for all data points. The algorithm solved the objective function as best as possible but some of the points still fall outside the margins. As such, we need to account for the possibility of errors that are larger than \u03f5. We can do this with slack variables.", "The concept of slack variables is simple: for any value that falls outside of \u03f5, we can denote its deviation from the margin as \u03be.", "We know that these deviations have the potential to exist, but we would still like to minimize them as much as possible. Thus, we can add these deviations to the objective function.", "We now have an additional hyperparameter, C, that we can tune. As C increases, our tolerance for points outside of \u03f5 also increases. As C approaches 0, the tolerance approaches 0 and the equation collapses into the simplified (although sometimes infeasible) one.", "Let\u2019s set C=1.0 and retrain our model above. The results are plotted below:", "The above model seems to fit the data much better. We can go one step further and grid search over C to obtain an even better solution. Let\u2019s define a scoring metric, % within Epsilon. This metric measures how many of the total points within our test set fall within our margin of error. We can also monitor how the Mean Absolute Error (MAE) varies with C as well.", "Below is a plot of the grid search results, with values of C on the x-axis and % within Epsilon and MAE on the left and right y-axes, respectively.", "As we can see, MAE generally decreases as C increases. However, we see a maximum occur in the % within Epsilon metric. Since our original objective of this model was to maximize the prediction within our margin of error ($5,000), we want t find the value of C that maximizes % within Epsilon. Thus, C=6.13.", "The plot above shows that this model has again improved upon previous ones, as expected.", "SVR is a powerful algorithm that allows us to choose how tolerant we are of errors, both through an acceptable error margin(\u03f5) and through tuning our tolerance of falling outside that acceptable error rate. Hopefully, this tutorial has shown you the ins-and-outs of SVR and has left you confident enough to add it to your modeling arsenal.", "Thanks for reading! If you liked this post or have any questions/comments, please leave a comment below!", "If you\u2019d like updates on what I\u2019m writing, side projects I\u2019m building, or articles I find interesting, feel free to join my newsletter \u2014 Aspiring Data Scientist.", "The code for this post can be found on my GitHub page.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fa3ebc1672c2&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fan-introduction-to-support-vector-regression-svr-a3ebc1672c2&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fan-introduction-to-support-vector-regression-svr-a3ebc1672c2&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fan-introduction-to-support-vector-regression-svr-a3ebc1672c2&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fan-introduction-to-support-vector-regression-svr-a3ebc1672c2&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----a3ebc1672c2--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----a3ebc1672c2--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://tomsharp.medium.com/?source=post_page-----a3ebc1672c2--------------------------------", "anchor_text": ""}, {"url": "https://tomsharp.medium.com/?source=post_page-----a3ebc1672c2--------------------------------", "anchor_text": "Tom Sharp \ud83d\udcbb"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fc9d851eef6d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fan-introduction-to-support-vector-regression-svr-a3ebc1672c2&user=Tom+Sharp+%F0%9F%92%BB&userId=c9d851eef6d&source=post_page-c9d851eef6d----a3ebc1672c2---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa3ebc1672c2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fan-introduction-to-support-vector-regression-svr-a3ebc1672c2&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa3ebc1672c2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fan-introduction-to-support-vector-regression-svr-a3ebc1672c2&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://www.aspiringdatascientist.com/", "anchor_text": "Aspiring Data Scientist"}, {"url": "https://github.com/tomsharp/SVR/blob/master/SVR.ipynb", "anchor_text": "GitHub"}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.svm.SVR.html", "anchor_text": "https://scikit-learn.org/stable/modules/generated/sklearn.svm.SVR.html"}, {"url": "https://en.wikipedia.org/wiki/Support-vector_machine#Regression", "anchor_text": "https://en.wikipedia.org/wiki/Support-vector_machine#Regression"}, {"url": "https://www.saedsayad.com/support_vector_machine_reg.htm", "anchor_text": "https://www.saedsayad.com/support_vector_machine_reg.htm"}, {"url": "https://medium.com/tag/svr?source=post_page-----a3ebc1672c2---------------svr-----------------", "anchor_text": "Svr"}, {"url": "https://medium.com/tag/support-vector-regression?source=post_page-----a3ebc1672c2---------------support_vector_regression-----------------", "anchor_text": "Support Vector Regression"}, {"url": "https://medium.com/tag/support-vector-machine?source=post_page-----a3ebc1672c2---------------support_vector_machine-----------------", "anchor_text": "Support Vector Machine"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----a3ebc1672c2---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/regression?source=post_page-----a3ebc1672c2---------------regression-----------------", "anchor_text": "Regression"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fa3ebc1672c2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fan-introduction-to-support-vector-regression-svr-a3ebc1672c2&user=Tom+Sharp+%F0%9F%92%BB&userId=c9d851eef6d&source=-----a3ebc1672c2---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fa3ebc1672c2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fan-introduction-to-support-vector-regression-svr-a3ebc1672c2&user=Tom+Sharp+%F0%9F%92%BB&userId=c9d851eef6d&source=-----a3ebc1672c2---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa3ebc1672c2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fan-introduction-to-support-vector-regression-svr-a3ebc1672c2&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----a3ebc1672c2--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fa3ebc1672c2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fan-introduction-to-support-vector-regression-svr-a3ebc1672c2&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----a3ebc1672c2---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----a3ebc1672c2--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----a3ebc1672c2--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----a3ebc1672c2--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----a3ebc1672c2--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----a3ebc1672c2--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----a3ebc1672c2--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----a3ebc1672c2--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----a3ebc1672c2--------------------------------", "anchor_text": ""}, {"url": "https://tomsharp.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://tomsharp.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Tom Sharp \ud83d\udcbb"}, {"url": "https://tomsharp.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "281 Followers"}, {"url": "https://www.aspiringdatascientist.com/", "anchor_text": "https://www.aspiringdatascientist.com/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fc9d851eef6d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fan-introduction-to-support-vector-regression-svr-a3ebc1672c2&user=Tom+Sharp+%F0%9F%92%BB&userId=c9d851eef6d&source=post_page-c9d851eef6d--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F75e70863bb0e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fan-introduction-to-support-vector-regression-svr-a3ebc1672c2&newsletterV3=c9d851eef6d&newsletterV3Id=75e70863bb0e&user=Tom+Sharp+%F0%9F%92%BB&userId=c9d851eef6d&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}