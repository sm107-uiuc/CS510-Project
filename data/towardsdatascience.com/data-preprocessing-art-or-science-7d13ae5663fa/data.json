{"url": "https://towardsdatascience.com/data-preprocessing-art-or-science-7d13ae5663fa", "time": 1683000857.767309, "path": "towardsdatascience.com/data-preprocessing-art-or-science-7d13ae5663fa/", "webpage": {"metadata": {"title": "Data Preprocessing \u2014 Art or Science | by Anshul Kanthaliya | Towards Data Science", "h1": "Data Preprocessing \u2014 Art or Science", "description": "Most of the people say that the heart of any analytics model is Model building, but I would rather say its data preprocessing, not the Model building. One can only build the model, once he/she have\u2026"}, "outgoing_paragraph_urls": [], "all_paragraphs": ["Most of the people say that the heart of any analytics model is Model building, but I would rather say its data preprocessing, not the Model building. One can only build the model, once he/she have processed data or clean data. All the available raw data is incomplete and it needs to be cleaned before doing any further analytics as there is a saying if the input is wrong, the output will be misleading only.", "Data preprocessing is a process of cleaning your data to make it more meaningful before performing any task and thus, it becomes an important and integral part of any analytics task whether it\u2019s Descriptive Analytics or Predictive Analytics.", "How to approach for Data preprocessing:", "\u00b7 Fields that are not useful or redundant", "Let\u2019s discuss these in detail with sample data information.", "1) Fields that are redundant: One has to observe the data very closely before starting any sort of preprocessing or data analysis. Things to check before moving to deep into data preprocessing:", "a) Need to remove the duplicate records if found any.", "b) Need to check for the data format, sometimes you need to consider few variables into text, but that might get changed into numbers.", "c) Look for correlated variables, if you found highly or completed correlated variables, then keeping both the variables become redundant, so one variable can be removed. Heap map, the correlation matrix is used to check this.", "2) Missing Values: Dataset often have variables which have some data missing and we don\u2019t know what to do with those missing values. One hassle-free way is to remove such rows or columns. But wonder is it the right way to go for it because your dataset may be small, you may lose the most important information by removing such values.", "In fact, Gallit Shmueli, Nitin Patel and Peter Bruce state that if 5% of data values are missing from data set of 30 variables, and the missing values are spread evenly throughout the data, almost 80% of the records would have at least one missing value and thus by simply removing the rows which have missing data, we would be left with 20% of the data, so removing data is always not a solution.", "Now the solution is to replace the missing value with some values, that\u2019s called \u201cMissing Value Imputation\u201d. Below are the few methods of imputing values wrt to the type of data.", "2.1) Replace missing value with some constant or zero: One way of going about missing value is to replace your missing value with some constant or 0, but by this, you create a new class or variable, which you are sure about whether it exists or not, thus not a good way to impute missing values.", "Thus, if we impute some random 1 in Marital Status, then it\u2019s a separate class, which doesn\u2019t have any explanation, similarly for the continuous variable as well, it won\u2019t give much info.", "2.2) Replace missing value when the variable is continuous: There are multiple ways to impute your data on continuous variables. A few of them are listed below.", "a) With mean/median: You can impute your missing values by mean/median of the respective variable. Pros for this approach is that it\u2019s a faster way of imputing the data, work fairly ok when you have small dataset, but modeling is all about variability in the data, how far or close the data points are from each other, so if you impute data with mean or mode then, it loses variability in the data and may not work well. Also, it can\u2019t be used on categorical variables.", "Similarly, median imputation can be done.", "b) With randomly chosen value from the distribution: Another way of imputing continuous variable is by randomly chosen value from the observed distribution of that variable. The benefit of this approach is that the measures of center and spread remain closer to the original when compared to the mean/median replacement method.", "Here in this case, if you see, based on the random value, eligibility for home loan amount came out to be 8000 for 2nd record, while the customers don\u2019t have mortgage property, thus this value doesn\u2019t make sense, so one needs to be very careful while using this method as this doesn\u2019t account for other variables while imputation.", "c) With Linear regression: Another way to impute the continuous data is via linear regression. In this case, the variable for which you want to do the imputation becomes your target variable and rest becomes your response variable (we don\u2019t consider the actual target variable in this process as it can create bias in modeling later). Once, we create data like this, the stepwise process is being used to develop linear regression and after the regression parameter is being estimated, the prediction of the missing values is achieved.", "Now, in case you have to estimate two/multiple variables of 1 record, then we will use the following approach:", "Step 1: Build the regression model to impute for the 1st variable, don\u2019t include the second variable as a predictor variable.", "Step 2: Construct a regression model to impute for the 2nd variable, including the values of the second variable found in step 1 as well.", "2.3) Replace missing value when the variable is categorical: There are multiple ways to impute your data on continuous variables. A few of them are listed below.", "a) With mode: Categorical variables can be imputed using mode (value having highest frequency) within that variable. This is easiest way to impute values for categorical variables, but this process can create bias in the data, as you will be imputing the same value across all missing space within a variable.", "Here in this variable, most of the missing value becomes married, and if most of the data becomes of one class out of two, then it may happen that this variable may be able to provide much insight.", "b) With Decision tree or logistic regression: Another way to impute missing data for the categorical variables is through the Decision Tree. In this case, too, the variable for which you want to do the imputation becomes your target variable and rest becomes your predictor variable (we don\u2019t consider the actual target variable in this process as it can create bias in modeling later). Once, we create data like this, you can run the CART algorithm to find the rules and based on that imputation can be done for categorical variables.", "Let\u2019s say, in our case we want to impute, Marital Status, then we will be considering the data like this where Marital Status becomes the target variable and rest other variables becomes predictor variable. Also, missing value rows will be removed from the variables.", "Thus, the Decision tree will provide you rules as Age>35 and Job = management and Credit Default = No, then 96% data is Married and 4% is Single. Hence, the missing values can be replaced by looking at the information for other variables with 96% accuracy.", "c) Replace missing value with K-Nearest Neighbor (KNN): KNN is one of the most used methods to impute missing value. It can be used on both continuous as well as categorical variables. KNN algorithm works on similarity measures such as Euclidean distance, Cosine distance, Hamming distance, etc. The basic approach of KKN is that it tries to find out the nearest neighbor among all the observation wrt the observation in consideration for imputation by distance measures. The observation which is having the lowest value of distance are considered neighbors and then the average of the K neighbors is taken to impute the missing value to make it more precise. K can take any value as top 3 neighbors, 5 neighbors, etc.", "In the below example, we have 4 customer ids and three variables (here I have considered an only continuous variable as to find distance using Euclidian distance, for ease of explaining, otherwise categorical variable can also be used.", "So the distance from C1 for each of three customers have been calculated, variables for which data is missing will be dropped for distance calculation and rest variables will be taken, this distance will be calculated from each of the neighbors. We can see that customer 4 has the lowest distance from customer 1, so customers 4 and 1 are considered the nearest neighbors for each other, thus value can be imputed. Also, instead of taking one nearest neighbor, we can take 5 nearest neighbors and, average values can be imputed.", "Now, there are two strategies to identify who will act as a neighbor for observation and then the nearest neighbor calculation will be performed: one is complete case strategy and other being incomplete case strategy.", "But one must be aware that this process is time-consuming when data size is too large.", "Thus, missing values can be imputed with a lot of techniques and methods, there is no right or wrong way of doing the imputation, it\u2019s just that which method is suiting your data set most and giving you the most accurate results. There is no way to replace the exact data in the missing space, but one can try on how much close values can be replaced.", "That's all about part 1 of Data preprocessing where I have talked about data redundancy and Missing value imputation and in part 2 of data preprocessing, I will discuss Outliers and Data transformation.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Enthusiast l Consultant - Advanced Analytics | IIM B"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F7d13ae5663fa&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-preprocessing-art-or-science-7d13ae5663fa&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-preprocessing-art-or-science-7d13ae5663fa&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-preprocessing-art-or-science-7d13ae5663fa&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-preprocessing-art-or-science-7d13ae5663fa&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----7d13ae5663fa--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----7d13ae5663fa--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@anshulkanthaliya21?source=post_page-----7d13ae5663fa--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@anshulkanthaliya21?source=post_page-----7d13ae5663fa--------------------------------", "anchor_text": "Anshul Kanthaliya"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fb4be818db528&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-preprocessing-art-or-science-7d13ae5663fa&user=Anshul+Kanthaliya&userId=b4be818db528&source=post_page-b4be818db528----7d13ae5663fa---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F7d13ae5663fa&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-preprocessing-art-or-science-7d13ae5663fa&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F7d13ae5663fa&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-preprocessing-art-or-science-7d13ae5663fa&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://medium.com/tag/data-science?source=post_page-----7d13ae5663fa---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----7d13ae5663fa---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/data-analysis?source=post_page-----7d13ae5663fa---------------data_analysis-----------------", "anchor_text": "Data Analysis"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F7d13ae5663fa&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-preprocessing-art-or-science-7d13ae5663fa&user=Anshul+Kanthaliya&userId=b4be818db528&source=-----7d13ae5663fa---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F7d13ae5663fa&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-preprocessing-art-or-science-7d13ae5663fa&user=Anshul+Kanthaliya&userId=b4be818db528&source=-----7d13ae5663fa---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F7d13ae5663fa&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-preprocessing-art-or-science-7d13ae5663fa&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----7d13ae5663fa--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F7d13ae5663fa&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-preprocessing-art-or-science-7d13ae5663fa&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----7d13ae5663fa---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----7d13ae5663fa--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----7d13ae5663fa--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----7d13ae5663fa--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----7d13ae5663fa--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----7d13ae5663fa--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----7d13ae5663fa--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----7d13ae5663fa--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----7d13ae5663fa--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@anshulkanthaliya21?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@anshulkanthaliya21?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Anshul Kanthaliya"}, {"url": "https://medium.com/@anshulkanthaliya21/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "41 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fb4be818db528&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-preprocessing-art-or-science-7d13ae5663fa&user=Anshul+Kanthaliya&userId=b4be818db528&source=post_page-b4be818db528--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fusers%2Fb4be818db528%2Flazily-enable-writer-subscription&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-preprocessing-art-or-science-7d13ae5663fa&user=Anshul+Kanthaliya&userId=b4be818db528&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}