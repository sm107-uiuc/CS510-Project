{"url": "https://towardsdatascience.com/kaggle-3rd-place-solution-jigsaw-multilingual-toxic-comment-classification-e36d7d194bfb", "time": 1683013396.529781, "path": "towardsdatascience.com/kaggle-3rd-place-solution-jigsaw-multilingual-toxic-comment-classification-e36d7d194bfb/", "webpage": {"metadata": {"title": "Kaggle 3rd Place Solution \u2014 Jigsaw Multilingual Toxic Comment Classification | by Moiz Saifee | Towards Data Science", "h1": "Kaggle 3rd Place Solution \u2014 Jigsaw Multilingual Toxic Comment Classification", "description": "I had recently participated in the Jigsaw Multilingual Toxic Comment Classification challenge at Kaggle and our team (ACE team) secured 3rd place on the final leader board. In this blog, I describe\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.kaggle.com/c/jigsaw-multilingual-toxic-comment-classification", "anchor_text": "Jigsaw Multilingual Toxic Comment Classification", "paragraph_index": 0}, {"url": "http://en.wikipedia.org/wiki/Receiver_operating_characteristic", "anchor_text": "ROC AUC", "paragraph_index": 2}, {"url": "https://jigsaw.google.com/", "anchor_text": "Jigsaw", "paragraph_index": 4}, {"url": "https://towardsdatascience.com/recent-advancements-in-nlp-2-2-df2ee75e189", "anchor_text": "earlier", "paragraph_index": 14}, {"url": "https://cloud.google.com/tpu", "anchor_text": "Google\u2019s TPU", "paragraph_index": 22}, {"url": "https://github.com/moizsaifee/kaggle-jigsaw-multilingual-toxic-comment-classification-3rd-place-solution", "anchor_text": "link", "paragraph_index": 24}], "all_paragraphs": ["I had recently participated in the Jigsaw Multilingual Toxic Comment Classification challenge at Kaggle and our team (ACE team) secured 3rd place on the final leader board. In this blog, I describe the problem statement, our approach, and the learnings we had from the competition. I have also provided the link to our full code towards the end of the blog.", "The goal of the competition was to detect toxicity (for example rudeness, disrespect, or threat) in user comments during online interaction. This is a very real-life problem given the increase in trolling and hatred on social media etc these days.", "The problem was set up as a vanilla text classification problem where one had to predict the probability of a (text) comment being toxic and the submissions were evaluated on a ROC AUC metric", "The most interesting part of the problem was that \u2014 the toxicity had to be identified in 6 different languages, and there was no training data provided at all for 3 of them, and there was very little training data for the remaining 3.", "The competition was organized by Jigsaw, which is a Google company, that builds tools to deal with problems like toxicity, disinformation, harassment radicalization in online content. This was the third toxicity detection competition conducted by Jigsaw (although the first one that was multilingual in nature).", "Detecting toxicity is a lot more than just detecting abusive words in the text. As an example, consider the following comment, which doesn\u2019t have any abusive words, but is still toxic", "I just wanted to have a little fun, captain buzz kill. I guess you never had a life when you were young. that was probably like, 100000000000000000 years old", "In addition to this, if you are trying to solve the problem across multiple languages, it becomes quite a handful.", "The figure above shows high-level overview of various components of our final solution, along with their individual scores (ROC) and weights, that led to our final score of 0.9523.", "The final solution was a blend of diverse underlying models trained in a variety of ways. \u201cRoberta\u201d in the above figure represents models derived off RoBERTa XLM architecture and Mono Bert represents Bert Base models pre-trained on the text of a specific language.", "The flowchart below gives high-level technical overview of our solution. I\u2019ll share various fine details in the section that follows", "We used the following datasets for model training in the competition:", "Train data was prepared from the above items using stratified sampling ensuring class balance.", "Translating the labeled English data to target languages help in absence of labeled data in the target language, but its not as good as the data in the target language itself because the process of translation strips the text of some subtlety which is at times important to detect toxicity.", "Transformer architecture based pre-trained (transfer learning) models are the rage in NLP since 2018. Conceptually they are deep learning models trained on huge (terabytes) of text data due to which they learn a very good numerical representation of languages (words, text). These representations are useful in a variety of downstream tasks. You can read more details on Transformers and Transfer Learning in one of my earlier blogs", "RoBERTa XLM, a variant of Google\u2019s Bert in terms of architecture, and pre-trained on 100+ languages was the workhorse in the competition. It performs surprisingly well out of the box and performed decently even with just English training data on other languages.", "In addition to the multilingual model described above, we also used Bert models pre-trained on specific languages of interest. These mono-lingual models performed better for the individual language they were trained on, compared to the multilingual models as one would expect (for a given model capacity, per language performance goes down as we increase the number of languages). But this method is slightly less elegant in practice as it's cumbersome to maintain language-specific models in production if you are dealing with a lot of languages.", "This is where a lot of art and experience come into play. We used various strategies for model training:", "It's a well-known fact that blending predictions from various diverse models tend to outperform the underlying individual model predictions, and is often the best way to improve the final predictions.", "Our final solution was a blend of predictions from 4 families of models as described in \u201cSolution Overview\u201d. We trained multi-fold models (training on different subsets of data) within each family to end up with about 30 (!!) odd models.", "We took a straight average of multifold predictions within each family and a weighted average of predictions across different families of models. We didn\u2019t really have a quality dataset, which was unseen by underlying models, to come with the weights across the family, so we used some intuition, leader board feedback, and experimentation to determine these weights.", "Test Time Augmentation (TTA) is a technique where we make the prediction on not just a test example, but also some of its variants, to end up with a better final prediction. We employed this technique in some of our underlying models, and it gave us a minor boost, here is how it worked:", "It's no secret that Deep Learning models run a lot faster on GPU compared to a CPU, but Google\u2019s TPU is way faster than even a GPU. They are just phenomenal in terms of memory (allow higher batch size) and speed (allow quick experimentation) they provide and make the training process a lot less painful.", "We extensively used the free TPU quota provided by Kaggle and Google Colab during the competition to train our models.", "Here is the link to our complete code", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Senior Principal at Correlation Venture. Passionate about Artificial Intelligence. Kaggle Master; IIT Kharagpur alum"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fe36d7d194bfb&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fkaggle-3rd-place-solution-jigsaw-multilingual-toxic-comment-classification-e36d7d194bfb&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fkaggle-3rd-place-solution-jigsaw-multilingual-toxic-comment-classification-e36d7d194bfb&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fkaggle-3rd-place-solution-jigsaw-multilingual-toxic-comment-classification-e36d7d194bfb&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fkaggle-3rd-place-solution-jigsaw-multilingual-toxic-comment-classification-e36d7d194bfb&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----e36d7d194bfb--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----e36d7d194bfb--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@moiz.saifee?source=post_page-----e36d7d194bfb--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@moiz.saifee?source=post_page-----e36d7d194bfb--------------------------------", "anchor_text": "Moiz Saifee"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fe747ca1923f5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fkaggle-3rd-place-solution-jigsaw-multilingual-toxic-comment-classification-e36d7d194bfb&user=Moiz+Saifee&userId=e747ca1923f5&source=post_page-e747ca1923f5----e36d7d194bfb---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe36d7d194bfb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fkaggle-3rd-place-solution-jigsaw-multilingual-toxic-comment-classification-e36d7d194bfb&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe36d7d194bfb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fkaggle-3rd-place-solution-jigsaw-multilingual-toxic-comment-classification-e36d7d194bfb&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://www.kaggle.com/c/jigsaw-multilingual-toxic-comment-classification", "anchor_text": "Jigsaw Multilingual Toxic Comment Classification"}, {"url": "http://en.wikipedia.org/wiki/Receiver_operating_characteristic", "anchor_text": "ROC AUC"}, {"url": "https://jigsaw.google.com/", "anchor_text": "Jigsaw"}, {"url": "http://opus.nlpl.eu/OpenSubtitles-v2018.php", "anchor_text": "Open Subtitles data"}, {"url": "https://www.kaggle.com/cdeotte/pseudo-labeling-qda-0-969", "anchor_text": "pseudo labeling"}, {"url": "https://towardsdatascience.com/recent-advancements-in-nlp-2-2-df2ee75e189", "anchor_text": "earlier"}, {"url": "https://cloud.google.com/tpu", "anchor_text": "Google\u2019s TPU"}, {"url": "https://github.com/moizsaifee/kaggle-jigsaw-multilingual-toxic-comment-classification-3rd-place-solution", "anchor_text": "link"}, {"url": "https://medium.com/tag/nlp?source=post_page-----e36d7d194bfb---------------nlp-----------------", "anchor_text": "NLP"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----e36d7d194bfb---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/kaggle?source=post_page-----e36d7d194bfb---------------kaggle-----------------", "anchor_text": "Kaggle"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----e36d7d194bfb---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----e36d7d194bfb---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fe36d7d194bfb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fkaggle-3rd-place-solution-jigsaw-multilingual-toxic-comment-classification-e36d7d194bfb&user=Moiz+Saifee&userId=e747ca1923f5&source=-----e36d7d194bfb---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fe36d7d194bfb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fkaggle-3rd-place-solution-jigsaw-multilingual-toxic-comment-classification-e36d7d194bfb&user=Moiz+Saifee&userId=e747ca1923f5&source=-----e36d7d194bfb---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe36d7d194bfb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fkaggle-3rd-place-solution-jigsaw-multilingual-toxic-comment-classification-e36d7d194bfb&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----e36d7d194bfb--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fe36d7d194bfb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fkaggle-3rd-place-solution-jigsaw-multilingual-toxic-comment-classification-e36d7d194bfb&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----e36d7d194bfb---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----e36d7d194bfb--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----e36d7d194bfb--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----e36d7d194bfb--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----e36d7d194bfb--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----e36d7d194bfb--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----e36d7d194bfb--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----e36d7d194bfb--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----e36d7d194bfb--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@moiz.saifee?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@moiz.saifee?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Moiz Saifee"}, {"url": "https://medium.com/@moiz.saifee/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "365 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fe747ca1923f5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fkaggle-3rd-place-solution-jigsaw-multilingual-toxic-comment-classification-e36d7d194bfb&user=Moiz+Saifee&userId=e747ca1923f5&source=post_page-e747ca1923f5--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F408ae670d9f1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fkaggle-3rd-place-solution-jigsaw-multilingual-toxic-comment-classification-e36d7d194bfb&newsletterV3=e747ca1923f5&newsletterV3Id=408ae670d9f1&user=Moiz+Saifee&userId=e747ca1923f5&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}