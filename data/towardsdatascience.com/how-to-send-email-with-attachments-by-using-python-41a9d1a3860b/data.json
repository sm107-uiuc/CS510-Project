{"url": "https://towardsdatascience.com/how-to-send-email-with-attachments-by-using-python-41a9d1a3860b", "time": 1683000888.8184981, "path": "towardsdatascience.com/how-to-send-email-with-attachments-by-using-python-41a9d1a3860b/", "webpage": {"metadata": {"title": "How to Send Email with Attachments by using Python | by June Tao Ching | Towards Data Science", "h1": "How to Send Email with Attachments by using Python", "description": "As a Data Analyst, most often than not I receive requests like \u201cCan you send this report to me on a weekly basis?\u201d or \u201cCan you send this data to me through email every month?\u201d. Sending report is easy\u2026"}, "outgoing_paragraph_urls": [{"url": "https://docs.python.org/3/library/smtplib.html", "anchor_text": "SMTP Protocol Client", "paragraph_index": 2}, {"url": "https://github.com/chingjunetao/google-service-with-python/tree/master/email-with-python", "anchor_text": "Github", "paragraph_index": 13}], "all_paragraphs": ["As a Data Analyst, most often than not I receive requests like \u201cCan you send this report to me on a weekly basis?\u201d or \u201cCan you send this data to me through email every month?\u201d. Sending report is easy but it will be irritating if you have to do the same thing every week. That\u2019s why you should learn how to use python to send email/report and schedule the script on your server.", "In this article, I will show you how to extract data from Google BigQuery and send it as a report. You can jump to the Email part if you only want to know how to send the email using Python.", "As usual, we will have to import the libraries before going into the coding part. We will be using SMTP Protocol Client to send the email. ConfigParser is used to read config file that storing the SQL query. I will explain the detail in next part.", "First, you have to create a config file to store all the SQL queries. Separating python script with SQL query is a good practice especially when your SQL query is long (more than 20 lines). By doing this, your main script will not be cluttered by long SQL query.", "[report1] is your sub-confiq. filename , dialect and query are the attributes of the sub-config.", "You can read the config file by using the following codes.", "This self define function will read the attributes of the sub-config file that you pass in and output a CSV file.", "yourProjectID will be your BigQuery Project ID while credential.json will be your BigQuery Credential JSON file. You can remove this if you wish to use Web Auth to login.", "Now, you just need a loop to extract all the files you define in your config file. config.sections() will return you a list of sub-config file in your config file.", "Above is how you define your email attributes such as From, To, CC and Subject. The htmlEmail will be your email body. You can use plain text or html as your email body. I prefer to use html because I can do more formatting like bold, italic and change the colour of the font.", "The same thing, we will use loop to attach all the file.", "For demo purpose, the password is hard coded inside the script. This isn\u2019t a good practice. You should save your password in other file for better security.", "Now you have learnt how to send email with attachments by using Python. Do drop me a comment if I made any mistake or typo.", "You can view the complete scripts in my Github. Give me a clap to support me if you think this article is useful to you. Cheers!", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Analytics @ Binance | Love to learn and share"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F41a9d1a3860b&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-send-email-with-attachments-by-using-python-41a9d1a3860b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-send-email-with-attachments-by-using-python-41a9d1a3860b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-send-email-with-attachments-by-using-python-41a9d1a3860b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-send-email-with-attachments-by-using-python-41a9d1a3860b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----41a9d1a3860b--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----41a9d1a3860b--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@chingjunetao?source=post_page-----41a9d1a3860b--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@chingjunetao?source=post_page-----41a9d1a3860b--------------------------------", "anchor_text": "June Tao Ching"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F694172770f8f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-send-email-with-attachments-by-using-python-41a9d1a3860b&user=June+Tao+Ching&userId=694172770f8f&source=post_page-694172770f8f----41a9d1a3860b---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F41a9d1a3860b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-send-email-with-attachments-by-using-python-41a9d1a3860b&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F41a9d1a3860b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-send-email-with-attachments-by-using-python-41a9d1a3860b&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@webhost?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Web Hosting"}, {"url": "https://unsplash.com/s/photos/email?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://docs.python.org/3/library/smtplib.html", "anchor_text": "SMTP Protocol Client"}, {"url": "https://github.com/chingjunetao/google-service-with-python/tree/master/email-with-python", "anchor_text": "Github"}, {"url": "https://medium.com/tag/email?source=post_page-----41a9d1a3860b---------------email-----------------", "anchor_text": "Email"}, {"url": "https://medium.com/tag/python?source=post_page-----41a9d1a3860b---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/programming?source=post_page-----41a9d1a3860b---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/tag/data-science?source=post_page-----41a9d1a3860b---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/automation?source=post_page-----41a9d1a3860b---------------automation-----------------", "anchor_text": "Automation"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F41a9d1a3860b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-send-email-with-attachments-by-using-python-41a9d1a3860b&user=June+Tao+Ching&userId=694172770f8f&source=-----41a9d1a3860b---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F41a9d1a3860b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-send-email-with-attachments-by-using-python-41a9d1a3860b&user=June+Tao+Ching&userId=694172770f8f&source=-----41a9d1a3860b---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F41a9d1a3860b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-send-email-with-attachments-by-using-python-41a9d1a3860b&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----41a9d1a3860b--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F41a9d1a3860b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-send-email-with-attachments-by-using-python-41a9d1a3860b&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----41a9d1a3860b---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----41a9d1a3860b--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----41a9d1a3860b--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----41a9d1a3860b--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----41a9d1a3860b--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----41a9d1a3860b--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----41a9d1a3860b--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----41a9d1a3860b--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----41a9d1a3860b--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@chingjunetao?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@chingjunetao?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "June Tao Ching"}, {"url": "https://medium.com/@chingjunetao/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "469 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F694172770f8f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-send-email-with-attachments-by-using-python-41a9d1a3860b&user=June+Tao+Ching&userId=694172770f8f&source=post_page-694172770f8f--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F1eab7de7ecbe&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-send-email-with-attachments-by-using-python-41a9d1a3860b&newsletterV3=694172770f8f&newsletterV3Id=1eab7de7ecbe&user=June+Tao+Ching&userId=694172770f8f&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}