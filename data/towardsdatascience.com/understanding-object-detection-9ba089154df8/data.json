{"url": "https://towardsdatascience.com/understanding-object-detection-9ba089154df8", "time": 1683002352.793634, "path": "towardsdatascience.com/understanding-object-detection-9ba089154df8/", "webpage": {"metadata": {"title": "Understanding Object Detection. From the history of object detection\u2026 | by Frederik Mattwich | Towards Data Science", "h1": "Understanding Object Detection", "description": "In this article, I want to give you an overview of the history of object detectors and will explain how the architectures evolved to current state-of-the art detectors. Furthermore, I will go into\u2026"}, "outgoing_paragraph_urls": [{"url": "https://github.com/tensorflow/models/tree/master/research/object_detection", "anchor_text": "Tensorflow Object detection API", "paragraph_index": 0}, {"url": "https://github.com/tensorflow/models/tree/master/research/object_detection", "anchor_text": "Object Detection API by Tensorflow", "paragraph_index": 12}, {"url": "https://arxiv.org/pdf/1311.2524.pdf", "anchor_text": "Rich feature hierarchies for accurate object detection and semantic segmentation", "paragraph_index": 13}, {"url": "https://arxiv.org/pdf/1406.4729.pdf", "anchor_text": "Spatial pyramid pooling in deep convolutional networks for visual recognition", "paragraph_index": 14}], "all_paragraphs": ["In this article, I want to give you an overview of the history of object detectors and will explain how the architectures evolved to current state-of-the art detectors. Furthermore, I will go into detail about the inner workings of Faster R-CNN, hence it is very widely used and also part of the Tensorflow Object detection API.", "Object detection combines the tasks of object classification and localization. Current object detectors can be divided into two categories: Networks separating the tasks of determining the location of objects and their classification, where Faster R-CNN is one of the most famous ones, and networks which predict bounding boxes and class scores at once, with the YOLO and SSD networks being famous architectures.", "The first deep neural network for object detection was Overfeat [1]. They introduced a multi-scale sliding window approach using CNNs and showed that object detection also improved image classification. They were shortly followed by R-CNN: Regions with CNN features [2]. The authors proposed a model that used selective-search for generating region proposals by merging similar pixels into regions. Each region was fed into a CNN, which produced a high dimensional feature vector. This vector was then used for the final classification and bounding box regression, as shown in Figure 1.", "It outperformed the Overfeat network by a large margin but was also very slow, because the proposal generation using selective-search was very time-intensive, as well as the need to feed every single proposal through a CNN. A more sophisticated approach, Fast R-CNN [3], also generated region proposals with selective-search but fed the whole image through a CNN. The region proposals were pooled directly on the feature map by ROI pooling. The pooled feature vectors were fed into a fully connected network for classification and regression, as depicted in Figure 2. Similar to R-CNN, Fast R-CNN generated the region proposals with selective-search.", "Faster R-CNN [4] addressed this issue by proposing a novel region proposal network, that was fused with the Fast R-CNN architecture to drastically speed up the process and will be explained in greater detail in the next section. Another approach to detected object in images was R-FCN [5], the region fully convolutional network, that used position-sensitive score maps instead of a pre-region subnetwork.", "The design of object detection networks was revolutionized by the YOLO [6] network. It follows completely different approach to the aforementioned models and is capable of predicting class scores and bounding boxes at once. The proposed model divided the image into a grid, where each cell predicted a confidence score of an object being present with the corresponding bounding box coordinates. This allowed YOLO real-time predictions. The authors also released two more versions, YOLO9000 [7], and YOLOv2, where the former was capable of predicting over 9000 categories, and the latter one was capable of processing larger images. Another network that predicts classes and bounding boxes at once is the single shot detector, SSD [8]. It is comparable to YOLO but used multiple aspect ratios per grid cell and more convolutional layers to improve prediction.", "The major problem of Fast R-CNN and R-CNN was the time and resource-intensive generation of region proposals. Faster R-CNN solved this by fusing Fast R-CNN with a region proposal network (RPN), as depicted in Figure 3. The RPN uses the output of the CNN as input and generates region proposals, where each proposal consists of an objectness score, as well as the object\u2019s location. The RPN can be trained jointly with the detection network, speeding up the training and inference time. Faster R-CNN is up to 34 times faster than Fast R-CNN. In the following paragraphs each step of Faster R-CNN is explained in greater detail.", "The objective of Faster R-CNN is to detect objects as rectangular bounding boxes. These rectangles can be of varying size and scale. When previous works tried to consider objects of varying size and scale, they either created image pyramids, where multiple sizes of the image were considered, or pyramids of filters, where multiple different sized convolutional filters were applied [1, 9, 10]. These approaches worked on the input image, whereas Faster R-CNN works on the feature map from the output of a CNN and is thus creating a pyramid of anchors. An anchor is a fixed bounding box, that consists of a center point, a specific width and height, and references a bounding box on the original image. A set of anchors, which consists of multiple anchors of different combinations of sizes and scales, is generated for each position from a sliding window on the feature map. Figure 4 shows an example, where a window of size 3x3 generates k anchors, where each anchor has the same center point in the original image. This is possible, because the convolution operation is invariant to translation, and a position on the feature map can be calculated back to a region in an image.", "The RPN is a fully convolutional network and directly works on the feature map in order to generate region proposals, as depicted in figure 5. It takes the anchors as input, predicts an objectness score and performs box regression. The former is the likeliness of an anchor being an object or background, and the latter corresponds to the offset from the anchor to the actual box. Therefore, for k anchors, the RPN predicts 2k scores and 4k box regression values. The initial number of anchors does not need to be smaller than from any other region proposal method since the RPN reduces the number of anchors drastically by only considering regions that have a high objectness score. Training the RPN is not trivial. Since this is a supervised learning approach, each anchor has to be labeled either foreground or background. Therefore, every anchor has to be compared to every ground truth object by calculating their intersection over union (IoU). An anchor is considered to be foreground and positive if there exists an IoU with a groundtruth object greater than 0.7. It is considered to be background and negative if the IoU to every groundtruth box is lower than 0.3. All anchors that have an IoU between 0.3 and 0.7 are ignored. The distribution of positive and negative proposals is very imbalanced because there are way more negative than positive proposals per groundtruth box. Therefore, a minibatch with a fixed number of positives and negatives is sampled for the training process. If there are not enough positive proposals, the batch is filled with the proposals, that have the highest IoU for the respective groundtruth box. If there are still not enough positive proposals, they will be padded with negatives. The RPN employs a multitask loss to optimize both objectives simultaneously. For classification, a binary cross-entropy loss and for bounding box regression a smooth L1 loss is used. Architecture of the region proposal network, which is a fully convolutional network.", "The regression loss is only calculated for positive anchors. Non maximum suppression (NMS) is applied after prediction to remove region proposals that have an IoU with other region proposals higher than a certain value, but a lower objectness score. After NMS, the top N proposals are selected as the final region proposals.", "The next step after the RPN is to use the region proposals in order to predict object classes and localization. Instead of the approach of R-CNN, where each proposal is fed through a classification network, Faster R-CNN makes use of the feature map to extract the features. Since a classifier expects a fixed-size input, fixed-size features are extracted for each region proposal from the feature map. In modern implementations, the feature map is cropped by the region proposal and resized to a fixed size. Max pooling extracts the most salient features afterwards, leading to a fixed size for each region proposal, which is then fed into the final stage.", "The last step in Faster R-CNN is the classification of the extracted features. Therefore, the pooled features are flattened and input to two fully connected layers, which handle classification and regression. The classification layer outputs N+1 predictions, one for each of the N classes, plus one background class. The regression layer outputs 4N predictions, where each represents the regressed bounding box for each of the N classes. The training of the R-CNN module is comparable to the one of the RPN. A proposal is assigned to each groundtruth box with an IoU of greater than 0.5. Proposals with an IoU between 0.1 and 0.5 are treated as negatives and backgrounds and proposals with an IoU lower than 0.1 are ignored. Random sampling during training creates a mini-batch containing 25 percent foreground and 75 percent background proposals. The classification loss is a multiclass cross entropy loss using all proposals in the mini-batch, whereas the localization loss only uses positive proposals. In order to remove duplicates, class based NMS is applied. The final output is a list of all predicted objects with a probability higher than a specific threshold, mostly 0.5.", "There are many different ways to detect objects in images. This blogpost showed the history from slow networks using selective search for generating region proposals to more sophisticated networks, such as Faster R-CNN. If you want to get started with object detection, I recommend the Object Detection API by Tensorflow, which mainly features the Faster R-CNN and SSD architectures. Thanks for reading!", "[2] R. B. Girshick, J. Donahue, T. Darrell, and J. Malik, Rich feature hierarchies for accurate object detection and semantic segmentation, 2014 IEEE Conference on Computer Vision and Pattern Recognition, pp. 580\u2013587, 2014.", "[10] K. He, X. Zhang, S. Ren, and J. Sun, Spatial pyramid pooling in deep convolutional networks for visual recognition, IEEE Transactions on Pattern Analysis and Machine Intelligence, vol. 37, pp. 1904\u20131916, 2014.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Co-Founder and CTO of Design AI"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F9ba089154df8&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-object-detection-9ba089154df8&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-object-detection-9ba089154df8&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-object-detection-9ba089154df8&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-object-detection-9ba089154df8&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----9ba089154df8--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----9ba089154df8--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@frederik.mattwich?source=post_page-----9ba089154df8--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@frederik.mattwich?source=post_page-----9ba089154df8--------------------------------", "anchor_text": "Frederik Mattwich"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F2b3d0333b9ed&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-object-detection-9ba089154df8&user=Frederik+Mattwich&userId=2b3d0333b9ed&source=post_page-2b3d0333b9ed----9ba089154df8---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F9ba089154df8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-object-detection-9ba089154df8&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F9ba089154df8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-object-detection-9ba089154df8&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://medium.com/towards-data-science/inside-ai/home", "anchor_text": "Inside AI"}, {"url": "https://github.com/tensorflow/models/blob/master/research/object_detection/g3doc/img/kites_detections_output.jpg", "anchor_text": "Source"}, {"url": "https://github.com/tensorflow/models/tree/master/research/object_detection", "anchor_text": "Tensorflow Object detection API"}, {"url": "https://github.com/tensorflow/models/tree/master/research/object_detection", "anchor_text": "Object Detection API by Tensorflow"}, {"url": "https://arxiv.org/pdf/1312.6229.pdf", "anchor_text": "Overfeat: Integrated recognition, localization and detection using convolutional networks"}, {"url": "https://arxiv.org/pdf/1311.2524.pdf", "anchor_text": "Rich feature hierarchies for accurate object detection and semantic segmentation"}, {"url": "https://arxiv.org/pdf/1504.08083.pdf", "anchor_text": "Fast r-cnn"}, {"url": "https://arxiv.org/pdf/1506.01497v3.pdf", "anchor_text": "Faster r-cnn: Towards real-time object detection with region proposal networks"}, {"url": "https://arxiv.org/pdf/1605.06409.pdf", "anchor_text": "Object detection via region-based fully convolutional networks"}, {"url": "https://arxiv.org/pdf/1506.02640.pdf", "anchor_text": "You only look once: Unified, real-time object detection"}, {"url": "https://arxiv.org/pdf/1612.08242.pdf", "anchor_text": "Yolo9000: Better, faster, stronger"}, {"url": "https://arxiv.org/pdf/1512.02325.pdf", "anchor_text": "Ssd: Single shot multibox detector"}, {"url": "https://ieeexplore.ieee.org/document/5255236", "anchor_text": "Object detection with discriminatively trained part-based models"}, {"url": "https://arxiv.org/pdf/1406.4729.pdf", "anchor_text": "Spatial pyramid pooling in deep convolutional networks for visual recognition"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----9ba089154df8---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/object-detection?source=post_page-----9ba089154df8---------------object_detection-----------------", "anchor_text": "Object Detection"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----9ba089154df8---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----9ba089154df8---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----9ba089154df8---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F9ba089154df8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-object-detection-9ba089154df8&user=Frederik+Mattwich&userId=2b3d0333b9ed&source=-----9ba089154df8---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F9ba089154df8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-object-detection-9ba089154df8&user=Frederik+Mattwich&userId=2b3d0333b9ed&source=-----9ba089154df8---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F9ba089154df8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-object-detection-9ba089154df8&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----9ba089154df8--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F9ba089154df8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-object-detection-9ba089154df8&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----9ba089154df8---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----9ba089154df8--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----9ba089154df8--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----9ba089154df8--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----9ba089154df8--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----9ba089154df8--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----9ba089154df8--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----9ba089154df8--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----9ba089154df8--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@frederik.mattwich?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@frederik.mattwich?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Frederik Mattwich"}, {"url": "https://medium.com/@frederik.mattwich/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "21 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F2b3d0333b9ed&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-object-detection-9ba089154df8&user=Frederik+Mattwich&userId=2b3d0333b9ed&source=post_page-2b3d0333b9ed--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fusers%2F2b3d0333b9ed%2Flazily-enable-writer-subscription&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-object-detection-9ba089154df8&user=Frederik+Mattwich&userId=2b3d0333b9ed&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}