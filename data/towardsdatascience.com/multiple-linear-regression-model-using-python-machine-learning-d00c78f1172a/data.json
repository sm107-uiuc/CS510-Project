{"url": "https://towardsdatascience.com/multiple-linear-regression-model-using-python-machine-learning-d00c78f1172a", "time": 1683015203.194765, "path": "towardsdatascience.com/multiple-linear-regression-model-using-python-machine-learning-d00c78f1172a/", "webpage": {"metadata": {"title": "Multiple Linear Regression model using Python: Machine Learning | by Kaushik Katari | Towards Data Science", "h1": "Multiple Linear Regression model using Python: Machine Learning", "description": "Linear regression performs a regression task on a target variable based on independent variables in a given data. It is a machine learning algorithm and is often used to find the relationship between\u2026"}, "outgoing_paragraph_urls": [{"url": "https://towardsdatascience.com/simple-linear-regression-model-using-python-machine-learning-eab7924d18b4", "anchor_text": "Simple Linear Regression", "paragraph_index": 1}, {"url": "https://github.com/Kaushik-Varma/mlr", "anchor_text": "here", "paragraph_index": 8}, {"url": "https://towardsdatascience.com/simple-linear-regression-model-using-python-machine-learning-eab7924d18b4", "anchor_text": "simple linear regression", "paragraph_index": 22}], "all_paragraphs": ["Linear regression performs a regression task on a target variable based on independent variables in a given data. It is a machine learning algorithm and is often used to find the relationship between the target and independent variables.", "The Simple Linear Regression model is to predict the target variable using one independent variable.", "When one variable/column in a dataset is not sufficient to create a good model and make more accurate predictions, we\u2019ll use a multiple linear regression model instead of a simple linear regression model.", "The line equation for the multiple linear regression model is:", "Before proceeding further on building the model using python, we need to consider some things:", "We\u2019ll discuss points 2 & 3 using python code.", "Now, let\u2019s dive into the Jupyter notebook and see how we can build the Python model.", "We read the data into our system and understand if the data has any anomalies.", "For the remainder of the article, we are using the dataset, which can be downloaded from here.", "The target variable/column in the dataset is Price.", "We\u2019ll import the necessary libraries to read the data and convert it into a pandas dataframe.", "The sample data frame looks like this,", "Let\u2019s see for any null values in the dataset using .info(), and also, we have to check for any outliers using .describe().", "Observe, there are no null values in the data, and also, there are no outliers in the data.", "If we observe the dataset, there are numeric values and columns with values as \u2018Yes\u2019 or \u2018No.\u2019 But to fit a regression line, we need numeric values, so we\u2019ll convert \u2018Yes\u2019 and \u2018No\u2019 as 1s and 0s.", "The furnishingstatus column has three levels furnished, semi_furnished, and unfurnished.", "We need to convert this column into numerical as well. To do that, we\u2019ll use dummy variables.", "When you have a categorical variable with n-levels, the idea of creating a dummy variable is to build \u2018n-1\u2019 variables, indicating the levels.", "We can create a dummy variable using the get_dummies method in pandas.", "Let\u2019s see how the furnishstatus column looks like in a dataset.", "Now, we don\u2019t need three columns. We can drop the furnished column, as it can be identified with just the last two columns values where:", "Let\u2019s drop the furnished column and add the status dataset into our original dataset. After that, we\u2019ll drop the furnishstatus column from the dataset.", "Now let\u2019s build the model. As we have seen in the simple linear regression model article, the first step is to split the dataset into train and test data.", "We\u2019ll split the data into two datasets to a 7:3 ratio.", "We can see that all the columns have smaller integer values in the dataset except the area column. So it is important to re-scale the variables so that they all have a comparable scale. If we don\u2019t have relative scales, then some of the regression model coefficients will be of different units compared to the other coefficients.", "To do that, we use the MinMax scaling method.", "The training dataset looks like this,", "Before building the model, we need to divide the data into X and Y sets.", "First, we\u2019ll add the variables except for the target variable to the model.", "Adding all the variables to the model", "The summary of the model is,", "If we look at the p-values of some of the variables, the values seem to be pretty high, which means they aren\u2019t significant. That means we can drop those variables from the model.", "Before dropping the variables, as discussed above, we have to see the multicollinearity between the variables. We do that by calculating the VIF value.", "Variance Inflation Factor or VIF is a quantitative value that says how much the feature variables are correlated with each other. It is an extremely important parameter to test our linear model. The formula for VIF is:", "In python, we can calculate the VIF values by importing variance_inflation_factor from statsmodels", "The VIF values for every column is,", "We consider the variables generally having a value <5. If we observe the above image clearly, there are some variables we need to drop.", "While dropping the variables, the first preference will go to the p-value. Also, we have to drop one variable at a time.", "Dropping the variable and updating the modelAs we can see from the summary and the VIF, some variables are still insignificant. One of these variables is semi-furnished, as it has a very high p-value of 0.938. Let\u2019s go ahead and drop this variable.", "The summary of the newly created model is,", "Now, let\u2019s calculate the VIF values for the new model.", "The VIF values for the new model is,", "Now, the variable bedroom has a high VIF (6.6) and a p-value (0.206). Hence, it isn\u2019t of much use and should be dropped from the model. We\u2019ll repeat the same process as before.", "The next step is calculating VIF,", "The VIF values are as follows,", "We\u2019ll repeat this process till every column\u2019s p-value is <0.005 and VIF is <5", "After dropping all the necessary variables one by one, the final model will be,", "The summary for the final model looks like,", "The VIFs for the final model is,", "The VIF values are as follows,", "As we can see, the p-value and VIF are in the acceptable range. It\u2019s time for us to go ahead and make predictions using the final model. This is how we select the Feature variables, which we discussed earlier.", "Now, before making predictions, we have to see whether the error terms are normally distributed or not. We\u2019ll do that by using Residual Analysis.", "The difference between the actual y-value and the predicted y-value using the model at that particular x-value is the error term.", "We have to check if the error terms are normally distributed (which is one of the major assumptions of linear regression); let us plot the error terms\u2019 histogram.", "The histogram looks like the following,", "As we can see, the error terms resemble closely to a normal distribution. So we can move ahead and make predictions using the model in the test dataset.", "We have fitted the model and checked the normality of error terms. Let\u2019s make predictions using the final model.", "Similar to the training dataset. First, we have to scale the test data.", "The test dataset looks like this,", "Dividing the test data into X and Y, after that, we\u2019ll drop the unnecessary variables from the test data based on our model.", "Now, we have to see if the final predicted model is best fitted or not. To do that, we\u2019ll calculate the R\u00b2 value for the expected test model.", "We do that by importing the r2_score library from sklearn", "Since the R\u00b2 values for both the train and test data are almost equal, the model we built is the best-fitted model.", "This is one type of process to build the multiple linear regression model where we select and drop the variables manually. There is another process called Recursive Feature Elimination (RFE).", "RFE is an automatic process where we don\u2019t need to select variables manually. We follow the same steps we have done earlier until Re-scaling the features and dividing the data into X and Y.", "We will use the LinearRegression function from sklearn for RFE (which is a utility from sklearn)", "We have to run the RFE. In the code, we have to provide the number of variables the RFE has to consider to build the model.", "The output for the above code is,", "As we can see, the variables showing True is essential for the model, and the False variable is not needed. If we want to add the False variable to the model, there is also a rank associated with them to add the variables in that order.", "Now, we build the model using statsmodel for detailed statistics.", "The summary of the model is,", "Since the bedrooms column is insignificant to other variables, it can be dropped from the model.", "The summary of the model after dropping the bedroom variable", "Now, we calculate the VIFs for the model.", "The VIF values for the above code is,", "Since the p-values and VIF are in the desired range, we\u2019ll move forward with the analysis.", "The next step is the residual analysis of error terms.", "So, let\u2019s check if the error terms are also normally distributed using a histogram.", "Applying the scaling on the test sets and dividing the data into X and Y.", "After that, let\u2019s evaluate the model,", "Since the R\u00b2 values for both the train and test data are almost equal, the model we built is the best-fitted model.", "We built a basic multiple linear regression model in machine learning manually and using an automatic RFE approach. Most of the time, we use multiple linear regression instead of a simple linear regression model because the target variable is always dependent on more than one variable.", "So, it is crucial to learn how multiple linear regression works in machine learning, and without knowing simple linear regression, it is challenging to understand the multiple linear regression model.", "Thank you for reading and happy coding!!!", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Software Engineer | Python | Machine Learning | Writer"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fd00c78f1172a&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmultiple-linear-regression-model-using-python-machine-learning-d00c78f1172a&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmultiple-linear-regression-model-using-python-machine-learning-d00c78f1172a&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmultiple-linear-regression-model-using-python-machine-learning-d00c78f1172a&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmultiple-linear-regression-model-using-python-machine-learning-d00c78f1172a&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----d00c78f1172a--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----d00c78f1172a--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@kaushikvarma.katari?source=post_page-----d00c78f1172a--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@kaushikvarma.katari?source=post_page-----d00c78f1172a--------------------------------", "anchor_text": "Kaushik Katari"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F6c8e045892b3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmultiple-linear-regression-model-using-python-machine-learning-d00c78f1172a&user=Kaushik+Katari&userId=6c8e045892b3&source=post_page-6c8e045892b3----d00c78f1172a---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fd00c78f1172a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmultiple-linear-regression-model-using-python-machine-learning-d00c78f1172a&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fd00c78f1172a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmultiple-linear-regression-model-using-python-machine-learning-d00c78f1172a&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://pixabay.com/vectors/a-i-ai-anatomy-2729781/", "anchor_text": "Image by Gordon Johnson from Pixabay"}, {"url": "https://towardsdatascience.com/simple-linear-regression-model-using-python-machine-learning-eab7924d18b4", "anchor_text": "Simple Linear Regression"}, {"url": "https://github.com/Kaushik-Varma/mlr", "anchor_text": "here"}, {"url": "https://towardsdatascience.com/simple-linear-regression-model-using-python-machine-learning-eab7924d18b4", "anchor_text": "simple linear regression"}, {"url": "https://towardsdatascience.com/simple-linear-regression-model-using-python-machine-learning-eab7924d18b4", "anchor_text": "Simple Linear Regression Model using Python: Machine Learning"}, {"url": "https://towardsdatascience.com/linear-regression-model-machine-learning-9853450c8bce", "anchor_text": "Linear Regression Model: Machine Learning"}, {"url": "https://towardsdatascience.com/exploratory-data-analysis-eda-python-87178e35b14", "anchor_text": "Exploratory Data Analysis(EDA): Python"}, {"url": "https://towardsdatascience.com/central-limit-theorem-clt-data-science-19c442332a32", "anchor_text": "Central Limit Theorem(CLT): Data Science"}, {"url": "https://towardsdatascience.com/inferential-statistics-data-analysis-e59adc75c6eb", "anchor_text": "Inferential Statistics: Data Analysis"}, {"url": "https://towardsdatascience.com/seaborn-python-8563c3d0ad41", "anchor_text": "Seaborn: Python"}, {"url": "https://levelup.gitconnected.com/pandas-python-e69f4829fee1", "anchor_text": "Pandas: Python"}, {"url": "https://levelup.gitconnected.com/matplotlib-python-ecc7ba303848", "anchor_text": "Matplotlib: Python"}, {"url": "https://medium.com/coderbyte/numpy-python-f8c8f2bbd13e", "anchor_text": "NumPy: Python"}, {"url": "https://acadgild.com/blog/multiple-linear-regression", "anchor_text": "https://acadgild.com/blog/multiple-linear-regression"}, {"url": "https://www.geeksforgeeks.org/ml-multiple-linear-regression-using-python/", "anchor_text": "https://www.geeksforgeeks.org/ml-multiple-linear-regression-using-python/"}, {"url": "https://www.coursera.org/lecture/machine-learning-with-python/multiple-linear-regression-0y8Cq", "anchor_text": "https://www.coursera.org/lecture/machine-learning-with-python/multiple-linear-regression-0y8Cq"}, {"url": "https://www.tutorialspoint.com/machine_learning_with_python/machine_learning_with_python_multiple_linear_regression.htm", "anchor_text": "https://www.tutorialspoint.com/machine_learning_with_python/machine_learning_with_python_multiple_linear_regression.htm"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----d00c78f1172a---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/linear-regression?source=post_page-----d00c78f1172a---------------linear_regression-----------------", "anchor_text": "Linear Regression"}, {"url": "https://medium.com/tag/python?source=post_page-----d00c78f1172a---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/vif?source=post_page-----d00c78f1172a---------------vif-----------------", "anchor_text": "Vif"}, {"url": "https://medium.com/tag/jupyter-notebook?source=post_page-----d00c78f1172a---------------jupyter_notebook-----------------", "anchor_text": "Jupyter Notebook"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fd00c78f1172a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmultiple-linear-regression-model-using-python-machine-learning-d00c78f1172a&user=Kaushik+Katari&userId=6c8e045892b3&source=-----d00c78f1172a---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fd00c78f1172a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmultiple-linear-regression-model-using-python-machine-learning-d00c78f1172a&user=Kaushik+Katari&userId=6c8e045892b3&source=-----d00c78f1172a---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fd00c78f1172a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmultiple-linear-regression-model-using-python-machine-learning-d00c78f1172a&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----d00c78f1172a--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fd00c78f1172a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmultiple-linear-regression-model-using-python-machine-learning-d00c78f1172a&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----d00c78f1172a---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----d00c78f1172a--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----d00c78f1172a--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----d00c78f1172a--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----d00c78f1172a--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----d00c78f1172a--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----d00c78f1172a--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----d00c78f1172a--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----d00c78f1172a--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@kaushikvarma.katari?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@kaushikvarma.katari?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Kaushik Katari"}, {"url": "https://medium.com/@kaushikvarma.katari/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "434 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F6c8e045892b3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmultiple-linear-regression-model-using-python-machine-learning-d00c78f1172a&user=Kaushik+Katari&userId=6c8e045892b3&source=post_page-6c8e045892b3--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fda750799846d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmultiple-linear-regression-model-using-python-machine-learning-d00c78f1172a&newsletterV3=6c8e045892b3&newsletterV3Id=da750799846d&user=Kaushik+Katari&userId=6c8e045892b3&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}