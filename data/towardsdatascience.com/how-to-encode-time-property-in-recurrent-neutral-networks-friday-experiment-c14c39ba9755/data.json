{"url": "https://towardsdatascience.com/how-to-encode-time-property-in-recurrent-neutral-networks-friday-experiment-c14c39ba9755", "time": 1683002586.175947, "path": "towardsdatascience.com/how-to-encode-time-property-in-recurrent-neutral-networks-friday-experiment-c14c39ba9755/", "webpage": {"metadata": {"title": "How-to encode time property in recurrent neural networks. \u2014 Friday Experiment | by Oleksandr Savsunenko | Towards Data Science", "h1": "How-to encode time property in recurrent neural networks. \u2014 Friday Experiment", "description": "You have a stream of events that you use for neural network training. Those events have a duration and/or spaced at non-equal intervals or other time-related property. You understand that dropping\u2026"}, "outgoing_paragraph_urls": [{"url": "https://fridayexperiment.com/how-to-encode-time-property-in-recurrent-neutral-networks/", "anchor_text": "https://fridayexperiment.com", "paragraph_index": 25}, {"url": "http://FridayExperiment.com", "anchor_text": "FridayExperiment.com", "paragraph_index": 27}], "all_paragraphs": ["You have a stream of events that you use for neural network training. Those events have a duration and/or spaced at non-equal intervals or other time-related property. You understand that dropping this information in counter-productive, but you were unable to find a simple, sane and working method for incorporating this data into existing RNN architecture. Fear no more. Here\u2019s what you need to know:", "IMHO, this should be of particular interest for event-driven AI and marketing platforms.", "I\u2019ve been playing around a Datascience Bowl 2019 Kaggle competition. The dataset behind is basically a stream of various app-originated events of mixed granularity. At the moment(Dec 2019) it seems that the dominating approach is a classical \u201cfeature engineering \u2014 gradient boosting- ensembling\u201d combo. I was curious if we can obtain a comparable or better result with RNNs or Transformers, as more \u201cevent-native\u201d (at least it seems so) approach.", "Encoding events themselves isn\u2019t an easy task, taking into the account number of hyperparameters and choices involved, I also stumbled upon an obvious question \u2014 how does one encode temporal information about an event? It seems intuitive, that time has a lot of information, especially when connected to the nature of the event.", "I decided to write this article, for a number of reasons:", "[1] proposes two approaches for encoding time.", "The authors compare these two approaches and show that the second one gives a better improvement in performance, so I am focusing on it here.", "Any time property characterizing event duration or spacing should be represented as a single scalar for each event. Based on the nature of your data, applying a log transform would be a nice idea. If you are unsure \u2014 treat it as a hyperparameter. Here\u2019s how you should prepare your raw data:", "where event data is a unique event type, encoded with categorical encoder, and time data is a float, representing time-domain for an event(distance from previous event or time till next or key event)", "We want to embed a single float scalar into an embedding space, using the same principle as for word embeddings. Word embedding works pretty simply, this is basically a learnable hash table, that maps word index in vocabulary to a vector of embeddings without any extra transform.", "This works for an integer word index, but how can we apply this technique to a float value, that has continuous and non-linear nature?", "The first step is to transform a single scalar in a vector. To do this we multiply a scalar onto a randomly-initialized and trainable vector W and add a vector of biases B.", ", where W is as weights matrix of [1,hidden_vector_dimension] shape and B is a bias vector of[hidden_vector_dimension] shape.", "As this is a linear transformation it doesn\u2019t have any huge encoding and representational power, you can think of it as a step of a learnable linear scalar to vector transformation.", "Then, we apply a softmax function to the vector the obtained.", "As you know, softmax tends to increase one value in the vector, while decreasing others. Think of this as \u201cthis is the most important of the vectors\u201d. Then, we use the same approach as in word embeddings, but instead of taking one vector, that corresponds to word index we take all embedding matrix, where we weight all rows in the embedding space, according to values in the vector values, threating them as weights. Voila, we have a time-embedding vector!", "Now, we are free to choose how to combine this vector with another stream of data \u2014 event embedding obtained using traditional event-type embedding matrix. My first and natural idea was to concatenate them, but authors in [1] propose to take a mean of time-embedding and event-embedding.", "Here, I propose a Keras+Tensorflow 2.0 implementation of this time-embedding layer. Feel free to grab it at my GitHub.", "Let\u2019s see, what is going on here.", "We init the layer using 2 hyperparameters \u2014 the size of hidden embedding latent space and output size of time-embeded vector.", "In the \u201cbuild\u201d method, we randomly initialise weighs, biases and embedding matrix.", "In the \u201ccall\u201d method, we do actual calculations. Projection of scalar and application of softmax function is done using keras backend functions:", "Then we do the most interesting part \u2014 the projection of the latent vector onto the embedding matrix. While this can be done with dot product notation it's not mathematically correct. A better way to do it would be to use Einstein notation.", "Our input would be of shape [batch,timesteps,hidden_vector_dimension] and output is expected to be in form of [batch,timesteps,embedding_matrix_dimensions], where mathematically it looks like this:", "Whenever you were able to express this in this form of mathematical summation, you can directly use einsum notation, by just a copy of summation indexes into einsum notation.", "Originally published at https://fridayexperiment.com on January 4, 2020.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Research Engineer at Ring, doer/maker/dreamer, father. Author of unbiased experimentation blog FridayExperiment.com"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fc14c39ba9755&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-encode-time-property-in-recurrent-neutral-networks-friday-experiment-c14c39ba9755&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-encode-time-property-in-recurrent-neutral-networks-friday-experiment-c14c39ba9755&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-encode-time-property-in-recurrent-neutral-networks-friday-experiment-c14c39ba9755&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-encode-time-property-in-recurrent-neutral-networks-friday-experiment-c14c39ba9755&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----c14c39ba9755--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----c14c39ba9755--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@oleksandrsavsunenko?source=post_page-----c14c39ba9755--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@oleksandrsavsunenko?source=post_page-----c14c39ba9755--------------------------------", "anchor_text": "Oleksandr Savsunenko"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F7d0fbbbf6ecc&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-encode-time-property-in-recurrent-neutral-networks-friday-experiment-c14c39ba9755&user=Oleksandr+Savsunenko&userId=7d0fbbbf6ecc&source=post_page-7d0fbbbf6ecc----c14c39ba9755---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc14c39ba9755&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-encode-time-property-in-recurrent-neutral-networks-friday-experiment-c14c39ba9755&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc14c39ba9755&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-encode-time-property-in-recurrent-neutral-networks-friday-experiment-c14c39ba9755&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://www.groundai.com/project/time-dependent-representation-for-neural-event-sequence-prediction/2", "anchor_text": "https://www.groundai.com/project/time-dependent-representation-for-neural-event-sequence-prediction/2"}, {"url": "https://github.com/crazyleg/time-dependant-rnn-embeddings-keras", "anchor_text": "my GitHub"}, {"url": "https://arxiv.org/abs/1708.00065", "anchor_text": "https://arxiv.org/abs/1708.00065"}, {"url": "https://fridayexperiment.com/how-to-encode-time-property-in-recurrent-neutral-networks/", "anchor_text": "https://fridayexperiment.com"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----c14c39ba9755---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/keras?source=post_page-----c14c39ba9755---------------keras-----------------", "anchor_text": "Keras"}, {"url": "https://medium.com/tag/rnn?source=post_page-----c14c39ba9755---------------rnn-----------------", "anchor_text": "Rnn"}, {"url": "https://medium.com/tag/tensorflow?source=post_page-----c14c39ba9755---------------tensorflow-----------------", "anchor_text": "TensorFlow"}, {"url": "https://medium.com/tag/neural-networks?source=post_page-----c14c39ba9755---------------neural_networks-----------------", "anchor_text": "Neural Networks"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fc14c39ba9755&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-encode-time-property-in-recurrent-neutral-networks-friday-experiment-c14c39ba9755&user=Oleksandr+Savsunenko&userId=7d0fbbbf6ecc&source=-----c14c39ba9755---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fc14c39ba9755&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-encode-time-property-in-recurrent-neutral-networks-friday-experiment-c14c39ba9755&user=Oleksandr+Savsunenko&userId=7d0fbbbf6ecc&source=-----c14c39ba9755---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc14c39ba9755&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-encode-time-property-in-recurrent-neutral-networks-friday-experiment-c14c39ba9755&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----c14c39ba9755--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fc14c39ba9755&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-encode-time-property-in-recurrent-neutral-networks-friday-experiment-c14c39ba9755&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----c14c39ba9755---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----c14c39ba9755--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----c14c39ba9755--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----c14c39ba9755--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----c14c39ba9755--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----c14c39ba9755--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----c14c39ba9755--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----c14c39ba9755--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----c14c39ba9755--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@oleksandrsavsunenko?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@oleksandrsavsunenko?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Oleksandr Savsunenko"}, {"url": "https://medium.com/@oleksandrsavsunenko/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "774 Followers"}, {"url": "http://FridayExperiment.com", "anchor_text": "FridayExperiment.com"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F7d0fbbbf6ecc&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-encode-time-property-in-recurrent-neutral-networks-friday-experiment-c14c39ba9755&user=Oleksandr+Savsunenko&userId=7d0fbbbf6ecc&source=post_page-7d0fbbbf6ecc--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F6fbbfe97a270&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-encode-time-property-in-recurrent-neutral-networks-friday-experiment-c14c39ba9755&newsletterV3=7d0fbbbf6ecc&newsletterV3Id=6fbbfe97a270&user=Oleksandr+Savsunenko&userId=7d0fbbbf6ecc&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}