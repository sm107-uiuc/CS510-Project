{"url": "https://towardsdatascience.com/style-up-your-photos-with-a-touch-of-deep-learning-magic-60a003c676f9", "time": 1682996628.1401641, "path": "towardsdatascience.com/style-up-your-photos-with-a-touch-of-deep-learning-magic-60a003c676f9/", "webpage": {"metadata": {"title": "Style up your photos with a touch of Deep Learning magic | by George Seif | Towards Data Science", "h1": "Style up your photos with a touch of Deep Learning magic", "description": "Style Transfer in the context of imaging refers to the process of transferring the \u201cstyle\u201d of one image to another, while maintaining the \u201ccontent\u201d of the second image. For example, the image on the\u2026"}, "outgoing_paragraph_urls": [{"url": "https://arxiv.org/pdf/1703.07511.pdf", "anchor_text": "Deep Photo Style Transfer", "paragraph_index": 2}, {"url": "https://en.wikipedia.org/wiki/Affine_transformation", "anchor_text": "Affine transform", "paragraph_index": 10}, {"url": "https://towardsdatascience.com/semantic-segmentation-with-deep-learning-a-guide-and-code-e52fc8958823", "anchor_text": "Semantic Segmentation", "paragraph_index": 15}, {"url": "https://pytorch.org/", "anchor_text": "Pytorch", "paragraph_index": 17}, {"url": "https://twitter.com/GeorgeSeif94", "anchor_text": "twitter", "paragraph_index": 22}, {"url": "https://www.linkedin.com/in/georgeseif/", "anchor_text": "LinkedIn", "paragraph_index": 22}, {"url": "https://amzn.to/2Lj0vWJ", "anchor_text": "Deep Learning with Python", "paragraph_index": 23}], "all_paragraphs": ["Style Transfer in the context of imaging refers to the process of transferring the \u201cstyle\u201d of one image to another, while maintaining the \u201ccontent\u201d of the second image.", "For example, the image on the far left is the \u201ccontent\u201d image. We apply the \u201cstyle\u201d of the the middle image (the \u201cstyle\u201d image) to our content image. We expect that since the middle image has kind of a big city night time vibe to it that this will be reflected in the final image \u2014 which is exactly what happens in the result on the far right!", "One of the most ground-breaking pieces of research in this area came from Adobe Research. They called it Deep Photo Style Transfer (DPST).", "To properly perform a style transfer from one photo to another, the Adobe team framed the goal of their DPST: \u201cto transfer the style of the reference to the input while keeping the result photorealistic\u201d", "The key part here is maintaining the \u201cphotorealistic\u201d property of the output. If we have a content photo like the one above, we don\u2019t want any of the building to change at all. We just want it to look like that exact same photo was taken at night time.", "Many style transfer algorithms that came before the publication of this research distorted a lot of the content present the original image. Things like making straight lines wavy and changing the shapes of objects were common to see in the results of Neural Style Transfer techniques at the time.", "And that was totally acceptable. Many of algorithms were designed for artistic style transfer, so a bit of distortion was even welcomed!", "But in this case, the aim was to create images that were still realistic \u2014 as if they were taken by a real-world camera.", "There are 2 main things that the authors do to accomplish this: (1) a photorealism regularisation term in the loss function (2) a semantic segmentation of the content image to be used as a guidance.", "Think of how we would intuitively maintain photorealism in an image. We\u2019d want the lines and shapes of the original image to remain the same. The colors and lighting might change, but a person should still look like a person, a tree like a tree, a dog like a dog, etc.", "Based on this intuitive idea, the regularisation term implemented by the authors forces the transformation of the pixels from the input to the output to be locally affine in colorspace. An Affine transform by definition must maintain the points, straight lines, and planes when mapping the input to the output.", "With this constraint, straight lines never go wavy and there won\u2019t be any weird shape shifting in our output!", "In addition to maintaining the points, straight lines, and planes we also want to make sure that the style of various \u201cthings\u201d in the style image are actually transferred realistically.", "Imagine if you had a style image that showed a beautiful orange sunset like the one down below.", "Most of the image is a red-ish orange. If we were to style transfer this to, say, a city image, all of the buildings would turn red! That\u2019s not really what we want though \u2014 a more realistic transfer would make most of the buildings very dark (close to black) and only the sky would have a sunset and water color.", "The Deep Photo Style Transfer algorithm uses the results of a Semantic Segmentation applied to the content image in order to guide the style transfer. When the algorithms knows exactly which pixels belong to the foreground and background, it can more realistically transfer the style. Sky pixels will always be transferred to sky pixels, background pixels to background pixels, and so on.", "You can download the repository for Photo Realistic Style Transfer from GitHub:", "All that\u2019s required for it to run is a recent version of Pytorch. Once that\u2019s done, move into the folder and download the models for the Semantic Segmentation with the downloading script:", "Now we\u2019re ready to run our code!", "Download a style image and a content image \u2014 any image of your choice! City and landscape images tend to work best in my experience. Finally, run the code like so:", "The algorithm will iteratively improve the style transfer result, so the more you wait the better it will get! By default it\u2019s set to run for 3000 steps, but you can increase that if you feel that more steps is improving the results.", "Give the code a try yourself, it\u2019s great fun! See how your photos look after the style transfer. Feel free to post a link below to share your photos with the community.", "Follow me on twitter where I post all about the latest and greatest AI, Technology, and Science! Connect with me on LinkedIn too!", "Want to learn more about Deep Learning? The Deep Learning with Python book will teach you how to do real Deep Learning with the easiest Python library ever: Keras!", "And just a heads up, I support this blog with Amazon affiliate links to great books, because sharing great books helps everyone! As an Amazon Associate I earn from qualifying purchases.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F60a003c676f9&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fstyle-up-your-photos-with-a-touch-of-deep-learning-magic-60a003c676f9&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fstyle-up-your-photos-with-a-touch-of-deep-learning-magic-60a003c676f9&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fstyle-up-your-photos-with-a-touch-of-deep-learning-magic-60a003c676f9&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fstyle-up-your-photos-with-a-touch-of-deep-learning-magic-60a003c676f9&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----60a003c676f9--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----60a003c676f9--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@george.seif94?source=post_page-----60a003c676f9--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@george.seif94?source=post_page-----60a003c676f9--------------------------------", "anchor_text": "George Seif"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fe2af5c8737ec&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fstyle-up-your-photos-with-a-touch-of-deep-learning-magic-60a003c676f9&user=George+Seif&userId=e2af5c8737ec&source=post_page-e2af5c8737ec----60a003c676f9---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F60a003c676f9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fstyle-up-your-photos-with-a-touch-of-deep-learning-magic-60a003c676f9&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F60a003c676f9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fstyle-up-your-photos-with-a-touch-of-deep-learning-magic-60a003c676f9&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://arxiv.org/pdf/1703.07511.pdf", "anchor_text": "research paper"}, {"url": "https://arxiv.org/pdf/1703.07511.pdf", "anchor_text": "Deep Photo Style Transfer"}, {"url": "https://github.com/yusuketomoto/chainer-fast-neuralstyle", "anchor_text": "Source"}, {"url": "https://en.wikipedia.org/wiki/Affine_transformation", "anchor_text": "Affine transform"}, {"url": "https://pixabay.com/illustrations/tropical-summer-sunset-beach-1651426/", "anchor_text": "Source"}, {"url": "https://towardsdatascience.com/semantic-segmentation-with-deep-learning-a-guide-and-code-e52fc8958823", "anchor_text": "Semantic Segmentation"}, {"url": "https://github.com/GeorgeSeif/DeepPhotoStyle_pytorch.git", "anchor_text": "https://github.com/GeorgeSeif/DeepPhotoStyle_pytorch.git"}, {"url": "https://pytorch.org/", "anchor_text": "Pytorch"}, {"url": "https://twitter.com/GeorgeSeif94", "anchor_text": "twitter"}, {"url": "https://www.linkedin.com/in/georgeseif/", "anchor_text": "LinkedIn"}, {"url": "https://amzn.to/2Lj0vWJ", "anchor_text": "Deep Learning with Python"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----60a003c676f9---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----60a003c676f9---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/data?source=post_page-----60a003c676f9---------------data-----------------", "anchor_text": "Data"}, {"url": "https://medium.com/tag/data-science?source=post_page-----60a003c676f9---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/technology?source=post_page-----60a003c676f9---------------technology-----------------", "anchor_text": "Technology"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F60a003c676f9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fstyle-up-your-photos-with-a-touch-of-deep-learning-magic-60a003c676f9&user=George+Seif&userId=e2af5c8737ec&source=-----60a003c676f9---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F60a003c676f9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fstyle-up-your-photos-with-a-touch-of-deep-learning-magic-60a003c676f9&user=George+Seif&userId=e2af5c8737ec&source=-----60a003c676f9---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F60a003c676f9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fstyle-up-your-photos-with-a-touch-of-deep-learning-magic-60a003c676f9&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----60a003c676f9--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F60a003c676f9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fstyle-up-your-photos-with-a-touch-of-deep-learning-magic-60a003c676f9&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----60a003c676f9---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----60a003c676f9--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----60a003c676f9--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----60a003c676f9--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----60a003c676f9--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----60a003c676f9--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----60a003c676f9--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----60a003c676f9--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----60a003c676f9--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@george.seif94?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@george.seif94?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "George Seif"}, {"url": "https://medium.com/@george.seif94/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "21K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fe2af5c8737ec&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fstyle-up-your-photos-with-a-touch-of-deep-learning-magic-60a003c676f9&user=George+Seif&userId=e2af5c8737ec&source=post_page-e2af5c8737ec--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fc78596234267&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fstyle-up-your-photos-with-a-touch-of-deep-learning-magic-60a003c676f9&newsletterV3=e2af5c8737ec&newsletterV3Id=c78596234267&user=George+Seif&userId=e2af5c8737ec&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}