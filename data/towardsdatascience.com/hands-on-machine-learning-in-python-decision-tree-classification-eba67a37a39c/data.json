{"url": "https://towardsdatascience.com/hands-on-machine-learning-in-python-decision-tree-classification-eba67a37a39c", "time": 1683015056.476939, "path": "towardsdatascience.com/hands-on-machine-learning-in-python-decision-tree-classification-eba67a37a39c/", "webpage": {"metadata": {"title": "Hands-on Machine Learning in Python \u2014 Decision Tree Classification | by Christopher Tao | Towards Data Science", "h1": "Hands-on Machine Learning in Python \u2014 Decision Tree Classification", "description": "This article shows a completed workflow of typical hands-on Decision Tree machine learning task from data exploratory analysis, cleansing, model training to evaluation."}, "outgoing_paragraph_urls": [], "all_paragraphs": ["As one of the most popular classic machine learning algorithms, the Decision Tree is much more intuitive than the others for its explainability. Today, in this article, I am going to show you the entire workflow of implementing a Decision Tree Classification Model.", "A typical workflow of a machine learning task usually starts from the data wrangling, since the data we have got initially often cannot be directly used. That is so-called raw data. The typical workflow is usually as follows.", "Please be noticed that the workflow might not be linear. For example, sometimes the performance of the model is not quite well after we have done the model evaluation, and we still have other ideas to try. Then, we might go back to either step among 3\u20135 to apply our ideas that might improve the model.", "In this article, I\u2019ll show these steps as linear. I assume that you have already known what is a decision tree and roughly how it works. However, if not, I have written many articles to introduce the decision tree model with intuitions. Please check them out at the end of this article if you need to.", "The Titanic survival dataset is famous in the data science domain, which is also considered as the \u201clesson 1\u201d in Kaggle. Of course, many excellent solutions can predict survivals very well, and it turns out that Decision Tree is not the best solution. However, it doesn\u2019t prevent us to use this dataset as an example to train our Decision Tree Classification model.", "The dataset can be found in Kaggle, which can be downloaded for free.", "Please be noticed that we are going to use the train.csv only. The test.csv is used to submit your predicted results because Kaggle is for competition purposes. The gender_submission.csv is not relevant to the machine learning model, so please ignore it.", "The instructions of the dataset, including the variables, train/test sets, etc. can be found in the above link together with the downloadable dataset.", "However, in practice, all the information of a given raw dataset might not be clear enough. Knowing the problem is \u201cpredicting the survival\u201d is far from enough. It may be necessary to conduct workshops with the data owners and other stakeholders.", "Trust me, clarifying a dataset is not an easy job. Most of the time, we may have to start working on a dataset without 100% understanding it because it can be impossible sometimes.", "The results of EDA is not directly used in the model training, but it cannot be ignored. We need to understand the dataset in detail, in order to facilitate the data cleansing and feature selection.", "Here I will show some basic and commonly used EDA.", "Before everything, we usually want to know how the dataset looks like. However, it is not uncommon that the dataset is too large so that we can print them entirely. There is a simple function head() to preview the first 5 rows.", "Pandas has a very convenient function for us for profiling the data frame we have. Simply call info() function of the data frame as follows.", "It is also very important to check the statistics of the features. Pandas data frame can also do that for us very easily.", "The describe() function will automatically select numeric features and calculate their statistics for us. However, what if we also want to have a picture of those categorical or string-type features? We can use the include parameter in the describe() function and pass in a list of object types explicitly as follows.", "Please be noticed that the type 'O' means string type. In Pandas, no variables will be read as categorical by default unless you explicitly ask it to do so. If you really have any columns that are categorical types (can be found in the data profile), you need also to pass in 'categorical' in the list.", "In practice, you may need to do more tasks for EDA, such as plot the features in histograms to see their distributions or get the correlation matrix and so on. This article will stop here since it meant to show you what are the type of things to do in EDA.", "After the above EDA tasks, we have found some problems that need to be addressed in the Data Cleansing stage.", "Let\u2019s firstly look at the Age column. We can firstly double check there are data entries with age that are missing.", "There are many ways to fix a data gap, such as", "In here, let\u2019s take the relatively simple methods. That is, using mean value to fill the numeric columns, and then using the mode to fill the categorical values.", "To fill the Age missing data with mean, we can do as follows.", "For the Embarked column, let\u2019s fill it with the mode value. Here we don\u2019t need to find the mode again, because the describe(include=['O']) has already told as 'S' has the largest frequency that is 644 out of 889 entries.", "So, let\u2019s use 'S' to fill the NULL values in the Embarked column.", "Finally, for the Cabin column, there are more than 70% missing. It is definitely cannot be filled. In fact, for such kind of column, I would like to ignore it for now. In other words, we won\u2019t use it for our model training.", "Feature Engineering is a very important step for training a machine learning model, especially for classic machine learning algorithms (not deep learning). Sometimes it makes the majority time of the whole workflow, because we may need to revisit this stage many times to improve the performance of our model.", "In our dataset, firstly we need to identify some features that are not usable or not useful.", "For the rest of the features: Pclass, Sex, Age, SibSp, Parch, Fare and Embarked, they seem to be useful so that we should select them. Because we are going to use the Decision Tree, so if there are any features that do not help the model, they will be less likely to be selected to split the tree nodes. Let the algorithm tells us.", "So, let\u2019s build our feature data frame and label series.", "Now we can train our model using the features. However, since we are going to use the Sci-kit Learn library and its Decision Tree algorithms do not take categorical values in string types, we have to do One Hot Encoding to our feature dataset. Specifically, our Sex and Embarked features are of string type, which needs to be converted into numbers.", "Encoding is one of the most important techniques in data preprocessing, which is worth writing another article to introduce. So, we will skip the lecture on One Hot Encoding in this article. You will be able to get many excellent tutorials online if you don\u2019t understand what it is.", "First of all, let\u2019s import the One Hot Encoder from the Sci-kit Learn library.", "Initialising the encoder is very easy. After that, let\u2019s fit the encoder with the two categorical features: Sex and Embarked.", "It can be seen that we got an 891 x 5 matrix, which means that the encoded feature set has 5 columns. This is because the Sex feature has 2 distinct values: female and male, and the Embarked feature has 3 distinct values: S, C and Q. So, the total number is five.", "We can get the order of the labels by calling categories_ of the encoder.", "Once we have the order of the new features, we can generate a data frame from the encoded matrix using the new feature labels.", "The new encoded feature set makes sense. For example, the first row in the above data frame shows that the passenger is a male and embarked with S.", "Now, we can concatenate the encoded feature set with the original feature data frame. Don\u2019t forget to remove the Sex and Embarked columns from the original one because they should be replaced by the encoded new features.", "Now, we can train our Decision Tree model.", "But wait, what does our model look like? Usually, it is not quite easy to be \u201cseen\u201d how the model looks like for most of the machine learning algorithms. However, Decision Tree is not in those. We can visualise our model to see how the nodes are split.", "The code above will plot the tree using Matplotlib and save the graph as an image file. It is recommended to check out the tree in the image file because it is too big to be shown in a webpage if you\u2019re using Jupyter Notebook.", "Here is a part of the tree from the \u201ctree.png\u201d image.", "In the final stage, but might not be the finish of our workflow, we need to evaluate our model.", "The best way of evaluating our model is to download the test.csv from the Kaggle page above and predict the survivals for the test dataset and then submit it. However, this is because Kaggle is a competition platform that provides such a feature. In practice, we usually need to split our raw dataset into training and testing datasets.", "However, in this article, I want to use another method to evaluate our model which is cross-validation.", "The basic idea of cross-validation is to evaluate the model training methods and hyperparameters rather than a trained model. It can be considered as the following steps.", "Please be noticed that the parameter cv is the number of segments n that is mentioned. It is quite common to use 10 for that.", "It turns out that the result might not be ideal. In practice, we may revisit one of the previous stages to see whether we can reshape our dataset to get a better result, such as changing the gap-filling mechanisms in the Data Cleansing stage.", "Well, I would say that the average accuracy we got from the cross-validation is indeed not very ideal. You may go to the Kaggle problem webpage to find out other solutions that have been done by others, some of them has achieved very high accuracy.", "In this article, I have demonstrated an entire typical workflow of a machine learning job. It starts from the problem statement, how to treat the data and so on, rather than directly jump into training a machine learning model like most of the other articles do. Although there is too much detail that can be expanded such as the EDA and Feature Engineering steps, hope this article has shown the typical steps that data scientists would follow and give you a general picture.", "If you feel my articles are helpful, please consider joining Medium Membership to support me and thousands of other writers! (Click the link above)", "Here are some of my previous articles that introduce Decision Tree Algorithms. Please go check them out if you are interested!", "Decision Tree by ID3 Algorithm (Entropy)", "Decision Tree by C4.5 Algorithm (Information Gain Ratio)", "Decision Tree by CART Algorithm (Gini Index)", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Feba67a37a39c&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhands-on-machine-learning-in-python-decision-tree-classification-eba67a37a39c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhands-on-machine-learning-in-python-decision-tree-classification-eba67a37a39c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhands-on-machine-learning-in-python-decision-tree-classification-eba67a37a39c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhands-on-machine-learning-in-python-decision-tree-classification-eba67a37a39c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----eba67a37a39c--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----eba67a37a39c--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://qiuyujx.medium.com/?source=post_page-----eba67a37a39c--------------------------------", "anchor_text": ""}, {"url": "https://qiuyujx.medium.com/?source=post_page-----eba67a37a39c--------------------------------", "anchor_text": "Christopher Tao"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fb8176fabf308&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhands-on-machine-learning-in-python-decision-tree-classification-eba67a37a39c&user=Christopher+Tao&userId=b8176fabf308&source=post_page-b8176fabf308----eba67a37a39c---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Feba67a37a39c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhands-on-machine-learning-in-python-decision-tree-classification-eba67a37a39c&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Feba67a37a39c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhands-on-machine-learning-in-python-decision-tree-classification-eba67a37a39c&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://pixabay.com/users/fietzfotos-6795508/", "anchor_text": "fietzfotos"}, {"url": "https://pixabay.com/photos/landscape-tree-bench-park-meadow-5591270/", "anchor_text": "Pixabay"}, {"url": "https://pixabay.com/users/pixel2013-2364555/", "anchor_text": "pixel2013"}, {"url": "https://pixabay.com/photos/ship-wreck-old-rust-stranded-3401500/", "anchor_text": "Pixabay"}, {"url": "https://www.kaggle.com/c/titanic/data", "anchor_text": "Titanic: Machine Learning from DisasterStart here! Predict survival on the Titanic and get familiar with ML basicswww.kaggle.com"}, {"url": "https://pixabay.com/users/julius_silver-4371822/", "anchor_text": "Julius_Silver"}, {"url": "https://pixabay.com/photos/portugal-algarve-benagil-caves-3029665/", "anchor_text": "Pixabay"}, {"url": "https://pixabay.com/users/sztrapacska74-8968314/", "anchor_text": "Sztrapacska74"}, {"url": "https://pixabay.com/photos/kitten-cat-4274170/", "anchor_text": "Pixabay"}, {"url": "https://pixabay.com/users/silviarita-3142410/", "anchor_text": "silviarita"}, {"url": "https://pixabay.com/photos/tray-breakfast-muesli-fruit-fruits-2546077/", "anchor_text": "Pixabay"}, {"url": "https://pixabay.com/users/stevepb-282134/", "anchor_text": "stevepb"}, {"url": "https://pixabay.com/photos/dumbbells-training-fitness-gym-2465478/", "anchor_text": "Pixabay"}, {"url": "https://pixabay.com/users/qimono-1962238/", "anchor_text": "qimono"}, {"url": "https://pixabay.com/photos/measurement-millimeter-centimeter-1476919/", "anchor_text": "Pixabay"}, {"url": "https://pixabay.com/users/larisa-k-1107275/", "anchor_text": "Larisa-K"}, {"url": "https://pixabay.com/photos/spring-tree-flowers-meadow-276014/", "anchor_text": "Pixabay"}, {"url": "https://medium.com/@qiuyujx/membership", "anchor_text": "Join Medium with my referral link \u2014 Christopher TaoAs a Medium member, a portion of your membership fee goes to writers you read, and you get full access to every story\u2026medium.com"}, {"url": "https://towardsdatascience.com/go-out-for-exercise-or-not-let-data-science-decide-34f8f28ce7b4", "anchor_text": "Go Out For Exercise Or Not? Let Data Science DecideAn introduction to the Decision Tree Machine Learning Algorithmtowardsdatascience.com"}, {"url": "https://towardsdatascience.com/do-not-use-decision-tree-like-this-369769d6104d", "anchor_text": "Do Not Use Decision Tree Like ThisDemonstrate the Limitation of Information Gain in ID3 and the Benefits of using C4.5towardsdatascience.com"}, {"url": "https://towardsdatascience.com/get-your-decision-tree-model-moving-by-cart-82765d59ae09", "anchor_text": "Get Your Decision Tree Model Moving by CARTGini Impurity \u2014 another criterion to split node in a decision treetowardsdatascience.com"}, {"url": "https://medium.com/towards-artificial-intelligence/everyone-can-understand-machine-learning-regression-tree-model-28e3541b3e79", "anchor_text": "Everyone Can Understand Machine Learning \u2014 Regression Tree ModelIntroduction to Regression Tree Model without formula, equations, and scientific statementmedium.com"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----eba67a37a39c---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/technology?source=post_page-----eba67a37a39c---------------technology-----------------", "anchor_text": "Technology"}, {"url": "https://medium.com/tag/data-science?source=post_page-----eba67a37a39c---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----eba67a37a39c---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/programming?source=post_page-----eba67a37a39c---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Feba67a37a39c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhands-on-machine-learning-in-python-decision-tree-classification-eba67a37a39c&user=Christopher+Tao&userId=b8176fabf308&source=-----eba67a37a39c---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Feba67a37a39c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhands-on-machine-learning-in-python-decision-tree-classification-eba67a37a39c&user=Christopher+Tao&userId=b8176fabf308&source=-----eba67a37a39c---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Feba67a37a39c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhands-on-machine-learning-in-python-decision-tree-classification-eba67a37a39c&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----eba67a37a39c--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Feba67a37a39c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhands-on-machine-learning-in-python-decision-tree-classification-eba67a37a39c&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----eba67a37a39c---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----eba67a37a39c--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----eba67a37a39c--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----eba67a37a39c--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----eba67a37a39c--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----eba67a37a39c--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----eba67a37a39c--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----eba67a37a39c--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----eba67a37a39c--------------------------------", "anchor_text": ""}, {"url": "https://qiuyujx.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://qiuyujx.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Christopher Tao"}, {"url": "https://qiuyujx.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "8.7K Followers"}, {"url": "https://www.linkedin.com/in/christopher-tao-5717a274/", "anchor_text": "https://www.linkedin.com/in/christopher-tao-5717a274/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fb8176fabf308&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhands-on-machine-learning-in-python-decision-tree-classification-eba67a37a39c&user=Christopher+Tao&userId=b8176fabf308&source=post_page-b8176fabf308--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F1d2af94a683f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhands-on-machine-learning-in-python-decision-tree-classification-eba67a37a39c&newsletterV3=b8176fabf308&newsletterV3Id=1d2af94a683f&user=Christopher+Tao&userId=b8176fabf308&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}