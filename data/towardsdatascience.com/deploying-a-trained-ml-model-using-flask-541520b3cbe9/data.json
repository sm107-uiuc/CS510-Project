{"url": "https://towardsdatascience.com/deploying-a-trained-ml-model-using-flask-541520b3cbe9", "time": 1683011729.6750348, "path": "towardsdatascience.com/deploying-a-trained-ml-model-using-flask-541520b3cbe9/", "webpage": {"metadata": {"title": "Deploying a Trained ML Model using Flask | by Harshit Tyagi | Towards Data Science", "h1": "Deploying a Trained ML Model using Flask", "description": "Continuing from my last post on End-to-End Machine Learning Project Tutorial where we discussed major tasks of building a robust ML model, this post offers you a simple and fast solution to deploying\u2026"}, "outgoing_paragraph_urls": [{"url": "https://towardsdatascience.com/end-to-end-machine-learning-project-tutorial-part-1-ea6de9710c0?source=---------4------------------", "anchor_text": "my last post", "paragraph_index": 0}, {"url": "https://towardsdatascience.com/end-to-end-machine-learning-project-tutorial-part-1-ea6de9710c0", "anchor_text": "on End-to-End Machine Learning Project Tutorial", "paragraph_index": 0}, {"url": "https://towardsdatascience.com/task-cheatsheet-for-almost-every-machine-learning-project-d0946861c6d0?source=---------2------------------", "anchor_text": "major tasks of building a robust ML model", "paragraph_index": 0}, {"url": "https://towardsdatascience.com/end-to-end-machine-learning-project-tutorial-part-1-ea6de9710c0", "anchor_text": "here.", "paragraph_index": 1}, {"url": "https://realpython.com/primer-on-python-decorators/", "anchor_text": "here.", "paragraph_index": 18}, {"url": "http://HTTP://0.0.0.0:9696/test", "anchor_text": "http://0.0.0.0:9696/test", "paragraph_index": 22}, {"url": "https://github.com/dswh/fuel-consumption-end-to-end-ml/blob/master/auto_mpg_prediction-part3.ipynb", "anchor_text": "here", "paragraph_index": 25}, {"url": "https://gunicorn.org/", "anchor_text": "Gunicorn", "paragraph_index": 36}, {"url": "https://signup.heroku.com/", "anchor_text": "Create a Heroku account", "paragraph_index": 41}, {"url": "https://mpg-flask-app.herokuapp.com/predict", "anchor_text": "https://mpg-flask-app.herokuapp.com/predict", "paragraph_index": 45}, {"url": "https://archive.ics.uci.edu/ml/datasets.php?format=&task=cla&att=&area=&numAtt=&numIns=&type=&sort=nameUp&view=table", "anchor_text": "a classification problem", "paragraph_index": 50}, {"url": "https://towardsdatascience.com/task-cheatsheet-for-almost-every-machine-learning-project-d0946861c6d0?source=---------2------------------", "anchor_text": "these tasks", "paragraph_index": 50}, {"url": "https://towardsdatascience.com/hitchhikers-guide-to-learning-data-science-2cc3d963b1a2?source=---------8------------------", "anchor_text": "series covering the entire data science space", "paragraph_index": 52}, {"url": "https://www.youtube.com/channel/UCH-xwLTKQaABNs2QmGxK2bQ", "anchor_text": "channel", "paragraph_index": 52}, {"url": "https://www.youtube.com/c/DataSciencewithHarshit", "anchor_text": "https://www.youtube.com/c/DataSciencewithHarshit", "paragraph_index": 54}], "all_paragraphs": ["Continuing from my last post on End-to-End Machine Learning Project Tutorial where we discussed major tasks of building a robust ML model, this post offers you a simple and fast solution to deploying your ML model on the web.", "This is the last task in our End-to-End ML fuel consumption project which we started here.", "In order to deploy any trained model, you need the following:", "Let\u2019s get started by looking at each one of these processes one by one.", "Once you\u2019re confident enough to take your trained and tested model into the production-ready environment, the first step is to save it into a .h5 or .bin file using a library like pickle .", "Make sure you have pickle installed in your environment.", "Next, let\u2019s import the module and dump the model into a .bin file:", "This will save your model in your present working directory unless you specify some other path.", "It\u2019s time to test if we are able to use this file to load our model and make predictions, we are going to use the same(as defined in prev blog) vehicle config:", "Let\u2019 load the model from the file:", "The output is the same as we predicted earlier using final_model.", "The next step is to package this model into a web service that when given the data through a POST request returns the MPG(Miles per Gallon) predictions as a response.", "I am using the Flask web framework, a commonly used lightweight framework for developing web services in Python. In my opinion, it is probably the easiest way to implement a web service.", "Flask requires gets you started with very little code and you don\u2019t need to worry about the complexity of handling with HTTP requests and responses.", "The next step is to activate this environment and start developing a simple endpoint to test the application:", "Create a new file, main.py and import the flask module:", "Create a Flask app by instantiating the Flask class:", "Create a route and a function corresponding to it that will return a simple string:", "The above code makes use of decorators \u2014 an advanced python feature. You can read more about decorators here. We don\u2019t need a deep understanding of decorators, just that adding a decorator @app.route on top of the test() function assigns that web service address to that function.", "Now, to run the application we need this last piece of code:", "The run method starts our flask application service. The 3 parameters specify:", "Now, in your terminal run the main.py", "Opening the URL http://0.0.0.0:9696/test in your browser will print the response string on the webpage:", "With the application now, running, let\u2019s run the model:", "Create a new directory model_files to store all the model-related code.", "In this directory, create a ml_model.py file which will contain the data preparation code and the predict function we wrote here.", "Copy and paste the libraries you imported in the first part and the preprocessing/transformation functions. The file should look like this:", "In the same directory, place your saved model.bin file as well.", "Now, in the main.py we are going to import the predict_mpg function to make predictions but to do that we are required to create an empty __init__.py file to tell Python that the directory is a package.", "Your directory should have this tree:", "Next up, define the predict/ route that will accept the vehicle_config from an HTTP POST request and return the predictions using the model and predict_mpg() method.", "Then add the predict route and the corresponding function:", "We can test this route using Postman or the requests package, start the server running the main.py and then in your notebook, add this code to send a POST request with the vehicle_config:", "Great! Now, comes the last part, this same functionality should work when deployed on a remote server.", "To deploy this flask application on Heroku, you need to follow these very simple steps:", "We are using gunicorn(installed earlier) to deploy the application:", "Gunicorn is a pure-Python HTTP server for WSGI applications. It allows you to run any Python application concurrently by running multiple Python processes within a single dyno. It provides a perfect balance of performance, flexibility, and configuration simplicity.", "3. Create a wsgi.py file and add:", "Make sure you delete the run code from the main.py .", "4. Write all the python dependencies into requirements.txt:", "you can use pip freeze > requirements.txt or simply put the above-mentioned list of packages + any other package that your application is using.", "6. Create a Heroku account if you haven\u2019t already, login to Heroku CLI:", "Approve the login from the browser as the page pops up:", "I named it mpg-flask-app. It will create a flask app and will give us a URL on which the app will be deployed.", "8. Finally, push all your code to Heroku remote:", "And Voila! your web service is now deployed on https://mpg-flask-app.herokuapp.com/predict.", "Again, test the endpoint using request package by sending the same vehicle config:", "With that, you have all the major skills you need to get on to building more complex ML applications.", "You can refer to my GitHub repository for this project:", "And you can develop this entire project along with me:", "This was still a simple project, for the next steps, I\u2019d recommend you take up a more complex dataset, maybe pick up a classification problem and repeat these tasks till deployment.", "But if you don\u2019t want to wait, here is the complete tutorial series(playlist) on my YouTube channel where you can follow me while working on this project.", "With this channel, I plan to roll out a couple of series covering the entire data science space. Here is why you should be subscribing to the channel:", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Web & Data Science Instructional Designer | YouTuber | Writer https://www.youtube.com/c/DataSciencewithHarshit"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F541520b3cbe9&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeploying-a-trained-ml-model-using-flask-541520b3cbe9&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeploying-a-trained-ml-model-using-flask-541520b3cbe9&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeploying-a-trained-ml-model-using-flask-541520b3cbe9&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeploying-a-trained-ml-model-using-flask-541520b3cbe9&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----541520b3cbe9--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----541520b3cbe9--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://dswharshit.medium.com/?source=post_page-----541520b3cbe9--------------------------------", "anchor_text": ""}, {"url": "https://dswharshit.medium.com/?source=post_page-----541520b3cbe9--------------------------------", "anchor_text": "Harshit Tyagi"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F4530efc184cb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeploying-a-trained-ml-model-using-flask-541520b3cbe9&user=Harshit+Tyagi&userId=4530efc184cb&source=post_page-4530efc184cb----541520b3cbe9---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F541520b3cbe9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeploying-a-trained-ml-model-using-flask-541520b3cbe9&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F541520b3cbe9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeploying-a-trained-ml-model-using-flask-541520b3cbe9&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@scienceinhd?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Science in HD"}, {"url": "https://unsplash.com/s/photos/server?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://towardsdatascience.com/end-to-end-machine-learning-project-tutorial-part-1-ea6de9710c0?source=---------4------------------", "anchor_text": "my last post"}, {"url": "https://towardsdatascience.com/end-to-end-machine-learning-project-tutorial-part-1-ea6de9710c0", "anchor_text": "on End-to-End Machine Learning Project Tutorial"}, {"url": "https://towardsdatascience.com/task-cheatsheet-for-almost-every-machine-learning-project-d0946861c6d0?source=---------2------------------", "anchor_text": "major tasks of building a robust ML model"}, {"url": "https://towardsdatascience.com/end-to-end-machine-learning-project-tutorial-part-1-ea6de9710c0", "anchor_text": "here."}, {"url": "http://twitter.com/app", "anchor_text": "@app"}, {"url": "https://realpython.com/primer-on-python-decorators/", "anchor_text": "here."}, {"url": "http://HTTP://0.0.0.0:9696/test", "anchor_text": "http://0.0.0.0:9696/test"}, {"url": "https://github.com/dswh/fuel-consumption-end-to-end-ml/blob/master/auto_mpg_prediction-part3.ipynb", "anchor_text": "here"}, {"url": "http://localhost:9696/predict", "anchor_text": "http://localhost:9696/predict"}, {"url": "https://www.heroku.com/art", "anchor_text": "https://www.heroku.com/art"}, {"url": "https://gunicorn.org/", "anchor_text": "Gunicorn"}, {"url": "https://signup.heroku.com/", "anchor_text": "Create a Heroku account"}, {"url": "https://mpg-flask-app.herokuapp.com/predict", "anchor_text": "https://mpg-flask-app.herokuapp.com/predict"}, {"url": "https://github.com/dswh/fuel-consumption-end-to-end-ml", "anchor_text": "dswh/fuel-consumption-end-to-end-mlEnd to End Machine Learning Project on Fuel Consumption Prediction of 70s and 80s vehicles. GitHub is home to over 50\u2026github.com"}, {"url": "https://archive.ics.uci.edu/ml/datasets.php?format=&task=cla&att=&area=&numAtt=&numIns=&type=&sort=nameUp&view=table", "anchor_text": "a classification problem"}, {"url": "https://towardsdatascience.com/task-cheatsheet-for-almost-every-machine-learning-project-d0946861c6d0?source=---------2------------------", "anchor_text": "these tasks"}, {"url": "https://www.youtube.com/c/DataSciencewithHarshit?sub_confirmation=1", "anchor_text": "Data Science with Harshit"}, {"url": "https://towardsdatascience.com/hitchhikers-guide-to-learning-data-science-2cc3d963b1a2?source=---------8------------------", "anchor_text": "series covering the entire data science space"}, {"url": "https://www.youtube.com/channel/UCH-xwLTKQaABNs2QmGxK2bQ", "anchor_text": "channel"}, {"url": "https://towardsdatascience.com/python-fundamentals-for-data-science-6c7f9901e1c8?source=---------5------------------", "anchor_text": "Python fundamentals for Data Science"}, {"url": "https://towardsdatascience.com/practical-reasons-to-learn-mathematics-for-data-science-1f6caec161ea?source=---------9------------------", "anchor_text": "Mathematics and derivations"}, {"url": "https://www.youtube.com/watch?v=a2pkZCleJwM&t=2s", "anchor_text": "Podcasts with Data Scientists and Engineers"}, {"url": "https://towardsdatascience.com/building-covid-19-analysis-dashboard-using-python-and-voila-ee091f65dcbb?source=---------2------------------", "anchor_text": "Projects and instructions"}, {"url": "https://youtu.be/yapSsspJzAw", "anchor_text": "TensorFlow Developer Certificate Exam by Google."}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----541520b3cbe9---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----541520b3cbe9---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/data-science?source=post_page-----541520b3cbe9---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/python?source=post_page-----541520b3cbe9---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/programming?source=post_page-----541520b3cbe9---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F541520b3cbe9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeploying-a-trained-ml-model-using-flask-541520b3cbe9&user=Harshit+Tyagi&userId=4530efc184cb&source=-----541520b3cbe9---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F541520b3cbe9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeploying-a-trained-ml-model-using-flask-541520b3cbe9&user=Harshit+Tyagi&userId=4530efc184cb&source=-----541520b3cbe9---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F541520b3cbe9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeploying-a-trained-ml-model-using-flask-541520b3cbe9&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----541520b3cbe9--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F541520b3cbe9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeploying-a-trained-ml-model-using-flask-541520b3cbe9&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----541520b3cbe9---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----541520b3cbe9--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----541520b3cbe9--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----541520b3cbe9--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----541520b3cbe9--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----541520b3cbe9--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----541520b3cbe9--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----541520b3cbe9--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----541520b3cbe9--------------------------------", "anchor_text": ""}, {"url": "https://dswharshit.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://dswharshit.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Harshit Tyagi"}, {"url": "https://dswharshit.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "3.2K Followers"}, {"url": "https://www.youtube.com/c/DataSciencewithHarshit", "anchor_text": "https://www.youtube.com/c/DataSciencewithHarshit"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F4530efc184cb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeploying-a-trained-ml-model-using-flask-541520b3cbe9&user=Harshit+Tyagi&userId=4530efc184cb&source=post_page-4530efc184cb--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F7293934ec1a7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeploying-a-trained-ml-model-using-flask-541520b3cbe9&newsletterV3=4530efc184cb&newsletterV3Id=7293934ec1a7&user=Harshit+Tyagi&userId=4530efc184cb&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}