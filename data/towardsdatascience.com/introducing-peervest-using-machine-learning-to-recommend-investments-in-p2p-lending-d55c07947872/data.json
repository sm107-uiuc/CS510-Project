{"url": "https://towardsdatascience.com/introducing-peervest-using-machine-learning-to-recommend-investments-in-p2p-lending-d55c07947872", "time": 1683000350.390392, "path": "towardsdatascience.com/introducing-peervest-using-machine-learning-to-recommend-investments-in-p2p-lending-d55c07947872/", "webpage": {"metadata": {"title": "Using Machine Learning to Recommend Investments in P2P Lending | by Alexander Shropshire | Towards Data Science", "h1": "Using Machine Learning to Recommend Investments in P2P Lending", "description": "Peer-to-peer lending marketplaces like LendingClub and Prosper Marketplace are driven by what is essentially a brokers fee for connecting investors and borrowers. They are incentivized to increase\u2026"}, "outgoing_paragraph_urls": [{"url": "https://towardsdatascience.com/questions-96667b06af5", "anchor_text": "rules and guidelines", "paragraph_index": 17}, {"url": "https://towardsdatascience.com/readers-terms-b5d780a700a4", "anchor_text": "Reader Terms", "paragraph_index": 17}], "all_paragraphs": ["Peer-to-peer lending marketplaces like LendingClub and Prosper Marketplace are driven by what is essentially a brokers fee for connecting investors and borrowers. They are incentivized to increase the sheer number of transactions taking place on their platforms. Driven by ease-of-use, their off-the-shelf credit risk assessments score risk in grouped buckets. On a loan-by-loan basis, this is inefficient given each loan\u2019s uniqueness and the sheer amount of data collected from borrowers. Scoring risk on a more granular, continuous basis is not only possible but preferable over discrete, grouped buckets.", "Credit risk is something all peer-to-peer lending investors and bond investors must carefully consider when making informed decisions. Institutions, including large banks, have been employing researchers and quantitative analysts to wrangle and analyze this data hoping to become more confident in their risk-reward assessments. What is the underlying risk that a borrower fails to make required payments, leading to a loss of principal and interest? Given the terms of the loan, what return can an investor expect? There should be a more simple and accessible tool for the everyday investor that can hope to outperform the marketplace\u2019s own off-the-shelf advisor.", "PeerVest helps individual investors augment their portfolio by intelligently allocating funds to Peer-to-Peer Lending Marketplaces using machine learning trained on LendingClub.com historical loan data to assess risk and predict return. PeerVest recommends the best loans to invest in given a user\u2019s available funds, maximum risk tolerance, and minimum desired annualized return. There are plenty of institutions that are thought leaders in utilizing modern, alternative datasets to assess credit risk and predict investment potential, but I\u2019ve simplified the problem into 2 key models: (1) scoring risk by predicting the probability that a loan defaults, and (2) predicting annualized returns.", "To assign a quantity to each loan that measures its risk level, or the probability that the borrower will default on the loan, I approached this like a standard classification problem where each historical loan is assigned a 1 if it was Fully Paid and a 0 if it defaulted. To provide a more granular risk assessment than LendingClub and sites like it provide off the shelf, I was looking not for the class (1 or 0), but for the probability that each loan is predicted to fall in each class. My initial approach was to use a Logistic Regression, which despite classifying each loan quite confidently, and despite probability calibration, didn\u2019t seem to interact well with sklearn\u2019s .predict_proba() function. This function returns a probability between 0 and 1 that a loan belongs to class 1. Taking 1 minus this very number yields an interpretable probability of default metric (the larger it is, the higher likelihood that it will default).", "Given 1,107 unique features, there seemed to exist many non-linear relationships and the effort of manually reducing dimensions would be cumbersome. There was no true benefit to using Principal Component Analysis since it was not improving the situation \u2014 it reduced dimensionality and reduced explained variance in equal magnitude. I decided to keep all the features, despite the increased likelihood of feature redundancy. Knowing neural networks would be able to handle this complexity over many epochs of training, I began architecting a model using Keras, a neural network library built on TensorFlow. I iterated through many different Keras architectures by employing different combinations of hidden layer sizes, dropout regularization, L2 kernel regularization, early stopping, epochs, class weight balancing, and ReLU/Sigmoid activation functions. Despite some stagnation in validation loss, the model eventually broke through and began improving more significantly within a few epochs, for both train and test sets, while calibrating prediction probabilities very well.", "Underperformers: 3 Scikit-Learn Logistic Regression models, 7 Keras Neural NetworksBest Performer: Keras Neural Network v8", "Best Model Evaluation Metrics (Test Error):", "I used a very simple Annualized Return calculation based on the available data from LendingClub. I decided against using LendingClub\u2019s complicated Adjusted Net Annualized Return computation due to interpretability, though as I continue iterating my model I am open to refined calculations that utilize more traditional financial loss estimates. The element of time as it relates to loan terms and payments sits within this calculation. Macro information like the federal interest rate, inflation and the time value of money is inherent in the interest rate quoted to the borrower, though there is certainly room to dive into time series and survival analysis with increased rigor to productionalize this model for financial institutions.", "Linear Regression worked decently on the training set, but was overfit and did not generalize well to the future set or the test set within the same period. Ridge Regression, which is similar but applied L2 regularization fixed the overfitting issue in my 2nd iteration. That said, I wanted to know if my evaluation metrics would improve using something that could make regression decisions differently, and if there was a model that wouldn\u2019t be as reliant on total payment so that my prediction could be used for a brand new listing on LendingClub without payment history. Random Forest was the perfect candidate given the overfitting problem and its proven ability to bootstrap subsamples of features and aggregate many decision trees. In simple terms, a Random Forest would be able to construct and combine many not-so-good models that are not correlated with each other to create a single, decent model \u2014 all while being equipped to handle my 1,107 features without much additional preparation besides finding the best parameters. Given the power of a Google Cloud GPU, I let GridSearchCV handle this by searching for the best combination.", "Underperformers: 1 Linear Regression model, 3 Ridge Regression Models, 1 Keras Neural Network, 4 Random Forest Regression models (using Scikit-Learn)Best Performer: Random Forest Regression v5 with GridSearch Cross-Validation", "Best Model Evaluation Metrics (Test Error \u2014 not including payment history):", "The best Random Forest regression model achieves a root-MSE of 0.16 on the test set, which implies that the predicted annualized return is estimated to differ from the true annualized return by 0.16. While this may appear very large at first, the model can be very useful in formulating a loan selection strategy. Loan defaults usually happen soon after loan funding, and the chance of default decreases as more payment is made. As a result, I recommend loans with annualized return predictions higher than a reasonable threshold set by the user. Intuitively, the threshold can serve as a parameter investors can tune according to their investment account size: the bigger the minimum annualized return (higher return) and the smaller the maximum probability of default is (lower risk), the more stringent the overall loan selection is, so less total dollars can be invested. Hopefully, the annualized return will be higher due to investing in loans more selectively.", "That said, we can become much more confident in our prediction if we were to know something about the borrowers\u2019 payment history, though in practice we won\u2019t be able to incorporate initial borrow payment behavior as an investor. That said, with a bit of payment history to work with, the model improves significantly:", "Evaluation Metrics (Test Error \u2014 if payment history is included):", "This app is free to use. There are no fees or benefits to me should you decide to apply my models to your own investment portfolio. I am not a certified financial advisor of any kind \u2014 invest at your own risk.", "The model has been deployed on the web as a Flask app hosted on an Amazon Web Services EC2 instance, utilizing HTML, CSS, and Brython. It can collect a user\u2019s maximum risk tolerance and their corresponding minimum desired portfolio return, and output a comprehensive list of loans currently live on LendingClub.com based on my model\u2019s recommendation.", "Let\u2019s connect! I encourage you to comment, share, or message me directly with your thoughts on the ideas presented here, or suggestions on interesting topics I should look into going forward.", "Note from Towards Data Science\u2019s editors: While we allow independent authors to publish articles in accordance with our rules and guidelines, we do not endorse each author\u2019s contribution. You should not rely on an author\u2019s works without seeking professional advice. See our Reader Terms for details.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Finance x Data @ Brex | Past: Legendary Entertainment, VEVO, AOL | Let\u2019s Connect!"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fd55c07947872&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroducing-peervest-using-machine-learning-to-recommend-investments-in-p2p-lending-d55c07947872&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroducing-peervest-using-machine-learning-to-recommend-investments-in-p2p-lending-d55c07947872&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroducing-peervest-using-machine-learning-to-recommend-investments-in-p2p-lending-d55c07947872&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroducing-peervest-using-machine-learning-to-recommend-investments-in-p2p-lending-d55c07947872&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----d55c07947872--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----d55c07947872--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@as6140?source=post_page-----d55c07947872--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@as6140?source=post_page-----d55c07947872--------------------------------", "anchor_text": "Alexander Shropshire"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F993feda9902d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroducing-peervest-using-machine-learning-to-recommend-investments-in-p2p-lending-d55c07947872&user=Alexander+Shropshire&userId=993feda9902d&source=post_page-993feda9902d----d55c07947872---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fd55c07947872&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroducing-peervest-using-machine-learning-to-recommend-investments-in-p2p-lending-d55c07947872&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fd55c07947872&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroducing-peervest-using-machine-learning-to-recommend-investments-in-p2p-lending-d55c07947872&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://www.forbes.com/sites/bernardmarr/2018/09/24/what-are-artificial-neural-networks-a-simple-explanation-for-absolutely-anyone/#7a5465a12457", "anchor_text": "Learn More Here"}, {"url": "https://www.kdnuggets.com/2019/01/random-forests-explained-intuitively.html", "anchor_text": "Learn More Here"}, {"url": "https://www.investopedia.com/terms/d/defaultprobability.asp", "anchor_text": "Learn More Here"}, {"url": "https://www.investopedia.com/terms/a/annualized-rate.asp", "anchor_text": "Learn More Here"}, {"url": "https://gombru.github.io/2018/05/23/cross_entropy_loss/", "anchor_text": "Binary Cross-Entropy"}, {"url": "http://ruder.io/optimizing-gradient-descent/index.html#adam", "anchor_text": "Adam"}, {"url": "http://www.peervest.online/", "anchor_text": "www.peervest.online"}, {"url": "https://www.lendingclub.com/auth/login", "anchor_text": "Click Here"}, {"url": "http://www.linkedin.com/in/alexandershropshire", "anchor_text": "LinkedIn"}, {"url": "http://github.com/as6140", "anchor_text": "GitHub Portfolio"}, {"url": "https://github.com/as6140/peervest", "anchor_text": "as6140/peervest( http://www.peervest.online) A P2P Lending Robo-Advisor Using a Neural Network (Classification, Probability of\u2026github.com"}, {"url": "https://towardsdatascience.com/questions-96667b06af5", "anchor_text": "rules and guidelines"}, {"url": "https://towardsdatascience.com/readers-terms-b5d780a700a4", "anchor_text": "Reader Terms"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----d55c07947872---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/towards-data-science?source=post_page-----d55c07947872---------------towards_data_science-----------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/tag/data-science?source=post_page-----d55c07947872---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/finance?source=post_page-----d55c07947872---------------finance-----------------", "anchor_text": "Finance"}, {"url": "https://medium.com/tag/investing?source=post_page-----d55c07947872---------------investing-----------------", "anchor_text": "Investing"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fd55c07947872&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroducing-peervest-using-machine-learning-to-recommend-investments-in-p2p-lending-d55c07947872&user=Alexander+Shropshire&userId=993feda9902d&source=-----d55c07947872---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fd55c07947872&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroducing-peervest-using-machine-learning-to-recommend-investments-in-p2p-lending-d55c07947872&user=Alexander+Shropshire&userId=993feda9902d&source=-----d55c07947872---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fd55c07947872&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroducing-peervest-using-machine-learning-to-recommend-investments-in-p2p-lending-d55c07947872&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----d55c07947872--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fd55c07947872&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroducing-peervest-using-machine-learning-to-recommend-investments-in-p2p-lending-d55c07947872&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----d55c07947872---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----d55c07947872--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----d55c07947872--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----d55c07947872--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----d55c07947872--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----d55c07947872--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----d55c07947872--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----d55c07947872--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----d55c07947872--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@as6140?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@as6140?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Alexander Shropshire"}, {"url": "https://medium.com/@as6140/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "188 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F993feda9902d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroducing-peervest-using-machine-learning-to-recommend-investments-in-p2p-lending-d55c07947872&user=Alexander+Shropshire&userId=993feda9902d&source=post_page-993feda9902d--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F6afb749b7ed1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroducing-peervest-using-machine-learning-to-recommend-investments-in-p2p-lending-d55c07947872&newsletterV3=993feda9902d&newsletterV3Id=6afb749b7ed1&user=Alexander+Shropshire&userId=993feda9902d&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}