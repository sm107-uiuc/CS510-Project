{"url": "https://towardsdatascience.com/7-must-know-sql-querying-mistakes-fixes-321ee292a251", "time": 1683018279.3158, "path": "towardsdatascience.com/7-must-know-sql-querying-mistakes-fixes-321ee292a251/", "webpage": {"metadata": {"title": "7 Must Know SQL Querying Mistakes & Fixes | by Ashish Tomar | Towards Data Science", "h1": "7 Must Know SQL Querying Mistakes & Fixes", "description": "This article aims to refine your querying skills by pointing out some common, yet ignored mistakes. I\u2019ll elaborate on them using demonstrations and fixes."}, "outgoing_paragraph_urls": [{"url": "https://towardsdatascience.com/indexing-for-sql-query-optimization-139b57db9fc6?sk=1235f74826c820c5cc57b864345bba8e", "anchor_text": "SQL query optimization by using the \u2018Indexing\u2019 technique", "paragraph_index": 28}, {"url": "https://www.linkedin.com/in/ashish-tomar-565b1654/", "anchor_text": "LinkedIn", "paragraph_index": 33}, {"url": "https://www.linkedin.com/in/ashish-tomar-565b1654/", "anchor_text": "https://www.linkedin.com/in/ashish-tomar-565b1654/", "paragraph_index": 35}], "all_paragraphs": ["Welcome to another interesting article on SQL. This article aims to refine your querying skills by pointing out some common, yet ignored mistakes. I\u2019ll elaborate on them using hypothetical tables, and also provide fixes for each. So, sit tight and get ready to polish your querying skills.", "Let\u2019s take a hypothetical business example, as always. Suppose you are in the e-Commerce Analytics team at Amazon and have a few simple queries to run. You have two tables called \u2018product\u2019 and \u2018discount\u2019.", "We\u2019ll fix them all, whatever it takes!", "When you need to count null column values as well, you should be aware of how \u2018COUNT\u2019 works. Let\u2019s say you want to count the number of products, even when the primary key \u2018product_id\u2019 of the table \u2018product\u2019 is missing.", "You may have been expecting 4 since you wanted to count the null value of column \u2018product_id\u2019 as well. But, COUNT() doesn\u2019t count the null values.", "Use COUNT(*). It counts the null values as well.", "That looks easy but is often missed while writing complex queries.", "This won\u2019t work since the column name \u2018Rank\u2019 is a reserved word for the function \u2018Rank\u2019.", "This will throw an exception since you used the comparison operator \u2018=\u2019 with NULL, and so will the comparison operator \u2018!=\u2019.", "The logic is that you mean to ask whether the value in the column \u2018product_id\u2019 is unknown, not whether it is equal to something that is unknown.", "That sounds like a tongue twister, and seems a bit confusing, right? It\u2019s safe to say that this syntax is invalid in SQL. That\u2019s easy!", "This is a very interesting concept and is sure to improve your fundamental understanding of the difference between filtering in the \u2018ON\u2019 clause & filtering in the \u2018WHERE\u2019 clause. This isn\u2019t exactly a mistake, just a demonstration of the usage of both, and you can choose the best option depending on the business requirement.", "Here, the filter is applied after the tables are joined. So, the result has no rows where d.product_id\u22641 (and obviously not where p.product\u22641)", "Notice the usage of \u2018AND\u2019, and the difference in results.", "Here, the conditional statement \u2018AND\u2019 is evaluated before the join occurs. You can think of it as a \u2018WHERE\u2019 clause that applies only to one of the tables (\u2018product\u2019 table). Now, the result has even those rows where d.product_id\u22641 (obviously along with p.product_id>1) because of the RIGHT JOIN.", "Mind it that filtering in the \u2018ON\u2019 clause and \u2018WHERE\u2019 clause differ only when it\u2019s a LEFT/RIGHT/OUTER JOIN and not when it\u2019s an INNER JOIN.", "You should be careful not to use the column names created through Windows functions and the \u2018CASE WHEN\u2019 clause in the \u2018WHERE\u2019 clause of the same query.", "This query will throw an exception since column \u2018rk\u2019 has been created through the Windows function, and it has been used in the \u2018WHERE\u2019 clause of the same query.", "This can be fixed by using a temporary table or a subquery.", "The same idea applies to a column created using the \u2018CASE WHEN\u2019 clause. Remember that the Windows functions can only appear in the \u2018SELECT\u2019 or \u2018ORDER BY\u2019 clauses.", "If you\u2019re unaware of the inclusivity of the range covered by \u2018BETWEEN\u2019, you may get unexpected outputs.", "The statement \u2018BETWEEN x AND y\u2019 includes both x and y in the required range.", "Tweaking the range accordingly takes care of this.", "And now you have all the dates only in 2019. That was an easy fix, right?", "You should be careful about where you write \u2018WHERE\u2019 when you use \u2018GROUP BY\u2019.", "This is incorrect because you have used the \u2018WHERE\u2019 clause after \u2018GROUP BY\u2019. And, why is that?", "\u2018WHERE\u2019 clause is used to filter on the results, and you should logically do that before you group that, not after. Applying the \u2018WHERE\u2019 filter first would reduce the data and then \u2018GROUP BY\u2019 will group it according to the aggregation function used (AVG here).", "Be mindful of the order of execution of the main SQL statements:", "This will help you in optimizing your SQL queries. Also, give this article on SQL query optimization by using the \u2018Indexing\u2019 technique a quick read:", "This wasn\u2019t an exhaustive list of all the common mistakes but consisted of mostly the ones where the fixes can be a bit confusing, especially for beginners. Hope it helps you refine your querying skills.", "To end with a powerful message by Henry Ford,", "\u201cThe only real mistake is the one from which we learn nothing.\u201d", "Feel free to have a look at the other articles that I\u2019ve written around data analytics:", "Feel free to provide feedback and follow me for more interesting articles on data analytics. Connect with me on LinkedIn.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "I work as a data scientist at FedEx Ground. I'm passionate about data analytics & digital experimentation. (https://www.linkedin.com/in/ashish-tomar-565b1654/)"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F321ee292a251&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F7-must-know-sql-querying-mistakes-fixes-321ee292a251&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2F7-must-know-sql-querying-mistakes-fixes-321ee292a251&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F7-must-know-sql-querying-mistakes-fixes-321ee292a251&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2F7-must-know-sql-querying-mistakes-fixes-321ee292a251&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----321ee292a251--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----321ee292a251--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://ashishtomar-60885.medium.com/?source=post_page-----321ee292a251--------------------------------", "anchor_text": ""}, {"url": "https://ashishtomar-60885.medium.com/?source=post_page-----321ee292a251--------------------------------", "anchor_text": "Ashish Tomar"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Ff0f831383d74&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F7-must-know-sql-querying-mistakes-fixes-321ee292a251&user=Ashish+Tomar&userId=f0f831383d74&source=post_page-f0f831383d74----321ee292a251---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F321ee292a251&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F7-must-know-sql-querying-mistakes-fixes-321ee292a251&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F321ee292a251&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F7-must-know-sql-querying-mistakes-fixes-321ee292a251&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://app.blogcast.host/embedly/2463", "anchor_text": "LISTEN TO THE ARTICLE HERE.\u25b6"}, {"url": "https://imgs.xkcd.com/comics/fixing_problems.png", "anchor_text": "xkcd.com"}, {"url": "https://unsplash.com/@markusspiske?utm_source=medium&utm_medium=referral", "anchor_text": "Markus Spiske"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://towardsdatascience.com/indexing-for-sql-query-optimization-139b57db9fc6?sk=1235f74826c820c5cc57b864345bba8e", "anchor_text": "SQL query optimization by using the \u2018Indexing\u2019 technique"}, {"url": "https://towardsdatascience.com/indexing-for-sql-query-optimization-139b57db9fc6", "anchor_text": "Indexing for SQL Query OptimizationTime to up your querying game!towardsdatascience.com"}, {"url": "https://towardsdatascience.com/a-b-testing-top-4-mistakes-with-business-cases-fixes-85e76767dfde", "anchor_text": "A/B Testing: Top 4 Mistakes With Business Cases & FixesThe ones you may have been ignoring till you found this articletowardsdatascience.com"}, {"url": "https://towardsdatascience.com/data-analytics-in-e-commerce-retail-7ea42b561c2f", "anchor_text": "Data Analytics in E-Commerce RetailAnalytics concepts & applications in e-commerce retail with easy demonstrations and interesting business examplestowardsdatascience.com"}, {"url": "https://www.linkedin.com/in/ashish-tomar-565b1654/", "anchor_text": "LinkedIn"}, {"url": "https://medium.com/tag/sql?source=post_page-----321ee292a251---------------sql-----------------", "anchor_text": "Sql"}, {"url": "https://medium.com/tag/data?source=post_page-----321ee292a251---------------data-----------------", "anchor_text": "Data"}, {"url": "https://medium.com/tag/analytics?source=post_page-----321ee292a251---------------analytics-----------------", "anchor_text": "Analytics"}, {"url": "https://medium.com/tag/business-intelligence?source=post_page-----321ee292a251---------------business_intelligence-----------------", "anchor_text": "Business Intelligence"}, {"url": "https://medium.com/tag/data-science?source=post_page-----321ee292a251---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F321ee292a251&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F7-must-know-sql-querying-mistakes-fixes-321ee292a251&user=Ashish+Tomar&userId=f0f831383d74&source=-----321ee292a251---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F321ee292a251&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F7-must-know-sql-querying-mistakes-fixes-321ee292a251&user=Ashish+Tomar&userId=f0f831383d74&source=-----321ee292a251---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F321ee292a251&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F7-must-know-sql-querying-mistakes-fixes-321ee292a251&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----321ee292a251--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F321ee292a251&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F7-must-know-sql-querying-mistakes-fixes-321ee292a251&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----321ee292a251---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----321ee292a251--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----321ee292a251--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----321ee292a251--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----321ee292a251--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----321ee292a251--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----321ee292a251--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----321ee292a251--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----321ee292a251--------------------------------", "anchor_text": ""}, {"url": "https://ashishtomar-60885.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://ashishtomar-60885.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Ashish Tomar"}, {"url": "https://ashishtomar-60885.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "116 Followers"}, {"url": "https://www.linkedin.com/in/ashish-tomar-565b1654/", "anchor_text": "https://www.linkedin.com/in/ashish-tomar-565b1654/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Ff0f831383d74&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F7-must-know-sql-querying-mistakes-fixes-321ee292a251&user=Ashish+Tomar&userId=f0f831383d74&source=post_page-f0f831383d74--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F9236be80e8e1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F7-must-know-sql-querying-mistakes-fixes-321ee292a251&newsletterV3=f0f831383d74&newsletterV3Id=9236be80e8e1&user=Ashish+Tomar&userId=f0f831383d74&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}