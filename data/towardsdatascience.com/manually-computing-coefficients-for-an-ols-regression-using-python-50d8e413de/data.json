{"url": "https://towardsdatascience.com/manually-computing-coefficients-for-an-ols-regression-using-python-50d8e413de", "time": 1683008839.078537, "path": "towardsdatascience.com/manually-computing-coefficients-for-an-ols-regression-using-python-50d8e413de/", "webpage": {"metadata": {"title": "Manually computing the coefficients for an OLS regression using Python | by Roman Shemet | Towards Data Science", "h1": "Manually computing the coefficients for an OLS regression using Python", "description": "There are two reasons I am writing this tutorial. A while ago, I was wondering what exactly lies behind the .fit() and .predict() methods of the popular statistical packages like scikit-learn\u2026"}, "outgoing_paragraph_urls": [{"url": "https://scikit-learn.org/stable/user_guide.html", "anchor_text": "scikit-learn", "paragraph_index": 0}, {"url": "https://www.statsmodels.org/stable/user-guide.html", "anchor_text": "statsmodels", "paragraph_index": 0}, {"url": "https://github.com/rshemet/OLS_coeffs_walkthrough", "anchor_text": "here", "paragraph_index": 16}], "all_paragraphs": ["There are two reasons I am writing this tutorial. A while ago, I was wondering what exactly lies behind the .fit() and .predict() methods of the popular statistical packages like scikit-learn, statsmodels and countless other libraries. After spending a considerable amount of time on Google, I did not find a simple enough tutorial and had to dive into the closest statistics book myself. Second, although I have been using Medium for a while, this is my first time writing an article here and I wanted to see what it would be like \ud83d\ude00.", "I will begin by briefly explaining the logic of a regression \u2014 feel free to skip this section if you are familiar with the underlying concepts. Getting to know the theory and basic algebra behind the Ordinary Least Squares (OLS) regression can be helpful for interpreting the results as well as understanding the limitations of your models.", "A regression is a method for studying a relationship between a dependent variable and (one or many) independent variables. On a simple two-axis chart, a univariate OLS regression will essentially attempt to plot a \u201cline of best fit\u201d through our observed data points; a multivariate regression is a little trickier to visualise. But, regardless of the number of predictor variables, an OLS regression attempts to find the coefficients (typically represented by the letter \u03b2\u200b) for the equation:", "Let us quickly define the notation we will be using:", "Y \u2014 dependent variableX \u2014 independent variable(s)\u03b2 \u2014 OLS coefficient(s)\u03f5 \u2014 error termk \u2014 number of observationsn \u2014 number of predictors", "The error term \u03f5 represents the fact that we (typically) cannot fit the data perfectly and there will be an \u201cerror\u201d between our model estimate and the true value of the data. The objective of the Least Squares regression is to minimise those squared errors (hence its name):", "The beauty of the OLS regression is that the optimal coefficients can be obtained numerically by rewriting the above equation in matrix form and taking the first order derivative:", "As we can see, the OLS coefficients themselves are a linear combination of X and Y.", "Now, to the point of the article. To remain consistent with the commonly used packages, we will write two methods: .fit() and .predict(). Our data manipulation will be carried out using the numpy package. If you\u2019re importing your data from another file, e.g. in a .csv format, you may use the pandas library to do so.", "Next, we will create a class for our Model and create a method that fits an OLS regression to the given x and y variables \u2014 those must be passed in as numpy arrays. The coefficients are obtained according to the vector form derivation performed earlier (np.linalg.inv() is a numpy function for matrix inversion and @ notation represents vector multiplication):", "Our .fit() method stores the computed coefficients in the self.betas attribute to allow them to be accessed later by other methods. Note that we have added an optional parameter intercept; if we decide to fit our model with an intercept, the method will add a vector of 1\u2019s to the array of the independent variables.", "We now create the .predict() method:", "Our (very) simple method makes use of vector multiplication to obtain the \u201cpredicted\u201d values \u2014 y_hat.", "As an additional (and optional) touch, we can add a method to visually output the prediction (Note: in the current form, it will only work for a univariate regression with an intercept):", "Finally, let us execute the methods we created using sample data (if you don\u2019t want to generate a graph, delete the call to plot_predictions() in line 7 and instead, add the return self.y_hat line at the end of our .predict() method):", "If you followed everything along \u2014 you should have successfully computed the coefficients and have generated something similar to this:", "If you\u2019d like to play around with the code, the full version is available as a GitHub repository here.", "Needless to say, this is a very basic exercise, which, nonetheless, efficiently illustrates where the OLS betas come from and what their (mathematical) significance is. Figuring this out has been immensely helpful in my further studies. Lastly, the statistical packages I have referred to earlier, in addition to the computed coefficients, typically calculate a variety of other measures \u2014 statistical significance, confidence intervals, R squared and so on. These can all be calculated numerically, however I would advise to rely on the (well-tested) libraries once you\u2019ve understood the underlying concepts.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "MSc Financial Economics at the University of Oxford. Interested in Finance and Data Science. Triathlon, Chess & Blues enthusiast."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F50d8e413de&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmanually-computing-coefficients-for-an-ols-regression-using-python-50d8e413de&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmanually-computing-coefficients-for-an-ols-regression-using-python-50d8e413de&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmanually-computing-coefficients-for-an-ols-regression-using-python-50d8e413de&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmanually-computing-coefficients-for-an-ols-regression-using-python-50d8e413de&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----50d8e413de--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----50d8e413de--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@shemet0roman?source=post_page-----50d8e413de--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@shemet0roman?source=post_page-----50d8e413de--------------------------------", "anchor_text": "Roman Shemet"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fd6ab8e7b1702&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmanually-computing-coefficients-for-an-ols-regression-using-python-50d8e413de&user=Roman+Shemet&userId=d6ab8e7b1702&source=post_page-d6ab8e7b1702----50d8e413de---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F50d8e413de&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmanually-computing-coefficients-for-an-ols-regression-using-python-50d8e413de&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F50d8e413de&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmanually-computing-coefficients-for-an-ols-regression-using-python-50d8e413de&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://scikit-learn.org/stable/user_guide.html", "anchor_text": "scikit-learn"}, {"url": "https://www.statsmodels.org/stable/user-guide.html", "anchor_text": "statsmodels"}, {"url": "https://github.com/rshemet/OLS_coeffs_walkthrough", "anchor_text": "here"}, {"url": "https://medium.com/tag/python?source=post_page-----50d8e413de---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/ols?source=post_page-----50d8e413de---------------ols-----------------", "anchor_text": "Ols"}, {"url": "https://medium.com/tag/regression?source=post_page-----50d8e413de---------------regression-----------------", "anchor_text": "Regression"}, {"url": "https://medium.com/tag/data-science?source=post_page-----50d8e413de---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/numpy?source=post_page-----50d8e413de---------------numpy-----------------", "anchor_text": "Numpy"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F50d8e413de&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmanually-computing-coefficients-for-an-ols-regression-using-python-50d8e413de&user=Roman+Shemet&userId=d6ab8e7b1702&source=-----50d8e413de---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F50d8e413de&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmanually-computing-coefficients-for-an-ols-regression-using-python-50d8e413de&user=Roman+Shemet&userId=d6ab8e7b1702&source=-----50d8e413de---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F50d8e413de&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmanually-computing-coefficients-for-an-ols-regression-using-python-50d8e413de&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----50d8e413de--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F50d8e413de&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmanually-computing-coefficients-for-an-ols-regression-using-python-50d8e413de&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----50d8e413de---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----50d8e413de--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----50d8e413de--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----50d8e413de--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----50d8e413de--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----50d8e413de--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----50d8e413de--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----50d8e413de--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----50d8e413de--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@shemet0roman?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@shemet0roman?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Roman Shemet"}, {"url": "https://medium.com/@shemet0roman/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "93 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fd6ab8e7b1702&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmanually-computing-coefficients-for-an-ols-regression-using-python-50d8e413de&user=Roman+Shemet&userId=d6ab8e7b1702&source=post_page-d6ab8e7b1702--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fe01b2d9e5a59&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmanually-computing-coefficients-for-an-ols-regression-using-python-50d8e413de&newsletterV3=d6ab8e7b1702&newsletterV3Id=e01b2d9e5a59&user=Roman+Shemet&userId=d6ab8e7b1702&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}