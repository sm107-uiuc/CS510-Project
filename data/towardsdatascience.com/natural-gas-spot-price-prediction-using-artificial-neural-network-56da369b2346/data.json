{"url": "https://towardsdatascience.com/natural-gas-spot-price-prediction-using-artificial-neural-network-56da369b2346", "time": 1683002927.885958, "path": "towardsdatascience.com/natural-gas-spot-price-prediction-using-artificial-neural-network-56da369b2346/", "webpage": {"metadata": {"title": "Natural Gas Spot Price Prediction Using Artificial Neural Network | by Sarit Maitra | Towards Data Science", "h1": "Natural Gas Spot Price Prediction Using Artificial Neural Network", "description": "Prediction of natural gas price has become increasingly important because the association with crude oil. The energy commodity which includes natural gas price, is dramatically volatile with high\u2026"}, "outgoing_paragraph_urls": [{"url": "https://machinelearningmastery.com/learning-curves-for-diagnosing-machine-learning-model-performance/", "anchor_text": "here", "paragraph_index": 22}], "all_paragraphs": ["Prediction of natural gas price has become increasingly important because the association with crude oil. The energy commodity which includes natural gas price, is dramatically volatile with high risk and uncertain situations. Here, we will investigate natural gas spot price with additional variables such as meteorological data, economic data etc. related to climate data including production related data, consumption related data and temperature related data.", "Data set combined monthly data of historical spot price at Henry Hub & WTI, and other related factors (46 variables excluding Henry hub and WTI).", "Though we all are aware of the fact that, gas consumption is traditionally high during winter session which leads to rising market prices. However, market do not behave the way we expect; the problem is that, in contrast to popular belief, there is remarkable deviation in price almost throughout the year.", "In order to target the said problem, we will use machine learning algorithm to examine if we can predict the future price by adding different parameters which may have external direct or indirect effect on natural gas price. We will try to develop a forecasting model to predict the spot price of natural gas based on historical prices.", "Lag scatter plot can be used to check for auto-correlation; the data (t) on the x-axis against the data on the previous month \u201ct-1/t-2/t-3/t-4\u201d on the y-axis. The diagonal line with large dot clearly shows a relationship or some correlation. The missing values in between can also be seen here.", "We can see that, some patterns exist in the series and the series is auto-correlated. Lag 1 shows the data are mostly concentrated and highly correlated. However, we will validate this further with auto-correlation plot. The empty space is because of missing values in data.", "Below, we have added another variables which is monthly return as percent change which kind of normalize the data, but still large fluctuations show the high volatility and randomness at Henry hub spot price (HH).", "Let us review the correlation between the HH time series in the lagged versions of itself. In the below ACF plot, the blue shaded area is the 95% confidence interval. We can see that several lags till 10 months.", "Here, we assume that the current value depends on its previous values with some lag. To find the maximum lag that can be taken to predict the future price, we look at the partial autocorrelation plot and identify the lag after which most lags are not significant. Here, we see from pacf, a big spike after 1 month which can be used as look back period for future prediction.", "Ideally we should try a number of different lag combinations by -", "Our data set came with lot of missing values. So, we have created a function to fill -in the missing values with previous one.", "Let us investigate the time series distribution. From below histogram and Jarque-Bera normality test shows that the price time series is not normally distributed. However, the logarithmic price follows the Gaussian distribution.", "So, we can assume normal distribution for first the difference of variable and or the logarithm of the gas price.", "It is quite difficult to identify the variables and make any assumption from below correlation Pearson correlation plot.", "Further to correlation plot, in order to identify the variables contributing to standard error in regression analysis, we have used an easy to understand metric (variance inflation factor). So, this helps in detecting multi-collinearity in our data-set. Large VIF (> 5) means significant multi-collinearity exists and ideally we should drop these variables from regression analysis.", "We have VIF > 5 and beyond for a few variables. All above analysis indicate the use of neural network would be an ideal choice and also suggest that, theoretically we can use one of the high auto-correlation lags (1) to develop a neural network model.", "LSTMs are quite useful in time series prediction tasks involving auto-correlation, the presence of correlation between the time series and lagged versions of itself, because of their ability to maintain state and recognize patterns over the length of the time series. The recurrent architecture enables the states to persist, or communicate between updates of the weights as each epoch progresses.", "Price prediction can be either uni-variate or multivariate models.", "Here, we will be investigating the 2nd type of model using GRU network architecture. The GRU controls the flow of information without having to use a memory unit. It is relatively new, and computationally more efficient with less complex structure.", "Sequence of values are crucial with time-series data. So, we have split the data in train and test test using a systematic approach as below. Also, normalization is required to fit the data for neural network architecture learning.", "We will prepare X_train, y_train with look back option as 1 as identified by acf/pacf plot earlier.", "Once the model is fit on training data, we want to see the skill of the model on out-of-sample data. Likewise we did in training set, we will prepare the test set and we need to pick up look-back value from training data. The look-back is the number of previous time steps to use as input variables to predict the next time period (1 in this case).", "The goal of the algorithm is to find a place between an over-fit and under-fit model. A good fit is identified by a training and validation loss that decreases to a point of stability with a minimal gap between the two final loss values. you may read here to know more about diagnostic plot.", "The loss of the model will almost always be lower on the training data-set than the validation data-set. This means that we should expect some gap between the train and validation loss learning curves. This gap is referred to as the \u201cgeneralization gap.\u201d", "However, the diagnostic plot shows the sign of unrepresentative training data-set which means that model did not get enough information from training set to learn the problem.", "We concatenate both observed and predicted values in one data frame for better representation and reporting.", "Mean squared error (MSE): MSE measures the mean of the squares of the errors i.e. the average squared difference between the estimated values and the actual value. The smaller the MSE, the closer we are to best fitted mode.", "Root mean squared error (RMSE): RMSE is the square root of the average of squared differences between prediction and actual observation. Since the errors are squared before the mean is taken, RMSE gives a relatively high weight to large errors. This makes RMSE most effective when large errors are undesirable.", "Mean absolute error (MAE): MAE is the average over the test sample of the absolute differences between prediction and actual observation where all individual differences have equal weight.", "We can see that, the result is not as expected. But here, our objective was to find a model, fit, and predict the natural gas spot price. We had taken time horizon of 1 month and our algorithm was able to learn and predict future price. The ability to learn and generalization are key features of neural networks. Moreover, one of the advantage is that, the activation function which could be linear or nonlinear can be applied (model.add(Activation(\u201crelu\u201d or \u201csigmoid\u201d)). The memory blocks of network architecture are connected through layers. Each block contains gates to manage the state and output and operates upon an input sequence. Moreover, each gate within a block uses the activation units to control. By default, the architecture use \u201csigmoid\u201d activation. Here, by selecting the various nonlinear functions and different arrangement of the neurons and layers, nonlinear response to the stimuli was captured. Finally, we observe that, GRU network architecture can be used effectively to predict the future market price for our time-series data.", "The model accuracy need to be tested with more training data, batch size may be configured to 64 or 128 and number of input parameters can be selective. We have used monthly data-set, where daily data may help achieving better accuracy.", "We can identify the top 10 important features from our data-set as stated below to predict monthly price movements of Henry Hub spot price:", "It has always been a difficult task to predict the exact daily price ofthe stock market index. Many factors such as political events, general economic conditions, and traders\u2019 expectations may have an influence onthe spot price index. Here, we have applied several input variables to predict the price direction of next 12 months. However, the prediction performance may be improved further by selecting effective input indicators. In addition, we can include a few other technical indicators that may affect the prediction performance. The models in the experiment have solved the problem as a regression. Regression model can be combined with Classification model predicting rise and fall to improve the directional accuracy for precise predictions. Moreover, the same model need to be tested with large amount of data for prediction accuracy because non-parametric modeling approach requires a lot more training data to estimate the mapping function.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Analytics & Data Science Practice Lead"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F56da369b2346&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnatural-gas-spot-price-prediction-using-artificial-neural-network-56da369b2346&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnatural-gas-spot-price-prediction-using-artificial-neural-network-56da369b2346&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnatural-gas-spot-price-prediction-using-artificial-neural-network-56da369b2346&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnatural-gas-spot-price-prediction-using-artificial-neural-network-56da369b2346&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----56da369b2346--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----56da369b2346--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://sarit-maitra.medium.com/?source=post_page-----56da369b2346--------------------------------", "anchor_text": ""}, {"url": "https://sarit-maitra.medium.com/?source=post_page-----56da369b2346--------------------------------", "anchor_text": "Sarit Maitra"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fc611876588a8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnatural-gas-spot-price-prediction-using-artificial-neural-network-56da369b2346&user=Sarit+Maitra&userId=c611876588a8&source=post_page-c611876588a8----56da369b2346---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F56da369b2346&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnatural-gas-spot-price-prediction-using-artificial-neural-network-56da369b2346&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F56da369b2346&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnatural-gas-spot-price-prediction-using-artificial-neural-network-56da369b2346&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://machinelearningmastery.com/learning-curves-for-diagnosing-machine-learning-model-performance/", "anchor_text": "here"}, {"url": "https://www.linkedin.com/in/saritmaitra/", "anchor_text": "here"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----56da369b2346---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/neural-networks?source=post_page-----56da369b2346---------------neural_networks-----------------", "anchor_text": "Neural Networks"}, {"url": "https://medium.com/tag/forecasting?source=post_page-----56da369b2346---------------forecasting-----------------", "anchor_text": "Forecasting"}, {"url": "https://medium.com/tag/data-analytics?source=post_page-----56da369b2346---------------data_analytics-----------------", "anchor_text": "Data Analytics"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F56da369b2346&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnatural-gas-spot-price-prediction-using-artificial-neural-network-56da369b2346&user=Sarit+Maitra&userId=c611876588a8&source=-----56da369b2346---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F56da369b2346&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnatural-gas-spot-price-prediction-using-artificial-neural-network-56da369b2346&user=Sarit+Maitra&userId=c611876588a8&source=-----56da369b2346---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F56da369b2346&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnatural-gas-spot-price-prediction-using-artificial-neural-network-56da369b2346&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----56da369b2346--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F56da369b2346&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnatural-gas-spot-price-prediction-using-artificial-neural-network-56da369b2346&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----56da369b2346---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----56da369b2346--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----56da369b2346--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----56da369b2346--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----56da369b2346--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----56da369b2346--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----56da369b2346--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----56da369b2346--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----56da369b2346--------------------------------", "anchor_text": ""}, {"url": "https://sarit-maitra.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://sarit-maitra.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Sarit Maitra"}, {"url": "https://sarit-maitra.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "2.8K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fc611876588a8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnatural-gas-spot-price-prediction-using-artificial-neural-network-56da369b2346&user=Sarit+Maitra&userId=c611876588a8&source=post_page-c611876588a8--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fba440ad8d04d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnatural-gas-spot-price-prediction-using-artificial-neural-network-56da369b2346&newsletterV3=c611876588a8&newsletterV3Id=ba440ad8d04d&user=Sarit+Maitra&userId=c611876588a8&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}