{"url": "https://towardsdatascience.com/how-to-use-deep-learning-for-time-series-forecasting-3f8a399cf205", "time": 1683014156.9676218, "path": "towardsdatascience.com/how-to-use-deep-learning-for-time-series-forecasting-3f8a399cf205/", "webpage": {"metadata": {"title": "How to use Deep Learning for Time Series Forecasting | by Christophe Pere | Towards Data Science", "h1": "How to use Deep Learning for Time Series Forecasting", "description": "For a long time, I heard that the problem of time series could only be approached by statistical methods (AR[1], AM[2], ARMA[3], ARIMA[4]). These techniques are generally used by mathematicians who\u2026"}, "outgoing_paragraph_urls": [{"url": "https://github.com/Christophe-pere/Time_series_RNN", "anchor_text": "Here", "paragraph_index": 3}, {"url": "https://machinelearningmastery.com/xgboost-for-time-series-forecasting/", "anchor_text": "here", "paragraph_index": 4}, {"url": "https://github.com/Jenniferz28/Time-Series-ARIMA-XGBOOST-RNN", "anchor_text": "github", "paragraph_index": 4}, {"url": "https://pandas.pydata.org/", "anchor_text": "Pandas", "paragraph_index": 23}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.MinMaxScaler.html", "anchor_text": "scikit-learn", "paragraph_index": 32}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.MinMaxScaler.html", "anchor_text": "MinMaxScaler", "paragraph_index": 32}, {"url": "https://keras.io/", "anchor_text": "Keras", "paragraph_index": 37}], "all_paragraphs": ["For a long time, I heard that the problem of time series could only be approached by statistical methods (AR[1], AM[2], ARMA[3], ARIMA[4]). These techniques are generally used by mathematicians who try to improve them continuously to constrain stationary and non-stationary time series.", "A friend of mine (mathematician, professor of statistics, and specialist in non-stationary time series) offered me several months ago to work on the validation and improvement of techniques to reconstruct the lightcurve of stars. Indeed, the Kepler satellite[11], like many other satellites, could not continuously measure the intensity of the luminous flux of nearby stars. The Kepler satellite was dedicated between 2009 and 2016 to search for planets outside our Solar System called extrasolar planets or exoplanets.", "As you have understood, we are going to travel a little further than our planet Earth and deep dive into a galactic journey whose machine learning will be our vessel. As you can understand, astrophysics has remained a strong passion for me.", "The notebook is available on Github: Here.", "So what ship will we carry through this study? We will use the recurrent neural networks (RNN[5]), models. We will use LSTM[6], GRU[7], Stacked LSTM, Stacked GRU, Bidirectional[8] LSTM, Bidirectional GRU, and also CNN-LSTM[9]. For those passionate about tree family, you can find a great article on XGBoost and time series written by Jason Brownlee here. A great repository about time series is available on github.", "For those who are not familiar with the RNN family, see them as learning methods with memory effect and the ability to forget. The bidirectional term comes from the architecture, it is about two RNN which will \"read\" the data in one direction (from left to right) and the other (from right to left) in order to be able to have the best representation of long-term dependencies.", "As said earlier in the introduction, the data correspond to flux measurements of several stars. Indeed, at each temporal increment (hour), the satellite made a measurement of the flux coming from nearby stars. This flux, or magnitude, which is light intensity, varies over time. There are several reasons for this, the proper movement of the satellite, rotation, angle of sight, etc. will vary. Therefore the number of photons measured will change, the star is a ball of molten material (hydrogen and helium fusion) which has its own movement therefore the emission of photons is made depending on its movement. This corresponds to fluctuations in light intensity.", "But, there can also be planets, exoplanets, which disturb the star or even pass between the star and in the line of sight of the satellite (transit method[12]). This passage obscures the star, the satellite receives fewer photons because they are blocked by the planet passing in front of it (a concrete example is a Solar eclipse due to the Moon).", "The set of flux measurements is called a light curve. What does a light curve look like? Here are some examples:", "The fluxes are very different from one star to another. Some are very noisy while others have great stability. The fluxes nevertheless present anomalies. Holes, or lack of measurement, are visible in the light curves. The goal is to see if it is possible to predict the behavior of light curves where there is no measurement.", "In order to be able to use the data in the models, it is necessary to carry out a data reduction. Two will be presented here, the moving average and window method.", "The moving average consists of taking X successive points and compute the mean on them. This method permits to reduce the variability and delete the noise. This also reduces the number of points, it\u2019s a downsampling method.", "The following function allows us to compute a moving average from a list of points by giving a number that will be used to compute the average and the standard deviation of the points.", "You can see that the function takes 3 parameters in the input. time and flux are the x and y of the time series. lag is the parameter controlling the number of points takes into account to compute the mean of the time and flux and the standard deviation of the flux.", "Now, we can take a look at how to use this function and the result obtained by the transformation.", "Now we need to import the data. The file kep_lightcurves.csv contains the data from the 13 stars. Each star has 4 columns, the original flux (\u2018\u2026_orig\u2019), the rescaled flux is the original flux minus the average flux (\u2018\u2026_rscl\u2019), the difference (\u2018\u2026_diff\u2019), and the residuals (\u2018\u2026_res\u2019). So, 52 columns in total.", "The result for the 3 previous lightcurves:", "The second method is the window method, how does it work?", "You need to take a number of points, in the previous case 20, compute the mean (no difference with the previous method), this point it\u2019s the beginning of the new time series and it is at the position 20 (shift of 19 points). But, instead of shifting to the next 20 points, the window is shifted by one point, compute the mean with the 20 previous points and move again and again by just shifting one step ahead. It\u2019s not a downsampling method but a cleaning method because the effect is to smooth the data points.", "You can easily use it like that:", "Well, not so bad. Setting the lag to 40 permits to \u201cpredict\u201d or extend the new time series in the small holes. But, if you look closer you\u2019ll see a divergence at the beginning and the end of the portions of the red line. The function can be improved to avoid these artifacts.", "For the rest of the study, we will use the time series obtained with the moving average method.", "Change the x-axis from values to dates:", "You can change the axis if you want with dates. The Kepler mission began on 2009\u201303\u201307 and ended in 2017. Pandas has a function called pd.data_range() this function that allows you to create dates from a list constantly incrementing.", "This line of code will create a new index with a frequency of hours. If you print the result (as below) you\u2019ll find a proper real timescale.", "You have now a good timescale for the original time series.", "So, now that the data reduction functions have been created, we can combine them in another function (shown below) which will take into account the initial dataset and the name of the stars present in the dataset (this part could have been done in the function).", "To generate the new data frames do this:", "We have 13 stars with 4 data types, corresponding to 52 columns.", "Perfect, at this point, you have two new datasets containing the data reduced by the moving average and the window method.", "In order to use a machine-learning algorithm to predict time series, the data must be prepared accordingly. The data cannot just be set at (x,y) data points. The data must take the form of a series [x1, x2, x3, \u2026, xn] and a predicted value y.", "The function below shows you how to set up your dataset:", "1- The data need to be rescaledDeep Learning algorithms are better when the data is in the range of [0, 1) to predict time series. To do it simply scikit-learn provides the function MinMaxScaler(). You can configure the feature_range parameter but by default it takes (0, 1). And clean the data of nan values (if you don\u2019t delete the nan values your loss function will be output nan).", "2- The data need to be converted into x list and y Now, we will the create_values() function to generate the data for the models. But, before, I prefer to save the original data by:", "Just take a look at the result:", "What metrics do we use for time series prediction? We can use the mean absolute error and the mean squared error. They are given by the function:", "You need to first import the functions:", "You can implement easily the RNN family with Keras in few lines of code. Here you can use this function which will configure your RNN. You need to first import the different models from Keras like:", "Now, we have the models imported from Keras. The function below can generate a simple model (SimpleRNN, LSTM, GRU). Or, two models (identical) can be stacked, or used in Bidirectional or a stack of two Bidirectional models. You can also add the CNN part (Conv1D)with MaxPooling1D and dropout.", "This function computes the metrics for the training part and the test part and returned the results in a data frame. Look at how you how to use it for five examples.", "The results are pretty good considering the data. We can see that deep learning RNN can reproduce with good accuracy of the data. The figure below shows the result of the prediction by the LSTM model.", "Table 1: Results of the different RNN models, showing the MAE and MSE metrics", "The Table 1 shows the mean absolute error (MAE) and the mean squared error (MSE) for the train set and the test set for the RNN family. The GRU shows the best result on the test set with an MAE of 4.15 and an MSE of 31.47.", "The results are good and reproduced the lightcurves of the different stars (see notebook). However, the fluctuations are not perfectly reproduced, the peaks do not have the same intensity and the flux is slightly shifted. A potential correction could be made via the attention mechanisms (Transformers[10]). Another way is to tune the models, the number of layers (stack), the number of units (cells), the combination of different RNN algorithms, new loss function or activation function, etc.", "This article shows the possibilities of combining so-called artificial intelligence methods with time series. The power of memory algorithms (RNN, LSTM, GRU) makes it possible to accurately reproduce sporadic fluctuations of events. In our case, the stellar flux exhibited quite strong and marked fluctuations that the methods have been able to capture.", "This study shows that time series are no longer reserved for statistical methods such as the ARIMA[4] model.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F3f8a399cf205&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-use-deep-learning-for-time-series-forecasting-3f8a399cf205&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-use-deep-learning-for-time-series-forecasting-3f8a399cf205&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-use-deep-learning-for-time-series-forecasting-3f8a399cf205&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-use-deep-learning-for-time-series-forecasting-3f8a399cf205&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----3f8a399cf205--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----3f8a399cf205--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://pere-christophe.medium.com/?source=post_page-----3f8a399cf205--------------------------------", "anchor_text": ""}, {"url": "https://pere-christophe.medium.com/?source=post_page-----3f8a399cf205--------------------------------", "anchor_text": "Christophe Pere"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F9cf1f3f55c40&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-use-deep-learning-for-time-series-forecasting-3f8a399cf205&user=Christophe+Pere&userId=9cf1f3f55c40&source=post_page-9cf1f3f55c40----3f8a399cf205---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F3f8a399cf205&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-use-deep-learning-for-time-series-forecasting-3f8a399cf205&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F3f8a399cf205&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-use-deep-learning-for-time-series-forecasting-3f8a399cf205&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://github.com/Christophe-pere/Time_series_RNN", "anchor_text": "Here"}, {"url": "https://machinelearningmastery.com/xgboost-for-time-series-forecasting/", "anchor_text": "here"}, {"url": "https://github.com/Jenniferz28/Time-Series-ARIMA-XGBOOST-RNN", "anchor_text": "github"}, {"url": "https://pandas.pydata.org/", "anchor_text": "Pandas"}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.MinMaxScaler.html", "anchor_text": "scikit-learn"}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.MinMaxScaler.html", "anchor_text": "MinMaxScaler"}, {"url": "https://keras.io/", "anchor_text": "Keras"}, {"url": "https://en.wikipedia.org/wiki/Autoregressive_model", "anchor_text": "Autoregressive model, Wikipedia"}, {"url": "https://en.wikipedia.org/wiki/Moving-average_model", "anchor_text": "Moving-average model, Wikipedia"}, {"url": "https://doi.org/10.1002/9780470061572.eqr276", "anchor_text": "https://doi.org/10.1002/9780470061572.eqr276"}, {"url": "https://ui.adsabs.harvard.edu/abs/1986Natur.323..533R", "anchor_text": "1986Natur.323..533R"}, {"url": "https://en.wikipedia.org/wiki/Doi_(identifier)", "anchor_text": "doi"}, {"url": "https://doi.org/10.1162%2Fneco.1997.9.8.1735", "anchor_text": "10.1162/neco.1997.9.8.1735"}, {"url": "https://en.wikipedia.org/wiki/ArXiv_(identifier)", "anchor_text": "arXiv"}, {"url": "https://arxiv.org/abs/1412.3555", "anchor_text": "1412.3555"}, {"url": "https://doi.org/10.1109/78.650093", "anchor_text": "10.1109/78.650093"}, {"url": "https://static.googleusercontent.com/media/research.google.com/fr//pubs/archive/43455.pdf", "anchor_text": "https://static.googleusercontent.com/media/research.google.com/fr//pubs/archive/43455.pdf"}, {"url": "https://arxiv.org/abs/1706.03762", "anchor_text": "https://arxiv.org/abs/1706.03762"}, {"url": "https://www.nasa.gov/mission_pages/kepler/overview/index.html", "anchor_text": "Kepler mission, Nasa"}, {"url": "https://medium.com/tag/data-science?source=post_page-----3f8a399cf205---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----3f8a399cf205---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----3f8a399cf205---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/towards-data-science?source=post_page-----3f8a399cf205---------------towards_data_science-----------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/tag/time-series-forecasting?source=post_page-----3f8a399cf205---------------time_series_forecasting-----------------", "anchor_text": "Time Series Forecasting"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F3f8a399cf205&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-use-deep-learning-for-time-series-forecasting-3f8a399cf205&user=Christophe+Pere&userId=9cf1f3f55c40&source=-----3f8a399cf205---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F3f8a399cf205&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-use-deep-learning-for-time-series-forecasting-3f8a399cf205&user=Christophe+Pere&userId=9cf1f3f55c40&source=-----3f8a399cf205---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F3f8a399cf205&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-use-deep-learning-for-time-series-forecasting-3f8a399cf205&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----3f8a399cf205--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F3f8a399cf205&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-use-deep-learning-for-time-series-forecasting-3f8a399cf205&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----3f8a399cf205---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----3f8a399cf205--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----3f8a399cf205--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----3f8a399cf205--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----3f8a399cf205--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----3f8a399cf205--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----3f8a399cf205--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----3f8a399cf205--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----3f8a399cf205--------------------------------", "anchor_text": ""}, {"url": "https://pere-christophe.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://pere-christophe.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Christophe Pere"}, {"url": "https://pere-christophe.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "357 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F9cf1f3f55c40&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-use-deep-learning-for-time-series-forecasting-3f8a399cf205&user=Christophe+Pere&userId=9cf1f3f55c40&source=post_page-9cf1f3f55c40--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fc4294bfe2553&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-use-deep-learning-for-time-series-forecasting-3f8a399cf205&newsletterV3=9cf1f3f55c40&newsletterV3Id=c4294bfe2553&user=Christophe+Pere&userId=9cf1f3f55c40&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}