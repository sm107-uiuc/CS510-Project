{"url": "https://towardsdatascience.com/reinforcement-learning-for-combinatorial-optimization-d1402e396e91", "time": 1682995675.320939, "path": "towardsdatascience.com/reinforcement-learning-for-combinatorial-optimization-d1402e396e91/", "webpage": {"metadata": {"title": "Reinforcement Learning for Combinatorial Optimization | by Or Rivlin | Towards Data Science", "h1": "Reinforcement Learning for Combinatorial Optimization", "description": "From as early as humankind\u2019s beginning, millions of years ago, every innovation in technology and every invention that improved our lives and our ability to survive and thrive on earth, has been\u2026"}, "outgoing_paragraph_urls": [{"url": "https://arxiv.org/pdf/1704.01665.pdf", "anchor_text": "Learning Combinatorial Optimization Algorithms over Graphs", "paragraph_index": 7}, {"url": "https://towardsdatascience.com/robotic-control-with-graph-networks-f1b8d22b8c86", "anchor_text": "I discuss graph neural networks in another article", "paragraph_index": 7}, {"url": "https://arxiv.org/pdf/1706.03762.pdf", "anchor_text": "Attention Is All You Need", "paragraph_index": 12}, {"url": "https://arxiv.org/pdf/1710.10903.pdf", "anchor_text": "Graph Attention Networks", "paragraph_index": 13}, {"url": "https://arxiv.org/pdf/1803.08475.pdf", "anchor_text": "Attention! Learn to Solve Routing Problems", "paragraph_index": 14}, {"url": "https://arxiv.org/pdf/1903.03332.pdf", "anchor_text": "Learning Heuristics Over Large Graphs Via Deep Reinforcement Learning", "paragraph_index": 18}, {"url": "https://github.com/orrivlin/MinimumVertexCover_DRL", "anchor_text": "Feel free to check it out", "paragraph_index": 21}], "all_paragraphs": ["From as early as humankind\u2019s beginning, millions of years ago, every innovation in technology and every invention that improved our lives and our ability to survive and thrive on earth, has been devised by the cunning minds of intelligent humans. From the fire to the wheel, and from electricity to quantum mechanics, our understanding of the world and the complexity of things around us have increased to the point that we often have difficulty grasping them intuitively.", "Today, designers of airplanes, cars, ships, satellites, complex structures many other endeavors are heavily relied on the ability of algorithms to make them better, often in subtle ways that humans could simply never achieve. In addition to design, optimization plays a crucial role in every-day things such as network routing (Internet and mobile), logistics, advertising, social networks and even medicine. In the future, as our technology continues to improve and complexify, the ability to solve difficult problems of immense scale is likely to be in much higher demand, and will require breakthroughs in optimization algorithms.", "Broadly speaking, combinatorial optimization problems are problems that involve finding the \u201cbest\u201d object from a finite set of objects. In this context, \u201cbest\u201d is measured by a given evaluation function that maps objects to some score or cost, and the objective is to find the object that merits the lowest cost. Most practically interesting combinatorial optimization problems (COPs from now on) are also very hard, in the sense that the number of objects in the set increases extremely fast due to even small increases in the problem size, making exhaustive search impractical.", "To make things clearer, we will focus on a specific problem, the well-known Traveling Salesman Problem (TSP). in this problem we have N cities, and our salesman must visit them all. However, travelling between cities incurs some cost and we must find a tour that minimizes the total accumulated cost while traveling to all the cities and returning to the starting city. For example, the image below shows an optimal tour of all the capital cities in the US:", "This problem naturally arises in many important applications such as planning, delivery services, manufacturing, DNA sequencing and many others. Finding better tours can sometimes have serious financial implications, prompting the scientific community and enterprise to invest a lot of effort in better methods for such problems.", "While building a tour for a TSP instance with K cities, we eliminate a city at each stage of the tour construction process, until no more cities are left. At the first stage we have K cities to choose from to start the tour, at the second stage we have K-1 options and then K-2 options and so forth. The number of possible tours we can construct is the product of the number of options we have at each stage, and so the complexity of this problem behaves like O(K!). For small numbers this may seem not so bad. Say we have a 5 city problem, the number of possible tours is 5!=120. But for 7 cities it increases to 5040, for 10 cities it\u2019s already 3628800 and for 100 cities it\u2019s a whopping 9.332622e+157, which is many orders of magnitude more than the number of atoms in the universe. Practical instances of TSP that arise in the real world often have many thousands of cities, and require highly sophisticated search algorithms and heuristics that have been developed for decades in a vast literature in order to be solved in a reasonable time (which could be hours). Unfortunately, many COPs that arise in real-world applications have unique nuances and constraints that prevent us from just using state of the art solvers for known problems such as TSP, and require us to develop methods and heuristics specific to that problem. This process can be long and arduous, and might require the work of domain experts to detect some structure in the combinatorial search space of the specific problem.", "Due to the dramatic successes of Deep Learning in many domains in recent years, the possibility of letting a machine learn how to solve our problem on its own sounds very promising. Automating the process of designing algorithms to difficult COPs could save a lot of money and time and could perhaps yield better solutions than human-designed methods could (as we have seen in achievements such as that of AlphaGo, which beat thousands of years of human experience).", "An early attempt at this problem came in 2016 with a paper called \u201cLearning Combinatorial Optimization Algorithms over Graphs\u201d. In this paper the authors trained a kind of Graph Neural Network (I discuss graph neural networks in another article) called structure2vec to greedily construct solutions to several hard COPs and achieved very nice approximation ratios (the ratio between the produced cost and the optimal cost).", "The basic idea goes like this: the state of the problem can be expressed as a graph, on which the neural network builds the solution. At each iteration of the solution construction process our network observes the current graph, and chooses a node to add to the solution, after which the graph is updated according to that choice, and the process is repeated until a complete solution is obtained.", "The authors trained their neural network using a DQN algorithm and demonstrated the learned model\u2019s ability to generalize to much larger problem instances than it was trained on. Their model generalized well even to instances of 1200 nodes (while being trained on instances of around 100 nodes), and could produce in 12 seconds solutions that were sometimes better than what a commercial solver could find in 1 hour. A big disadvantage of their method was that they used a \u201chelper\u201d function, to aid the neural network find better solutions. This helper function was a human designed one, and problem specific, which is what we would like to avoid.", "This use of a graph-based state representation makes a lot of sense, as many COPs can be very naturally expressed in this way, as in this example of a TSP graph:", "The nodes represent the cities, and the edges contain the inter-city distances. A very similar graph can be constructed without the edge attributes (if we do not assume knowledge of the distances for some reason). Recent years have seen an incredible rise in the popularity of neural network models that operate on graphs (with or without assuming knowledge of the structure), most notably in the area of Natural Language Processing where Transformer style models have become state of the art on many tasks.", "There are many excellent articles that explain the Transformer architecture in detail, so I will not delve too much into it, but give a very brief overview. The transformer architecture was introduced by Google researchers in a famous paper titled \u201cAttention Is All You Need\u201d and was used to tackle sequence problems that arise in NLP. The difference is that unlike in Recurrent Neural Networks such as LSTMs, which are explicitly fed a sequence of input vectors, the transformer is fed the input as a set of objects, and special means must be taken to help it see the order in the \u201csequence\u201d. The transformer uses several layers that consist of a multi-head self-attention sublayer followed by a fully connected sublayer.", "The relationship to graphs becomes evident in the attention layers, which are actually a sort of message passing mechanism between the input \u201cnodes\u201d. Each node observes the other nodes and attends to those that seem more \u201cmeaningful\u201d for it. This is very similar to the process that happens in Graph Attention Networks, and in fact, if we use a mask to block nodes passing messages to non-adjacent ones, we get an equivalent process.", "In their paper \u201cAttention! Learn to Solve Routing Problems\u201d, the authors tackle several combinatorial optimization problems that involve routing agents on graphs, including our now familiar Traveling Salesman Problem. They treat the input as a graph and feed it to a modified Transformer architecture that embeds the nodes of the graph, and then sequentially chooses nodes to add to the tour until a full tour has been constructed. Treating the input as a graph is a more \u2018correct\u2019 approach than feeding it a sequence of nodes, since it eliminates the dependency on the order in which the cities are given in the input, as long their coordinates do not change. This means that however we permute the cities, the output of a given graph neural network will remain the same, unlike in the sequence approach.", "In the architecture presented in the paper, the graph is embedded by a transformer style Encoder, which produces embeddings for all the nodes, and a single embedding vector for the entire graph. To produce the solution, a separate Decoder network is given each time a special context vector, that consists of the graph embedding and those of the last and first cities, and the embeddings of the unvisited cities, and it outputs a probability distribution on the unvisited cities, which is sampled to produce the next city to visit. The decoder sequentially produces cities until the tour is complete, and then a reward is given based on the length of the tour.", "The authors train their model using a reinforcement learning algorithm called REINFORCE, which is a policy gradient based algorithm. The pseudo code for their version can be seen here:", "They use a roll-out network to deterministically evaluate the difficulty of the instance, and periodically update the roll-out network with the parameters of the policy network. Using this method, the authors achieve excellent results on several problems, surpassing the other methods that I mentioned in previous sections. However, they still train and evaluate their method on small instances, with up to 100 nodes. While these results are promising, such instances are minuscule compared to real-world ones.", "Very recently, an important step was taken towards real-world sized problem with the paper \u201cLearning Heuristics Over Large Graphs Via Deep Reinforcement Learning\u201d. In this paper the authors trained a Graph Convolutional Network to solve large instances of problems such as Minimum Vertex Cover (MVC) and Maximum Coverage Problem (MCP). They used a popular greedy algorithm for these problems to train the neural network to embed the graph and predict the next node to choose at each stage, and then further trained it using a DQN algorithm.", "They evaluated their method on graphs with millions of nodes, and achieved results that are both better and faster than current standard algorithms. While they did make use of a hand-crafted heuristic to help train their model, future works might do away with this constraint, and learn to solve huge problems Tabula Rasa.", "Overall, I think that the quest to find structure in problems with vast search spaces is an important and practical research direction for Reinforcement Learning. Many critics of RL claim that so far it has only been used to tackle games and simple control problems, and that transferring it to real-world problems is still very far away. Though those claims might be true, I think that the methods I outlined in this article represent very real uses that could benefit RL in the very near-term future, and it\u2019s a shame that they don\u2019t attract as much attention as methods for video games.", "I implemented a relatively simple algorithm for learning to solve instances of the Minimum Vertex Cover problem, using a Graph Convolutional Network. Feel free to check it out.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fd1402e396e91&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Freinforcement-learning-for-combinatorial-optimization-d1402e396e91&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Freinforcement-learning-for-combinatorial-optimization-d1402e396e91&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Freinforcement-learning-for-combinatorial-optimization-d1402e396e91&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Freinforcement-learning-for-combinatorial-optimization-d1402e396e91&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----d1402e396e91--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----d1402e396e91--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://or-rivlin-mail.medium.com/?source=post_page-----d1402e396e91--------------------------------", "anchor_text": ""}, {"url": "https://or-rivlin-mail.medium.com/?source=post_page-----d1402e396e91--------------------------------", "anchor_text": "Or Rivlin"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fd6ea8553654c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Freinforcement-learning-for-combinatorial-optimization-d1402e396e91&user=Or+Rivlin&userId=d6ea8553654c&source=post_page-d6ea8553654c----d1402e396e91---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fd1402e396e91&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Freinforcement-learning-for-combinatorial-optimization-d1402e396e91&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fd1402e396e91&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Freinforcement-learning-for-combinatorial-optimization-d1402e396e91&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "http://www.wallpapermaiden.com/image/2018/02/01/communication-molecules-lines-connection-abstract-19701.jpg", "anchor_text": "source"}, {"url": "https://static.pakwheels.com/2016/04/aerodynamic_mercbenz-640x360.jpg", "anchor_text": "source"}, {"url": "https://cdn.journals.aps.org/journals/PHYSICS/synopses/images/10.1103/PhysRevA.95.032323", "anchor_text": "source"}, {"url": "https://arxiv.org/pdf/1704.01665.pdf", "anchor_text": "Learning Combinatorial Optimization Algorithms over Graphs"}, {"url": "https://towardsdatascience.com/robotic-control-with-graph-networks-f1b8d22b8c86", "anchor_text": "I discuss graph neural networks in another article"}, {"url": "https://arxiv.org/pdf/1704.01665.pdf", "anchor_text": "source"}, {"url": "https://openi.nlm.nih.gov/imgs/512/288/3270844/PMC3270844_sensors-10-00330f5.png", "anchor_text": "source"}, {"url": "https://arxiv.org/pdf/1706.03762.pdf", "anchor_text": "Attention Is All You Need"}, {"url": "http://jalammar.github.io/images/t/transformer_resideual_layer_norm.png", "anchor_text": "source"}, {"url": "https://arxiv.org/pdf/1710.10903.pdf", "anchor_text": "Graph Attention Networks"}, {"url": "https://arxiv.org/pdf/1803.08475.pdf", "anchor_text": "Attention! Learn to Solve Routing Problems"}, {"url": "https://arxiv.org/pdf/1803.08475.pdf", "anchor_text": "source"}, {"url": "https://arxiv.org/pdf/1903.03332.pdf", "anchor_text": "Learning Heuristics Over Large Graphs Via Deep Reinforcement Learning"}, {"url": "https://arxiv.org/pdf/1903.03332.pdf", "anchor_text": "source"}, {"url": "https://github.com/orrivlin/MinimumVertexCover_DRL", "anchor_text": "Feel free to check it out"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----d1402e396e91---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----d1402e396e91---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/reinforcement-learning?source=post_page-----d1402e396e91---------------reinforcement_learning-----------------", "anchor_text": "Reinforcement Learning"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----d1402e396e91---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/towards-data-science?source=post_page-----d1402e396e91---------------towards_data_science-----------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fd1402e396e91&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Freinforcement-learning-for-combinatorial-optimization-d1402e396e91&user=Or+Rivlin&userId=d6ea8553654c&source=-----d1402e396e91---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fd1402e396e91&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Freinforcement-learning-for-combinatorial-optimization-d1402e396e91&user=Or+Rivlin&userId=d6ea8553654c&source=-----d1402e396e91---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fd1402e396e91&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Freinforcement-learning-for-combinatorial-optimization-d1402e396e91&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----d1402e396e91--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fd1402e396e91&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Freinforcement-learning-for-combinatorial-optimization-d1402e396e91&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----d1402e396e91---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----d1402e396e91--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----d1402e396e91--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----d1402e396e91--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----d1402e396e91--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----d1402e396e91--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----d1402e396e91--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----d1402e396e91--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----d1402e396e91--------------------------------", "anchor_text": ""}, {"url": "https://or-rivlin-mail.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://or-rivlin-mail.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Or Rivlin"}, {"url": "https://or-rivlin-mail.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "793 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fd6ea8553654c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Freinforcement-learning-for-combinatorial-optimization-d1402e396e91&user=Or+Rivlin&userId=d6ea8553654c&source=post_page-d6ea8553654c--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F8de554e94ad7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Freinforcement-learning-for-combinatorial-optimization-d1402e396e91&newsletterV3=d6ea8553654c&newsletterV3Id=8de554e94ad7&user=Or+Rivlin&userId=d6ea8553654c&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}