{"url": "https://towardsdatascience.com/predictive-maintenance-with-lstm-siamese-network-51ee7df29767", "time": 1683001346.084348, "path": "towardsdatascience.com/predictive-maintenance-with-lstm-siamese-network-51ee7df29767/", "webpage": {"metadata": {"title": "Predictive Maintenance with LSTM Siamese Network | by Marco Cerliani | Towards Data Science", "h1": "Predictive Maintenance with LSTM Siamese Network", "description": "Predictive Maintenance nowadays is an active field where Artificial Intelligence solutions are introduced to improve the productivity of every kind of manufacturing system. Typical requests involve\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.kaggle.com/inIT-OWL/high-storage-system-data-for-energy-optimization", "anchor_text": "High Storage System Data for Energy Optimization", "paragraph_index": 2}, {"url": "https://www.smartfactory-owl.de/index.php/en/", "anchor_text": "Smartfactory", "paragraph_index": 2}], "all_paragraphs": ["Predictive Maintenance nowadays is an active field where Artificial Intelligence solutions are introduced to improve the productivity of every kind of manufacturing system. Typical requests involve developing a solution that produces warnings when particular parts of observed components are closed to failure. As can be guessed, these are classic \u2018situations of unbalance\u2019 where we have tons of data coming from every kind of sensor but a lack of positive labeled samples, where a positive sample is the presence of a failure.", "In a previous post, I\u2019ve introduced a solution that classifies the degradation status of a particular component in a hydraulic pipeline system; the results were cool! Now, I try to develop a pipeline that detects if a storage system is close to failure. We want to classify continuous time series coming from sensors making use of Neural Networks. In particular, I avoid the problem of lack in failure samples using Siamese Networks adapted to fit time series with an LSTM architecture.", "As always, I prefer to work with real data. I found a fantastic dataset on Kaggle: High Storage System Data for Energy Optimization, released by Smartfactory. The dataset stores the signals of 4 short conveyor belts (BLO, BHL, BHR, BRU) and 2 rails (HR, HL).", "The high storage system is built in order to transport one package between two spots. The two conveyor belts in the middle can only move vertically when they don\u2019t move the package horizontally. The two conveyor belts in the middle can move the package horizontal, they move vertically as well. Two runs of the whole system are provided: optimized and not optimized. I make use of HRSS_anomalous_optimized.csv, which contains optimized runs with failures.", "We have 19634 temporal observations split into 111 cycles and 4517 recorded failures. Every time a cycle starts, the timestamp is set to 0. Those cycles are not necessarily recorded directly after each other. There could be a bigger time difference between them.", "For every cycle, we have at disposal 18 sensors laid on the 4 conveyor belts and on the 2 rails, which monitor their activities.", "Before starting to think about the model, we have to spend a good part of our time thinking about cleaning and preprocessing. In these kinds of situations, the data are always very noisy and adequate preliminary manipulation is critical to achieve good results. We have no missing values but we have sensor series with a huge difference in magnitude, as seen on std bar chart. In order to reduce this discrepancy, I adopt three steps preprocess workflow:", "All these procedures have to be carried out with care! We don\u2019t want to pollute our data and compromise our results. For these reasons, it\u2019s important to establish at the begging an optimal validation strategy. In our case, we have to deal with time series, so the most common validation approach is to validate our results by preserving time dependency. I want to test my model on the latest part of the data (the latest 10%); whereas \u2018the latest part\u2019 I intend the latest 10% of every cycle. So, with this concept in mind, it\u2019s easier to operate an ad hoc preprocess.", "As introduced at the beginning, we try to model the presence of possible failures in the system one step in advance through a Siamese Network. Understanding how a siamese system works is very simple and intuitive. It receives a double input on which it computes an embedding distance. The scope of the model is to verify if the two samples are similar or far away from each other in the space. All the processes can be dealt as a binary classification task, where the positive samples belong to the same class (so they are similar).", "The siamese principle is often applied in image recognition, we try to switch the domain of application approaching a time series classification problem in the field of Predictive Maintenance. The benefit of this procedure is to avoid the lack of unlabeled samples for the crucial class of interest, i.e. in Predictive Maintenance, it\u2019s synonymous of the absence of failures evidence.", "The premises sound great! So to carry out this amazing task the perfect tool is represented by the powerful LSTM. We\u2019ll build our Siamese Network adopting a sequential encoder composed of LSTM layers.", "The choice of an LSTM structure implies managing the data in the form of sequential samples. We split our initial time series into a sequence of 8 time steps, taking care to avoid overlapping with the cycle starts (in the code this process is computed together with the preprocess workflow).", "We generate the training pairs randomly choosing from our training population of sequences. In this way, we are able to increase significantly the number of samples at our disposal. With the pairs generated, we are ready to fit the Siamese Network. At the end of this phase, we have to take care of validation. Check the performance of this kind of system is not always immediate. The network is fitted receiving a double input, so we have to pass it two sequences at once. One of the two is for sure our test sequence, the other one comes from train. Firstly, we combine the test with a training sequence, selected at random, from the fault class. Secondly, we pair it with a not fault sample. So, we compute two predictions at the same time to verify the nearest class to which the test sample belongs to. The greatest similarity score defines which class our test sequence belongs to.", "The stability of the results can be granted repeating the process of random selection and prediction N times for the couple test sequence/training sequence (of a specific class). Let\u2019s say by doing the above N comparisons we get N similarity scores for a single class. We can summarize them taking the maximum or other statistics like the mean (I choose the max). So after this procedure, we can check the performance in a classic way.", "We are able to identify some of the fault sequences one step in advance in a valuable way. We could predict around 15% of breaks restricting the number of false-positive (high precision), which can be considered a good starting point for a storage system.", "In this post, I produce a solution to detect faults in advance. I want to apply to this particular and infamous task the power of Siamese Network with LSTM layers. This structure, combined with a proper and clever preprocess workflow, grants us to \u2018ignore\u2019 the lack of positive labeled samples and train a model which classifies, at a particular moment, the status of our system.", "If you are interested in the topic, I suggest:", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F51ee7df29767&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredictive-maintenance-with-lstm-siamese-network-51ee7df29767&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredictive-maintenance-with-lstm-siamese-network-51ee7df29767&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredictive-maintenance-with-lstm-siamese-network-51ee7df29767&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredictive-maintenance-with-lstm-siamese-network-51ee7df29767&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----51ee7df29767--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----51ee7df29767--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@cerlymarco?source=post_page-----51ee7df29767--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@cerlymarco?source=post_page-----51ee7df29767--------------------------------", "anchor_text": "Marco Cerliani"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fc843902314c7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredictive-maintenance-with-lstm-siamese-network-51ee7df29767&user=Marco+Cerliani&userId=c843902314c7&source=post_page-c843902314c7----51ee7df29767---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F51ee7df29767&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredictive-maintenance-with-lstm-siamese-network-51ee7df29767&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F51ee7df29767&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredictive-maintenance-with-lstm-siamese-network-51ee7df29767&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@solimonster?utm_source=medium&utm_medium=referral", "anchor_text": "sol"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://www.kaggle.com/inIT-OWL/high-storage-system-data-for-energy-optimization", "anchor_text": "High Storage System Data for Energy Optimization"}, {"url": "https://www.smartfactory-owl.de/index.php/en/", "anchor_text": "Smartfactory"}, {"url": "https://www.kaggle.com/inIT-OWL/high-storage-system-data-for-energy-optimization", "anchor_text": "source"}, {"url": "https://towardsdatascience.com/predictive-maintenance-detect-faultsfrom-sensors-with-cnn-6c6172613371", "anchor_text": "Predictive Maintenance: detect Faults from Sensors with CNN"}, {"url": "https://towardsdatascience.com/predictive-maintenance-detect-faults-from-sensors-with-crnn-and-spectrograms-e1e4f8c2385d", "anchor_text": "Predictive Maintenance: detect Faults from Sensors with CRNN and Spectrograms"}, {"url": "https://medium.com/towards-data-science/predictive-maintenance-with-resnet-ebb4f4a0be3d", "anchor_text": "Predictive Maintenance with ResNet"}, {"url": "https://github.com/cerlymarco/MEDIUM_NoteBook", "anchor_text": "CHECK MY GITHUB REPO"}, {"url": "https://www.linkedin.com/in/marco-cerliani-b0bba714b/", "anchor_text": "Linkedin"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----51ee7df29767---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/siamese-networks?source=post_page-----51ee7df29767---------------siamese_networks-----------------", "anchor_text": "Siamese Networks"}, {"url": "https://medium.com/tag/predictive-maintenance?source=post_page-----51ee7df29767---------------predictive_maintenance-----------------", "anchor_text": "Predictive Maintenance"}, {"url": "https://medium.com/tag/lstm?source=post_page-----51ee7df29767---------------lstm-----------------", "anchor_text": "Lstm"}, {"url": "https://medium.com/tag/towards-data-science?source=post_page-----51ee7df29767---------------towards_data_science-----------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F51ee7df29767&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredictive-maintenance-with-lstm-siamese-network-51ee7df29767&user=Marco+Cerliani&userId=c843902314c7&source=-----51ee7df29767---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F51ee7df29767&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredictive-maintenance-with-lstm-siamese-network-51ee7df29767&user=Marco+Cerliani&userId=c843902314c7&source=-----51ee7df29767---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F51ee7df29767&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredictive-maintenance-with-lstm-siamese-network-51ee7df29767&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----51ee7df29767--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F51ee7df29767&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredictive-maintenance-with-lstm-siamese-network-51ee7df29767&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----51ee7df29767---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----51ee7df29767--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----51ee7df29767--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----51ee7df29767--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----51ee7df29767--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----51ee7df29767--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----51ee7df29767--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----51ee7df29767--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----51ee7df29767--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@cerlymarco?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@cerlymarco?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Marco Cerliani"}, {"url": "https://medium.com/@cerlymarco/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "6K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fc843902314c7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredictive-maintenance-with-lstm-siamese-network-51ee7df29767&user=Marco+Cerliani&userId=c843902314c7&source=post_page-c843902314c7--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fe2412974851a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredictive-maintenance-with-lstm-siamese-network-51ee7df29767&newsletterV3=c843902314c7&newsletterV3Id=e2412974851a&user=Marco+Cerliani&userId=c843902314c7&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}