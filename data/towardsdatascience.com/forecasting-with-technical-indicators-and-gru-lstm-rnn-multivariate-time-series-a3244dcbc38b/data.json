{"url": "https://towardsdatascience.com/forecasting-with-technical-indicators-and-gru-lstm-rnn-multivariate-time-series-a3244dcbc38b", "time": 1683001469.1352599, "path": "towardsdatascience.com/forecasting-with-technical-indicators-and-gru-lstm-rnn-multivariate-time-series-a3244dcbc38b/", "webpage": {"metadata": {"title": "Technical Indicators and GRU/LSTM for Time-Series Prediction | by Sarit Maitra | Towards Data Science", "h1": "Technical Indicators and GRU/LSTM for Time-Series Prediction", "description": "TECHNICAL indicators are available at large numbers and used mostly by stock traders. Most indicators have user-defined variables which allow traders to adapt key inputs such as look-back period\u2026"}, "outgoing_paragraph_urls": [{"url": "https://arxiv.org/pdf/1412.3555v1.pdf", "anchor_text": "article", "paragraph_index": 1}, {"url": "https://medium.com/datadriveninvestor/multivariate-time-series-using-gated-recurrent-unit-gru-1039099e545a", "anchor_text": "article", "paragraph_index": 3}], "all_paragraphs": ["TECHNICAL indicators are available at large numbers and used mostly by stock traders. Most indicators have user-defined variables which allow traders to adapt key inputs such as look-back period which us how much historical data will be used to form the calculations to suit their needs. We will use some of the indicators to create features in the existing data set. Applying these features, we will see if we can predict the future price of a particular stock.", "I have used here Gated Recurrent Unit (GRU) and Long Short-Term Memory (LSTM) of recurrent units to compare their performance. LSTM is well established on sequence-based tasks with long-term dependencies, and GRU is an addition in the field of machine learning. It is an improvised version of Recurrent Neural Network(RNN). I found this article is quite interesting to know more about these two network architecture. Though they are quite popular in the field of NLP(natural language text processing), here, I have experimented their performance on numerical financial market data.", "There are some similarities and differences between GRU and LSTM.", "You may visit this article to get more theoretical ideas about GRU and LSTM network architecture. I will explain here both feature creation and applying RNN with a simplified example.", "I have created 2 copies of data (tek_ind_1 & tek_ind_2) to add columns of different sets of Technical Indicators.", "Calculation of Stochastic Oscillator (%K and %D)", "For data that is known to have seasonal, or daily patterns we\u2019d like to use Fourier analysis to make predictions. It\u2019s like a combination of extrapolation and de-noising. We want to repeat the observed data over multiple periods. and also want to find patterns by finding the dominant frequency components in the observed data. We will compute the Fourier transformation and the spectral density of the signal.", "If we compare with 10,50,200 day MA plot, we see here that Fourier transformation smoothing the data better by de-noising.", "We see that data points varies from -100 to 756.77; we need to scale and standardize the data for RNN network. This will be done once we split the train/test data set.", "Now, let\u2019s define a function to create the time series data set. I have specified a look back interval (60 time steps) and the predicted column. RNN works based on time steps. If we are making 60 time steps which means that, for making future forecast our RNN will observe previous 60 time steps and every time it will predict the output, it will check previous 60 time steps. So, we need to create the data structure accordingly.", "Above is first 4 rows of the transformed data set. We can see the 22 input variables (input series) and the 1 output variable (Close Price). If we check the new shape of data, we can see the difference of 60 time steps.", "Here we split the data-set into train and test sets. Then splits the train and test sets into input and output variables. Finally, the inputs are reshaped into the 3D format expected by LSTMs, namely [samples, time-steps, features]. We will fit the model on 90% of the data, then evaluate it on the remaining data.", "Sequence of values are crucial with time-series data. So, we have split the data in train and test test using a systematic approach as below. Also, normalization is required to fit the data for neural network architecture learning.", "Here I have taken a look back period of 60 days where the model will look through last 60 time steps to predict future price.", "We now create the LSTM model with 3 LSTM layers and one Dense layer. I have defined the LSTM with 75 neurons in the first hidden layer, 30 neuron in the 2nd and 3rd layers; 1 neuron in the output layer for predicting price. The input shape will be 60 time step with 22 features.", "The model is compiled with Mean Absolute Error (MAE) loss function and the efficient Adam version of stochastic gradient descent.", "Once the model is fit on training data, we want to see the skill of the model on out-of-sample data. Likewise we did in training set, we will prepare the test set and we need to pick up look-back value from training data. The look-back is the number of previous time steps to use as input variables to predict the next time period (60 in this case).", "The model is fitted with 20 training epochs with a batch size of 32.", "GRU network is created with same parameters and configuration as LSTM.", "Here, both LSTM and GRU had the same architecture but the number of parameters in LSTM is 49, 771 whereas GRU in GRU is 37,741.", "As we already discussed the differences, GRU with two gates compared to LSTM that has three gates. GRU has fewer parameters it is computationally more efficient than LSTM.", "The training history of both LSTM & GRU models are used to diagnose the behavior of the models. I have created a single plot for the ease of convenience.", "We can see that, in both cases the training losses is considerably lower than validation losses indicating models may have under-fitting the training data. The performance may be improved by increasing the epochs which can be experimented.", "This gives us the scale down values of prediction; we inverse the scale and need to bring these values to normal scale. Let us find out the scaling level of our data.", "Here, the 1st value is the Open price; to bring this to normal scale, we divide this value by 1 as shown below.", "Now we can forecast for the entire test data-set combining the forecast with the test data-set and invert the scaling. ith forecasts and actual values in their original scale, we can calculate an error score ( Root Mean Squared Error \u2014 RMSE) for the model. RMSE gives error in the same units as the variable itself.", "The accuracy can be calculated by taking the average of observed values and predicted values and dividing them with each other.", "We can perform the similar exercise on GRU model.", "Moreover, performance of the models can be improved by adding more time variants e.g. adding Weeks (day of weeks, week no.), Months (month no.) and Year Columns, time lags etc. and also adjusting the hyper-parameters and epochs.", "The key difference between a GRU and an LSTM is that a GRU has two gates (reset and update gates) whereas an LSTM has three gates (namely input, output and forget gates). GRU network is simpler and thus easier to modify, for example adding new gates in case of additional input to the network. It\u2019s just less code in general. However, if sequence is large or accuracy is very critical, I would recommend LSTM", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Analytics & Data Science Practice Lead"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fa3244dcbc38b&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fforecasting-with-technical-indicators-and-gru-lstm-rnn-multivariate-time-series-a3244dcbc38b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fforecasting-with-technical-indicators-and-gru-lstm-rnn-multivariate-time-series-a3244dcbc38b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fforecasting-with-technical-indicators-and-gru-lstm-rnn-multivariate-time-series-a3244dcbc38b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fforecasting-with-technical-indicators-and-gru-lstm-rnn-multivariate-time-series-a3244dcbc38b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----a3244dcbc38b--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----a3244dcbc38b--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://sarit-maitra.medium.com/?source=post_page-----a3244dcbc38b--------------------------------", "anchor_text": ""}, {"url": "https://sarit-maitra.medium.com/?source=post_page-----a3244dcbc38b--------------------------------", "anchor_text": "Sarit Maitra"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fc611876588a8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fforecasting-with-technical-indicators-and-gru-lstm-rnn-multivariate-time-series-a3244dcbc38b&user=Sarit+Maitra&userId=c611876588a8&source=post_page-c611876588a8----a3244dcbc38b---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa3244dcbc38b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fforecasting-with-technical-indicators-and-gru-lstm-rnn-multivariate-time-series-a3244dcbc38b&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa3244dcbc38b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fforecasting-with-technical-indicators-and-gru-lstm-rnn-multivariate-time-series-a3244dcbc38b&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://arxiv.org/pdf/1412.3555v1.pdf", "anchor_text": "article"}, {"url": "https://medium.com/datadriveninvestor/multivariate-time-series-using-gated-recurrent-unit-gru-1039099e545a", "anchor_text": "article"}, {"url": "https://www.linkedin.com/in/saritmaitra/", "anchor_text": "here"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----a3244dcbc38b---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/recurrent-neural-network?source=post_page-----a3244dcbc38b---------------recurrent_neural_network-----------------", "anchor_text": "Recurrent Neural Network"}, {"url": "https://medium.com/tag/technical-indicator?source=post_page-----a3244dcbc38b---------------technical_indicator-----------------", "anchor_text": "Technical Indicator"}, {"url": "https://medium.com/tag/predictive-analytics?source=post_page-----a3244dcbc38b---------------predictive_analytics-----------------", "anchor_text": "Predictive Analytics"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fa3244dcbc38b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fforecasting-with-technical-indicators-and-gru-lstm-rnn-multivariate-time-series-a3244dcbc38b&user=Sarit+Maitra&userId=c611876588a8&source=-----a3244dcbc38b---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fa3244dcbc38b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fforecasting-with-technical-indicators-and-gru-lstm-rnn-multivariate-time-series-a3244dcbc38b&user=Sarit+Maitra&userId=c611876588a8&source=-----a3244dcbc38b---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa3244dcbc38b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fforecasting-with-technical-indicators-and-gru-lstm-rnn-multivariate-time-series-a3244dcbc38b&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----a3244dcbc38b--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fa3244dcbc38b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fforecasting-with-technical-indicators-and-gru-lstm-rnn-multivariate-time-series-a3244dcbc38b&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----a3244dcbc38b---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----a3244dcbc38b--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----a3244dcbc38b--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----a3244dcbc38b--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----a3244dcbc38b--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----a3244dcbc38b--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----a3244dcbc38b--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----a3244dcbc38b--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----a3244dcbc38b--------------------------------", "anchor_text": ""}, {"url": "https://sarit-maitra.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://sarit-maitra.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Sarit Maitra"}, {"url": "https://sarit-maitra.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "2.8K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fc611876588a8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fforecasting-with-technical-indicators-and-gru-lstm-rnn-multivariate-time-series-a3244dcbc38b&user=Sarit+Maitra&userId=c611876588a8&source=post_page-c611876588a8--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fba440ad8d04d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fforecasting-with-technical-indicators-and-gru-lstm-rnn-multivariate-time-series-a3244dcbc38b&newsletterV3=c611876588a8&newsletterV3Id=ba440ad8d04d&user=Sarit+Maitra&userId=c611876588a8&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}