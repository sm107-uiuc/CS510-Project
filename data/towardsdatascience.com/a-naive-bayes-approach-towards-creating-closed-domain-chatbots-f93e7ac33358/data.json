{"url": "https://towardsdatascience.com/a-naive-bayes-approach-towards-creating-closed-domain-chatbots-f93e7ac33358", "time": 1683006732.668818, "path": "towardsdatascience.com/a-naive-bayes-approach-towards-creating-closed-domain-chatbots-f93e7ac33358/", "webpage": {"metadata": {"title": "A Naive Bayes approach towards creating closed domain Chatbots! | by Dhruvil Shah | Towards Data Science", "h1": "A Naive Bayes approach towards creating closed domain Chatbots!", "description": "Have you ever experienced seeking customer support help for making an inquiry or paying bills or maybe while ordering food online? The chances are good that your first interaction was with a chatbot\u2026"}, "outgoing_paragraph_urls": [{"url": "https://github.com/jackfrost1411/naive_bayes_chatbot", "anchor_text": "this", "paragraph_index": 24}, {"url": "https://www.linkedin.com/in/dhruvilshah28/", "anchor_text": "here", "paragraph_index": 24}, {"url": "http://LinkedIn.com/in/dhruvilshah28", "anchor_text": "LinkedIn.com/in/dhruvilshah28", "paragraph_index": 30}], "all_paragraphs": ["Have you ever experienced seeking customer support help for making an inquiry or paying bills or maybe while ordering food online? The chances are good that your first interaction was with a chatbot. Many companies use rule-based or retrieval-based chatbots that are trained for a specific subject, these are called closed domain chatbots. For example, if you want to check the status of your flight you may have a chat like this :", "In the conversation above, chatbot gave a reply that made the most sense to it or that was very similar to the question asked. This chatbot is specifically trained for handling customer reports or inquiries about flights.", "A rule-based chatbot uses RE (Regular Expression) patterns for matching the input user response to the responses it is trained on for carrying the conversation with a person when a retrieval-based chatbot uses Intent Classification, Entity Recognition and Response Selection for carrying out a real conversation.", "There is an easy and efficient approach for creating a closed domain chatbot that uses the Naive Bayes classifier. In this approach a closed domain dataset containing questions/user-responses and corresponding answers is made, in which each question/user-response is given a label, this label relates the question to its answer. Because of multiple questions could have the same response, there can be multiple questions having the same answer. To clear the clouds let\u2019s look at the example.", "The labels/digits at the end are nothing but the index of answers in our answers dataset.", "The first two questions contain the label \u20181\u2019 so they refer to the response \u2018Hi there, how are you !?\u2019. Similarly, the last four questions refer to \u2018I\u2019m 22 years old\u2019.", "The notion here is that the Naive Bayes classifier will predict the label based on the input we give it. So when you say \u2018hi\u2019 our classifier will predict the label \u20181\u2019, which in return we can use to find a suitable answer. When the input is \u2018what\u2019s your age?\u2019 classifier will predict the label \u20183\u2019, which is an index of the answer \u2018I\u2019m 22 years old\u2019.", "The below figure will dissolve any misgivings you have about the notion.", "If we have our questions formatted as above in a file called \u2018que.txt\u2019 and answers in a file \u2018ans.txt\u2019, we can prepare separate lists containing questions, labels, and answers with the help of the code below:", "Each label is at the end of the question and we can get it as shown above. After this, we will have all the questions for training in a list called \u2018questions\u2019 and the labels of those questions in a list \u2018labels\u2019. Remember, the labels of questions relate them to their answers. In the \u2018answers\u2019 list all the possible answers will be stored.", "Note: Here, label numbers at the end of a question start from 1 but to map them to answers in the \u2018answers\u2019 list we will have to do a subtraction of 1 from the number because python list indexing starts from 0.", "Now, we need to convert our training questions to vectors to feed them to our classifier. For this purpose, we are going to use CountVectorizer from the machine learning library sci-kit learn. Below is the code snippet for doing this:", "\u2018Bow\u2019 in bow_vectorizer stands for Bag-of-words. The .fit_transform() method of CountVectorizer() does two things: 1.) trains the features dictionary \u2014 dictionary of all the unique words in the training corpus 2.) transforms each question into vectors of a size of features dictionary that contains zeros in all the places except for the words used in the question", "If you didn\u2019t understand the above explanation, let\u2019s take an example.", "The feature dictionary contains all the unique words from the training corpus as keys and their index as values. The word \u2018fly\u2019 appeared twice in our sentence. If we look at the feature dictionary for \u2018fly\u2019, we find that its index is 3. So, when we look at our vector we\u2019d expect the number at index 3 to be \u20182\u2019. As shown above the CountVectorizer() gives us the vectors for our questions we feed.", "Note: Here, we are training our classifier on a very small dataset containing 10 answers and 37 questions only to keep things simple. The size may differ according to various applications.", "Now that we have our training vectors it\u2019s time we create our Naive Bayes classifier. For this, we will use sci-kit learn\u2019s MultinomialNB().", "We train our classifier using .fit() method, passing in the training vectors and corresponding labels.", "Now, our classifier is ready to make predictions. We can take input from the user, convert it into the vector with the help of vectorizer we created earlier, and get predictions of the label from our classifier.", "It is time we create a chatbot class that comprises all methods to carry out a conversation. start_chat() method is to start the conversation. chat() method checks for exit commands like \u2018quit\u2019 or \u2018bye\u2019 and stops the conversation if found any of those words in a user\u2019s response.", "Let\u2019s create an instance of our ChatBot class and test our work.", "When we call .start_chat() eventually call goes to .chat() for checking of exit words and then to .generate_response(). .generate_response() method takes user response as input, converts it to a vector-based on the training corpus, and feeds it to our classifier to get the prediction of a label which in turn will give us the index of the answer to be given to the user. Remember, here we have to access the answers list by index minus one.", "The above GIF shows how chatbot responds with the weather inquiry. In the training data, there is a user response/question \u2014 \u201ctell me today\u2019s weather report 8\u201d which contains label \u20188\u2019. In the answers dataset on line 8 is the response \u2014 \u201cToday temperature will be 37 degrees Celsius and sky will be clear all day\u201d. It is obvious that this response is hardcoded here, there can be functions to do the job of entity recognition from the user response (\u2018weather\u2019) and getting the real-time data from the web using available APIs.", "Our chatbot is ready. The output above also shows how accurate the prediction is but for this project as a minimal dataset was used, the accuracy is relatively low. Still, it works just okay. Companies can simply adopt this system by replacing their larger closed domain dataset.", "GitHub\u2019s link for this project is this. You can get all of the above code from there and you can find me here on LinkedIn.", "Intent Classification and Entity Recognition can be integrated into this approach to serve the applications like paying bills or suggesting songs based on different genres or providing the status of the flight specified by the user. Part-of-speech (POS) tagging could be used for this.", "This approach can not be applied to open-domain applications where user response can vary to various applications. This approach is strictly for the closed-domain applications where the responses can be determined beforehand and we can map the questions to them.", "To conclude, chatbots can be built using the Naive Bayes approach in which we just have to give each training question a corresponding label number of the answer and our classifier will predict the label of the user input. This label number is an index of a corresponding response in our answers\u2019 dataset. This way, we do not need to worry much about Regular expression pattern matching like in regular rule-based chatbot approach. The chatbot built above is trained on a very smaller dataset as this is supposed to be a simple explanation of the new approach. The companies may create their datasets according to the specific application.", "For a production system, you will want to consider one of the existing bot frameworks and integrating this approach into it; this way, you do not have to start from scratch. The Internet is full of resources and after reading this article you may want to create a chatbot of your own.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Science Enthusiast | Full Stack Developer | LinkedIn.com/in/dhruvilshah28"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Ff93e7ac33358&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-naive-bayes-approach-towards-creating-closed-domain-chatbots-f93e7ac33358&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-naive-bayes-approach-towards-creating-closed-domain-chatbots-f93e7ac33358&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-naive-bayes-approach-towards-creating-closed-domain-chatbots-f93e7ac33358&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-naive-bayes-approach-towards-creating-closed-domain-chatbots-f93e7ac33358&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----f93e7ac33358--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----f93e7ac33358--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@dhruvilshah28?source=post_page-----f93e7ac33358--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@dhruvilshah28?source=post_page-----f93e7ac33358--------------------------------", "anchor_text": "Dhruvil Shah"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fe0cd54e8f51c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-naive-bayes-approach-towards-creating-closed-domain-chatbots-f93e7ac33358&user=Dhruvil+Shah&userId=e0cd54e8f51c&source=post_page-e0cd54e8f51c----f93e7ac33358---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ff93e7ac33358&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-naive-bayes-approach-towards-creating-closed-domain-chatbots-f93e7ac33358&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ff93e7ac33358&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-naive-bayes-approach-towards-creating-closed-domain-chatbots-f93e7ac33358&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@agkdesign?utm_source=medium&utm_medium=referral", "anchor_text": "Alex Knight"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://github.com/jackfrost1411/naive_bayes_chatbot", "anchor_text": "this"}, {"url": "https://www.linkedin.com/in/dhruvilshah28/", "anchor_text": "here"}, {"url": "https://medium.com/tag/python?source=post_page-----f93e7ac33358---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/chatbots?source=post_page-----f93e7ac33358---------------chatbots-----------------", "anchor_text": "Chatbots"}, {"url": "https://medium.com/tag/data-science?source=post_page-----f93e7ac33358---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/naive-bayes?source=post_page-----f93e7ac33358---------------naive_bayes-----------------", "anchor_text": "Naive Bayes"}, {"url": "https://medium.com/tag/nlp?source=post_page-----f93e7ac33358---------------nlp-----------------", "anchor_text": "NLP"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Ff93e7ac33358&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-naive-bayes-approach-towards-creating-closed-domain-chatbots-f93e7ac33358&user=Dhruvil+Shah&userId=e0cd54e8f51c&source=-----f93e7ac33358---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Ff93e7ac33358&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-naive-bayes-approach-towards-creating-closed-domain-chatbots-f93e7ac33358&user=Dhruvil+Shah&userId=e0cd54e8f51c&source=-----f93e7ac33358---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ff93e7ac33358&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-naive-bayes-approach-towards-creating-closed-domain-chatbots-f93e7ac33358&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----f93e7ac33358--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Ff93e7ac33358&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-naive-bayes-approach-towards-creating-closed-domain-chatbots-f93e7ac33358&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----f93e7ac33358---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----f93e7ac33358--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----f93e7ac33358--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----f93e7ac33358--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----f93e7ac33358--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----f93e7ac33358--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----f93e7ac33358--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----f93e7ac33358--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----f93e7ac33358--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@dhruvilshah28?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@dhruvilshah28?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Dhruvil Shah"}, {"url": "https://medium.com/@dhruvilshah28/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "172 Followers"}, {"url": "http://LinkedIn.com/in/dhruvilshah28", "anchor_text": "LinkedIn.com/in/dhruvilshah28"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fe0cd54e8f51c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-naive-bayes-approach-towards-creating-closed-domain-chatbots-f93e7ac33358&user=Dhruvil+Shah&userId=e0cd54e8f51c&source=post_page-e0cd54e8f51c--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F2bf065f3ed8b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-naive-bayes-approach-towards-creating-closed-domain-chatbots-f93e7ac33358&newsletterV3=e0cd54e8f51c&newsletterV3Id=2bf065f3ed8b&user=Dhruvil+Shah&userId=e0cd54e8f51c&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}