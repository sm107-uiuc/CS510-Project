{"url": "https://towardsdatascience.com/image-recommendation-engine-leverage-transfert-learning-ec9af32f5239", "time": 1683000697.343756, "path": "towardsdatascience.com/image-recommendation-engine-leverage-transfert-learning-ec9af32f5239/", "webpage": {"metadata": {"title": "Image recommendation engine \u2014 leverage transfer learning | by Alexandre Wrg | Towards Data Science", "h1": "Image recommendation engine \u2014 leverage transfer learning", "description": "In this article, we will develop a recommendation system based on unstructured data that are images. In order to have a fast, operational model without the laborious work of fine-tuning a\u2026"}, "outgoing_paragraph_urls": [{"url": "https://en.wikipedia.org/wiki/Convolutional_neural_network", "anchor_text": "Convolutional neural network", "paragraph_index": 0}, {"url": "https://en.wikipedia.org/wiki/Transfer_learning", "anchor_text": "Transfer Learning", "paragraph_index": 0}, {"url": "https://en.wikipedia.org/wiki/Machine_learning", "anchor_text": "machine learning", "paragraph_index": 1}, {"url": "https://en.wikipedia.org/wiki/Transfer_learning#cite_note-1", "anchor_text": "[1]", "paragraph_index": 1}, {"url": "https://en.wikipedia.org/wiki/Computer_vision#Recognition", "anchor_text": "recognize", "paragraph_index": 1}, {"url": "https://keras.io/", "anchor_text": "Keras", "paragraph_index": 2}, {"url": "https://www.kaggle.com/paramaggarwal/fashion-product-images-classifier", "anchor_text": "here", "paragraph_index": 3}], "all_paragraphs": ["In this article, we will develop a recommendation system based on unstructured data that are images. In order to have a fast, operational model without the laborious work of fine-tuning a Convolutional neural network algorithm, we will use Transfer Learning.", "Transfer learning is a research problem in machine learning that focuses on storing knowledge gained while solving one problem and applying it to a different but related problem.[1] For example, knowledge gained while learning to recognize cars could apply when trying to recognize trucks", "To make it even easier we will use the high-level API Keras. Keras offers several pre-training models that have proven their worth in terms of generalization. Let\u2019s move on to modeling without further delay!", "I have some data about fashion product that I got here, I reduced the corpus to 2000 images due to computation times. Thus, as I said before, Keras offers several pre-training models that just need to be imported.", "Well, I imported my algorithms they\u2019re already training, what do I do now? There are a few preliminary steps, we will prepare our corpus of images and redesign the algorithm so that it will return high level features that has been determined through training.", "We have a list of png:", "First of all, we need to know what\u2019s the shape of the model\u2019s input and resize our images with this shape. Let\u2019s use VGG16 to do our preprocessing, it has the following structure.", "As we see the input shape in the input layer is (none, 224, 224, 3), we will extract the size and width requested in input from the model directly so that we do not have to look at the summary for each model.", "n.b : since the output of self.model.layers[0].output.shape[1] is tensorflow.python.framework.tensor_shape.Dimension object I\u2019ll eval it to get the integer instead. Then we load and resize the image as a PIL.Image.Image", "we can do this for every file and turn it to a matrix.", "preprocess_input subtracts the mean RGB channels of the data. This is because the model you are using has been trained on a different dataset: image.shape is still (1, 224, 224, 3) with stack and preprocess_input it turn to (n, 224, 224, 3) with n the number of input (i.e number of image).", "Now our input is ready to be fitted in the algorithm. We need to redesign our model by passing in a new Model the pretrained input and the second last layer at the output.", "with this model, we can use .predict method and got image features with as much feature as the second layer (4096 for vgg_model \u2018fc2 layer\u2019).", "Now we can calculate the cosine similarity between each image to obtain a dense matrix of (n*n) with png in the index and columns and then we can make one or more recommendations.", "let\u2019s generalize all this to test several models at once.", "We have defined a generic class that takes any pre-training model and adapts the corpus of images accordingly and proposes a recommendation in response to a given image, let\u2019s see the result.", "Pretty cool isn\u2019t it! We have very relevant recommendations although we used a corpus of only 2000 pictures.", "We have seen the advantages of using transfer learning. It would be more relevant to create our own convolution network in order to have a more accurate recommendation system it will be the subject of a next article, stay connected! Thanks.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data scientist at Auchan Retail Data"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fec9af32f5239&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimage-recommendation-engine-leverage-transfert-learning-ec9af32f5239&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimage-recommendation-engine-leverage-transfert-learning-ec9af32f5239&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimage-recommendation-engine-leverage-transfert-learning-ec9af32f5239&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimage-recommendation-engine-leverage-transfert-learning-ec9af32f5239&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----ec9af32f5239--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----ec9af32f5239--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@alexandrewrg?source=post_page-----ec9af32f5239--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@alexandrewrg?source=post_page-----ec9af32f5239--------------------------------", "anchor_text": "Alexandre Wrg"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fa5f80e627a47&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimage-recommendation-engine-leverage-transfert-learning-ec9af32f5239&user=Alexandre+Wrg&userId=a5f80e627a47&source=post_page-a5f80e627a47----ec9af32f5239---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fec9af32f5239&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimage-recommendation-engine-leverage-transfert-learning-ec9af32f5239&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fec9af32f5239&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimage-recommendation-engine-leverage-transfert-learning-ec9af32f5239&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://en.wikipedia.org/wiki/Convolutional_neural_network", "anchor_text": "Convolutional neural network"}, {"url": "https://en.wikipedia.org/wiki/Transfer_learning", "anchor_text": "Transfer Learning"}, {"url": "https://en.wikipedia.org/wiki/Machine_learning", "anchor_text": "machine learning"}, {"url": "https://en.wikipedia.org/wiki/Transfer_learning#cite_note-1", "anchor_text": "[1]"}, {"url": "https://en.wikipedia.org/wiki/Computer_vision#Recognition", "anchor_text": "recognize"}, {"url": "https://keras.io/", "anchor_text": "Keras"}, {"url": "https://www.kaggle.com/paramaggarwal/fashion-product-images-classifier", "anchor_text": "here"}, {"url": "https://github.com/AlexWarembourg/Medium/blob/master/product_recommendation.ipynb", "anchor_text": "https://github.com/AlexWarembourg/Medium/blob/master/"}, {"url": "https://228045d1dc1ea06f-dot-datalab-vm-us-west1.googleusercontent.com/files/product_recommendation.ipynb", "anchor_text": "product_recommendation.ipynb"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----ec9af32f5239---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----ec9af32f5239---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/recommendations?source=post_page-----ec9af32f5239---------------recommendations-----------------", "anchor_text": "Recommendations"}, {"url": "https://medium.com/tag/data-science?source=post_page-----ec9af32f5239---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/keras?source=post_page-----ec9af32f5239---------------keras-----------------", "anchor_text": "Keras"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fec9af32f5239&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimage-recommendation-engine-leverage-transfert-learning-ec9af32f5239&user=Alexandre+Wrg&userId=a5f80e627a47&source=-----ec9af32f5239---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fec9af32f5239&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimage-recommendation-engine-leverage-transfert-learning-ec9af32f5239&user=Alexandre+Wrg&userId=a5f80e627a47&source=-----ec9af32f5239---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fec9af32f5239&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimage-recommendation-engine-leverage-transfert-learning-ec9af32f5239&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----ec9af32f5239--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fec9af32f5239&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimage-recommendation-engine-leverage-transfert-learning-ec9af32f5239&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----ec9af32f5239---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----ec9af32f5239--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----ec9af32f5239--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----ec9af32f5239--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----ec9af32f5239--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----ec9af32f5239--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----ec9af32f5239--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----ec9af32f5239--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----ec9af32f5239--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@alexandrewrg?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@alexandrewrg?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Alexandre Wrg"}, {"url": "https://medium.com/@alexandrewrg/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "354 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fa5f80e627a47&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimage-recommendation-engine-leverage-transfert-learning-ec9af32f5239&user=Alexandre+Wrg&userId=a5f80e627a47&source=post_page-a5f80e627a47--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F7c3751d086ca&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimage-recommendation-engine-leverage-transfert-learning-ec9af32f5239&newsletterV3=a5f80e627a47&newsletterV3Id=7c3751d086ca&user=Alexandre+Wrg&userId=a5f80e627a47&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}