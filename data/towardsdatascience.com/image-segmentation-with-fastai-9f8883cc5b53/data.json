{"url": "https://towardsdatascience.com/image-segmentation-with-fastai-9f8883cc5b53", "time": 1682995347.6266, "path": "towardsdatascience.com/image-segmentation-with-fastai-9f8883cc5b53/", "webpage": {"metadata": {"title": "Image segmentation using fastai. Learn how to color code every pixel of\u2026 | by Dipam Vasani | Towards Data Science", "h1": "Image segmentation using fastai", "description": "Image segmentation is an application of computer vision wherein we color-code every pixel in an image. Each pixel then represents a particular object in that image. If you look at the images above\u2026"}, "outgoing_paragraph_urls": [{"url": "https://medium.com/@dipam44/learning-rate-and-golf-87c8d4697e31", "anchor_text": "learning rate", "paragraph_index": 20}, {"url": "https://www.kaggle.com/dipam7/image-segmentation-using-fastai", "anchor_text": "The full notebook can be found here.", "paragraph_index": 24}], "all_paragraphs": ["Image segmentation is an application of computer vision wherein we color-code every pixel in an image. Each pixel then represents a particular object in that image. If you look at the images above, every street is coded in violet, every building is orange, every tree is green and so on. Why do we do this and how is it different from object detection?", "Image segmentation is usually used when we care about edges and regions, when we want to separate important objects from the background. We want to know the specifics of an object and conduct further analysis on it from there on. Think about it in terms of a self driving car. A self driving car will not only want to identify a street, but also know it\u2019s edges or curves in order to make the correct turn.", "Image segmentation has a lot of significance in the field of medicine. Parts that need to be studied are color coded and viewed in scans taken from different angles. They are then used for things like automatic measurement of organs, cell counting, or simulations based on the extracted boundary information.", "We treat image segmentation as a classification problem, where for every pixel in the image, we try to predict what it is. Is it a bicycle, road line, sidewalk, or a building? In this way we produce a color coded image where every object has the same color.", "As usual we start by importing the fastai libraries.", "Let\u2019s first take a look at one of the images.", "Next, we take a look at what the image looks like after segmentation. Since the values in the labelled image are integers, we cannot use the same functions to open it. Instead, we use open_mask with show to display the image.", "Notice the function get_y_fn inside open_mask . In every segmentation problem, we are given 2 sets of images, original ones and labelled ones. We need to match the labelled images with the normal ones. We do this using the filenames. Let\u2019s take a look at the filenames of some of the images.", "We see that the filenames of the normal images and the labelled images are the same except, the corresponding labelled image has an _P towards the end. Hence we write a function which for every image, identifies its corresponding labelled counterpart.", "We also have a file called codes.txt that tells us what object the integers in our labelled image correspond to. Let\u2019s open the data for our labelled image.", "Now let\u2019s check the codes file for the meaning of these integers.", "The labelled data had a lot of 26s in it. Counting from index 0 in our codes file we see that the object referred by the integer 26 is a tree.", "Now that we\u2019ve understood our data, we can move on to creating a data bunch and training our model.", "We will not use the whole dataset, and we will also keep the batch size relatively small since classifying every pixel in every image is a resource intensive task.", "As usual we create our data bunch. Reading the above code:", "For training, we will use a CNN architecture called U-Net since they are good at recreating images.", "Before explaining what a U-Net is, notice the metrics used in the above code. What\u2019s acc_camvid ?", "The accuracy in an image segmentation problem is the same as that in any classification problem.", "However in this case, some pixels are labelled as Void (this label also exists in codes.txt) and shouldn\u2019t be considered when calculating the accuracy. Hence we make a new function for accuracy where we avoid those labels.", "The way a CNN works is it breaks down an image into smaller and smaller parts until is has just one thing to predict (left part of the U-Net architecture shown below). A U-Net then takes this and makes it bigger and bigger again and it does this for every stage of the CNN. However, constructing an image from a small vector is a difficult job. Hence we have connections from the original convolution layers to our deconvolution network.", "As always we find the learning rate and train our model. Even with half the data set, we get a pretty good accuracy of 92%.", "The ground truths are the actual targets and the predictions are what our model labelled.", "We can now train on the full data set.", "That will be it for this article. In this article we saw how to color code every pixel of an image using a U-net. U-nets are gaining popularity because they\u2019ve performed better than GANs on applications like generating high resolution images from blurry images. Hence it will be really useful to know what they are and how to use them.", "The full notebook can be found here.", "If you want to learn more about deep learning check out my series of articles on the same:", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F9f8883cc5b53&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimage-segmentation-with-fastai-9f8883cc5b53&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimage-segmentation-with-fastai-9f8883cc5b53&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimage-segmentation-with-fastai-9f8883cc5b53&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimage-segmentation-with-fastai-9f8883cc5b53&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----9f8883cc5b53--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----9f8883cc5b53--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://dipam44.medium.com/?source=post_page-----9f8883cc5b53--------------------------------", "anchor_text": ""}, {"url": "https://dipam44.medium.com/?source=post_page-----9f8883cc5b53--------------------------------", "anchor_text": "Dipam Vasani"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fdb5934347fa&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimage-segmentation-with-fastai-9f8883cc5b53&user=Dipam+Vasani&userId=db5934347fa&source=post_page-db5934347fa----9f8883cc5b53---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F9f8883cc5b53&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimage-segmentation-with-fastai-9f8883cc5b53&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F9f8883cc5b53&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimage-segmentation-with-fastai-9f8883cc5b53&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://medium.com/@dipam44/data-augmentations-in-fastai-84979bbcefaa", "anchor_text": "Apply transforms on the image"}, {"url": "https://medium.com/@dipam44/learning-rate-and-golf-87c8d4697e31", "anchor_text": "learning rate"}, {"url": "https://www.kaggle.com/dipam7/image-segmentation-using-fastai", "anchor_text": "The full notebook can be found here."}, {"url": "https://medium.com/@dipam44/deep-learning-series-30ad108fbe2b", "anchor_text": "Deep learning seriesA systematic list of all my articles on deep learningmedium.com"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----9f8883cc5b53---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----9f8883cc5b53---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/neural-networks?source=post_page-----9f8883cc5b53---------------neural_networks-----------------", "anchor_text": "Neural Networks"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----9f8883cc5b53---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/programming?source=post_page-----9f8883cc5b53---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F9f8883cc5b53&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimage-segmentation-with-fastai-9f8883cc5b53&user=Dipam+Vasani&userId=db5934347fa&source=-----9f8883cc5b53---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F9f8883cc5b53&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimage-segmentation-with-fastai-9f8883cc5b53&user=Dipam+Vasani&userId=db5934347fa&source=-----9f8883cc5b53---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F9f8883cc5b53&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimage-segmentation-with-fastai-9f8883cc5b53&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----9f8883cc5b53--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F9f8883cc5b53&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimage-segmentation-with-fastai-9f8883cc5b53&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----9f8883cc5b53---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----9f8883cc5b53--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----9f8883cc5b53--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----9f8883cc5b53--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----9f8883cc5b53--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----9f8883cc5b53--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----9f8883cc5b53--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----9f8883cc5b53--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----9f8883cc5b53--------------------------------", "anchor_text": ""}, {"url": "https://dipam44.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://dipam44.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Dipam Vasani"}, {"url": "https://dipam44.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "698 Followers"}, {"url": "https://github.com/dipam7/", "anchor_text": "https://github.com/dipam7/"}, {"url": "https://www.linkedin.com/in/dipam-vasani-734932104/", "anchor_text": "https://www.linkedin.com/in/dipam-vasani-734932104/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fdb5934347fa&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimage-segmentation-with-fastai-9f8883cc5b53&user=Dipam+Vasani&userId=db5934347fa&source=post_page-db5934347fa--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fe16e216bc3bf&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimage-segmentation-with-fastai-9f8883cc5b53&newsletterV3=db5934347fa&newsletterV3Id=e16e216bc3bf&user=Dipam+Vasani&userId=db5934347fa&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}