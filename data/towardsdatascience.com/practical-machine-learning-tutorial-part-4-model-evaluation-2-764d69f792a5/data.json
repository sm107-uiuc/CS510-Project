{"url": "https://towardsdatascience.com/practical-machine-learning-tutorial-part-4-model-evaluation-2-764d69f792a5", "time": 1683016989.967961, "path": "towardsdatascience.com/practical-machine-learning-tutorial-part-4-model-evaluation-2-764d69f792a5/", "webpage": {"metadata": {"title": "Practical Machine Learning Tutorial: Part.4 (Model Evaluation-2) | by Ryan A. Mardani | Towards Data Science", "h1": "Practical Machine Learning Tutorial: Part.4 (Model Evaluation-2)", "description": "In this part, we will elaborate on more model evaluation metrics specifically for multi-class classification problems. Learning curves will be discussed as a tool to come up with an idea of how to\u2026"}, "outgoing_paragraph_urls": [{"url": "https://towardsdatascience.com/practical-machine-learning-tutorial-part-1-data-exploratory-analysis-c13d39b8f33b", "anchor_text": "part1", "paragraph_index": 0}, {"url": "https://towardsdatascience.com/practical-machine-learning-tutorial-part-2-build-model-validate-c98c2ddad744", "anchor_text": "part2", "paragraph_index": 0}, {"url": "https://towardsdatascience.com/practical-machine-learning-tutorial-part-3-model-evaluation-1-5eefae18ec98", "anchor_text": "part3", "paragraph_index": 0}, {"url": "https://github.com/mardani72/Practical_ML_Tutorial_Facies_examp", "anchor_text": "here", "paragraph_index": 0}, {"url": "https://www.linkedin.com/in/amardani/", "anchor_text": "Ryan A. Mardani", "paragraph_index": 16}, {"url": "https://neptune.ai/blog", "anchor_text": "neptune.ai", "paragraph_index": 17}], "all_paragraphs": ["In this part, we will elaborate on more model evaluation metrics specifically for multi-class classification problems. Learning curves will be discussed as a tool to come up with an idea of how to trade-off between bias and variance in the model parameter selection. ROC curves for all classes in a specific model will be shown to see how false and true positive rate varies through the modeling process. Finally, we will select the best model and examine its performance on blind well data(data that was not involved in any of the processes up to now). This post is the fourth part(final) of part1, part2, part3. You can find the jupyter notebook file of this part here.", "Let\u2019s look at the schematic graph of the validation curve. As the model complexity increases, the training score increases as well but at some point, the validation(or test data) score starts to decrease. Increasing model complexity will lead to high variance or over-fitting. When the model is too simple, it can not capture all aspects of data mapping complexity leaving a high bias model. The best model is located between these two conditions, where it is complicated enough to have the highest validation score while not too complicated to capture every detail of training data.", "Let\u2019s create a function to plot the learning curve for our dataset. This function will generate 8 plots (each model algorithms) for test and training learning curve, samples vs fit time curve, and fit the time vs score curve. The function will receive these parameters: model estimator, the title for the chart, axes location for each model, ylim, cross-validation value, number of jobs that can be done in parallel, and train data size.", "If you refer to the code above, you may notice that this figure consists of two sets of rows of graphs. The first row in each set belongs to the learning curve of the first four models, then in the second row, fitting time is plotted as a function of training sample sizes and in the third row, the score is plotted as the function of fitting time. The second set of rows is the same as above but for different models.", "There are some important points to consider:1. For all algorithms, you may notice that training scores are always higher than tests or cross-validation scores(this is almost standard of ML).2. For logistic regression, SVM, and Naive Bays we see a specific pattern. The Traning data score decreases as examples increase in the training dataset and the validation score is very low(high bias) at the beginning and increases. This pattern can be found in more complex datasets very often.3. For the rest of the classifiers, we can see that the training score is still around the maximum, and validation could be increased with more new data samples. Comparing with the schematic chart above, we do not see the turning point for the validation curve in these plots meaning we are not in the area of over-fitting at the end of the training. We also can not claim that these classifiers(such as the random forest algorithm) have the highest performance because non of the validation curves did not flatten at the end of the training process.", "The plots in the second row show the times required by the models to train with various sizes of training datasets. The plots in the third row show how much time was required to train the models for each training size.", "Receiver Operating Characteristic (ROC) is a metric to evaluate classifier output quality. To calculate and plot:", "ROC curves typically consist of true positive rates on the y-axis and false positive rates on the x-axis. This means that the top left corner of the graph area is the ideal point as the true positive is maximum and the false positive is zero. As always not only we do not have a perfect dataset but also datasets are contaminated by some noise levels, which is not very realistic. However, it is always good to have a larger area under the curve(in the figure below, the first and last classes are the greatest). If we go back to the precision-recall report showed at the start of this post, we see that precision and recall(and f-score of course) for the first and last classes were the highest among others.", "ROC curves can be plotted for other model algorithms as well.", "This is the final step of this project. We will see how the constructed models can predict with real data that already have not been seen during the training and test process. We have kept well \u2018KIMZEY A\u2019 as blind well out of the process because it has all facies class. In this set of codes below, first defined X and y array data for blind well, then copied optimized model objects from the previous section and fit the models with all available data expect blind well data. Then predict blind labels and stored accuracy score.We defined a function to plot all prediction results juxtaposed by original true labels.", "The blind data model accuracy reveals that the best accuracy belongs to the extra tree classifier(ensemble in total). We see that although prediction accuracy for the training-test dataset is high for all models it decreases in blind well validation. We can conclude that the number of data samples and presumably amount of features are not high enough for models to capture all aspects of data complexity. In fact, more samples and more data features can help to improve model prediction accuracy.", "Classification report below for Extras Tree Classifier: Facies SS was failed in prediction while BS with 7 members could have been recognized by the extra tree model. Mudstone(MS) showed weak prediction results.", "Confusion matrix, Extras Tree Classifier: confusion matrix shows us the extra tree model capability to predict facies labels. We see that MS true labels are predicted as WS and PS by the model.", "Finally, the true facies labels(left track) is plotted as a criterion to compare with different model prediction results in the blind well. Visually, extras tree and random forest model prediction seem better than the rest of the models. One important point that we can see is that classifiers try to detect thin layers inside thick layers.", "As a final point, selecting the best model can be a subjective topic depending on your expectancy from a model. For example, if you are looking for a specific thin layer in geological succession, and a model could predict that layer very well while did poor prediction for other layers, we can employ that model, though we are aware that its evaluation metrics are not good enough altogether.", "To build a machine learning model the first step is to prepare the dataset. Data visualization, feature engineering, and extracting important features can be an important part of data preparation. Null values management is also a very crucial step specifically in the small datasets. We imputed missing data in this dataset using ML prediction to save more data. The second main important step is to build a model and validate it. Hyper-parameters are also important to be chosen carefully for efficient model performances. We employed a grid search to find out the optimized parameters. Finally, model evaluation is the most important task in ML model production. We mainly start with simple evaluation metrics and then narrow down to specific and more detailed metrics to understand our model\u2019s strengths and weaknesses.", "If you have a question, please reach out through my LinkedIn: Ryan A. Mardani", "More reading:I found the neptune.ai as a valuable resource to read and find some interesting articles.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F764d69f792a5&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpractical-machine-learning-tutorial-part-4-model-evaluation-2-764d69f792a5&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpractical-machine-learning-tutorial-part-4-model-evaluation-2-764d69f792a5&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpractical-machine-learning-tutorial-part-4-model-evaluation-2-764d69f792a5&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpractical-machine-learning-tutorial-part-4-model-evaluation-2-764d69f792a5&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----764d69f792a5--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----764d69f792a5--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@mardani.a?source=post_page-----764d69f792a5--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@mardani.a?source=post_page-----764d69f792a5--------------------------------", "anchor_text": "Ryan A. Mardani"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fb36223c810e6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpractical-machine-learning-tutorial-part-4-model-evaluation-2-764d69f792a5&user=Ryan+A.+Mardani&userId=b36223c810e6&source=post_page-b36223c810e6----764d69f792a5---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F764d69f792a5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpractical-machine-learning-tutorial-part-4-model-evaluation-2-764d69f792a5&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F764d69f792a5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpractical-machine-learning-tutorial-part-4-model-evaluation-2-764d69f792a5&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://towardsdatascience.com/practical-machine-learning-tutorial-part-1-data-exploratory-analysis-c13d39b8f33b", "anchor_text": "part1"}, {"url": "https://towardsdatascience.com/practical-machine-learning-tutorial-part-2-build-model-validate-c98c2ddad744", "anchor_text": "part2"}, {"url": "https://towardsdatascience.com/practical-machine-learning-tutorial-part-3-model-evaluation-1-5eefae18ec98", "anchor_text": "part3"}, {"url": "https://github.com/mardani72/Practical_ML_Tutorial_Facies_examp", "anchor_text": "here"}, {"url": "https://jakevdp.github.io/PythonDataScienceHandbook/06.00-figure-code.html#Validation-Curve", "anchor_text": "jakevdp.github.io"}, {"url": "https://www.linkedin.com/in/amardani/", "anchor_text": "Ryan A. Mardani"}, {"url": "https://neptune.ai/blog", "anchor_text": "neptune.ai"}, {"url": "https://jakevdp.github.io/PythonDataScienceHandbook/index.html", "anchor_text": "https://jakevdp.github.io/PythonDataScienceHandbook/index.html"}, {"url": "https://scikit-learn.org/stable/supervised_learning.html#supervised-learning", "anchor_text": "https://scikit-learn.org/stable"}, {"url": "https://machinelearningmastery.com/", "anchor_text": "https://machinelearningmastery.com"}, {"url": "https://github.com/brendonhall/facies_classification/blob/master/Facies%20Classification%20-%20SVM.ipynb", "anchor_text": "Brendon Hall"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----764d69f792a5---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/model-evaluation?source=post_page-----764d69f792a5---------------model_evaluation-----------------", "anchor_text": "Model Evaluation"}, {"url": "https://medium.com/tag/multiclass-classification?source=post_page-----764d69f792a5---------------multiclass_classification-----------------", "anchor_text": "Multiclass Classification"}, {"url": "https://medium.com/tag/geoscience?source=post_page-----764d69f792a5---------------geoscience-----------------", "anchor_text": "Geoscience"}, {"url": "https://medium.com/tag/python?source=post_page-----764d69f792a5---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F764d69f792a5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpractical-machine-learning-tutorial-part-4-model-evaluation-2-764d69f792a5&user=Ryan+A.+Mardani&userId=b36223c810e6&source=-----764d69f792a5---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F764d69f792a5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpractical-machine-learning-tutorial-part-4-model-evaluation-2-764d69f792a5&user=Ryan+A.+Mardani&userId=b36223c810e6&source=-----764d69f792a5---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F764d69f792a5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpractical-machine-learning-tutorial-part-4-model-evaluation-2-764d69f792a5&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----764d69f792a5--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F764d69f792a5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpractical-machine-learning-tutorial-part-4-model-evaluation-2-764d69f792a5&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----764d69f792a5---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----764d69f792a5--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----764d69f792a5--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----764d69f792a5--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----764d69f792a5--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----764d69f792a5--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----764d69f792a5--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----764d69f792a5--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----764d69f792a5--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@mardani.a?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@mardani.a?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Ryan A. Mardani"}, {"url": "https://medium.com/@mardani.a/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "388 Followers"}, {"url": "http://www.dataenergy.ca", "anchor_text": "www.dataenergy.ca"}, {"url": "http://linkedin.com/in/amardani", "anchor_text": "linkedin.com/in/amardani"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fb36223c810e6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpractical-machine-learning-tutorial-part-4-model-evaluation-2-764d69f792a5&user=Ryan+A.+Mardani&userId=b36223c810e6&source=post_page-b36223c810e6--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F7a39952b3ca1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpractical-machine-learning-tutorial-part-4-model-evaluation-2-764d69f792a5&newsletterV3=b36223c810e6&newsletterV3Id=7a39952b3ca1&user=Ryan+A.+Mardani&userId=b36223c810e6&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}