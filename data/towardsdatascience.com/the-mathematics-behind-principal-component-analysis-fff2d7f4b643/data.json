{"url": "https://towardsdatascience.com/the-mathematics-behind-principal-component-analysis-fff2d7f4b643", "time": 1682994312.086905, "path": "towardsdatascience.com/the-mathematics-behind-principal-component-analysis-fff2d7f4b643/", "webpage": {"metadata": {"title": "The Mathematics Behind Principal Component Analysis | by Akash Dubey | Towards Data Science", "h1": "The Mathematics Behind Principal Component Analysis", "description": "The central idea of principal component analysis (PCA) is to reduce the dimensionality of a data set consisting of a large number of interrelated variables while retaining as much as possible of the\u2026"}, "outgoing_paragraph_urls": [{"url": "https://study.com/academy/lesson/eigenvalues-eigenvectors-definition-equation-examples.html", "anchor_text": "link", "paragraph_index": 27}], "all_paragraphs": ["The central idea of principal component analysis (PCA) is to reduce the dimensionality of a data set consisting of a large number of interrelated variables while retaining as much as possible of the variation present in the data set. This is achieved by transforming to a new set of variables, the principal components (PCs), which are uncorrelated, and which are ordered so that the first few retain most of the variation present in all of the original variables.", "PCA can be thought of as an unsupervised learning problem. The whole process of obtaining principle components from a raw dataset can be simplified in six parts :", "So, let\u2019s unfurl the maths behind each of this one by one.", "Let\u2019s say we have a dataset which is d+1 dimensional. Where d could be thought as X_train and 1 could be thought as y_train (labels) in modern machine learning paradigm. So, X_train + y_train makes up our complete train dataset.", "So, after we drop the labels we are left with d dimensional dataset and this would be the dataset we will use to find the principal components. Also, let\u2019s assume we are left with a three-dimensional dataset after ignoring the labels i.e d = 3.", "we will assume that the samples stem from two different classes, where one-half samples of our dataset are labeled class 1 and the other half class 2.", "Let our data matrix X be the score of three students :", "2. Compute the mean of every dimension of the whole dataset.", "The data from the above table can be represented in matrix A, where each column in the matrix shows scores on a test and each row shows the score of a student.", "So, The mean of matrix A would be", "3. Compute the covariance matrix of the whole dataset ( sometimes also called as the variance-covariance matrix)", "So, we can compute the covariance of two variables X and Y using the following formula :", "Using the above formula, we can find the covariance matrix of A. Also, the result would be a square matrix of d \u00d7d dimensions.", "Let\u2019s rewrite our original matrix like this", "Few points that can be noted here is :", "a) The covariance between math and English is positive (360), and the covariance between math and art is positive (180). This means the scores tend to covary in a positive way. As scores on math go up, scores on art and English also tend to go up; and vice versa.", "b) The covariance between English and art, however, is zero. This means there tends to be no predictable relationship between the movement of English and art scores.", "4. Compute Eigenvectors and corresponding Eigenvalues", "Intuitively, an eigenvector is a vector whose direction remains unchanged when a linear transformation is applied to it.", "Now, we can easily compute eigenvalue and eigenvectors from the covariance matrix that we have above.", "Let A be a square matrix, \u03bd a vector and \u03bb a scalar that satisfies A\u03bd = \u03bb\u03bd, then \u03bb is called eigenvalue associated with eigenvector \u03bd of A.", "The eigenvalues of A are roots of the characteristic equation", "Calculating det(A-\u03bbI) first, I is an identity matrix :", "Simplifying the matrix first, we can calculate the determinant later,", "Now that we have our simplified matrix, we can find the determinant of the same :", "We now have the equation and we need to solve for \u03bb, so as to get the eigenvalue of the matrix. So, equating the above equation to zero :", "After solving this equation for the value of \u03bb, we get the following value", "Now, we can calculate the eigenvectors corresponding to the above eigenvalues. I would not show how to calculate eigenvector here, visit this link to understand how to calculate eigenvectors.", "So, after solving for eigenvectors we would get the following solution for the corresponding eigenvalues", "5. Sort the eigenvectors by decreasing eigenvalues and choose k eigenvectors with the largest eigenvalues to form a d \u00d7 k dimensional matrix W.", "We started with the goal to reduce the dimensionality of our feature space, i.e., projecting the feature space via PCA onto a smaller subspace, where the eigenvectors will form the axes of this new feature subspace. However, the eigenvectors only define the directions of the new axis, since they have all the same unit length 1.", "So, in order to decide which eigenvector(s) we want to drop for our lower-dimensional subspace, we have to take a look at the corresponding eigenvalues of the eigenvectors. Roughly speaking, the eigenvectors with the lowest eigenvalues bear the least information about the distribution of the data, and those are the ones we want to drop.", "The common approach is to rank the eigenvectors from highest to lowest corresponding eigenvalue and choose the top k eigenvectors.", "So, after sorting the eigenvalues in decreasing order, we have", "For our simple example, where we are reducing a 3-dimensional feature space to a 2-dimensional feature subspace, we are combining the two eigenvectors with the highest eigenvalues to construct our d\u00d7k dimensional eigenvector matrix W.", "So, eigenvectors corresponding to two maximum eigenvalues are :", "6. Transform the samples onto the new subspace", "In the last step, we use the 3x2 dimensional matrix W that we just computed to transform our samples onto the new subspace via the equation y = W\u2032 \u00d7 x where W\u2032 is the transpose of the matrix W.", "So lastly, we have computed our two principal components and projected the data points onto the new subspace.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Senior Data Scientist \u2014 Search & Relevancy @ Lowes"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Ffff2d7f4b643&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-mathematics-behind-principal-component-analysis-fff2d7f4b643&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-mathematics-behind-principal-component-analysis-fff2d7f4b643&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-mathematics-behind-principal-component-analysis-fff2d7f4b643&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-mathematics-behind-principal-component-analysis-fff2d7f4b643&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----fff2d7f4b643--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----fff2d7f4b643--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@akashkdubey?source=post_page-----fff2d7f4b643--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@akashkdubey?source=post_page-----fff2d7f4b643--------------------------------", "anchor_text": "Akash Dubey"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F5c0cf2ef9af&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-mathematics-behind-principal-component-analysis-fff2d7f4b643&user=Akash+Dubey&userId=5c0cf2ef9af&source=post_page-5c0cf2ef9af----fff2d7f4b643---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ffff2d7f4b643&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-mathematics-behind-principal-component-analysis-fff2d7f4b643&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ffff2d7f4b643&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-mathematics-behind-principal-component-analysis-fff2d7f4b643&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@mangofantasy?utm_source=medium&utm_medium=referral", "anchor_text": "Tim Johnson"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://getcalc.com/statistics-covariance-calculator.htm", "anchor_text": "https://getcalc.com/statistics-covariance-calculator.htm"}, {"url": "https://study.com/academy/lesson/eigenvalues-eigenvectors-definition-equation-examples.html", "anchor_text": "link"}, {"url": "http://sebastianraschka.com/Articles/2014_pca_step_by_step.html", "anchor_text": "Sebastian Raschka Blog"}, {"url": "https://stattrek.com/matrix-algebra/covariance-matrix.aspx", "anchor_text": "Stattrek Matrix Algebra"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----fff2d7f4b643---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----fff2d7f4b643---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----fff2d7f4b643---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/dimensionality-reduction?source=post_page-----fff2d7f4b643---------------dimensionality_reduction-----------------", "anchor_text": "Dimensionality Reduction"}, {"url": "https://medium.com/tag/mathematics?source=post_page-----fff2d7f4b643---------------mathematics-----------------", "anchor_text": "Mathematics"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Ffff2d7f4b643&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-mathematics-behind-principal-component-analysis-fff2d7f4b643&user=Akash+Dubey&userId=5c0cf2ef9af&source=-----fff2d7f4b643---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Ffff2d7f4b643&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-mathematics-behind-principal-component-analysis-fff2d7f4b643&user=Akash+Dubey&userId=5c0cf2ef9af&source=-----fff2d7f4b643---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ffff2d7f4b643&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-mathematics-behind-principal-component-analysis-fff2d7f4b643&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----fff2d7f4b643--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Ffff2d7f4b643&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-mathematics-behind-principal-component-analysis-fff2d7f4b643&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----fff2d7f4b643---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----fff2d7f4b643--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----fff2d7f4b643--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----fff2d7f4b643--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----fff2d7f4b643--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----fff2d7f4b643--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----fff2d7f4b643--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----fff2d7f4b643--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----fff2d7f4b643--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@akashkdubey?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@akashkdubey?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Akash Dubey"}, {"url": "https://medium.com/@akashkdubey/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "581 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F5c0cf2ef9af&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-mathematics-behind-principal-component-analysis-fff2d7f4b643&user=Akash+Dubey&userId=5c0cf2ef9af&source=post_page-5c0cf2ef9af--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F71a5cfd3040b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-mathematics-behind-principal-component-analysis-fff2d7f4b643&newsletterV3=5c0cf2ef9af&newsletterV3Id=71a5cfd3040b&user=Akash+Dubey&userId=5c0cf2ef9af&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}