{"url": "https://towardsdatascience.com/spamilton-text-generation-with-lstms-and-hamilton-lyrics-ec7938ae830c", "time": 1683011050.467804, "path": "towardsdatascience.com/spamilton-text-generation-with-lstms-and-hamilton-lyrics-ec7938ae830c/", "webpage": {"metadata": {"title": "Spamilton: Text Generation with LSTMs and Hamilton Lyrics | by Drew Perkins | Towards Data Science", "h1": "Spamilton: Text Generation with LSTMs and Hamilton Lyrics", "description": "Text generation is a bridge between computational linguistics and AI that automatically generates natural language text. In deep learning, RNNs have proven to work extremely well with sequential data\u2026"}, "outgoing_paragraph_urls": [{"url": "https://github.com/perkdrew/text-generation", "anchor_text": "GitHub", "paragraph_index": 0}], "all_paragraphs": ["Text generation is a bridge between computational linguistics and AI that automatically generates natural language text. In deep learning, RNNs have proven to work extremely well with sequential data such as text. In this case example, I will demonstrate applying LSTMs with word embeddings to generate Hamilton lyrics. Many of the ideas came from Karpathy\u00b9 and Bansal\u00b2. All of the code can be found on my GitHub.", "Let\u2019s import the required libraries from Tensorflow and Keras:", "Now we provide a path to the word embeddings:", "The lyrics were scraped from the internet and placed in a plain text file:", "The corpus was lowercased and tokenized. The input sequences were created using the list of tokens and padded to match the max sequence length:", "We then separate our input sequences into predictors and labels for our learning algorithm. This is treated as a categorical task with the number of classes reflecting the total words that the tokenizer recognized:", "We need to open our word embedding file so that can be properly accessed in our embedding layer. The embedding index is a precursory step for the embedding matrix. GLoVe embeddings are applied here:", "The embedding matrix is what we will actually feed into our network:", "Now that the data and word embeddings are prepared, we can start setting up the layers of our RNN. We start by adding our embedding layer followed by the bidirectional LSTM with 256 units and an LSTM with 128 units:", "We follow with a dropout layer to remove disposable neurons and prevent overfitting without diminishing the performance of our task; recurrent dropout \u201cdrops\u201d the connections between recurrent units whereas regular dropout \u201cdrops\u201d the connections to the general inputs/outputs. The final dense layer with softmax activation closes out the model. We call an early stopping if the loss function begins to inflate. As the runtime can be quite long, epochs are set moderately low:", "Finally, a helper function was added to display the generated text:", "The function takes the seed text, the number of following words, and the max sequence length as arguments. The seed text is the text we use as the basis for our learning algorithm to project its predictions and we choose the number of words we want to follow the text.", "We run our pipeline and print our results:", "With several lines of text generated, we can expect results such as this:", "With more text preprocessing, feature engineering, and robust modeling, we can expect to mitigate the grammar and syntax errors above. The LSTMs can be switched out with GRUs for faster runtimes at the expense of lower precision in longer text sequences. Text generation with character embeddings or VAEs could be worth exploring as well. As Aaron Burr would note, the world is wide enough for different modeling approaches.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Machine Learning Engineer | Optimistic Nihilist"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fec7938ae830c&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fspamilton-text-generation-with-lstms-and-hamilton-lyrics-ec7938ae830c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fspamilton-text-generation-with-lstms-and-hamilton-lyrics-ec7938ae830c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fspamilton-text-generation-with-lstms-and-hamilton-lyrics-ec7938ae830c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fspamilton-text-generation-with-lstms-and-hamilton-lyrics-ec7938ae830c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----ec7938ae830c--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----ec7938ae830c--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@drewperk?source=post_page-----ec7938ae830c--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@drewperk?source=post_page-----ec7938ae830c--------------------------------", "anchor_text": "Drew Perkins"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fe67c23662228&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fspamilton-text-generation-with-lstms-and-hamilton-lyrics-ec7938ae830c&user=Drew+Perkins&userId=e67c23662228&source=post_page-e67c23662228----ec7938ae830c---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fec7938ae830c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fspamilton-text-generation-with-lstms-and-hamilton-lyrics-ec7938ae830c&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fec7938ae830c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fspamilton-text-generation-with-lstms-and-hamilton-lyrics-ec7938ae830c&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@sdoy1995?utm_source=medium&utm_medium=referral", "anchor_text": "Sudan Ouyang"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://github.com/perkdrew/text-generation", "anchor_text": "GitHub"}, {"url": "http://karpathy.github.io/2015/05/21/rnn-effectiveness/", "anchor_text": "http://karpathy.github.io/2015/05/21/rnn-effectiveness/"}, {"url": "https://mc.ai/language-modelling-text-generation-using-lstms-deep-learning-for-nlp/?fbclid=IwAR2mR7QkpnwzCzszwN1mOXUWHBhIGOtfvxGA4AapS52RJZW6wSpKhckI1HY", "anchor_text": "https://mc.ai/language-modelling-text-generation-using-lstms-deep-learning-for-nlp/?fbclid=IwAR2mR7QkpnwzCzszwN1mOXUWHBhIGOtfvxGA4AapS52RJZW6wSpKhckI1HY"}, {"url": "https://medium.com/tag/hamilton?source=post_page-----ec7938ae830c---------------hamilton-----------------", "anchor_text": "Hamilton"}, {"url": "https://medium.com/tag/nlp?source=post_page-----ec7938ae830c---------------nlp-----------------", "anchor_text": "NLP"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----ec7938ae830c---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/ai?source=post_page-----ec7938ae830c---------------ai-----------------", "anchor_text": "AI"}, {"url": "https://medium.com/tag/tensorflow?source=post_page-----ec7938ae830c---------------tensorflow-----------------", "anchor_text": "TensorFlow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fec7938ae830c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fspamilton-text-generation-with-lstms-and-hamilton-lyrics-ec7938ae830c&user=Drew+Perkins&userId=e67c23662228&source=-----ec7938ae830c---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fec7938ae830c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fspamilton-text-generation-with-lstms-and-hamilton-lyrics-ec7938ae830c&user=Drew+Perkins&userId=e67c23662228&source=-----ec7938ae830c---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fec7938ae830c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fspamilton-text-generation-with-lstms-and-hamilton-lyrics-ec7938ae830c&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----ec7938ae830c--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fec7938ae830c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fspamilton-text-generation-with-lstms-and-hamilton-lyrics-ec7938ae830c&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----ec7938ae830c---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----ec7938ae830c--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----ec7938ae830c--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----ec7938ae830c--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----ec7938ae830c--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----ec7938ae830c--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----ec7938ae830c--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----ec7938ae830c--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----ec7938ae830c--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@drewperk?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@drewperk?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Drew Perkins"}, {"url": "https://medium.com/@drewperk/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "14 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fe67c23662228&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fspamilton-text-generation-with-lstms-and-hamilton-lyrics-ec7938ae830c&user=Drew+Perkins&userId=e67c23662228&source=post_page-e67c23662228--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F886f3f4b9083&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fspamilton-text-generation-with-lstms-and-hamilton-lyrics-ec7938ae830c&newsletterV3=e67c23662228&newsletterV3Id=886f3f4b9083&user=Drew+Perkins&userId=e67c23662228&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}