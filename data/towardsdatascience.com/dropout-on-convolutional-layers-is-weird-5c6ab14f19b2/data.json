{"url": "https://towardsdatascience.com/dropout-on-convolutional-layers-is-weird-5c6ab14f19b2", "time": 1682994948.378978, "path": "towardsdatascience.com/dropout-on-convolutional-layers-is-weird-5c6ab14f19b2/", "webpage": {"metadata": {"title": "Dropout on convolutional layers is weird | by Jacob Reinhold | Towards Data Science", "h1": "Dropout on convolutional layers is weird", "description": "Dropout is commonly used to regularize deep neural networks; however, applying dropout on fully-connected layers and applying dropout on convolutional layers are fundamentally different operations\u2026"}, "outgoing_paragraph_urls": [{"url": "http://jmlr.org/papers/volume15/srivastava14a.old/srivastava14a.pdf", "anchor_text": "Dropout", "paragraph_index": 0}, {"url": "https://www.cv-foundation.org/openaccess/content_cvpr_2015/papers/Tompson_Efficient_Object_Localization_2015_CVPR_paper.pdf", "anchor_text": "limited benefits", "paragraph_index": 0}, {"url": "https://papers.nips.cc/paper/8271-dropblock-a-regularization-method-for-convolutional-networks.pdf", "anchor_text": "when applied to convolutional layers", "paragraph_index": 0}, {"url": "http://jmlr.org/papers/volume15/srivastava14a.old/srivastava14a.pdf", "anchor_text": "Dropout paper", "paragraph_index": 7}, {"url": "https://arxiv.org/pdf/1511.02680.pdf", "anchor_text": "these", "paragraph_index": 25}, {"url": "https://arxiv.org/abs/1506.02158", "anchor_text": "papers", "paragraph_index": 25}, {"url": "http://proceedings.mlr.press/v80/mianjy18b/mianjy18b.pdf", "anchor_text": "have been shown", "paragraph_index": 27}, {"url": "http://jcreinhold.com", "anchor_text": "jcreinhold.com", "paragraph_index": 29}], "all_paragraphs": ["Dropout is commonly used to regularize deep neural networks; however, applying dropout on fully-connected layers and applying dropout on convolutional layers are fundamentally different operations. While it is known in the deep learning community that dropout has limited benefits when applied to convolutional layers, I wanted to show a simple mathematical example of why the two are different. To do so, I\u2019ll define how dropout operates on fully-connected layers, define how dropout operates on convolutional layers and contrast the two operations.", "An n-layer fully-connected neural network (ignoring bias) can be defined as:", "Consider a single hidden-layer fully-connected neural network f(x): \u211d\u2079 \u2192 \u211d\u2079 with no non-linearity or bias. We can express the network as:", "Below is a diagram of our single hidden-layer neural network.", "Let\u2019s add dropout to this network. Let r \u2208 {0,1}\u2079 be a vector of independent and identically distributed (iid) Bernoulli random variables. Dropout, in our previously defined neural network, can then be expressed as:", "where V\u1d40x has been collapsed to h for space.", "To see how this is equivalent to dropout, consider the specific case where r = (1, 0, 0, \u2026 , 0)\u1d40. The resultant network is:", "which is what was discussed in the original Dropout paper.", "We see that dropout in fully-connected neural networks is equivalent to zeroing-out a column from the weight matrix associated with a fully-connected layer. This operation corresponds to \u201cdropping\u201d a neuron in the neural network. Dropping a neuron in this way is reasonable because \u2014 qualitatively \u2014 it promotes redundancy in the weight matrix, i.e., sub-networks can robustly perform the desired operation.", "An n-layer convolutional neural network (ignoring bias) can be defined as:", "where \u2217 is the convolution operator, \u03d5\u1d62 is a non-linearity, K\u1d62 for i \u2208{1, \u2026 , n} are convolutional kernels and x is the input.", "To get our bearings, let\u2019s first examine the convolutional operation. We can rewrite a discrete convolution as a matrix multiplication. Let\u2019s consider convolving x \u2208 \u211d\u00b3 \u02e3 \u00b3 with K \u2208 \u211d\u00b2 \u02e3 \u00b2. Then K \u2217 x is defined as:", "which is, up to a reshape operation, equivalent to:", "Now that we have established that convolution can be applied as a matrix multiplication, let\u2019s formulate a convolutional network in approximately the same way as we formulated a fully-connected network.", "Let g(x): \u211d\u00b3 \u02e3 \u00b3 \u2192 \u211d\u00b3 \u02e3 \u00b3 be a fully-convolutional neural network with no non-linearity or bias. In the spirit of our previous network, we define g as:", "where u, v \u2208 \u211d\u00b3 \u02e3 \u00b3 are the convolutional kernels and x \u2208 \u211d\u00b3 \u02e3 \u00b3 is an image.", "For simplicity, and because it doesn\u2019t affect our analysis, let h = v \u2217 x. Note that for the transformation g to be valid, we will need to use zero-padding at each convolutional layer. This can be incorporated into the matrix form of the convolutional kernel, and so our network can be written as:", "The proof of which is left as an exercise to the reader.", "As before in our fully-connected network, let\u2019s add dropout to our convolutional network.", "Let U be defined as the matrix in the previous equation (i.e., the expanded convolutional kernel with zero-padding) and let r \u2208 {0,1}\u2079 iid Bernoulli random variables, as before. Then we have:", "To show that this application of dropout is not equivalent to the fully-connected case, it is sufficient to focus on the top-left 3 \u00d7 3 block of the previously shown matrix:", "Notice that the weights u\u2084, u\u2085, u\u2086 are each found at least twice across the three columns in this cutout. Thus if r\u2081 = 0 and r\u2082=1 or r\u2081 = 1 and r\u2082=0, we will still be updating the weights u\u2085 and u\u2084 (regardless of the value of r\u2083!).", "In our analysis of dropout in fully-connected networks, we showed that the dropout operation could be understood as zeroing out columns of a weight matrix in the neural network. This operation corresponded to not training, or \u201cdropping out,\u201d a neuron.", "In the above analysis, we have shown that dropout on convolutional layers does not produce the same effect. This is demonstrated by the fact that zeroing out a column of the weight matrix corresponding to the convolutional kernel still allows the weights in that column to be trained.", "Since dropout is usually used to not train subsets of neurons randomly during training and dropout on convolutional layers does not do this operation, the name is misleading and \u2014 since the effect is not obviously interpretable \u2014 weird.", "I am not saying that dropout on convolutional layers has no utility. In these papers, the authors get better results when using dropout on convolutional layers. However, the effect of dropout on convolutional layers seems to amount to multiplying Bernoulli noise into the feature maps of the network. My point is that choosing this type of way to inject noise into the system seems odd without more underlying theory; theory which is present in the case of fully-connected layers.", "So if you try adding dropout after a convolutional layer and get bad results, don\u2019t be dismayed! There doesn\u2019t appear that there is a good reason it should provide good results.", "Dropout applied on fully-connected single-hidden layer neural networks have been shown to correspond to an interpretable regularizer, one that equalizes the weight matrices. However, the derivations of these results make heavy use of the fact that the weights of each entry of the matrix are independent of one another; a fact that does not hold in convolutional layers. I don\u2019t immediately see how to reconcile this fact with convolutional layers, so I don\u2019t see how dropout can provide a similar, interpretable regularization.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "machine learning | medical image analysis | jcreinhold.com | @JacobCReinhold"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F5c6ab14f19b2&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdropout-on-convolutional-layers-is-weird-5c6ab14f19b2&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdropout-on-convolutional-layers-is-weird-5c6ab14f19b2&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdropout-on-convolutional-layers-is-weird-5c6ab14f19b2&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdropout-on-convolutional-layers-is-weird-5c6ab14f19b2&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----5c6ab14f19b2--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----5c6ab14f19b2--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@jcreinhold?source=post_page-----5c6ab14f19b2--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@jcreinhold?source=post_page-----5c6ab14f19b2--------------------------------", "anchor_text": "Jacob Reinhold"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fd6cf1d0b0aa7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdropout-on-convolutional-layers-is-weird-5c6ab14f19b2&user=Jacob+Reinhold&userId=d6cf1d0b0aa7&source=post_page-d6cf1d0b0aa7----5c6ab14f19b2---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F5c6ab14f19b2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdropout-on-convolutional-layers-is-weird-5c6ab14f19b2&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F5c6ab14f19b2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdropout-on-convolutional-layers-is-weird-5c6ab14f19b2&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "http://jmlr.org/papers/volume15/srivastava14a.old/srivastava14a.pdf", "anchor_text": "Dropout"}, {"url": "https://www.cv-foundation.org/openaccess/content_cvpr_2015/papers/Tompson_Efficient_Object_Localization_2015_CVPR_paper.pdf", "anchor_text": "limited benefits"}, {"url": "https://papers.nips.cc/paper/8271-dropblock-a-regularization-method-for-convolutional-networks.pdf", "anchor_text": "when applied to convolutional layers"}, {"url": "http://jmlr.org/papers/volume15/srivastava14a.old/srivastava14a.pdf", "anchor_text": "Dropout paper"}, {"url": "https://arxiv.org/pdf/1511.02680.pdf", "anchor_text": "these"}, {"url": "https://arxiv.org/abs/1506.02158", "anchor_text": "papers"}, {"url": "http://proceedings.mlr.press/v80/mianjy18b/mianjy18b.pdf", "anchor_text": "have been shown"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----5c6ab14f19b2---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----5c6ab14f19b2---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/dropout?source=post_page-----5c6ab14f19b2---------------dropout-----------------", "anchor_text": "Dropout"}, {"url": "https://medium.com/tag/convolutional-neural-net?source=post_page-----5c6ab14f19b2---------------convolutional_neural_net-----------------", "anchor_text": "Convolutional Neural Net"}, {"url": "https://medium.com/tag/mathematics?source=post_page-----5c6ab14f19b2---------------mathematics-----------------", "anchor_text": "Mathematics"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F5c6ab14f19b2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdropout-on-convolutional-layers-is-weird-5c6ab14f19b2&user=Jacob+Reinhold&userId=d6cf1d0b0aa7&source=-----5c6ab14f19b2---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F5c6ab14f19b2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdropout-on-convolutional-layers-is-weird-5c6ab14f19b2&user=Jacob+Reinhold&userId=d6cf1d0b0aa7&source=-----5c6ab14f19b2---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F5c6ab14f19b2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdropout-on-convolutional-layers-is-weird-5c6ab14f19b2&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----5c6ab14f19b2--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F5c6ab14f19b2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdropout-on-convolutional-layers-is-weird-5c6ab14f19b2&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----5c6ab14f19b2---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----5c6ab14f19b2--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----5c6ab14f19b2--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----5c6ab14f19b2--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----5c6ab14f19b2--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----5c6ab14f19b2--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----5c6ab14f19b2--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----5c6ab14f19b2--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----5c6ab14f19b2--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@jcreinhold?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@jcreinhold?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Jacob Reinhold"}, {"url": "https://medium.com/@jcreinhold/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "218 Followers"}, {"url": "http://jcreinhold.com", "anchor_text": "jcreinhold.com"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fd6cf1d0b0aa7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdropout-on-convolutional-layers-is-weird-5c6ab14f19b2&user=Jacob+Reinhold&userId=d6cf1d0b0aa7&source=post_page-d6cf1d0b0aa7--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F8c3f698931d6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdropout-on-convolutional-layers-is-weird-5c6ab14f19b2&newsletterV3=d6cf1d0b0aa7&newsletterV3Id=8c3f698931d6&user=Jacob+Reinhold&userId=d6cf1d0b0aa7&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}