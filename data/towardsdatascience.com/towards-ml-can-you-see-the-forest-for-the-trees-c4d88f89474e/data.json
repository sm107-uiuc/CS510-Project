{"url": "https://towardsdatascience.com/towards-ml-can-you-see-the-forest-for-the-trees-c4d88f89474e", "time": 1683016793.3804128, "path": "towardsdatascience.com/towards-ml-can-you-see-the-forest-for-the-trees-c4d88f89474e/", "webpage": {"metadata": {"title": "Towards ML \u2014 Can you see the Forest for the Trees? | Medium | Towards Data Science", "h1": "Towards Machine Learning \u2014 Can you see the Forest for the Trees?", "description": "A simple map, to help you not get lost in the Random Forest of Decision Trees"}, "outgoing_paragraph_urls": [{"url": "https://www.kaggle.com/uciml/iris", "anchor_text": "Kaggle", "paragraph_index": 16}, {"url": "https://github.com/emilylauyw/Udacity_DAND_CaseStudy2-Analyze_Fuel_Economy_Data", "anchor_text": "Udacity", "paragraph_index": 16}, {"url": "https://www.linkedin.com/mwlite/in/karlo-leskovar-a8612b105", "anchor_text": "LinkedIn", "paragraph_index": 37}, {"url": "https://medium.com/@Karlo_Leskovar", "anchor_text": "Medium", "paragraph_index": 39}], "all_paragraphs": ["Last time we have covered some of the most important evaluation techniques for Machine Learning model. We could easily say that when someone blindly uses only accuracy as measurements, he really \u201ccan\u2019t see the Forest for the Trees\u201d. :) Joking aside, we saw that when the data is imbalanced, just accuracy is often not enough to properly evaluate the model.", "As the title suggests, we are continuing our journey covering popular Machine Learning techniques. On todays topic, we have Decision Trees and Random Forests. As the later is an advanced version, or rather, a combination of multiple Decision Trees, I\u2019ve decided to cover this two algorithms together.", "With the article I will try to explain Decision Trees and Random Forest classifiers on a beginner level. Also, some interesting examples on real data are provided. After reading this, I hope you will be ready to deploy your own classifier.", "Let\u2019s start with the definition of a Decision Tree. When we think of a Decision Tree, the best is to think of a real tree, where nodes represent questions the model asks regarding the object or value we want to classify. In other words, based on the features of the data (either being continuous integers or floats, or being classes or labels), the model creates rules, which are used to correctly classify each object from the dataset. In this example I will present a simple Decision Tree used to classify precipitation according to its type. Each node has two outcomes (branches), for example the precipitation is either SOLID or LIQUID or is the precipitation is either FALLING from clouds or formed at GROUND LEVEL.", "Decision Trees have some important characteristics, root, depth, node, leaf, splits(branches) etc.", "Depth: the number of splits before we get a result, in our case, 3", "Decision Node: each \u201crectangular\u201d on the image that is being splitted", "Leaf: each \u201crectangular\u201d that is NOT being splitted (the ones in the last line)", "Splits: the \u201cquestions\u201d we ask to get a smaller portion of the data, i.e liquid or solid", "Decision Trees can be used for regression also, often called Decision Tree Regressors. The difference to a classifier tree is only in the outcome, where the classifier predicts a class or label, the regressor predicts a continuous value, a number, i.e. how much rain will fall on 26th of November.", "We get the point of a Tree now, but, can there be a Forest of Trees? Surely, it can! A Random Forest is an ensemble of many Decision Trees. Every Tree for it gets train only on a RANDOM part (subset) of the features, and a RANDOM part (subset) of the training data. By such, each Tree tends to overfit to training data, but as an ensemble, the result gets averaged (or majority vote) for several dozens of Trees, hence, we get a result, spared of overfitting. Let\u2019s see how would the our Precipitation Classifier look like, if we create it as a Random Forest.", "So in this example three Trees are presented, each with a depth of 2. Now, let\u2019s say, the first and last predict that the resulting precipitation is \u201cHoar\u201d, while the second predicts \u201cMist\u201d. The \u201cMajority Voting\u201d would result in the final predication as \u201dHoar\u201d. As denoted on the image, we can have N-number of individual Trees. It is important to note, that each individual Tree, would use different features (\u201cquestions\u201d). In cases of Classifiers the majority vote is used, while in cases of Regression, the averaging.", "In Machine Learning, the process of combining multiple individual models (in this case Decision Trees) is referred as \u201cEnsemble Learning\u201d.", "In the next few sections, we will implement Scikit-learn Decision Tree and Random Forest classifiers on two popular datasets.", "Before we load our datasets, first we import the dependencies.", "Decision Tree classifier class is loaded from the tree module, while Random Forest class from the ensemble module of Scikit-learn. Additionally, we imported train_test_split to split our data into training and test sets, confusion_matrix to evaluate the results, tree to visualize a Decision Tree and preprocessing in order to use the Label Encoder to convert descriptive features (non-numerical) to numerical labels.", "Afterwards we can import the data. This time we use the iris dataset from Kaggle and fuel economy dataset from Udacity. Our goal is to predict flower species (Class) of the Iris flowers and vehicle class (VClass) for the cars.", "A sneak peak into the data.", "As we plan to use transmission type and drive type as predictors, e need to apply the Label Encoder to the cars dataset, to convert descriptive (non-numerical) features, to integers.", "In the flower dataset, all the features are numerical and similar order of magnitude, so no preprocessing was applied. If the order of magnitude of the features widely differ or outliers are present, normalization is highly advisable.", "As last step before creating the model, we split the data into training and test datasets.", "When creating the Decision Tree classifier several parameters can be chosen. Some of them were already mentioned when we\u2019ve described the Tree model. Scikit-learn allows us to select the max_depth of the tree, criterion, random_state, max_leaf_nodes, max_features etc. With this dataset i went with the default settings, since it gave a satisfactory result.", "Next, we create a Random Forest classifier for the Iris dataset. Here, Scikit-learn gave the option to change the overall number of Decision Trees in the ensemble (n_estimator), criterion, max_depth (of the trees), max_features etc, all in all, similar parameters as when creating a single Decision Tree. Again, the default settings were chosen due to good results.", "With both classifiers, identical results were obtained. Only one sample of Iris-Versicolor was misclassified as Iris-Virginica.", "Let\u2019s see how the classifiers perform on a bigger, more complicated dataset.", "The training accuracy for the cars is satisfactory with 93%, while the test accuracy dropped to 73%.", "A slightly better result is achieved with a Random Forest classifier.", "Again, the training remains at 93% while the test accuracy is a bit better with 76%. Next we will try to \u201ctune\u201d our models, to achieve better results.", "Scikit-learn provides a method called GridSearchCV, which makes it very easy find best the classifier for several different hyperparameters. As input GridSearchCV takes the desired classifier, a dictionary (or list) with the selected hyperparameters and the evaluation metric. The default evaluation metric is accuracy, but other metrics are possible, like i.e. area under ROC curve or F1-score.", "For the decision Tree model, we\u2019ve selected only the max_depth. We plot the best hyperparameter for this case, training accuracy and the test accuracy.", "In the case of the car fuel economy dataset, GridSearchCV found that the best depth of Decision Tree model is 19, yielding an test accuracy of 75.1%. A 2.1% increase, in contrast to the default hyperparameters.", "In the case of the Random Forest classifier we\u2019ve selected 3 hyperparameters to tune: n_estimators (number of trees in the ensemble), max_depth of the trees and max_features (maximum number of features per tree).", "I wanted to point out, that the computational requirements of GridSearchCV in this case are pretty high, so this step will take some time, depending on the type of CPU you have. For example, in this case the model has to build 6x28x7=1176 Random Forests in order to acquire the score of every single one. With the n_jobs parameter one can select the number of processor threads used during the computation (-1 ensures all available threads will be used, while a positive integer select a specific number of threads).", "In contrast to the default hyperparameter values in the Random Forest classifier we managed to get a slightly better accuracy. The GridSearchCV method found that 500 decision trees in the ensemble, gave a better results than the default 100 trees. Also, instead of using all seven features, the model here chose only 2 features per tree. Probably running the algorithm with different and longer ranges of the hyperparameters, would yield a further increase in the accuracy, but the additional time-effort is questionable.", "With this article I\u2019ve tried to simplify the terms of Decision Trees and Random Forests. Both algorithms can be used for both Classification and Regression. In this example, I\u2019ve covered Classification.", "Also, a simple approach to DT and RF classification on two datasets have been presented, with a very good, and a satisfactory result. Therefore the Scikit-learn DecisionTree and RandomForest classes were used.", "Scikit-learn provides a great tool for model hyperparameter tuning called GridSearchCV. The implementation is straightforward, but requires significant computational power, especially in case of random Forests.", "For any questions or suggestions regarding this article or my work feel free to contact me via LinkedIn\u00a0.", "I hope you found the article helpful and understandable.", "Also, you can find my other articles on Medium.", "Thank you for taking the time, Cheers! \ud83d\ude42", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "PhD \u2192 Hydrology & Deep Learning (ANN hydrological models). Teaching and Research Assistant at University of Zagreb."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fc4d88f89474e&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftowards-ml-can-you-see-the-forest-for-the-trees-c4d88f89474e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftowards-ml-can-you-see-the-forest-for-the-trees-c4d88f89474e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftowards-ml-can-you-see-the-forest-for-the-trees-c4d88f89474e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftowards-ml-can-you-see-the-forest-for-the-trees-c4d88f89474e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----c4d88f89474e--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----c4d88f89474e--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@Karlo_Leskovar?source=post_page-----c4d88f89474e--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@Karlo_Leskovar?source=post_page-----c4d88f89474e--------------------------------", "anchor_text": "Karlo Leskovar"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fc0efc778fe01&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftowards-ml-can-you-see-the-forest-for-the-trees-c4d88f89474e&user=Karlo+Leskovar&userId=c0efc778fe01&source=post_page-c0efc778fe01----c4d88f89474e---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc4d88f89474e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftowards-ml-can-you-see-the-forest-for-the-trees-c4d88f89474e&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc4d88f89474e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftowards-ml-can-you-see-the-forest-for-the-trees-c4d88f89474e&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://towardsdatascience.com/machine-learning-how-to-evaluate-your-model-1dabbdc849a4", "anchor_text": "Machine Learning \u2014 How to Evaluate your Model?Basic evaluation metrics and methods for Machine Learning algorithmstowardsdatascience.com"}, {"url": "https://unsplash.com/@elijahhail?utm_source=medium&utm_medium=referral", "anchor_text": "Elijah Hail"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://www.kaggle.com/uciml/iris", "anchor_text": "Kaggle"}, {"url": "https://github.com/emilylauyw/Udacity_DAND_CaseStudy2-Analyze_Fuel_Economy_Data", "anchor_text": "Udacity"}, {"url": "https://www.linkedin.com/mwlite/in/karlo-leskovar-a8612b105", "anchor_text": "LinkedIn"}, {"url": "https://medium.com/@Karlo_Leskovar", "anchor_text": "Medium"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----c4d88f89474e---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/decision-tree?source=post_page-----c4d88f89474e---------------decision_tree-----------------", "anchor_text": "Decision Tree"}, {"url": "https://medium.com/tag/random-forest?source=post_page-----c4d88f89474e---------------random_forest-----------------", "anchor_text": "Random Forest"}, {"url": "https://medium.com/tag/classification?source=post_page-----c4d88f89474e---------------classification-----------------", "anchor_text": "Classification"}, {"url": "https://medium.com/tag/python?source=post_page-----c4d88f89474e---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fc4d88f89474e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftowards-ml-can-you-see-the-forest-for-the-trees-c4d88f89474e&user=Karlo+Leskovar&userId=c0efc778fe01&source=-----c4d88f89474e---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fc4d88f89474e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftowards-ml-can-you-see-the-forest-for-the-trees-c4d88f89474e&user=Karlo+Leskovar&userId=c0efc778fe01&source=-----c4d88f89474e---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc4d88f89474e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftowards-ml-can-you-see-the-forest-for-the-trees-c4d88f89474e&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----c4d88f89474e--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fc4d88f89474e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftowards-ml-can-you-see-the-forest-for-the-trees-c4d88f89474e&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----c4d88f89474e---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----c4d88f89474e--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----c4d88f89474e--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----c4d88f89474e--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----c4d88f89474e--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----c4d88f89474e--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----c4d88f89474e--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----c4d88f89474e--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----c4d88f89474e--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@Karlo_Leskovar?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@Karlo_Leskovar?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Karlo Leskovar"}, {"url": "https://medium.com/@Karlo_Leskovar/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "97 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fc0efc778fe01&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftowards-ml-can-you-see-the-forest-for-the-trees-c4d88f89474e&user=Karlo+Leskovar&userId=c0efc778fe01&source=post_page-c0efc778fe01--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F5902a10f355e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftowards-ml-can-you-see-the-forest-for-the-trees-c4d88f89474e&newsletterV3=c0efc778fe01&newsletterV3Id=5902a10f355e&user=Karlo+Leskovar&userId=c0efc778fe01&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}