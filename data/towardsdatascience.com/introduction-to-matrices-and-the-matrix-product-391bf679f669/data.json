{"url": "https://towardsdatascience.com/introduction-to-matrices-and-the-matrix-product-391bf679f669", "time": 1683017850.2926688, "path": "towardsdatascience.com/introduction-to-matrices-and-the-matrix-product-391bf679f669/", "webpage": {"metadata": {"title": "Essential Math for Data Science: Introduction to Matrices and the Matrix Product | by Hadrien Jean | Towards Data Science", "h1": "Essential Math for Data Science: Introduction to Matrices and the Matrix Product", "description": "As you saw in Essential Math for Data Science, vectors are a useful way to store and manipulate data. You can represent them geometrically as arrows, or as arrays of numbers (the coordinates of their\u2026"}, "outgoing_paragraph_urls": [{"url": "https://bit.ly/34jm8xb", "anchor_text": "Essential Math for Data Science", "paragraph_index": 0}, {"url": "https://bit.ly/34jm8xb", "anchor_text": "Essential Math for Data Science", "paragraph_index": 6}, {"url": "https://bit.ly/34jm8xb", "anchor_text": "Essential Math for Data Science", "paragraph_index": 24}, {"url": "https://bit.ly/34jm8xb", "anchor_text": "Essential Math for Data Science", "paragraph_index": 27}, {"url": "https://bit.ly/34jm8xb", "anchor_text": "Essential Math for Data Science", "paragraph_index": 33}, {"url": "https://bit.ly/34jm8xb", "anchor_text": "Essential Math for Data Science", "paragraph_index": 43}, {"url": "https://bit.ly/34jm8xb", "anchor_text": "Essential Math for Data Science", "paragraph_index": 57}, {"url": "https://hadrienj.github.io/about/", "anchor_text": "https://hadrienj.github.io/about/", "paragraph_index": 60}], "all_paragraphs": ["As you saw in Essential Math for Data Science, vectors are a useful way to store and manipulate data. You can represent them geometrically as arrows, or as arrays of numbers (the coordinates of their ending points). However, it can be helpful to create more complicated data structures \u2014 and that is where matrices need to be introduced.", "As vectors, matrices are data structures allowing you to organize numbers. They are square or rectangular arrays containing values organized in two dimensions: rows and columns. You can think of them as a spreadsheet. Usually, you\u2019ll see the term matrix in the context of math and two-dimensional array in the context of Numpy.", "In the context of matrices, the term dimension is different from dimensions of the geometric representation of vectors (the dimensions of the space). When we say that a matrix is a two-dimensional array, it means that there are two directions in the array: the rows and the columns.", "In this book, I\u2019ll denote matrices with bold typeface and upper-case letters, like A:", "Matrix A has two rows and two columns but you can imagine matrices with any shape. More generally, if the matrix has m rows and n columns and contains real values, you can characterize it with the following notation: A \u2208 \u211d (m \u00d7 n).", "You can refer to matrix entries with the name of the matrix with no bold font (because the entries are scalars) followed by the index for the row and the index for the column separated by a comma in subscript. For instance, A_{1, 2} denotes the entry in the first row and the second column.", "By convention, the first index is for the row and the second for the column. For instance, the entry 2 in the matrix A above is located in the second row and the first column of the matrix A, so it is denoted as A_{2, 1} (remember from Essential Math for Data Science that one-based indexing is generally used in mathematical notation).", "You can write the matrix components as follows:", "Figure 1: Matrices are two-dimensional arrays. The number of rows is usually denoted as m and the number of columns as n.", "The shape of an array gives you the number of components in each dimension, as illustrated in Figure 1. Since this matrix is two-dimensional (rows and columns), you need two values to describe the shape (the number of rows and the number of columns in this order).", "Let\u2019s start by creating a 2D Numpy array with the method np.array():", "Note that we use arrays in arrays ([[]]) to create the 2D array. This differs from creating a 1D array by the number of square brackets that you use.", "Like with vectors, it is possible to access the shape property of Numpy arrays:", "You can see that the shape contains two numbers: they correspond to the number of rows and columns respectively.", "To get a matrix entry, you need two indexes: one to refer to the row index and one to refer to the column index.", "Using Numpy, the indexing process is the same as that of vectors. You just need to specify two indexes. Let\u2019s take again the following matrix A:", "It is possible to get a specific entry with the following syntax:", "A[1, 2] returns the component with the row index one and the column index two (with zero-based indexing).", "To get a complete column, it is possible to use a colon:", "This returns the first column (index zero) because the colon says that we want the components from the first to the last rows. Similarly, to get a specific row, you can do:", "Being able to manipulate matrices containing data is an essential skill for data scientists. Checking the shape of your data is important to be sure that it is organized the way you want. It is also important to know the data shape you\u2019ll need to use libraries like Sklearn or Tensorflow.", "With Numpy, if the array is a vector (1D Numpy array), the shape is a single number:", "You can see that v is a vector. If it is a matrix, the shape has two numbers (the number of values in the rows and in the columns respectively). For instance:", "You can see that the matrix has a single row: the first number of the shape is 1. Once again, using two square brackets, [[ and ]], allows you to create a two-dimensional array (a matrix).", "You learn about the dot product in Essential Math for Data Science. The equivalent operation for matrices is called the matrix product, or matrix multiplication. It takes two matrices and returns another matrix. This is a core operation in linear algebra.", "The simpler case of matrix product is between a matrix and a vector (that you can consider as a matrix product with one of them having a single column).", "Figure 2 illustrates the steps of the product between a matrix and a vector. Let\u2019s consider the first row of the matrix. You do the dot product between the vector (the values 3 and 4 in red) and the row you\u2019re considering (the values 1 and 2 in blue). You multiply the values by pairs: the first value in the row with the first in the column vector ( 1 \u22c5 3), and the second in the row with the second in the vector ( 2 \u22c5 4). It gives you the first component of the resulting matrix ( 1 \u22c5 3 + 2 \u22c5 4 = 11).", "You can see that the matrix-vector product relates to the dot product. It is like splitting the matrix A into three rows and applying the dot product (as in Essential Math for Data Science).", "Let\u2019s see how it works with Numpy.", "Note that we used the reshape() function to reshape the vector into a 2 by 1 matrix (the-1 tells Numpy to guess the remaining number). Without it, you would end with a one-dimensional array instead of a two-dimensional array here (a matrix with a single column).", "There is another way to think about the matrix product. You can consider that the vector contains values that weight each column of the matrix. It clearly shows that the length of the vector needs to be equal to the number of columns of the matrix on which the vector is applied.", "Figure 3 might help to visualize this concept. You can consider the vector values (3 and 4) as weights applied to the columns of the matrix. The rules about scalar multiplication that you saw earlier lead to the same results as before.", "Using the last example, you can write the dot product between A and v as follows:", "This is important because, as you\u2019ll see in more details in Essential Math for Data Science, it shows that Av is a linear combination of the columns of A with the coefficients being the values from v.", "In addition, you can see that the shapes of the matrix and the vector must match for the dot product to be possible.", "Figure 4 summarizes the shapes involved in the matrix-vector product and shows that the number of columns of the matrix must be equal to the number of rows of the vector.", "The matrix product is the equivalent of the dot product operation for two matrices. As you\u2019ll see, it is similar to the matrix-vector product, but applied to each column of the second matrix.", "Figure 5 shows you an example of a matrix product. You can see that the resulting matrix has two columns, as the second matrix. The values of the first column of the second matrix (3 and 4) weight the two columns and the result fills the first column of the resulting matrix. Similarly, the values of the second column of the second matrix (9 and 0) weight the two columns and the result fills the second column of the resulting matrix.", "With Numpy, you can calculate the matrix product exactly as the dot product:", "Like with the matrix-vector product and as illustrated in Figure 6, the number of columns of the first matrix must match the number of rows of the second matrix.", "The resulting matrix has as many rows as the first matrix and as many columns as the second matrix.", "The matrices A and B have different shapes. Let\u2019s calculate their dot product:", "You can see the result of A \u22c5 B is a 3 by 3 matrix. This shape comes from the number of rows of A (3) and the number of columns of B (3).", "You can calculate the covariance matrix (more details about the covariance matrix in Essential Math for Data Science) of a dataset with the product between the matrix containing the variables and its transpose. Then, you divide by the number of observations (or this number minus one for the Bessel correction). You need to be sure that the variables are centered around zero beforehand (this can be done by subtracting the mean).", "Let\u2019s simulate the following variables x, y, and z:", "Using Numpy, the covariance matrix is:", "Now, using the matrix product, you first need to stack the variables as columns of a matrix:", "You can see that the variable X is a 100 by 3 matrix: the 100 rows correspond to the observations and the 3 columns to the features. Then, you center this matrix around zero:", "Finally, you calculate the covariance matrix:", "You get a covariance matrix similar to the one from the function np.cov(). This is important to keep in mind that the dot product of a matrix with its transpose corresponds to the covariance matrix.", "The transpose of the dot product between two matrices is defined as follows:", "For instance, take the following matrices A and B:", "You can check the result of (A B)^T and B^T A^T:", "This can be surprising at first that the order of the two vectors or matrices in the parentheses must change for the equivalence to be satisfied. Let\u2019s look at the details of the operation.", "Figure 7 shows that the transpose of a matrix product is equal to the product of the transpose if you change the order of the vector and matrix.", "You can apply this property to more than two matrices or vectors. For instance,", "Keep this property in a corner of your mind. It explains many \u201ccosmetic rearrangements\u201d that you can encounter when matrices and vectors are manipulated. Trying these manipulations with code is a great way to learn.", "To conclude, the matrix product is a key concept of linear algebra, and you will see in Essential Math for Data Science how it relates to space transformation.", "This post is a sample of my book Essential Math for Data Science!", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Machine learning scientist. PhD in cognitive science at the \u00c9cole Normale Sup\u00e9rieure (ENS), Paris, France. More info: https://hadrienj.github.io/about/"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F391bf679f669&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroduction-to-matrices-and-the-matrix-product-391bf679f669&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroduction-to-matrices-and-the-matrix-product-391bf679f669&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroduction-to-matrices-and-the-matrix-product-391bf679f669&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroduction-to-matrices-and-the-matrix-product-391bf679f669&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----391bf679f669--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----391bf679f669--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@hadrienj?source=post_page-----391bf679f669--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@hadrienj?source=post_page-----391bf679f669--------------------------------", "anchor_text": "Hadrien Jean"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F6a54d892cde4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroduction-to-matrices-and-the-matrix-product-391bf679f669&user=Hadrien+Jean&userId=6a54d892cde4&source=post_page-6a54d892cde4----391bf679f669---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F391bf679f669&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroduction-to-matrices-and-the-matrix-product-391bf679f669&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F391bf679f669&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroduction-to-matrices-and-the-matrix-product-391bf679f669&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://towardsdatascience.com/tagged/essential-math", "anchor_text": "ESSENTIAL MATH FOR DATA SCIENCE"}, {"url": "https://bit.ly/34jm8xb", "anchor_text": "Essential Math for Data Science"}, {"url": "https://bit.ly/34jm8xb", "anchor_text": "Essential Math for Data Science"}, {"url": "https://bit.ly/34jm8xb", "anchor_text": "Essential Math for Data Science"}, {"url": "https://bit.ly/34jm8xb", "anchor_text": "Essential Math for Data Science"}, {"url": "https://bit.ly/34jm8xb", "anchor_text": "Essential Math for Data Science"}, {"url": "https://bit.ly/34jm8xb", "anchor_text": "Essential Math for Data Science"}, {"url": "https://bit.ly/34jm8xb", "anchor_text": "Essential Math for Data Science"}, {"url": "https://hadrienj.github.io/posts/Essential-Math-for-Data-Science-Introduction_to_matrices_and_matrix_product/", "anchor_text": "https://hadrienj.github.io/posts/Essential-Math-for-Data-Science-Introduction_to_matrices_and_matrix_product/"}, {"url": "https://bit.ly/34jm8xb", "anchor_text": "Get the book here: https://bit.ly/34jm8xb"}, {"url": "https://bit.ly/3odUglO", "anchor_text": "!"}, {"url": "https://medium.com/tag/essential-math?source=post_page-----391bf679f669---------------essential_math-----------------", "anchor_text": "Essential Math"}, {"url": "https://medium.com/tag/editors-pick?source=post_page-----391bf679f669---------------editors_pick-----------------", "anchor_text": "Editors Pick"}, {"url": "https://medium.com/tag/data-science?source=post_page-----391bf679f669---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----391bf679f669---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/mathematics?source=post_page-----391bf679f669---------------mathematics-----------------", "anchor_text": "Mathematics"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F391bf679f669&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroduction-to-matrices-and-the-matrix-product-391bf679f669&user=Hadrien+Jean&userId=6a54d892cde4&source=-----391bf679f669---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F391bf679f669&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroduction-to-matrices-and-the-matrix-product-391bf679f669&user=Hadrien+Jean&userId=6a54d892cde4&source=-----391bf679f669---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F391bf679f669&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroduction-to-matrices-and-the-matrix-product-391bf679f669&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----391bf679f669--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F391bf679f669&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroduction-to-matrices-and-the-matrix-product-391bf679f669&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----391bf679f669---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----391bf679f669--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----391bf679f669--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----391bf679f669--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----391bf679f669--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----391bf679f669--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----391bf679f669--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----391bf679f669--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----391bf679f669--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@hadrienj?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@hadrienj?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Hadrien Jean"}, {"url": "https://medium.com/@hadrienj/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "846 Followers"}, {"url": "https://hadrienj.github.io/about/", "anchor_text": "https://hadrienj.github.io/about/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F6a54d892cde4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroduction-to-matrices-and-the-matrix-product-391bf679f669&user=Hadrien+Jean&userId=6a54d892cde4&source=post_page-6a54d892cde4--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F13cd9155f2bd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroduction-to-matrices-and-the-matrix-product-391bf679f669&newsletterV3=6a54d892cde4&newsletterV3Id=13cd9155f2bd&user=Hadrien+Jean&userId=6a54d892cde4&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}