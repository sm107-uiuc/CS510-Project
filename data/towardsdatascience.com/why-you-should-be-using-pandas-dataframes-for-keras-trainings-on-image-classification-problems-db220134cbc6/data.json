{"url": "https://towardsdatascience.com/why-you-should-be-using-pandas-dataframes-for-keras-trainings-on-image-classification-problems-db220134cbc6", "time": 1683008337.909499, "path": "towardsdatascience.com/why-you-should-be-using-pandas-dataframes-for-keras-trainings-on-image-classification-problems-db220134cbc6/", "webpage": {"metadata": {"title": "Why You Should Be Using Pandas Dataframes for Keras Trainings on Image Classification Problems | Towards Data Science", "h1": "Why You Should Be Using Pandas Dataframes for Keras Trainings on Image Classification Problems", "description": "Stop using flow_from_directory and use flow_from_dataframe instead."}, "outgoing_paragraph_urls": [{"url": "https://towardsdatascience.com/organize-and-document-your-machine-learning-or-any-research-project-with-notion-623d52fae972", "anchor_text": "previous article", "paragraph_index": 0}, {"url": "https://keras.io/preprocessing/image/", "anchor_text": "Keras preprocessing module", "paragraph_index": 2}, {"url": "https://pandas.pydata.org/", "anchor_text": "Pandas", "paragraph_index": 3}, {"url": "https://www.pyimagesearch.com/2018/05/07/multi-label-classification-with-keras/", "anchor_text": "it is possible", "paragraph_index": 16}], "all_paragraphs": ["As seen in my previous article, research projects can be arduous with a lack of organization. So many resources around, that sometimes slow down the process of researching.", "In this article, I am going to focused on datasets that are composed of images, especially those for Image Classification problems. We are going to see how launching Keras trainings on this kind of datasets has some advantages when using Pandas dataframes.", "Keras provides a way to use large datasets when working with neural networks: either in the training or evaluation stage. This is the Keras preprocessing module, which has several methods to load data from disk and dynamically pre-process it. The most common method is flow_from_directory(), which is a very simple workflow since you just have to separate your image files into folders for each class. The generator will take each folder as the classes to be trained. This is pretty simple, yes, but it involves having to develop time-consuming scripts to copy or move images from one side to another for each training dataset version.", "We will see how using Pandas library will help relieve these problems.", "Keras has a generator function that is meant to use a Pandas dataframe to load data from disk: flow_from_dataframe(). This dataframe must have a column where you specify the image filename for each item. With this and the directory parameter, Keras will compose the path for each image file in the following way:os.path.join(directory, <filename_column>)At this point, you can forget the idea of having the files organized in folders of classes, and instead, you can just have them all in the same folder.", "Each of the following sections attempts to answer one of the three previous questions by using thisflow_from_dataframe() method.", "My workflow when working with datasets is that I manually create a versioning control system: each version is the result of any modification I make for a particular experiment: adding additional data, modifications to the labels, corrections, etc.", "This results in having different dataset versions that are more clearly represented by dataframes, instead of having to create a separate folder where the images are copied to with a new class-structure. The most powerful thing about this is that the large-size files (the images) are still in the same directory. Therefore, you can have several dataset versions (csv files) composed of different combinations of the same images.", "As I mentioned before, Keras composes the path of the images to be read by using the directory parameter and filename column. The latest must have the file name but it may contain sub-paths too. Keras will perform the join without asking if there is only a filename. This is very powerful for datasets that you download online and have a particular structure in which images are located in different subdirectories. Furthermore, with this, we can easily compose a dataset version where there are images that come from different sources, without having to move them to the same folder.", "Suppose you have dataset 1 and dataset 2 with the following image paths:", "Dataset 1 has a structure where all images are under the same directory: dataset_1/train/*. However, dataset 2 is different, it has subfolders and the image filename itself is repeated (\u201cimage_1.png\u201d), so we need to add this subfolder to the filename column. These would be the two dataframes and their corresponding Keras method calls:", "To create a merged version (dataset 3) we just need to add the path from where both paths become different: \u201cdataset_1/\u201d and \u201cdataset_2/\u201d.", "For this example, we have to set the directory parameter in flow_from_dataframe() to the common path, in order for Keras to be able to compose paths that work for both datasets.", "One thing I suggest here is to create a folder, for instance, dataset_3, with symlinks to both datasets:", "This is just for organization purposes since the base path where both datasets differ would be: /home/datasets/dataset_3 instead of the more general one: /home/datasets. But, it could also be very useful if datasets are located in different places and they don\u2019t share any base path \u2014 and you don\u2019t want to move them.", "In one task using dataframes is unnegotiable is when training a multi-task problem. This refers to networks models that can predict multiple outputs for one input: for instance, if an image has a cat or a dog and the color of its skin.", "For this kind of problems, we need two labels for each input in the training step. So the approach of separating the files into folders for each label, though it is possible, involves having one folder for each label combination. Something it could result in creating a great number of folders.", "The good thing of a dataframe is that you can have a column for label cat/dog and another one for the skin color. When using the flow_from_dataframe() method with your two-output network, you just need to specify in the y_col parameter in which columns are the labels:", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Madrid (Spain) | Machine Learning & Computer Vision Engineer at Geomni"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fdb220134cbc6&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhy-you-should-be-using-pandas-dataframes-for-keras-trainings-on-image-classification-problems-db220134cbc6&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhy-you-should-be-using-pandas-dataframes-for-keras-trainings-on-image-classification-problems-db220134cbc6&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhy-you-should-be-using-pandas-dataframes-for-keras-trainings-on-image-classification-problems-db220134cbc6&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhy-you-should-be-using-pandas-dataframes-for-keras-trainings-on-image-classification-problems-db220134cbc6&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----db220134cbc6--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----db220134cbc6--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@serchu?source=post_page-----db220134cbc6--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@serchu?source=post_page-----db220134cbc6--------------------------------", "anchor_text": "Sergio Ruiz"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fa668b1152709&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhy-you-should-be-using-pandas-dataframes-for-keras-trainings-on-image-classification-problems-db220134cbc6&user=Sergio+Ruiz&userId=a668b1152709&source=post_page-a668b1152709----db220134cbc6---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fdb220134cbc6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhy-you-should-be-using-pandas-dataframes-for-keras-trainings-on-image-classification-problems-db220134cbc6&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fdb220134cbc6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhy-you-should-be-using-pandas-dataframes-for-keras-trainings-on-image-classification-problems-db220134cbc6&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://towardsdatascience.com/organize-and-document-your-machine-learning-or-any-research-project-with-notion-623d52fae972", "anchor_text": "previous article"}, {"url": "https://unsplash.com/@mbaumi?utm_source=medium&utm_medium=referral", "anchor_text": "Mika Baumeister"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://keras.io/preprocessing/image/", "anchor_text": "Keras preprocessing module"}, {"url": "https://pandas.pydata.org/", "anchor_text": "Pandas"}, {"url": "https://www.pyimagesearch.com/2018/05/07/multi-label-classification-with-keras/", "anchor_text": "it is possible"}, {"url": "https://twitter.com/serchu", "anchor_text": "@serchu"}, {"url": "https://towardsdatascience.com/organize-and-document-your-machine-learning-or-any-research-project-with-notion-623d52fae972", "anchor_text": "Organize and Document your Machine Learning (or any) Research Project with NotionResearch can be arduous with a lack of organization and documentation.towardsdatascience.com"}, {"url": "https://medium.com/tag/keras?source=post_page-----db220134cbc6---------------keras-----------------", "anchor_text": "Keras"}, {"url": "https://medium.com/tag/pandas?source=post_page-----db220134cbc6---------------pandas-----------------", "anchor_text": "Pandas"}, {"url": "https://medium.com/tag/image-classification?source=post_page-----db220134cbc6---------------image_classification-----------------", "anchor_text": "Image Classification"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----db220134cbc6---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/towards-data-science?source=post_page-----db220134cbc6---------------towards_data_science-----------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fdb220134cbc6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhy-you-should-be-using-pandas-dataframes-for-keras-trainings-on-image-classification-problems-db220134cbc6&user=Sergio+Ruiz&userId=a668b1152709&source=-----db220134cbc6---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fdb220134cbc6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhy-you-should-be-using-pandas-dataframes-for-keras-trainings-on-image-classification-problems-db220134cbc6&user=Sergio+Ruiz&userId=a668b1152709&source=-----db220134cbc6---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fdb220134cbc6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhy-you-should-be-using-pandas-dataframes-for-keras-trainings-on-image-classification-problems-db220134cbc6&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----db220134cbc6--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fdb220134cbc6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhy-you-should-be-using-pandas-dataframes-for-keras-trainings-on-image-classification-problems-db220134cbc6&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----db220134cbc6---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----db220134cbc6--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----db220134cbc6--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----db220134cbc6--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----db220134cbc6--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----db220134cbc6--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----db220134cbc6--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----db220134cbc6--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----db220134cbc6--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@serchu?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@serchu?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Sergio Ruiz"}, {"url": "https://medium.com/@serchu/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "46 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fa668b1152709&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhy-you-should-be-using-pandas-dataframes-for-keras-trainings-on-image-classification-problems-db220134cbc6&user=Sergio+Ruiz&userId=a668b1152709&source=post_page-a668b1152709--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fusers%2Fa668b1152709%2Flazily-enable-writer-subscription&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhy-you-should-be-using-pandas-dataframes-for-keras-trainings-on-image-classification-problems-db220134cbc6&user=Sergio+Ruiz&userId=a668b1152709&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}