{"url": "https://towardsdatascience.com/principal-component-analysis-from-scratch-in-numpy-61843da1f967", "time": 1683017578.4270551, "path": "towardsdatascience.com/principal-component-analysis-from-scratch-in-numpy-61843da1f967/", "webpage": {"metadata": {"title": "Principal Component Analysis From Scratch in Numpy | by Guillermina Sutter Schneider | Towards Data Science", "h1": "Principal Component Analysis From Scratch in Numpy", "description": "For a couple of months now, I have been looking for projects to work on. I have gone from wanting to work on this NFL challenge, to actually building a web app with a friend that some people would\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.kaggle.com/c/nfl-big-data-bowl-2021", "anchor_text": "NFL challenge", "paragraph_index": 0}, {"url": "https://www.kaggle.com/theforcecoder/wind-power-forecasting", "anchor_text": "this dataset about wind power forecasting", "paragraph_index": 1}, {"url": "https://towardsdatascience.com/a-one-stop-shop-for-principal-component-analysis-5582fb7e0a9c", "anchor_text": "this article", "paragraph_index": 7}, {"url": "https://github.com/glosophy/WindPowerForecasting/blob/main/windPowerPCA.ipynb", "anchor_text": "this repo", "paragraph_index": 8}, {"url": "https://bioturing.medium.com/how-to-read-pca-biplots-and-scree-plots-186246aae063#:~:text=A%20scree%20plot%20shows%20how,the%20principal%20components%20to%20keep.&text=Proportion%20of%20variance%20plot%3A%20the,least%2080%25%20of%20the%20variance.", "anchor_text": "this article", "paragraph_index": 19}, {"url": "https://blogs.sas.com/content/iml/2019/11/04/interpret-graphs-principal-components.html", "anchor_text": "this article", "paragraph_index": 21}, {"url": "https://github.com/glosophy/WindPowerForecasting/blob/main/windPowerPCA.ipynb", "anchor_text": "here", "paragraph_index": 23}], "all_paragraphs": ["For a couple of months now, I have been looking for projects to work on. I have gone from wanting to work on this NFL challenge, to actually building a web app with a friend that some people would probably classify as PG13 (one day I will write about it and, maybe, deploy it).", "I ended up looking for datasets on Kaggle that could help me brush up my time series skills. You know\u2026 just for fun. That was when I ran into this dataset about wind power forecasting, and decided to give it a try.", "After I cleaned up the data (got rid of some columns with a huge amount of missing values, turned some categorical features into numbers, parsed the dates, filled some missing values with the median, dropped more columns that didn\u2019t add much to the data, etc.) I found that:", "When your features are correlated with each other, that means that they are not independent. This is a common problem in data science and is called \u201cmulticollinearity\u201d.", "In an ideal case features should be independent from each other. Solving this issue is super important, because working with highly correlated features in multivariate regression models can lead to inaccurate results.", "One way to approach this problem is by doing Principal component analysis (PCA).", "PCA is a feature extraction method commonly used to tackle multicollinearity, among other things. The greatest advantage of PCA in this case, is that after applying it, each of the \u201cnew\u201d variables will be independent of one another.", "This section is based on this article by Matt Brems. (I have to thank my time series professor for sending it to me!). I will go step by step and explain how to do PCA using just numpy (and a little bit of pandas to manipulate the dataframe at the beginning).", "It is very important to clean the dataset first. Since that is not the objective of this article, you can go take a look at what I did in this repo.", "Separate your data into the dependent variable (Y) and the features or independent variables (X).", "Take the matrix of independent variables X and, for each column, subtract the mean of that column from each feature. (This ensures that each column has a mean of zero.) You can also normalize X by dividing each column for its standard deviation. The purpose of this step is to standarize the features so they have a mean equal to zero and a standard deviation equal to one.", "This is a sanity-check step. Let\u2019s make sure the mean and standard deviation are zero and one, respectively.", "Take the matrix Z, transpose it, and multiply the transposed matrix by Z. This is the covariance matrix of Z.", "Get an array of computed eigenvalues and a matrix whose columns are the normalized eigenvectors corresponding to the eigenvalues in that order.", "In this step it is important to make sure that the eigenvalues and its eigenvectors are sorted in descending order (from largest to smallest). Sort the eigenvalues and then the eigenvectors, accordingly.", "Assign P to the matrix of eigenvectors and D to the diagonal matrix with eigenvalues on the diagonal and values of zero everywhere else. The eigenvalues on the diagonal of D will be associated with the corresponding column in P.", "Calculate Z* = ZP. This new matrix, Z*, is a centered or standardized version of X but now each observation is a combination of the original variables, where the weights are determined by the eigenvector.", "One important thing about this new matrix Z* is that because the eigenvectors in P are independent to one another, so will be the columns in Z*!", "With Z* one can now make the decision about how many features to keep versus how many to drop. This is commonly done through a scree plot.", "A scree plot shows how much variation each principal component captures from the data. The y axis stands for the amount of variation (see this article for more information about scree plots and how to interpret them). The plot on the left shows both amount of variation derived from each principal component and the cumulative variation that results from adding or considering another principal component for the model.", "How many principal components to choose, comes down to a rule of thumb: the selected principal components should be able to describe at least 80\u201385% of the variance. In this case, the first principal component alone explains roughly 82% of the variance. Adding the second principal component pushes that figure to almost 90%.", "If you are wondering how to interpret the principal components in the context of the data, I found this article to be particularly easy to follow. They use the iris dataset and gives lots of examples using the scree, profile, and pattern plots.", "PCA can be tricky sometimes. But with the right resources and patience, it can become enjoyable. On top of that, I found useful getting back to the basics and getting a full grasp of PCA by coding everything using numpy and understanding the linear algebra behind every line of code.", "I hope you found this article helpful! You can see the full Python script here.", "Also, if you have any feedback, please do not hesitate to get in touch.", "Thanks for reading and happy coding! \ud83e\udd13", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Argentine data scientist living in the United States. I like numbers, dataviz, and Germany. Not necessarily in that order."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F61843da1f967&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fprincipal-component-analysis-from-scratch-in-numpy-61843da1f967&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fprincipal-component-analysis-from-scratch-in-numpy-61843da1f967&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fprincipal-component-analysis-from-scratch-in-numpy-61843da1f967&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fprincipal-component-analysis-from-scratch-in-numpy-61843da1f967&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----61843da1f967--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----61843da1f967--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://gsutter.medium.com/?source=post_page-----61843da1f967--------------------------------", "anchor_text": ""}, {"url": "https://gsutter.medium.com/?source=post_page-----61843da1f967--------------------------------", "anchor_text": "Guillermina Sutter Schneider"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F3105dffd4d5e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fprincipal-component-analysis-from-scratch-in-numpy-61843da1f967&user=Guillermina+Sutter+Schneider&userId=3105dffd4d5e&source=post_page-3105dffd4d5e----61843da1f967---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F61843da1f967&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fprincipal-component-analysis-from-scratch-in-numpy-61843da1f967&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F61843da1f967&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fprincipal-component-analysis-from-scratch-in-numpy-61843da1f967&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@fempreneurstyledstock?utm_source=medium&utm_medium=referral", "anchor_text": "Leone Venter"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://www.kaggle.com/c/nfl-big-data-bowl-2021", "anchor_text": "NFL challenge"}, {"url": "https://www.kaggle.com/theforcecoder/wind-power-forecasting", "anchor_text": "this dataset about wind power forecasting"}, {"url": "https://towardsdatascience.com/a-one-stop-shop-for-principal-component-analysis-5582fb7e0a9c", "anchor_text": "this article"}, {"url": "https://github.com/glosophy/WindPowerForecasting/blob/main/windPowerPCA.ipynb", "anchor_text": "this repo"}, {"url": "https://bioturing.medium.com/how-to-read-pca-biplots-and-scree-plots-186246aae063#:~:text=A%20scree%20plot%20shows%20how,the%20principal%20components%20to%20keep.&text=Proportion%20of%20variance%20plot%3A%20the,least%2080%25%20of%20the%20variance.", "anchor_text": "this article"}, {"url": "https://blogs.sas.com/content/iml/2019/11/04/interpret-graphs-principal-components.html", "anchor_text": "this article"}, {"url": "https://github.com/glosophy/WindPowerForecasting/blob/main/windPowerPCA.ipynb", "anchor_text": "here"}, {"url": "https://medium.com/tag/python?source=post_page-----61843da1f967---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/numpy?source=post_page-----61843da1f967---------------numpy-----------------", "anchor_text": "Numpy"}, {"url": "https://medium.com/tag/statistics?source=post_page-----61843da1f967---------------statistics-----------------", "anchor_text": "Statistics"}, {"url": "https://medium.com/tag/programming?source=post_page-----61843da1f967---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----61843da1f967---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F61843da1f967&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fprincipal-component-analysis-from-scratch-in-numpy-61843da1f967&user=Guillermina+Sutter+Schneider&userId=3105dffd4d5e&source=-----61843da1f967---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F61843da1f967&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fprincipal-component-analysis-from-scratch-in-numpy-61843da1f967&user=Guillermina+Sutter+Schneider&userId=3105dffd4d5e&source=-----61843da1f967---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F61843da1f967&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fprincipal-component-analysis-from-scratch-in-numpy-61843da1f967&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----61843da1f967--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F61843da1f967&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fprincipal-component-analysis-from-scratch-in-numpy-61843da1f967&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----61843da1f967---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----61843da1f967--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----61843da1f967--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----61843da1f967--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----61843da1f967--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----61843da1f967--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----61843da1f967--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----61843da1f967--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----61843da1f967--------------------------------", "anchor_text": ""}, {"url": "https://gsutter.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://gsutter.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Guillermina Sutter Schneider"}, {"url": "https://gsutter.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "266 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F3105dffd4d5e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fprincipal-component-analysis-from-scratch-in-numpy-61843da1f967&user=Guillermina+Sutter+Schneider&userId=3105dffd4d5e&source=post_page-3105dffd4d5e--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fb6433a5d80bf&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fprincipal-component-analysis-from-scratch-in-numpy-61843da1f967&newsletterV3=3105dffd4d5e&newsletterV3Id=b6433a5d80bf&user=Guillermina+Sutter+Schneider&userId=3105dffd4d5e&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}