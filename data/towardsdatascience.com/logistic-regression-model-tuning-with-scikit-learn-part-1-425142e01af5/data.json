{"url": "https://towardsdatascience.com/logistic-regression-model-tuning-with-scikit-learn-part-1-425142e01af5", "time": 1682994547.9208472, "path": "towardsdatascience.com/logistic-regression-model-tuning-with-scikit-learn-part-1-425142e01af5/", "webpage": {"metadata": {"title": "Logistic Regression Model Tuning with scikit-learn \u2014 Part 1 | by Finn Qiao | Towards Data Science", "h1": "Logistic Regression Model Tuning with scikit-learn \u2014 Part 1", "description": "Classifiers are a core component of machine learning models and can be applied widely across a variety of disciplines and problem statements. With all the packages available out there, running a\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.kaggle.com/henriqueyamahata/bank-marketing", "anchor_text": "Bank Marketing dataset", "paragraph_index": 3}, {"url": "https://www.kdnuggets.com/2017/04/must-know-curse-dimensionality.html", "anchor_text": "curse of dimensionality", "paragraph_index": 7}, {"url": "https://developers.google.com/machine-learning/crash-course/classification/roc-and-auc", "anchor_text": "AUC", "paragraph_index": 9}, {"url": "https://github.com/finnqiao/bank-logistic/blob/master/bank-logistic-v2.ipynb", "anchor_text": "here", "paragraph_index": 37}, {"url": "https://www.linkedin.com/in/finnqiao/", "anchor_text": "LinkedIn", "paragraph_index": 37}], "all_paragraphs": ["Classifiers are a core component of machine learning models and can be applied widely across a variety of disciplines and problem statements.", "With all the packages available out there, running a logistic regression in Python is as easy as running a few lines of code and getting the accuracy of predictions on a test set.", "What are some ways to improve on such a base model and how do the results compare?", "For the purpose of showing some techniques, we will run some models with the Bank Marketing dataset from the UCI Machine Learning Repository. This dataset represents the direct marketing campaigns of a Portuguese bank and whether the efforts led to a bank term deposit.", "After importing the necessary packages for the basic EDA and using the missingno package, it seems that most data is present for this dataset.", "To run a logistic regression on this data, we would have to convert all non-numeric features into numeric ones. There are two popular ways to do this: label encoding and one hot encoding.", "For label encoding, a different number is assigned to each unique value in the feature column. A potential issue with this method would be the assumption that the label sizes represent ordinality (i.e. a label of 3 is greater than a label of 1).", "For one hot encoding, a new feature column is created for each unique value in the feature column. The value would be 1 if the value was present for that observation and 0 otherwise. This method however could easily lead to an explosion in number of features and lead to the curse of dimensionality.", "Below, we try to fit one model with only dummy variables and another with only label encoded variables.", "While the resulting model accuracies are quite comparable, a quick look at AUC, another model metric indicates a drastic improvement when label encoding were used.", "It seems that label encoding performs much better across the spectrum of different threshold values. However, there are a few features in which the label ordering did not make sense. For example, days of week:", "Furthermore, the \u2018job\u2019 feature in particular would be more explanatory if converted to dummy variables as one\u2019s job would appear to be an important determinant of whether they open a term deposit and an ordinal scale wouldn\u2019t quite make sense.", "Below, custom orders were determined for education, month, and day of the week while dummy variables were created for jobs.", "The resulting model has a comparable accuracy to only label encoded variables while maintaining a similarly high AUC score of 0.92. More importantly, the new mix of labels and dummy variables can now be clearly explained and identified.", "The above base model was performed on the original data without any normalization. Here, we adopt the MinMaxScaler and constrain the range of values to be between 0 and 1.", "One might also be skeptical of the immediate AUC score of around 0.9. Upon examining the sample of the response variable, there appears to be a class imbalance problem where only around 10% of the customers subscribed to the term deposit.", "There is debate around the severity of the class imbalance issue with a 10:90 split as there are many conversion experiments out there that could have up to a 1:99 split.", "Nonetheless, we explore a resampling technique here using SMOTE. In our particular scenario, we oversample the minority class by synthetically generating additional samples.", "While the resampled data slightly outperformed on AUC, the accuracy drops to 86.6%. This is in fact even lower than our base model.", "While we have been using the basic logistic regression model in the above test cases, another popular approach to classification is the random forest model.", "Lets repeat the above two models with normalized data and resampled data with the random forest model.", "Both have comparable accuracy scores but it is interesting to note how the model accuracy on the resampled data greatly improved with the random forest model as opposed to the base logistic regression model.", "While both AUC scores were slightly lower than those of the logistic models, it seems that using a random forest model on resampled data performed better on aggregate across accuracy and AUC metrics.", "It is notable that the above models were run with the default parameters determined by the LogisticRegression and RandomForestClassifier modules. Could we improve the model by tuning the hyperparameters of the model?", "To achieve this, we define a \u201cgrid\u201d of parameters that we would want to test out in the model and select the best model using GridSearchCV.", "With the above grid search, we utilize a parameter grid that consists of two dictionaries.", "The first dictionary includes all variations of LogisticRegression I want to run in the model that includes variations with respect to type of regularization, size of penalty, and type of solver used.", "The second dictionary includes all variations of RandomForestClassifier and includes different ranges for the number of estimators (trees) and the maximum number of features used in the model.", "With the defined parameter ranges, 100 potential models were evaluated. As I had chosen a 5-fold cross validation, that resulted in 500 different models being fitted. This took around 9 minutes.", "This is what the \u201cbest\u201d model looks like for parameters:", "The accuracy of 0.908 and AUC score of 0.94 are both the highest we\u2019ve seen of each respective metric from all models so far.", "Repeating the same fit on resampled data yielded the same accuracy and classification report but took up to 23 minutes to run.", "How have different classification metrics improved from our base model?", "It appears that all models performed very well for the majority class, with precision, recall metrics all above 0.9.", "The new improved model though performs much better for the minority class and arguably the \u201cmore important\u201d classification of whether a customer was going to subscribe to the term deposit.", "The AUC score was also improved to 0.94 which suggests that the final model also performs better across different threshold values.", "While we have managed to improve the base model, there are still many ways to tune the model including polynomial feature generation, sklearn feature selection, and tuning of more hyperparameters for grid search.", "These will be the focus of Part 2! In the meantime, thanks for reading and the code can be found here. Feel free to connect on LinkedIn as well!", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Food \u00b7 Travel \u00b7 Technology \u00b7 Product \u00b7 Strategy"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F425142e01af5&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flogistic-regression-model-tuning-with-scikit-learn-part-1-425142e01af5&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flogistic-regression-model-tuning-with-scikit-learn-part-1-425142e01af5&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flogistic-regression-model-tuning-with-scikit-learn-part-1-425142e01af5&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flogistic-regression-model-tuning-with-scikit-learn-part-1-425142e01af5&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----425142e01af5--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----425142e01af5--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@finnqiao?source=post_page-----425142e01af5--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@finnqiao?source=post_page-----425142e01af5--------------------------------", "anchor_text": "Finn Qiao"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F511a811ea993&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flogistic-regression-model-tuning-with-scikit-learn-part-1-425142e01af5&user=Finn+Qiao&userId=511a811ea993&source=post_page-511a811ea993----425142e01af5---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F425142e01af5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flogistic-regression-model-tuning-with-scikit-learn-part-1-425142e01af5&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F425142e01af5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flogistic-regression-model-tuning-with-scikit-learn-part-1-425142e01af5&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://www.kaggle.com/henriqueyamahata/bank-marketing", "anchor_text": "Bank Marketing dataset"}, {"url": "https://www.kdnuggets.com/2017/04/must-know-curse-dimensionality.html", "anchor_text": "curse of dimensionality"}, {"url": "https://developers.google.com/machine-learning/crash-course/classification/roc-and-auc", "anchor_text": "AUC"}, {"url": "https://github.com/finnqiao/bank-logistic/blob/master/bank-logistic-v2.ipynb", "anchor_text": "here"}, {"url": "https://www.linkedin.com/in/finnqiao/", "anchor_text": "LinkedIn"}, {"url": "https://medium.com/tag/data?source=post_page-----425142e01af5---------------data-----------------", "anchor_text": "Data"}, {"url": "https://medium.com/tag/data-science?source=post_page-----425142e01af5---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/tech?source=post_page-----425142e01af5---------------tech-----------------", "anchor_text": "Tech"}, {"url": "https://medium.com/tag/technology?source=post_page-----425142e01af5---------------technology-----------------", "anchor_text": "Technology"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----425142e01af5---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F425142e01af5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flogistic-regression-model-tuning-with-scikit-learn-part-1-425142e01af5&user=Finn+Qiao&userId=511a811ea993&source=-----425142e01af5---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F425142e01af5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flogistic-regression-model-tuning-with-scikit-learn-part-1-425142e01af5&user=Finn+Qiao&userId=511a811ea993&source=-----425142e01af5---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F425142e01af5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flogistic-regression-model-tuning-with-scikit-learn-part-1-425142e01af5&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----425142e01af5--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F425142e01af5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flogistic-regression-model-tuning-with-scikit-learn-part-1-425142e01af5&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----425142e01af5---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----425142e01af5--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----425142e01af5--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----425142e01af5--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----425142e01af5--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----425142e01af5--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----425142e01af5--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----425142e01af5--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----425142e01af5--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@finnqiao?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@finnqiao?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Finn Qiao"}, {"url": "https://medium.com/@finnqiao/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "609 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F511a811ea993&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flogistic-regression-model-tuning-with-scikit-learn-part-1-425142e01af5&user=Finn+Qiao&userId=511a811ea993&source=post_page-511a811ea993--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F3294a2317ce2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flogistic-regression-model-tuning-with-scikit-learn-part-1-425142e01af5&newsletterV3=511a811ea993&newsletterV3Id=3294a2317ce2&user=Finn+Qiao&userId=511a811ea993&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}