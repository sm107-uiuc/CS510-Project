{"url": "https://towardsdatascience.com/scraping-coronavirus-death-demographics-with-beautiful-soup-9df7488fe84c", "time": 1683005995.11134, "path": "towardsdatascience.com/scraping-coronavirus-death-demographics-with-beautiful-soup-9df7488fe84c/", "webpage": {"metadata": {"title": "Scraping Coronavirus Death Demographics with Beautiful Soup | by Jian Xu | Towards Data Science", "h1": "Scraping Coronavirus Death Demographics with Beautiful Soup", "description": "As the coronavirus spreading across the world, detailed data become essential for people to understand this virus. Many excellent data sources have been publishing data readily available for research\u2026"}, "outgoing_paragraph_urls": [{"url": "https://towardsdatascience.com/a-short-review-of-covid-19-data-sources-ba7f7aa1c342", "anchor_text": "this article", "paragraph_index": 0}, {"url": "https://towardsdatascience.com/covid-19-gis-resource-summary-debcba2a000b", "anchor_text": "this article", "paragraph_index": 0}, {"url": "https://www.dph.illinois.gov/news/202004", "anchor_text": "Illinois Department of Health daily news", "paragraph_index": 1}, {"url": "https://github.com/jianxu305/nCov2019_analysis", "anchor_text": "GitHub repo", "paragraph_index": 19}, {"url": "https://towardsdatascience.com/deeppicar-part-1-102e03c83f2c", "anchor_text": "DeepPiCar", "paragraph_index": 24}], "all_paragraphs": ["As the coronavirus spreading across the world, detailed data become essential for people to understand this virus. Many excellent data sources have been publishing data readily available for research (a general review in this article, and a more GIS-related review in this article). However, most of the data sources are focused on confirmed/death/recovery counts and test counts at different locations. What if you want other information, for example, the death demographics such as sex and age?", "In this tutorial, we are going to scape the Illinois Department of Health daily news webpage to obtain the coronavirus death demographics, using Python and the Beautiful Soup library.", "First, we know that the Illinois Department of Health (IDPH) has daily briefing which contains death demographics. Let\u2019s take 2020 April as an example, and visit the following webpage", "A quick look can reveal the following information:", "Since we know the HTTP address, we can easily construct a soup object with the Beautiful Soup.", "Most modern web browsers provide basic tools to view the source code of web pages. Take Chrome as an example, you can use the <F12> key to bring up the DevTools Console on the side, which looks like the following:", "At first sight, the contents on the right look daunting, especially for those are not familiar with HTML. How can we find the relevant information in this big mess?", "The good news is that, in most cases, we don\u2019t have to know the complete structure of the web page. For example, since in step #1 we already identified that the date string specifies the location of the news, we can use Ctrl-F to search the date string \u201c15th Apr\u201d, to quickly locate the section of interest:", "If you hover your mouth over the \u201c15th Apr\u201d, the corresponding section on the web page on the left will be highlighted. This confirms the code location.", "After confirming the logical location, we can replicate this in the soup object using the find_all function to find all the div, and use the one whose span has the correct string.", "After running the above code, we can print the target_elm to confirm whether it is the element that contains \u201c15th Apr, 2020\u201d:", "As we discussed in #1, the detailed daily report is actually at another location, under the \u201cRead more\u201d link. We can find the relative path by using the same trick, ie, search \u201cRead more\u201d in the DevTools Console:", "Conveniently, the element which contains the \u201cRead more\u201d link and the element which contains the \u201c15th Apr\u201d string belongs to the same parent. Therefore, we can use the parent property of the soup element to navigate the structure, then use .a.get('href') to obtain the hyperlink.", "After obtaining the hyperlink of the detailed report of the date, we can request the new web page, and create the new soup object accordingly:", "Then we can open the actual daily report page, and use the same trick, search \u201cCook County\u201d to locate the related part of the code. As we can see, the detailed break down is in an unordered list (<ul> </ul>tag) under a div class \u201cfield-item even\u201d.", "After locating the list, we can iterate the list by using the find_all function to search the <li> tag, then use the .text property to obtain the corresponding text.", "Once we get the string such as \u201c1 male 30s\u201d, we can extract the count/sex/age information from the string. And then we can put them into a Pandas data frame for further analysis.", "The core analytics in the above code is the extract()function, which we have to implement. The basic idea is simple \u2014 we can split the string into three substrings, then extract the count, sex, and age accordingly.", "However, the reality is far more complicated and error-prone, just like any web scraping. Because the news texts are generated by humans, even though the format is relatively stable, there are lots of nuances that could vary. Just to name a few:", "After all, the complete implementation can be found in the utils.parse_IL_death_demographic()in this GitHub repo. As a piece of supporting information, I added the link of the news page in the output data frame, so that I can quickly verify the result if necessary. The final output data frame looks like the following:", "After all the hard works above, we obtained the death demographic data frame from the IDPH daily reports. So the web scraping is done. But it\u2019s always a good idea to check the results before declaring a victory. The Pandas pivot_table()provides flexible ways to aggregate data. For example, we can look at the daily death count time series:", "The above plot can be easily verified by the news source, which gives us some confidence about our result.", "Finally, we can take a look at the death demographics. A stacked bar plot by age and sex is a nice representation. This can be done easily by pivoting the data frame in another direction:", "In general, web scraping is not robust, because web pages will change without you knowing it. Therefore, we always prefer a more robust API. But when that is not available, web scraping can serve as another venue to obtain data.", "I want to thank my friend David Tian, a Machine Learning engineer, for his valuable suggestions on this article. Check out his fun self-driving *DeepPiCar* blog.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Engineer, teacher, writer. Loves to explain complex problems in simple terms, and to solve real-world problems by technology."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F9df7488fe84c&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fscraping-coronavirus-death-demographics-with-beautiful-soup-9df7488fe84c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fscraping-coronavirus-death-demographics-with-beautiful-soup-9df7488fe84c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fscraping-coronavirus-death-demographics-with-beautiful-soup-9df7488fe84c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fscraping-coronavirus-death-demographics-with-beautiful-soup-9df7488fe84c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----9df7488fe84c--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----9df7488fe84c--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@jian01.xu?source=post_page-----9df7488fe84c--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@jian01.xu?source=post_page-----9df7488fe84c--------------------------------", "anchor_text": "Jian Xu"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F8d1b81e7d0b1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fscraping-coronavirus-death-demographics-with-beautiful-soup-9df7488fe84c&user=Jian+Xu&userId=8d1b81e7d0b1&source=post_page-8d1b81e7d0b1----9df7488fe84c---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F9df7488fe84c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fscraping-coronavirus-death-demographics-with-beautiful-soup-9df7488fe84c&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F9df7488fe84c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fscraping-coronavirus-death-demographics-with-beautiful-soup-9df7488fe84c&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@markusspiske?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Markus Spiske"}, {"url": "https://unsplash.com/s/photos/scraping-web?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://towardsdatascience.com/a-short-review-of-covid-19-data-sources-ba7f7aa1c342", "anchor_text": "this article"}, {"url": "https://towardsdatascience.com/covid-19-gis-resource-summary-debcba2a000b", "anchor_text": "this article"}, {"url": "https://www.dph.illinois.gov/news/202004", "anchor_text": "Illinois Department of Health daily news"}, {"url": "https://www.dph.illinois.gov/news/202004", "anchor_text": "https://www.dph.illinois.gov/news/202004"}, {"url": "https://github.com/jianxu305/nCov2019_analysis", "anchor_text": "GitHub repo"}, {"url": "https://towardsdatascience.com/deeppicar-part-1-102e03c83f2c", "anchor_text": "DeepPiCar"}, {"url": "https://medium.com/tag/coronavirus?source=post_page-----9df7488fe84c---------------coronavirus-----------------", "anchor_text": "Coronavirus"}, {"url": "https://medium.com/tag/data-science?source=post_page-----9df7488fe84c---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/python?source=post_page-----9df7488fe84c---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/healthcare?source=post_page-----9df7488fe84c---------------healthcare-----------------", "anchor_text": "Healthcare"}, {"url": "https://medium.com/tag/data-visualization?source=post_page-----9df7488fe84c---------------data_visualization-----------------", "anchor_text": "Data Visualization"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F9df7488fe84c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fscraping-coronavirus-death-demographics-with-beautiful-soup-9df7488fe84c&user=Jian+Xu&userId=8d1b81e7d0b1&source=-----9df7488fe84c---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F9df7488fe84c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fscraping-coronavirus-death-demographics-with-beautiful-soup-9df7488fe84c&user=Jian+Xu&userId=8d1b81e7d0b1&source=-----9df7488fe84c---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F9df7488fe84c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fscraping-coronavirus-death-demographics-with-beautiful-soup-9df7488fe84c&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----9df7488fe84c--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F9df7488fe84c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fscraping-coronavirus-death-demographics-with-beautiful-soup-9df7488fe84c&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----9df7488fe84c---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----9df7488fe84c--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----9df7488fe84c--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----9df7488fe84c--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----9df7488fe84c--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----9df7488fe84c--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----9df7488fe84c--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----9df7488fe84c--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----9df7488fe84c--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@jian01.xu?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@jian01.xu?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Jian Xu"}, {"url": "https://medium.com/@jian01.xu/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "106 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F8d1b81e7d0b1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fscraping-coronavirus-death-demographics-with-beautiful-soup-9df7488fe84c&user=Jian+Xu&userId=8d1b81e7d0b1&source=post_page-8d1b81e7d0b1--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fusers%2F8d1b81e7d0b1%2Flazily-enable-writer-subscription&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fscraping-coronavirus-death-demographics-with-beautiful-soup-9df7488fe84c&user=Jian+Xu&userId=8d1b81e7d0b1&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}