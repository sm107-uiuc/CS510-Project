{"url": "https://towardsdatascience.com/real-time-lane-detection-and-alerts-for-autonomous-driving-1f0a021390ee", "time": 1683017765.682938, "path": "towardsdatascience.com/real-time-lane-detection-and-alerts-for-autonomous-driving-1f0a021390ee/", "webpage": {"metadata": {"title": "Real-Time Lane Detection and alerts for Autonomous Driving | by Priya Dwivedi | Towards Data Science", "h1": "Real-Time Lane Detection and alerts for Autonomous Driving", "description": "Autonomous driving is set to revolutionize travel in the coming decade. Autonomous driving applications are currently being tested for a variety of use cases ranging from passenger cars, robot taxis\u2026"}, "outgoing_paragraph_urls": [{"url": "https://github.com/TuSimple/tusimple-benchmark/tree/master/doc/lane_detection", "anchor_text": "TUSimple", "paragraph_index": 5}, {"url": "https://arxiv.org/abs/1505.04597", "anchor_text": "U-Net model", "paragraph_index": 6}, {"url": "https://arxiv.org/abs/1911.02855#:~:text=Dice%20loss%20is%20based%20on,to%20the%20data%2Dimbalance%20issue.&text=With%20the%20proposed%20training%20objective,of%20data%20imbalanced%20NLP%20tasks.", "anchor_text": "their paper", "paragraph_index": 7}, {"url": "https://medium.com/ai-salon/understanding-dice-loss-for-crisp-boundary-detection-bb30c2e5f62b", "anchor_text": "this blog", "paragraph_index": 7}, {"url": "https://arxiv.org/pdf/1807.01726.pdf", "anchor_text": "LaneNet", "paragraph_index": 8}, {"url": "https://github.com/MaybeShewill-CV/lanenet-lane-detection", "anchor_text": "this repo", "paragraph_index": 10}, {"url": "https://github.com/ultralytics/yolov5", "anchor_text": "YOLO-v5", "paragraph_index": 12}, {"url": "https://towardsdatascience.com/yolov5-compared-to-faster-rcnn-who-wins-a771cd6c9fb4", "anchor_text": "here", "paragraph_index": 12}, {"url": "https://deeplearninganalytics.org/", "anchor_text": "Deep Learning Analytics", "paragraph_index": 17}, {"url": "https://deeplearninganalytics.org/contact-us/", "anchor_text": "here", "paragraph_index": 17}], "all_paragraphs": ["Autonomous driving is set to revolutionize travel in the coming decade. Autonomous driving applications are currently being tested for a variety of use cases ranging from passenger cars, robot taxis, automated commercial delivery trucks, smart forklifts and event automated tractors for farming.", "Autonomous driving needs a computer vision perception module to understand and navigate the environment. The role of this perception module among other things is to :", "A good perception system should be able to do this in real-time and in a variety of driving conditions \u2014 day/night, summer/winter, rain/snow etc", "In this blog, we look at a real-time model for detecting lane lines, other vehicles etc and generating alerts.", "The lane detection problem is typically framed as a semantic or instance segmentation problem with the goal of identifying the pixels that belong to the lane class.", "TUSimple is a popular data set for the lane detection task. This data set has 3626 annotated video clips of road scenes. Each clip has 20 frames. The data has been captured from a camera mounted on the car. A sample image and its annotation are shared below.", "On this dataset, we can train a semantic segmentation model to segment out the pixels that belong to the lane class. U-Net model would be an ideal fit here since it is a lightweight model with real-time inference speed. U-Net is an encoder-decoder model with skip connections b/w encoder and decoder blocks. The model architecture is shown below.", "However, the loss function should be modified to a Dice Loss coefficient. The lane line segmentation problem is an extremely imbalanced data problem. The majority of the pixels in the image belong to the background class. Dice Loss is based on Sorenson-Dice coefficient and it attaches similar importance to false positives and false negatives which allows it to perform better for imbalanced data problems. You can read more about the Dice Loss in their paper. The Dice loss tries to match the lane pixels in the ground truth and predicted models and is able to get a crisp boundary prediction. I really enjoyed this blog on using Dice Loss for boundary prediction.", "For this blog, I used the LaneNet model to generate lane lines. The LaneNet model is a two-stage lane line predictor. The first stage is an encoder-decoder model to create a segmentation mask for the lane lines. The second stage is a lane localization network that takes as input the lane points extracted from the mask and uses LSTM to learn a quadratic function that predicts the points for the lane.", "The image below shows the two stages in action. The left panel is the original image, the center panel is the lane mask output from stage 1 and the right panel is the final output from stage 2.", "I used the LaneNet model implementation from this repo. The code is well maintained and runs without errors.", "I have combined the predictions of lane lines with object detection to generate smart alerts. These smart alerts can be related to:", "Here, I have used YOLO-v5 to detect cars and humans on the road. If you are interested in testing YOLO-v5, please check out my blog here.", "YOLO-v5 does quite well in detecting other cars on the road. The inference time is also very fast.", "Below we are using YOLO v5 to measure the distance b/w ego vehicle and the closest vehicle in front. The models return the distance in pixels which can be converted to meters based on the camera parameters. Since camera parameters are not known for the TUSimple data set, I have estimated pixels to meter conversion based on the standard width of lane lines.", "We can similarly calculate the radius of curvature of the lane and use that for the steering module of the car.", "In this blog, we explore the problem of detecting lane lines accurately and quickly for applications in Autonomous Driving. We then use YOLOv5 to build an understanding of other objects on the road. This can be used to generate smart alerts.", "At Deep Learning Analytics, we are extremely passionate about using Machine Learning to solve real-world problems. We have helped many businesses deploy innovative AI-based solutions. Contact us through our website here if you see an opportunity to collaborate.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F1f0a021390ee&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Freal-time-lane-detection-and-alerts-for-autonomous-driving-1f0a021390ee&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Freal-time-lane-detection-and-alerts-for-autonomous-driving-1f0a021390ee&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Freal-time-lane-detection-and-alerts-for-autonomous-driving-1f0a021390ee&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Freal-time-lane-detection-and-alerts-for-autonomous-driving-1f0a021390ee&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----1f0a021390ee--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----1f0a021390ee--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://priya-dwivedi.medium.com/?source=post_page-----1f0a021390ee--------------------------------", "anchor_text": ""}, {"url": "https://priya-dwivedi.medium.com/?source=post_page-----1f0a021390ee--------------------------------", "anchor_text": "Priya Dwivedi"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fb040ce924438&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Freal-time-lane-detection-and-alerts-for-autonomous-driving-1f0a021390ee&user=Priya+Dwivedi&userId=b040ce924438&source=post_page-b040ce924438----1f0a021390ee---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F1f0a021390ee&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Freal-time-lane-detection-and-alerts-for-autonomous-driving-1f0a021390ee&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F1f0a021390ee&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Freal-time-lane-detection-and-alerts-for-autonomous-driving-1f0a021390ee&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://github.com/TuSimple/tusimple-benchmark/tree/master/doc/lane_detection", "anchor_text": "TUSimple"}, {"url": "https://arxiv.org/abs/1505.04597", "anchor_text": "U-Net model"}, {"url": "https://arxiv.org/abs/1911.02855#:~:text=Dice%20loss%20is%20based%20on,to%20the%20data%2Dimbalance%20issue.&text=With%20the%20proposed%20training%20objective,of%20data%20imbalanced%20NLP%20tasks.", "anchor_text": "their paper"}, {"url": "https://medium.com/ai-salon/understanding-dice-loss-for-crisp-boundary-detection-bb30c2e5f62b", "anchor_text": "this blog"}, {"url": "https://arxiv.org/pdf/1807.01726.pdf", "anchor_text": "LaneNet"}, {"url": "https://arxiv.org/pdf/1807.01726.pdf", "anchor_text": "https://arxiv.org/pdf/1807.01726.pdf"}, {"url": "https://github.com/MaybeShewill-CV/lanenet-lane-detection", "anchor_text": "this repo"}, {"url": "https://github.com/ultralytics/yolov5", "anchor_text": "YOLO-v5"}, {"url": "https://towardsdatascience.com/yolov5-compared-to-faster-rcnn-who-wins-a771cd6c9fb4", "anchor_text": "here"}, {"url": "https://deeplearninganalytics.org/", "anchor_text": "Deep Learning Analytics"}, {"url": "https://deeplearninganalytics.org/contact-us/", "anchor_text": "here"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----1f0a021390ee---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----1f0a021390ee---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/self-driving-cars?source=post_page-----1f0a021390ee---------------self_driving_cars-----------------", "anchor_text": "Self Driving Cars"}, {"url": "https://medium.com/tag/data-science?source=post_page-----1f0a021390ee---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/computer-vision?source=post_page-----1f0a021390ee---------------computer_vision-----------------", "anchor_text": "Computer Vision"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F1f0a021390ee&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Freal-time-lane-detection-and-alerts-for-autonomous-driving-1f0a021390ee&user=Priya+Dwivedi&userId=b040ce924438&source=-----1f0a021390ee---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F1f0a021390ee&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Freal-time-lane-detection-and-alerts-for-autonomous-driving-1f0a021390ee&user=Priya+Dwivedi&userId=b040ce924438&source=-----1f0a021390ee---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F1f0a021390ee&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Freal-time-lane-detection-and-alerts-for-autonomous-driving-1f0a021390ee&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----1f0a021390ee--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F1f0a021390ee&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Freal-time-lane-detection-and-alerts-for-autonomous-driving-1f0a021390ee&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----1f0a021390ee---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----1f0a021390ee--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----1f0a021390ee--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----1f0a021390ee--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----1f0a021390ee--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----1f0a021390ee--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----1f0a021390ee--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----1f0a021390ee--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----1f0a021390ee--------------------------------", "anchor_text": ""}, {"url": "https://priya-dwivedi.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://priya-dwivedi.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Priya Dwivedi"}, {"url": "https://priya-dwivedi.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "9.1K Followers"}, {"url": "http://www.deeplearninganalytics.org/", "anchor_text": "http://www.deeplearninganalytics.org/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fb040ce924438&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Freal-time-lane-detection-and-alerts-for-autonomous-driving-1f0a021390ee&user=Priya+Dwivedi&userId=b040ce924438&source=post_page-b040ce924438--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F373349a3bfb7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Freal-time-lane-detection-and-alerts-for-autonomous-driving-1f0a021390ee&newsletterV3=b040ce924438&newsletterV3Id=373349a3bfb7&user=Priya+Dwivedi&userId=b040ce924438&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}