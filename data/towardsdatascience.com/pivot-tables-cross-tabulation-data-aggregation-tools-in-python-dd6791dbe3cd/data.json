{"url": "https://towardsdatascience.com/pivot-tables-cross-tabulation-data-aggregation-tools-in-python-dd6791dbe3cd", "time": 1683008830.357939, "path": "towardsdatascience.com/pivot-tables-cross-tabulation-data-aggregation-tools-in-python-dd6791dbe3cd/", "webpage": {"metadata": {"title": "Pivot Tables \u2014 Data Aggregation Tool in Python | by Tanya | Towards Data Science", "h1": "Pivot Tables \u2014 Data Aggregation Tool in Python", "description": "Exploratory data analysis is an important phase of machine learning projects. The wonderful Pandas library is equipped with several useful functions for this purpose. One among them is pivot_table\u2026"}, "outgoing_paragraph_urls": [{"url": "https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.pivot_table.html", "anchor_text": "pandas.DataFrame.pivot_table", "paragraph_index": 0}, {"url": "https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.pivot_table.html", "anchor_text": "pandas.pivot_table", "paragraph_index": 0}, {"url": "https://www.kaggle.com/tanyadayanand/online-shopping", "anchor_text": "Online Shopping Dataset", "paragraph_index": 2}, {"url": "https://www.kaggle.com/tanyadayanand/multiple-ways-to-effectively-use-the-pivot-table", "anchor_text": "notebook", "paragraph_index": 2}], "all_paragraphs": ["Exploratory data analysis is an important phase of machine learning projects. The wonderful Pandas library is equipped with several useful functions for this purpose. One among them is pivot_table that summarizes a feature\u2019s values in a neat two-dimensional table. The data summarization tool frequently found in data analysis software, offering a ton of flexibility. DataFrame has a pivot_table method (pandas.DataFrame.pivot_table), and additionally, there is a top-level pandas.pivot_table function(any of them can be used as per the convenience, both results in the same output). Most often we end up using pivot_table with the default parameters. This article will help you achieve more by optimal usage of the default parameters.", "The pivot_table() method returns a DataFrame which is an Excel-style pivot table. The pivot table aggregates a table of data by one or more keys, arranging the data in a rectangle with some of the group keys along the rows and some along the columns into a two-dimensional table that provides a multidimensional summarization of the data.", "Let\u2019s look into the basic level usage of this method by applying it on a dataset. Online Shopping Dataset used in the article can be downloaded from Kaggle. To get into the codes directly, an accompanying notebook is published on Kaggle.", "Let\u2019s begin with importing the necessary libraries and loading the dataset. This is a requisite step in every data analysis process.", "Thus, the column Product_Base_Margin has null values.", "At this point, we barely have any idea of what dataset looks like. So let\u2019s now look into the usage of pivot_table() in multiple different ways to explore the data further.", "The index is the column, grouper, array, or list we\u2019d like to group our data by. The simplest pivot table requires a dataframe and an index . The index features will be displayed in the index column in the resultant table. By default, it will average all the numerical columns data when the value and aggfunc parameters are not specified.", "I will be using the Customer_Segment column as the index here:", "The function returns a pivot table with Customer_Segment as index and averages the numerical columns. We can see that the pivot table is smart enough to start aggregating the data and summarizing it by grouping based on Customer_Segment.", "pivot_table can take multiple features as indexes through a list. This increases the level of granularity in the resultant table and we can get more specific with our findings:", "Here the pivot_table is grouping the Product_Category with Customer_Segment and giving us a summarized table of the combinations. Now we start to get a glimpse of what a pivot table can do for us.", "The value parameter is where we tell the function which features to aggregate on. It is an optional field and if we don\u2019t specify this value, then the function will aggregate on all the numerical features of the dataset. In the previous example of indexes, we saw that the aggregation was done for all numerical columns. Since the value parameter was not specified, pivot_table, by default considered all numerical columns.", "Below example compares average Sales across Customer_Segment:", "The Sales column automatically averages the data but we can do a count or a sum as well( by adding a parameter aggfunc and np.sum orcount ).", "Alike index parameter, the values parameter can also take multiple features via a list.", "The pivot table aggregates data of both the features Order_Quantity and Sales and groups it with Customer_Segment.", "As mentioned before, pivot_table uses mean function (numpy.mean) for aggregating or summarizing data by default. But there are other important function or list of functions to consider. aggfunc is an aggregate function that pivot_table applies to our grouped data. aggfunc (optional) accepts a function or list of functions we\u2019d like to use in our group. The aggregation specification can be a string such as 'sum', 'mean', 'count', 'min', 'max', etc or a function that implements an aggregation (e.g. np.sum(), min(), sum(), etc). Now its time to experiment with the aggfunc parameter.", "This first example aggregates values by taking the mean:", "The second example aggregates values by taking the sum. It compares the total number of orders across regions.", "The following example aggregates by taking the sum across multiple columns.", "Not only we can specify what aggregating function we want, but we can also specify more than one aggregating function. For example, if we are interested in both the sum and count of Sales, we can specify the functions as a list to the argument aggfunc. Let\u2019s try it out.", "We can provide a list of aggregate functions to apply to each value too. Below is the example for the same.", "We can use different aggregate functions for different features too. Just provide a dictionary mapping as an input to the aggfunc parameter with the feature name as the key and the corresponding aggregate function as the value.", "In the below example, I will be using sum for the Order_Quantity feature and mean for the Sales feature. Also, notice that I\u2019ve omitted the values keyword; when specifying a mapping for aggfunc, this is determined automatically.", "When we give multiple aggregating functions, we would get a multi-indexed data frame as output.", "The column parameter displays the values horizontally on the top of the resultant table. Most of the time there is confusion with the pivot_table related to the use of columns and values . Bear in mind, columns are optional, they provide a supplementary way to segment the actual values we care about. The aggregation functions are applied to values we list.", "If we want to see Profit broken down by the Customer_Segment, the columns parameter allows us to define one or more columns. Here we are comparing the total profit across product categories and customer segments.", "Using multiple features as indexes is fine, but using some features as columns will help us to quickly understand the relationship between them. Also, the resultant table can always be better viewed by incorporating the columns parameter of the pivot_table.", "Both columns and the index parameters are optional, but using them effectively will help us to intuitively understand the relationship between the features.", "At times it\u2019s useful to compute totals for each grouping. Now, if we want to see some totals of the data, margins=True does that for us. margins is type boolean that adds all rows and columns (e.g. for subtotal / grand totals) and defaults to \u2018False\u2019.", "The margin label can be specified with the margins_name keyword, which defaults to \"All\".margins_name is of type string and accepts the name of the row/column that will contain the totals when margins equal True.", "These two parameters are both optional and often useful to improve the display.", "The NaN\u2019s are a bit distracting. pivot_table helps us to deal with it through the parameters dropna and fill_value. Two of these options, fill_value and dropna, have to do with missing data and are fairly straightforward.", "I will be replacing the NaN values with the mean value from the Product_Base_Margin column:", "We don\u2019t have any columns where all entries are NaN, but it\u2019s worth knowing that if we did pivot_table would drop them by default according to dropna definition.", "Thus, we can see that pivot_table() is a handy tool, and we can do some interesting analysis with this single line of code. As you build up the pivot table, I think it\u2019s easiest to take it one step at a time. Add items and check each step to verify if you are getting the results you expect and see what presentation makes the most sense for your needs. As soon as you start playing with the data and slowly add the items, you can get a feel for how it works.", "We\u2019ve covered the powerful parameters of pivot_table , so you can get a lot out of it if you go experiment using these methods on your project.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "AI & ML Enthusiast | Reshaping with technology"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fdd6791dbe3cd&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpivot-tables-cross-tabulation-data-aggregation-tools-in-python-dd6791dbe3cd&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpivot-tables-cross-tabulation-data-aggregation-tools-in-python-dd6791dbe3cd&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpivot-tables-cross-tabulation-data-aggregation-tools-in-python-dd6791dbe3cd&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpivot-tables-cross-tabulation-data-aggregation-tools-in-python-dd6791dbe3cd&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----dd6791dbe3cd--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----dd6791dbe3cd--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@tanyadayanand?source=post_page-----dd6791dbe3cd--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@tanyadayanand?source=post_page-----dd6791dbe3cd--------------------------------", "anchor_text": "Tanya"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Ff678f7de95fd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpivot-tables-cross-tabulation-data-aggregation-tools-in-python-dd6791dbe3cd&user=Tanya&userId=f678f7de95fd&source=post_page-f678f7de95fd----dd6791dbe3cd---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fdd6791dbe3cd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpivot-tables-cross-tabulation-data-aggregation-tools-in-python-dd6791dbe3cd&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fdd6791dbe3cd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpivot-tables-cross-tabulation-data-aggregation-tools-in-python-dd6791dbe3cd&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@markuswinkler?utm_source=medium&utm_medium=referral", "anchor_text": "Markus Winkler"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.pivot_table.html", "anchor_text": "pandas.DataFrame.pivot_table"}, {"url": "https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.pivot_table.html", "anchor_text": "pandas.pivot_table"}, {"url": "https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.pivot_table.html", "anchor_text": "https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.pivot_table.html"}, {"url": "https://www.kaggle.com/tanyadayanand/online-shopping", "anchor_text": "Online Shopping Dataset"}, {"url": "https://www.kaggle.com/tanyadayanand/multiple-ways-to-effectively-use-the-pivot-table", "anchor_text": "notebook"}, {"url": "https://www.kaggle.com/tanyadayanand/multiple-ways-to-effectively-use-the-pivot-table", "anchor_text": "Multiple ways to effectively use the pivot_table()Explore and run machine learning code with Kaggle Notebooks | Using data from Online Shoppingwww.kaggle.com"}, {"url": "https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.pivot_table.html", "anchor_text": "pandas.DataFrame.pivot_table"}, {"url": "https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.pivot_table.html", "anchor_text": "pandas.pivot_table"}, {"url": "https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.pivot_table.html", "anchor_text": "pandas.DataFrame.pivot_table documentation"}, {"url": "https://medium.com/tag/pivot-tables?source=post_page-----dd6791dbe3cd---------------pivot_tables-----------------", "anchor_text": "Pivot Tables"}, {"url": "https://medium.com/tag/pandas?source=post_page-----dd6791dbe3cd---------------pandas-----------------", "anchor_text": "Pandas"}, {"url": "https://medium.com/tag/data-science?source=post_page-----dd6791dbe3cd---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/eda?source=post_page-----dd6791dbe3cd---------------eda-----------------", "anchor_text": "Eda"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----dd6791dbe3cd---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fdd6791dbe3cd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpivot-tables-cross-tabulation-data-aggregation-tools-in-python-dd6791dbe3cd&user=Tanya&userId=f678f7de95fd&source=-----dd6791dbe3cd---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fdd6791dbe3cd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpivot-tables-cross-tabulation-data-aggregation-tools-in-python-dd6791dbe3cd&user=Tanya&userId=f678f7de95fd&source=-----dd6791dbe3cd---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fdd6791dbe3cd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpivot-tables-cross-tabulation-data-aggregation-tools-in-python-dd6791dbe3cd&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----dd6791dbe3cd--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fdd6791dbe3cd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpivot-tables-cross-tabulation-data-aggregation-tools-in-python-dd6791dbe3cd&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----dd6791dbe3cd---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----dd6791dbe3cd--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----dd6791dbe3cd--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----dd6791dbe3cd--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----dd6791dbe3cd--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----dd6791dbe3cd--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----dd6791dbe3cd--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----dd6791dbe3cd--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----dd6791dbe3cd--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@tanyadayanand?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@tanyadayanand?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Tanya"}, {"url": "https://medium.com/@tanyadayanand/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "68 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Ff678f7de95fd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpivot-tables-cross-tabulation-data-aggregation-tools-in-python-dd6791dbe3cd&user=Tanya&userId=f678f7de95fd&source=post_page-f678f7de95fd--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fc91183103b2b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpivot-tables-cross-tabulation-data-aggregation-tools-in-python-dd6791dbe3cd&newsletterV3=f678f7de95fd&newsletterV3Id=c91183103b2b&user=Tanya&userId=f678f7de95fd&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}