{"url": "https://towardsdatascience.com/an-end-to-end-machine-learning-project-with-python-pandas-keras-flask-docker-and-heroku-c987018c42c7", "time": 1683017502.7391539, "path": "towardsdatascience.com/an-end-to-end-machine-learning-project-with-python-pandas-keras-flask-docker-and-heroku-c987018c42c7/", "webpage": {"metadata": {"title": "An end-to-end machine learning project with Python Pandas, Keras, Flask, Docker and Heroku | by Ryan Lamb | Towards Data Science", "h1": "An end-to-end machine learning project with Python Pandas, Keras, Flask, Docker and Heroku", "description": "At the time of the Rugby World Cup in 2019 I did a small data science project to try and predict rugby match results, which I wrote about here. I\u2019ve expanded this into an example end-to-end machine\u2026"}, "outgoing_paragraph_urls": [{"url": "https://towardsdatascience.com/using-machine-learning-to-predict-sport-scores-a-rugby-world-cup-example-f699fd552673?sk=052e7a0d71f68421a97e1996f3b05727", "anchor_text": "which I wrote about here", "paragraph_index": 0}, {"url": "https://github.com/RyanEricLamb/rugby-score-prediction", "anchor_text": "GitHub here", "paragraph_index": 3}, {"url": "https://rugby-score-prediction.herokuapp.com/", "anchor_text": "the live app can be viewed here", "paragraph_index": 3}, {"url": "https://www.anaconda.com/state-of-data-science-2020", "anchor_text": "Data scientists spend about 45% of their time simply getting data ready for model development", "paragraph_index": 4}, {"url": "https://github.com/pandas-profiling/pandas-profiling", "anchor_text": "Pandas-profiling", "paragraph_index": 7}, {"url": "https://www.espn.co.uk/rugby/", "anchor_text": "ESPN Scrum", "paragraph_index": 8}, {"url": "https://www.world.rugby/tournaments/rankings/mru", "anchor_text": "World Rugby Rankings", "paragraph_index": 8}, {"url": "https://www.microsoft.com/en-us/research/project/trueskill-ranking-system/", "anchor_text": "TrueSkill", "paragraph_index": 8}, {"url": "https://archive.ics.uci.edu/ml/datasets.php#:~:text=%20%20%20Name%20%20%20Default%20Task,%20%20%20%2017%20more%20rows%20", "anchor_text": "UC Irvine\u2019s Machine Learning repository", "paragraph_index": 9}, {"url": "https://www.kaggle.com/datasets", "anchor_text": "Kaggle", "paragraph_index": 9}, {"url": "https://www.crummy.com/software/BeautifulSoup/bs4/doc/", "anchor_text": "BeautifulSoup", "paragraph_index": 9}, {"url": "https://sqlite.org/about.html", "anchor_text": "and the mostly widely deployed in the world", "paragraph_index": 10}, {"url": "https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/", "anchor_text": "here", "paragraph_index": 12}, {"url": "https://www.kdnuggets.com/2019/12/5-techniques-prevent-overfitting-neural-networks.html", "anchor_text": "various techniques to avoid overfitting", "paragraph_index": 13}, {"url": "https://arxiv.org/pdf/1412.6980.pdf", "anchor_text": "efficient gradient descent algorithm", "paragraph_index": 16}, {"url": "https://keras.io/guides/serialization_and_saving/", "anchor_text": "save()", "paragraph_index": 17}, {"url": "https://palletsprojects.com/p/flask/", "anchor_text": "Flask", "paragraph_index": 18}, {"url": "https://towardsdatascience.com/deploying-a-keras-deep-learning-model-as-a-web-application-in-p-fc0f2354a7ff", "anchor_text": "here", "paragraph_index": 18}, {"url": "https://wtforms.readthedocs.io/en/2.3.x/", "anchor_text": "WTForms", "paragraph_index": 20}, {"url": "https://docs.docker.com/get-started/overview/", "anchor_text": "here", "paragraph_index": 24}, {"url": "https://www.heroku.com/home", "anchor_text": "Heroku", "paragraph_index": 25}, {"url": "https://www.linkedin.com/in/ryanericlamb/", "anchor_text": "drop me a message on LinkedIn", "paragraph_index": 28}, {"url": "http://ryanericlamb.com/", "anchor_text": "ryanericlamb.com/", "paragraph_index": 30}], "all_paragraphs": ["At the time of the Rugby World Cup in 2019 I did a small data science project to try and predict rugby match results, which I wrote about here. I\u2019ve expanded this into an example end-to-end machine learning project to demonstrate how to deploy a machine learning model as an interactive web app.", "To provide a high-level overview of the key steps needed in going from raw data to a live deployed machine learning app.", "Once you\u2019ve gone through this \u2014 pick a topic that you\u2019re interested in, find some data, get your hands dirty and aim to build your own machine learning app, from data preparation to deployment.", "The code for this is available on GitHub here and the live app can be viewed here. (Note that this code isn\u2019t necessarily production level, but meant to show what can be done as a starting point. The live app uses a snapshot of data at a specific point in time).", "Data scientists spend about 45% of their time simply getting data ready for model development", "Data wrangling includes cleaning, structuring and enriching your data to get it ready for your machine learning model. For example, dealing with blank data or inconsistent formats.", "Unless you\u2019re using an already clean dataset (which seldom happens in the real world), you\u2019d need to perform Exploratory Data Analysis (EDA) to better understand the data profile.", "Pandas-profiling is an excellent module for EDA. It generates profile reports of DataFrames including quantile and descriptive statistics, correlations, missing values and histograms.", "For this project, I needed data from ESPN Scrum. You can find detailed cleaning steps in the data_prep.py file, for example defining the Match Date format with the to_datetime() method. I also enriched the data with the World Rugby Rankings and a measure of skill using Microsoft\u2019s TrueSkill rating system.", "If you\u2019re looking for datasets to get started, UC Irvine\u2019s Machine Learning repository and Kaggle are good sources to explore. Alternatively you can get data from scraping using BeautifulSoup.", "I stored my DataFrames as tables in a SQLite database. This is a lightweight database and the mostly widely deployed in the world. Plain csv files can of course be used, but this provides an opportunity to learn about SQLite. The code below connects to the match_results database and writes the latest_stats DataFrame to it as a table.", "Now we\u2019ve got the data - time to test and train the machine learning model.", "Mean Squared Error (MSE) was used as a loss function to minimize. Hyperparameter tuning was performed (Jason Brownlee has a tutorial here), and I experimented with both wide (one layer with a lot of neurons) and deep (more layers but fewer neurons per layer) networks until the MSE didn\u2019t improve significantly.", "You want the model to be able to perform well with unseen data. If you overfit your model, you may have a low error on your training data but a high error on your test (unseen) data. When this happens, the model has learned the training data almost too well and cannot generalize to new data. There are various techniques to avoid overfitting.", "Below you can see the MSE decreasing rapidly up until ~25 epochs and then remaining relatively stable for both training and testing data.", "The final model had a first layer of 15 neurons and a second layer of 8 neurons, both with the Rectified Linear Activation Unit (ReLU).", "It was compiled with the Adam optimization algorithm, which is an efficient gradient descent algorithm.", "The save() function is used to save the final Keras model. This saves the model architecture and weights, and will allow us to load the model later on in the app to make predictions on new data.", "Flask is a web framework that can be used for developing web applications relatively quickly. You can find a walk through for quick development here.", "The code below in the app.py file essentially sets up the home page and serves the index.html to the user:", "WTForms is used for the form so that the user can select their two rugby teams. When the button is clicked, the inputs are sent to the saved ML model via the model_predict function. The resulting model predictions are then sent as input variables to the prediction.html template.", "The prediction.html template does three key things:", "And that\u2019s it! In summary, you have:", "Now to deploy your app and share it with the world.", "I won\u2019t go into much detail about Docker but the key thing to know is that it allows you to package your application in a self-sufficient container that can be used across systems i.e. it creates a portable container that makes it easier to deploy your app. You can dig into the details in the official Docker documentation here.", "I used Heroku for hosting because they have a good free tier for non-commercial apps.", "Done! You are ready to share your live machine learning web app.", "Hope this has been helpful to get you started. Feel free to post links to your own ML apps in the comments - would be great to see them.", "If you\u2019d like to collaborate on rugby (or sport) analytics, drop me a message on LinkedIn!", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Business consultant | Data scientist | Chartered Management Accountant (CIMA) \u2014 let\u2019s connect! ryanericlamb.com/"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fc987018c42c7&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fan-end-to-end-machine-learning-project-with-python-pandas-keras-flask-docker-and-heroku-c987018c42c7&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fan-end-to-end-machine-learning-project-with-python-pandas-keras-flask-docker-and-heroku-c987018c42c7&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fan-end-to-end-machine-learning-project-with-python-pandas-keras-flask-docker-and-heroku-c987018c42c7&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fan-end-to-end-machine-learning-project-with-python-pandas-keras-flask-docker-and-heroku-c987018c42c7&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----c987018c42c7--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----c987018c42c7--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@ryanelamb?source=post_page-----c987018c42c7--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@ryanelamb?source=post_page-----c987018c42c7--------------------------------", "anchor_text": "Ryan Lamb"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fadce0c00c3e2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fan-end-to-end-machine-learning-project-with-python-pandas-keras-flask-docker-and-heroku-c987018c42c7&user=Ryan+Lamb&userId=adce0c00c3e2&source=post_page-adce0c00c3e2----c987018c42c7---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc987018c42c7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fan-end-to-end-machine-learning-project-with-python-pandas-keras-flask-docker-and-heroku-c987018c42c7&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc987018c42c7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fan-end-to-end-machine-learning-project-with-python-pandas-keras-flask-docker-and-heroku-c987018c42c7&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://towardsdatascience.com/tagged/hands-on-tutorials", "anchor_text": "Hands-on Tutorials"}, {"url": "https://pixabay.com/users/chrisreadingfoto-2723427/", "anchor_text": "Chris Reading"}, {"url": "https://pixabay.com/photos/team-huddle-togetherness-connection-1928848/", "anchor_text": "Pixabay"}, {"url": "https://towardsdatascience.com/using-machine-learning-to-predict-sport-scores-a-rugby-world-cup-example-f699fd552673?sk=052e7a0d71f68421a97e1996f3b05727", "anchor_text": "which I wrote about here"}, {"url": "https://github.com/RyanEricLamb/rugby-score-prediction", "anchor_text": "GitHub here"}, {"url": "https://rugby-score-prediction.herokuapp.com/", "anchor_text": "the live app can be viewed here"}, {"url": "https://www.anaconda.com/state-of-data-science-2020", "anchor_text": "Data scientists spend about 45% of their time simply getting data ready for model development"}, {"url": "https://github.com/pandas-profiling/pandas-profiling", "anchor_text": "Pandas-profiling"}, {"url": "https://www.espn.co.uk/rugby/", "anchor_text": "ESPN Scrum"}, {"url": "https://www.world.rugby/tournaments/rankings/mru", "anchor_text": "World Rugby Rankings"}, {"url": "https://www.microsoft.com/en-us/research/project/trueskill-ranking-system/", "anchor_text": "TrueSkill"}, {"url": "https://archive.ics.uci.edu/ml/datasets.php#:~:text=%20%20%20Name%20%20%20Default%20Task,%20%20%20%2017%20more%20rows%20", "anchor_text": "UC Irvine\u2019s Machine Learning repository"}, {"url": "https://www.kaggle.com/datasets", "anchor_text": "Kaggle"}, {"url": "https://www.crummy.com/software/BeautifulSoup/bs4/doc/", "anchor_text": "BeautifulSoup"}, {"url": "https://sqlite.org/about.html", "anchor_text": "and the mostly widely deployed in the world"}, {"url": "https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/", "anchor_text": "here"}, {"url": "https://www.kdnuggets.com/2019/12/5-techniques-prevent-overfitting-neural-networks.html", "anchor_text": "various techniques to avoid overfitting"}, {"url": "https://arxiv.org/pdf/1412.6980.pdf", "anchor_text": "efficient gradient descent algorithm"}, {"url": "https://keras.io/guides/serialization_and_saving/", "anchor_text": "save()"}, {"url": "https://palletsprojects.com/p/flask/", "anchor_text": "Flask"}, {"url": "https://towardsdatascience.com/deploying-a-keras-deep-learning-model-as-a-web-application-in-p-fc0f2354a7ff", "anchor_text": "here"}, {"url": "https://wtforms.readthedocs.io/en/2.3.x/", "anchor_text": "WTForms"}, {"url": "https://docs.docker.com/get-started/overview/", "anchor_text": "here"}, {"url": "https://www.docker.com/products/docker-desktop", "anchor_text": "here"}, {"url": "https://docs.docker.com/engine/reference/builder/", "anchor_text": "ockerfile"}, {"url": "https://docs.docker.com/develop/develop-images/dockerfile_best-practices/", "anchor_text": "here"}, {"url": "https://pythonspeed.com/articles/dockerizing-python-is-hard/", "anchor_text": "here"}, {"url": "https://www.heroku.com/home", "anchor_text": "Heroku"}, {"url": "https://devcenter.heroku.com/articles/heroku-cli", "anchor_text": "Heroku CLI"}, {"url": "https://www.linkedin.com/in/ryanericlamb/", "anchor_text": "drop me a message on LinkedIn"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----c987018c42c7---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/python?source=post_page-----c987018c42c7---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/data-science?source=post_page-----c987018c42c7---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/editors-pick?source=post_page-----c987018c42c7---------------editors_pick-----------------", "anchor_text": "Editors Pick"}, {"url": "https://medium.com/tag/hands-on-tutorials?source=post_page-----c987018c42c7---------------hands_on_tutorials-----------------", "anchor_text": "Hands On Tutorials"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fc987018c42c7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fan-end-to-end-machine-learning-project-with-python-pandas-keras-flask-docker-and-heroku-c987018c42c7&user=Ryan+Lamb&userId=adce0c00c3e2&source=-----c987018c42c7---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fc987018c42c7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fan-end-to-end-machine-learning-project-with-python-pandas-keras-flask-docker-and-heroku-c987018c42c7&user=Ryan+Lamb&userId=adce0c00c3e2&source=-----c987018c42c7---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc987018c42c7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fan-end-to-end-machine-learning-project-with-python-pandas-keras-flask-docker-and-heroku-c987018c42c7&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----c987018c42c7--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fc987018c42c7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fan-end-to-end-machine-learning-project-with-python-pandas-keras-flask-docker-and-heroku-c987018c42c7&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----c987018c42c7---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----c987018c42c7--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----c987018c42c7--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----c987018c42c7--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----c987018c42c7--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----c987018c42c7--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----c987018c42c7--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----c987018c42c7--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----c987018c42c7--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@ryanelamb?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@ryanelamb?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Ryan Lamb"}, {"url": "https://medium.com/@ryanelamb/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "170 Followers"}, {"url": "http://ryanericlamb.com/", "anchor_text": "ryanericlamb.com/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fadce0c00c3e2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fan-end-to-end-machine-learning-project-with-python-pandas-keras-flask-docker-and-heroku-c987018c42c7&user=Ryan+Lamb&userId=adce0c00c3e2&source=post_page-adce0c00c3e2--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fusers%2Fadce0c00c3e2%2Flazily-enable-writer-subscription&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fan-end-to-end-machine-learning-project-with-python-pandas-keras-flask-docker-and-heroku-c987018c42c7&user=Ryan+Lamb&userId=adce0c00c3e2&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}