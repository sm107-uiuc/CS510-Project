{"url": "https://towardsdatascience.com/credit-card-fraud-detection-a1c7e1b75f59", "time": 1683000246.590584, "path": "towardsdatascience.com/credit-card-fraud-detection-a1c7e1b75f59/", "webpage": {"metadata": {"title": "Credit Card Fraud Detection. Staying Vigilant in the Virtual World | by Randy Macaraeg | Towards Data Science", "h1": "Credit Card Fraud Detection", "description": "In today\u2019s world, we are on the express train to a cashless society. According to the World Payments Report, in 2016 total non-cash transactions increased by 10.1% from 2015 for a total of 482.6\u2026"}, "outgoing_paragraph_urls": [{"url": "https://github.com/rmacaraeg/CC_Fraud", "anchor_text": "Github", "paragraph_index": 0}, {"url": "https://worldpaymentsreport.com/wp-content/uploads/sites/5/2018/10/World-Payments-Report-2018.pdf", "anchor_text": "World Payments Report", "paragraph_index": 1}, {"url": "https://www.kaggle.com/mlg-ulb/creditcardfraud", "anchor_text": "Kaggle dataset", "paragraph_index": 4}, {"url": "https://towardsdatascience.com/@tonester524", "anchor_text": "Tony Yiu", "paragraph_index": 18}, {"url": "https://towardsdatascience.com/understanding-logistic-regression-using-a-simple-example-163de52ea900", "anchor_text": "Logistic Regression", "paragraph_index": 18}, {"url": "https://towardsdatascience.com/understanding-random-forest-58381e0602d2", "anchor_text": "Random Forest", "paragraph_index": 18}], "all_paragraphs": ["The code for this article can be found on my Github.", "In today\u2019s world, we are on the express train to a cashless society. According to the World Payments Report, in 2016 total non-cash transactions increased by 10.1% from 2015 for a total of 482.6 billion transactions! That\u2019s huge! Also, it\u2019s expected that in future years there will be a steady growth of non-cash transactions as shown below:", "Now, while this might be exciting news, on the flip-side fraudulent transactions are on the rise as well. Even with EMV smart chips being implemented, we still have a very high amount of money lost from credit card fraud:", "What can we do to mitigate the risk? While there are a lot of methods to limit the loss and prevent fraud, and I\u2019ll walk you through my process and show you my findings.", "To start, I gathered my data from a Kaggle dataset which contained 285,000 rows of data and 31 columns. Out of all the columns, the only ones that made the most sense were Time, Amount, and Class (fraud or not fraud). The other 28 columns were transformed using what seems to be a PCA dimensionality reduction in order to protect user identities.", "The data itself is short in terms of time (it\u2019s only 2 days long), and these transactions were made by European cardholders.", "Now that we have the data, I wanted to run a few initial comparisons between the three columns I mentioned earlier (Time, Amount, and Class).", "Given that this distribution is two days\u2019 worth of data, it would follow the trend I\u2019d expect to see for normal consumers. Most purchases are made during the daylight hours, and as people get out of work/school and head home, purchasing dwindles down until the next day.", "While the vast majority of transactions are very low, this distribution is also expected. Most daily transactions aren\u2019t extremely expensive (most are <$50), but it\u2019s likely where most fraudulent transactions are occurring as well.", "In this dataset, there are only 492 fraudulent transactions. That\u2019s only 0.173% of all of the transactions in this dataset! Still, my goal will be to capture as many of those pesky fraudsters as possible.", "I started by making sure there wasn\u2019t any strong collinearity going on in the data by using a heatmap.", "In this example I didn\u2019t add any numbers since it would be really difficult to see for readers. I\u2019m looking for anything that\u2019s showing high correlation, and a few that I spotted were:", "While these correlations are relatively high in comparison to the others, I didn\u2019t feel that it was high enough to run the risk of multicollinearity.", "StandardScaler is a common tool when working with classification problems like this. It transforms the data to where there is a mean of 0 and a standard deviation of 1, thus standardizing the data into a normal distribution. Especially with working on such a wide range of amounts and time, I saw that scaling my data prior to running the tests provided better results.", "I initialized the fit using the training set, then scaled the train, validation, and test sets before running everything into the models.", "Now for the fun stuff! With so many data points to work with, I decided on a 60% train/20% validation/20% test split before I created any models.", "Another issue to address is the highly imbalanced dataset. With so many non-fraudulent transactions in place, I implemented Random Undersampling to decrease the number of non-fraudulent transactions and match it to the amount of fraudulent transactions.", "With this set up, I\u2019m now ready to run the data through some models!", "Special shoutout to Tony Yiu and his Logistic Regression and Random Forest blogs! These blogs were great resources in helping me understand how each one works.", "With the Logistic Regression and Random Forest models, I tried to determine if the data would help the models find the fraudulent transactions.", "Logistic Regression is a statistical model that tries to minimize cost of how wrong a prediction is. Random Forests is an ensemble of decision trees that collectively predict if a transaction is fraudulent or not.", "I ran my data through these two models and got some really good results.", "For this section, I\u2019ll be using these abbreviations in the formulas:", "TP = True Positive. Fraudulent transactions the model predicts as fraudulent.", "TN = True Negative. Normal transactions the model predicts as normal.", "FP = False Positive. Normal transactions the model predicts as fraudulent.", "FN = False Negative. Fraudulent transactions the model predicts as normal.", "Accuracy is one metric for evaluating classification models. It is the fraction of predictions the model gets right. While accuracy might seem to be a good metric to measure how well a model performs, there is a huge downside when using it in this unbalanced dataset. If I were to say all 285,000 transactions were normal transactions (none fraudulent), I\u2019d have a 99.8% accuracy! The problem here, however, is the obvious miss of all the fraudulent transactions. Especially for imbalanced datasets, there are more effective metrics to use.", "Recall answers the question: out of the fraudulent transactions, what percentage of these are correctly identified by our model? In our best model, our recall is 89.9%. This means out of all of the data, it correctly identifies 89.9% of all fraudulent transactions. This could be improved but I feel it\u2019s a good starting point.", "Precision answers the question: out of all the transactions predicted to be fraudulent, what percentage were actually fraudulent? In our best model, 97.8% of all fraudulent transactions are captured. This is a really good metric!", "The F1 score combines Recall and Precision into one metric as a weighted average of the two. Unlike Recall and Precision individually, F1 takes both false positives and false negatives into consideration. In imbalanced classes such as this, F1 is much more effective than accuracy at determining the performance of the model.", "After training each of the models, these are the final results. All of the scores for Logistic Regression and the Random Forest models are very promising for our dataset! Each model has a high true positive rate and a low false positive rate, which is exactly what we\u2019re looking for.", "Lastly, I\u2019ll go over the ROC curve, the Confusion Matrix, and how each model stacks up.", "The ROC is a performance measurement for classification problems at various thresholds. It is essentially a probability curve, and the higher the Area Under the Curve (AUC) score the better the model is at predicting fraudulent/non-fraudulent transactions.", "In the graph above, the AUC scores for Logistic Regression and Random Forest are pretty high, which is what we\u2019d like to see. It\u2019s important to note that each point on the curve indicates a threshold. As we move further right along the curve, we both capture more True Positives but also incur more False Positives. This means we capture more fraudulent transactions, but also flag even more normal transactions as fraudulent. From the table in the previous section, the ideal thresholds found were:", "At these thresholds, we capture the optimal amount of fraudulent transactions while keeping False Positives as low as possible. With these thresholds, we can visualize the effects of each model using a Confusion Matrix:", "With a threshold of 0.842 in this out-of-sample test set, We capture 88 of the 98 fraudulent transactions, and mistakenly mark 1,669 transactions as fraudulent. I\u2019d imagine these cases are like when I go to another state without telling my bank I\u2019m traveling, and they send me a text asking for confirmation after I use my card to buy some coffee.", "At a threshold of 0.421, the Random Forest model has similar results to the Logistic Regression model. The Random Forest model captures 88/98 fraudulent transactions, but it indicates 9 more normal transactions as fraudulent in comparison to Logistic Regression. Both models are still promising and give good results in the end.", "Finding fraudulent credit card transactions is really important, especially in today\u2019s society. There are lots of methods to capture these instances, and it\u2019s really cool to see how companies deal with this on a day-to-day basis.", "I love finding anomalies, so going through this project was a lot of fun for me. I hope I was able to explain my findings well and thanks so much for reading!", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fa1c7e1b75f59&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcredit-card-fraud-detection-a1c7e1b75f59&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcredit-card-fraud-detection-a1c7e1b75f59&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcredit-card-fraud-detection-a1c7e1b75f59&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcredit-card-fraud-detection-a1c7e1b75f59&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----a1c7e1b75f59--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----a1c7e1b75f59--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@randysm?source=post_page-----a1c7e1b75f59--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@randysm?source=post_page-----a1c7e1b75f59--------------------------------", "anchor_text": "Randy Macaraeg"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F41571626b7fd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcredit-card-fraud-detection-a1c7e1b75f59&user=Randy+Macaraeg&userId=41571626b7fd&source=post_page-41571626b7fd----a1c7e1b75f59---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa1c7e1b75f59&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcredit-card-fraud-detection-a1c7e1b75f59&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa1c7e1b75f59&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcredit-card-fraud-detection-a1c7e1b75f59&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@alesnesetril?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Ales Nesetril"}, {"url": "https://unsplash.com/search/photos/credit-card?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://github.com/rmacaraeg/CC_Fraud", "anchor_text": "Github"}, {"url": "https://worldpaymentsreport.com/wp-content/uploads/sites/5/2018/10/World-Payments-Report-2018.pdf", "anchor_text": "World Payments Report"}, {"url": "https://www.creditcards.com/credit-card-news/credit-card-security-id-theft-fraud-statistics-1276.php", "anchor_text": "CC Fraud Report from CreditCards.com"}, {"url": "https://www.kaggle.com/mlg-ulb/creditcardfraud", "anchor_text": "Kaggle dataset"}, {"url": "https://towardsdatascience.com/@tonester524", "anchor_text": "Tony Yiu"}, {"url": "https://towardsdatascience.com/understanding-logistic-regression-using-a-simple-example-163de52ea900", "anchor_text": "Logistic Regression"}, {"url": "https://towardsdatascience.com/understanding-random-forest-58381e0602d2", "anchor_text": "Random Forest"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----a1c7e1b75f59---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----a1c7e1b75f59---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/business?source=post_page-----a1c7e1b75f59---------------business-----------------", "anchor_text": "Business"}, {"url": "https://medium.com/tag/technology?source=post_page-----a1c7e1b75f59---------------technology-----------------", "anchor_text": "Technology"}, {"url": "https://medium.com/tag/programming?source=post_page-----a1c7e1b75f59---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fa1c7e1b75f59&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcredit-card-fraud-detection-a1c7e1b75f59&user=Randy+Macaraeg&userId=41571626b7fd&source=-----a1c7e1b75f59---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fa1c7e1b75f59&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcredit-card-fraud-detection-a1c7e1b75f59&user=Randy+Macaraeg&userId=41571626b7fd&source=-----a1c7e1b75f59---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa1c7e1b75f59&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcredit-card-fraud-detection-a1c7e1b75f59&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----a1c7e1b75f59--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fa1c7e1b75f59&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcredit-card-fraud-detection-a1c7e1b75f59&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----a1c7e1b75f59---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----a1c7e1b75f59--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----a1c7e1b75f59--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----a1c7e1b75f59--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----a1c7e1b75f59--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----a1c7e1b75f59--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----a1c7e1b75f59--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----a1c7e1b75f59--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----a1c7e1b75f59--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@randysm?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@randysm?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Randy Macaraeg"}, {"url": "https://medium.com/@randysm/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "276 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F41571626b7fd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcredit-card-fraud-detection-a1c7e1b75f59&user=Randy+Macaraeg&userId=41571626b7fd&source=post_page-41571626b7fd--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F6290336f38d1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcredit-card-fraud-detection-a1c7e1b75f59&newsletterV3=41571626b7fd&newsletterV3Id=6290336f38d1&user=Randy+Macaraeg&userId=41571626b7fd&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}