{"url": "https://towardsdatascience.com/a-swift-introduction-to-flux-for-julia-with-cuda-9d87c535312c", "time": 1683004223.490647, "path": "towardsdatascience.com/a-swift-introduction-to-flux-for-julia-with-cuda-9d87c535312c/", "webpage": {"metadata": {"title": "A Swift Introduction To Flux For Julia (With CUDA) | by Emma Boudreau | Towards Data Science", "h1": "A Swift Introduction To Flux For Julia (With CUDA)", "description": "Machine learning in Julia has come a long way since the classic Mocha.jl days, and one of the most groundbreaking creations contributing to that ecosystem is Flux.jl. Flux is the definitive gradient\u2026"}, "outgoing_paragraph_urls": [], "all_paragraphs": ["Machine learning in Julia has come a long way since the classic Mocha.jl days, and one of the most groundbreaking creations contributing to that ecosystem is Flux.jl. Flux is the definitive gradient descent library for Julia and can be compared to something like Tensorflow for Python. Flux follows a similar concept to a lot of Julia packages like Lathe.jl and DataFrames.jl, being only written in around one-thousand lines of code, and relying on only Julia itself. Compare this to solutions like Tensorflow and Pytorch, both of which use various languages including C++, Go, and C.", "One great thing about Julia is just how seamlessly tethered parallel computing platforms and multi-threading are with the language. Nowhere is this more visualized (get it?) than the venerable platform for NVIDIA graphics processors, CUDA. The tight integration between Julia and your hardware continues very well into Flux, making Flux and CUDA a true match made in heaven. Set that zero flag to one in the machine-code and buckle-up, because this is positively going to be exciting!", "For my sample data today, I chose to go with a data-set from MLDatasets.jl, which is a product of the lovely Julia Computing, you can add it using Pkg:", "or alternatively, in the Pkg REPL:", "I don\u2019t usually select data-sets from packages that are commonly used, but I made this exception to ensure that this code would be reproducible without any downloads (at least not through your web-browser). The dataset I\u2019m going to be using is the Fashion MINST data-set, which we can download like so:", "Optionally you could also add a validation set, or split your own data-set with Lathe:", "Since my data-set works with images, it might behoove me to convert the data into an image from its respective file format, which we can do like this:", "First, we are going to need to import Flux itself:", "I also directly imported several modules from Flux including onehotbatch, onecold, crossentropy, throttle, and params, as well as the mean function from Lathe.stats, partition from Julia\u2019s Iterators, and Random. All of these are the pieces of the puzzle we can use to make our Flux model. The next step will be to construct a model chain. This is where Flux really shines because unlike most other machine-learning libraries, Flux\u2019s gradient layers work using chains. Flux uses a combination of various unique and awesome syntax points inside of the Julia language to create a very elegant machine-learning environment, and chain is a great example of this.", "Next, we\u2019re going to need to get N for our train data:", "Now we can use N to randomly shuffle and permute our train indexes with range iteration:", "Something important to note here is that our data is going to need to be stored in sub-arrays, or dictionaries. Given that this will work with dictionaries, it will most likely work with DataFrames as well. After putting our data into a format that Flux\u2019s batching can take, we can batch our data like so:", "Now we simply construct our model with an anticipated return:", "I didn\u2019t bother hyper-parameter tuning for this particular model, so it is very likely that accuracy could be increased with just a bit of optimization.", "Next, we need a metric function that will allow our model to detect when it is doing good or bad. To do this we will need three big parts:", "The attempt is what I like to call the initial guess before the network has learned anything. Validation is an essential step of the process where the model needs to detect whether it has gotten more accurate, or less accurate. Last, but not least, reconstruction is the recursive process where the guess is recovered and learned from. Here is my function:", "And then we can plug all of these pieces into syntactical expressions:", "And now we can check out our accuracy using our same metric function:", "Flux\u2019s syntax, expressions, and speed make it a very valuable tool for Data Scientists working in Julia. Flux blows away the competition in many tests because of its compact size, simplicity, speed, and effectiveness. Another massive benefit to Flux is just how modular models can be, as I illustrated by building the layers of my network in a chain and then passing more built-ins onto them. Overall I\u2019m excited about the development coming to Flux as well as Julia as a whole for machine-learning and statistics. If you\u2019re interested in Flux, another cool thing you might be interested in is KNet, and I\u2019m going to be writing \u201c A Swift Introduction\u201d into that pretty soon! Something you could go and check out for yourself now is Metalhead.jl, which is an image classifier written in Flux that can be fit with new data and recycled for any classification use-case.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F9d87c535312c&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-swift-introduction-to-flux-for-julia-with-cuda-9d87c535312c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-swift-introduction-to-flux-for-julia-with-cuda-9d87c535312c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-swift-introduction-to-flux-for-julia-with-cuda-9d87c535312c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-swift-introduction-to-flux-for-julia-with-cuda-9d87c535312c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----9d87c535312c--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----9d87c535312c--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://emmettgb.medium.com/?source=post_page-----9d87c535312c--------------------------------", "anchor_text": ""}, {"url": "https://emmettgb.medium.com/?source=post_page-----9d87c535312c--------------------------------", "anchor_text": "Emma Boudreau"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fea170050148c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-swift-introduction-to-flux-for-julia-with-cuda-9d87c535312c&user=Emma+Boudreau&userId=ea170050148c&source=post_page-ea170050148c----9d87c535312c---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F9d87c535312c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-swift-introduction-to-flux-for-julia-with-cuda-9d87c535312c&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F9d87c535312c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-swift-introduction-to-flux-for-julia-with-cuda-9d87c535312c&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://medium.com/tag/programming?source=post_page-----9d87c535312c---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/tag/julia?source=post_page-----9d87c535312c---------------julia-----------------", "anchor_text": "Julia"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----9d87c535312c---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/cuda?source=post_page-----9d87c535312c---------------cuda-----------------", "anchor_text": "Cuda"}, {"url": "https://medium.com/tag/data-science?source=post_page-----9d87c535312c---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F9d87c535312c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-swift-introduction-to-flux-for-julia-with-cuda-9d87c535312c&user=Emma+Boudreau&userId=ea170050148c&source=-----9d87c535312c---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F9d87c535312c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-swift-introduction-to-flux-for-julia-with-cuda-9d87c535312c&user=Emma+Boudreau&userId=ea170050148c&source=-----9d87c535312c---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F9d87c535312c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-swift-introduction-to-flux-for-julia-with-cuda-9d87c535312c&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----9d87c535312c--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F9d87c535312c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-swift-introduction-to-flux-for-julia-with-cuda-9d87c535312c&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----9d87c535312c---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----9d87c535312c--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----9d87c535312c--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----9d87c535312c--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----9d87c535312c--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----9d87c535312c--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----9d87c535312c--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----9d87c535312c--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----9d87c535312c--------------------------------", "anchor_text": ""}, {"url": "https://emmettgb.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://emmettgb.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Emma Boudreau"}, {"url": "https://emmettgb.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "4.6K Followers"}, {"url": "https://twitter.com/emmettboudgie", "anchor_text": "https://twitter.com/emmettboudgie"}, {"url": "https://github.com/emmettgb", "anchor_text": "https://github.com/emmettgb"}, {"url": "https://ems.computer/", "anchor_text": "https://ems.computer/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fea170050148c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-swift-introduction-to-flux-for-julia-with-cuda-9d87c535312c&user=Emma+Boudreau&userId=ea170050148c&source=post_page-ea170050148c--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Ff16bf42bb45f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-swift-introduction-to-flux-for-julia-with-cuda-9d87c535312c&newsletterV3=ea170050148c&newsletterV3Id=f16bf42bb45f&user=Emma+Boudreau&userId=ea170050148c&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}