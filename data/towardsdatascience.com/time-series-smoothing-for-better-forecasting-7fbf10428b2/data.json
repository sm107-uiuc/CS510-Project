{"url": "https://towardsdatascience.com/time-series-smoothing-for-better-forecasting-7fbf10428b2", "time": 1683013906.737066, "path": "towardsdatascience.com/time-series-smoothing-for-better-forecasting-7fbf10428b2/", "webpage": {"metadata": {"title": "Time Series Smoothing for better Forecasting | by Marco Cerliani | Towards Data Science", "h1": "Time Series Smoothing for better Forecasting", "description": "In time series forecasting, the presence of dirty and messy data can hurt the final predictions. This is true, especially in this domain, because the temporal dependency plays a crucial role when\u2026"}, "outgoing_paragraph_urls": [{"url": "https://github.com/cerlymarco/tsmoothie", "anchor_text": "tsmoothie", "paragraph_index": 1}, {"url": "https://github.com/cerlymarco/tsmoothie", "anchor_text": "Tsmoothie", "paragraph_index": 1}, {"url": "https://www.kaggle.com/fvcoppen/solarpanelspower", "anchor_text": "Kaggle", "paragraph_index": 3}, {"url": "https://github.com/cerlymarco/tsmoothie", "anchor_text": "Tsmoothie", "paragraph_index": 8}, {"url": "https://github.com/cerlymarco/keras-hypetune", "anchor_text": "keras-hypetune", "paragraph_index": 12}], "all_paragraphs": ["In time series forecasting, the presence of dirty and messy data can hurt the final predictions. This is true, especially in this domain, because the temporal dependency plays a crucial role when dealing with temporal sequences.", "Noise or outliers must be handled with care following ad-hoc solutions. In this situation, the tsmoothie package can help us save a lot of time in preparing time series for our analysis. Tsmoothie is a python library for time series smoothing and outlier detection that can handle multiple series in a vectorized way. It\u2019s useful because it can provide the preprocess steps we needed, like denoising or outlier removal, preserving the temporal pattern present in our raw data.", "In this post, we use these trinks to improve a forecasting task. More precisely, we try to forecast the daily power production of solar panels. In the end, we will expect to benefit from our denoising procedure and produce better predictions than the case without preprocessing.", "A real dataset for our purpose is available on Kaggle. This data stores the daily power production of solar panels installed on the roof of a private house. The data are recorded since 2011 and present 3 different sources in a time series format:", "As we can notice from the plot of the raw series, a lot of noise is present. This is normal for data registered by sensors. The situation is worse if our data sources suffer the external meteorological conditions or if the sensors are not of good quality and locate in not optimal positions.", "Fortunately, we have the knowledge and the instruments to achieve good results for our forecasting task.", "The first step in our workflow consists of time series preprocessing. Our strategy is very intuitive and effective. We take the target time series (power production) and smooth it with a fantastic instrument: the Kalman Filter, a must to know for every data scientist.", "Generally speaking, the great advantage of using the Kalman Filter, in time series tasks, is the possibility to use a state-space form to represent an unobserved component model. The scope of representing time series models in the state-space form is the availability of a set of general algorithms (including Kalman Filter), for the computation of the Gaussian likelihood, which can be numerically maximized to obtain the maximum likelihood estimation of the model\u2019s parameters. It\u2019s no accident that famous software use this representation to fit models like ARIMA. In our particular case, we use the Kalman Filter and a state-space representation to build an unobserved component model.", "All that explained so far can sound tricky but I want to reassure you\u2026 Tsmoothie can easily build unobserved component models to operate a custom Kalman smoothing in a very simple and efficient way. At this stage, we can free our imagination and detect which components from level, trend, seasonality, long seasonality contributes to create the time series we are observing. A level and a long seasonality of 365 days sound good for us. We simply add a \u2018confidence\u2019 for each component assumption and we have finished.", "The resulting smoothed time series holds the same temporal pattern present in the raw data but with a consistent and rational noise reduction.", "PRO TIP: If our series presents NaNs it\u2019s not a problem, this procedure works extremely well and it\u2019s a very powerful instrument to fill missing gaps in our data\u2026 this is the beauty of Kalman smoothing.", "The second step involves the building of a neural network structure to forecast the next days\u2019 power production. Firstly we fit a model on the raw data and secondly, we try fitting on the smoothed series. The smoothing data is used only as a target variable, all the input series remain in the original format. The usage of a smoothed label is aimed to help the model to better catch the real patterns and discard the noise.", "We choose an LSTM autoencoder to forecast the next 5 daily values of power production. The training procedure is carried out using keras-hypetune. This framework provides hyperparameter optimization of the neural network structures in a very intuitive way. We operate a grid search of some parameter combinations. This is done for all the two training involved.", "As we can imagine the prediction errors are in function of the time horizons. The predictions of the next day are more accurate than the predictions for the next five days. The important point is that the smoothing procedure provides a great benefit in terms of prediction accuracy for all the time forecasting horizons.", "In this post, we took advantage of the time series smoothing in a forecasting scenario. We applied the Kalman Filter to smooth our raw data and reduce the presence of noise. This choice proved to be advantageous in terms of forecasting accuracy. I want to point out also the power of the Kalman Filter in this application and its ability to be a good instrument when building unobserved component models.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F7fbf10428b2&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftime-series-smoothing-for-better-forecasting-7fbf10428b2&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftime-series-smoothing-for-better-forecasting-7fbf10428b2&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftime-series-smoothing-for-better-forecasting-7fbf10428b2&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftime-series-smoothing-for-better-forecasting-7fbf10428b2&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----7fbf10428b2--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----7fbf10428b2--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@cerlymarco?source=post_page-----7fbf10428b2--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@cerlymarco?source=post_page-----7fbf10428b2--------------------------------", "anchor_text": "Marco Cerliani"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fc843902314c7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftime-series-smoothing-for-better-forecasting-7fbf10428b2&user=Marco+Cerliani&userId=c843902314c7&source=post_page-c843902314c7----7fbf10428b2---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F7fbf10428b2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftime-series-smoothing-for-better-forecasting-7fbf10428b2&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F7fbf10428b2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftime-series-smoothing-for-better-forecasting-7fbf10428b2&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@notevilbird?utm_source=medium&utm_medium=referral", "anchor_text": "Aleksandr Eremin"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://github.com/cerlymarco/tsmoothie", "anchor_text": "tsmoothie"}, {"url": "https://github.com/cerlymarco/tsmoothie", "anchor_text": "Tsmoothie"}, {"url": "https://www.kaggle.com/fvcoppen/solarpanelspower", "anchor_text": "Kaggle"}, {"url": "https://github.com/cerlymarco/tsmoothie", "anchor_text": "Tsmoothie"}, {"url": "https://github.com/cerlymarco/keras-hypetune", "anchor_text": "keras-hypetune"}, {"url": "https://github.com/cerlymarco/MEDIUM_NoteBook", "anchor_text": "CHECK MY GITHUB REPO"}, {"url": "https://www.linkedin.com/in/marco-cerliani-b0bba714b/", "anchor_text": "Linkedin"}, {"url": "https://medium.com/tag/data-science?source=post_page-----7fbf10428b2---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----7fbf10428b2---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/time-series-forecasting?source=post_page-----7fbf10428b2---------------time_series_forecasting-----------------", "anchor_text": "Time Series Forecasting"}, {"url": "https://medium.com/tag/neural-networks?source=post_page-----7fbf10428b2---------------neural_networks-----------------", "anchor_text": "Neural Networks"}, {"url": "https://medium.com/tag/editors-pick?source=post_page-----7fbf10428b2---------------editors_pick-----------------", "anchor_text": "Editors Pick"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F7fbf10428b2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftime-series-smoothing-for-better-forecasting-7fbf10428b2&user=Marco+Cerliani&userId=c843902314c7&source=-----7fbf10428b2---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F7fbf10428b2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftime-series-smoothing-for-better-forecasting-7fbf10428b2&user=Marco+Cerliani&userId=c843902314c7&source=-----7fbf10428b2---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F7fbf10428b2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftime-series-smoothing-for-better-forecasting-7fbf10428b2&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----7fbf10428b2--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F7fbf10428b2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftime-series-smoothing-for-better-forecasting-7fbf10428b2&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----7fbf10428b2---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----7fbf10428b2--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----7fbf10428b2--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----7fbf10428b2--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----7fbf10428b2--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----7fbf10428b2--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----7fbf10428b2--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----7fbf10428b2--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----7fbf10428b2--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@cerlymarco?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@cerlymarco?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Marco Cerliani"}, {"url": "https://medium.com/@cerlymarco/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "6K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fc843902314c7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftime-series-smoothing-for-better-forecasting-7fbf10428b2&user=Marco+Cerliani&userId=c843902314c7&source=post_page-c843902314c7--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fe2412974851a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftime-series-smoothing-for-better-forecasting-7fbf10428b2&newsletterV3=c843902314c7&newsletterV3Id=e2412974851a&user=Marco+Cerliani&userId=c843902314c7&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}