{"url": "https://towardsdatascience.com/new-approaches-to-object-detection-f5cbc925e00e", "time": 1683013222.687806, "path": "towardsdatascience.com/new-approaches-to-object-detection-f5cbc925e00e/", "webpage": {"metadata": {"title": "New Approaches to Object Detection | by Libor Vanek | Towards Data Science", "h1": "New Approaches to Object Detection", "description": "I will start with a short introduction of different approaches to object detection. After both traditional and newer approaches are presented, you can read about the most important parts of CenterNet\u2026"}, "outgoing_paragraph_urls": [{"url": "https://github.com/Ximilar-com/xcenternet", "anchor_text": "GitHub", "paragraph_index": 0}, {"url": "https://arxiv.org/abs/1311.2524", "anchor_text": "R-CNN", "paragraph_index": 2}, {"url": "https://arxiv.org/abs/1504.08083", "anchor_text": "Fast R-CNN", "paragraph_index": 2}, {"url": "https://arxiv.org/abs/1506.01497", "anchor_text": "R-CNN", "paragraph_index": 2}, {"url": "https://arxiv.org/abs/1506.02640", "anchor_text": "YOLO \u2014 You Only Look Once", "paragraph_index": 3}, {"url": "https://arxiv.org/abs/2004.10934", "anchor_text": "version 4", "paragraph_index": 3}, {"url": "https://medium.com/r?url=https%3A%2F%2Farxiv.org%2Fabs%2F1512.02325", "anchor_text": "SSD \u2014 Single Shot multibox Detector", "paragraph_index": 3}, {"url": "https://arxiv.org/abs/1808.01244", "anchor_text": "CornerNet: Detecting Objects as Paired Keypoints", "paragraph_index": 4}, {"url": "https://arxiv.org/abs/1904.07850", "anchor_text": "Objects as Points", "paragraph_index": 5}, {"url": "https://arxiv.org/abs/1909.00700", "anchor_text": "TTFNet", "paragraph_index": 6}, {"url": "https://github.com/Ximilar-com/xcenternet", "anchor_text": "package", "paragraph_index": 6}, {"url": "https://arxiv.org/abs/1603.06937", "anchor_text": "Hourglass network", "paragraph_index": 8}, {"url": "https://arxiv.org/abs/1703.06211", "anchor_text": "Deformable Convolutions", "paragraph_index": 16}, {"url": "https://www.tensorflow.org/addons", "anchor_text": "TensorFlow Addons", "paragraph_index": 17}, {"url": "https://github.com/smallsunsun1/addons/tree/feature/deformable_ops", "anchor_text": "a fork of TFA", "paragraph_index": 17}, {"url": "https://github.com/tensorflow/addons/pull/1129", "anchor_text": "1129", "paragraph_index": 17}, {"url": "https://arxiv.org/abs/1708.02002", "anchor_text": "focal loss", "paragraph_index": 19}, {"url": "https://giou.stanford.edu/", "anchor_text": "Generalized Intersection over Union loss", "paragraph_index": 21}, {"url": "https://arxiv.org/abs/1911.08287", "anchor_text": "Distance-IoU Loss", "paragraph_index": 21}, {"url": "https://github.com/Ximilar-com/xcenternet", "anchor_text": "GitHub", "paragraph_index": 22}, {"url": "https://github.com/Cospel", "anchor_text": "Michal Lukac", "paragraph_index": 22}, {"url": "https://www.ximilar.com/", "anchor_text": "Ximilar", "paragraph_index": 22}, {"url": "https://www.ximilar.com/how-to-train-an-object-detection-model-with-one-click/", "anchor_text": "this blog post", "paragraph_index": 22}, {"url": "https://app.ximilar.com", "anchor_text": "Ximilar App", "paragraph_index": 22}], "all_paragraphs": ["I will start with a short introduction of different approaches to object detection. After both traditional and newer approaches are presented, you can read about the most important parts of CenterNet and TTFNet. Many ideas in both models are similar, therefore they will be introduced together. We implemented a package inspired by both networks. Please check our GitHub if you are interested.", "Basic knowledge of deep learning and convolutional neural networks (CNNs) is required.", "As often in computer science, when we have a difficult problem without a solution, we try to change it to a problem whose solution we know or which is more simple. Good examples are so-called two-stage detection models. In this case, the more simple problem is an image classification or tagging. (Placing given image to a category or assigning tags to given image) Simply put, we can divide the image into multiple regions and then classify those, right? Yes \u2026 but it will take a lot of time. Therefore you need to be clever about it. An example of algorithms which uses this approach is R-CNN (2014). Which later evolved into Fast R-CNN (2015) and even Faster R-CNN (2016).", "Even though performance of those models is quite good, researchers were obviously asking themselves if this process can be made simple and therefore more efficient. In one stage, without the region proposals. One possible answer to this question is YOLO \u2014 You Only Look Once (2015). Which is now in the version 4 (2020). Or SSD \u2014 Single Shot multibox Detector (2015). Finally, RetinaNet (2017) should be mentioned as well, especially because it was used to introduced a focal loss for object detection, which is now used very often.", "In recent years, another idea has been gaining popularity. The object can be transformed to a set of points. And the detection task can be thought of as a keypoint estimation problem. This approach is introduced in CornerNet: Detecting Objects as Paired Keypoints. As the name suggests, an object is represented as a pair of keypoints, the top-left corner and the bottom-right corner.", "Similar idea is explored in Objects as Points paper, introducing CenterNet. There, we detect the center point of a bounding box using a heat map. Other properties such as size of the bounding box are predicted directly using regression.", "Weakness of this approach is a slower training. To address this issue, TTFNet (Training-Time-Friendly Network) was proposed. It follows the same basic ideas, therefore we decided to implement ideas from both networks in one package.", "Let\u2019s dive in! I will start from top, introducing you to the network layout. Then, important individual parts will be discussed, mainly the heatmaps and different loss functions.", "We can use either some network designed specifically for this kind of task. For example the Hourglass network. Or, as we have decided to do, take one of the standard image classification CNNs and modify it to our needs. We have chosen to test ResNet (18, 50) and EfficientNet (b0, b1, b2).", "As in all standard transfer learning tasks, we discarded the top dense layer. But the layer left at the top does not even remotely fit the output we need. Therefore, some upsampling is necessary. In addition to that, connections from lower layers improves the performance. When we have a layer of a correct size at the end of our network, we can \u201csplit\u201d it into the desired number of heads.", "In order to make the network faster, the heatmap side is just 1/4 of the input image. We have one heatmap per every class. Then, there are two other heads in CenterNet (for basic object detection) and one in TTFNet.", "Both have only two filters \u2014 there could be only single object at any given point of the heatmap. If you are interested in other properties of an object, more heads can be added.", "In TTFNet, there is only one additional head with four filters to calculate the size \u2014 distances to the sides of an object.", "So, what does a heatmap look like? It is a matrix filled with values from 0.0 to 1.0. Peaks on such a map indicates the presence of of some object.", "Bellow, you see some generated training heatmaps. There is just one point with exactly 1.0. Around this point, the probabilities are slowly vanishing.", "The upsampling part of the network can be done in multiple ways. We have shown you the simple approach with concatenations, upsampling and standard convolutional layers. To improve the performance, deformable convolutions are used.", "There is not doubt that convolutional neural networks brought a great revolution to deep learning. They enabled us to extract feature which would be really hard to get from fully connected layers. And together with another layout improvements, out networks could become really deep. Nevertheless, the basic idea is still the same. Especially, the shape of the filters is always rectangular. Deformable Convolutions are trying to improve on that. They learn an offset to the standard grid and performs the convolutions with this \u201cdeformed\u201d kernel.", "Unfortunately, deformable convolutional layers are not yet implemented in TensorFlow nor TensorFlow Addons (TFA). We are using a fork of TFA with support for Deformable Conv2d and hoping it will be merged soon. (See pull request 1129.)", "Now, when we have the network layout and how the outputs look like, only one crucial thing is missing. Loss Functions.", "There is one problem with heatmaps \u2014 they are very sparse. Mostly there are no detection (zeros), only very occasionally we see an object (one, decreasing values in the surrounding). Standard metrics do not work very well in this setting. Fortunately, there is a solution \u2014 a focal loss. It is used in both CenteNet and TTFNet.", "To optimize bounding box size, CenterNet uses L1 loss. It is a simple sum of differences between true and predicted bounding box coordinates. It seems reasonable, but on the other hand, we do not use it for evaluation very often. We use IoU metric \u2014 Intersection over Union. So when we are interested in improving this metrics, why not use it for optimization as well? We can turn it to a loss by subtracting the IoU value from one. Or not?", "Unfortunately, the IoU is zero if there is no intersection. Therefore the loss is always one in such case. Two loss functions based on IoU were proposed. Generalized Intersection over Union loss, used in TTFNet, addresses this problem. Distance-IoU Loss focuses also on adding a distance information into the function, in other words, how far from the center of the bounding box we are.", "You can find our implementation on GitHub. I would like to thank Michal Lukac for working with me on this project, Ximilar for allowing us to opensource it. If you want to try the model without any coding, please check this blog post about object detection in Ximilar App.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Ff5cbc925e00e&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnew-approaches-to-object-detection-f5cbc925e00e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnew-approaches-to-object-detection-f5cbc925e00e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnew-approaches-to-object-detection-f5cbc925e00e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnew-approaches-to-object-detection-f5cbc925e00e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----f5cbc925e00e--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----f5cbc925e00e--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://libor-vanek.medium.com/?source=post_page-----f5cbc925e00e--------------------------------", "anchor_text": ""}, {"url": "https://libor-vanek.medium.com/?source=post_page-----f5cbc925e00e--------------------------------", "anchor_text": "Libor Vanek"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F90ae692ebe71&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnew-approaches-to-object-detection-f5cbc925e00e&user=Libor+Vanek&userId=90ae692ebe71&source=post_page-90ae692ebe71----f5cbc925e00e---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ff5cbc925e00e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnew-approaches-to-object-detection-f5cbc925e00e&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ff5cbc925e00e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnew-approaches-to-object-detection-f5cbc925e00e&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://www.pexels.com/photo/top-view-of-assorted-colored-row-boats-929032/", "anchor_text": "pexels.com"}, {"url": "https://github.com/Ximilar-com/xcenternet", "anchor_text": "GitHub"}, {"url": "https://arxiv.org/abs/1311.2524", "anchor_text": "R-CNN"}, {"url": "https://arxiv.org/abs/1504.08083", "anchor_text": "Fast R-CNN"}, {"url": "https://arxiv.org/abs/1506.01497", "anchor_text": "R-CNN"}, {"url": "https://arxiv.org/abs/1506.02640", "anchor_text": "YOLO \u2014 You Only Look Once"}, {"url": "https://arxiv.org/abs/2004.10934", "anchor_text": "version 4"}, {"url": "https://medium.com/r?url=https%3A%2F%2Farxiv.org%2Fabs%2F1512.02325", "anchor_text": "SSD \u2014 Single Shot multibox Detector"}, {"url": "https://arxiv.org/abs/1808.01244", "anchor_text": "CornerNet: Detecting Objects as Paired Keypoints"}, {"url": "https://arxiv.org/abs/1904.07850", "anchor_text": "Objects as Points"}, {"url": "https://www.pexels.com/photo/person-holding-white-ceramic-mug-beside-macbook-pro-3787300/", "anchor_text": "pexels.com"}, {"url": "https://arxiv.org/abs/1909.00700", "anchor_text": "TTFNet"}, {"url": "https://github.com/Ximilar-com/xcenternet", "anchor_text": "package"}, {"url": "https://arxiv.org/abs/1603.06937", "anchor_text": "Hourglass network"}, {"url": "https://arxiv.org/abs/1703.06211", "anchor_text": "Deformable Convolutions"}, {"url": "https://www.tensorflow.org/addons", "anchor_text": "TensorFlow Addons"}, {"url": "https://github.com/smallsunsun1/addons/tree/feature/deformable_ops", "anchor_text": "a fork of TFA"}, {"url": "https://github.com/tensorflow/addons/pull/1129", "anchor_text": "1129"}, {"url": "https://arxiv.org/abs/1708.02002", "anchor_text": "focal loss"}, {"url": "https://giou.stanford.edu/", "anchor_text": "Generalized Intersection over Union loss"}, {"url": "https://arxiv.org/abs/1911.08287", "anchor_text": "Distance-IoU Loss"}, {"url": "https://github.com/Ximilar-com/xcenternet", "anchor_text": "GitHub"}, {"url": "https://github.com/Cospel", "anchor_text": "Michal Lukac"}, {"url": "https://www.ximilar.com/", "anchor_text": "Ximilar"}, {"url": "https://www.ximilar.com/how-to-train-an-object-detection-model-with-one-click/", "anchor_text": "this blog post"}, {"url": "https://app.ximilar.com", "anchor_text": "Ximilar App"}, {"url": "https://medium.com/tag/object-detection?source=post_page-----f5cbc925e00e---------------object_detection-----------------", "anchor_text": "Object Detection"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----f5cbc925e00e---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/tensorflow?source=post_page-----f5cbc925e00e---------------tensorflow-----------------", "anchor_text": "TensorFlow"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----f5cbc925e00e---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/towards-data-science?source=post_page-----f5cbc925e00e---------------towards_data_science-----------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Ff5cbc925e00e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnew-approaches-to-object-detection-f5cbc925e00e&user=Libor+Vanek&userId=90ae692ebe71&source=-----f5cbc925e00e---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Ff5cbc925e00e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnew-approaches-to-object-detection-f5cbc925e00e&user=Libor+Vanek&userId=90ae692ebe71&source=-----f5cbc925e00e---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ff5cbc925e00e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnew-approaches-to-object-detection-f5cbc925e00e&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----f5cbc925e00e--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Ff5cbc925e00e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnew-approaches-to-object-detection-f5cbc925e00e&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----f5cbc925e00e---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----f5cbc925e00e--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----f5cbc925e00e--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----f5cbc925e00e--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----f5cbc925e00e--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----f5cbc925e00e--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----f5cbc925e00e--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----f5cbc925e00e--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----f5cbc925e00e--------------------------------", "anchor_text": ""}, {"url": "https://libor-vanek.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://libor-vanek.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Libor Vanek"}, {"url": "https://libor-vanek.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "70 Followers"}, {"url": "https://www.linkedin.com/in/libor-vanek/", "anchor_text": "https://www.linkedin.com/in/libor-vanek/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F90ae692ebe71&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnew-approaches-to-object-detection-f5cbc925e00e&user=Libor+Vanek&userId=90ae692ebe71&source=post_page-90ae692ebe71--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fusers%2F90ae692ebe71%2Flazily-enable-writer-subscription&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnew-approaches-to-object-detection-f5cbc925e00e&user=Libor+Vanek&userId=90ae692ebe71&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}