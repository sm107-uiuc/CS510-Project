{"url": "https://towardsdatascience.com/use-machine-learning-to-predict-horse-racing-4f1111fb6ced", "time": 1683010085.361135, "path": "towardsdatascience.com/use-machine-learning-to-predict-horse-racing-4f1111fb6ced/", "webpage": {"metadata": {"title": "Use Machine Learning to Predict Horse Racing | by Cullen Sun | Towards Data Science", "h1": "Use Machine Learning to Predict Horse Racing", "description": "I am a part-time student of master of computer science at HKU. After last semester exams, I was thinking it would be fun and cool to apply machine learning on a real world dataset. It took me no time\u2026"}, "outgoing_paragraph_urls": [{"url": "http://kaggle.com", "anchor_text": "Kaggle", "paragraph_index": 1}, {"url": "https://www.kaggle.com/gdaley/hkracing", "anchor_text": "the dataset for Horse Racing in HK", "paragraph_index": 1}, {"url": "https://www.kaggle.com/gdaley", "anchor_text": "Graham Daley", "paragraph_index": 1}, {"url": "https://developers.google.com/machine-learning/crash-course/classification/precision-and-recall", "anchor_text": "\ud835\udc5d\ud835\udc5f\ud835\udc52\ud835\udc50\ud835\udc56\ud835\udc60\ud835\udc56\ud835\udc5c\ud835\udc5b = \ud835\udc47\ud835\udc43/(\ud835\udc47\ud835\udc43+\ud835\udc39\ud835\udc43)", "paragraph_index": 10}, {"url": "https://entertainment.hkjc.com/entertainment/common/images/learn-racing/racing-academy/pdf/Racing_101_202005_Eng_final.pdf", "anchor_text": "Racing 101", "paragraph_index": 12}, {"url": "https://www.kaggle.com/cullensun/deep-learning-model-for-hong-kong-horse-racing", "anchor_text": "here", "paragraph_index": 13}], "all_paragraphs": ["I am a part-time student of master of computer science at HKU. After last semester exams, I was thinking it would be fun and cool to apply machine learning on a real world dataset.", "It took me no time to find out the great website for machine learning, Kaggle. Kaggle has a lot of interesting datasets for data science students and professionals. I searched for \u201cHong Kong\u201d because I would like to find a dataset that is close/related to me, and I got the dataset for Horse Racing in HK. Great thanks to Graham Daley for posting the dataset on Kaggle.", "I was very excited to work on my first real world machine learning project. I think horse racing is predictable and it\u2019s a typical classification problem.", "In this article, I am going to share with you how to do data preprocessing, neural network model building and training. We are going to use common machine learning packages like pandas, tensorflow, numpy, sklearn, etc. At the end, I will also share some thoughts that I came out after this project.", "The dataset contains two csv files: races.csv and runs.csv. The two tables are related by column \u201crace_id\u201d. We will need to join the two tables to make meaningful data for training.", "Till now, we are happy with the data from races.csv. The dataframe head looks like below.", "The runs.csv file contains data of horses for every race, associated with races.csv by race_id. Usually, each race has 14 or less horses racing together. The code is very similar to what we did for races.csv file, so I am not going to explain line by line. One thing to note is that, in line 10\u201313 above, we need to delete some noisy data, and the reason is explained in the code inline comment. After the processing, the dataframe head looks like below.", "You might think that we are done with the runs.csv file, but not really because we need to think how we are going to feed the data into the neural network. Basically, we want one row from races.csv plus all the rows from runs.csv which belong to the same race, and put them together as one sample input for the neural network. The following code is to reshape runs dataframe so that rows of same race will form into one row.", "You see, it\u2019s a lot of work for the data preprocessing. Luckily, we are almost there. Now, let\u2019s do the last bit to get the data ready for the neural network.", "Firstly, I\u2019d like to show you the architecture of the neural network as below. This is the core of the project. All the data preprocessing we have done so far is to feed into the neural network.", "Code is shown below, which is fairly simple, thanks to keras. Please pay attention to metrics. I chose precision, \ud835\udc5d\ud835\udc5f\ud835\udc52\ud835\udc50\ud835\udc56\ud835\udc60\ud835\udc56\ud835\udc5c\ud835\udc5b = \ud835\udc47\ud835\udc43/(\ud835\udc47\ud835\udc43+\ud835\udc39\ud835\udc43), as an evaluation parameter because it's our interest to bet on win.", "The model detail is printed out as below. Trainable parameters are 11,438, which is the power of a neural network. It means the network will learn and adjust each of these parameters in order to find a function y = f(X) to fit our data.", "The network is powerful enough to fit the training dataset well. However, there is big overfitting. The best performance we can reach on the validation dataset is about precision=0.3, which happens around epoch 60~80. Precision=0.3 means when we can get 3 out 10 win-bets correctly. This performance is not as high as I expected. The reason might be most races are handicaps, which means runners carry different weights to equalise their chance of winning the race, see reference Racing 101.", "In this article, I have shared with you how to apply machine learning skills end to end on a real world dataset from Kaggle. My full notebook can be found here. Thank you so much for reading it and welcome your comments.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Experienced software developer, and now learning AI and Robotics. Love reading."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F4f1111fb6ced&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fuse-machine-learning-to-predict-horse-racing-4f1111fb6ced&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fuse-machine-learning-to-predict-horse-racing-4f1111fb6ced&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fuse-machine-learning-to-predict-horse-racing-4f1111fb6ced&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fuse-machine-learning-to-predict-horse-racing-4f1111fb6ced&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----4f1111fb6ced--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----4f1111fb6ced--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://cullensun.medium.com/?source=post_page-----4f1111fb6ced--------------------------------", "anchor_text": ""}, {"url": "https://cullensun.medium.com/?source=post_page-----4f1111fb6ced--------------------------------", "anchor_text": "Cullen Sun"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fd111e74596f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fuse-machine-learning-to-predict-horse-racing-4f1111fb6ced&user=Cullen+Sun&userId=d111e74596f&source=post_page-d111e74596f----4f1111fb6ced---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F4f1111fb6ced&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fuse-machine-learning-to-predict-horse-racing-4f1111fb6ced&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F4f1111fb6ced&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fuse-machine-learning-to-predict-horse-racing-4f1111fb6ced&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "http://kaggle.com", "anchor_text": "Kaggle"}, {"url": "https://www.kaggle.com/gdaley/hkracing", "anchor_text": "the dataset for Horse Racing in HK"}, {"url": "https://www.kaggle.com/gdaley", "anchor_text": "Graham Daley"}, {"url": "https://unsplash.com/@vitreous_macula?utm_source=medium&utm_medium=referral", "anchor_text": "Julia Joppien"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://developers.google.com/machine-learning/crash-course/classification/precision-and-recall", "anchor_text": "\ud835\udc5d\ud835\udc5f\ud835\udc52\ud835\udc50\ud835\udc56\ud835\udc60\ud835\udc56\ud835\udc5c\ud835\udc5b = \ud835\udc47\ud835\udc43/(\ud835\udc47\ud835\udc43+\ud835\udc39\ud835\udc43)"}, {"url": "https://entertainment.hkjc.com/entertainment/common/images/learn-racing/racing-academy/pdf/Racing_101_202005_Eng_final.pdf", "anchor_text": "Racing 101"}, {"url": "https://special.hkjc.com/racing/info/en/betting/guide.asp", "anchor_text": "guide"}, {"url": "https://www.kaggle.com/cullensun/deep-learning-model-for-horse-racing", "anchor_text": "another notebook of mine"}, {"url": "https://www.kaggle.com/cullensun/deep-learning-model-for-hong-kong-horse-racing", "anchor_text": "here"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----4f1111fb6ced---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----4f1111fb6ced---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/ai?source=post_page-----4f1111fb6ced---------------ai-----------------", "anchor_text": "AI"}, {"url": "https://medium.com/tag/kaggle?source=post_page-----4f1111fb6ced---------------kaggle-----------------", "anchor_text": "Kaggle"}, {"url": "https://medium.com/tag/horse-racing?source=post_page-----4f1111fb6ced---------------horse_racing-----------------", "anchor_text": "Horse Racing"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F4f1111fb6ced&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fuse-machine-learning-to-predict-horse-racing-4f1111fb6ced&user=Cullen+Sun&userId=d111e74596f&source=-----4f1111fb6ced---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F4f1111fb6ced&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fuse-machine-learning-to-predict-horse-racing-4f1111fb6ced&user=Cullen+Sun&userId=d111e74596f&source=-----4f1111fb6ced---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F4f1111fb6ced&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fuse-machine-learning-to-predict-horse-racing-4f1111fb6ced&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----4f1111fb6ced--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F4f1111fb6ced&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fuse-machine-learning-to-predict-horse-racing-4f1111fb6ced&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----4f1111fb6ced---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----4f1111fb6ced--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----4f1111fb6ced--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----4f1111fb6ced--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----4f1111fb6ced--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----4f1111fb6ced--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----4f1111fb6ced--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----4f1111fb6ced--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----4f1111fb6ced--------------------------------", "anchor_text": ""}, {"url": "https://cullensun.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://cullensun.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Cullen Sun"}, {"url": "https://cullensun.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "133 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fd111e74596f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fuse-machine-learning-to-predict-horse-racing-4f1111fb6ced&user=Cullen+Sun&userId=d111e74596f&source=post_page-d111e74596f--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F3454fc22cf06&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fuse-machine-learning-to-predict-horse-racing-4f1111fb6ced&newsletterV3=d111e74596f&newsletterV3Id=3454fc22cf06&user=Cullen+Sun&userId=d111e74596f&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}