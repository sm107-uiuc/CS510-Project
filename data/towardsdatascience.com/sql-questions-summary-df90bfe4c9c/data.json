{"url": "https://towardsdatascience.com/sql-questions-summary-df90bfe4c9c", "time": 1683009803.4235368, "path": "towardsdatascience.com/sql-questions-summary-df90bfe4c9c/", "webpage": {"metadata": {"title": "What I realized after solving 100 leetcode SQL questions\u2026 | by Linda Chen | Towards Data Science", "h1": "What I realized after solving 100 leetcode SQL questions\u2026", "description": "There are lots of articles out there teaching you how to write queries. Knowing how to write a single query is not really the hard part. The hard part is that there are always multiple options of\u2026"}, "outgoing_paragraph_urls": [], "all_paragraphs": ["There are lots of articles out there teaching you how to write queries. Knowing how to write a single query is not really the hard part. The hard part is that there are always multiple options of approaches and all of them require a combination of queries. To put questions into categories, it helps us to identify patterns and build better instincts on what kinds of queries we can use.", "There are basically 3 types of SQL questions. The three types of questions are very simple in their original form. However, they can be leveled up by mix and match with 3 things. They are Time Constraints, Calculation Requirments, and Comparison/Ranking Requirments. I will show you what I meant with examples. Let\u2019s clarify the most basic forms first.", "Type 2: Select the group that did X", "Type 3: Select the group that didn\u2019t do X", "As you will see, Type-1 questions are basically testing our ability to use different kinds of joins. Both Type-2 and Type-3 questions are testing our ability to precisely identify the special group that satisfies certain constraints.", "It is important to draw the distinction between Type 2 and Type 3. Type 2 requires only 1 step with the where statement. Type 3 requires a 2-steps approach. Firstly, we need to identify the special group with where statement. Secondly, we need to use not in to exclude that group in the where statement.", "The reason is that if we directly select everything that is not green, then the samples that are both red and green will still be selected. I will provide examples below and it will become clearer. As you will see, Type 3 can become a lot more complicated than Type 2 questions.", "Type 2 : Select the group that did X/met X description", "Type 3: Select the groups that did not do X/met X description", "Notice buyer 2 bought both S8 and iPhone and they are two separate samples. So this has to be solved with 2 steps. Identify buyers who bought an iPhone first, then select buyer_id that is not in the buyers who bought an iPhone.", "Dealing with the time format requires us to be familiar with the queries that deal with time. However, at this stage, the logic is very much the same. It gets hard when it combines with the other two things. It often gets combine with some calculations requirements.", "Because we are selecting a special time frame, we are creating a special group. Therefore, these problems are either Type-2 or Type-3.", "When it comes to select the first or latest of something, I categorize them as Type-1 problems. The reason is we need to consider all the information without repetition and then select the best among them all.", "The hard part is date information is often not the primary key. Therefore, it takes some effort to ensure that the date that we wanted is matched with the corresponded item. See the following example.", "When we select min(event_date), the date is the earliest one but it will not match the corresponding device id because nor event_date or device_id is the primary key.", "The most common calculations are count/sum/average/ctr. When Type-2 or Type-3 questions have calculation involves, we oftentimes need to use case when to label some samples. For calculations in Type-1 questions, it is mostly plugging in formulas.", "The desired output can be separated into two categories. The first category has an output as one number. The second category has an output in the form of a table. The calculation is separated by users/dates/sessions.", "Because it is a Type-2 question, we first need to identify the special group \u2014 removed posts. Then we label one group \u201c1\u201d and the other \u201c0\u201d to perform the calculation.", "This is a Type-2 Time Constraint question with Calculation Requirments. We need to select the right time period and then perform the calculation", "2. The output as a table", "This is a Type-2 question because to calculate the CTR. CTR requires us to identify the \u201cclicked\u201d as one group and \u201cviewed\u201d as the other before performing any calculation. There is nothing new in the logic. We select these especial groups first and then apply the calculation.", "However, for this particular question, it highlights the fact that we need to be careful of having 0 as the denominator in calculation. When this happens, we often need to treat that sample separately then union with the rest.", "This is a Type-1 question. Therefore, essentially, it is testing our understanding of different kinds of joins. For the above question, I used cross join and left join to solve it. This is a harder question because the information is scattered among 3 tables. As we join multiple tables together, it is tricky to avoid duplicates and includes all the information.", "This is a Type-2 question with Time Constraints. Thus, we first need to organize the table according to the time constraints. Then we apply the function to calculate. The hard part is we need to be familiar with the queries that handle time. For this particular question, I used lag() over(order by) and sum(s_amount) over(order by)", "When it comes to comparison/ranking, it is often built on top of Calculation Requirements. For Type-1 questions, it is often to consider all the samples, rank them, and pick the best one. For Type-2 questions, it is often to categorize samples into groups and compare the two groups. For Type-3 questions, it is often to make a special group first, which requires ranking to do so. Then we select everything that has or does not have that group\u2019s characteristics.", "Type 1: Find the highest, nth highest, 2nd highest", "This is a tricky question because it is a function, which is uncommon in SQL. However, the underlying approach is the same. It is a Type-1 question, so we need to make sure no repetitive samples. Select distinct(salary) first, rank them using order_by, then use offset and fetch to get the second row.", "Type 2 questions: one group that has higher than/more than/at least\u2026", "We first precisely select the groups that we want using where or sometimes having first. Then we compare or put them into order.", "Type 3: select the top 3 /Nth highest salary", "Both questions have one sharing characteristic: you can have 2 or more samples sharing one rank. These two questions are easy because you can use dense_rank(). It tolerates the same ranking and thus, saves our efforts from doing the two-steps approach.", "This is a hard question because we have a nested logic. Here is what I meant. It is a Type-3 question, so we need to use the two-steps approach. Firstly, we make a group that consists of top-3 salaries from each department. They are 90000, 85000, 75000 for the IT department and 80000, 60000 for the Sales department. Secondly, we select all the samples that have one of these salaries.", "To select a group with our desired salaries, we need to use a Type-2 logic: separate two groups and compare them. In this example, we make a copy of our table so that we have two identical tables side by side. From table 1, we pick a salary and compare it to all the salaries in table 2. If there are more than 3 salaries bigger than the salary we picked, then that salary must not be the top 3.", "Here are two examples of questions where you have all three elements together: Time Constrains, Calculation Requirments, and Comparison. See if you can break down the components and solve it!", "So this how I break down complex questions into components. I hope my strategy helps!", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Share what I learned, and learn from what I shared. All about machines, humans, and the links between them. Take everything with a grain of salt."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fdf90bfe4c9c&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsql-questions-summary-df90bfe4c9c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsql-questions-summary-df90bfe4c9c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsql-questions-summary-df90bfe4c9c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsql-questions-summary-df90bfe4c9c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----df90bfe4c9c--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----df90bfe4c9c--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://linnndachen.medium.com/?source=post_page-----df90bfe4c9c--------------------------------", "anchor_text": ""}, {"url": "https://linnndachen.medium.com/?source=post_page-----df90bfe4c9c--------------------------------", "anchor_text": "Linda Chen"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fb0d085971d50&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsql-questions-summary-df90bfe4c9c&user=Linda+Chen&userId=b0d085971d50&source=post_page-b0d085971d50----df90bfe4c9c---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fdf90bfe4c9c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsql-questions-summary-df90bfe4c9c&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fdf90bfe4c9c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsql-questions-summary-df90bfe4c9c&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@sebastiancoman?utm_source=medium&utm_medium=referral", "anchor_text": "Sebastian Coman Photography"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://medium.com/tag/sql?source=post_page-----df90bfe4c9c---------------sql-----------------", "anchor_text": "Sql"}, {"url": "https://medium.com/tag/code-interview?source=post_page-----df90bfe4c9c---------------code_interview-----------------", "anchor_text": "Code Interview"}, {"url": "https://medium.com/tag/sql-queries?source=post_page-----df90bfe4c9c---------------sql_queries-----------------", "anchor_text": "Sql Queries"}, {"url": "https://medium.com/tag/study-summary?source=post_page-----df90bfe4c9c---------------study_summary-----------------", "anchor_text": "Study Summary"}, {"url": "https://medium.com/tag/leetcode?source=post_page-----df90bfe4c9c---------------leetcode-----------------", "anchor_text": "Leetcode"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fdf90bfe4c9c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsql-questions-summary-df90bfe4c9c&user=Linda+Chen&userId=b0d085971d50&source=-----df90bfe4c9c---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fdf90bfe4c9c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsql-questions-summary-df90bfe4c9c&user=Linda+Chen&userId=b0d085971d50&source=-----df90bfe4c9c---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fdf90bfe4c9c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsql-questions-summary-df90bfe4c9c&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----df90bfe4c9c--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fdf90bfe4c9c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsql-questions-summary-df90bfe4c9c&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----df90bfe4c9c---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----df90bfe4c9c--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----df90bfe4c9c--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----df90bfe4c9c--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----df90bfe4c9c--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----df90bfe4c9c--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----df90bfe4c9c--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----df90bfe4c9c--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----df90bfe4c9c--------------------------------", "anchor_text": ""}, {"url": "https://linnndachen.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://linnndachen.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Linda Chen"}, {"url": "https://linnndachen.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "477 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fb0d085971d50&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsql-questions-summary-df90bfe4c9c&user=Linda+Chen&userId=b0d085971d50&source=post_page-b0d085971d50--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fe27496a5a656&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsql-questions-summary-df90bfe4c9c&newsletterV3=b0d085971d50&newsletterV3Id=e27496a5a656&user=Linda+Chen&userId=b0d085971d50&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}