{"url": "https://towardsdatascience.com/a-single-python-function-generating-a-gorgeous-bar-chart-race-video-dd6410b8aed", "time": 1683016500.622132, "path": "towardsdatascience.com/a-single-python-function-generating-a-gorgeous-bar-chart-race-video-dd6410b8aed/", "webpage": {"metadata": {"title": "A Single Python Function Generating A Gorgeous Bar Chart Race Video | by Christopher Tao | Towards Data Science", "h1": "A Single Python Function Generating A Gorgeous Bar Chart Race Video", "description": "A tutorial for generating Bar Chart Race Video (popular everywhere on the Internet now) using Python with a single function and a few lines of code."}, "outgoing_paragraph_urls": [{"url": "https://towardsdatascience.com/3-lines-of-python-code-to-create-an-interactive-playable-covid-19-bubble-map-74807939e887", "anchor_text": "3 Lines of Python Code to Create An Interactive Playable COVID-19 Bubble Map", "paragraph_index": 6}, {"url": "http://towardsdatascience.com/", "anchor_text": "Towards Data Science", "paragraph_index": 45}, {"url": "https://www.who.int/emergencies/diseases/novel-coronavirus-2019/situation-reports", "anchor_text": "here", "paragraph_index": 45}], "all_paragraphs": ["Recently, a very fancy type of data visualisation ignited in various platforms such as YouTube. As long as there are some \u201centities\u201d with a single measure that changes over time, this type of visualisation can be perfect to illustrate the dynamic ranking between these entities.", "That is the Bar Chart Race. It is usually can be seen as a video. The video below is generated by myself using a single Python function. Have a look at it, then you will know what I\u2019m talking about.", "Do you believe the above video is generated using a single Python function with a few lines of code? I\u2019ll show you how.", "The article is not too short, because I want to provide something that can be followed step by step. I would say that 95% of the time we\u2019re doing data preprocessing here. If you really want to skip and directly to the point, please go the section \u201cGenerate Bar Chart Race Video\u201d for the code of generating the video :)", "To make sure this tutorial is achievable, I will not just provide the code for generating the bar chart race video, but also how to get the dataset and pre-process it. So, the prepared dataset is actionable and then can be fit in the bar chart race library in Python.", "The dataset I used was provided by the European Centre for Disease Prevention and Control that is publicly available. Everyone can download the COVID-19 dataset for free. I also used this dataset in one of my previous articles.", "3 Lines of Python Code to Create An Interactive Playable COVID-19 Bubble Map", "There is a link on the above webpage that we can download the dataset in CSV format. In fact, we don\u2019t have to download the dataset to our local machine, because Pandas Dataframe can directly read a remote CSV file as follows.", "Then, we can have a look at what columns we have in the dataset and how the values look like by df.head().", "If you have watched the previous video, you might aware that I have used the number of confirmed cases as the measure. So, Let\u2019s start the data cleansing and transforming.", "In the data transformation, we need to reshape the data into something we can use. To generate the bar chart race video, we are going to use the Python library called \u201cbar-chart-race\u201d (Will introduce in the next section). It expected the data frame using the DateTime object as the indexes, and the entity names as the column name. So, let\u2019s transform the data together.", "Since we are only interested in the date, countries an the number of cases, we can filter the data frame with only these three columns as follows.", "2. Convert date string to datetime object", "If we check the data types of the columns, we will find that the dateRep is actually of objects, which will be treated as strings rather than datetime object. This will cause some troubles because we can\u2019t expect the sort results based on a date string column.", "Therefore, we need to convert it into datetime type.", "After this, let\u2019s check the dtypes again.", "You may have already noticed that the number of cases is for the corresponding date. However, we need cumulative total cases for each day so that the data entry for each day can be generated as a frame in the video.", "Therefore, let\u2019s generate a column called total_case, so it means the total number of cases so far on that day.", "4. Remove the non-useful columns again and rename the columns", "Since we have generated the new date and total_cases columns, we don\u2019t need the dateRep and cases columns. Also, let\u2019s rename the column of country name to keep it simple.", "Remember we need to use the country names as the column names? So, we need to pivot the table. This is very easy to do in Pandas data frame.", "We use date as the index, country should be the columns and the values are total_cases. Then, we will get the pivot table as follows.", "The multi-level indexes that are generated by the pivot_table function are ugly and potentially will cause problems. So, let\u2019s fix it.", "We finished transforming the raw dataset. However, we still need to cleanse the data.", "Have you seen that we still have a lot of NaN values in the data frame? That is because there are not cases recorded ever for that country, which makes sense. However, they may cause problems later on.", "1. Fill the NaN values with Zero", "Since the NaN values mean there are no confirmed cases for the country, it is safe to fill all the NaN values with zeros.", "Please be aware here we also change the data type to integers, because it doesn\u2019t make sense to have float numbers for the number of cases.", "Among all the countries that are already columns in our data frame, there is a column called Cases_on_an_international_conveyance_Japan, which is not a country. It refers to the Diamond Princess Cruise. Because it is not actually a country and the passengers are actually from various countries, I would like to remove it from our statistics in this case.", "3. Remove the underscores in the country names", "The country names (our column names) have underscores in between the words. I would like to replace these underscores with whitespaces so that it will be prettier when we see them as the bar chart labels.", "4. Remove countries that never ranked in the top 10", "This step is optional. However, it will improve performance when we generate the video. We have totally 200+ countries in the dataset, but not every one of them has ever ranked in the top 10. Since we are going to create a top 10 bar chart race data visualisation, those countries will never be displayed.", "We can remove these countries as follows.", "Here, we firstly generate a set called country_reserved. Using a set is because it will simply ignore duplicated values. Then, iterate each row of the data frame, append the country names to the set if their total cases are ranked in top 10 on that day.", "Finally, we will have a set of countries that ever ranked in the top 10. Convert the set into a list and filter the column will produce a much smaller data frame we will use later.", "Now we only have 30 countries left.", "OK. We have used a lot of time to wrangle the dataset. In fact, to generate the video is extremely easy as I titled this article.", "We just need to download the library called bar-chart-race, pip will do that in a minute.", "Simply call the bar_chart_race function as follows.", "After a while, the video will be generated at the path and the name that we have specified.", "In this article, I have introduced yet another amazing Python library \u201cBar Chart Race\u201d. With a single function and a few lines of code, we can generate a gorgeous bar chart race video in MP4 format.", "It turns out there are more configurable items available in the bar chart race library. It is highly recommended to try them out by yourself. The link to the official documentation has been given in the references!", "If you feel my articles are helpful, please consider joining Medium Membership to support me and thousands of other writers! (Click the link above)", "European Centre for Disease Prevention and Control", "Note from the editors: Towards Data Science is a Medium publication primarily based on the study of data science and machine learning. We are not health professionals or epidemiologists, and the opinions of this article should not be interpreted as professional advice. To learn more about the coronavirus pandemic, you can click here.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fdd6410b8aed&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-single-python-function-generating-a-gorgeous-bar-chart-race-video-dd6410b8aed&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-single-python-function-generating-a-gorgeous-bar-chart-race-video-dd6410b8aed&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-single-python-function-generating-a-gorgeous-bar-chart-race-video-dd6410b8aed&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-single-python-function-generating-a-gorgeous-bar-chart-race-video-dd6410b8aed&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----dd6410b8aed--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----dd6410b8aed--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://qiuyujx.medium.com/?source=post_page-----dd6410b8aed--------------------------------", "anchor_text": ""}, {"url": "https://qiuyujx.medium.com/?source=post_page-----dd6410b8aed--------------------------------", "anchor_text": "Christopher Tao"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fb8176fabf308&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-single-python-function-generating-a-gorgeous-bar-chart-race-video-dd6410b8aed&user=Christopher+Tao&userId=b8176fabf308&source=post_page-b8176fabf308----dd6410b8aed---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fdd6410b8aed&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-single-python-function-generating-a-gorgeous-bar-chart-race-video-dd6410b8aed&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fdd6410b8aed&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-single-python-function-generating-a-gorgeous-bar-chart-race-video-dd6410b8aed&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://pixabay.com/users/shutterbug75-2077322/", "anchor_text": "Shutterbug75"}, {"url": "https://pixabay.com/photos/art-artistic-blue-brown-business-1238602/", "anchor_text": "Pixabay"}, {"url": "https://pixabay.com/users/tibine-238708/", "anchor_text": "TiBine"}, {"url": "https://pixabay.com/photos/forge-blacksmith-hammer-iron-fire-411923/", "anchor_text": "Pixabay"}, {"url": "https://towardsdatascience.com/3-lines-of-python-code-to-create-an-interactive-playable-covid-19-bubble-map-74807939e887", "anchor_text": "3 Lines of Python Code to Create An Interactive Playable COVID-19 Bubble Map"}, {"url": "https://www.ecdc.europa.eu/en/publications-data/download-todays-data-geographic-distribution-covid-19-cases-worldwide", "anchor_text": "https://www.ecdc.europa.eu/en/publications-data/download-todays-data-geographic-distribution-covid-19-cases-worldwide"}, {"url": "https://opendata.ecdc.europa.eu/covid19/casedistribution/csv/data.csv'", "anchor_text": "https://opendata.ecdc.europa.eu/covid19/casedistribution/csv/data.csv'"}, {"url": "https://pixabay.com/users/webandi-1460261/", "anchor_text": "webandi"}, {"url": "https://pixabay.com/photos/sweeper-periodic-brush-return-clean-1687445/", "anchor_text": "Pixabay"}, {"url": "https://pixabay.com/users/startupstockphotos-690514/", "anchor_text": "StartupStockPhotos"}, {"url": "https://pixabay.com/photos/children-win-success-video-game-593313/", "anchor_text": "Pixabay"}, {"url": "https://pixabay.com/users/bokskapet-7322944/", "anchor_text": "Bokskapet"}, {"url": "https://pixabay.com/photos/video-production-video-movie-film-4223885/", "anchor_text": "Pixabay"}, {"url": "https://medium.com/@qiuyujx/membership", "anchor_text": "Join Medium with my referral link \u2014 Christopher TaoAs a Medium member, a portion of your membership fee goes to writers you read, and you get full access to every story\u2026medium.com"}, {"url": "https://www.ecdc.europa.eu/en/publications-data/download-todays-data-geographic-distribution-covid-19-cases-worldwide", "anchor_text": "Download the daily number of new reported cases of COVID-19 by country worldwideThe downloadable data file is updated daily and contains the latest available public data on COVID-19. You may use the\u2026www.ecdc.europa.eu"}, {"url": "https://www.dexplo.org/bar_chart_race/", "anchor_text": "Bar Chart RaceAnimated bar chart races in Python with the bar_chart_race packagewww.dexplo.org"}, {"url": "http://towardsdatascience.com/", "anchor_text": "Towards Data Science"}, {"url": "https://www.who.int/emergencies/diseases/novel-coronavirus-2019/situation-reports", "anchor_text": "here"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----dd6410b8aed---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/technology?source=post_page-----dd6410b8aed---------------technology-----------------", "anchor_text": "Technology"}, {"url": "https://medium.com/tag/programming?source=post_page-----dd6410b8aed---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/tag/data-science?source=post_page-----dd6410b8aed---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/data-visualization?source=post_page-----dd6410b8aed---------------data_visualization-----------------", "anchor_text": "Data Visualization"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fdd6410b8aed&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-single-python-function-generating-a-gorgeous-bar-chart-race-video-dd6410b8aed&user=Christopher+Tao&userId=b8176fabf308&source=-----dd6410b8aed---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fdd6410b8aed&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-single-python-function-generating-a-gorgeous-bar-chart-race-video-dd6410b8aed&user=Christopher+Tao&userId=b8176fabf308&source=-----dd6410b8aed---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fdd6410b8aed&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-single-python-function-generating-a-gorgeous-bar-chart-race-video-dd6410b8aed&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----dd6410b8aed--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fdd6410b8aed&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-single-python-function-generating-a-gorgeous-bar-chart-race-video-dd6410b8aed&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----dd6410b8aed---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----dd6410b8aed--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----dd6410b8aed--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----dd6410b8aed--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----dd6410b8aed--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----dd6410b8aed--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----dd6410b8aed--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----dd6410b8aed--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----dd6410b8aed--------------------------------", "anchor_text": ""}, {"url": "https://qiuyujx.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://qiuyujx.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Christopher Tao"}, {"url": "https://qiuyujx.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "8.7K Followers"}, {"url": "https://www.linkedin.com/in/christopher-tao-5717a274/", "anchor_text": "https://www.linkedin.com/in/christopher-tao-5717a274/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fb8176fabf308&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-single-python-function-generating-a-gorgeous-bar-chart-race-video-dd6410b8aed&user=Christopher+Tao&userId=b8176fabf308&source=post_page-b8176fabf308--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F1d2af94a683f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-single-python-function-generating-a-gorgeous-bar-chart-race-video-dd6410b8aed&newsletterV3=b8176fabf308&newsletterV3Id=1d2af94a683f&user=Christopher+Tao&userId=b8176fabf308&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}