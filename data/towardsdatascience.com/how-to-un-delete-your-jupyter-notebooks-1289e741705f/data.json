{"url": "https://towardsdatascience.com/how-to-un-delete-your-jupyter-notebooks-1289e741705f", "time": 1683005195.648434, "path": "towardsdatascience.com/how-to-un-delete-your-jupyter-notebooks-1289e741705f/", "webpage": {"metadata": {"title": "How to Un-Delete Your Jupyter Notebooks | by Ray Johns | Towards Data Science", "h1": "How to Un-Delete Your Jupyter Notebooks", "description": "Who doesn\u2019t love Jupyter notebooks? They\u2019re interactive, giving you the instant gratification of immediate feedback. They\u2019re extensible \u2014 you can even deploy them as websites. Most importantly for\u2026"}, "outgoing_paragraph_urls": [{"url": "https://ipython.readthedocs.io/en/stable/interactive/magics.html#magic-history", "anchor_text": "powerful command", "paragraph_index": 12}, {"url": "https://medium.com/swlh/a-guide-to-python-virtual-environments-8af34aa106ac", "anchor_text": "virtual environment", "paragraph_index": 13}, {"url": "https://jupytext.readthedocs.io/en/latest/introduction.html", "anchor_text": "jupytext", "paragraph_index": 27}, {"url": "https://towardsdatascience.com/advanced-google-skills-for-data-science-350bf828dbe6", "anchor_text": "creative search techniques", "paragraph_index": 30}], "all_paragraphs": ["Who doesn\u2019t love Jupyter notebooks? They\u2019re interactive, giving you the instant gratification of immediate feedback. They\u2019re extensible \u2014 you can even deploy them as websites. Most importantly for data scientists and machine learning engineers, they\u2019re expressive \u2014 they span the space between the scientists and engineers who manipulate data and the lay audience that consumes and wants to understand the information that data represents.", "But Jupyter notebooks have their drawbacks. They\u2019re big JSON files that store the code, markdown, input, output, and metadata of every cell that you run. To understand what I mean, here\u2019s a short notebook I wrote to define and test the sigmoid function.", "And here\u2019s what (part of) it looks like when IPython isn\u2019t rendering it (I\u2019ve abridged all but the first actual input cell, because even for a short notebook it\u2019s long and ugly):", "It\u2019s kind of hard to version control them as a result. It also means there\u2019s a lot of junk data in there you usually don\u2019t care very much about saving, like the cell execution count and outputs.", "The next time you wonder why your Jupyter notebook is running so slowly, open it in a plain-text editor and see how many massive dataframes are just hanging out in your notebook\u2019s metadata.", "Under the right circumstances, though, all that junk can look like precious gems. Those circumstances usually involve:", "Anyone who\u2019s ever strayed into the dangerous territory of doing their development in an IPython notebook has done these things at least once, probably at the same time.", "If this is you, and you\u2019re here because you Googled recover deleted jupyter notebook refreshed browser window, don\u2019t panic. First I\u2019m going to tell you how to fix it.* Then I\u2019m going to tell you how to prevent it from happening again.", "(Unscientific) estimated probability of recovery: 90%", "In the least-worst case, you\u2019ve hit x on a cell you didn\u2019t actually want to delete, and now you want to get back its code or data.", "When you use a notebook, the IPython kernel runs your code. The IPython kernel is a process that is separate from your Python interpreter. (That\u2019s also why you need to link a new kernel to a new virtual environment. The two are not automatically connected.) It sends and receives messages, like your code cells, using JSON.", "When you run a cell or hit \u201csave\u201d, the notebook server sends your code as JSON to a notebook on your computer that stores your input and output. So the little words In and Out next to your cell aren\u2019t just words, they\u2019re containers \u2014 specifically lists of your session history. You can print out and index into them.", "Use the %history line magic to print your input history (last in, first out). This powerful command grants you access to your current and past sessions by absolute or relative number.", "If the current IPython process is still connected, and you\u2019ve installed nbformat in your virtual environment, execute this code in a cell to recover your notebook:", "This magic renders the entire current session history as a new Jupyter notebook.", "This won\u2019t always work, and you might need to expend a bit of effort weeding extraneous cells from the output.", "There are lots more things you can do with the history magic. Here are a few recipes I find useful:", "If you\u2019ve been working in a really big data science notebook for a long time, the %notebook magic strategy might produce a lot of noise that you don\u2019t want. Use the other parameters to whittle down the output of %history -g, then use jupytext (explained below) to convert the results.", "(Unscientific) estimated probability of recovery: 70\u201385%", "Remember how we said version control is hard with notebooks? A kernel can connect to more than one frontend at the same time. Which means those two browser tabs with the same notebook open can access the same variables. Which is how you overwrote your code in the first place.", "IPython stores your session history in a database. By default, you can find it under your home directory in a folder called .ipython/profile_default.", "Back up history.sqlite to a copy.", "Open the backup, either in a database browser or via the sqlite3 command line interface. It has three tables: history, output_history, and sessions. Depending on what you want to recover, you may need to join all three, so brush off your SQL.", "If you can tell from the database browser GUI which session number in the history table has your code, then your life is a bit simpler.", "Either execute the SQL command in the browser or on the command line:", "All this does is specify the session number and the filename to write to (in the example given, 1 and recovered.py) and selects your source code from the database, separating each block with a newline character (which in ASCII is 10).", "If you wanted to select the line number as a Python comment, you could do so with a query like:", "Once you have a Python executable, you can pretty much breathe easy. But you could turn it back into a notebook with jupytext, a miraculous tool that can convert plaintext formats to Jupyter notebooks.", "(Unscientific) estimated probability of recovery: 50\u201375%", "None of the above worked, but you\u2019re not ready to give up yet.", "Go back to whatever tool you\u2019re using to navigate your history-bak.sqlite database. The queries you write will require creative search techniques that make the most of the information you have:", "For example, you could find everything you wrote involving pytest this year with a query like:", "Once you\u2019ve shaped your view to the rows you want, you can export it to an executable .py file as before, and convert it back to .ipynb with jupytext.", "As you savor your relief at not having to rewrite your notebook from scratch, take a moment to ponder a few measures to guard against future expeditions into history.sqlite:", "What are some of your biggest challenges with Jupyter notebooks? Drop a comment on topics you\u2019d like to tackle in future posts.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Opinions are my own. Machine Learning, AI, Linguistics, NLP with Deep Learning | { B.A. : Dartmouth; J.D. : Yale; M.S. : Simmons; CS Graduate Courses: Stanford}"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F1289e741705f&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-un-delete-your-jupyter-notebooks-1289e741705f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-un-delete-your-jupyter-notebooks-1289e741705f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-un-delete-your-jupyter-notebooks-1289e741705f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-un-delete-your-jupyter-notebooks-1289e741705f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----1289e741705f--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----1289e741705f--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@rayljohns?source=post_page-----1289e741705f--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@rayljohns?source=post_page-----1289e741705f--------------------------------", "anchor_text": "Ray Johns"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F304c3bcee737&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-un-delete-your-jupyter-notebooks-1289e741705f&user=Ray+Johns&userId=304c3bcee737&source=post_page-304c3bcee737----1289e741705f---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F1289e741705f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-un-delete-your-jupyter-notebooks-1289e741705f&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F1289e741705f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-un-delete-your-jupyter-notebooks-1289e741705f&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://medium.com/swlh/a-guide-to-python-virtual-environments-8af34aa106ac", "anchor_text": "virtual environment"}, {"url": "https://sqlitestudio.pl/index.rvt?act=download", "anchor_text": "SQLiteStudio"}, {"url": "https://ipython.readthedocs.io/en/stable/interactive/magics.html#magic-history", "anchor_text": "powerful command"}, {"url": "https://medium.com/swlh/a-guide-to-python-virtual-environments-8af34aa106ac", "anchor_text": "virtual environment"}, {"url": "https://jupytext.readthedocs.io/en/latest/introduction.html", "anchor_text": "jupytext"}, {"url": "https://towardsdatascience.com/advanced-google-skills-for-data-science-350bf828dbe6", "anchor_text": "creative search techniques"}, {"url": "https://towardsdatascience.com/power-up-your-python-projects-with-visual-studio-code-401f78dd97eb", "anchor_text": "Using Visual Studio Code as your Jupyter IDE"}, {"url": "https://jupytext.readthedocs.io/en/latest/introduction.html", "anchor_text": "Jupytext"}, {"url": "https://ipython.readthedocs.io/en/stable/config/extensions/storemagic.html", "anchor_text": "Here\u2019s the full documentation."}, {"url": "https://towardsdatascience.com/power-up-your-python-projects-with-visual-studio-code-401f78dd97eb", "anchor_text": "Power up your Python Projects with Visual Studio Code"}, {"url": "https://towardsdatascience.com/advanced-google-skills-for-data-science-350bf828dbe6", "anchor_text": "Advanced Google Skills for Data Science"}, {"url": "https://jupytext.readthedocs.io/en/latest/introduction.html", "anchor_text": "Jupytext"}, {"url": "https://ipython.readthedocs.io/en/stable/config/extensions/storemagic.html", "anchor_text": "IPython storemagic"}, {"url": "https://ipython.readthedocs.io/en/stable/interactive/magics.html#magic-history", "anchor_text": "IPython history magic"}, {"url": "https://sqlitestudio.pl/index.rvt?act=download", "anchor_text": "SQLiteStudio"}, {"url": "https://medium.com/tag/data-science?source=post_page-----1289e741705f---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/science?source=post_page-----1289e741705f---------------science-----------------", "anchor_text": "Science"}, {"url": "https://medium.com/tag/technology?source=post_page-----1289e741705f---------------technology-----------------", "anchor_text": "Technology"}, {"url": "https://medium.com/tag/programming?source=post_page-----1289e741705f---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----1289e741705f---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F1289e741705f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-un-delete-your-jupyter-notebooks-1289e741705f&user=Ray+Johns&userId=304c3bcee737&source=-----1289e741705f---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F1289e741705f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-un-delete-your-jupyter-notebooks-1289e741705f&user=Ray+Johns&userId=304c3bcee737&source=-----1289e741705f---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F1289e741705f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-un-delete-your-jupyter-notebooks-1289e741705f&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----1289e741705f--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F1289e741705f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-un-delete-your-jupyter-notebooks-1289e741705f&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----1289e741705f---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----1289e741705f--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----1289e741705f--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----1289e741705f--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----1289e741705f--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----1289e741705f--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----1289e741705f--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----1289e741705f--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----1289e741705f--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@rayljohns?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@rayljohns?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Ray Johns"}, {"url": "https://medium.com/@rayljohns/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "656 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F304c3bcee737&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-un-delete-your-jupyter-notebooks-1289e741705f&user=Ray+Johns&userId=304c3bcee737&source=post_page-304c3bcee737--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F199f98e22d81&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-un-delete-your-jupyter-notebooks-1289e741705f&newsletterV3=304c3bcee737&newsletterV3Id=199f98e22d81&user=Ray+Johns&userId=304c3bcee737&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}