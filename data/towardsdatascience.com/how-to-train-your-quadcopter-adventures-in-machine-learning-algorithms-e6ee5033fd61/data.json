{"url": "https://towardsdatascience.com/how-to-train-your-quadcopter-adventures-in-machine-learning-algorithms-e6ee5033fd61", "time": 1682997446.689601, "path": "towardsdatascience.com/how-to-train-your-quadcopter-adventures-in-machine-learning-algorithms-e6ee5033fd61/", "webpage": {"metadata": {"title": "How to Train Your Quadcopter. The beginner\u2019s guide to teaching a\u2026 | by Anne Bonner | Towards Data Science", "h1": "How to Train Your Quadcopter", "description": "Quadcopters are amazing things. They\u2019re small, they\u2019re maneuverable, and they allow you to test new ideas in fields like flight control theory, real-time systems, navigation, and robotics."}, "outgoing_paragraph_urls": [{"url": "https://wiki.kerbalspaceprogram.com/wiki/Center_of_thrust", "anchor_text": "center of thrust", "paragraph_index": 3}, {"url": "https://arxiv.org/pdf/1707.05110.pdf", "anchor_text": "Jemin Hwangbo, et al., wrote a great paper outlining their research if you\u2019re interested.", "paragraph_index": 5}, {"url": "http://udacity.com", "anchor_text": "Udacity\u2019s", "paragraph_index": 8}, {"url": "https://github.com/udacity/RL-Quadcopter", "anchor_text": "check it out", "paragraph_index": 8}, {"url": "https://arxiv.org/abs/1509.02971", "anchor_text": "this Deep Deterministic Policy Gradients paper", "paragraph_index": 12}, {"url": "https://en.wikipedia.org/wiki/Gaussian_noise", "anchor_text": "Gaussian noise", "paragraph_index": 13}, {"url": "https://en.wikipedia.org/wiki/Ornstein%E2%80%93Uhlenbeck_process", "anchor_text": "You can read about the Ornstein\u2013Uhlenbeck process here", "paragraph_index": 17}, {"url": "https://en.wikipedia.org/wiki/Rectifier_(neural_networks)", "anchor_text": "ReLU activation function", "paragraph_index": 26}, {"url": "https://github.com/udacity/RL-Quadcopter", "anchor_text": "If you want to take a look at the original project, you can find it here", "paragraph_index": 31}, {"url": "https://github.com/bonn0062/quadcopter2", "anchor_text": "it\u2019s on GitHub", "paragraph_index": 32}, {"url": "https://www.linkedin.com/in/annebonnerdata/", "anchor_text": "@annebonnerdata", "paragraph_index": 33}, {"url": "http://bit.ly/submissions2023", "anchor_text": "http://bit.ly/submissions2023", "paragraph_index": 35}], "all_paragraphs": ["Lately, I\u2019ve been having a lot of fun trying to train a quadcopter to fly.", "They\u2019re small, they\u2019re maneuverable, and they can be flown both indoors and outdoors. They\u2019re amazing for photography and journalism. You can use them for deliveries, humanitarian operations, search and rescue, and cinematography. They have military and law enforcement applications too, of course. They\u2019re also great for research! With a quadcopter, you can test new ideas in fields like flight control theory, real-time systems, navigation, and robotics.", "Plus they can be built and maintained by amateurs!", "At a very basic level, a quadcopter is a kind of helicopter that\u2019s lifted and propelled by (most of the time) four rotors. They usually use two pairs of identical fixed pitched propellers. Two run clockwise, and two run counterclockwise. For control, they use independent variation of the speed of each rotor. By changing the speed of each rotor, you can generate your desired total thrust, locate for the center of thrust (laterally and longitudinally), and create a desired total torque.", "The really cool thing about a quadcopter is that you can control it with a neural network trained using machine learning techniques!", "Using reinforcement learning, you can train a network to directly map state to actuator commands. It\u2019s even possible to completely control a quadcopter using a neural network trained in simulation! Jemin Hwangbo, et al., wrote a great paper outlining their research if you\u2019re interested.", "While most quadcopters have four motors that provide thrust (\u2026putting the \u201cquad\u201d in \u201cquadcopter\u201d), some actually have 6 or 8. Having more points of thrust improves stability and enables a bunch of cool flying behaviors. But a more complex system means that it\u2019s almost impossible to manually control each motor\u2019s thrust.", "Fortunately, you can use reinforcement learning to build agents that can learn behaviors on their own!", "This is one of the required projects in Udacity\u2019s Machine Learning Engineer Nanodegree. It\u2019s a pretty cool project, you might want to check it out! You get some solid basic code, a few helpful files, and then you plug in your own code and get that baby up and running.", "To get this thing to work, you need to design your own reinforcement learning task and an agent to complete it. You\u2019re provided with a sample agent to get started and a simulator for the quadcopter.", "The rest is up to you.", "The agent controls the quadcopter by setting the revolutions per second on each of its four rotors. You can expand the size of the state vector by including the velocity information. (Udacity uses the 6-dimensional pose of the quadcopter to construct the state of the environment at each timestep). You can also use any combination of the pose, velocity, and angular velocity.", "You\u2019ll use the __init__()method to initialize several variables, including your task. If you look through the code for a minute, you\u2019ll see that the simulator is initialized here as an instance of the physics_sim class, for example. Udacity also makes use of action repeats, inspired by this Deep Deterministic Policy Gradients paper. You\u2019ll set the number of elements in the state vector and specify the target position as a variable.", "You\u2019re provided with an example sample agent. It uses a very simplistic linear policy to directly compute the action vector as a dot product of the state vector and a matrix of weights. It randomly perturbs the parameters by adding some Gaussian noise to produce a different policy. Based on the average reward obtained in each episode, it keeps track of the best set of parameters found so far and how the score is changing. It then tweaks a scaling factor to widen or tighten the noise.", "The simple one they set you up with doesn\u2019t perform so well\u2026", "Next it\u2019s up to you to specify a task of your choosing. You\u2019ll define your own agent and tweak various hyperparameters and the reward function for your task until you arrive at some behavior you can be proud of.", "We\u2019ll need to define our task (environment) in a task.py file. We\u2019ll also have a folder for our reinforcement agents. We\u2019ll keep an agent.py file in there where we define our agent and take advantage of the physics_sim.py file that contains the simulator for our quadcopter. You might want to consider creating more files, like a one for defining a neural network if you want to try that.", "We definitely need to design the agent. After much wasted time and useless fooling around, I decided to use actor, critic, policy search, replay buffer, and ou_noise files. (You can read about the Ornstein\u2013Uhlenbeck process here.)", "It\u2019s time to train our agent!", "Now head on over to your notebook and grab your imports", "then head on over to your notebook. Start with your imports", "We can plot the rewards like this:", "First, we can look at the reward function. The drone receives a reward between -1 and 1 at each step of the episode according to the difference between its current position and target position for x, y, and z dimensions. Because the initial reward function wasn\u2019t giving us good results, we switched to a tanh reward function.", "Then, after determining that the provided reward function wasn\u2019t satisfactory, we went with a tanh reward function:", "Lowering the \u201c0.3\u201d constant gave much better results. After much trial and error, I decided to run with:", "(Besides the improved results, the drone also learned much faster with this change!)", "The Actor model has two dense layers with 512 and 256 cells. On both layers, we used 12 regularizers, batch normalization, and ReLU activation function. The final layer has a dense layer with four cells and a sigmoid activation function. Adam optimizer worked well with a learning rate of 0.001.", "The Critic model is similar to the Actor model and also has two dense layers with 512 and 256 cells. Batch normalization and a ReLU activation function made sense here too.", "Depending on the random initialization of parameters, your agent might learn a task in the first 20\u201350 episodes. But most algorithms learn tasks in 500\u20131000 episodes. It\u2019s also possible for them to get stuck in local minima and never make it out (or only make it out after a long time). It\u2019s always possible your training algorithm might take longer. That depends on details like the learning rate parameter you chose and so on.", "This agent learned quickly! It has an impressively steep learning curve. The drone received periodic large increases in rewards rather than a gradual learning curve. The mean reward over the last 10 episodes was approximately 93.3.", "Because I\u2019m no expert in robotics or quadcopters, this project was tough! But the amount I learned trying to put this project together was astonishing. If you have any interest at all, you might want to try taking this project for a spin!", "If you want to take a look at the original project, you can find it here. This is where you can find all of the original code and instructions.", "If you\u2019re interested in my code, it\u2019s on GitHub!", "Thanks for reading! As always, if you do anything cool with this information, let everyone know about it in the comments below, or reach out on LinkedIn @annebonnerdata!", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Building a community space at VentureBeat \ud83d\udcab Submit your articles here: http://bit.ly/submissions2023"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fe6ee5033fd61&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-train-your-quadcopter-adventures-in-machine-learning-algorithms-e6ee5033fd61&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-train-your-quadcopter-adventures-in-machine-learning-algorithms-e6ee5033fd61&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-train-your-quadcopter-adventures-in-machine-learning-algorithms-e6ee5033fd61&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-train-your-quadcopter-adventures-in-machine-learning-algorithms-e6ee5033fd61&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----e6ee5033fd61--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----e6ee5033fd61--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@annebonner?source=post_page-----e6ee5033fd61--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@annebonner?source=post_page-----e6ee5033fd61--------------------------------", "anchor_text": "Anne Bonner"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fa71060a2ef24&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-train-your-quadcopter-adventures-in-machine-learning-algorithms-e6ee5033fd61&user=Anne+Bonner&userId=a71060a2ef24&source=post_page-a71060a2ef24----e6ee5033fd61---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe6ee5033fd61&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-train-your-quadcopter-adventures-in-machine-learning-algorithms-e6ee5033fd61&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe6ee5033fd61&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-train-your-quadcopter-adventures-in-machine-learning-algorithms-e6ee5033fd61&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://www.pexels.com/photo/animal-avian-beak-bird-416202/", "anchor_text": "Pixaby"}, {"url": "https://www.pexels.com/photo/animal-avian-beak-bird-416202/", "anchor_text": "Pexels"}, {"url": "https://www.pexels.com/@366671?utm_content=attributionCopyText&utm_medium=referral&utm_source=pexels", "anchor_text": "\u043d\u0430\u0442\u0430\u043b\u044c\u044f \u0441\u0435\u043c\u0435\u043d\u043a\u043e\u0432\u0430"}, {"url": "https://www.pexels.com/photo/selective-focus-photography-of-sphinx-cat-lying-on-bedspread-991831/?utm_content=attributionCopyText&utm_medium=referral&utm_source=pexels", "anchor_text": "Pexels"}, {"url": "https://media.giphy.com/media/1fkd6ZTBsxSosV4UTS", "anchor_text": "GIPHY"}, {"url": "https://wiki.kerbalspaceprogram.com/wiki/Center_of_thrust", "anchor_text": "center of thrust"}, {"url": "https://arxiv.org/pdf/1707.05110.pdf", "anchor_text": "Jemin Hwangbo, et al., wrote a great paper outlining their research if you\u2019re interested."}, {"url": "https://www.pexels.com/@jimbear?utm_content=attributionCopyText&utm_medium=referral&utm_source=pexels", "anchor_text": "Jimmy Chan"}, {"url": "https://www.pexels.com/photo/photography-of-a-baby-monkey-eating-vegetable-1000529/?utm_content=attributionCopyText&utm_medium=referral&utm_source=pexels", "anchor_text": "Pexels"}, {"url": "http://udacity.com", "anchor_text": "Udacity\u2019s"}, {"url": "https://github.com/udacity/RL-Quadcopter", "anchor_text": "check it out"}, {"url": "https://www.pexels.com/photo/adorable-angry-animal-animal-portrait-208984/", "anchor_text": "Pixabay via Pexels"}, {"url": "https://arxiv.org/abs/1509.02971", "anchor_text": "this Deep Deterministic Policy Gradients paper"}, {"url": "https://en.wikipedia.org/wiki/Gaussian_noise", "anchor_text": "Gaussian noise"}, {"url": "https://en.wikipedia.org/wiki/Ornstein%E2%80%93Uhlenbeck_process", "anchor_text": "You can read about the Ornstein\u2013Uhlenbeck process here"}, {"url": "https://www.pexels.com/@jvdm?utm_content=attributionCopyText&utm_medium=referral&utm_source=pexels", "anchor_text": "Jean van der Meulen"}, {"url": "https://www.pexels.com/photo/brown-and-gray-bird-1526410/?utm_content=attributionCopyText&utm_medium=referral&utm_source=pexels", "anchor_text": "Pexels"}, {"url": "https://en.wikipedia.org/wiki/Rectifier_(neural_networks)", "anchor_text": "ReLU activation function"}, {"url": "https://github.com/udacity/RL-Quadcopter", "anchor_text": "If you want to take a look at the original project, you can find it here"}, {"url": "https://github.com/bonn0062/quadcopter2", "anchor_text": "it\u2019s on GitHub"}, {"url": "https://www.linkedin.com/in/annebonnerdata/", "anchor_text": "@annebonnerdata"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----e6ee5033fd61---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----e6ee5033fd61---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/technology?source=post_page-----e6ee5033fd61---------------technology-----------------", "anchor_text": "Technology"}, {"url": "https://medium.com/tag/programming?source=post_page-----e6ee5033fd61---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/tag/towards-data-science?source=post_page-----e6ee5033fd61---------------towards_data_science-----------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fe6ee5033fd61&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-train-your-quadcopter-adventures-in-machine-learning-algorithms-e6ee5033fd61&user=Anne+Bonner&userId=a71060a2ef24&source=-----e6ee5033fd61---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fe6ee5033fd61&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-train-your-quadcopter-adventures-in-machine-learning-algorithms-e6ee5033fd61&user=Anne+Bonner&userId=a71060a2ef24&source=-----e6ee5033fd61---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe6ee5033fd61&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-train-your-quadcopter-adventures-in-machine-learning-algorithms-e6ee5033fd61&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----e6ee5033fd61--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fe6ee5033fd61&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-train-your-quadcopter-adventures-in-machine-learning-algorithms-e6ee5033fd61&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----e6ee5033fd61---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----e6ee5033fd61--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----e6ee5033fd61--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----e6ee5033fd61--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----e6ee5033fd61--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----e6ee5033fd61--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----e6ee5033fd61--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----e6ee5033fd61--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----e6ee5033fd61--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@annebonner?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@annebonner?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Anne Bonner"}, {"url": "https://medium.com/@annebonner/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "6.4K Followers"}, {"url": "http://bit.ly/submissions2023", "anchor_text": "http://bit.ly/submissions2023"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fa71060a2ef24&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-train-your-quadcopter-adventures-in-machine-learning-algorithms-e6ee5033fd61&user=Anne+Bonner&userId=a71060a2ef24&source=post_page-a71060a2ef24--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F29e21558a591&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-train-your-quadcopter-adventures-in-machine-learning-algorithms-e6ee5033fd61&newsletterV3=a71060a2ef24&newsletterV3Id=29e21558a591&user=Anne+Bonner&userId=a71060a2ef24&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}