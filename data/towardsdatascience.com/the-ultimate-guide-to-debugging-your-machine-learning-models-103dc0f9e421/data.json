{"url": "https://towardsdatascience.com/the-ultimate-guide-to-debugging-your-machine-learning-models-103dc0f9e421", "time": 1683012591.432758, "path": "towardsdatascience.com/the-ultimate-guide-to-debugging-your-machine-learning-models-103dc0f9e421/", "webpage": {"metadata": {"title": "The Ultimate Guide to Debugging your Machine Learning models | by James Thorn | Towards Data Science", "h1": "The Ultimate Guide to Debugging your Machine Learning models", "description": "You\u2019ve divided your data into a training, development and test set, with the correct percentage of samples in each block, and you\u2019ve also made sure that all of these blocks (specially development and\u2026"}, "outgoing_paragraph_urls": [{"url": "https://towardsdatascience.com/how-to-do-exploratory-data-analysis-e8bfa7db69d9", "anchor_text": "exploratory data analysis", "paragraph_index": 1}, {"url": "https://towardsdatascience.com/an-introduction-to-feature-selection-dd72535ecf2b", "anchor_text": "chosen the best features", "paragraph_index": 1}, {"url": "https://towardsdatascience.com/support-vector-machines-explained-25a685e4d228", "anchor_text": "Support Vector Machine", "paragraph_index": 2}, {"url": "https://towardsdatascience.com/probability-learning-v-naive-bayes-7f1d0466f5f1", "anchor_text": "Naive Bayes", "paragraph_index": 8}, {"url": "https://analyticsindiamag.com/10-popular-datasets-for-sentiment-analysis/", "anchor_text": "some labelled data for sentiment analysis", "paragraph_index": 9}, {"url": "https://towardsdatascience.com/logistic-regression-explained-9ee73cede081", "anchor_text": "Logistic Regression", "paragraph_index": 9}, {"url": "https://towardsdatascience.com/deep-learning-for-nlp-anns-rnns-and-lstms-explained-95866c1db2e4", "anchor_text": "Recurrent Neural Network", "paragraph_index": 10}, {"url": "https://medium.com/@jaimezornoza", "anchor_text": "follow me on Medium", "paragraph_index": 40}, {"url": "https://howtolearnmachinelearning.com/", "anchor_text": "this repository", "paragraph_index": 40}], "all_paragraphs": ["You\u2019ve divided your data into a training, development and test set, with the correct percentage of samples in each block, and you\u2019ve also made sure that all of these blocks (specially development and test set) come from the same distribution.", "You\u2019ve done some exploratory data analysis, gathered insights from this data, and chosen the best features for the task at hand. You\u2019ve also chosen an evaluation metric that is well suited for your problem. Using this metric you will be able to iterate and change the hyper-parameters and configuration of your models in the quest to obtain the best possible performance.", "After all this, you pre-process the data, prepare it, and finally train a model (lets say a Support Vector Machine). You wait patiently, and once it has finished training you dispose yourself to evaluate the results, which are the following:", "How should we look at these results? What can we compare them against? How can we improve them? Is it possible to do it?", "In this post we will answer all of these questions in an easy, accessible manner. This guide is not a debugging guide about setting breakpoints in your code or seeing how training is evolving. It is about knowing what to do when your model is trained and built, how to correctly asses its performance, and seeing how you could improve it.", "When we build our first model and get the initial round of results, it is always desirable to compare this model against some already existing metric, to quickly asses how well it is doing. For this, we have two main strategies: Baseline models and Human-level performance.", "A baseline model is a very simple model that generally yields acceptable results in some kind of task. These results, given by the baseline, are the ones you should try to improve with your new shiny machine learning model.", "In a few words, a baseline is a simple approach towards solving a problem that gives a good enough result, but that should be taken as a starting point for performance. If you build a model that does not surpass baseline model performance on some data, then you should probably rethink what you are doing.", "Lets see an example to get a better idea of how this works: In Natural Language Processing (NLP) one of the most common problems is that of Sentiment Analysis: detecting the mood, feeling or sentiment of a certain sentence, which could be positive, neutral or negative. A very simple model that can do this, is Naive Bayes: it is very transparent, fast on the training, and generally gives acceptable results, however, these are far from being optimal.", "Imagine, you gather some labelled data for sentiment analysis, pre-process the data, train a Naive Bayes model and get 65% accuracy. Because we are taking Naive Bayes as a Baseline model for this task, with every further model we build, we should aim to beat this 65% accuracy. If we train a Logistic Regression and get 55% performance, then we should probably re-think what we are doing.", "We might come to the conclusion that non-neural models are not fit for this task, train an initial Recurrent Neural Network, and get 70%. Now, as we have beaten the baseline, we can try to keep improving this RNN to get better and better performance.", "In the recent years, it has become usual for Machine Learning algorithms to not only produce excellent results in many fields, but to achieve even better results than human experts in those specific fields. Because of this, an useful metric to compare the performance of an algorithm on a certain task is Human Level Performance on that same task.", "Lets see an example so that you can quickly grasp how this works. Imagine that a cardiovascular doctor can look at the health parameters of patients and diagnose with only three errors out of every one-hundred patients if the patient has a certain disease or not.", "Now, we build a Machine learning model to look at these same parameters and diagnose the absence or presence of this previous disease. If our model makes 10 errors out of every 100 diagnoses, then there is a lot of room for improvement, (the expert makes 7 fewer errors for every 100 patients; he has a 7% lower error rate), however, if our model makes 1 failed prediction out 100, it is surpassing human level performance, and therefore doing quite well.", "Model test data performance: 10% error", "Alright, now that we have understood these two metrics, lets progress in the analysis of the results of our Machine Learning models taking Human-level performance as the metric to compare against.", "Understanding how humans perform in a task can guide us towards how to reduce bias and variance. If you don\u2019t know what Bias or Variance are, you can learn about it on the following post:", "Despite humans being awesome at certain tasks, as we have said, Machines can become even better than them, and surpass human level performance. However, there is a certain threshold that neither humans or Machine learning models can surpass: Bayes Optimal error.", "Bayes optimal error is the best theoretical result that can be obtained for a certain task, and can not be improved by any kind of function, natural or artificial.", "Imagine a data set composed of images of traffic lights where some images have an orientation such, and are so blurry that it is impossible, even for humans to get all the correct light colours from these images.", "For this data set, Bayes optimal performance would be the maximum number of images that we can actually correctly classify, as some of them are impossible both for humans and machines.", "For many tasks human level performance is close to Bayes optimal error, so we tend to use human level performance as a proxy or approximation of Bayes optimal error.", "Lets see a more concrete example, with numbers, to get a complete grasp of the relationship between Human level performance, Bayes Optimal error, and the results of our models.", "Imagine a medical image diagnosis task, where a typical doctor achieves a 1% error. Because of this, if we take Human level performance as a proxy for Bayes, we can say that Bayes error is lower or equal to 1%.", "It is important to note that Human level performance has to be defined depending on the context in which the Machine Learning system is going to be deployed.", "Imagine now that we build a Machine learning model and get the following results on this diagnosis task:", "Now, if our Human level performance (proxy for Bayes error) is 1%, what do you think we should focus on improving? The error difference between Bayes Optimal error (1%) and our training set error (7%) or the error difference between training and test set error? We will call the first of these two differences Avoidable bias (between human and training set error) and the second one Variance (between train and test errors).", "Once we know where to optimise, how should we do it? Keep reading to find out!", "Depending on these sizes of these two error differences (avoidable bias and variance) there are different strategies which we ought to apply in order to reduce these errors and get the best possible results out of our models.", "In the previous example, the difference between human level performance and training set error (6%) is a lot bigger than the difference between training and test set error (1%), so we will focus on reducing the avoidable bias. If training set error was 2% however, then the bias would be 1%, and the variance would be 6% and we would focus on reducing variance.", "If bias and variance were very similar, and there was room for improving both, then we would have to see which is least expensive or easier to reduce.", "Lastly, if human level performance, training, and test error where all similar and acceptable, we would leave our awesome model just as it is.", "How do we reduce each of these gaps? Lets take a look first and how to reduce avoidable bias.", "In our search for the best possible Machine learning model, we must look to fit the training set really well without producing over-fitting.", "We will look at how to quantify and reduce this over-fitting in just a bit, but the first thing we have to try to achieve is an acceptable performance on our training set, making the gap between human level performance or Bayes error, and training set error as small as possible.", "For this there are various strategies we can adopt:", "By using these tactics we can make avoidable bias become increasingly low. Now that we know how to do this, lets take a look at how to reduce Variance.", "When our model has high variance, we say that it is over-fitting: it adapts too well to the training data, but generalises badly to data it has not seen before. To reduce this variance, there are various strategies that we can adopt, which differ mostly from the ones we just saw to reduce bias. These strategies are:", "After this, we would have also managed to reduce our variance! Awesome, now we have optimised our Machine Learning model to its full potential.", "That is it! As always, I hope you enjoyed the post, and that I managed to help you understand how to debug and improve the performance of your Machine learning models.", "If you want to learn more about Machine Learning and Artificial Intelligence follow me on Medium, and stay tuned for my next posts! Also, you can check out this repository for more resources on Machine Learning and AI!", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F103dc0f9e421&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-ultimate-guide-to-debugging-your-machine-learning-models-103dc0f9e421&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-ultimate-guide-to-debugging-your-machine-learning-models-103dc0f9e421&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-ultimate-guide-to-debugging-your-machine-learning-models-103dc0f9e421&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-ultimate-guide-to-debugging-your-machine-learning-models-103dc0f9e421&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----103dc0f9e421--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----103dc0f9e421--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://james-thorn.medium.com/?source=post_page-----103dc0f9e421--------------------------------", "anchor_text": ""}, {"url": "https://james-thorn.medium.com/?source=post_page-----103dc0f9e421--------------------------------", "anchor_text": "James Thorn"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F1fd70d25ff14&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-ultimate-guide-to-debugging-your-machine-learning-models-103dc0f9e421&user=James+Thorn&userId=1fd70d25ff14&source=post_page-1fd70d25ff14----103dc0f9e421---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F103dc0f9e421&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-ultimate-guide-to-debugging-your-machine-learning-models-103dc0f9e421&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F103dc0f9e421&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-ultimate-guide-to-debugging-your-machine-learning-models-103dc0f9e421&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://towardsdatascience.com/how-to-do-exploratory-data-analysis-e8bfa7db69d9", "anchor_text": "exploratory data analysis"}, {"url": "https://towardsdatascience.com/an-introduction-to-feature-selection-dd72535ecf2b", "anchor_text": "chosen the best features"}, {"url": "https://towardsdatascience.com/support-vector-machines-explained-25a685e4d228", "anchor_text": "Support Vector Machine"}, {"url": "https://towardsdatascience.com/probability-learning-v-naive-bayes-7f1d0466f5f1", "anchor_text": "Naive Bayes"}, {"url": "https://analyticsindiamag.com/10-popular-datasets-for-sentiment-analysis/", "anchor_text": "some labelled data for sentiment analysis"}, {"url": "https://towardsdatascience.com/logistic-regression-explained-9ee73cede081", "anchor_text": "Logistic Regression"}, {"url": "https://towardsdatascience.com/deep-learning-for-nlp-anns-rnns-and-lstms-explained-95866c1db2e4", "anchor_text": "Recurrent Neural Network"}, {"url": "https://towardsdatascience.com/quick-bias-variance-trade-off-d4895b126b08", "anchor_text": "Quick Bias/Variance Trade-OffThe Bias/Variance trade-off easily explainedtowardsdatascience.com"}, {"url": "https://unsplash.com/photos/YN33ook6s6U", "anchor_text": "Unsplash"}, {"url": "https://towardsdatascience.com/what-is-boosting-in-machine-learning-2244aa196682", "anchor_text": "Boosting model"}, {"url": "https://unsplash.com/photos/Ku3igYrMhD4", "anchor_text": "Unsplash."}, {"url": "https://medium.com/@jaimezornoza", "anchor_text": "follow me on Medium"}, {"url": "https://howtolearnmachinelearning.com/", "anchor_text": "this repository"}, {"url": "https://howtolearnmachinelearning.com/", "anchor_text": "How to Learn Machine Learning - A repository of resources to get into MLLosttrying to discover how to learn Machine Learning? It is an incredible time to learn about this technology, however\u2026howtolearnmachinelearning.com"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----103dc0f9e421---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----103dc0f9e421---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/data-science?source=post_page-----103dc0f9e421---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/startup?source=post_page-----103dc0f9e421---------------startup-----------------", "anchor_text": "Startup"}, {"url": "https://medium.com/tag/programming?source=post_page-----103dc0f9e421---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F103dc0f9e421&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-ultimate-guide-to-debugging-your-machine-learning-models-103dc0f9e421&user=James+Thorn&userId=1fd70d25ff14&source=-----103dc0f9e421---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F103dc0f9e421&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-ultimate-guide-to-debugging-your-machine-learning-models-103dc0f9e421&user=James+Thorn&userId=1fd70d25ff14&source=-----103dc0f9e421---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F103dc0f9e421&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-ultimate-guide-to-debugging-your-machine-learning-models-103dc0f9e421&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----103dc0f9e421--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F103dc0f9e421&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-ultimate-guide-to-debugging-your-machine-learning-models-103dc0f9e421&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----103dc0f9e421---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----103dc0f9e421--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----103dc0f9e421--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----103dc0f9e421--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----103dc0f9e421--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----103dc0f9e421--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----103dc0f9e421--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----103dc0f9e421--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----103dc0f9e421--------------------------------", "anchor_text": ""}, {"url": "https://james-thorn.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://james-thorn.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "James Thorn"}, {"url": "https://james-thorn.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "3K Followers"}, {"url": "https://howtolearnmachinelearning.com/", "anchor_text": "https://howtolearnmachinelearning.com/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F1fd70d25ff14&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-ultimate-guide-to-debugging-your-machine-learning-models-103dc0f9e421&user=James+Thorn&userId=1fd70d25ff14&source=post_page-1fd70d25ff14--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F5ad84c2cef18&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-ultimate-guide-to-debugging-your-machine-learning-models-103dc0f9e421&newsletterV3=1fd70d25ff14&newsletterV3Id=5ad84c2cef18&user=James+Thorn&userId=1fd70d25ff14&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}