{"url": "https://towardsdatascience.com/a-primer-on-computer-vision-with-julia-2c7068a35b32", "time": 1683001790.3145049, "path": "towardsdatascience.com/a-primer-on-computer-vision-with-julia-2c7068a35b32/", "webpage": {"metadata": {"title": "A Primer in Computer Vision with Julia | by Julien Pascal | Towards Data Science", "h1": "A Primer in Computer Vision with Julia", "description": "This post is a crash course on convolutional neural network (CNN) using Julia. A CNN is a fancy function that can be \u201ctrained\u201d to recognize patterns in images. In this blog post, I introduce the\u2026"}, "outgoing_paragraph_urls": [{"url": "https://en.wikipedia.org/wiki/MNIST_database", "anchor_text": "MNIST dataset", "paragraph_index": 0}, {"url": "https://github.com/JulienPascal/CNNPrimer", "anchor_text": "here", "paragraph_index": 1}, {"url": "https://en.wikipedia.org/wiki/Curse_of_dimensionality", "anchor_text": "curse of dimensionality", "paragraph_index": 2}, {"url": "https://en.wikipedia.org/wiki/Rectifier_(neural_networks)", "anchor_text": "ReLU", "paragraph_index": 8}, {"url": "https://papers.nips.cc/paper/4824-imagenet-classification-with-deep-convolutional-neural-networks", "anchor_text": "\u201cImageNet Classification with Deep Convolutional Neural Networks\u201d", "paragraph_index": 11}, {"url": "https://en.wikipedia.org/wiki/Vanishing_gradient_problem", "anchor_text": "the vanishing gradient problem", "paragraph_index": 13}, {"url": "https://en.wikipedia.org/wiki/Cross_entropy", "anchor_text": "cross entropy", "paragraph_index": 15}, {"url": "https://arxiv.org/abs/1412.6980", "anchor_text": "ADAM", "paragraph_index": 15}, {"url": "https://julienpascal.github.io/post/ols_ml/", "anchor_text": "Stochastic Gradient Descent", "paragraph_index": 15}, {"url": "https://github.com/FluxML/model-zoo/blob/master/vision/mnist/conv.jl", "anchor_text": "https://github.com/FluxML/model-zoo/blob/master/vision/mnist/conv.jl", "paragraph_index": 26}, {"url": "https://mitmath.github.io/18337/lecture14/pdes_and_convolutions", "anchor_text": "https://mitmath.github.io/18337/lecture14/pdes_and_convolutions", "paragraph_index": 26}, {"url": "http://cs231n.github.io/convolutional-networks/", "anchor_text": "http://cs231n.github.io/convolutional-networks/", "paragraph_index": 26}, {"url": "https://julienpascal.github.io/post/cnn/", "anchor_text": "https://julienpascal.github.io", "paragraph_index": 27}], "all_paragraphs": ["This post is a crash course on convolutional neural network (CNN) using Julia. A CNN is a fancy function that can be \u201ctrained\u201d to recognize patterns in images. In this blog post, I introduce the \u201cHello World\u201d of computer vision: the classification of hand-written digits from the MNIST dataset. There are thousands of tutorials on the same topic using Python freely available on the Internet.", "Instead, let\u2019s use Julia and the package Flux.jl. Why? Because Julia is fast, and if you have millions of images to analyze, the speedup could be substantial compared to Python. The Jupyter notebook for this blog post can be found here.", "The MNIST dataset contains images of hand-written digits (0 to 9) in grayscale and that are nicely centered. Each pixel is represented by a number in between 0 (black) and 255 (white). Each image is 28 by 28 pixels. One way to represent an image is to see it as a 1d-column vector of 28*28 = 784 pixels. However, this representation ignores the \u201cstructure\u201d of an image: pixels that are close to each other are informative on the digit we are trying to identify. A CNN is a good tool to keep the spatial structure of an image, while avoiding issues linked to the curse of dimensionality: images are noisy and high-dimensional input data.", "Two of the key ingredients of a CNN are a convolutional layer (hence the name) and a maxpool layer.", "A convolutional layer applies a stencil to each point. The output of a convolutional layer is an \u201cimage\u201d of lower dimension, that is informative on some features of the input image (shapes, edges, etc.). The figure below shows how a convolutional layer works:", "A maxpool layer is a stencil that selects the maximum value within a square. Below is an illustration of a maxpool layer applied to a 4 by 4 image:", "When building a CNN, one must specify two hyperparameters: stride and padding", "Below is an example of a 3 by 3 filter applied to a 5 by 5 input padded with a 1 by 1 border of zeros using 2 by 2 strides:", "The typical infrastructure of a CNN is first to apply a convolutional layer to the input image, then to use a maxpool layer, before using a fully-connected layer. Several \u201cconvolutional layer \u2014 maxpool layer\u201d units can be stacked together before using a fully-connected (FC) layer. Note that an activation layer (often ReLU) is generally inserted between the the convolutional and the maxpool layer.", "Flux.jl is a leading machine learning package in the Julia ecosystem. In what follows, we load both the train and the test samples of the MNIST dataset. The train sample is a set of images used to fine-tune the parameters of the CNN, while the test sample contains images used to check that we did not overfit the train sample. A smoking gun for overfitting is when the accuracy in the train sample is much better than the accuracy using images from the test sample.", "Our CNN has the usual Conv->ReLU->MaxPool components, before using a FC layer. We use a 1 by 1 padding and a stride of 1 (the default value). The size of input is gradually reduced by using 2 by 2 maxpool layers. The default activation in Flux.jl is the function is x->x. Here, we use the Rectified Linear Unit function (ReLU) instead:", "The ReLU activation function is a piece-wise linear function. In the \u201cImageNet Classification with Deep Convolutional Neural Networks\u201d paper by Krizhevsky and coauthors, the authors write:", "we refer to neurons with this nonlinearity as Rectified Linear Units (ReLUs). Deep convolutional neural networks with ReLUs train several times faster than their equivalents with tanh units.", "The ReLU activation function also helps in reducing the practical issues caused by the vanishing gradient problem. That is, the failure of the minimization algorithm used to find the parameters of our CNN. Below is a plot of the ReLU activation function:", "The batch size is a parameter that tells us how many images the network will \u201csee\u201d at once when \u201ctraining\u201d. In technical terms, when performing gradient descent, we don\u2019t use all the information at once (because of memory limitations and because it is not necessarily efficient). The following function generates \u201cbatches\u201d of images:", "For the CNN to \u201clearn\u201d anything at all, it must have a notion of \u201cwrong\u201d or \u201cright\u201d. The loss function does exactly that, by quantifying how well the model performs at recognizing digits. When the output is a probability, the cross entropy loss function is appropriate. The final step is to select an algorithm to minimize the loss function. Here, let\u2019s select the ADAM algorithm, which I understand as some sort of Stochastic Gradient Descent with momentum and adaptive learning rate:", "This block \u201ctrains\u201d (fine-tune the CNN parameter values) the model until a pre-determined accuracy level is reached:", "Once the model is trained, predicted values are easily obtained as follows:", "Let\u2019s see how the model performs on the test set. Can the CNN recognize digits using images that were not used when training the model? As you can see below, our model does an amazing job at recognizing hand-written digits:", "We now have a model that seems to do quite a good job in recognizing digits. But can we improve it? If yes, how? To improve our model, we first need to identify when and why it fails.", "To do that, a useful reporting tool is a confusion matrix. Each row of a confusion matrix shows instances of the true value, while each column displays instances of the predicted value. Ideally, we would like our model to perfectly predict the outcome. With a perfect model, all instances would be located on the diagonal elements of the confusion matrix.", "The last time I checked, Flux.jl did not have an in-built function to calculate confusion matrices. Fortunately, an implementation is available in the package MLBase. The next block of code calculates the confusion matrix and displays it. Most of the instances are on located on the diagonal, which is not a surprise given that the accuracy rate of our model is more than 97.0%", "To visualize where our model makes mistakes, one can use the optional argument clim, to put an upper bound on the underlying color-map. For instance, the next plot shows that our model has troubles differentiating 7 and 2 or 8 and 2.", "The next block of code displays digits for which our CNN failed:", "While it seems obvious that the two digits starting from the left (see the plot above) are a 9 and a 6, the remaining 3 elements are not trivial. The 8 in the middle could be easily confused with something else and the two remaining digits are weirdly shaped.", "When dealing with images, a convolutional neural network generally does an amazing job at recognizing patterns. This blog post was a non-technical introduction to the topic. While Python is the tool of predilection in machine learning (Keras, TensorFlow, etc.), my guess is that Julia will get increasingly popular because Julia is both easy to use and fast.", "* The code for this blog post is heavily based on this Flux.jl tutorial: https://github.com/FluxML/model-zoo/blob/master/vision/mnist/conv.jl * On the links between CNN and PDEs: https://mitmath.github.io/18337/lecture14/pdes_and_convolutions* A full course on CNN. Most of the content is available online: http://cs231n.github.io/convolutional-networks/", "Originally published at https://julienpascal.github.io on December 5, 2019.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Economist. In my spare time, I blog on computational techniques, econometrics, machine learning."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F2c7068a35b32&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-primer-on-computer-vision-with-julia-2c7068a35b32&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-primer-on-computer-vision-with-julia-2c7068a35b32&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-primer-on-computer-vision-with-julia-2c7068a35b32&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-primer-on-computer-vision-with-julia-2c7068a35b32&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----2c7068a35b32--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----2c7068a35b32--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@julien.pascal?source=post_page-----2c7068a35b32--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@julien.pascal?source=post_page-----2c7068a35b32--------------------------------", "anchor_text": "Julien Pascal"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F6b4ca9ca7bc9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-primer-on-computer-vision-with-julia-2c7068a35b32&user=Julien+Pascal&userId=6b4ca9ca7bc9&source=post_page-6b4ca9ca7bc9----2c7068a35b32---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F2c7068a35b32&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-primer-on-computer-vision-with-julia-2c7068a35b32&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F2c7068a35b32&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-primer-on-computer-vision-with-julia-2c7068a35b32&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://pixabay.com/users/cocoparisienne-127419/?utm_source=link-attribution&utm_medium=referral&utm_campaign=image&utm_content=1173863", "anchor_text": "cocoparisienne"}, {"url": "https://pixabay.com/?utm_source=link-attribution&utm_medium=referral&utm_campaign=image&utm_content=1173863", "anchor_text": "Pixabay"}, {"url": "https://en.wikipedia.org/wiki/MNIST_database", "anchor_text": "MNIST dataset"}, {"url": "https://github.com/JulienPascal/CNNPrimer", "anchor_text": "here"}, {"url": "https://en.wikipedia.org/wiki/Curse_of_dimensionality", "anchor_text": "curse of dimensionality"}, {"url": "https://mitmath.github.io/18337/lecture14/pdes_and_convolutions", "anchor_text": "https://mitmath.github.io/18337/lecture14/pdes_and_convolutions"}, {"url": "https://mauriciocodesso.com/post/convolution-neural-network/", "anchor_text": "https://mauriciocodesso.com/post/convolution-neural-network/"}, {"url": "http://deeplearning.net/software/theano/tutorial/conv_arithmetic.html", "anchor_text": "http://deeplearning.net/software/theano/tutorial/conv_arithmetic.html"}, {"url": "https://en.wikipedia.org/wiki/Rectifier_(neural_networks)", "anchor_text": "ReLU"}, {"url": "https://towardsdatascience.com/visualizing-the-fundamentals-of-convolutional-neural-networks-6021e5b07f69", "anchor_text": "https://towardsdatascience.com/visualizing-the-fundamentals-of-convolutional-neural-networks-6021e5b07f69"}, {"url": "https://papers.nips.cc/paper/4824-imagenet-classification-with-deep-convolutional-neural-networks", "anchor_text": "\u201cImageNet Classification with Deep Convolutional Neural Networks\u201d"}, {"url": "https://en.wikipedia.org/wiki/Vanishing_gradient_problem", "anchor_text": "the vanishing gradient problem"}, {"url": "https://en.wikipedia.org/wiki/Cross_entropy", "anchor_text": "cross entropy"}, {"url": "https://arxiv.org/abs/1412.6980", "anchor_text": "ADAM"}, {"url": "https://julienpascal.github.io/post/ols_ml/", "anchor_text": "Stochastic Gradient Descent"}, {"url": "https://github.com/FluxML/model-zoo/blob/master/vision/mnist/conv.jl", "anchor_text": "https://github.com/FluxML/model-zoo/blob/master/vision/mnist/conv.jl"}, {"url": "https://mitmath.github.io/18337/lecture14/pdes_and_convolutions", "anchor_text": "https://mitmath.github.io/18337/lecture14/pdes_and_convolutions"}, {"url": "http://cs231n.github.io/convolutional-networks/", "anchor_text": "http://cs231n.github.io/convolutional-networks/"}, {"url": "https://julienpascal.github.io/post/cnn/", "anchor_text": "https://julienpascal.github.io"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----2c7068a35b32---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/julia?source=post_page-----2c7068a35b32---------------julia-----------------", "anchor_text": "Julia"}, {"url": "https://medium.com/tag/computer-vision?source=post_page-----2c7068a35b32---------------computer_vision-----------------", "anchor_text": "Computer Vision"}, {"url": "https://medium.com/tag/cnn?source=post_page-----2c7068a35b32---------------cnn-----------------", "anchor_text": "Cnn"}, {"url": "https://medium.com/tag/flux?source=post_page-----2c7068a35b32---------------flux-----------------", "anchor_text": "Flux"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F2c7068a35b32&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-primer-on-computer-vision-with-julia-2c7068a35b32&user=Julien+Pascal&userId=6b4ca9ca7bc9&source=-----2c7068a35b32---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F2c7068a35b32&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-primer-on-computer-vision-with-julia-2c7068a35b32&user=Julien+Pascal&userId=6b4ca9ca7bc9&source=-----2c7068a35b32---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F2c7068a35b32&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-primer-on-computer-vision-with-julia-2c7068a35b32&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----2c7068a35b32--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F2c7068a35b32&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-primer-on-computer-vision-with-julia-2c7068a35b32&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----2c7068a35b32---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----2c7068a35b32--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----2c7068a35b32--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----2c7068a35b32--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----2c7068a35b32--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----2c7068a35b32--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----2c7068a35b32--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----2c7068a35b32--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----2c7068a35b32--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@julien.pascal?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@julien.pascal?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Julien Pascal"}, {"url": "https://medium.com/@julien.pascal/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "344 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F6b4ca9ca7bc9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-primer-on-computer-vision-with-julia-2c7068a35b32&user=Julien+Pascal&userId=6b4ca9ca7bc9&source=post_page-6b4ca9ca7bc9--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F63b8df90203d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-primer-on-computer-vision-with-julia-2c7068a35b32&newsletterV3=6b4ca9ca7bc9&newsletterV3Id=63b8df90203d&user=Julien+Pascal&userId=6b4ca9ca7bc9&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}