{"url": "https://towardsdatascience.com/from-a-computer-vision-idea-to-an-mvp-the-model-part-2-acca969ef56b", "time": 1683013413.932883, "path": "towardsdatascience.com/from-a-computer-vision-idea-to-an-mvp-the-model-part-2-acca969ef56b/", "webpage": {"metadata": {"title": "From a Vision idea to Production: Part 2 | by Aditi Khandelwal | Towards Data Science", "h1": "From a Vision idea to Production: Part 2", "description": "Our goal is to do Multiclass image classification where the aim is to classify which bulb type the image belongs to among 6. Since the problem is a fresh one and has not been tried upon, I was told\u2026"}, "outgoing_paragraph_urls": [{"url": "https://cloud.google.com/automl/", "anchor_text": "AutoML", "paragraph_index": 28}, {"url": "https://cloud.google.com/vision/automl/docs/", "anchor_text": "Google Cloud AutoML Vision Edge", "paragraph_index": 29}, {"url": "https://cloud.google.com/vision/automl/docs/edge-quickstart", "anchor_text": "google edge", "paragraph_index": 30}, {"url": "https://cloud.google.com/automl/", "anchor_text": "AutoML", "paragraph_index": 33}, {"url": "https://www.tensorflow.org/js", "anchor_text": "TensorFlow.js", "paragraph_index": 42}], "all_paragraphs": ["This article talks about the model that was built for multi-class bulb classification.", "What will we look at with this Article?1.Build a multiclass classifier from scratch on Google Collab/Jupyter NotebookAlternatively you could build a model using Google\u2019s Auto ML software as a validation metric or just use the Google model as it is 2.Use the Google Auto ML model for validation of the model.** This step requires you to have a Google cloud account to train your model on the cloud alternatively you can use the model that we train from scratch for deployment.", "Our goal is to do Multiclass image classification where the aim is to classify which bulb type the image belongs to among 6.", "Since the problem is a fresh one and has not been tried upon, I was told to start with a single label classification, we started by determining whether the image was of an MR16 Bulb or not. The picture below denotes the Predicted value and the actual value where 0 is MR16 and 1 is other.", "I used Google collaboratory because it leverages GPU usage which would help you train your model 10X faster than your local machine. You might want to upgrade your google collab to the pro version to increase its RAM and helps it to not disconnect if your screen switches off.", "Train validation and test splitTrain: 6003 imagesValidation:266 imagesTest:383 imagesSince we had a large dataset, we had enough images to validate and test it on and therefor most images were put in the train set.", "This is the structure of the train and validation set are both expected to have a similar structure with a folder for every label which would contain images of the same as depicted above.", "As you can see in the above picture, the test folder should also contain a single folder inside which all the test images are present(Think of it as \u201cunlabeled\u201d class, this is there because the flow_from_directory() expects at least one directory under the given directory path).", "The folder names for the classes are important, name(or rename) them with respective label names so that it would be easy for you later.Once you set up the images into the above structure, you are ready to code!", "These are the 6 classes of bulbs that I tried to classify at first. I first Checked out how many images I have of each label to make sure my data set is balanced.", "Check out how many images you have of each label to make sure your data set is balanced.", "The class mode=categorical performs one-hot encoding and stores the label.", "Let\u2019s see what the class_mode= categorical does when it comes out of the generator?", "It took me a while to get to what the generator outputs and how it stores the images and labels, there was no documentation for this, here it goes:", "Know that the way the data is structured is that there are 32 images in each batch. The image is stored with the label displayed in the image as [a][b][c] where:[a]= batch number of the image [b]= b takes values 0 and 1 where [a][1][c] stores the label of the image and [a][0][c] stores the image itself. [c]=image number in that batch.", "I have been asked a couple of times by people new to Computer vision, What does each layer learn in a CNN? The diagram below shows what each layer in the CNN picks and learns from the images.", "Now we create our model. The first step is to initialize the model with Sequential(). After that, we flatten our data and add our additional 3 (or more) hidden layers. This step is fully customizable to what you want. We made several different models with different dropouts, hidden layers, and activation.", "For multi-class classification, the last dense layer must have several nodes equal to the number of classes, followed by softmax activation, i.e. the last two layers of your model should be:", "It is also best for loss to be categorical cross-entropy. I tried a variety of Transfer learning models including the ResNet, VGGnet, and Inception since these models are both widely used for transfer learning because of their performance and specific architectural innovations. I tried turning the last few layers of these models but they didn\u2019t seem to give better results, therefore, I would believe that they are not a good fit for distinguishing the kind of images I am using ( i.e different types of bulbs)", "Then after I created and compiled our model, we fit our training and validation data to it with the specifications we mentioned earlier. Finally, we create an evaluation step, to check for the accuracy of our model training set versus the validation set.", "This is our model now training the data and then validating it. An epoch is how many times the model trains on our whole data set. A batch can be explained as taking in small amounts, train and take some more. Each epoch must finish all batch before moving to the next epoch. Training with too little epoch can lead to underfitting the data and too many will lead to overfitting the data. You also want a loss that is as low as possible. The pictures below will show the accuracy and loss of our data set.", "This picture below shows how well the machine we just made can predict against unseen data. Notice it says that it\u2019s testing on test_data. Accuracy is the second number. However, this is not the only method of checking how well our machines performed.There are two great methods to see how well your machine can predict or classify. One of them is the classification metrics and the other is the confusion matrix.Our classification metrics show that our model has relatively high precision accuracy for all our image categories, letting us know that this is a valid model", "To use classification metrics, we had to convert our testing data into a different NumPy format, NumPy array, to read. That is all the first line of code is doing. The second cell block takes in the converted code and runs it through the built-in classification metrics to give us a neat result. Please note that due to our generator function we didn\u2019t need to manually label our classes here, since we set class= categorical while taking an input. The important factors here are precision and f1-score. The higher the score the better your model is.", "As we can see in our standardized data, our machine is pretty good at classifying which bulb is what. MR16\u2019s were misclassified as PAR203038 most likely due to their similar structure. Also, PAR203038 was misclassified as MR16 because of probably the same reason.", "The final phase is testing on images. The cell blocks below will accomplish that:", "The first def function is letting our machine know that it has to load the image, change the size, and convert it to an array which can be accessed at GitHub. The second def function is using the prediction model and an iterative function to help predict the image properly. The path is where we define the image location and finally, the test_single_image cell block will print out the final result, depending on the prediction from the second cell block.This is the final result that our model gives:", "PRO HACK: You can directly use the Google Auto ML model to train the data and then try to incorporate the model weights and model.json in the app we try to build.", "While working on this project I came across Google\u2019s Auto ML software, and Since 78% accuracy is what I was able to get, even after trying different transfer models and tuning the hyperparameters, I decided to Validate my model by training my data with an Auto ML model.", "AutoML is a suite of machine learning products that enables developers with limited machine learning expertise to train high-quality models specific to their business needs. It\u2019s a neural net that can design neural nets.", "I will share how I trained a custom machine learning model from scratch using Google Cloud AutoML Vision Edge.", "You can learn more about google edge computer vision auto ml model at :I don\u2019t want to make the tutorial verbose and document the steps of training your Vision edge model that is done well above!", "Once we\u2019re ready with a clean dataset, we can get started by setting up our Google Cloud project.", "1. We can follow this guide to create a Google Cloud project:", "2. The next step is to create our dataset on the AutoML page. Here, as you can see in the snapshot, we will use single-label classification. Single-label classification is used when an image can belong to a single class. In our, bulb identification problem, every image will be labeled as either of the six labels, i.e a single-class label. In multi-label classification, a single image can belong to multiple classes simultaneously.", "This Video explains well how you upload and train your data in Auto ml and takes your through it step by step.", "After this initial project setup, we\u2019ll use the \u201cImport\u201d button and import the dog and cat folders with their respective images.", "Note: A best practice is to upload all out images to Google Cloud Storage Bucket and then import the bucket from the AutoML dashboard.", "After the upload, we can see all the images under the \u201cImages\u201d tab. This is how your data looks once it\u2019s uploaded, I suggest you upload zip folders of different classes in your bucket which helps the process be more efficient and convenient.", "Once you see your images get reflected in the AutoML dashboard, you train your model.", "Training this model is very easy with AutoML \u2014 go to the Train tab and click Train New Model. Once training is completed, we\u2019ll get an email notification.", "Before training, you should decide how your model will be consumed \u2014 as an API (online prediction) or on an edge device (offline predictions). Online Predictions are the best way to test the results or if you want to consume the model directly through the AutoML API. They are more accurate. Offline models save a lot of costs and can run on-device. They are generally less in size and can run without an internet connection. We use an edge device since I am interested in making an app that can run on any machine.", "For the evaluation of the model, we know Precision refers to the percentage of your results that are relevant. On the other hand, recall refers to the percentage of the total relevant results correctly classified by your algorithm.Check out the recall and precision values of our Bulb classifier.", "After training, the model can be consumed in various formats provided by AutoML, such as TF Lite, Core ML , Tensorflow.js, and other container export formats.TensorFlow.js is a library that helps to use ML directly in the browser. AutoML takes very little time to create a model and TensorFlow.js is the easiest and the most efficient way to run models directly inside the browser.", "It\u2019s an interesting question with various opinions like a browser is widely present in all the devices whether it is desktop, tablets, or mobiles. So, ML in browsers can create a large impact. From the user\u2019s perspective, the ML model can be easily set up in a browser without any drivers, libraries, etc. All the data stays on the user\u2019s device, with no need to send data to servers.", "The process of using AutoML\u2019s TensorFlow.js the model format requires two steps: exporting the model and then loading it for inference.", "The following step-by-step instructions will help you load any TF.js-based model into the browser.Once you click on the Tensorflow.js box, it downloads bin files like shown and this is how your directory should look once you\u2019re ready to deploy.", "Once the model is exported, you\u2019ll see a model.json file, which contains the tensor information along with the weight file names and files containing the model weights. Download all the files from the bucket into your local system.", "We will walk through the process of creating a web app deployed in Heroku that can be used by anyone on the web however the instructions here are a good starting point to try out.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Science Enthusiast | MS in Business Analytics at Columbia University"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Facca969ef56b&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffrom-a-computer-vision-idea-to-an-mvp-the-model-part-2-acca969ef56b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffrom-a-computer-vision-idea-to-an-mvp-the-model-part-2-acca969ef56b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffrom-a-computer-vision-idea-to-an-mvp-the-model-part-2-acca969ef56b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffrom-a-computer-vision-idea-to-an-mvp-the-model-part-2-acca969ef56b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----acca969ef56b--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----acca969ef56b--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@ak4426?source=post_page-----acca969ef56b--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@ak4426?source=post_page-----acca969ef56b--------------------------------", "anchor_text": "Aditi Khandelwal"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fcee367d60d94&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffrom-a-computer-vision-idea-to-an-mvp-the-model-part-2-acca969ef56b&user=Aditi+Khandelwal&userId=cee367d60d94&source=post_page-cee367d60d94----acca969ef56b---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Facca969ef56b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffrom-a-computer-vision-idea-to-an-mvp-the-model-part-2-acca969ef56b&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Facca969ef56b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffrom-a-computer-vision-idea-to-an-mvp-the-model-part-2-acca969ef56b&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://arxiv.org/pdf/1311.2901.pdf", "anchor_text": "https://arxiv.org/pdf/1311.2901.pdf"}, {"url": "https://cloud.google.com/automl/", "anchor_text": "AutoML"}, {"url": "https://cloud.google.com/vision/automl/docs/", "anchor_text": "Google Cloud AutoML Vision Edge"}, {"url": "https://cloud.google.com/vision/automl/docs/edge-quickstart", "anchor_text": "google edge"}, {"url": "https://cloud.google.com/dataproc/docs/guides/setup-project", "anchor_text": "Set up a project | Dataproc Documentation | Google CloudSign in to your Google Account. If you don\u2019t already have one, sign up for a new account. In the Cloud Console, on the\u2026cloud.google.com"}, {"url": "https://cloud.google.com/automl/", "anchor_text": "AutoML"}, {"url": "https://www.tensorflow.org/js", "anchor_text": "TensorFlow.js"}, {"url": "https://cloud.google.com/vision/automl/docs/tensorflow-js-tutorial", "anchor_text": "Edge TensorFlow.js tutorial | Cloud AutoML Vision DocumentationTerminology: See the AutoML Vision Edge terminology page for a list of terms used in this tutorial. In this tutorial\u2026cloud.google.com"}, {"url": "https://github.com/aditi310896/Bulbdetection/blob/master/Multiclassmodeltrial1.ipynb", "anchor_text": "https://github.com/aditi310896/Bulbdetection/blob/master/Multiclassmodeltrial1.ipynb"}, {"url": "https://medium.com/tag/neural-networks?source=post_page-----acca969ef56b---------------neural_networks-----------------", "anchor_text": "Neural Networks"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----acca969ef56b---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----acca969ef56b---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/computer-vision?source=post_page-----acca969ef56b---------------computer_vision-----------------", "anchor_text": "Computer Vision"}, {"url": "https://medium.com/tag/app-development?source=post_page-----acca969ef56b---------------app_development-----------------", "anchor_text": "App Development"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Facca969ef56b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffrom-a-computer-vision-idea-to-an-mvp-the-model-part-2-acca969ef56b&user=Aditi+Khandelwal&userId=cee367d60d94&source=-----acca969ef56b---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Facca969ef56b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffrom-a-computer-vision-idea-to-an-mvp-the-model-part-2-acca969ef56b&user=Aditi+Khandelwal&userId=cee367d60d94&source=-----acca969ef56b---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Facca969ef56b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffrom-a-computer-vision-idea-to-an-mvp-the-model-part-2-acca969ef56b&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----acca969ef56b--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Facca969ef56b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffrom-a-computer-vision-idea-to-an-mvp-the-model-part-2-acca969ef56b&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----acca969ef56b---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----acca969ef56b--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----acca969ef56b--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----acca969ef56b--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----acca969ef56b--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----acca969ef56b--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----acca969ef56b--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----acca969ef56b--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----acca969ef56b--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@ak4426?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@ak4426?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Aditi Khandelwal"}, {"url": "https://medium.com/@ak4426/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "17 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fcee367d60d94&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffrom-a-computer-vision-idea-to-an-mvp-the-model-part-2-acca969ef56b&user=Aditi+Khandelwal&userId=cee367d60d94&source=post_page-cee367d60d94--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fusers%2Fcee367d60d94%2Flazily-enable-writer-subscription&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffrom-a-computer-vision-idea-to-an-mvp-the-model-part-2-acca969ef56b&user=Aditi+Khandelwal&userId=cee367d60d94&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}