{"url": "https://towardsdatascience.com/object-detection-in-6-steps-using-detectron2-705b92575578", "time": 1683011872.108233, "path": "towardsdatascience.com/object-detection-in-6-steps-using-detectron2-705b92575578/", "webpage": {"metadata": {"title": "Object Detection in 6 steps using Detectron2 | by Aakarsh Yelisetty | Towards Data Science", "h1": "Object Detection in 6 steps using Detectron2", "description": "Have you ever tried training an object detection model using a custom dataset of your own choice from scratch? If yes, you\u2019d know how tedious the process would be. We need to start with building a\u2026"}, "outgoing_paragraph_urls": [{"url": "https://github.com/facebookresearch/detectron2/blob/master/MODEL_ZOO.md", "anchor_text": "model zoo", "paragraph_index": 3}, {"url": "https://github.com/aakarsh7599/Text-Detection-using-Detectron2", "anchor_text": "Google Colab Notebook", "paragraph_index": 12}, {"url": "https://detectron2.readthedocs.io/tutorials/builtin_datasets.html", "anchor_text": "builtin datasets", "paragraph_index": 15}, {"url": "https://colab.research.google.com/drive/1q-gwQteO79r8sX59oYnHYCNtP9zXWFPN?usp=sharing", "anchor_text": "Colab Notebook", "paragraph_index": 18}, {"url": "https://detectron2.readthedocs.io/modules/structures.html#detectron2.structures.BoxMode", "anchor_text": "structures.BoxMode", "paragraph_index": 20}, {"url": "https://towardsdatascience.com/understanding-fast-r-cnn-and-faster-r-cnn-for-object-detection-adbb55653d97", "anchor_text": "previous article", "paragraph_index": 28}, {"url": "https://tarangshah.com/blog/2018-01-27/what-is-map-understanding-the-statistic-of-choice-for-comparing-object-detection-models/", "anchor_text": "article", "paragraph_index": 34}, {"url": "https://colab.research.google.com/drive/1d0kXs-TE7_3CXldJNs1WsEshXf8Gw_5n?usp=sharing", "anchor_text": "Colab Notebook", "paragraph_index": 36}, {"url": "https://github.com/aakarsh7599/Text-Detection-using-Detectron2", "anchor_text": "Github repository", "paragraph_index": 40}, {"url": "https://towardsdatascience.com/understanding-object-detection-and-r-cnn-e39c16f37600", "anchor_text": "previous article", "paragraph_index": 41}, {"url": "https://www.linkedin.com/in/aakarsh-yelisetty-6b691b171/", "anchor_text": "LinkedIn", "paragraph_index": 42}], "all_paragraphs": ["Have you ever tried training an object detection model using a custom dataset of your own choice from scratch?", "If yes, you\u2019d know how tedious the process would be. We need to start with building a model using a Feature Pyramid Network combined with a Region Proposal Network if we opt for region proposal based methods such as Faster R-CNN or we can also use one-shot detector algorithms like SSD and YOLO.", "Either of them is a bit complicated to work with if we want to implement it from scratch. We need a framework where we can use state-of-the-art models such as Fast, Faster, and Mask R-CNNs with ease. Nevertheless, it is important to try building a model at least once from scratch to understand the math behind it.", "Detectron 2 comes to the rescue if we want to train an object detection model in a snap with a custom dataset. All the models present in the model zoo of the Detectron 2 library are pre-trained on COCO Dataset. We just need to fine-tune our custom dataset on the pre-trained model.", "Detectron 2 is a complete rewrite of the first Detectron which was released in the year 2018. The predecessor was written on Caffe2, a deep learning framework that is also backed by Facebook. Both the Caffe2 and Detectron are now deprecated. Caffe2 is now a part of PyTorch and the successor, Detectron 2 is completely written on PyTorch.", "Detectron2 is meant to advance machine learning by offering speedy training and addressing the issues companies face when making the step from research to production.", "These are the various types of Object Detection models that the Detectron 2 offers.", "Let\u2019s dive into Instance Detection directly.", "Instance Detection refers to the classification and localization of an object with a bounding box around it. In this article, We are going to deal with identifying the language of text from images using the Faster RCNN model from the Detectron 2\u2019s model zoo.", "Note that we are going to limit our languages by 2.", "We identify Hindi and English Text and we include a class labeled Others for other languages.", "We\u2019ll implement a model where the output would be in this way.", "Using Detectron 2, Object Detection can be performed on any custom dataset using seven steps. All the steps are readily available in this Google Colab Notebook and you can run it straight away!", "Using Google Colab for this would be an easy task as we can use a GPU for faster training.", "Kickstart with installing a few dependencies such as Torch Vision and COCO API and check whether CUDA is available. CUDA helps in keeping track of the currently selected GPU. And then install Detectron2.", "Datasets that have builtin support in detectron2 are listed in builtin datasets. If you want to use a custom dataset while also reusing detectron2\u2019s data loaders, you will need to Register your dataset (i.e., tell detectron2 how to obtain your dataset).", "We use our Text Detection Dataset which has three classes:", "We\u2019ll train a text detection model from an existing model pre-trained on the COCO dataset, available in detectron2\u2019s model zoo.", "If you\u2019re interested to know the conversion from the raw format of the dataset to the format that Detectron 2 accepts, checkout this Colab Notebook.", "There are certain formats in how data can be fed to a model such as a YOLO format, PASCAL VOC format, COCO format, etc. Detectron2 accepts the COCO Format of the dataset. COCO format of the dataset consists of a JSON file which includes all the details of an image such as size, annotations (i.e., bounding box coordinates), labels corresponding to it\u2019s bounding box, etc. For example,", "This is how the JSON looks like for one image. There are different types of formats for the bounding box representation. It must be a member of structures.BoxMode for Detectron2. There are 5 such formats. But currently, it supports BoxMode.XYXY_ABS, BoxMode.XYWH_ABS. We use the second format. The (X, Y) represents one coordinate of the bounding box, and W, H represents Width and Height of that box. The category_id refers to the class the box belongs to.", "Then, we need to register our dataset.", "To verify the data loading is correct, let\u2019s visualize the annotations of randomly selected samples in the training set.", "We\u2019ll randomly pick 3 pictures from the train folder of our dataset and see how the bounding boxes look like.", "The output looks in this way,", "The big step. This is the step where we give configurations and set the model ready to get trained. Technically, we just fine-tune our model on the dataset as the model is already pre-trained on COCO Dataset.", "There are a ton of models available for object detection in the Detectron2\u2019s Model Zoo. Here, we use the faster_rcnn_R_50_FPN_3x model which looks in this way on a high level.", "There\u2019d be a Backbone Network (Resnet in this case) which is used to extract features from the image followed by a Region Proposal Network for proposing region proposals and a Box Head for tightening the bounding box.", "You can read more about how Faster R-CNN works in my previous article.", "Let\u2019s set the configuration for training.", "I wouldn\u2019t say this is the best configuration. Surely, the accuracy may get improved for other configs as well. After all, it depends on choosing the right hyperparameters.", "Note that, here we also calculate the accuracy for every 500 iterations on the Validation Set.", "It\u2019s time to infer the results by testing the model on the Validation Set.", "An output folder gets saved in the local storage after successful completion of training in which the final weights are stored. You can save this folder for inferencing from this model in the future.", "Usually, the model is evaluated following the COCO Standards of evaluation. Mean Average Precision (mAP) is used to evaluate the performance of the model. Here\u2019s an article that precisely gives an idea on the mAP.", "We get an accuracy of around 79.4% for an IoU of 0.5 which is not that bad. It can be increased certainly by tweaking the parameters a bit and increasing the number of iterations. But keep an eye on training extensively as the model might overfit the training set.", "Go through this Colab Notebook if you need inference from a saved model.", "In this article, I emphasized on the procedure of objection detection using a custom dataset using detectron 2 rather than focusing on gaining higher accuracy.", "Although this seems to be a pretty straight forward process, there\u2019s a lot to explore in Detectron 2\u2019s library. We have a good amount of optimization parameters that can be further tweaked to attain higher accuracy, which completely depends on one\u2019s custom dataset.", "Hope you\u2019ve learned something new today.", "You can download the notebook from my Github repository and try running it on Google Colab or Jupyter Notebooks.", "You could read more about Object Detection and the legacy R-CNN's in my previous article.", "If you\u2019d like to get in touch, connect with me on LinkedIn.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "An ardent learner in the field of AI, blockchain and loves to explore new tech."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F705b92575578&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fobject-detection-in-6-steps-using-detectron2-705b92575578&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fobject-detection-in-6-steps-using-detectron2-705b92575578&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fobject-detection-in-6-steps-using-detectron2-705b92575578&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fobject-detection-in-6-steps-using-detectron2-705b92575578&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----705b92575578--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----705b92575578--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@aakarsh0705?source=post_page-----705b92575578--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@aakarsh0705?source=post_page-----705b92575578--------------------------------", "anchor_text": "Aakarsh Yelisetty"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F4ed920938e13&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fobject-detection-in-6-steps-using-detectron2-705b92575578&user=Aakarsh+Yelisetty&userId=4ed920938e13&source=post_page-4ed920938e13----705b92575578---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F705b92575578&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fobject-detection-in-6-steps-using-detectron2-705b92575578&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F705b92575578&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fobject-detection-in-6-steps-using-detectron2-705b92575578&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://github.com/facebookresearch/detectron2/blob/master/MODEL_ZOO.md", "anchor_text": "model zoo"}, {"url": "https://research.fb.com/wp-content/uploads/2019/12/4.-detectron2.pdf", "anchor_text": "https://research.fb.com/wp-content/uploads/2019/12/4.-detectron2.pdf"}, {"url": "https://github.com/aakarsh7599/Text-Detection-using-Detectron2", "anchor_text": "Google Colab Notebook"}, {"url": "https://download.pytorch.org/whl/cu101/torch_stable.html", "anchor_text": "https://download.pytorch.org/whl/cu101/torch_stable.html"}, {"url": "https://detectron2.readthedocs.io/tutorials/builtin_datasets.html", "anchor_text": "builtin datasets"}, {"url": "https://colab.research.google.com/drive/1q-gwQteO79r8sX59oYnHYCNtP9zXWFPN?usp=sharing", "anchor_text": "Colab Notebook"}, {"url": "https://detectron2.readthedocs.io/modules/structures.html#detectron2.structures.BoxMode", "anchor_text": "structures.BoxMode"}, {"url": "https://medium.com/@hirotoschwert/digging-into-detectron-2-47b2e794fabd", "anchor_text": "Source"}, {"url": "https://towardsdatascience.com/understanding-fast-r-cnn-and-faster-r-cnn-for-object-detection-adbb55653d97", "anchor_text": "previous article"}, {"url": "https://tarangshah.com/blog/2018-01-27/what-is-map-understanding-the-statistic-of-choice-for-comparing-object-detection-models/", "anchor_text": "article"}, {"url": "https://colab.research.google.com/drive/1d0kXs-TE7_3CXldJNs1WsEshXf8Gw_5n?usp=sharing", "anchor_text": "Colab Notebook"}, {"url": "https://github.com/aakarsh7599/Text-Detection-using-Detectron2", "anchor_text": "Github repository"}, {"url": "https://towardsdatascience.com/understanding-object-detection-and-r-cnn-e39c16f37600", "anchor_text": "previous article"}, {"url": "https://www.linkedin.com/in/aakarsh-yelisetty-6b691b171/", "anchor_text": "LinkedIn"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----705b92575578---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/computer-vision?source=post_page-----705b92575578---------------computer_vision-----------------", "anchor_text": "Computer Vision"}, {"url": "https://medium.com/tag/object-detection?source=post_page-----705b92575578---------------object_detection-----------------", "anchor_text": "Object Detection"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----705b92575578---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/towards-data-science?source=post_page-----705b92575578---------------towards_data_science-----------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F705b92575578&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fobject-detection-in-6-steps-using-detectron2-705b92575578&user=Aakarsh+Yelisetty&userId=4ed920938e13&source=-----705b92575578---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F705b92575578&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fobject-detection-in-6-steps-using-detectron2-705b92575578&user=Aakarsh+Yelisetty&userId=4ed920938e13&source=-----705b92575578---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F705b92575578&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fobject-detection-in-6-steps-using-detectron2-705b92575578&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----705b92575578--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F705b92575578&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fobject-detection-in-6-steps-using-detectron2-705b92575578&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----705b92575578---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----705b92575578--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----705b92575578--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----705b92575578--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----705b92575578--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----705b92575578--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----705b92575578--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----705b92575578--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----705b92575578--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@aakarsh0705?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@aakarsh0705?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Aakarsh Yelisetty"}, {"url": "https://medium.com/@aakarsh0705/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "141 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F4ed920938e13&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fobject-detection-in-6-steps-using-detectron2-705b92575578&user=Aakarsh+Yelisetty&userId=4ed920938e13&source=post_page-4ed920938e13--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fe011017c9cea&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fobject-detection-in-6-steps-using-detectron2-705b92575578&newsletterV3=4ed920938e13&newsletterV3Id=e011017c9cea&user=Aakarsh+Yelisetty&userId=4ed920938e13&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}