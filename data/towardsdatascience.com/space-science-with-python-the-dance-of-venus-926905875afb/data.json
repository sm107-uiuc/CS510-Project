{"url": "https://towardsdatascience.com/space-science-with-python-the-dance-of-venus-926905875afb", "time": 1683006685.482961, "path": "towardsdatascience.com/space-science-with-python-the-dance-of-venus-926905875afb/", "webpage": {"metadata": {"title": "Space Science with Python \u2014 The dance of Venus | by Thomas Albin | Towards Data Science", "h1": "Space Science with Python \u2014 The dance of Venus", "description": "This is the 4th part of my Python tutorial series \u201cSpace Science with Python\u201d. All codes that are shown here are uploaded on GitHub. Enjoy! Did you recently take a look at the sky in the evening\u2026"}, "outgoing_paragraph_urls": [{"url": "https://github.com/ThomasAlbin/SpaceScienceTutorial", "anchor_text": "GitHub", "paragraph_index": 0}, {"url": "https://naif.jpl.nasa.gov/pub/naif/toolkit_docs/C/cspice/furnsh_c.html", "anchor_text": "furnsh", "paragraph_index": 8}, {"url": "https://naif.jpl.nasa.gov/pub/naif/toolkit_docs/C/cspice/utc2et_c.html", "anchor_text": "utc2et", "paragraph_index": 8}, {"url": "https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html", "anchor_text": "dataframe", "paragraph_index": 9}, {"url": "https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.apply.html", "anchor_text": "applying", "paragraph_index": 9}, {"url": "https://naif.jpl.nasa.gov/pub/naif/toolkit_docs/C/cspice/phaseq_c.html", "anchor_text": "phaseq", "paragraph_index": 9}, {"url": "https://naif.jpl.nasa.gov/pub/naif/toolkit_docs/C/cspice/phaseq_c.html", "anchor_text": "phaseq", "paragraph_index": 10}, {"url": "https://naif.jpl.nasa.gov/pub/naif/toolkit_docs/C/req/abcorr.html", "anchor_text": "The corresponding SPICE documentation for corrections provides the following descriptions for the terms", "paragraph_index": 12}, {"url": "https://matplotlib.org/", "anchor_text": "matplotlib", "paragraph_index": 21}, {"url": "https://matplotlib.org/api/_as_gen/matplotlib.axes.Axes.axvline.html", "anchor_text": "axvline", "paragraph_index": 21}, {"url": "https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.loc.html", "anchor_text": ".loc[]", "paragraph_index": 21}, {"url": "https://docs.bokeh.org/en/latest/index.html", "anchor_text": "bokeh", "paragraph_index": 29}], "all_paragraphs": ["This is the 4th part of my Python tutorial series \u201cSpace Science with Python\u201d. All codes that are shown here are uploaded on GitHub. Enjoy!", "Did you recently take a look at the sky in the evening? Right after sunset? You may have recognised this very bright star in the sky that is visible for a few hours before it vanishes below the horizon. In a few days, this dot will be gone\u2026 and it will reappear in the morning hours right before sunrise. The evening star will become the morning star.", "This is not a star, but our neighbour planet Venus. In the photo above you can see Venus right below the crescent Moon. Together with Australia\u2019s iconic Uluru this picture is a nice shot of our planet\u2019s landscape with our cosmic neighbours.", "But when are the Moon and Venus is this close constellation? In the last couple of weeks Venus was clearly visible so how many opportunities did we have to see (and to photograph) this beautiful constellation? Python + SPICE can answer that!", "We will reduce the underlying complexity of this problem to a few simple computations that will give us an easy answer to our question (the Conclusion & Outlook section at the end will list additional computational steps that are needed to get an entire expert\u2019s view).", "What do we need to determine the points of time where Venus and Moon are close to each other? Well, we need to compute the phase angle between the Moon and Venus as seen from our home planet. The phase angle is the angle that is enclosed by the two Earth-centric directional vectors that point to the Moon and to Venus.", "We will compute the angular distance between both objects for a certain time period. During the time both objects move along the Sky with changing angular distances to the Sun. We need also to compute a minimum distance between Sun \u2014 Venus and Sun \u2014 Moon. Otherwise we might compute constellations where all three objects are too close (Please note: Never look directly into the Sun; not with your naked eye and not through any devices like a camera\u2019s viewfinder. Wait after sunset to observe and photograph both objects safely. Trying to find Venus or other objects close to the Sun may cause blindness and / or irreparable damages to your eyes!).", "For this tutorial part our SPICE kernel meta file contains only two kernel paths. de432s.bsp is required for the position computation of the celestial bodies and naif0012.tls is the kernel that contains temporal information like leap-seconds.", "After loading the meta file with furnsh, we can define a time interval for our computations: the initial time is set to the beginning of the year 2020 and the end date is the 1st June 2020. The created date-time strings are converted to Ephemeris time (ET) using the SPICE function utc2et. The array TIME_INTERVAL contains all ETs from the initial time to the end time, in 3600 seconds (1 hour) steps.", "To store all relevant information in a common place we use a pandas dataframe (line 3). The ET array is stored (line 6) as well as the corresponding UTC time stamps that are being computed in line 12 +13, by applying the spiceypy function et2datetime. In line 22 to 28 we compute the phase angle between Venus and the Sun as seen from the Earth. For this purpose, we use the SPICE function phaseq. The function returns the angular distance in radians between two objects at a certain Ephemeris time et. The documentation provides a schematic overview on the input parameters target (target body), illmn (illuminating body), and obsrvr (observer body):", "Applying the function and the computational logic of phaseq on our problem leads to the following input parameters:", "Further, we may notice another input parameter called abcorr. In our last tutorials, we computed state and directional vectors, phase angles and other parameters in rather simple \u201csteady states\u201d. Here, we compute the distances in a more precise way, by considering the light time (travelling time of the light) and taking the observes velocity into account. The resulting input argument is LT+S.", "The corresponding SPICE documentation for corrections provides the following descriptions for the terms", "Correct for one-way light time (also called \u201cplanetary aberration\u201d) using a Newtonian formulation. This correction yields the state of the target at the moment it emitted photons arriving at the observer at ET.", "Correct for one-way light time and stellar aberration using a Newtonian formulation. This option modifies the state obtained with the \u2018LT\u2019 option to account for the observer\u2019s velocity relative to the solar system barycenter. The result is the apparent state of the target \u2014 -the position and velocity of the target as seen by the observer.", "These corrections are necessary in our following tutorials, where we will also compute the positions of hazardous Asteroids where a correct timing and observation planning are crucial.", "Now we use the same function to compute the phase angle between the Moon and the Sun\u2026", "\u2026 as well as the phase angle between the Moon and Venus.", "We can now set our requirements for a photogenic Moon \u2014 Venus constellation. A new column is added called PHOTOGENIC, where a binary value represents a \u201cnice\u201d (1) or \u201cnot so nice\u201d (0) constellation. Please note that we set some artificial requirements for this computation. Tastes are different in (Astro-) Photography; so feel free to change the requirements accordingly.", "Here we apply the following requirements in an if-else condition within the lambda function:", "Let\u2019s have a look at the results. We computed the phase angles in a time interval of 3649 hours (152 days). Only 143 hours (6 days) fulfil this requirement!", "We can now show the results in a plot to get a feeling of the changing angular distances and the perfect time slots for our observations. For this purpose, we use matplotlib. Line 10 to 17 plot the three different phase angles vs. the dates. We set some labels for the axes, create a vertical grid for better readability and set the limits for the x axis (line 20 to 27). For the x axis we format the design and locators as little bit (line 30 to 34). Only the beginning of a month is displayed and each smaller locator represents an individual day of the month. The \u201cphotogenic moments\u201d are visualized as vertical blue lines and are created in a for-loop in line 38+39, using the function axvline. To extract the \u201cphotogenic moments\u201d dates, a filtering is applied using the pandas function .loc[]:", "Finally, we add the legend, rotate the dates slightly and store the plot.", "The figure below shows the resulting plot. As you can see, the angles are displayed vs. the date. One Moon orbit around the Earth is around 27 days, resulting in the fast changing pattern for the phase angles Moon \u2014 Sun and Moon \u2014 Venus, respectively. The angular distance between Venus and the Sun reached its maximum a few weeks ago and currently the distance is rapidly decreasing. End of May, the Venus will no be visible since Venus is between the Sun and Earth. This position constellation is called \u201clower conjunction\u201d. In a few weeks, Venus will re-appear as the morning star.", "The blue lines indicate the \u201cphotogenic moments\u201d we have defined earlier. Each Moon revolution contains only 1 to 1.5 days of \u201cthe perfect moment\u201d. Did you take a photo in one of these time slots?", "Unfortunately, there is no opportunity left for May; so we have to wait for the morning star (and motivate ourselves to wake up early). Or we wait \u2026 for the evening star. But when is Venus returning in the evening? With the SPICE functions you learned so far you can try to answer this question! Try to plot the orbit of Venus and Earth as well as the phase angle between Venus and Sun to get an idea of the returning dates.", "If you are an experienced astronomer you may point out that we did not compute the position of Venus on the sky. Further, we computed the phase angles from the centre of the Earth, not considering the geographical coordinates of a human observer. Well, you are absolutely right!", "So far, we learned some SPICE functions and some use cases using Python and Jupyter Notebooks. In the next tutorials I would like to dive deeper, beginning with asteroids and so-called Near-Earth objects (NEOs). But before, however, we need to cover two general topics:", "These two topics are as relevant for us as mathematics and statistics for Data Science and Machine Learning. Do not worry, we will learn these things together, with Python. Afterwards you have a solid knowledge fundament to work on science topics I will show you afterwards.", "In the meantime, play around with the functions you have learned so far. Improve the matplotlib plots or create interactive versions using bokeh.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Scientist and Engineer. Astrophysicist and Solar System researcher \u2014 Now working in the automotive industry"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F926905875afb&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fspace-science-with-python-the-dance-of-venus-926905875afb&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fspace-science-with-python-the-dance-of-venus-926905875afb&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fspace-science-with-python-the-dance-of-venus-926905875afb&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fspace-science-with-python-the-dance-of-venus-926905875afb&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----926905875afb--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----926905875afb--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://thomas-albin.medium.com/?source=post_page-----926905875afb--------------------------------", "anchor_text": ""}, {"url": "https://thomas-albin.medium.com/?source=post_page-----926905875afb--------------------------------", "anchor_text": "Thomas Albin"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fe5af1ec51465&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fspace-science-with-python-the-dance-of-venus-926905875afb&user=Thomas+Albin&userId=e5af1ec51465&source=post_page-e5af1ec51465----926905875afb---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F926905875afb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fspace-science-with-python-the-dance-of-venus-926905875afb&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F926905875afb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fspace-science-with-python-the-dance-of-venus-926905875afb&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://towardsdatascience.com/tagged/space-science-with-python", "anchor_text": "https://towardsdatascience.com/tagged/space-science-with-python"}, {"url": "https://unsplash.com/@grantmciver?utm_source=medium&utm_medium=referral", "anchor_text": "Grant McIver"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://github.com/ThomasAlbin/SpaceScienceTutorial", "anchor_text": "GitHub"}, {"url": "https://naif.jpl.nasa.gov/pub/naif/toolkit_docs/C/cspice/furnsh_c.html", "anchor_text": "furnsh"}, {"url": "https://naif.jpl.nasa.gov/pub/naif/toolkit_docs/C/cspice/utc2et_c.html", "anchor_text": "utc2et"}, {"url": "https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html", "anchor_text": "dataframe"}, {"url": "https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.apply.html", "anchor_text": "applying"}, {"url": "https://naif.jpl.nasa.gov/pub/naif/toolkit_docs/C/cspice/phaseq_c.html", "anchor_text": "phaseq"}, {"url": "https://naif.jpl.nasa.gov/pub/naif/toolkit_docs/C/cspice/phaseq_c.html", "anchor_text": "phaseq"}, {"url": "https://naif.jpl.nasa.gov/pub/naif/toolkit_docs/C/req/naif_ids.html", "anchor_text": "NAIF ID"}, {"url": "https://naif.jpl.nasa.gov/pub/naif/toolkit_docs/C/req/abcorr.html", "anchor_text": "The corresponding SPICE documentation for corrections provides the following descriptions for the terms"}, {"url": "https://matplotlib.org/", "anchor_text": "matplotlib"}, {"url": "https://matplotlib.org/api/_as_gen/matplotlib.axes.Axes.axvline.html", "anchor_text": "axvline"}, {"url": "https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.loc.html", "anchor_text": ".loc[]"}, {"url": "https://stellarium.org/", "anchor_text": "Stellarium"}, {"url": "https://docs.bokeh.org/en/latest/index.html", "anchor_text": "bokeh"}, {"url": "https://medium.com/tag/space?source=post_page-----926905875afb---------------space-----------------", "anchor_text": "Space"}, {"url": "https://medium.com/tag/science?source=post_page-----926905875afb---------------science-----------------", "anchor_text": "Science"}, {"url": "https://medium.com/tag/python?source=post_page-----926905875afb---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/programming?source=post_page-----926905875afb---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/tag/space-science-with-python?source=post_page-----926905875afb---------------space_science_with_python-----------------", "anchor_text": "Space Science With Python"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F926905875afb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fspace-science-with-python-the-dance-of-venus-926905875afb&user=Thomas+Albin&userId=e5af1ec51465&source=-----926905875afb---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F926905875afb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fspace-science-with-python-the-dance-of-venus-926905875afb&user=Thomas+Albin&userId=e5af1ec51465&source=-----926905875afb---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F926905875afb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fspace-science-with-python-the-dance-of-venus-926905875afb&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----926905875afb--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F926905875afb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fspace-science-with-python-the-dance-of-venus-926905875afb&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----926905875afb---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----926905875afb--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----926905875afb--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----926905875afb--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----926905875afb--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----926905875afb--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----926905875afb--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----926905875afb--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----926905875afb--------------------------------", "anchor_text": ""}, {"url": "https://thomas-albin.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://thomas-albin.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Thomas Albin"}, {"url": "https://thomas-albin.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "432 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fe5af1ec51465&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fspace-science-with-python-the-dance-of-venus-926905875afb&user=Thomas+Albin&userId=e5af1ec51465&source=post_page-e5af1ec51465--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fe56e0e06b404&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fspace-science-with-python-the-dance-of-venus-926905875afb&newsletterV3=e5af1ec51465&newsletterV3Id=e56e0e06b404&user=Thomas+Albin&userId=e5af1ec51465&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}