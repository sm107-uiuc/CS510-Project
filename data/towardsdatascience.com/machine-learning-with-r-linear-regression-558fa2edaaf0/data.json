{"url": "https://towardsdatascience.com/machine-learning-with-r-linear-regression-558fa2edaaf0", "time": 1683014350.539784, "path": "towardsdatascience.com/machine-learning-with-r-linear-regression-558fa2edaaf0/", "webpage": {"metadata": {"title": "Machine Learning With R: Linear Regression | by Dario Rade\u010di\u0107 | Towards Data Science", "h1": "Machine Learning With R: Linear Regression", "description": "I decided to start an entire series on machine learning with R. No, that doesn\u2019t mean I\u2019m quitting Python (God forbid), but I\u2019ve been exploring R recently and it isn\u2019t that bad as I initially\u2026"}, "outgoing_paragraph_urls": [{"url": "https://github.com/betterdatascience/MachineLearningWithR", "anchor_text": "here", "paragraph_index": 5}, {"url": "https://www.kaggle.com/aungpyaeap/fish-market", "anchor_text": "Fish Market", "paragraph_index": 14}, {"url": "https://medium.com/@radecicdario/membership", "anchor_text": "Medium member", "paragraph_index": 49}, {"url": "https://betterdatascience.com/machine-learning-with-r-linear-regression/", "anchor_text": "https://betterdatascience.com", "paragraph_index": 50}, {"url": "http://betterdatascience.com", "anchor_text": "betterdatascience.com", "paragraph_index": 52}], "all_paragraphs": ["I decided to start an entire series on machine learning with R. No, that doesn\u2019t mean I\u2019m quitting Python (God forbid), but I\u2019ve been exploring R recently and it isn\u2019t that bad as I initially thought. So, let start with the basics \u2014 linear regression.", "If you\u2019d like to know my initial impressions on R programming language, here\u2019s the article from a couple of weeks back:", "This should be a fun series. I intend to cover all the major machine learning algorithms, compare the \u2018weird\u2019 parts with its Python alternative, and also to learn a lot of things in the process.", "This article is structured as follows:", "If you\u2019re more of a video person, I\u2019ve got you covered:", "Also, you can get the source code here.", "We have a lot of things to cover, so let\u2019s get started right away!", "I\u2019ll take my chances and say that this probably isn\u2019t your first exposure to linear regression. And it shouldn\u2019t be, as the article won\u2019t go in much depth with the theory. Still, we\u2019ll start with the high-level overview of the algorithm.", "Linear regression is a simple algorithm initially developed in the field of statistics. It was studied as a model for understanding relationships between input and output variables. As the name suggests, it\u2019s a linear model, so it assumes a linear relationship between input variables and a single (continuous) output variable.", "This output variable is calculated as a linear combination of the input variables.", "Two main types of linear regression exist:", "Training a linear regression model essentially adds a coefficient to each input variable \u2014 which determines how important it is. The value of input variables are then multiplied with the corresponding coefficient, and the bias (intercept) term is added to the sum. That\u2019s essentially our predicted value.", "Awesome! Linear regression has some assumption, and we as a data scientists must be aware of them:", "And that\u2019s it for a high-level overview. Let\u2019s continue with the good stuff now.", "We\u2019ll use the Fish Market dataset to build our model. Yes, it\u2019s the first time I\u2019m using it too, so you\u2019re not alone. Download the dataset and store it in a friendly location.", "Now we can start with the imports:", "Put simply \u2014 dplyr is used for data manipulation, ggplot2 for visualization, caTools for train/test split, and corrgram for making neat correlation matrix plots.", "We can now read in the dataset and check how do the first couple of rows look like:", "Awesome! Everything seems to be working fine, so we can proceed with the basic exploratory data analysis.", "The first thing we need to do is to check for missing values. The process is as simple as with Python:", "Executing this code yields a big uppercase FALSE in the console, indicating there are no missing values \u2014 so we can proceed with the analysis.", "Let\u2019s make a couple of visualization next. Nothing complex, just to get the feel of how our dataset behaves. The first visualization is a scatter plot of fish weight vs height, colored by the fish species. This code snippet does the trick:", "Just from the color, we can see the fish species are nicely separated (in most cases). Next, let\u2019s check for the correlation between the attributes. Here, the corrgram library comes in handy. Here\u2019s the code:", "The correlations are insanely high between almost all attributes. But we won\u2019t do anything about it, since the aim of this article is to discuss linear regression and not the exploratory data analysis.", "Keep in mind \u2014 this will most likely result in model overfitting, but more on that later.", "That concludes the EDA part, and we can continue with the actual modeling.", "This will be the longest section thus far, so get yourself a cup of coffee. We\u2019ll start with the train/test split. We want to split our dataset into two parts, one (bigger) on which the model is trained, and the other (smaller) that is used for model evaluation.", "Before we do anything, let\u2019s set a random seed. Train/test split is a random process, and seed ensures the randomization works the same on yours and my computer:", "Great! Let\u2019s perform the split now. 70% of the data is used for training, and the remaining 30% is used for testing. Here\u2019s the code:", "After executing the code, you should see two additional variables created in the top right panel:", "So, we have 159 rows in total, of which 111 were allocated for model training, and the remaining 48 are used to test the model.", "We can now proceed with the model training.", "R uses the following syntax for linear regression models:", "That\u2019s okay, but imagine we had 100 predictors, then it would be a nightmare to write every single one to the equation. Instead, we can use the following syntax:", "Keep in mind \u2014 this only works if you decide to use all predictors for model training. Accordingly, we can train the model like this:", "In a nutshell \u2014 we\u2019re trying to predict the Weight attribute as a linear combination of every other attribute. R also handles the categorical attributes automatically. Take that, Python!", "Next, we can take a look at the summary of our model:", "The most interesting thing here is the P-values, displayed in the Pr(>|t|) column. Those values display the probability of a variable not being important for prediction. It\u2019s common to use a 5% significance threshold, so if a P-value is 0.05 or below we can say that there\u2019s a low chance it is not significant for the analysis. Sorry for the negation, that\u2019s just how the hypotheses are formed.", "Awesome! Next, we can make a residuals plot, or residuals histogram to be more precise. Here we expect to see something approximately normally distributed. Let\u2019s see how the histogram looks like:", "Well, there\u2019s a bit of skew due to the value on the far right, but after eyeballing it we can conclude that the residuals are approximately normally distributed.", "And now we can finally make predictions! It\u2019s quite easy to do so:", "And now we can evaluate. We\u2019ll create a dataframe of actual and predicted values, for starters:", "Here\u2019s how the first couple of rows look like:", "It\u2019s not the best model \u2014 at least not without any tuning, but we\u2019re still getting decent results. How decent? Well, that\u2019s what metrics like MSE and RMSE will tell us. Here are the calculations:", "We got the RMSE value of 95.9, and MSE is well, a square of that. This means that we\u2019re on average wrong by 95.9 units of Weight. I\u2019ll leave it up to you to decide how good or bad that is.", "In my opinion, the model has overfitted on the training data, due to large correlation coefficients between the input variables. Also, the coefficient of determination value (R2) for the train set is insanely high (0.93+).", "And that\u2019s just enough for today. Let\u2019s wrap things up in the next section.", "I hope this article was easy enough to follow along. We covered the simplest machine learning algorithm and touched a bit on exploratory data analysis. It\u2019s a lot to digest for a single article, I know, but the topic isn\u2019t that hard.", "We\u2019ll cover logistic regression next, approximately in 3\u20134 days, so stay tuned if that\u2019s something you find interesting.", "Loved the article? Become a Medium member to continue learning without limits. I\u2019ll receive a portion of your membership fee if you use the following link, with no extra cost to you.", "Originally published at https://betterdatascience.com on September 25, 2020.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Scientist & Tech Writer | betterdatascience.com"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F558fa2edaaf0&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-with-r-linear-regression-558fa2edaaf0&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-with-r-linear-regression-558fa2edaaf0&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-with-r-linear-regression-558fa2edaaf0&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-with-r-linear-regression-558fa2edaaf0&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----558fa2edaaf0--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----558fa2edaaf0--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@radecicdario?source=post_page-----558fa2edaaf0--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@radecicdario?source=post_page-----558fa2edaaf0--------------------------------", "anchor_text": "Dario Rade\u010di\u0107"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F689ba04bb8be&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-with-r-linear-regression-558fa2edaaf0&user=Dario+Rade%C4%8Di%C4%87&userId=689ba04bb8be&source=post_page-689ba04bb8be----558fa2edaaf0---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F558fa2edaaf0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-with-r-linear-regression-558fa2edaaf0&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F558fa2edaaf0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-with-r-linear-regression-558fa2edaaf0&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@nathananderson?utm_source=medium&utm_medium=referral", "anchor_text": "Nathan Anderson"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://towardsdatascience.com/ive-tried-r-for-the-first-time-how-bad-was-it-ba344f22e90b", "anchor_text": "I\u2019ve Tried R for the First Time \u2014 How Bad Was It?All-time Pythonista tries out R \u2014 comparisons with Python included.towardsdatascience.com"}, {"url": "https://github.com/betterdatascience/MachineLearningWithR", "anchor_text": "here"}, {"url": "https://www.kaggle.com/aungpyaeap/fish-market", "anchor_text": "Fish Market"}, {"url": "https://mailchi.mp/46a3d2989d9b/bdssubscribe", "anchor_text": "Join my private email list for more helpful insights."}, {"url": "https://medium.com/@radecicdario/membership", "anchor_text": "Medium member"}, {"url": "https://medium.com/@radecicdario/membership", "anchor_text": "Join Medium with my referral link - Dario Rade\u010di\u0107As a Medium member, a portion of your membership fee goes to writers you read, and you get full access to every story\u2026medium.com"}, {"url": "https://betterdatascience.com/machine-learning-with-r-linear-regression/", "anchor_text": "https://betterdatascience.com"}, {"url": "https://medium.com/tag/towards-data-science?source=post_page-----558fa2edaaf0---------------towards_data_science-----------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/tag/data-science?source=post_page-----558fa2edaaf0---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----558fa2edaaf0---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/r?source=post_page-----558fa2edaaf0---------------r-----------------", "anchor_text": "R"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----558fa2edaaf0---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F558fa2edaaf0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-with-r-linear-regression-558fa2edaaf0&user=Dario+Rade%C4%8Di%C4%87&userId=689ba04bb8be&source=-----558fa2edaaf0---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F558fa2edaaf0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-with-r-linear-regression-558fa2edaaf0&user=Dario+Rade%C4%8Di%C4%87&userId=689ba04bb8be&source=-----558fa2edaaf0---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F558fa2edaaf0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-with-r-linear-regression-558fa2edaaf0&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----558fa2edaaf0--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F558fa2edaaf0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-with-r-linear-regression-558fa2edaaf0&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----558fa2edaaf0---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----558fa2edaaf0--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----558fa2edaaf0--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----558fa2edaaf0--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----558fa2edaaf0--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----558fa2edaaf0--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----558fa2edaaf0--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----558fa2edaaf0--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----558fa2edaaf0--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@radecicdario?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@radecicdario?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Dario Rade\u010di\u0107"}, {"url": "https://medium.com/@radecicdario/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "39K Followers"}, {"url": "http://betterdatascience.com", "anchor_text": "betterdatascience.com"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F689ba04bb8be&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-with-r-linear-regression-558fa2edaaf0&user=Dario+Rade%C4%8Di%C4%87&userId=689ba04bb8be&source=post_page-689ba04bb8be--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F33e2fb82c727&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-with-r-linear-regression-558fa2edaaf0&newsletterV3=689ba04bb8be&newsletterV3Id=33e2fb82c727&user=Dario+Rade%C4%8Di%C4%87&userId=689ba04bb8be&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://amzn.to/400ZUtX", "anchor_text": "Machine Learning Automation with TPOT: Build, validate, and deploy fully automated machine learning models with Python2021"}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}