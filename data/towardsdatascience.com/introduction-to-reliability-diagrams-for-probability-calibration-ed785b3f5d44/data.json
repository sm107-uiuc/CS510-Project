{"url": "https://towardsdatascience.com/introduction-to-reliability-diagrams-for-probability-calibration-ed785b3f5d44", "time": 1683006843.657679, "path": "towardsdatascience.com/introduction-to-reliability-diagrams-for-probability-calibration-ed785b3f5d44/", "webpage": {"metadata": {"title": "A brief introduction to uncertainty calibration and reliability diagrams | by Xiang Jiang | Towards Data Science", "h1": "A brief introduction to uncertainty calibration and reliability diagrams", "description": "Uncertainty calibration is one of the most misunderstood concepts in machine learning. It can be encapsulated in this simple question: \u201cAre you taking an umbrella given the above probabilities of\u2026"}, "outgoing_paragraph_urls": [{"url": "https://scikit-learn.org/stable/modules/generated/sklearn.calibration.calibration_curve.html", "anchor_text": "scikit-learn", "paragraph_index": 16}], "all_paragraphs": ["Uncertainty calibration is one of the most misunderstood concepts in machine learning. It can be encapsulated in this simple question: \u201cAre you taking an umbrella given the above probabilities of rain?\u201d", "We use the concepts of subjective probability and uncertainty calibration in our daily life without realizing them. For a weather forecast model with well-calibrated uncertainty, it is probably not worthwhile to bring an umbrella if the probability of rain is only 5%. From a frequentist perspective, if the weather condition, in the above figure, at 7 a.m. can be observed repeatedly over a large number of random trials, only 5% of them are going to rain. On the other hand, however, if the uncertainties are ill-calibrated, it is likely that 40% of those random trials at 7 a.m. will end up raining \u2014 a big wet surprise.", "DeGroot et al. [1] use forecasting rain as an example to illustrate the concept of calibration.", "The concept of calibration pertains to the agreement between a forecaster\u2019s predictions and the actual observed relative frequency of rain. Rougly speaking, a forecaster is said to be well-calibrated if among these days for which his prediction is x, the long-run relative frequency is also x.", "To put another way, for a well-calibrated model, if it predicts a set of images with 40% probability of being a cat, the frequency of cat contained in that set should be equal to 40%. The \u201crelative frequency\u201d is sometimes referred to as \u201cconditional probability\u201d that can be understood as the probability of cat, i.e., a positive outcome, conditioned on the predicted probability being 40%.", "A similar procedure is presented by Dawid [1] as the following.", "One way of comparing forecasts with reality is to pick out some fairly arbitrary test set of days, and in it compare (a) the proportion p of days whose associated events in fact occur with (b) the average forecast probability \u03c0 for those days.", "We arrive at the reliability diagram if we follow some partitioning scheme to select test sets in which we compare (a) and (b).", "In a binary classification problem, we train a model to estimate the probability of an example to be classified as the positive class, i.e., f(x_i)=p(y_i=1|x_i), as shown in Figure 1 below.", "Once we obtained the probabilities for a test set, we partition the probabilities into K subsets in which each subset represents a disjoint interval of probabilities between 0 and 1. This is depicted in Figure 2.", "For each subset in different colors, we compute the two estimates: (a) average predicted probabilities, (b) the relative frequency of positive examples.", "We first calculate (a) the average predicted probabilities for each subset, shown in Figure 3.", "We next calculate (b) the relative frequency of positive examples, which requires the knowledge of ground-truth labels. In Figure 4, we use grey circles to present negative class, and the remaining colors represent the positive class. As an example, in set 1, only one example is positive; therefore, the relative frequency of positive examples is 1/3.", "The reliability diagram is to plot (b) against (a), shown in Figure 5.", "Intuitively, the calibration plot tells that: (I) when the average predictive probability is 0.17, about 33 percent of the predictions are positive; (II) when the average predictive probability is 0.45, about 50 percent of the predictions are positive; (III) when the average predictive probability is 0.82, about 80 percent of the predictions are positive. This contrived model is relatively well-calibrated, although not perfect.", "One pervasive misconception about the reliability diagram is to replace \u201crelative frequency\u201d with \u201caccuracy.\u201d Sometimes practitioners \u2014 including prominent researchers I have great respect to \u2014 use \u201cthe accuracy of each subset\u201d to represent the relative frequency, which is not the intention of calibration. We need to understand calibration from the relative frequency perspective where the predictive confidence of the positive class should reflect the frequency of positive examples among all prediction (sometimes referred to as prevalence of the subset) rather than the accuracy.", "I will use an example from scikit-learn [3] to show how they differ from each other. Figure 6 shows the reliability diagram of a logistic regression model, which is relatively well-calibrated.", "However, if I plot the y-axis using accuracy, it looks like a V-shaped curve as shown in Figure 7.", "This is because when the positive predictive probabilities are low while the negative probabilities are high, which lifted the left-half of the plot. This can be verified by the histogram of the mean predicted value. A large number of examples are with mean predicted values between 0 and 0.1 because they are negative classes, and most of them are correctly classified by the model.", "I hope you will never worry about uncertainty calibration for weather forecasts. If you always get wet when the probability of rain is below, say, 20%, you know the forecasting model is ill-calibrated.", "From a machine learning practitioner\u2019s perspective, uncertainty calibration is highly relevant in the interpretations of probabilistic outcomes of a model, especially in safety critical applications such as the medical domain.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fed785b3f5d44&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroduction-to-reliability-diagrams-for-probability-calibration-ed785b3f5d44&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroduction-to-reliability-diagrams-for-probability-calibration-ed785b3f5d44&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroduction-to-reliability-diagrams-for-probability-calibration-ed785b3f5d44&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroduction-to-reliability-diagrams-for-probability-calibration-ed785b3f5d44&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----ed785b3f5d44--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----ed785b3f5d44--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@xiangjiang.dal?source=post_page-----ed785b3f5d44--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@xiangjiang.dal?source=post_page-----ed785b3f5d44--------------------------------", "anchor_text": "Xiang Jiang"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F6098d3336056&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroduction-to-reliability-diagrams-for-probability-calibration-ed785b3f5d44&user=Xiang+Jiang&userId=6098d3336056&source=post_page-6098d3336056----ed785b3f5d44---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fed785b3f5d44&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroduction-to-reliability-diagrams-for-probability-calibration-ed785b3f5d44&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fed785b3f5d44&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroduction-to-reliability-diagrams-for-probability-calibration-ed785b3f5d44&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.calibration.calibration_curve.html", "anchor_text": "scikit-learn"}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.calibration.calibration_curve.html", "anchor_text": "https://scikit-learn.org/stable/modules/generated/sklearn.calibration.calibration_curve.html"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----ed785b3f5d44---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----ed785b3f5d44---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/probability?source=post_page-----ed785b3f5d44---------------probability-----------------", "anchor_text": "Probability"}, {"url": "https://medium.com/tag/statistics?source=post_page-----ed785b3f5d44---------------statistics-----------------", "anchor_text": "Statistics"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fed785b3f5d44&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroduction-to-reliability-diagrams-for-probability-calibration-ed785b3f5d44&user=Xiang+Jiang&userId=6098d3336056&source=-----ed785b3f5d44---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fed785b3f5d44&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroduction-to-reliability-diagrams-for-probability-calibration-ed785b3f5d44&user=Xiang+Jiang&userId=6098d3336056&source=-----ed785b3f5d44---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fed785b3f5d44&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroduction-to-reliability-diagrams-for-probability-calibration-ed785b3f5d44&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----ed785b3f5d44--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fed785b3f5d44&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroduction-to-reliability-diagrams-for-probability-calibration-ed785b3f5d44&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----ed785b3f5d44---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----ed785b3f5d44--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----ed785b3f5d44--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----ed785b3f5d44--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----ed785b3f5d44--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----ed785b3f5d44--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----ed785b3f5d44--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----ed785b3f5d44--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----ed785b3f5d44--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@xiangjiang.dal?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@xiangjiang.dal?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Xiang Jiang"}, {"url": "https://medium.com/@xiangjiang.dal/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "29 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F6098d3336056&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroduction-to-reliability-diagrams-for-probability-calibration-ed785b3f5d44&user=Xiang+Jiang&userId=6098d3336056&source=post_page-6098d3336056--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F61017944ba03&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroduction-to-reliability-diagrams-for-probability-calibration-ed785b3f5d44&newsletterV3=6098d3336056&newsletterV3Id=61017944ba03&user=Xiang+Jiang&userId=6098d3336056&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}