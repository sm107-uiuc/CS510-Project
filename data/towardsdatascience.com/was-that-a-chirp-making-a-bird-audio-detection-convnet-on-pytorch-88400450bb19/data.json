{"url": "https://towardsdatascience.com/was-that-a-chirp-making-a-bird-audio-detection-convnet-on-pytorch-88400450bb19", "time": 1683010110.2876658, "path": "towardsdatascience.com/was-that-a-chirp-making-a-bird-audio-detection-convnet-on-pytorch-88400450bb19/", "webpage": {"metadata": {"title": "\u201cWas That a Chirp?\u201d Making a Bird Audio Detection ConvNet on PyTorch | by Richard So | Towards Data Science", "h1": "\u201cWas That a Chirp?\u201d Making a Bird Audio Detection ConvNet on PyTorch", "description": "Follow me as I make a Bird Audio Detection model, making custom PyTorch datasets and learning the true importance of Bird Audio Detection along the way."}, "outgoing_paragraph_urls": [{"url": "https://zenodo.org/record/1226427", "anchor_text": "BirdVox-70k", "paragraph_index": 11}, {"url": "https://www.paperspace.com/", "anchor_text": "Paperspace", "paragraph_index": 11}, {"url": "https://h5py.readthedocs.io/en/stable/quick.html", "anchor_text": "h5py documentation", "paragraph_index": 12}, {"url": "https://wp.nyu.edu/birdvox/codedata/", "anchor_text": "website", "paragraph_index": 14}, {"url": "https://jovian.ml/richardso21/bird-audio-detection", "anchor_text": "https://jovian.ml/richardso21/bird-audio-detection", "paragraph_index": 35}, {"url": "https://jovian.ml/richardso21/bird-audio-detection", "anchor_text": "https://jovian.ml/richardso21/bird-audio-detection", "paragraph_index": 40}, {"url": "https://sorichard.com", "anchor_text": "https://sorichard.com", "paragraph_index": 42}], "all_paragraphs": ["You\u2019ve heard of automatic speech recognition, you\u2019ve heard of music tagging & generation, but have you heard of bird audio detection?", "It was around a year ago in my sophomore year of high school when I first heard of this sort of use case in deep learning with audio. In fact, Bird Audio Detection (ironically abbreviated as BAD, but I\u2019ll try to avoid this abbreviation as much as possible\ud83d\ude05) was the topic for one of the first projects I\u2019ve done in terms of deep learning and computer science. I was involved in a research project in detecting bird presence using purely audio around the outskirts of North Alaska. Jumping into it, Bird Audio Detection appeared as such a niche, yet fascinating application! And in this article, I\u2019ll show you how this can be achieved with a simple Convolutional Neural Network (CNN) on the BirdVox-70k dataset.", "Over the years, there has been constantly developing advancements over the use of deep learning models for Bird Audio Detection applications, and there are reasons why some are very interested in this. Firstly, birds are already hard enough to track, with their fast movement speeds and relatively small size. Additionally, different species of birds have their own unique vocalization, which makes bird detection through audio and hearing ever more preferable than seeing one. And finally, since birds are part of the ecosystem, their presence and migration patterns are often telltale signs for environmental health at any given region.", "Well, why not record an audio clip and send it for a human to listen to it later? However, let\u2019s be real:", "Manually labeling audio is expensive, tedious, and probably not anywhere close to real time.", "So, this is where deep learning and CNNs comes into play. If our models are accurate enough, we can automate the process of recording bird migration patterns and tracking bird species just by setting microphones around the wilderness. And with all this data, we can obtain a deeper understanding of our world\u2019s ecosystems and fully understand the effects of climate change on our environment.", "Let\u2019s talk all about sound first. Sound is basically made up of fancy pressure waves travelling through air and into our eardrums, and can be recorded with a digital device as signals. Turns out, we can plot this signal as shown below:", "However, this long line plot doesn\u2019t look particularly inviting to feed into any deep learning model, let alone a CNN. In fact, if I were to tell you now that the audio signal above is representative of a bird chirping, would you even believe me? Probably not\u2026you instead thought this was some randomly-generated plot I made. And if you thought the bird chirp is around the 10,000th tick, what if I said the bird chirp is right at the middle, at tick #6000? The point is:", "If we ourselves can\u2019t make any strong assumptions what any particular signal plot represents, how could we expect a deep learning model to do so?", "\u2026We are not entirely stuck. There is actually another way to represent audio: Spectrograms. Spectrograms are made by recording the presence of frequencies and respective intensities in a small time window, stacked along the x-axis (represented by a unit of time) until the spectrogram covers the total duration of the audio signal. It is common that the time window overlaps itself as it shifts in the process of spectrogram creation, and usually frequency intensity (volume, or loudness) is represented with color, or numerically speaking, higher/lower values.", "Given a spectrogram of the signal from above, it should be much clearer if and when the bird chirps. To be specific \u201cjust because\u201d, you can see unique activity around 6000 Hz at the 250 ms mark; that\u2019s the bird chirp. Thus, CNN audio classifiers often take in spectrograms as input, and Bird Audio Detection models are no exception.", "For this endeavor, I used the BirdVox-70k dataset from BirdVox, which contains half-second (500ms) recordings/waveforms either containing a bird chirp or not. The dataset was derived from its bigger brother, the BirdVox-full-night, both of which were recorded in Ithaca, NY, USA during the fall of 2015. The labels for each waveform is included in each of its filename as the last digit (either a 0or 1). Although the 70k dataset boasts approximately 70,000 clips of data (hence the name), I will only be using two-thirds of it (more specifically, around 50,000) because I\u2019m running low on persistent storage in my Paperspace account\ud83d\ude26.", "The data is bundled in seperate HDF5 files, meaning that the already-reduced 50,000 samples I plan to use are actually split into 4 different .hdf5 files. To add on to the fustration, each waveform is stored into a group with its own \u2018filename\u2019 label, and all of these are stored into another group called \u201cwaveforms\u201d. Even after reading the h5py documentation, I\u2019ve yet to see such an arrangement such as what\u2019s described above. Already, two of my worst data preparation nightmares emerge from these discoveries. Hardly having any more storage left, I can\u2019t alter the format of data that\u2019s already given to me. This leaves me with one last option: make a very custom PyTorch Dataset class so I can move forward.", "But before I go on, let\u2019s listen to some short audio samples, as well as some simple data analysis over the dataset(Warning \u2014 Lower your volume since the samples may be louder than anticipated):", "It also turns out that after combining all the files together, the portion of bird-positive audio samples is exactly 50%, as what\u2019s promised in their website. The filename for each bird-positive waveform also includes the frequency of the bird call. Compiling all of those together, here\u2019s what I found:", "I anticipated for many of the calls to be pretty high pitched. A good chunk of the samples were the case, but the huge majority were in fact closer to the lower frequencies (2000\u20133500 Hz). Pretty suprising!", "OK, so we know that there are separate .hdf5 files to handle into one \u201cdataset\u201d, and each file has a somewhat-awkward data structure. These conditions definitely call for a custom PyTorch Dataset class to properly load our audio data for later training. The Dataset class primarily needs the __init__ and __getitem__ functions (and also __len__ but that\u2019ll be quite simple). Here\u2019s what I plan each will do:", "Below, I\u2019ve turned these ideas into code for the Dataset class:", "We define the directory to the dataset files, and the filenames themselves. I\u2019ve decided to use 3 of the 4 files as test data and the last as the validation/test set to measure the model\u2019s performance, leaving out the smallest file for the latter. Since all recording devices of each file are set up relatively near to each other (in the same city of Ithaca), I believe bypassing random split won\u2019t introduce massive bias.", "After having our datasets set, it\u2019s time to define our dataloaders:", "I set up any necessary helper functions for my model for it to train later on:", "And define the main functions for fitting/training the model and testing it on the validation dataset:", "Finally, here\u2019s the simple CNN model we\u2019ve been waiting for:", "I utilized multiple convolutional layers, as our theoretical extrapolation earlier on suggested we do for our model, with some max pooling layers, followed by a very simple fully connected network to do the actual classification. And surprisingly, this architecture performs fairly well later on, surpassing even my own expectations.", "Nowadays, almost everyone needs a GPU to train anything more complicated than a vanilla feedforward neural network. Luckily, PyTorch makes it easy for us to harness the power of an available GPU. First, we define our cuda device as the keyword device for easier accessibility:", "Apparently, you can \u201ctell\u201d PyTorch to optimize itself while training over and over again, as long as the training input remains the same in terms of its size and shape. It\u2019ll know to use the fastest possible algorithms for your specific hardware (GPU). The more you know!", "We then define helper functions to move dataloaders, tensors, and our models to our GPU device.", "Using our device helper functions, we move everything to our GPU as follows:", "We also specify our learning rate and our amount of epochs, which took a long time for me to find a good value for both.", "We find the model\u2019s performance before any training:", "Next, we use our previously-defined fit function to train our simple Classifier model instance:", "After seeing a little dip in accuracy, I decide to train a tiny bit more to redirect the model back to the right direction:", "To summarize, here were our training statistics over the period of the 11 epochs used to train:", "Overall, our model trained pretty well, and by the looks of it we\u2019ve probably found a relative minimum for our model\u2019s loss.", "Trust me, I\u2019ve tried both of these as well shortly after the successes of the first attempt with my simple Classifier(). I decided not to include the specifics of both because I\u2019ve found their results actually worse than that of what we\u2019ve already achieve, weirdly.", "If you want to see how I\u2019ve tried implementing both, head on to my notebook posted here: https://jovian.ml/richardso21/bird-audio-detection.", "For extra spectrogram transformations, I\u2019ve attempted random time shifts and noise injection. Long story short, it didn\u2019t seem to improve validation accuracy at all. Since then, I\u2019ve reasoned this as the case because the dataset specifications said explicitly that all chirps would be located at the middle of the audio recording, and thus randomly shifting the spectrogram with the intent of allowing better model generalization actually might\u2019ve served as a detriment to it\u2019s performance. However, I\u2019ve yet to try only random noise injection.", "I\u2019ve also tried training a ResNet50 model with the hopes of further improving validation accuracy. Here\u2019s the most mind-boggling part: I\u2019ve never got the model past even 50% accuracy! I\u2019m not sure of what I was doing incorrectly yet to this day when I\u2019m writing this article, so if others can take a look at my notebook above and help me, I\u2019m more than happy to receive any advice or suggestions!", "All in all, I would say this endeavor was a really interesting one to spend some quarantine time on. For one, I got to revisit what I\u2019ve investigated over last summer, which has an admittedly nostalgic feeling. And even more importantly, we learned how to implement a PyTorch Dataset class for quite possibly a real world scenario, where data is not necessarily set up as you\u2019d quite expected. Finally, a final validation score of about 84% is pretty neat for such a simple network architecture I made up on the fly!", "Nevertheless, I hope you enjoyed this article as much as I enjoyed making it! An as always, happy coding! (This is really starting to become my catch phrase on Medium\u2026)", "If you want the source code/notebook for all code examples shown in this post, you may visit https://jovian.ml/richardso21/bird-audio-detection.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "https://sorichard.com | CS @ Georgia Tech, Class of \u201924. Pursuing everything code. Always learning!"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F88400450bb19&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwas-that-a-chirp-making-a-bird-audio-detection-convnet-on-pytorch-88400450bb19&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwas-that-a-chirp-making-a-bird-audio-detection-convnet-on-pytorch-88400450bb19&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwas-that-a-chirp-making-a-bird-audio-detection-convnet-on-pytorch-88400450bb19&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwas-that-a-chirp-making-a-bird-audio-detection-convnet-on-pytorch-88400450bb19&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----88400450bb19--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----88400450bb19--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://richardso21.medium.com/?source=post_page-----88400450bb19--------------------------------", "anchor_text": ""}, {"url": "https://richardso21.medium.com/?source=post_page-----88400450bb19--------------------------------", "anchor_text": "Richard So"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F94b97ebc1395&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwas-that-a-chirp-making-a-bird-audio-detection-convnet-on-pytorch-88400450bb19&user=Richard+So&userId=94b97ebc1395&source=post_page-94b97ebc1395----88400450bb19---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F88400450bb19&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwas-that-a-chirp-making-a-bird-audio-detection-convnet-on-pytorch-88400450bb19&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F88400450bb19&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwas-that-a-chirp-making-a-bird-audio-detection-convnet-on-pytorch-88400450bb19&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@janmeeus?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Jan Meeus"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://zenodo.org/record/1226427", "anchor_text": "BirdVox-70k"}, {"url": "https://www.paperspace.com/", "anchor_text": "Paperspace"}, {"url": "https://h5py.readthedocs.io/en/stable/quick.html", "anchor_text": "h5py documentation"}, {"url": "https://wp.nyu.edu/birdvox/codedata/", "anchor_text": "website"}, {"url": "https://jovian.ml/richardso21/bird-audio-detection", "anchor_text": "https://jovian.ml/richardso21/bird-audio-detection"}, {"url": "https://jovian.ml/richardso21/bird-audio-detection", "anchor_text": "https://jovian.ml/richardso21/bird-audio-detection"}, {"url": "https://medium.com/tag/towards-data-science?source=post_page-----88400450bb19---------------towards_data_science-----------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/tag/programming?source=post_page-----88400450bb19---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----88400450bb19---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/python?source=post_page-----88400450bb19---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----88400450bb19---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F88400450bb19&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwas-that-a-chirp-making-a-bird-audio-detection-convnet-on-pytorch-88400450bb19&user=Richard+So&userId=94b97ebc1395&source=-----88400450bb19---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F88400450bb19&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwas-that-a-chirp-making-a-bird-audio-detection-convnet-on-pytorch-88400450bb19&user=Richard+So&userId=94b97ebc1395&source=-----88400450bb19---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F88400450bb19&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwas-that-a-chirp-making-a-bird-audio-detection-convnet-on-pytorch-88400450bb19&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----88400450bb19--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F88400450bb19&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwas-that-a-chirp-making-a-bird-audio-detection-convnet-on-pytorch-88400450bb19&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----88400450bb19---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----88400450bb19--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----88400450bb19--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----88400450bb19--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----88400450bb19--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----88400450bb19--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----88400450bb19--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----88400450bb19--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----88400450bb19--------------------------------", "anchor_text": ""}, {"url": "https://richardso21.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://richardso21.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Richard So"}, {"url": "https://richardso21.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "966 Followers"}, {"url": "https://sorichard.com", "anchor_text": "https://sorichard.com"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F94b97ebc1395&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwas-that-a-chirp-making-a-bird-audio-detection-convnet-on-pytorch-88400450bb19&user=Richard+So&userId=94b97ebc1395&source=post_page-94b97ebc1395--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fd1d3caf01b63&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwas-that-a-chirp-making-a-bird-audio-detection-convnet-on-pytorch-88400450bb19&newsletterV3=94b97ebc1395&newsletterV3Id=d1d3caf01b63&user=Richard+So&userId=94b97ebc1395&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}