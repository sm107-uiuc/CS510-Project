{"url": "https://towardsdatascience.com/nlp-classification-with-universal-language-model-fine-tuning-ulmfit-4e1d5077372b", "time": 1683012184.344762, "path": "towardsdatascience.com/nlp-classification-with-universal-language-model-fine-tuning-ulmfit-4e1d5077372b/", "webpage": {"metadata": {"title": "NLP Classification with Universal Language Model Fine-tuning (ULMFiT) | by Agasti Kishor Dukare | Towards Data Science", "h1": "NLP Classification with Universal Language Model Fine-tuning (ULMFiT)", "description": "Text classification is one of the important applications of NLP. Applications such as Sentiment Analysis and Identifying spam, bots, and offensive comments come under Text Classification. Until now\u2026"}, "outgoing_paragraph_urls": [{"url": "http://nlp.fast.ai/classification/2018/05/15/introducing-ulmfit.html", "anchor_text": "here", "paragraph_index": 2}, {"url": "https://github.com/fastai/fastai", "anchor_text": "here", "paragraph_index": 3}, {"url": "https://www.kaggle.com/crowdflower/twitter-airline-sentiment#Tweets.csv", "anchor_text": "here", "paragraph_index": 4}], "all_paragraphs": ["Text classification is one of the important applications of NLP. Applications such as Sentiment Analysis and Identifying spam, bots, and offensive comments come under Text Classification. Until now, the approaches used for solving these problems included building Machine Learning or Deep Learning models from scratch, training them on your text data, and fine-tuning it with hyperparameters. Even though such models give decent results for applications like classifying whether a movie review is positive or negative, they may perform terribly if things become more ambiguous because most of the time there\u2019s just not enough amount of labeled data to learn from.", "But wait a minute? Isn\u2019t the Imagenet using the same approach to classify the images? Then how has it able to achieve great results with the same approach? What if, instead of building a model from scratch, we use a model that has been trained to solve one problem (classifying images from Imagenet) as the basis to solve some other somewhat similar problem (text classification). As the fine-tuned model doesn\u2019t have to learn from scratch, it gives higher accuracy without needing a lot of data. This is the principle of Transfer Learning upon which the Universal Language Model Fine-tuning (ULMFiT) has been built.", "And today we are going to see how you can leverage this approach for the Sentiment Analysis. You can read more about the ULMFiT, its advantages as well as comparison with other approaches here.", "The fastai library provides modules necessary to train and use ULMFiT models. You can view the library here.", "The problem we are going to solve is the Sentiment Analysis of US Airlines. You can download the dataset from here. So without further ado, let\u2019s start!", "Firstly, let\u2019s import all the libraries.", "Now we will convert the CSV file of our data into Pandas Dataframe and see the data.", "Now we check if there are any nulls in the dataframe. We observe that there are 5462 nulls in the negative_reason column. These nulls belong to positive + Neutral sentiments which makes sense. We verify this by taking count of all non-negative tweets. Both the numbers match. The reason negativereason_confidence count doesn\u2019t match with negativereason count is that the 0 values in the negativereason_confidence column correspond to blanks in negativereason column.", "If we look at the total count of data samples, it\u2019s 14640. The columns airline_sentiment_gold, negativereason_gold & tweet_coord have large amounts of blanks, i.e. in the range of 13000\u201314000. Thus it can be concluded that these columns will not provide any significant information & thus can be discarded.", "Now that we have the relevant data, let\u2019s start building our model.", "When we are making NLP model with Fastai, there are two stages:", "Here I\u2019m using TextList which is part of the data bloc instead of using the factory methods of TextClasDataBunch and TextLMDataBunch because TextList is part of the API which is more flexible and powerful.", "We can see that since we are training a language model, all the texts are concatenated together (with a random shuffle between them at each new epoch).", "Now we will fine-tune our model with the weights of a model pre-trained on a larger corpus, Wikitext 103. This model has been trained to predict the next word in the sentence provided to it as an input. As the language of the tweets is not always grammatically perfect, we will have to adjust the parameters of our model. Next, we will find the optimal learning rate & visualize it. The visualization will help us to spot the range of learning rates & choose from while training our model.", "By default, the Learner object is frozen thus we need to train the embeddings at first. Here, instead of running the cycle for one epoch, I am going to run it for 6 to see how accuracy varies. The learning rate I picked is with the help of the plot we got above.", "We got very low accuracy, which was expected the rest of our model is still frozen but we can see that the accuracy is increasing.", "We see that the accuracy improved slightly but still looming in the same range. This is because firstly the model was trained on a pre-trained model with different vocabulary & secondly, there were no labels, we had passed the data without specifying the labels.", "Now we will test our model with random input & see if it\u2019ll accurately complete the sentence.", "Now, we\u2019ll create a new data object that only grabs the labeled data and keeps those labels.", "The classifier needs a little less dropout, so we pass drop_mult=0.5 to multiply all the dropouts by this amount. We don\u2019t load the pre-trained model, but instead our fine-tuned encoder from the previous section.", "Again we perform similar steps as Language mode. Here I am skipping the last 15 data points as I\u2019m only interested till 1e-1.", "Here we see that the accuracy has drastically improved if we compare with the Language model in step 1 when we provide labels.", "Now we will partially train the model by unfreezing one layer at a time & differential learning rate. Here I am using the slice attribute which will divide the specified learning rates among 3 groups of models.", "We see that the accuracy is improving gradually which is expected as we are gradually unfreezing the layers. More layers providing more depth.", "Finally, we will unfreeze the whole model & visualize the learning rate to choose & use that for final training.", "We see that we have achieved maximum accuracy of 80% by the end of this model.", "For our final results, we\u2019ll take the average of the predictions of the model. Since the samples are sorted by text lengths for batching, we pass the argument ordered=True to get the predictions in the order of the texts.", "Now it\u2019s time to test our model with new text inputs & see how it performs!", "The databunch has converted the text labels into numerical. They are as follows:", "We see that our model has performed pretty well!!", "You can test the model with negative as well as mixed sentiment text and verify results.", "Hope you find this article helpful :D", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Scientist | Developer| University of Toronto"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F4e1d5077372b&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnlp-classification-with-universal-language-model-fine-tuning-ulmfit-4e1d5077372b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnlp-classification-with-universal-language-model-fine-tuning-ulmfit-4e1d5077372b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnlp-classification-with-universal-language-model-fine-tuning-ulmfit-4e1d5077372b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnlp-classification-with-universal-language-model-fine-tuning-ulmfit-4e1d5077372b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----4e1d5077372b--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----4e1d5077372b--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@agastidukare?source=post_page-----4e1d5077372b--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@agastidukare?source=post_page-----4e1d5077372b--------------------------------", "anchor_text": "Agasti Kishor Dukare"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fd09bb2f88017&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnlp-classification-with-universal-language-model-fine-tuning-ulmfit-4e1d5077372b&user=Agasti+Kishor+Dukare&userId=d09bb2f88017&source=post_page-d09bb2f88017----4e1d5077372b---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F4e1d5077372b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnlp-classification-with-universal-language-model-fine-tuning-ulmfit-4e1d5077372b&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F4e1d5077372b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnlp-classification-with-universal-language-model-fine-tuning-ulmfit-4e1d5077372b&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@markuswinkler?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Markus Winkler"}, {"url": "https://unsplash.com/s/photos/machine-learning?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "http://nlp.fast.ai/classification/2018/05/15/introducing-ulmfit.html", "anchor_text": "here"}, {"url": "https://github.com/fastai/fastai", "anchor_text": "here"}, {"url": "https://www.kaggle.com/crowdflower/twitter-airline-sentiment#Tweets.csv", "anchor_text": "here"}, {"url": "https://medium.com/tag/naturallanguageprocessing?source=post_page-----4e1d5077372b---------------naturallanguageprocessing-----------------", "anchor_text": "Naturallanguageprocessing"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----4e1d5077372b---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----4e1d5077372b---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----4e1d5077372b---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----4e1d5077372b---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F4e1d5077372b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnlp-classification-with-universal-language-model-fine-tuning-ulmfit-4e1d5077372b&user=Agasti+Kishor+Dukare&userId=d09bb2f88017&source=-----4e1d5077372b---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F4e1d5077372b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnlp-classification-with-universal-language-model-fine-tuning-ulmfit-4e1d5077372b&user=Agasti+Kishor+Dukare&userId=d09bb2f88017&source=-----4e1d5077372b---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F4e1d5077372b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnlp-classification-with-universal-language-model-fine-tuning-ulmfit-4e1d5077372b&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----4e1d5077372b--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F4e1d5077372b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnlp-classification-with-universal-language-model-fine-tuning-ulmfit-4e1d5077372b&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----4e1d5077372b---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----4e1d5077372b--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----4e1d5077372b--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----4e1d5077372b--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----4e1d5077372b--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----4e1d5077372b--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----4e1d5077372b--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----4e1d5077372b--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----4e1d5077372b--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@agastidukare?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@agastidukare?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Agasti Kishor Dukare"}, {"url": "https://medium.com/@agastidukare/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "111 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fd09bb2f88017&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnlp-classification-with-universal-language-model-fine-tuning-ulmfit-4e1d5077372b&user=Agasti+Kishor+Dukare&userId=d09bb2f88017&source=post_page-d09bb2f88017--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fb397032874c3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnlp-classification-with-universal-language-model-fine-tuning-ulmfit-4e1d5077372b&newsletterV3=d09bb2f88017&newsletterV3Id=b397032874c3&user=Agasti+Kishor+Dukare&userId=d09bb2f88017&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}