{"url": "https://towardsdatascience.com/using-genetic-algorithms-to-build-stock-trading-strategies-d227951d3df0", "time": 1683014673.065829, "path": "towardsdatascience.com/using-genetic-algorithms-to-build-stock-trading-strategies-d227951d3df0/", "webpage": {"metadata": {"title": "Using Genetic Algorithms to Build Trading Strategies | by Victor Sim | Towards Data Science", "h1": "Using Genetic Algorithms to Build Trading Strategies", "description": "Note from Towards Data Science\u2019s editors: While we allow independent authors to publish articles in accordance with our rules and guidelines, we do not endorse each author\u2019s contribution. You should\u2026"}, "outgoing_paragraph_urls": [{"url": "https://towardsdatascience.com/questions-96667b06af5", "anchor_text": "rules and guidelines", "paragraph_index": 0}, {"url": "https://towardsdatascience.com/readers-terms-b5d780a700a4", "anchor_text": "Reader Terms", "paragraph_index": 0}, {"url": "https://gitlab.com/evolutionary-computation/genetic_algorithm/-/blob/master/ga.py", "anchor_text": "here", "paragraph_index": 12}, {"url": "https://linktr.ee/victorsi", "anchor_text": "link", "paragraph_index": 30}, {"url": "https://linktr.ee/victorsi", "anchor_text": "https://linktr.ee/victorsi", "paragraph_index": 32}], "all_paragraphs": ["Note from Towards Data Science\u2019s editors: While we allow independent authors to publish articles in accordance with our rules and guidelines, we do not endorse each author\u2019s contribution. You should not rely on an author\u2019s works without seeking professional advice. See our Reader Terms for details.", "Genetic algorithms are often ignored, as another unsupervised learning algorithm that fails to converge effectively. This is partly true, as genetic algorithms do not use partial derivatives and therefore the training algorithm is less direct. However, genetic algorithms allow for the formulation of solutions that would have been impossible, using traditional gradient-based optimization.", "Why is this so? If the gradient descent based model started at local minimum, it would be permanently stuck, as the gradient of the points on each side would be higher. However, due to the more stochastic nature for genetic algorithms it would eventually find the solution.", "Additionally, neural networks require labelled data with well-defined loss functions. Genetic algorithms only require data, and a custom loss function (often called a fitness function for genetic algorithms) can be cleverly crafted to optimize certain features. This flexibility makes genetic algorithm stand out from the rest of the unsupervised algorithms.", "Genetic algorithms are a form of a brute-force type attack to the problem. The only differences being using the concept of evolution to speed up the process. Here is how the genetic algorithm works:", "By changing the fitness function and the input data, the genetic algorithm can be applied to literally every problem!", "For elementary tasks such as regression and classification, a deep neural network, trained using a gradient-based optimizer will always converge faster than a genetic algorithm.", "Genetic algorithm are not good for finding patterns, but rather having a wide scope of view, to find solutions that have not been considered.", "Stock trading is complex, as the noise from different sources dilute the true pattern behind the data. Using a genetic algorithm is like taking a shortcut through all of this; disregarding the pattern recognition and the complex analysis. It simply tests different strategies, and finds the best strategy to trade a security. If a genetic algorithm fails to find a good solution this can only be one (or both!) of these two reasons:", "Genetic algorithm, being a brute-force algorithm, requires a long period of time to narrow down the results. This is a large hurdle to overcome, as the computing power must be very high to overcome this problem", "2. The loss function is faulty", "This is much more common. The loss function that evaluates the network simply does not encapsulate the goal of the loss function.", "Disclaimer: This code has been adapted from the code here to make it compatible to optimize neural networks that create trading strategies.", "These are the most basic dependencies for the project. To make the learning process better, you can add more activation functions for your suitable datasets.", "Each agent has its own set of weights, generated randomly with the architecture of the neural network setup. The argument network is a list that looks like so:", "Each term in the list is describing a layer in the Neural Network. The first term in each nested list is the number of input neurons for the layer, the second term is the output and the third the activation function to be applied for the layer.", "This is used to generate the agents, as detailed in step 1 of the methodology to run a genetic algorithm.", "This fitness function is a trading simulation, that uses past data to calculate the profits of the model. Each agent generates a list of trades, by outputting a sigmoid value. These values are then rounded to the nearest value. If this value is 0, the simulation will sell the stock. If this value is 1, the simulation will buy the stock.", "It then calculates the profits, by comparing the best possible trade to the actual trade.", "This code essentially sorts the agents by their fitness value, from the lowest value to the highest. Keep in mind that the lower the fitness value, the better. It then shortens the list of agents to only the top 20% of the agents.", "This is the most complex part of the program. In the crossover process two random parents are chosen from within the selected agents. The nested list of weights are reduced to one long list. A splitting point is randomly picked. This determines how much of each parent\u2019s weights the child will be composed of. This child\u2019s weights is then reformatted and the child is added to the list of agents.", "Genetic Algorithms are technically \u201cblind\u201d as they have no insight to how the surface plotted by the loss function looks like. This means it is very easy for the genetic algorithm to get stuck at a certain point. Mutation allows for slight, random, infrequent changes to stir the pot and get the system out of local minimas.", "To execute the program we need data. For some reason, the SSL certificate would not let me get financial data from yfinance or alphavantage. I have not been able to run this program, so I just used random numpy arrays as data.", "If you want to use your own financial data, the concept would be to have an array of closing price data split it into chunks of size-n.", "For reproducibility, this program will set its own seed, making the randomness fixed. This is to decrease the randomness, to allow for the tweaking of parameters like population size, epochs and the neural network architecture. The more interesting parameter here is the length of each chunk of data to be fed into the network. Tweaking this parameter will find the optimum period of time in which the program will work.", "As I have said in many other articles of my own, this is merely the framework for what can be done with the concept. There are countless things that you can do to improve my program. Here are a few of them:", "By recording the generation of past agents, it prevents the program from regenerating agents that have been generated before.", "2. Link the program to a paper trading account", "Alpaca is the obvious choice to use a paper trading portfolio. It can make trades quickly, allowing for easy analysis of the program\u2019s performance.", "This is the hardest of the three. Add different trades such as stop-loss and put and buy trades, allowing for much more nuanced and layered trading strategies, layering different trade types onto each other, to maximize profits.", "If you want to see more of my content, click this link.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Interested in Machine Learning. Open to internships and opportunities. Connect at https://linktr.ee/victorsi."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fd227951d3df0&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-genetic-algorithms-to-build-stock-trading-strategies-d227951d3df0&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-genetic-algorithms-to-build-stock-trading-strategies-d227951d3df0&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-genetic-algorithms-to-build-stock-trading-strategies-d227951d3df0&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-genetic-algorithms-to-build-stock-trading-strategies-d227951d3df0&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----d227951d3df0--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----d227951d3df0--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://victorsim14.medium.com/?source=post_page-----d227951d3df0--------------------------------", "anchor_text": ""}, {"url": "https://victorsim14.medium.com/?source=post_page-----d227951d3df0--------------------------------", "anchor_text": "Victor Sim"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Ffc395af42221&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-genetic-algorithms-to-build-stock-trading-strategies-d227951d3df0&user=Victor+Sim&userId=fc395af42221&source=post_page-fc395af42221----d227951d3df0---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fd227951d3df0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-genetic-algorithms-to-build-stock-trading-strategies-d227951d3df0&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fd227951d3df0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-genetic-algorithms-to-build-stock-trading-strategies-d227951d3df0&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@maartendeckers?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Maarten Deckers"}, {"url": "https://unsplash.com/s/photos/architecture?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://towardsdatascience.com/questions-96667b06af5", "anchor_text": "rules and guidelines"}, {"url": "https://towardsdatascience.com/readers-terms-b5d780a700a4", "anchor_text": "Reader Terms"}, {"url": "https://gitlab.com/evolutionary-computation/genetic_algorithm/-/blob/master/ga.py", "anchor_text": "here"}, {"url": "https://linktr.ee/victorsi", "anchor_text": "link"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----d227951d3df0---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/programming?source=post_page-----d227951d3df0---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/tag/data-science?source=post_page-----d227951d3df0---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fd227951d3df0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-genetic-algorithms-to-build-stock-trading-strategies-d227951d3df0&user=Victor+Sim&userId=fc395af42221&source=-----d227951d3df0---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fd227951d3df0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-genetic-algorithms-to-build-stock-trading-strategies-d227951d3df0&user=Victor+Sim&userId=fc395af42221&source=-----d227951d3df0---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fd227951d3df0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-genetic-algorithms-to-build-stock-trading-strategies-d227951d3df0&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----d227951d3df0--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fd227951d3df0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-genetic-algorithms-to-build-stock-trading-strategies-d227951d3df0&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----d227951d3df0---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----d227951d3df0--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----d227951d3df0--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----d227951d3df0--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----d227951d3df0--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----d227951d3df0--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----d227951d3df0--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----d227951d3df0--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----d227951d3df0--------------------------------", "anchor_text": ""}, {"url": "https://victorsim14.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://victorsim14.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Victor Sim"}, {"url": "https://victorsim14.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "952 Followers"}, {"url": "https://linktr.ee/victorsi", "anchor_text": "https://linktr.ee/victorsi"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Ffc395af42221&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-genetic-algorithms-to-build-stock-trading-strategies-d227951d3df0&user=Victor+Sim&userId=fc395af42221&source=post_page-fc395af42221--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fa08a1abceacb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-genetic-algorithms-to-build-stock-trading-strategies-d227951d3df0&newsletterV3=fc395af42221&newsletterV3Id=a08a1abceacb&user=Victor+Sim&userId=fc395af42221&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}