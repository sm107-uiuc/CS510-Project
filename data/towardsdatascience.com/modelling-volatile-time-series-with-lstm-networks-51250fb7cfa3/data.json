{"url": "https://towardsdatascience.com/modelling-volatile-time-series-with-lstm-networks-51250fb7cfa3", "time": 1683004878.133176, "path": "towardsdatascience.com/modelling-volatile-time-series-with-lstm-networks-51250fb7cfa3/", "webpage": {"metadata": {"title": "Modelling Volatile Time Series with LSTM Networks | by Michael Grogan | Towards Data Science", "h1": "Modelling Volatile Time Series with LSTM Networks", "description": "Yearly rainfall data can be quite volatile. Unlike temperature, which typically demonstrates a clear trend through the seasons, rainfall as a time series can be quite volatile. In Ireland, it is not\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.met.ie/climate/available-data/historical-data", "anchor_text": "Met \u00c9ireann website", "paragraph_index": 4}, {"url": "https://github.com/MGCodesandStats/weather-modelling", "anchor_text": "here", "paragraph_index": 22}, {"url": "https://www.michael-grogan.com/", "anchor_text": "michael-grogan.com", "paragraph_index": 23}, {"url": "http://michael-grogan.com", "anchor_text": "michael-grogan.com", "paragraph_index": 26}], "all_paragraphs": ["Yearly rainfall data can be quite volatile. Unlike temperature, which typically demonstrates a clear trend through the seasons, rainfall as a time series can be quite volatile. In Ireland, it is not uncommon for summer months to see as much rain as that of winter months.", "Here is a graphical illustration of rainfall patterns from November 1959 for Newport, Ireland:", "As a sequential neural network, LSTM models can prove superior in accounting for the volatility in a time series.", "Using the Ljung-Box test, the p-value of less than 0.05 indicates that the residuals in this time series demonstrate a random pattern, indicating significant volatility:", "The dataset in question comprises of 722 months of rainfall data. The rainfall data for Newport, Ireland was sourced from the Met \u00c9ireann website.", "712 data points are selected for training and validation purposes, i.e. to build the LSTM model. Then, the last 10 months of data are used as test data to compare with the predictions from the LSTM model.", "Here is a snippet of the dataset:", "A dataset matrix is then formed in order to regress the time series against past values:", "The data is then normalized with MinMaxScaler:", "With the previous parameter set to 120, the training and validation datasets are created. For reference, previous = 120 means that the model is using past values from t \u2014 120 down to t \u2014 1 to predict the rainfall value at time t.", "The choice of the previous parameter is subject to trial and error, but 120 time periods were chosen to ensure capture of the volatility or extreme values demonstrated by the time series.", "The inputs are then reshaped to be in the format of samples, time steps, features.", "The model is trained across 100 epochs, and a batch size of 712 (equal to the number of data points in the training and validation set) is specified.", "Here is a plot of the training vs. validation loss:", "A plot of the predicted vs. actual rainfall is also generated:", "The prediction results are compared against the validation set on the basis of Mean Directional Accuracy (MDA), root mean squared error (RMSE) and mean forecast error (MFE).", "While the demonstrated results across the validation set are quite respectable, it is only by comparing the model predictions to the test (or unseen) data that we can be reasonably confident of the LSTM model holding predictive power.", "As previously explained, the last 10 months of rainfall data are used as the test set. The LSTM model is then used to predict 10 months ahead, with the predictions then being compared to the actual values.", "The previous values down to t-120 are used to predict the value at time t:", "The obtained results are as follows:", "With the mean rainfall for the last 10 months having come in at 148.93 mm, the forecast accuracy has shown similar performance to that of the validation set, and errors are low relative to the mean rainfall computed across the test set.", "In this example, you have seen:", "Many thanks for your time, and the associated repository for this example can be found here.", "You can also find more of my data science content at michael-grogan.com.", "Disclaimer: This article is written on an \u201cas is\u201d basis and without warranty. It was written with the intention of providing an overview of data science concepts, and should not be interpreted as professional advice. The findings and interpretations in this article are those of the author and are not endorsed by or affiliated with Met \u00c9ireann in any way.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Science Consultant with expertise in economics, time series analysis, and Bayesian methods | michael-grogan.com"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F51250fb7cfa3&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmodelling-volatile-time-series-with-lstm-networks-51250fb7cfa3&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmodelling-volatile-time-series-with-lstm-networks-51250fb7cfa3&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmodelling-volatile-time-series-with-lstm-networks-51250fb7cfa3&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmodelling-volatile-time-series-with-lstm-networks-51250fb7cfa3&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----51250fb7cfa3--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----51250fb7cfa3--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://mgcodesandstats.medium.com/?source=post_page-----51250fb7cfa3--------------------------------", "anchor_text": ""}, {"url": "https://mgcodesandstats.medium.com/?source=post_page-----51250fb7cfa3--------------------------------", "anchor_text": "Michael Grogan"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Feec017a8b178&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmodelling-volatile-time-series-with-lstm-networks-51250fb7cfa3&user=Michael+Grogan&userId=eec017a8b178&source=post_page-eec017a8b178----51250fb7cfa3---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F51250fb7cfa3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmodelling-volatile-time-series-with-lstm-networks-51250fb7cfa3&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F51250fb7cfa3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmodelling-volatile-time-series-with-lstm-networks-51250fb7cfa3&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://www.met.ie/climate/available-data/historical-data", "anchor_text": "Met \u00c9ireann website"}, {"url": "https://github.com/MGCodesandStats/weather-modelling", "anchor_text": "here"}, {"url": "https://www.michael-grogan.com/", "anchor_text": "michael-grogan.com"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----51250fb7cfa3---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----51250fb7cfa3---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/time-series-analysis?source=post_page-----51250fb7cfa3---------------time_series_analysis-----------------", "anchor_text": "Time Series Analysis"}, {"url": "https://medium.com/tag/neural-networks?source=post_page-----51250fb7cfa3---------------neural_networks-----------------", "anchor_text": "Neural Networks"}, {"url": "https://medium.com/tag/weather?source=post_page-----51250fb7cfa3---------------weather-----------------", "anchor_text": "Weather"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F51250fb7cfa3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmodelling-volatile-time-series-with-lstm-networks-51250fb7cfa3&user=Michael+Grogan&userId=eec017a8b178&source=-----51250fb7cfa3---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F51250fb7cfa3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmodelling-volatile-time-series-with-lstm-networks-51250fb7cfa3&user=Michael+Grogan&userId=eec017a8b178&source=-----51250fb7cfa3---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F51250fb7cfa3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmodelling-volatile-time-series-with-lstm-networks-51250fb7cfa3&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----51250fb7cfa3--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F51250fb7cfa3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmodelling-volatile-time-series-with-lstm-networks-51250fb7cfa3&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----51250fb7cfa3---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----51250fb7cfa3--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----51250fb7cfa3--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----51250fb7cfa3--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----51250fb7cfa3--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----51250fb7cfa3--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----51250fb7cfa3--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----51250fb7cfa3--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----51250fb7cfa3--------------------------------", "anchor_text": ""}, {"url": "https://mgcodesandstats.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://mgcodesandstats.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Michael Grogan"}, {"url": "https://mgcodesandstats.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "1.5K Followers"}, {"url": "http://michael-grogan.com", "anchor_text": "michael-grogan.com"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Feec017a8b178&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmodelling-volatile-time-series-with-lstm-networks-51250fb7cfa3&user=Michael+Grogan&userId=eec017a8b178&source=post_page-eec017a8b178--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F3c6e2607915&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmodelling-volatile-time-series-with-lstm-networks-51250fb7cfa3&newsletterV3=eec017a8b178&newsletterV3Id=3c6e2607915&user=Michael+Grogan&userId=eec017a8b178&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}