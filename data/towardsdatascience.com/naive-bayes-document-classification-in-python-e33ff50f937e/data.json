{"url": "https://towardsdatascience.com/naive-bayes-document-classification-in-python-e33ff50f937e", "time": 1682996787.105258, "path": "towardsdatascience.com/naive-bayes-document-classification-in-python-e33ff50f937e/", "webpage": {"metadata": {"title": "Naive Bayes Document Classification in Python | by Kelly Epley | Towards Data Science", "h1": "Naive Bayes Document Classification in Python", "description": "Naive Bayes is a reasonably effective strategy for document classification tasks even though it is, as the name indicates, \u201cnaive.\u201d Naive Bayes classification makes use of Bayes theorem to determine\u2026"}, "outgoing_paragraph_urls": [{"url": "https://philpapers.org", "anchor_text": "PhilPapers", "paragraph_index": 11}, {"url": "https://philpapers.org/browse/varieties-of-virtue-ethics", "anchor_text": "\u201cVarieties of Virtue Ethics\u201d", "paragraph_index": 12}, {"url": "https://philpapers.org/browse/trust", "anchor_text": "Trust", "paragraph_index": 12}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.naive_bayes.MultinomialNB.html#sklearn.naive_bayes.MultinomialNB", "anchor_text": "documentation", "paragraph_index": 21}], "all_paragraphs": ["Naive Bayes is a reasonably effective strategy for document classification tasks even though it is, as the name indicates, \u201cnaive.\u201d", "Naive Bayes classification makes use of Bayes theorem to determine how probable it is that an item is a member of a category. If I have a document that contains the word \u201ctrust\u201d or \u201cvirtue\u201d or \u201cknowledge,\u201d what\u2019s the probability that it falls in the category \u201cethics\u201d rather than \u201cepistemology?\u201d Naive Bayes sorts items into categories based on whichever probability is highest.", "It\u2019s \u201cnaive\u201d because it treats the probability of each word appearing in a document as though it were independent of the probability of any other word appearing. This assumption is almost never true of any documents we\u2019d wish to classify, which tend to follow rules of grammar, syntax, and communication. When we follow these rules, some words tend to be correlated with other words.", "Here, I devised what I thought would be a somewhat difficult classification task: sorting philosophy articles\u2019 abstracts. I chose sub-disciplines that are distinct, but that have a significant amount of overlap: Epistemology and Ethics. Both employ the language of justification and reasons. They also intersect frequently (e.g. ethics of belief, moral knowledge, and so forth). In the end, Naive Bayes performed surprisingly well in classifying these documents.", "Bayes theorem tells us that the probability of a hypothesis given some evidence is equal to the probability of the hypothesis multiplied by the probability of the evidence given the hypothesis, then divided by the probability of the evidence.", "Since we are classifying documents, the \u201chypothesis\u201d is: the document fits into category C. The \u201cevidence\u201d is the words W occurring in the document.", "Since classification tasks involve comparing two (or more) hypotheses, we can use the ratio form of Bayes theorem, which compares the numerators of the above formula (for Bayes aficionados: the prior times the likelihood) for each hypothesis:", "Since there are many words in a document, the formula becomes:", "For example, if I want to know whether a document containing the words \u201cpreheat the oven\u201d is a member of the category \u201ccookbooks\u201d rather than \u201cnovels,\u201d I\u2019d compare this:", "If the probability of its being a cookbook given the presence of the words in the document is greater than the probability of its being a novel, Naive Bayes returns \u201ccookbook\u201d. If it\u2019s the other way around, Naive Bayes returns \u201cnovel\u201d.", "A demonstration: Classifying philosophy papers by their abstracts", "The documents I will attempt to classify are article abstracts from a database called PhilPapers. Philpapers is a comprehensive database of research in philosophy. Since this database is curated by legions of topic editors, we can be reasonably confident that the document classifications given on the site are correct.", "I selected two philosophy subdisciplines from the site for a binary Naive Bayes classifier: ethics or epistemology. From each subdiscipline, I selected a topic. For ethics, I chose the topic \u201cVarieties of Virtue Ethics\u201d and for epistemology, I chose \u201cTrust.\u201d I collected 80 ethics and 80 epistemology abstracts.", "The head and tail of my initial DataFrame looked like this:", "To run a Naive Bayes classifier in Scikit Learn, the categories must be numeric, so I assigned the label 1 to all ethics abstracts and the label 0 to all epistemology abstracts (that is, not ethics):", "2. Split data into training and testing sets", "It\u2019s important to hold back some data so that we can validate our model. For this, we can use Scikit Learn\u2019s train_test_split.", "3. Convert abstracts into word count vectors", "A Naive Bayes classifier needs to be able to calculate how many times each word appears in each document and how many times it appears in each category. To make this possible, the data needs to look something like this:", "Each row represents a document, and each column represents a word. The first row might be a document that contains a zero for \u201cpreheat,\u201d a one for \u201cthe\u201d and a zero for \u201coven\u201d. That means that the document contains one instance of the word \u201cthe\u201d, but no \u201cpreheat\u201d or \u201coven.\u201d", "To get our abstracts in this format, we can use Scikit Learn\u2019s CountVectorizer. CountVectorizer creates a vector of word counts for each abstract to form a matrix. Each index corresponds to a word and every word appearing in the abstracts is represented.", "We can use the strip_accents, token_pattern, lowercase, and stopwords arguments to exclude nonwords, numbers, articles, and other things that are not useful for predicting categories from our counts. For details, see the documentation.", "If you\u2019d like to view the data and investigate the word counts, you can make a DataFrame of the word counts with the following code:", "4. Fit the model and make predictions", "Now we\u2019re ready to fit a Multinomial Naive Bayes classifier model to our training data and use it to predict the test data\u2019s labels:", "Let\u2019s see how the model performed on the test data:", "To understand these scores, it helps to see a breakdown:", "The accuracy score tells us: out of all of the identifications we made, how many were correct?", "The precision score tells us: out of all of the ethics identifications we made, how many were correct?", "The recall score tells us: out of all of the true cases of ethics, how many did we identify correctly?", "To investigate the incorrect labels, we can put the actual labels and the predicted labels side-by-side in a DataFrame.", "Overall, my Naive Bayes classifier performed well on the test set. There were only three mismatched labels out of 40.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Kelly Epley is a Data Science Fellow at Flatiron DC. She has a Ph.D. in philosophy from the University of Oklahoma."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fe33ff50f937e&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnaive-bayes-document-classification-in-python-e33ff50f937e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnaive-bayes-document-classification-in-python-e33ff50f937e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnaive-bayes-document-classification-in-python-e33ff50f937e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnaive-bayes-document-classification-in-python-e33ff50f937e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----e33ff50f937e--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----e33ff50f937e--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@kemepley?source=post_page-----e33ff50f937e--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@kemepley?source=post_page-----e33ff50f937e--------------------------------", "anchor_text": "Kelly Epley"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F9ef2b3547704&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnaive-bayes-document-classification-in-python-e33ff50f937e&user=Kelly+Epley&userId=9ef2b3547704&source=post_page-9ef2b3547704----e33ff50f937e---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe33ff50f937e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnaive-bayes-document-classification-in-python-e33ff50f937e&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe33ff50f937e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnaive-bayes-document-classification-in-python-e33ff50f937e&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://philpapers.org", "anchor_text": "PhilPapers"}, {"url": "https://philpapers.org/browse/varieties-of-virtue-ethics", "anchor_text": "\u201cVarieties of Virtue Ethics\u201d"}, {"url": "https://philpapers.org/browse/trust", "anchor_text": "Trust"}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.naive_bayes.MultinomialNB.html#sklearn.naive_bayes.MultinomialNB", "anchor_text": "documentation"}, {"url": "https://plato.stanford.edu/entries/logic-inductive/", "anchor_text": "Inductive Logic (Stanford Encyclopedia of Philosophy)A good way to specify the axioms of the logic of inductive support functions is as follows. These axioms are apparently\u2026plato.stanford.edu"}, {"url": "https://en.wikipedia.org/wiki/Additive_smoothing", "anchor_text": "Additive smoothing - WikipediaFrom a Bayesian point of view, this corresponds to the expected value of the posterior distribution, using a symmetric\u2026en.wikipedia.org"}, {"url": "https://towardsdatascience.com/naive-bayes-intuition-and-implementation-ac328f9c9718", "anchor_text": "Naive Bayes: Intuition and ImplementationLearn about Naive Bayes Algorithms and their power to predict classes.towardsdatascience.com"}, {"url": "https://jakevdp.github.io/PythonDataScienceHandbook/05.05-naive-bayes.html", "anchor_text": "In Depth: Naive Bayes ClassificationBecause naive Bayesian classifiers make such stringent assumptions about data, they will generally not perform as well\u2026jakevdp.github.io"}, {"url": "https://medium.com/syncedreview/applying-multinomial-naive-bayes-to-nlp-problems-a-practical-explanation-4f5271768ebf", "anchor_text": "Applying Multinomial Naive Bayes to NLP Problems: A Practical Explanation1.Introduction Naive Bayes is a family of algorithms based on applying Bayes theorem with a strong(naive)\u2026medium.com"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----e33ff50f937e---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fe33ff50f937e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnaive-bayes-document-classification-in-python-e33ff50f937e&user=Kelly+Epley&userId=9ef2b3547704&source=-----e33ff50f937e---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fe33ff50f937e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnaive-bayes-document-classification-in-python-e33ff50f937e&user=Kelly+Epley&userId=9ef2b3547704&source=-----e33ff50f937e---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe33ff50f937e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnaive-bayes-document-classification-in-python-e33ff50f937e&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----e33ff50f937e--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fe33ff50f937e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnaive-bayes-document-classification-in-python-e33ff50f937e&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----e33ff50f937e---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----e33ff50f937e--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----e33ff50f937e--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----e33ff50f937e--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----e33ff50f937e--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----e33ff50f937e--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----e33ff50f937e--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----e33ff50f937e--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----e33ff50f937e--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@kemepley?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@kemepley?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Kelly Epley"}, {"url": "https://medium.com/@kemepley/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "68 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F9ef2b3547704&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnaive-bayes-document-classification-in-python-e33ff50f937e&user=Kelly+Epley&userId=9ef2b3547704&source=post_page-9ef2b3547704--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fusers%2F9ef2b3547704%2Flazily-enable-writer-subscription&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnaive-bayes-document-classification-in-python-e33ff50f937e&user=Kelly+Epley&userId=9ef2b3547704&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}