{"url": "https://towardsdatascience.com/cost-functions-the-underpinnings-of-machine-learning-549ac5edb211", "time": 1682997718.668481, "path": "towardsdatascience.com/cost-functions-the-underpinnings-of-machine-learning-549ac5edb211/", "webpage": {"metadata": {"title": "Cost Functions: The Underpinnings of Machine Learning | by Peter Grant | Towards Data Science", "h1": "Cost Functions: The Underpinnings of Machine Learning", "description": "Fitting data sets to models is the basis of machine learning and data science. In this way we are able to create predictive tools that help people make important decisions. This is typically done by\u2026"}, "outgoing_paragraph_urls": [{"url": "https://towardsdatascience.com/how-to-choose-between-multiple-models-a0c274b4228a", "anchor_text": "model training, validating, and testing phases.", "paragraph_index": 1}], "all_paragraphs": ["Fitting data sets to models is the basis of machine learning and data science. In this way we are able to create predictive tools that help people make important decisions.", "This is typically done by minimizing the difference between the predictions generated by the model and the actual data in the model training, validating, and testing phases.", "To do this, we must be able to identify the difference between the model prediction and the actual values of the data. To fit the model to the data and create a valuable prediction tool, we must be able to rapidly calculate that difference using a minimizable function.", "This is the goal of the cost function.", "In data science, the cost function calculates the difference between your model predictions and your data set.", "According to Wikipedia a cost function is \u201ca function that maps an event or values of one or more variables onto a real number intuitively representing some \u201ccost\u201d associated with the event\u201d. In more practical terms, it\u2019s a function to calculate a parameter that you are about to either minimize or maximize.", "In data science, this commonly means identifying the differences between your models predictions and the training data set. In this way you can quantify the error in your model\u2019s predictions, and use optimization approaches to minimize that error.", "In the name cost function, \u201cfunction\u201d refers to the fact that it\u2019s a function calculating a value and \u201ccost\u201d refers to the penalty that is being calculated by the function.", "Note that the notion of a cost function is very flexible, and it can be customized to match a situation. It\u2019s about writing an equation that captures what you really care about.", "One example of cost function use is a person simulating the energy performance of a building. (S)he wants to minimize energy consumption, and writes a cost function accordingly. But the minimum energy consumption would be a building that never heats or cools the space! Clearly not acceptable.", "(S)he can add a term to the cost function that also penalizes the result for the number of hours when the occupants are uncomfortable. Then the result of the optimization will be a design that uses the minimum amount of energy while still maintaining comfort in the space. This cost function might look something like:", "In this way a single hour of predicted discomfort for occupants is as bad as one million units of energy consumption. Now the result of the system will be to find the most energy efficient way to heat and cool the space, not merely avoid heating/cooling the space to save energy.", "You can design your cost function as needed to study what\u2019s most important in your application.", "This was a very industry specific example. Some more generic data science examples include:", "Remember that you can design your cost function as needed to study what\u2019s most important in your application. This is important because all cost functions have different strengths and weaknesses.", "Thinking back to the building energy simulation example, a cost function that only examined energy consumption would have different impacts from one that only looked at uncomfortable hours. One without the energy consumption term has no pressure to ensure that the building is energy efficient. And one without the uncomfortable hours term has no pressure to ensure that the building keeps the occupants comfortable.", "Combining the two into a single cost function forces the model to care about both.", "Since the model is capable of examining both, it becomes important to ensure that each term is given the right amount of consideration in the cost function. This is done by adding weighting factors, or multipliers to each term, that tell the cost function how much you care about each term.", "In the building energy simulation example we had a weighting factor of 1 for the energy consumption, and a weighting factor of 1,000,000 for the uncomfortable hours. This basically forces the model to ensure there are 0 hours of discomfort.", "But what if a few hours of discomfort are OK to save energy? Then you can change your weighting factors to give the model results a different balance of caring about energy consumption and uncomfortable hours.", "Weighting factors tell the cost function how much you care about each term.", "A more directly data science example of this is combining MAE and RMSE in a cost function used to fit a model to a data set. MAE has the effect of getting the model as close to the data set as possible on average, across the entire data set. \u201cOn average\u201d is an important term here. It can lead to models that are extremely close at most point, and extremely inaccurate in a few points. The RMSE has the opposite impact. Since it uses the average of the squared errors, it pressures the model to have small errors at each and every point. It avoids models with a small handful of extremely inaccurate points, but can sacrifice average model accuracy to force that goal.", "To balance the strengths and weaknesses of these two approaches, a model fitting cost function could combine the MBE and RMSE. You would then want to apply weighting factors to the two terms in the cost function to balance the two terms as needed for your application.", "In order to create useful prediction tools, we must be able to create mathematical models that closely fit the data set. In order to create models that closely fit the data set, we must be able to quantify how different our models predictions are from the actual data.", "This is where the role of the cost function. Cost functions are formulas calculating a \u201ccost\u201d associated with a situation. In the case of model fitting, the cost function typically calculates the error in the model.", "Cost functions are flexible, and can include multiple terms. This enables you to combine different important factors into a single cost function. One example is looking at energy consumption of a building. Combining the terms of energy consumption and uncomfortable hours creates a cost function forcing the model to minimize energy consumption while also making sure people stay comfortable. In model fitting, a cost function may want to combine both the Mean Absolute Error (MAE) and Root Mean Square Error (RMSE).", "Cost functions with multiple terms need a way to balance the two terms, according to how much you value one over the other. Weighting factors are multipliers applied to each term that increase/decrease the value of that term accordingly. They can be added and adjusted to each term as needed to identify the desired balance in the cost function, and in the results of the minimization.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Scientist at Lawrence Berkeley National Laboratory who also teaches skills you need to build a fulfilling career."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F549ac5edb211&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcost-functions-the-underpinnings-of-machine-learning-549ac5edb211&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcost-functions-the-underpinnings-of-machine-learning-549ac5edb211&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcost-functions-the-underpinnings-of-machine-learning-549ac5edb211&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcost-functions-the-underpinnings-of-machine-learning-549ac5edb211&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----549ac5edb211--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----549ac5edb211--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://petergrant-81989.medium.com/?source=post_page-----549ac5edb211--------------------------------", "anchor_text": ""}, {"url": "https://petergrant-81989.medium.com/?source=post_page-----549ac5edb211--------------------------------", "anchor_text": "Peter Grant"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F985f2ff02845&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcost-functions-the-underpinnings-of-machine-learning-549ac5edb211&user=Peter+Grant&userId=985f2ff02845&source=post_page-985f2ff02845----549ac5edb211---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F549ac5edb211&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcost-functions-the-underpinnings-of-machine-learning-549ac5edb211&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F549ac5edb211&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcost-functions-the-underpinnings-of-machine-learning-549ac5edb211&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://towardsdatascience.com/how-to-choose-between-multiple-models-a0c274b4228a", "anchor_text": "model training, validating, and testing phases."}, {"url": "https://towardsdatascience.com/understanding-the-fundamentals-of-linear-regression-7e64afd614e1", "anchor_text": "Understanding the Fundamentals of Linear Regression"}, {"url": "https://towardsdatascience.com/understanding-multiple-regression-249b16bde83e", "anchor_text": "Understanding Multiple Regression"}, {"url": "https://en.wikipedia.org/wiki/Mean_absolute_error", "anchor_text": "Mean Absolute Error"}, {"url": "https://en.wikipedia.org/wiki/Root-mean-square_deviation", "anchor_text": "Root Mean Square Error"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----549ac5edb211---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/towards-data-science?source=post_page-----549ac5edb211---------------towards_data_science-----------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/tag/data-science?source=post_page-----549ac5edb211---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----549ac5edb211---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/programming?source=post_page-----549ac5edb211---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F549ac5edb211&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcost-functions-the-underpinnings-of-machine-learning-549ac5edb211&user=Peter+Grant&userId=985f2ff02845&source=-----549ac5edb211---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F549ac5edb211&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcost-functions-the-underpinnings-of-machine-learning-549ac5edb211&user=Peter+Grant&userId=985f2ff02845&source=-----549ac5edb211---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F549ac5edb211&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcost-functions-the-underpinnings-of-machine-learning-549ac5edb211&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----549ac5edb211--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F549ac5edb211&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcost-functions-the-underpinnings-of-machine-learning-549ac5edb211&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----549ac5edb211---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----549ac5edb211--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----549ac5edb211--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----549ac5edb211--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----549ac5edb211--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----549ac5edb211--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----549ac5edb211--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----549ac5edb211--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----549ac5edb211--------------------------------", "anchor_text": ""}, {"url": "https://petergrant-81989.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://petergrant-81989.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Peter Grant"}, {"url": "https://petergrant-81989.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "969 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F985f2ff02845&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcost-functions-the-underpinnings-of-machine-learning-549ac5edb211&user=Peter+Grant&userId=985f2ff02845&source=post_page-985f2ff02845--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F90e3ec001185&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcost-functions-the-underpinnings-of-machine-learning-549ac5edb211&newsletterV3=985f2ff02845&newsletterV3Id=90e3ec001185&user=Peter+Grant&userId=985f2ff02845&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}