{"url": "https://towardsdatascience.com/machine-learning-on-azure-with-automated-predictions-51d1721210f5", "time": 1683002662.363081, "path": "towardsdatascience.com/machine-learning-on-azure-with-automated-predictions-51d1721210f5/", "webpage": {"metadata": {"title": "Machine Learning on Azure with automated predictions | by Saurabh Maheshwari | Towards Data Science", "h1": "Machine Learning on Azure with automated predictions", "description": "I had a recent opportunity to work as a Data Science Intern at a company that used Microsoft Azure as their AI platform. For one of my projects, I had to recommend an optimal strategy (set-points) to\u2026"}, "outgoing_paragraph_urls": [{"url": "https://azure.microsoft.com/en-us/services/data-factory/?&ef_id=Cj0KCQiAxfzvBRCZARIsAGA7YMxT8Qsq5zPFJzJEN9lyqeQCu_F_RsX22fQrYZfz_IA_YFchnbAK2WkaAomJEALw_wcB:G:s&OCID=AID2000128_SEM_k2OvFYKP&MarinID=k2OvFYKP_287540103047_azure%20data%20factory_e_c__45619893599_kwd-295793767169&lnkd=Google_Azure_Brand&gclid=Cj0KCQiAxfzvBRCZARIsAGA7YMxT8Qsq5zPFJzJEN9lyqeQCu_F_RsX22fQrYZfz_IA_YFchnbAK2WkaAomJEALw_wcB", "anchor_text": "ADF", "paragraph_index": 6}, {"url": "https://docs.microsoft.com/en-us/azure/storage/blobs/storage-blobs-overview", "anchor_text": "blobs", "paragraph_index": 6}, {"url": "https://docs.microsoft.com/en-us/azure/data-factory/tutorial-hybrid-copy-data-tool", "anchor_text": "copy", "paragraph_index": 6}, {"url": "https://docs.microsoft.com/en-us/azure/machine-learning/", "anchor_text": "ML Services", "paragraph_index": 7}, {"url": "https://github.com/Azure/MachineLearningNotebooks/tree/master/how-to-use-azureml/training-with-deep-learning", "anchor_text": "here", "paragraph_index": 9}, {"url": "https://azure.microsoft.com/en-us/services/container-instances/", "anchor_text": "ACI", "paragraph_index": 10}, {"url": "https://docs.microsoft.com/en-us/azure/machine-learning/service/tutorial-deploy-models-with-aml", "anchor_text": "docker image and deploy the model", "paragraph_index": 12}, {"url": "https://docs.microsoft.com/en-us/azure/data-factory/how-to-create-schedule-trigger", "anchor_text": "schedule a trigger", "paragraph_index": 14}, {"url": "https://docs.microsoft.com/en-us/azure/data-factory/solution-template-databricks-notebook", "anchor_text": "this", "paragraph_index": 14}, {"url": "https://powerbi.microsoft.com/en-us/get-started/?&ef_id=Cj0KCQiAxfzvBRCZARIsAGA7YMyoGQvJwmxuyMoTd_MBcJfgJzlIB2H6ZMnbFAmez7nDCVvIWUdbbVsaAj5lEALw_wcB:G:s&OCID=AID2000568_SEM_bHb24t0B&lnkd=Google_PowerBI_Brand&MarinID=sbHb24t0B_286802327412_power%20bi_e_c__55839339962_kwd-25206446922_&gclid=Cj0KCQiAxfzvBRCZARIsAGA7YMyoGQvJwmxuyMoTd_MBcJfgJzlIB2H6ZMnbFAmez7nDCVvIWUdbbVsaAj5lEALw_wcB", "anchor_text": "PowerBI", "paragraph_index": 21}, {"url": "https://azure.microsoft.com/en-us/free/", "anchor_text": "this", "paragraph_index": 23}, {"url": "https://medium.com/u/f4178bb71651?source=post_page-----51d1721210f5--------------------------------", "anchor_text": "Radek Rybicki", "paragraph_index": 24}], "all_paragraphs": ["I had a recent opportunity to work as a Data Science Intern at a company that used Microsoft Azure as their AI platform. For one of my projects, I had to recommend an optimal strategy (set-points) to run multiple steam boilers in parallel at a manufacturing plant. For example, given certain conditions, run boiler1 at 100% (full capacity), boiler2 at 50% and so on. The goal was to meet the plant steam demand with minimal cumulative fuel input.", "Due to the nature of the problem, the boiler set-points were to be updated minute-by-minute, 24/7.", "To achieve this, I created an end-to-end machine learning (ML) pipeline on Azure. By pipeline, I mean :", "While building this pipeline, I found Microsoft\u2019s documentation to be spread across several products and less than straightforward, so I thought it would be helpful to share my workflow and provide links to appropriate resources.", "The workflow can be summarized in the figure below.", "The intent of this blog is not to discuss the ML methodology, but to understand how can one leverage different Microsoft products to create an end-to-end production pipeline.", "Before I start building my ML model, I needed to query relevant historical data from the on-premises SQL server and store it on the cloud. Here, Azure Data Factory v2 (ADF) comes in handy. ADF lets you connect to the on-premises database and write t-SQL queries to store data in the Azure Blob storage (blobs). The copy tool (under Move and Transform activity) of ADF lets you copy the required data.", "Once you have the required data stored in blob storage, you can use the Machine Learning Service Workspace (ML Services) platform that Azure provides for developing ML models. If you\u2019re familiar with Jupyter Notebook environment, then you\u2019ll be happy to know that ML Services lets you create Notebooks with important libraries pre-installed. So you do not need to worry about setting up the environment.", "Building a predictive model requires the following steps:", "A good tutorial can be found here.", "Once the final model is registered with the workspace, we need to deploy it as an API endpoint, which we can query to get predictions almost instantaneously. To create the API, I used Azure Container Instances (ACI).", "In addition to the final model, you would need the following to successfully deploy models using ACI:", "Once you have the final model, entry script, dependencies, and deployment configuration, you can create a docker image and deploy the model.", "This is the interesting part. I needed to submit the predictions to the on-premises server database minute-by-minute, 24/7, so I had to automate the prediction part. For this purpose, I created a Databricks notebook (see code examples below) that fetches the input, posts requests to the API and submits the predictions. The flow can be summarized as follows:", "To automate this flow every minute, you can schedule a trigger (frequency of triggering, when to start and stop, etc.) in ADF. Follow this for more details on how to add Databricks to ADF.", "My Databricks notebook looks like this:", "This will let you connect to the blob storage. Next, I connect to the specific blob and convert it to a pandas dataframe.", "Now, you have your data in a pandas dataframe. Do the required data transformations, if any. Then, call the API endpoint to get predictions.", "Here pd_df is the spark dataframe containing the predictions. Finally, you can save these predictions to Azure SQL Server Database or a blob as follows.", "Connecting Databricks to Azure SQL Server Database", "Connecting Databricks to Azure Blob Storage", "You can connect the on-premises database with PowerBI once you start populating it with predictions. PowerBI lets you create awesome visualizations just by dragging and dropping fields from the database table. Once you have the required data in PowerBI, you can calculate and visualize key performance indicators (KPI) to gauge the performance of your model. For example, one of the KPI in my case could be output to input (efficiency) ratio over time. Once created, you can automatically update your dashboard as your database gets updated.", "In fact, while analyzing your data, PowerBI could come really handy, saving you time and coding efforts while creating publication-quality interactive graphs.", "It could be tough to design such a complicated pipeline from scratch, especially if you are new to Azure. Hopefully, this blog would help you get started. You can create a Microsoft Azure free account and start using most of their services. For more details on how to get started, follow this.", "Lastly, I would like to sincerely thank my collaborator Radek Rybicki, who helped me define the project and guided me through different stages of it.", "This is my first data science blog, and I am really excited to continue blogging. Please let me know if you have any comments and/or suggestions. We can discuss each aspect of the pipeline in more detail later.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Statistics Graduate Student @ UC Davis. Looking for Data Science opportunities."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F51d1721210f5&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-on-azure-with-automated-predictions-51d1721210f5&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-on-azure-with-automated-predictions-51d1721210f5&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-on-azure-with-automated-predictions-51d1721210f5&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-on-azure-with-automated-predictions-51d1721210f5&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----51d1721210f5--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----51d1721210f5--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@sbhmaheshwari?source=post_page-----51d1721210f5--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@sbhmaheshwari?source=post_page-----51d1721210f5--------------------------------", "anchor_text": "Saurabh Maheshwari"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fa3828087c8b8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-on-azure-with-automated-predictions-51d1721210f5&user=Saurabh+Maheshwari&userId=a3828087c8b8&source=post_page-a3828087c8b8----51d1721210f5---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F51d1721210f5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-on-azure-with-automated-predictions-51d1721210f5&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F51d1721210f5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-on-azure-with-automated-predictions-51d1721210f5&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://azure.microsoft.com/en-us/services/data-factory/?&ef_id=Cj0KCQiAxfzvBRCZARIsAGA7YMxT8Qsq5zPFJzJEN9lyqeQCu_F_RsX22fQrYZfz_IA_YFchnbAK2WkaAomJEALw_wcB:G:s&OCID=AID2000128_SEM_k2OvFYKP&MarinID=k2OvFYKP_287540103047_azure%20data%20factory_e_c__45619893599_kwd-295793767169&lnkd=Google_Azure_Brand&gclid=Cj0KCQiAxfzvBRCZARIsAGA7YMxT8Qsq5zPFJzJEN9lyqeQCu_F_RsX22fQrYZfz_IA_YFchnbAK2WkaAomJEALw_wcB", "anchor_text": "ADF"}, {"url": "https://docs.microsoft.com/en-us/azure/storage/blobs/storage-blobs-overview", "anchor_text": "blobs"}, {"url": "https://docs.microsoft.com/en-us/azure/data-factory/tutorial-hybrid-copy-data-tool", "anchor_text": "copy"}, {"url": "https://docs.microsoft.com/en-us/azure/machine-learning/", "anchor_text": "ML Services"}, {"url": "https://docs.microsoft.com/en-us/azure/machine-learning/service/how-to-manage-workspace", "anchor_text": "Create your Azure Machine Learning workspace"}, {"url": "https://docs.microsoft.com/en-us/azure/machine-learning/service/how-to-access-data", "anchor_text": "connect to the blob storage"}, {"url": "https://docs.microsoft.com/en-us/azure/machine-learning/service/how-to-set-up-training-targets", "anchor_text": "Create an Azure Machine Learning compute target"}, {"url": "https://docs.microsoft.com/en-us/azure/machine-learning/service/tutorial-train-models-with-aml#create-a-training-script", "anchor_text": "Create a training script"}, {"url": "https://docs.microsoft.com/en-us/azure/machine-learning/service/how-to-train-ml-models", "anchor_text": "Create an Estimator"}, {"url": "https://docs.microsoft.com/en-us/azure/machine-learning/service/how-to-tune-hyperparameters", "anchor_text": "Configure your hyperparameter tuning experiment"}, {"url": "https://docs.microsoft.com/en-us/python/api/azureml-core/azureml.core.experiment(class)?view=azure-ml-py#submit-config--tags-none----kwargs-", "anchor_text": "Submit the experiment"}, {"url": "https://docs.microsoft.com/en-us/azure/machine-learning/service/how-to-deploy-and-where#registermodel", "anchor_text": "register the final model"}, {"url": "https://github.com/Azure/MachineLearningNotebooks/tree/master/how-to-use-azureml/training-with-deep-learning", "anchor_text": "here"}, {"url": "https://azure.microsoft.com/en-us/services/container-instances/", "anchor_text": "ACI"}, {"url": "https://docs.microsoft.com/en-us/azure/machine-learning/service/tutorial-deploy-models-with-aml", "anchor_text": "docker image and deploy the model"}, {"url": "https://docs.microsoft.com/en-us/azure/data-factory/how-to-create-schedule-trigger", "anchor_text": "schedule a trigger"}, {"url": "https://docs.microsoft.com/en-us/azure/data-factory/solution-template-databricks-notebook", "anchor_text": "this"}, {"url": "https://powerbi.microsoft.com/en-us/get-started/?&ef_id=Cj0KCQiAxfzvBRCZARIsAGA7YMyoGQvJwmxuyMoTd_MBcJfgJzlIB2H6ZMnbFAmez7nDCVvIWUdbbVsaAj5lEALw_wcB:G:s&OCID=AID2000568_SEM_bHb24t0B&lnkd=Google_PowerBI_Brand&MarinID=sbHb24t0B_286802327412_power%20bi_e_c__55839339962_kwd-25206446922_&gclid=Cj0KCQiAxfzvBRCZARIsAGA7YMyoGQvJwmxuyMoTd_MBcJfgJzlIB2H6ZMnbFAmez7nDCVvIWUdbbVsaAj5lEALw_wcB", "anchor_text": "PowerBI"}, {"url": "https://azure.microsoft.com/en-us/free/", "anchor_text": "this"}, {"url": "https://medium.com/u/f4178bb71651?source=post_page-----51d1721210f5--------------------------------", "anchor_text": "Radek Rybicki"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----51d1721210f5---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/microsoft-azure?source=post_page-----51d1721210f5---------------microsoft_azure-----------------", "anchor_text": "Microsoft Azure"}, {"url": "https://medium.com/tag/deployment?source=post_page-----51d1721210f5---------------deployment-----------------", "anchor_text": "Deployment"}, {"url": "https://medium.com/tag/cloud-computing?source=post_page-----51d1721210f5---------------cloud_computing-----------------", "anchor_text": "Cloud Computing"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F51d1721210f5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-on-azure-with-automated-predictions-51d1721210f5&user=Saurabh+Maheshwari&userId=a3828087c8b8&source=-----51d1721210f5---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F51d1721210f5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-on-azure-with-automated-predictions-51d1721210f5&user=Saurabh+Maheshwari&userId=a3828087c8b8&source=-----51d1721210f5---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F51d1721210f5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-on-azure-with-automated-predictions-51d1721210f5&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----51d1721210f5--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F51d1721210f5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-on-azure-with-automated-predictions-51d1721210f5&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----51d1721210f5---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----51d1721210f5--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----51d1721210f5--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----51d1721210f5--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----51d1721210f5--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----51d1721210f5--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----51d1721210f5--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----51d1721210f5--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----51d1721210f5--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@sbhmaheshwari?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@sbhmaheshwari?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Saurabh Maheshwari"}, {"url": "https://medium.com/@sbhmaheshwari/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "17 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fa3828087c8b8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-on-azure-with-automated-predictions-51d1721210f5&user=Saurabh+Maheshwari&userId=a3828087c8b8&source=post_page-a3828087c8b8--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fusers%2Fa3828087c8b8%2Flazily-enable-writer-subscription&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-on-azure-with-automated-predictions-51d1721210f5&user=Saurabh+Maheshwari&userId=a3828087c8b8&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}