{"url": "https://towardsdatascience.com/robosomm-chapter-1-predicting-grape-varieties-4c5beb505a7b", "time": 1682995995.519149, "path": "towardsdatascience.com/robosomm-chapter-1-predicting-grape-varieties-4c5beb505a7b/", "webpage": {"metadata": {"title": "Predicting Grape Varieties. A lot has been written and said about\u2026 | by Roald Schuring | Towards Data Science", "h1": "Predicting Grape Varieties", "description": "A lot has been written and said about the art and science of blind tasting wine. The ability to identify a glass of wine in front of you correctly is a source of pride for the world\u2019s best\u2026"}, "outgoing_paragraph_urls": [{"url": "https://github.com/RoaldSchuring/Wine-Blind-Tasting-Algorithm", "anchor_text": "GitHub repository", "paragraph_index": 2}, {"url": "https://github.com/RoaldSchuring/Wine-Blind-Tasting-Algorithm/blob/master/predicting_grape_varieties.ipynb", "anchor_text": "Jupyter Notebook", "paragraph_index": 2}, {"url": "https://www.winemag.com/", "anchor_text": "https://www.winemag.com/", "paragraph_index": 3}, {"url": "https://www.kaggle.com/christopheiv/winemagdata130k", "anchor_text": "Kaggle user", "paragraph_index": 3}, {"url": "https://stats.stackexchange.com/questions/331745/how-to-interpret-t-sne-plot", "anchor_text": "tricky", "paragraph_index": 26}], "all_paragraphs": ["A lot has been written and said about the art and science of blind tasting wine. The ability to identify a glass of wine in front of you correctly is a source of pride for the world\u2019s best sommeliers. The Somm series of documentaries shone a light on the amazing skill involved with this. Through rounds of targeted questioning using a structure called \u2018the grid\u2019, sommeliers are able to identify the grape variety/blend, the region and sometimes even the vintage associated with a glass of wine.", "In this article, we will explore blind tasting through a different perspective by using data science techniques. Can we train an algorithm to blind taste? Can we build our very own RoboSomm?", "For a more detail, see the more elaborate GitHub repository and associated Jupyter Notebook.", "RoboSomm is going to have to learn from examples. To this effect, we have used 170,000 unique wine reviews scraped from https://www.winemag.com/ by a friendly Kaggle user. These wine reviews are descriptions like the following:", "Both on the nose and palate, this Garnacha is mildly angular and pinching, with a sense of rawness brought on by hard tannins. Its foxy plum flavors are jumpy and nervy, finishing peppery and jagged.", "We will need to modify our examples to make sure they don\u2019t contain any information that couldn\u2019t be derived through the senses when blind tasting. After all, when we are trying to blind taste we wouldn\u2019t already know that the wine we are trying to identify is a Garnacha! In addition to removing any \u2018unknowable\u2019 information, we have removed any terms that are non-informative, and have gone through a couple of text normalization steps to standardize our text. From the description above, we can obtain the following descriptors:", "The world\u2019s best sommeliers can derive the variety, region and vintage of a wine when they are blind tasting. This may be a little too ambitious for the first generation of RoboSomm. To limit the scope of the exercise, we will start by seeing if we can train a model to predict the most common grape varieties in our dataset. For simplicity, we will also remove blends. The grape varieties we have left are:", "To familiarize ourselves with these grape varieties, we can build word clouds based on the descriptors that are most frequently associated with each:", "When a word appears more frequently, it will be larger in our word clouds. We can see that many of the descriptors appear for almost every grape variety \u2014 fruit and tannins, for instance. We might argue from the above that generally speaking, Syrah wines are more tannic than Grenache wines. Despite some words appearing in several word clouds, we can see that there are notable differences between the grape varieties. Sauvignon Blanc has more significant citrus notes than other wines. Barbera wines are comparatively heavy on spice. For Chardonnay, toast and apple come to mind.", "With our raw text converted to descriptors, we are almost ready to start building models. First, we need to convert the text-based descriptors into numerical features. We will use a simple method called one-hot-encoding to produce a matrix of 1\u2019s and 0\u2019s to highlight whether each descriptor is present for a given observation.", "In addition, we should take a moment to consider how we will evaluate the performance of our models. We would like RoboSomm to identify a wine in front of it with high precision. When it makes a prediction, that prediction needs to be accurate. We are less interested in retrieving all examples of a specific grape variety. In addition, it would be nice if our model is able to identify many different grape varieties with high precision \u2014 not just the most common ones in our dataset. As such, the key performance metric we will look to is the average precision across all categories (not weighted by the number of observations).", "The final piece of housekeeping we should address before we get into our models is how we have defined a training and test set \u2014 the training set is used to train our model, and the test set is used to evaluate its performance. Our training set is 80% of our dataset, and the test set constitutes the remaining 20% of the data.", "When sommeliers go through a formal blind tasting, they use a structure called \u2018the grid\u2019. The grid is a memorized table of attributes. In the world of data science, we could think of this as being similar to a decision tree. Rounds of successive questions provide a neat structure that helps somms classify the wine in front of them.", "Our decision tree model only achieves a low average precision on our test set (28%). However, the decision tree can show us what successive trail of questioning can most effectively allow us to distinguish between grape varieties. Let us visualize the first few layers of the tree (the actual decision tree is much deeper) to see what we can learn.", "The visualization exercise reveals that some wines are highly distinctive. Sauvignon Blanc, for instance, appears to be a very safe bet if there is a bell pepper taste/aroma and an absence of lychee. Despite the higher number of red vs. white grape varieties in our dataset (13 vs. 7), we can see that some Nebbiolo (balsamic) and Gamay (banana) wines have fairly unique flavor profiles. There is no guarantee that all Sauvignon Blanc, Nebbiolo and Gamay wines have the characteristics listed out above, but if the characteristics are present, this is a good indicator of what prediction to make.", "A decision tree is a fairly simplistic classification algorithm. There are other algorithms that are more sophisticated that may yield higher performance. For this exercise, we have explored multiple options, but found that Multinomial Naive Bayes (MNB) and Random Forests Classifiers are the algorithms that yield the highest average precision for our test set.", "To benefit from the relative strengths of these algorithms, we can go a step further and combine the predictions returned by each using something called a Voting Classifier. The Voting Classifier will run both of the algorithms, and weights the predictions returned by each to come up with a single prediction.", "Our Voting Classifier succeeds in bringing the unweighted average precision to 51%. That seems a lot more\u2026 palatable. Now that we have a classifier with better performance, let us take a deeper look at the predictions that are being returned. Are there specific grape varieties that are just harder to predict than others?", "It appears that some are indeed easier to predict with high precision. Gew\u00fcrztraminer, Gr\u00fcner Veltliner, Pinot Gris and Sauvignon (conveniently all white wines) can be predicted with levels of precision around 75%. This is likely also a product of the fact that we only have 7 white grape varieties in our dataset. Among the reds, we are getting relatively good precision for Nebbiolo and Zinfandel.", "Despite our encouraging results, some grape varieties seem to be very hard to predict. Cabernet Franc and Viognier are never returned as predictions for our test set. Let us dive a little deeper into this. Why might this be the case?", "To study the performance of our model in more detail, we will build a confusion matrix. A confusion matrix is a grid that shows the number of correct and incorrect predictions, summarized with count values.", "Our confusion matrix can help us tell stories about the predictions that are being returned. For instance, we can see that 1,232 Pinot Noir wines in our test set were predicted correctly. We can also see that Cabernet Franc wines are consistently predicted as either Pinot Noir, Cabernet Sauvignon, or sometimes Syrah. Viognier wines are consistently predicted as being Chardonnay or Riesling.", "We can identify two possible reasons (among many!) why this might be the case:", "In an attempt to build a more comprehensive model, an alternative approach to engineering features was also explored. Instead of having a matrix of 0\u2019s and 1\u2019s indicating the absence or presence of a descriptor in a description, we can choose to represent each descriptor with an embedding.", "A word embedding is a way of representing a word as a vector. By going through the process outlined in the image on the right, we can produce a single embedding for every wine description. You will note that only single words have been extracted from the raw text instead of phrases \u2014 for more details on this, you can visit the code in the Jupyter Notebook referenced above.", "Unfortunately, this approach did not yield better results than our \u2018simple\u2019 approach with 0\u2019s and 1\u2019s. However, we can also use the method of creating average word embeddings to construct an average vector for all the descriptions of a given grape variety. By then compressing this vector into two dimensions using a technique called T-SNE, we can build a visualization that can tell us how similar the descriptions for our various grape varieties are.", "Although interpreting the space in T-SNE visualizations can be tricky, there are some lessons to be learned here. We can see that white wines occupy one area in our plot, while red wines are all located towards the bottom. Lighter reds such as Grenache, Pinot Noir and Gamay are located in the same part of the plot, with heavier, more tannic reds such as Syrah, Malbec and Tempranillo also in close vicinity to one another. Cabernet Franc, one of the wines that was often misclassified as Pinot Noir or Cabernet Sauvignon, indeed lies between these two grape varieties.", "For the white wines, we can see that sweeter grape varieties such as Gew\u00fcrztraminer and Riesling lie relatively close to one another, while drier varieties such as Pinot Gris and Sauvignon Blanc occupy a different area in the plot. It is somewhat surprising that Viognier and Chardonnay are so far apart. Both of these wines are known as full-bodied whites and we know that Viogniers have consistently been misclassified as Chardonnays. This may be due to the fact that we cannot wholly capture the similarity between these grape varieties in a simple, 2-dimensional plot.", "Overall, there is still much work to do before we can build a RoboSomm that can reliably identify wines in a blind tasting. Nevertheless, we have learned a lot in this exploratory exercise. We have looked at ways to convert text-based wine descriptions into a set of descriptors, and have studied the differences between 20 popular grape varieties. We have built a few preliminary models to predict grape variety. With there still being enough room for improvement, we may continue by investigating things such as:", "As a parting thought, let us borrow some words of wisdom from the great sommelier Fred Dame. In life, and in data science\u2026", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F4c5beb505a7b&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frobosomm-chapter-1-predicting-grape-varieties-4c5beb505a7b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frobosomm-chapter-1-predicting-grape-varieties-4c5beb505a7b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frobosomm-chapter-1-predicting-grape-varieties-4c5beb505a7b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frobosomm-chapter-1-predicting-grape-varieties-4c5beb505a7b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----4c5beb505a7b--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----4c5beb505a7b--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://roald-schuring.medium.com/?source=post_page-----4c5beb505a7b--------------------------------", "anchor_text": ""}, {"url": "https://roald-schuring.medium.com/?source=post_page-----4c5beb505a7b--------------------------------", "anchor_text": "Roald Schuring"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Feb7a017fe77d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frobosomm-chapter-1-predicting-grape-varieties-4c5beb505a7b&user=Roald+Schuring&userId=eb7a017fe77d&source=post_page-eb7a017fe77d----4c5beb505a7b---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F4c5beb505a7b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frobosomm-chapter-1-predicting-grape-varieties-4c5beb505a7b&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F4c5beb505a7b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frobosomm-chapter-1-predicting-grape-varieties-4c5beb505a7b&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://github.com/RoaldSchuring/Wine-Blind-Tasting-Algorithm", "anchor_text": "GitHub repository"}, {"url": "https://github.com/RoaldSchuring/Wine-Blind-Tasting-Algorithm/blob/master/predicting_grape_varieties.ipynb", "anchor_text": "Jupyter Notebook"}, {"url": "https://www.winemag.com/", "anchor_text": "https://www.winemag.com/"}, {"url": "https://www.kaggle.com/christopheiv/winemagdata130k", "anchor_text": "Kaggle user"}, {"url": "https://stats.stackexchange.com/questions/331745/how-to-interpret-t-sne-plot", "anchor_text": "tricky"}, {"url": "https://medium.com/tag/wine?source=post_page-----4c5beb505a7b---------------wine-----------------", "anchor_text": "Wine"}, {"url": "https://medium.com/tag/data-science?source=post_page-----4c5beb505a7b---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/sommelier?source=post_page-----4c5beb505a7b---------------sommelier-----------------", "anchor_text": "Sommelier"}, {"url": "https://medium.com/tag/blind-tasting?source=post_page-----4c5beb505a7b---------------blind_tasting-----------------", "anchor_text": "Blind Tasting"}, {"url": "https://medium.com/tag/robosomm?source=post_page-----4c5beb505a7b---------------robosomm-----------------", "anchor_text": "Robosomm"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F4c5beb505a7b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frobosomm-chapter-1-predicting-grape-varieties-4c5beb505a7b&user=Roald+Schuring&userId=eb7a017fe77d&source=-----4c5beb505a7b---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F4c5beb505a7b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frobosomm-chapter-1-predicting-grape-varieties-4c5beb505a7b&user=Roald+Schuring&userId=eb7a017fe77d&source=-----4c5beb505a7b---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F4c5beb505a7b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frobosomm-chapter-1-predicting-grape-varieties-4c5beb505a7b&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----4c5beb505a7b--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F4c5beb505a7b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frobosomm-chapter-1-predicting-grape-varieties-4c5beb505a7b&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----4c5beb505a7b---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----4c5beb505a7b--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----4c5beb505a7b--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----4c5beb505a7b--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----4c5beb505a7b--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----4c5beb505a7b--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----4c5beb505a7b--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----4c5beb505a7b--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----4c5beb505a7b--------------------------------", "anchor_text": ""}, {"url": "https://roald-schuring.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://roald-schuring.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Roald Schuring"}, {"url": "https://roald-schuring.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "81 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Feb7a017fe77d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frobosomm-chapter-1-predicting-grape-varieties-4c5beb505a7b&user=Roald+Schuring&userId=eb7a017fe77d&source=post_page-eb7a017fe77d--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F853df658d335&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frobosomm-chapter-1-predicting-grape-varieties-4c5beb505a7b&newsletterV3=eb7a017fe77d&newsletterV3Id=853df658d335&user=Roald+Schuring&userId=eb7a017fe77d&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}