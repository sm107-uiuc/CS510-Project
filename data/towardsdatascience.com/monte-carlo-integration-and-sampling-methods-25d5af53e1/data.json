{"url": "https://towardsdatascience.com/monte-carlo-integration-and-sampling-methods-25d5af53e1", "time": 1683011563.697876, "path": "towardsdatascience.com/monte-carlo-integration-and-sampling-methods-25d5af53e1/", "webpage": {"metadata": {"title": "Monte Carlo Integration and Sampling Methods | by Mengsay Loem | Towards Data Science", "h1": "Monte Carlo Integration and Sampling Methods", "description": "Integration is a critical calculation used frequently in problem solving. With a probability task, an expectation value of a continuous random variable x is defined by the following integration where\u2026"}, "outgoing_paragraph_urls": [], "all_paragraphs": ["Integration is a critical calculation used frequently in problem solving. With a probability task, an expectation value of a continuous random variable x is defined by the following integration where p(x) is a probability density function of x.", "However, to calculate this value is not an easy process with a computer. To effectively define this integration, numerical approximation methods are used. Here, I will introduce a simple approximation method, Monte Carlo Integration", "Monte Carlo Integration is a numerical integration calculation method that uses random numbers to approximate the integration value. Consider the following calculation of the expectation value of f(x). Here, p(x) is a probability density function of x.", "In this method, we choose n samples {x_i} (i=1,2,\u2026,n) independent and identically distributed (i.i.d) from the probability identity function p(x). The integration value is approximated by the mean of f(x) for all sample x.", "From the law of large numbers, a limitation of the Monte Carlo integration when n \u2192\u221e converges to the expectation value of f(x).", "Let\u2019s calculate an approximate value of \u03c0 with the Monte Carlo integration method. Consider a square with side-length 1 and a unit circle as shown in the following figure.", "The area of the circle is \u03c0. Now let f(x,y) be a function which outputs 1 when (x,y) lies inside the circle, and otherwise 0. Let p(x,y) be a uniform distribution on [-1,1]\u00b2. In this case, the area of the unit circle \u03c0 can be written as", "With Monte Carlo integration, this integration (\u03c0) can be approximate by using i.i.d samples from p(x,y). n_(in circle) is the number of samples that lie in the unit circle.", "The following figure shows the convergence of Monte Carlo integration when n is large enough.", "With the Monte Carlo integration, we can simply compute the integration value with random numbers. However, the problem is \u201chow to generate random numbers?\u201d Of course, if the probability distribution is a well-known one, uniform distribution, Gaussian distribution, for example, we can easily implement the random number generator with some library. What if we have to generate random numbers from a distribution density function that is not implemented in any library? To solve this problem, sampling methods are used.", "A frequently used method is Importance Sampling. In this method, a proxy distribution is introduced to sample random numbers from any distribution. In most cases, we choose a well-known distribution such as Gaussian distribution, uniform distribution as a proxy distribution. The main concept of this method can be simply written in the following form, where q(x) is a proxy distribution.", "With Importance Sampling, instead of generating random numbers from p(x), we choose i.i.d samples {x\u2019_i} (i=1,2,\u2026,n) from a proxy distribution q(x) and approximate the integration value with the following calculation. Here, p(x)/q(x) is called importance of the sampling.", "Now, let\u2019s use a Laplace distribution\u2019 variance calculation as an example. Consider f(x)=x\u00b2 and a probability density function p(x)=1/2 Exp(-|x|). The distribution with density function like p(x) is called Laplace distribution. If we choose a uniform distribution as a proxy distribution, the variance of the Laplace distribution can be approximately calculated by", "With paper and a pencil, we can easily calculate the Var[x]. The value of this calculation is 2. Now, let\u2019s confirm the result of the Importance Sampling method.", "In Importance Sampling, we use random numbers (samples) generated from a proxy distribution to approximate the integration value. To directly generated samples from a distribution with any probability density function, I introduce the following sampling method.", "In Inverse Transform Sampling method, we use a random number u generated from a 1-dimensional uniform distribution to generate a random number x of any 1-dimensional probability density function p(x). In this case, we use the inverse function of the cumulative distribution function of p(x). If the cumulative distribution function of p(x) is P(x), then the inverse function of u=P(x) is x =P^-1 (u). Now, x = P^-1 (u) has p(x) as probability density function on [0,1]. Therefore, with n samples from uniform distribution on [0,1] {u_i} (i=1,2,\u2026,n), we can generate n sample of p(x) distribution {x_i} (i=1,2,\u2026,n) by calculate x_i = P^-1(u_i).", "Again, let's consider the Laplace distribution\u2019s variance calculation as an example. This time we directly generate random numbers (samples) from the Laplace distribution\u2019s probability density function using the Inverse Transform Sampling method. With these random numbers, we will again recalculate the approximated value of Var[x].", "Let\u2019s check the result of this method.", "The following figure shows the approximated value of Laplace distribution variance V[x] using Inverse Transform Sampling method.", "From this result, it is straight forward that using directly generated random numbers from a distribution offers a better approximation compared to a case of proxy distribution. However, with the Inverse Transform Sampling method, it is impossible to directly generate random numbers from only 2 or higher dimension distribution. To do this, Rejection Sampling method is used.", "The idea in Rejection Sampling is to use a proxy distribution (Gaussian or uniform distribution, etc.) called q(x) to generate a random number and use another uniform distribution to evaluate the generated sample whether or not to accept it as a sample generated from p(x). With this method, we can also generate random numbers from a higher dimensional distribution.", "As preparation in generating random numbers with this method, we need to know a finite value of L where max[p(x)/q(x)] < L. Here, q(x) is a proxy distribution.", "The algorithm in generating n random numbers with Rejection Sampling is", "Result on random number generating and Laplace distribution variance calculation (Proxy distribution: Gaussian distribution)", "In the Rejection sampling method, it is impossible to generate random numbers when the upper boundary L is not known. MCMC method is an effective solution to this problem. MCMC method uses the concept of a stochastic process (Markov chain in this case). In this case, the generation of i-th sample x_i depends on the previous sample x_(i-1). x1, x2, \u2026,xn with this concept is called a Markov chain. Here, I introduce one of the MCMC methods, the Metropolis-Hastings method.", "The process in this method is similar to Rejection sampling. But here, a proxy distribution density function is represented by a conditional probability q(x|x_i), and the evaluation index v is generated from a uniform distribution on [0,1].", "The algorithm in generating n random numbers with Rejection Sampling is", "Result on random number generating and Laplace distribution variance calculation (Proxy distribution: Gaussian distribution)", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Master's Student @ Tokyo Tech | Dept. of Computer Science"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F25d5af53e1&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmonte-carlo-integration-and-sampling-methods-25d5af53e1&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmonte-carlo-integration-and-sampling-methods-25d5af53e1&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmonte-carlo-integration-and-sampling-methods-25d5af53e1&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmonte-carlo-integration-and-sampling-methods-25d5af53e1&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----25d5af53e1--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----25d5af53e1--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@mengsaylms?source=post_page-----25d5af53e1--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@mengsaylms?source=post_page-----25d5af53e1--------------------------------", "anchor_text": "Mengsay Loem"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fde1bfda96132&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmonte-carlo-integration-and-sampling-methods-25d5af53e1&user=Mengsay+Loem&userId=de1bfda96132&source=post_page-de1bfda96132----25d5af53e1---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F25d5af53e1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmonte-carlo-integration-and-sampling-methods-25d5af53e1&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F25d5af53e1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmonte-carlo-integration-and-sampling-methods-25d5af53e1&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://medium.com/tag/monte-carlo-method?source=post_page-----25d5af53e1---------------monte_carlo_method-----------------", "anchor_text": "Monte Carlo Method"}, {"url": "https://medium.com/tag/random-number-generator?source=post_page-----25d5af53e1---------------random_number_generator-----------------", "anchor_text": "Random Number Generator"}, {"url": "https://medium.com/tag/importance-sampling?source=post_page-----25d5af53e1---------------importance_sampling-----------------", "anchor_text": "Importance Sampling"}, {"url": "https://medium.com/tag/reversetransformsampling?source=post_page-----25d5af53e1---------------reversetransformsampling-----------------", "anchor_text": "Reversetransformsampling"}, {"url": "https://medium.com/tag/rejection-sampling?source=post_page-----25d5af53e1---------------rejection_sampling-----------------", "anchor_text": "Rejection Sampling"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F25d5af53e1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmonte-carlo-integration-and-sampling-methods-25d5af53e1&user=Mengsay+Loem&userId=de1bfda96132&source=-----25d5af53e1---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F25d5af53e1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmonte-carlo-integration-and-sampling-methods-25d5af53e1&user=Mengsay+Loem&userId=de1bfda96132&source=-----25d5af53e1---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F25d5af53e1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmonte-carlo-integration-and-sampling-methods-25d5af53e1&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----25d5af53e1--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F25d5af53e1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmonte-carlo-integration-and-sampling-methods-25d5af53e1&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----25d5af53e1---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----25d5af53e1--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----25d5af53e1--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----25d5af53e1--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----25d5af53e1--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----25d5af53e1--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----25d5af53e1--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----25d5af53e1--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----25d5af53e1--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@mengsaylms?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@mengsaylms?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Mengsay Loem"}, {"url": "https://medium.com/@mengsaylms/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "71 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fde1bfda96132&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmonte-carlo-integration-and-sampling-methods-25d5af53e1&user=Mengsay+Loem&userId=de1bfda96132&source=post_page-de1bfda96132--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F48022e86df09&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmonte-carlo-integration-and-sampling-methods-25d5af53e1&newsletterV3=de1bfda96132&newsletterV3Id=48022e86df09&user=Mengsay+Loem&userId=de1bfda96132&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}