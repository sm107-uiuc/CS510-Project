{"url": "https://towardsdatascience.com/get-a-grip-when-to-add-covariates-in-a-linear-regression-f6a5a47930e5", "time": 1683004781.5866802, "path": "towardsdatascience.com/get-a-grip-when-to-add-covariates-in-a-linear-regression-f6a5a47930e5/", "webpage": {"metadata": {"title": "Get a Grip! When to Add Covariates in a Linear Regression | by Dan VanLunen (DVL) | Towards Data Science", "h1": "Get a Grip! When to Add Covariates in a Linear Regression", "description": "Linear regression models make it easy to measure the effect of a treatment holding other variables (covariates) fixed. But when and why should covariates be included? First, we\u2019ll talk about\u2026"}, "outgoing_paragraph_urls": [{"url": "https://stats.stackexchange.com/questions/16381/what-is-a-complete-list-of-the-usual-assumptions-for-linear-regression/400600#400600", "anchor_text": "Extension: check my stats stackexhange post to see what mathematical assumptions are required for unbiased coefficients", "paragraph_index": 20}, {"url": "https://stats.stackexchange.com/questions/16381/what-is-a-complete-list-of-the-usual-assumptions-for-linear-regression/400600#400600", "anchor_text": "see my stats stackexchange post for all assumptions and implications", "paragraph_index": 36}], "all_paragraphs": ["Linear regression models make it easy to measure the effect of a treatment holding other variables (covariates) fixed. But when and why should covariates be included?", "This post will answer that question.", "First, we\u2019ll talk about covariates in the context of prediction: add them when they improve out of sample fit.", "Then, we\u2019ll discuss when you should use covariates to measure a causal effect and when you shouldn\u2019t:", "If you are not influencing the value of any of the variables in the regression, you might only care about prediction. For example, if you were looking to sell an apartment, you might want to predict the sale price. You could train a regression on the sale price of other apartments including covariates like the number of bedrooms. In this case, you probably only care about getting a good prediction of the sale price. You likely are not looking to evaluate if you added another bedroom, how much more could you sell for (which, by contrast would be a causal problem).", "To decide whether or not a covariate should be added to a regression in a prediction context, simply separate your data into a training set and a test set. Train the model with the covariate and without using the training data. Whichever model does a better job predicting in the test data should be used.", "Adding covariates reduces the bias in your predictions, but increases the variance. Out of sample fit is the judge of this tradeoff. If you have many variables, techniques like L1 regularization can help determine which to include. You might also consider more complicated black box models because you are not concerned with interpretability.", "Things get more complicated when you are trying to measure a causal effect.", "Regressions are interpretable. It is easy to identify how the change of a variable in a regression is associated with a change in the outcome through the coefficients of the regression. For example, if you own a lot of dog grooming salons, you might consider whether or not you want to give dogs bandanas as they leave so they look cute.", "You want to know if giving bandanas will increase revenue so you run a regression:", "Where gives_bandanas is a 0, 1 indicator variable whether or not the salon gives bandanas. \\beta_1 will exactly tell you the impact on revenue that is associated with giving bandanas.", "The reasons for adding or not adding controls to a regression generally fall into two categories:", "There are 3 main cases where adding a covariate to your regression can make or break your resulting treatment effect estimate.", "Add Confounders that Could Bias the EstimateConfounders can make your treatment effect estimates incorrect if you don\u2019t account for them. A confounder is something that influences the value of both the treatment and the outcome.", "For example, let\u2019s say customers in fancy neighborhoods are more inclined to request bandanas. Fancy neighborhoods also tend to have people that spend more money on dog grooming. Thus, fanciness influences both the treatment (whether or not the salon gives bandanas) and the outcome (revenue) and is a confounder.", "Now let\u2019s see what would happen if we don\u2019t control for fanciness.", "The true effect of gives_bandanas is a $10000 increase to revenue, but we measured a much larger effect. In fact, the true effect doesn\u2019t even fall in our model\u2019s 95% confidence interval for the effect.", "But what if we add fanciness to the regression?", "Now we have an accurate measurement of the effect!", "A good way for checking for such confounds is running the regression with and without them. If the coefficient of interest (eg on gives_bandanas) changes a lot, it\u2019s a sign that bias is present.", "Extension: check my stats stackexhange post to see what mathematical assumptions are required for unbiased coefficients. The key assumption is strict exogeneity (similar to no correlation between the variable of interest like gives_bandanas and other variables that are not controlled for in the regression, but that also impact the outcome).", "Though controlling for confounds is helpful, controlling for downstream outcomes or colliders can distort our estimated treatment effect.", "If we add variables that are caused by our treatment and influence the outcome, we will remove the effect our treatment has on the outcome through the added variable. For example, let\u2019s imagine a case where giving dogs bandanas causes customers to be more likely to come back to the salon and that revenue is influenced by how many customers return.", "Let\u2019s see how the effect of giving bandanas is lost when we add the return rate as a covariate.", "Let\u2019s see how running the regression works here:", "We get an estimated effect that is very close to the true +100 effect when we don\u2019t include the downstream variable.", "But what if we do include it:", "Adding the return_rate to the regression eliminates the effect of giving bandanas. This is because holding return_rate fixed, giving bandanas doesn\u2019t actually have an impact. But we are still interested in the effect of giving bandanas (even if through other variables) so we shouldn\u2019t control for downstream effects.", "We don\u2019t only need to worry about adding downstream effects, we also need to worry about adding colliders.", "A collider is a variable that is influenced by both the treatment and the outcome. Adding a collider to a regression can distort the measured association between the treatment and outcome. For example, whether a salon as a storage closet or not. If your salon gives bandanas, you likely need a closet to store them in and therefore giving bandanas influences whether or not there is a storage closet. Also, salons that have a lot of revenue likely see more customers who leave things behind and thus those salons need a place to store lost and found items. Let\u2019s consider an example where bandanas don\u2019t have any impact on revenue, but where an association can be found if we accidentally control for this collider.", "The regression works fine without a collider.", "We don\u2019t measure any effect of giving bandanas then the collider is not included. This a good thing because bandanas have no effect of revenue in this case. But what happens when we add the collider?", "Now we measure a significant negative association between giving bandanas and revenue that does not actually exist. This is because of the \u201cholding fixed\u201d interpretation of a regression. For a given value of storage, revenue is negatively associated with giving bandanas.", "Knowing whether or not to add covariates to accurately measure an effect is most important, but it is also important to know when a covariate could increase the precision of your estimates.", "Covariates can increase the precision with which you estimate a particular coefficient if they are predictive of the outcome and not highly correlated with the variable whose coefficient you are trying to estimate.", "This result may seem counter intuitive: isn\u2019t adding covariates supposed to increase variance and therefore reduce precision? That\u2019s true in terms of the predictions of the outcome, but not the estimates of the coefficients in the regression.", "If we meet some standard assumptions of ordinary least squares (the relationship between our outcome and covariates is linear, the units are not impacting each other, there is no correlation between the treatment and other covariates that impact the outcome, homoskedasticty \u2014 see my stats stackexchange post for all assumptions and implications) the variance of the OLS estimate of the coefficient on the treatment is:", "The sum in the denominator refers to how much variance there is in the application of our treatment (giving bandanas). This is not related to what covariates we add.", "\\sigma\u00b2 is the error variance of the regression. The better we are at making predictions of the outcome with the regression, the lower this value will be. Therefore, if we add covariates that are highly predictive of the outcome \\sigma\u00b2 will decrease and we will have more precision.", "However, R\u00b2_{gives_bandanas} represents the R\u00b2 if we ran a regression with gives_bandanas as the outcome and all the other covariates as explanatory variables. This means that if we add covariates that are highly correlated with the treatment our estimate of the coefficient on the treatment will have a higher variance. This speaks to the fact that you should not add variables that are highly correlated with the treatment, unless they are confounders that are also highly correlated to the outcome.", "Let\u2019s illustrate. Suppose giving bandanas is not correlated with the number of dogs where the salon is, but salon revenue is (adding number of dogs to the regression will increase precision). Also, suppose that whether or not the salon gets ads from local bandana suppliers influences whether or not the salon gives bandanas, but does not affect the salons revenue directly (adding whether the salon received ads will reduce precision).", "Let\u2019s start with a regression using just treatment.", "We measure an accurate effect fairly close to the true impact of 5.", "Now let\u2019s add the predictive covariate.", "Now we measure an effect more precisely! The coefficient on gives_bandanas is much closer to 5 with a lower standard error.", "But what if we had added a non-predictor that was correlated with treatment instead?", "Now we have less precision and are further away from the true effect of 5.", "To summarize, please reference the chart below. If you would like to learn more about measuring effects through experiments check out my other posts:", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Science Manager \u2014 Causal Inference, Prediction, Data Engineering"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Ff6a5a47930e5&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fget-a-grip-when-to-add-covariates-in-a-linear-regression-f6a5a47930e5&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fget-a-grip-when-to-add-covariates-in-a-linear-regression-f6a5a47930e5&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fget-a-grip-when-to-add-covariates-in-a-linear-regression-f6a5a47930e5&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fget-a-grip-when-to-add-covariates-in-a-linear-regression-f6a5a47930e5&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----f6a5a47930e5--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----f6a5a47930e5--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@dvl-data?source=post_page-----f6a5a47930e5--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@dvl-data?source=post_page-----f6a5a47930e5--------------------------------", "anchor_text": "Dan VanLunen (DVL)"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F534d9d75f626&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fget-a-grip-when-to-add-covariates-in-a-linear-regression-f6a5a47930e5&user=Dan+VanLunen+%28DVL%29&userId=534d9d75f626&source=post_page-534d9d75f626----f6a5a47930e5---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ff6a5a47930e5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fget-a-grip-when-to-add-covariates-in-a-linear-regression-f6a5a47930e5&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ff6a5a47930e5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fget-a-grip-when-to-add-covariates-in-a-linear-regression-f6a5a47930e5&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://pixabay.com/photos/mixer-dj-controller-buttons-4197733/", "anchor_text": "Image via Pixabay"}, {"url": "https://stats.stackexchange.com/questions/16381/what-is-a-complete-list-of-the-usual-assumptions-for-linear-regression/400600#400600", "anchor_text": "Extension: check my stats stackexhange post to see what mathematical assumptions are required for unbiased coefficients"}, {"url": "https://stats.stackexchange.com/questions/16381/what-is-a-complete-list-of-the-usual-assumptions-for-linear-regression/400600#400600", "anchor_text": "see my stats stackexchange post for all assumptions and implications"}, {"url": "https://towardsdatascience.com/practical-experiment-fundamentals-all-data-scientists-should-know-f11c77fea1b2", "anchor_text": "Practical Experiment Fundamentals All Data Scientists Should Know"}, {"url": "https://towardsdatascience.com/an-experiment-assignment-method-all-data-scientists-should-know-e4d57d96b26b", "anchor_text": "An Experiment Assignment Method All Data Scientists Should Know"}, {"url": "https://medium.com/tag/r?source=post_page-----f6a5a47930e5---------------r-----------------", "anchor_text": "R"}, {"url": "https://medium.com/tag/data-science?source=post_page-----f6a5a47930e5---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/linear-regression?source=post_page-----f6a5a47930e5---------------linear_regression-----------------", "anchor_text": "Linear Regression"}, {"url": "https://medium.com/tag/bias?source=post_page-----f6a5a47930e5---------------bias-----------------", "anchor_text": "Bias"}, {"url": "https://medium.com/tag/precision?source=post_page-----f6a5a47930e5---------------precision-----------------", "anchor_text": "Precision"}, {"url": "http://creativecommons.org/licenses/by/4.0/", "anchor_text": "Some rights reserved"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Ff6a5a47930e5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fget-a-grip-when-to-add-covariates-in-a-linear-regression-f6a5a47930e5&user=Dan+VanLunen+%28DVL%29&userId=534d9d75f626&source=-----f6a5a47930e5---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Ff6a5a47930e5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fget-a-grip-when-to-add-covariates-in-a-linear-regression-f6a5a47930e5&user=Dan+VanLunen+%28DVL%29&userId=534d9d75f626&source=-----f6a5a47930e5---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ff6a5a47930e5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fget-a-grip-when-to-add-covariates-in-a-linear-regression-f6a5a47930e5&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----f6a5a47930e5--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Ff6a5a47930e5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fget-a-grip-when-to-add-covariates-in-a-linear-regression-f6a5a47930e5&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----f6a5a47930e5---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----f6a5a47930e5--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----f6a5a47930e5--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----f6a5a47930e5--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----f6a5a47930e5--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----f6a5a47930e5--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----f6a5a47930e5--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----f6a5a47930e5--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----f6a5a47930e5--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@dvl-data?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@dvl-data?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Dan VanLunen (DVL)"}, {"url": "https://medium.com/@dvl-data/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "81 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F534d9d75f626&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fget-a-grip-when-to-add-covariates-in-a-linear-regression-f6a5a47930e5&user=Dan+VanLunen+%28DVL%29&userId=534d9d75f626&source=post_page-534d9d75f626--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F8e09e2cd9254&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fget-a-grip-when-to-add-covariates-in-a-linear-regression-f6a5a47930e5&newsletterV3=534d9d75f626&newsletterV3Id=8e09e2cd9254&user=Dan+VanLunen+%28DVL%29&userId=534d9d75f626&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}