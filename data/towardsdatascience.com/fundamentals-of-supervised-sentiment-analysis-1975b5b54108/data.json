{"url": "https://towardsdatascience.com/fundamentals-of-supervised-sentiment-analysis-1975b5b54108", "time": 1683016207.972481, "path": "towardsdatascience.com/fundamentals-of-supervised-sentiment-analysis-1975b5b54108/", "webpage": {"metadata": {"title": "Fundamentals of Supervised Sentiment Analysis | by Eunjoo Byeon | Towards Data Science", "h1": "Fundamentals of Supervised Sentiment Analysis", "description": "In this post, I will explain a few basic machine learning approaches in classifying tweet sentiment and how to run them in Python. Sentiment analysis is used to identify the affect or emotion\u2026"}, "outgoing_paragraph_urls": [{"url": "https://github.com/slundberg/shap", "anchor_text": "SHAP", "paragraph_index": 25}, {"url": "https://github.com/slundberg/shap", "anchor_text": "SHAP", "paragraph_index": 25}, {"url": "https://nlp.stanford.edu/projects/glove/", "anchor_text": "GloVe", "paragraph_index": 29}], "all_paragraphs": ["In this post, I will explain a few basic machine learning approaches in classifying tweet sentiment and how to run them in Python.", "Sentiment analysis is used to identify the affect or emotion (positive, negative, or neutral) of the data. For a business, it is a simple way to determine customers\u2019 reactions towards the product or service and to quickly pick up on any change of emotion that may require immediate attention. The most basic approach to this problem is to use supervised learning. We can have actual humans to determine and label the sentiment of our data and treat it like a text classification problem. This is exactly what I will go over in this post, and will revisit the topic in the later post to discuss unsupervised methods.", "After cleaning the data (removing observations with missing texts, removing \u2018unknown\u2019 class, removing RTs), and splitting our data into train, test, and validation sets, we need to preprocess texts so they are properly quantifiable for our analysis. I will go through them one by one.", "Different encodings can result in some strange characters appearing on our data. So first we will make sure we are only keeping ASCII characters. The below code will filter out all characters that are not ASCII.", "Due to mishaps in encodings, some tweets contain HTML symbols such as &nbsp;. Before we remove punctuations, we will get rid of these words first so we are not left with gibberish after we remove punctuations. Other alphabetical words we want to remove are the name of users (e.g. @stereopickle) and hyperlinks (written as {link} in this dataset). We will use regex to do this.", "This expression means to substitute all words that do not start with the alphanumeric characters with space. These words may or may not end with a non-alphanumeric character.", "This is a step specific to this dataset. Because our dataset contains tweets about products, there\u2019s a lot of references to the actual brand and product names. We don\u2019t want the overall distribution of sentiment per different brands or products to bias our model, so we will remove some of them.", "Another straightforward cleaning. Please note, that I am removing all punctuation here for the sake of simplicity, but in reality, many tweets may use punctuations to express the sentiment, such as :) and :(.", "If you are curious about the above method, please take a look at my other post on how to effectively removing punctuations.", "Finally, we will lemmatize our vocabularies and remove stopwords using NLTK. In summary, lemmatizer will return the vocabularies into its basic form, lemma.", "Read more about lemmatization or stemming here.", "After applying the above functions to our text data, we should have a pretty clean set of words to work with. But I like to add a feature selection step here because NLP problems tend to end up with too many features when each vocabulary or bi-grams or tri-grams are tokenized.", "Of course, there are many ways to purge features, but I like to combine words that are similar using Spacy. The basic idea is to iterate through words that only occur a few times and to find an existing word with high similarity (closer in the vector space).", "This custom function returns a dictionary with low occurring words as keys and their replacements as values. This step often fixes some typos and corrects where lemmatization might have missed. We can use this replacement dictionary to change words to their more frequently occurring counterparts and remove ones that are occurring less than specified times.", "Typically our data will have a high class-imbalance problem as people are more likely to write about neutral or positive tweets than negative tweets in most cases. But for most business problems, our model must detect these negative tweets. So we will keep an eye out for these by looking at the macro-averaged f1-score as well as the precision-recall curve. Below function will plot the ROC curve and precision-recall curve and print the key evaluation metrics.", "We can use a scikit-learn\u2019s DummyClassifier to first see what our baseline measure would be if we were to just classify it based on how frequently each class occurs.", "One of the simplest way to quantify text data is to just count the frequency of each word. The scikit-learn\u2019s CountVectorizer can do that job easily.", "This returns the count vectors of single vocabularies and bigrams that occurs at least twice. Then we can use thes count vectors to train different classification algorithms.", "A problem with the count vector is that it only looks at the frequency of individual word and it does not care about the context in which the word occurs. There\u2019s no way to assess whether how important specific word in a tweet is. This is where the term frequency \u2014 inverse document frequency (TF-IDF) score comes in. TF-IDF score weighs words that are more uniquely frequent in one tweet more than words that tend to be frequent across all tweets.", "Now that we have two vectorized texts, we can test different classifiers for each of these vectors.", "Naive-Bayes is one of the more popular choices for text classification. It\u2019s a simple application of Bayes Theorem on each class and the predictors, and it assumes that each individual features (words in our case) are independent of each other.", "So let\u2019s say, we have a tweet that reads\u2026 \u201cI love my new phone. It\u2019s really fast, reliable and well-designed!\u201d. This tweet clearly has a positive sentiment. In this case, the Naive-Bayes model assumes that the individual words like \u2018love\u2019, \u2018new\u2019, \u2018really\u2019, \u2018fast\u2019, \u2018reliable\u2019, all contribute independently to its positive class. In other words, likelihood of the tweet being positive when it uses the word \u2018reliable\u2019 does not change by other words. This does not mean that these words are independent in their appearances. Some words may tend to appear together more often than not, but that does not mean how much each word contributes to its class is dependent.", "Naive-Bayes algorithm is simple to use and reliable when the above assumption holds. Since testing on our model requires vectorization, we can get the pipeline built into our model.", "Because of its assumption of independence between features, Naive Bayes overestimates confidence of how much each feature contributes to the label, making it a bad estimator. So take the probability of predictions with a grain of salt.", "Another popular choice of the text classification algorithm is the support vector machine (SVM). Simply put, SVM finds the hyperplane that divides the classes with a maximum margin between them. The main reason SVM is preferred in text classification is that we tend to end up with a lot of features. If we were to work in such a high dimensional space that takes all our features, it would have caused a problem known as the curse of dimensionality. Basically, our space is too big that our observations start to lose their meanings. But SVM is more robust when dealing with a large number of features because it uses the kernel trick. SVM does not actually work in the high dimensions, it just looks at the pairwise distances between observations as if they are in the high dimensions. It does take a long time to do the job, but it is robust.", "When the SVM uses the kernel trick, things get into a bit of grey area, in terms of interpretability. But we can use the Shapley value to decipher how individual features are contributing to the classification. We\u2019ll use SHAP\u2019s friendly interface to visualize the Shapley values. For a detailed tutorial on this, I recommend reading the documentation on SHAP.", "Let\u2019s dive a little bit deeper (literally). So far we worked with two different frequency measures to quantify our text data. But the frequency of each word tells only little bit of the story. Understanding language and its meaning requires understanding of syntax, or at the very least, the sequence of words. So we will look at a deep learning architecture that cares about the sequence of vocabularies: the long short-term memory (LSTM) architecture.", "For the LSTM, we need to feed in texts as a sequence. Below steps outline the steps to run and evaluate the LSTM classifier. I explained each step in the code.", "One downside of our LSTM model is that it only contains information that\u2019s present within our training data, while vocabularies have semantic meanings outside of the tweets. Knowing how each vocabulary relates to each other in terms of semantic similarity may help our model. We can apply weights to our vocabularies based on the pre-trained word embedding algorithm.", "For this, we will use GloVe, the vector representations obtained by a team at Stanford. I\u2019m using their 200 dimensions word vectors trained on 2 Billion tweets. You will need to download the vectors from their website.", "Then you can add the obtained vector matrix as embedding weights to the Embedding layer of our LSTM architecture.", "By using the word embedding and LSTM, my model showed 20% increase in overall accuracy and 16% increase in the macro-averaged F1-score.", "We reviewed the fundamentals of building a sentiment analysis model using tweets data. I will end the post with some of the questions to think about and to expand upon.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Scientist | Designer | Programmer | Researcher | Lifelong Learner"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F1975b5b54108&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffundamentals-of-supervised-sentiment-analysis-1975b5b54108&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffundamentals-of-supervised-sentiment-analysis-1975b5b54108&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffundamentals-of-supervised-sentiment-analysis-1975b5b54108&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffundamentals-of-supervised-sentiment-analysis-1975b5b54108&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----1975b5b54108--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----1975b5b54108--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://stereopickle.medium.com/?source=post_page-----1975b5b54108--------------------------------", "anchor_text": ""}, {"url": "https://stereopickle.medium.com/?source=post_page-----1975b5b54108--------------------------------", "anchor_text": "Eunjoo Byeon"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F96add1ec6388&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffundamentals-of-supervised-sentiment-analysis-1975b5b54108&user=Eunjoo+Byeon&userId=96add1ec6388&source=post_page-96add1ec6388----1975b5b54108---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F1975b5b54108&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffundamentals-of-supervised-sentiment-analysis-1975b5b54108&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F1975b5b54108&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffundamentals-of-supervised-sentiment-analysis-1975b5b54108&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@chrisjdavis?utm_source=medium&utm_medium=referral", "anchor_text": "Chris J. Davis"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://data.world/crowdflower/brands-and-product-emotions", "anchor_text": "data.world"}, {"url": "http://cs.stanford.edu/people/alecmgo/trainingandtestdata.zip", "anchor_text": "Sentiment140"}, {"url": "https://towardsdatascience.com/how-to-efficiently-remove-punctuations-from-a-string-899ad4a059fb", "anchor_text": "How to Efficiently Remove Punctuations from a String8 Different Ways to Clean Strings in Pythontowardsdatascience.com"}, {"url": "https://medium.com/swlh/understanding-art-through-art-description-data-part-1-2682e899dfe5", "anchor_text": "Understanding Art Through Art Description DataPreprocessing Art Description Data Using Pythonmedium.com"}, {"url": "https://github.com/slundberg/shap", "anchor_text": "SHAP"}, {"url": "https://github.com/slundberg/shap", "anchor_text": "SHAP"}, {"url": "https://unsplash.com/@freestocks?utm_source=medium&utm_medium=referral", "anchor_text": "freestocks"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://nlp.stanford.edu/projects/glove/", "anchor_text": "GloVe"}, {"url": "https://unsplash.com/@dear_jondog?utm_source=medium&utm_medium=referral", "anchor_text": "Jonathan Daniels"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://medium.com/tag/data-science?source=post_page-----1975b5b54108---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/sentiment-analysis?source=post_page-----1975b5b54108---------------sentiment_analysis-----------------", "anchor_text": "Sentiment Analysis"}, {"url": "https://medium.com/tag/nlp?source=post_page-----1975b5b54108---------------nlp-----------------", "anchor_text": "NLP"}, {"url": "https://medium.com/tag/python?source=post_page-----1975b5b54108---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----1975b5b54108---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F1975b5b54108&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffundamentals-of-supervised-sentiment-analysis-1975b5b54108&user=Eunjoo+Byeon&userId=96add1ec6388&source=-----1975b5b54108---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F1975b5b54108&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffundamentals-of-supervised-sentiment-analysis-1975b5b54108&user=Eunjoo+Byeon&userId=96add1ec6388&source=-----1975b5b54108---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F1975b5b54108&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffundamentals-of-supervised-sentiment-analysis-1975b5b54108&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----1975b5b54108--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F1975b5b54108&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffundamentals-of-supervised-sentiment-analysis-1975b5b54108&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----1975b5b54108---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----1975b5b54108--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----1975b5b54108--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----1975b5b54108--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----1975b5b54108--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----1975b5b54108--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----1975b5b54108--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----1975b5b54108--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----1975b5b54108--------------------------------", "anchor_text": ""}, {"url": "https://stereopickle.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://stereopickle.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Eunjoo Byeon"}, {"url": "https://stereopickle.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "188 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F96add1ec6388&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffundamentals-of-supervised-sentiment-analysis-1975b5b54108&user=Eunjoo+Byeon&userId=96add1ec6388&source=post_page-96add1ec6388--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fda8b33a640fe&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffundamentals-of-supervised-sentiment-analysis-1975b5b54108&newsletterV3=96add1ec6388&newsletterV3Id=da8b33a640fe&user=Eunjoo+Byeon&userId=96add1ec6388&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}