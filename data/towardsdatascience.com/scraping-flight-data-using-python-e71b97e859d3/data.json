{"url": "https://towardsdatascience.com/scraping-flight-data-using-python-e71b97e859d3", "time": 1682995920.7354088, "path": "towardsdatascience.com/scraping-flight-data-using-python-e71b97e859d3/", "webpage": {"metadata": {"title": "Scraping Flight Data Using Python | by Gregor Hesse | Towards Data Science", "h1": "Scraping Flight Data Using Python", "description": "The article explains how to scrape flight data from kayak.com using selenium and BeautifulSoup and how to ultimately visualize the best results in a heatmap."}, "outgoing_paragraph_urls": [{"url": "http://www.kayak.com", "anchor_text": "Kayak", "paragraph_index": 1}, {"url": "http://www.kayak.com", "anchor_text": "Kayak", "paragraph_index": 2}, {"url": "http://chromedriver.chromium.org/downloads", "anchor_text": "ChromeDriver", "paragraph_index": 4}, {"url": "http://www.kayak.com", "anchor_text": "Kayak", "paragraph_index": 7}, {"url": "http://www.kayak.com", "anchor_text": "Kayak", "paragraph_index": 10}], "all_paragraphs": ["Let\u2019s say we want to plan our next weekend trip. Plan is to go either to Milan or Madrid. Point is we really don\u2019t care, we\u2019re just looking for the best option. It\u2019s a bit like the German soccer player Andy M\u00f6ller once said: \u00abMilan or Madrid, as long as it is Italy\u00bb.", "In a first step, we just look for a flight like we would usually do. For this example we use Kayak. Once we\u2019ve entered our search criteria and set a few additional filters like \u00abNonstop\u00bb, we can see that interestingly the URL in our browser has adjusted accordingly", "We can actually dissect this URL into different parts: origin, destination, startdate, endate and a suffix that tells Kayak to look only for direct connections and to sort the results by price.", "Now the general idea is to get the information we want (e.g. price, departure and arrival times) from the underlying html code of the website. To do this, we mainly rely on two packages. The first one is selenium, which basically controls your browser and automatically opens the website. The second one is Beautiful Soup, which helps us to reshape the messy HTML code into a more structured and readable format. From this \u00absoup\u00bb we can later easily get the tasty bites we\u2019re looking for.", "So let\u2019s get started. First we need to set up selenium. For this, we need to download a browser driver, e.g. ChromeDriver (make sure it corresponds to your installed version of Chrome), which we have to put in the same folder as our Python code. Now we load a few packages and tell selenium that we want to use ChromeDriver and let it open our URL from above.", "Once the website has loaded, we need to find out how we can access the information that is relevant for us. Let\u2019s take e.g. the departure time, using the inspect feature of our browser, we can see that the 8:55pm departure time is wrapped in a span with a class called \u00abdepart-time base-time\u00bb.", "If we now pass the website\u2019s html code to BeautifulSoup, we can specifically search for the classes we\u2019re interested in. The results can then be extracted with a simple loop. Since for each search result we get a set of two departure times, we also need to reshape the results into logical departure-arrival time pairs.", "We use a similar approach for the price. However, when inspecting the price element, we can see that Kayak likes to use different classes for its price information. Therefore, we have to use a regular expression in order to capture all cases. Also the price itself is further wrapped up, that\u2019s why we need to use a few additional steps to get to it.", "Now, we put everything into a nice dataframe and get", "And this is pretty much it. We have scraped and put into shape all the information that was tangled up in the html code of our initial flight. The heavy lifting is done.", "To make things a bit more convenient, we can now wrap our code from above into a function and call that function by using different destination and starting day combinations for our three-day journey. When sending several requests, Kayak might think from time to time that we\u2019re a bot (and who can blame them), the best way to take care of this is by constantly changing the browser\u2019s user agent and also by waiting a bit between the requests. Our entire code would then look like this:", "Once we have specified all combinations and scraped the respective data, we can nicely visualize our results using a heatmap from seaborn", "So it\u2019s decided. Next stop: Madrid! For just $108 it is the cheapest option of the three weekends we picked in September. Looking forward to eating some delicious tapas.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data enthusiast interested in SQL, Python, D3.js and Power BI."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fe71b97e859d3&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fscraping-flight-data-using-python-e71b97e859d3&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fscraping-flight-data-using-python-e71b97e859d3&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fscraping-flight-data-using-python-e71b97e859d3&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fscraping-flight-data-using-python-e71b97e859d3&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----e71b97e859d3--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----e71b97e859d3--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@ghesse85?source=post_page-----e71b97e859d3--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@ghesse85?source=post_page-----e71b97e859d3--------------------------------", "anchor_text": "Gregor Hesse"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F9a960a1cc5dd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fscraping-flight-data-using-python-e71b97e859d3&user=Gregor+Hesse&userId=9a960a1cc5dd&source=post_page-9a960a1cc5dd----e71b97e859d3---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe71b97e859d3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fscraping-flight-data-using-python-e71b97e859d3&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe71b97e859d3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fscraping-flight-data-using-python-e71b97e859d3&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "http://www.kayak.com", "anchor_text": "Kayak"}, {"url": "http://www.kayak.com", "anchor_text": "Kayak"}, {"url": "http://chromedriver.chromium.org/downloads", "anchor_text": "ChromeDriver"}, {"url": "http://www.kayak.com", "anchor_text": "Kayak"}, {"url": "http://www.kayak.com", "anchor_text": "Kayak"}, {"url": "https://medium.com/tag/selenium?source=post_page-----e71b97e859d3---------------selenium-----------------", "anchor_text": "Selenium"}, {"url": "https://medium.com/tag/python?source=post_page-----e71b97e859d3---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/scraping?source=post_page-----e71b97e859d3---------------scraping-----------------", "anchor_text": "Scraping"}, {"url": "https://medium.com/tag/flight?source=post_page-----e71b97e859d3---------------flight-----------------", "anchor_text": "Flight"}, {"url": "https://medium.com/tag/data-science?source=post_page-----e71b97e859d3---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fe71b97e859d3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fscraping-flight-data-using-python-e71b97e859d3&user=Gregor+Hesse&userId=9a960a1cc5dd&source=-----e71b97e859d3---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fe71b97e859d3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fscraping-flight-data-using-python-e71b97e859d3&user=Gregor+Hesse&userId=9a960a1cc5dd&source=-----e71b97e859d3---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe71b97e859d3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fscraping-flight-data-using-python-e71b97e859d3&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----e71b97e859d3--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fe71b97e859d3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fscraping-flight-data-using-python-e71b97e859d3&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----e71b97e859d3---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----e71b97e859d3--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----e71b97e859d3--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----e71b97e859d3--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----e71b97e859d3--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----e71b97e859d3--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----e71b97e859d3--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----e71b97e859d3--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----e71b97e859d3--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@ghesse85?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@ghesse85?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Gregor Hesse"}, {"url": "https://medium.com/@ghesse85/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "52 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F9a960a1cc5dd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fscraping-flight-data-using-python-e71b97e859d3&user=Gregor+Hesse&userId=9a960a1cc5dd&source=post_page-9a960a1cc5dd--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fusers%2F9a960a1cc5dd%2Flazily-enable-writer-subscription&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fscraping-flight-data-using-python-e71b97e859d3&user=Gregor+Hesse&userId=9a960a1cc5dd&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}