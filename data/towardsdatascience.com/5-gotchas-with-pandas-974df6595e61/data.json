{"url": "https://towardsdatascience.com/5-gotchas-with-pandas-974df6595e61", "time": 1683002627.5720162, "path": "towardsdatascience.com/5-gotchas-with-pandas-974df6595e61/", "webpage": {"metadata": {"title": "5 Gotchas With Pandas. Doing data analysis with pandas is\u2026 | by Roman Orac | Towards Data Science", "h1": "5 Gotchas With Pandas", "description": "Some of the links above are affiliate links and if you go through them to make a purchase I\u2019ll earn a commission. Keep in mind that I link courses because of their quality and not because of the\u2026"}, "outgoing_paragraph_urls": [{"url": "https://romanorac.github.io/assets/notebooks/2019-12-23-few-gotchas-with-pandas.ipynb", "anchor_text": "Jupyter notebook", "paragraph_index": 0}, {"url": "https://pandas.pydata.org/pandas-docs/stable/user_guide/missing_data.html", "anchor_text": "pandas documentation", "paragraph_index": 36}, {"url": "https://pandas.pydata.org/pandas-docs/stable/user_guide/missing_data.html", "anchor_text": "pandas documentation", "paragraph_index": 41}, {"url": "https://twitter.com/romanorac", "anchor_text": "Twitter", "paragraph_index": 43}, {"url": "https://twitter.com/romanorac/status/1328952374447267843", "anchor_text": "tweet", "paragraph_index": 43}], "all_paragraphs": ["To run the examples download this Jupyter notebook.", "Here are a few links that might interest you:", "Some of the links above are affiliate links and if you go through them to make a purchase I\u2019ll earn a commission. Keep in mind that I link courses because of their quality and not because of the commission I receive from your purchases.", "To Step Up Your Pandas Game, read:", "Let\u2019s say we would like to read multiples files from a folder into a pandas DataFrame. Python has a path library that can list all the files in a certain folder, but I find glob easier to use. glob supports regular expressions, which gives us granular control on which files we would like to read. Note, there is no need to extract zipped files as pandas can unarchive them automatically while reading.", "To specify, which files we would like to read, we use *.gz with glob.", "glob detects the files, but they are not ordered. File with date 2019\u201312\u201310 is before 2019\u201312\u201309 in the list. This is an issue if we are working with time-series data like in this example.", "To get the correct order of time-series data, we have two options (one better than the other):", "Let\u2019s sort files by names to show why it is a bad idea.", "In this example, sorting filenames would work, but we need to be aware that sorting strings is not the same as sorting integers as shown in the example below. This happens because programming languages compare character by character. It is a bad idea to rely on the names of the files for the correct order of the data.", "In the example below, we sort strings and integers, respectively.", "As mentioned above, sorting a DataFrame by a column is a better option, but we need to be careful with the column data type.", "DataFrame has multiple columns and we would like to sort it by timestamp.", "Not so fast! Let\u2019s look at the data type of the timestamp column.", "The timestamp column has an object type. What happens when we sort an object type?", "A pandas object type is used for text or mixed numeric and non-numeric values. To get the correct order of the timestamp column we need to change it to the datetime64 type.", "The timestamp column has datetime64 type and we can proceed with sorting now.", "The describe is the first command I usually run when I\u2019m not familiar with the dataset. I briefly review descriptive statistics like count, min and max values to see if the data was read correctly.", "What I didn\u2019t notice for quite some time was that describe outputs descriptive statistics only for numerical columns. This makes sense because we cannot calculate them with other data types like strings.", "When we output columns we see that there are columns like timestamp, symbol, etc., that are not listed above.", "Luckily describe takes include argument, where we can specify to include all columns. Include argument also takes a list, where we can specify a subset of columns.", "Pandas plot function enables us to swiftly visualize the distribution of a certain column.", "To visualize outliers of a certain column we can use a box plot.", "On the plot above, we can observe that size has many outliers, which makes a box plot uninformative.", "My solution was to clip the bottom and top 1% quantile.", "This makes a box plot more informative, but we need to try different quantiles values and also add a new column in a DataFrame. A question arises, which column should we then use. Is there a better way?", "Plot function takes the ylim parameter, where we can specify boundaries for the y-axis. This makes a box plot more informative and we don\u2019t need a new column in the DataFrame.", "Let\u2019s say we would like to transform a numeric column to a discrete column.", "The most straight forward way is to specify n intervals and bin the data accordingly. pandas has cut function that does just that.", "Let\u2019s bin the price column to 5 discrete values.", "As we would expect, the price_discrete_bins has 5 distinct values, one for each bin.", "The cut function also enables us to specify bin labels. Also see the retbins argument, which outputs both intervals and labels.", "The most straight forward way is not always the best way when doing data analytics (or anything else I suppose \ud83d\ude0a). What I didn\u2019t point out above is that very high value (0.015%) is significantly less represented than other values (all over 15%). This could pose a problem if we intend to train a predictive model on this dataset:", "Is there a way to avoid this problem?", "There is. Let\u2019s bin the price to equal-size bins so that each bin will have the same number of values.", "In pandas, multiple values denote a missing value:", "The reason for this mess is (from pandas documentation): The choice of using NaN internally to denote missing data was largely for simplicity and performance reasons. We are hopeful that NumPy will soon be able to provide a native NA type solution (similar to R) performant enough to be used in pandas.", "What surprised me is that None equals None in Python, but nan doesn\u2019t equal nan in numpy.", "This is important so that we don\u2019t filter values by None:", "What is the reason that numpy nan is not equal to itself? Let\u2019s dive deeper. Some functions return nan when they are non-computable.", "Does this mean that the results of the function should be the same? Clearly not.", "Few important details on missing values behavior taken from pandas documentation:", "These were few gotchas with pandas that you need to be careful about when doing data analysis. Hopefully, you learned something new.", "Follow me on Twitter, where I regularly tweet about Data Science and Machine Learning.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F974df6595e61&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F5-gotchas-with-pandas-974df6595e61&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2F5-gotchas-with-pandas-974df6595e61&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F5-gotchas-with-pandas-974df6595e61&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2F5-gotchas-with-pandas-974df6595e61&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----974df6595e61--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----974df6595e61--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://romanorac.medium.com/?source=post_page-----974df6595e61--------------------------------", "anchor_text": ""}, {"url": "https://romanorac.medium.com/?source=post_page-----974df6595e61--------------------------------", "anchor_text": "Roman Orac"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F68bf0657a0cd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F5-gotchas-with-pandas-974df6595e61&user=Roman+Orac&userId=68bf0657a0cd&source=post_page-68bf0657a0cd----974df6595e61---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F974df6595e61&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F5-gotchas-with-pandas-974df6595e61&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F974df6595e61&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F5-gotchas-with-pandas-974df6595e61&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://imgflip.com/memegenerator", "anchor_text": "ImgFlip"}, {"url": "https://romanorac.github.io/assets/notebooks/2019-12-23-few-gotchas-with-pandas.ipynb", "anchor_text": "Jupyter notebook"}, {"url": "https://www.humanfirst.ai/", "anchor_text": "Labeling and Data Engineering for Conversational AI and Analytics"}, {"url": "https://imp.i115008.net/c/2402645/880006/11298", "anchor_text": "Data Science for Business Leaders"}, {"url": "https://imp.i115008.net/c/2402645/788201/11298", "anchor_text": "Intro to Machine Learning with PyTorch"}, {"url": "https://imp.i115008.net/c/2402645/803127/11298", "anchor_text": "Become a Growth Product Manager"}, {"url": "https://amzn.to/3ncTG7D", "anchor_text": "Deep Learning (Adaptive Computation and ML series)"}, {"url": "https://aigents.co/skills", "anchor_text": "Free skill tests for Data Scientists & Machine Learning Engineers"}, {"url": "https://towardsdatascience.com/pandas-analytics-server-d9abceec888b", "anchor_text": "Pandas analytics serverAn open-source project that simplifies connecting pandas to a realtime data feed, testing hypothesis and visualizing\u2026towardsdatascience.com"}, {"url": "https://me.me/i/dontworry-its-all-gonna-panda-out-dont-worry-its-all-35c9094c786b4a16a4236d032c4fbdc2", "anchor_text": "Meme"}, {"url": "https://www.pinterest.com/pin/792352128176205493/", "anchor_text": "Pinterest"}, {"url": "https://giphy.com/", "anchor_text": "Giphy"}, {"url": "https://giphy.com/gifs/panda-angry-breaking-EPcvhM28ER9XW", "anchor_text": "Giphy"}, {"url": "https://pandas.pydata.org/pandas-docs/stable/user_guide/missing_data.html", "anchor_text": "pandas documentation"}, {"url": "https://pandas.pydata.org/pandas-docs/stable/user_guide/missing_data.html", "anchor_text": "pandas documentation"}, {"url": "https://giphy.com/gifs/panda-critters-TRuV1HrNrNmP6", "anchor_text": "Giphy"}, {"url": "https://twitter.com/romanorac", "anchor_text": "Twitter"}, {"url": "https://twitter.com/romanorac/status/1328952374447267843", "anchor_text": "tweet"}, {"url": "https://unsplash.com/@cmhedger?utm_source=medium&utm_medium=referral", "anchor_text": "Courtney Hedger"}, {"url": "https://unsplash.com/?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://medium.com/tag/data-science?source=post_page-----974df6595e61---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/analytics?source=post_page-----974df6595e61---------------analytics-----------------", "anchor_text": "Analytics"}, {"url": "https://medium.com/tag/pandas?source=post_page-----974df6595e61---------------pandas-----------------", "anchor_text": "Pandas"}, {"url": "https://medium.com/tag/python?source=post_page-----974df6595e61---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/statistics?source=post_page-----974df6595e61---------------statistics-----------------", "anchor_text": "Statistics"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F974df6595e61&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F5-gotchas-with-pandas-974df6595e61&user=Roman+Orac&userId=68bf0657a0cd&source=-----974df6595e61---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F974df6595e61&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F5-gotchas-with-pandas-974df6595e61&user=Roman+Orac&userId=68bf0657a0cd&source=-----974df6595e61---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F974df6595e61&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F5-gotchas-with-pandas-974df6595e61&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----974df6595e61--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F974df6595e61&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F5-gotchas-with-pandas-974df6595e61&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----974df6595e61---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----974df6595e61--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----974df6595e61--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----974df6595e61--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----974df6595e61--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----974df6595e61--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----974df6595e61--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----974df6595e61--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----974df6595e61--------------------------------", "anchor_text": ""}, {"url": "https://romanorac.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://romanorac.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Roman Orac"}, {"url": "https://romanorac.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "7.7K Followers"}, {"url": "https://romanorac.medium.com/membership", "anchor_text": "https://romanorac.medium.com/membership"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F68bf0657a0cd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F5-gotchas-with-pandas-974df6595e61&user=Roman+Orac&userId=68bf0657a0cd&source=post_page-68bf0657a0cd--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fa69c18dd3c04&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F5-gotchas-with-pandas-974df6595e61&newsletterV3=68bf0657a0cd&newsletterV3Id=a69c18dd3c04&user=Roman+Orac&userId=68bf0657a0cd&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}