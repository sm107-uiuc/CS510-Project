{"url": "https://towardsdatascience.com/beyond-weisfeiler-lehman-approximate-isomorphisms-and-metric-embeddings-f7b816b75751", "time": 1683010839.709388, "path": "towardsdatascience.com/beyond-weisfeiler-lehman-approximate-isomorphisms-and-metric-embeddings-f7b816b75751/", "webpage": {"metadata": {"title": "Beyond Weisfeiler-Lehman: approximate isomorphisms and metric embeddings | by Michael Bronstein | Towards Data Science", "h1": "Beyond Weisfeiler-Lehman: approximate isomorphisms and metric embeddings", "description": "Graph isomorphism setting is too limiting for analysing the expressive power of graph neural networks and suggest a broader setting based on metric embeddings"}, "outgoing_paragraph_urls": [{"url": "https://towardsdatascience.com/expressive-power-of-graph-neural-networks-and-the-weisefeiler-lehman-test-b883db3c7c49", "anchor_text": "Part 1", "paragraph_index": 0}, {"url": "https://towardsdatascience.com/beyond-weisfeiler-lehman-using-substructures-for-provably-expressive-graph-neural-networks-d476ad665fa3", "anchor_text": "Part 2", "paragraph_index": 0}, {"url": "https://towardsdatascience.com/expressive-power-of-graph-neural-networks-and-the-weisefeiler-lehman-test-b883db3c7c49", "anchor_text": "as powerful as the 1-WL test", "paragraph_index": 1}, {"url": "https://towardsdatascience.com/beyond-weisfeiler-lehman-using-substructures-for-provably-expressive-graph-neural-networks-d476ad665fa3", "anchor_text": "different approach", "paragraph_index": 2}, {"url": "https://www.iti.zcu.cz/wl2018/pdf/wl_paper_translation.pdf", "anchor_text": "The reduction of a graph to canonical form and the algebra which appears therein", "paragraph_index": 17}, {"url": "https://www.ijcai.org/Proceedings/2018/0325.pdf", "anchor_text": "A property testing framework for the theoretical expressivity of graph kernels", "paragraph_index": 20}, {"url": "https://towardsdatascience.com/graph-deep-learning/home", "anchor_text": "other posts", "paragraph_index": 22}, {"url": "https://twitter.com/mmbronstein", "anchor_text": "Twitter", "paragraph_index": 22}], "all_paragraphs": ["This is the third in the series of posts on the expressivity of graph neural networks. See Part 1 describing the relation between graph neural networks and the Weisfeiler-Lehman graph isomorphism test, and Part 2 showing how to construct provably powerful graph neural networks based on substructure counting.", "Weisfeiler-Lehman (WL) test [1] is a general name for a hierarchy of graph-theoretical polynomial-time iterative algorithms providing a necessary but insufficient condition for graph isomorphism. In the context of deep learning on graphs, it was shown that message passing neural networks are as powerful as the 1-WL test [2]. Going to higher-order and hence more powerful k-WL tests leads to graph neural networks with high computational complexity and non-local operations [3], which are impractical in real applications.", "A different approach, which we introduced in a recent paper [4], is to break from the Weisfeiler-Lehman hierarchy and resort to a message passing mechanism that is aware of local graph structures such as cycles, cliques, and paths. This leads to graph neural networks that have the attractive locality and low-complexity of standard message-passing architectures, at the same time being provably more powerful than 2-WL and at least not less powerful than 3-WL. Such a view opens deep links to open problems in graph theory that have not been previously explored in the context of graph neural network expressivity.", "Is this the end of the story? I believe we can do better by changing the perspective on the problem and will discuss a few directions in this post.", "Approximate isomorphisms. While important insights into the expressive power of graph neural networks have emerged from the link to the graph isomorphism problem, the setting itself is rather limited. Graph neural networks can be seen as attempting to find a graph embedding f(G), with the desired property f(G)=f(G\u2032) iff G~G\u2032. Unfortunately, since the Weisfeiler-Lehman test is a necessary but not sufficient condition for graph isomorphism, this works only one way: f(G)=f(G\u2032) if G~G\u2032, but the converse is not necessarily true: two non-isomorphic graphs can result in equal embeddings.", "In practical applications, we rarely deal with exactly isomorphic graphs but rather graphs that are approximately isomorphic, as shown in the following figure:", "A proper way of quantifying the notion of \u201capproximate isomorphism\u201d is in the form of a metric d, which is large if the two graphs are dissimilar and small otherwise. Graph edit distance [5] or the Gromov-Hausdorff distance [6] are two possible examples. Importantly, the metric is defined to be d(G,G\u2032)=0 iff G~G\u2032 , implying that two isomorphic graphs are indiscernible [7]. The problem of isometric embedding", "attempts to replace the graph distance with the Euclidean distance |.| between the embeddings of the graphs in a way that the two distances are equal (the embedding f, in this case, is said to be \u201cisometric\u201d or \u201cdistance preserving\u201d).", "The works on the expressive power of graph neural networks showed that it is possible to construct in polynomial time graph embeddings that satisfy (\u2660) on a family of graphs on which the Weisfeiler-Lehman test succeeds. This setting seems to be too restrictive. First, it is probably impossible to devise a local and efficient algorithm that guarantees (\u2660) for all graphs [8]. Second, the graph isomorphism problem does not provide any guarantees for approximately isomorphic graphs, in which case d(G,G\u2032)>0. It is in principle possible, for example, that more similar graphs are less similar in the embedding space, i.e., d(G,G\u2032)<d(G,G\u2033) but |f(G)\u2212f(G\u2032)|>|f(G)\u2212f(G\u2033)|.", "The metric formulation, on the other hand, offers much more flexibility. Instead of requiring (\u2660) to hold exactly, one can relax it by bounding the metric dilation,", "which can be expressed as the bi-Lipschitz constant c of the embedding f. This means that the embedding does not \u201cstretch\u201d of \u201cshrink\u201d the groundtruth graph distance d by more than a factor c, which should ideally be as close to 1 as possible. Such an embedding is called an approximate isometry. A result one would try to obtain is a bound c independent of the graphs, and in particular, on the number of vertices.", "Note that the graph isomorphism is a particular case of (\u2663), since for isomorphic graphs G~G\u2032 one has d(G,G\u2032)=0 and thus f(G)=f(G\u2032). As discussed above, this is impossible to achieve for all graphs. Instead, model (\u2663) can be further relaxed allowing for additional metric distortion \u03b5,", "which sets a tolerance on how far apart can isomorphic graphs be. This is a small price to pay in many applications if in turn one can possibly satisfy (\u2666) for a much larger family of graphs than (\u2660).", "Probably approximate isometry. The approximate isomorphism problem can be rewritten as a probabilistic statement in the \u201cprobably approximately correct\u201d (PAC) form", "where the \u201capproximately\u201d is understood in the sense of the metric dilation c and \u201cprobably\u201d is that the bound (\u2666) holds with high probability 1\u2212\u03b4 for some distribution of graphs [9]. It is possible that such a setting will turn easier for analysis than the deterministic approximate isometric embedding problem.", "Bridging continuous and discrete structures. Last but not least, the question of graph neural network expressivity has been primarily focused on the topology of the graphs. However, in most practical applications, the graphs also have node- or edge-wise features or attributes, typically represented as vectors [10]. The metric framework naturally handles both structures by defining an appropriate distance between attributed graphs.", "As a final remark, I remind that one should also bear in mind that the majority of the works on the expressive power of graph neural networks are very recent developments building upon classical results in graph theory. Expanding into additional fields of mathematics such as metric geometry seems a promising avenue that is likely to bear fruit in the near future.", "[1] B. Weisfeiler, A. Lehman, The reduction of a graph to canonical form and the algebra which appears therein, 1968 (English translation)", "[7] Technically speaking, d is a pseudo-metric and can be regarded as a metric on the quotient set \ud835\udca2\u29f5~ of graphs modulo the isomorphism relation.", "[8] I say \u201cprobably\u201d because it is still unknown whether the graph isomorphism problem has a polynomial-time solution. It seems extremely unlikely that such a hypothetical algorithm would have practical time and space complexity.", "[9] A version of a probabilistic metric setting was previously used to analyse graph kernels in N. M. Kriege et al. A property testing framework for the theoretical expressivity of graph kernels (2018). Proc. IJCAI.", "[10] While the Weisfeiler-Lehman framework technically applies to coloured graphs, it is limited to nodes with a discrete set of features.", "I am grateful to Luca Belli, Giorgos Bouritsas, Fabrizio Frasca, Sergey Ivanov, and Emanuele Rossi for proof-reading this post, and to Christopher Morris for pointing to his previous work on property testing of graph kernels. Interested in Graph Deep Learning? See my other posts on Medium, or follow me on Twitter.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "DeepMind Professor of AI @Oxford. Serial startupper. ML for biochemistry, drug design, animal communication."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Ff7b816b75751&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbeyond-weisfeiler-lehman-approximate-isomorphisms-and-metric-embeddings-f7b816b75751&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbeyond-weisfeiler-lehman-approximate-isomorphisms-and-metric-embeddings-f7b816b75751&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbeyond-weisfeiler-lehman-approximate-isomorphisms-and-metric-embeddings-f7b816b75751&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbeyond-weisfeiler-lehman-approximate-isomorphisms-and-metric-embeddings-f7b816b75751&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----f7b816b75751--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----f7b816b75751--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://michael-bronstein.medium.com/?source=post_page-----f7b816b75751--------------------------------", "anchor_text": ""}, {"url": "https://michael-bronstein.medium.com/?source=post_page-----f7b816b75751--------------------------------", "anchor_text": "Michael Bronstein"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F7b1129ddd572&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbeyond-weisfeiler-lehman-approximate-isomorphisms-and-metric-embeddings-f7b816b75751&user=Michael+Bronstein&userId=7b1129ddd572&source=post_page-7b1129ddd572----f7b816b75751---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ff7b816b75751&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbeyond-weisfeiler-lehman-approximate-isomorphisms-and-metric-embeddings-f7b816b75751&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ff7b816b75751&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbeyond-weisfeiler-lehman-approximate-isomorphisms-and-metric-embeddings-f7b816b75751&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://towardsdatascience.com/expressive-power-of-graph-neural-networks-and-the-weisefeiler-lehman-test-b883db3c7c49", "anchor_text": "Part 1"}, {"url": "https://towardsdatascience.com/beyond-weisfeiler-lehman-using-substructures-for-provably-expressive-graph-neural-networks-d476ad665fa3", "anchor_text": "Part 2"}, {"url": "https://towardsdatascience.com/expressive-power-of-graph-neural-networks-and-the-weisefeiler-lehman-test-b883db3c7c49", "anchor_text": "as powerful as the 1-WL test"}, {"url": "https://towardsdatascience.com/beyond-weisfeiler-lehman-using-substructures-for-provably-expressive-graph-neural-networks-d476ad665fa3", "anchor_text": "different approach"}, {"url": "https://www.iti.zcu.cz/wl2018/pdf/wl_paper_translation.pdf", "anchor_text": "The reduction of a graph to canonical form and the algebra which appears therein"}, {"url": "https://arxiv.org/abs/1810.00826", "anchor_text": "How powerful are graph neural networks?"}, {"url": "https://arxiv.org/abs/1905.11136", "anchor_text": "Provably powerful graph neural networks"}, {"url": "https://arxiv.org/abs/2006.09252", "anchor_text": "Improving graph neural network expressivity via subgraph isomorphism counting"}, {"url": "https://www.ijcai.org/Proceedings/2018/0325.pdf", "anchor_text": "A property testing framework for the theoretical expressivity of graph kernels"}, {"url": "https://towardsdatascience.com/graph-deep-learning/home", "anchor_text": "other posts"}, {"url": "https://twitter.com/mmbronstein", "anchor_text": "Twitter"}, {"url": "https://medium.com/tag/geometric-deep-learning?source=post_page-----f7b816b75751---------------geometric_deep_learning-----------------", "anchor_text": "Geometric Deep Learning"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----f7b816b75751---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/graph-neural-networks?source=post_page-----f7b816b75751---------------graph_neural_networks-----------------", "anchor_text": "Graph Neural Networks"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----f7b816b75751---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/editors-pick?source=post_page-----f7b816b75751---------------editors_pick-----------------", "anchor_text": "Editors Pick"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Ff7b816b75751&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbeyond-weisfeiler-lehman-approximate-isomorphisms-and-metric-embeddings-f7b816b75751&user=Michael+Bronstein&userId=7b1129ddd572&source=-----f7b816b75751---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Ff7b816b75751&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbeyond-weisfeiler-lehman-approximate-isomorphisms-and-metric-embeddings-f7b816b75751&user=Michael+Bronstein&userId=7b1129ddd572&source=-----f7b816b75751---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ff7b816b75751&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbeyond-weisfeiler-lehman-approximate-isomorphisms-and-metric-embeddings-f7b816b75751&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----f7b816b75751--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Ff7b816b75751&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbeyond-weisfeiler-lehman-approximate-isomorphisms-and-metric-embeddings-f7b816b75751&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----f7b816b75751---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----f7b816b75751--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----f7b816b75751--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----f7b816b75751--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----f7b816b75751--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----f7b816b75751--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----f7b816b75751--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----f7b816b75751--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----f7b816b75751--------------------------------", "anchor_text": ""}, {"url": "https://michael-bronstein.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://michael-bronstein.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Michael Bronstein"}, {"url": "https://michael-bronstein.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "9.7K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F7b1129ddd572&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbeyond-weisfeiler-lehman-approximate-isomorphisms-and-metric-embeddings-f7b816b75751&user=Michael+Bronstein&userId=7b1129ddd572&source=post_page-7b1129ddd572--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F936a58357100&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbeyond-weisfeiler-lehman-approximate-isomorphisms-and-metric-embeddings-f7b816b75751&newsletterV3=7b1129ddd572&newsletterV3Id=936a58357100&user=Michael+Bronstein&userId=7b1129ddd572&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}