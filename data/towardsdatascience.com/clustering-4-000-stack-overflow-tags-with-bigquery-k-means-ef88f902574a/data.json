{"url": "https://towardsdatascience.com/clustering-4-000-stack-overflow-tags-with-bigquery-k-means-ef88f902574a", "time": 1682997400.458448, "path": "towardsdatascience.com/clustering-4-000-stack-overflow-tags-with-bigquery-k-means-ef88f902574a/", "webpage": {"metadata": {"title": "Clustering 4,000 Stack Overflow tags with BigQuery k-means | by Felipe Hoffa | Towards Data Science", "h1": "Clustering 4,000 Stack Overflow tags with BigQuery k-means", "description": "Felipe Hoffa is a Developer Advocate for Google Cloud. In this post he works with BigQuery \u2014 Google\u2019s serverless data warehouse \u2014 to run k-means clustering over Stack Overflow\u2019s published dataset\u2026"}, "outgoing_paragraph_urls": [{"url": "https://twitter.com/felipehoffa", "anchor_text": "Felipe Hoffa", "paragraph_index": 0}, {"url": "http://cloud.google.com/bigquery", "anchor_text": "BigQuery", "paragraph_index": 0}, {"url": "https://stackoverflow.blog/2016/12/15/you-can-now-play-with-stack-overflow-data-on-googles-bigquery/", "anchor_text": "here", "paragraph_index": 0}, {"url": "https://towardsdatascience.com/bigquery-without-a-credit-card-discover-learn-and-share-199e08d4a064", "anchor_text": "here", "paragraph_index": 0}, {"url": "https://cloud.google.com/bigquery-ml/docs/reference/standard-sql/bigqueryml-syntax-create", "anchor_text": "BigQuery docs for creating models", "paragraph_index": 16}, {"url": "https://cloud.google.com/bigquery-ml/docs/kmeans-tutorial", "anchor_text": "k-means tutorial", "paragraph_index": 16}, {"url": "https://medium.com/u/247b0630b5d6?source=post_page-----ef88f902574a--------------------------------", "anchor_text": "Lak Lakshmanan", "paragraph_index": 17}, {"url": "https://towardsdatascience.com/how-to-do-hyperparameter-tuning-of-a-bigquery-ml-model-29ba273a6563?source=post_page---------------------------", "anchor_text": "hyper-parameter tuning", "paragraph_index": 17}, {"url": "https://twitter.com/felipehoffa", "anchor_text": "@felipehoffa", "paragraph_index": 20}, {"url": "https://medium.com/@hoffa", "anchor_text": "medium.com/@hoffa", "paragraph_index": 20}, {"url": "https://reddit.com/r/bigquery", "anchor_text": "reddit.com/r/bigquery", "paragraph_index": 20}, {"url": "https://towardsdatascience.com/when-will-stack-overflow-reply-how-to-predict-with-bigquery-553c24b546a3", "anchor_text": "predicting when will Stack Overflow reply", "paragraph_index": 20}], "all_paragraphs": ["Felipe Hoffa is a Developer Advocate for Google Cloud. In this post he works with BigQuery \u2014 Google\u2019s serverless data warehouse \u2014 to run k-means clustering over Stack Overflow\u2019s published dataset, which is refreshed and uploaded to Google\u2019s Cloud once a quarter. You can check out more about working with Stack Overflow data and BigQuery here and here.", "These are the most active Stack Overflow tags since 2018 \u2014 they\u2019re a lot. In this picture I only have 240 tags \u2014 how would you group and categorize 4,000+ of them?", "Let\u2019s find tags that usually go together:", "So I\u2019ll take these relationships and I\u2019ll save them on an auxiliary table \u2014 plus a percentage of how frequently a relationship happens for each tag.", "Now get ready for some SQL magic. BigQuery ML does a good job of hot-encoding strings, but it doesn\u2019t handle arrays as I wish it did (stay tuned). So I\u2019m going to create a string first that will define all the columns where I want to find co-occurrence. Then I can use that string to get a huge table, with a 1 for every time a tag co-occurs with the main one at least certain % of time. Let\u2019s see first a subset of these results:", "What you see here is a co-occurrence matrix:", "You can reduce or augment the sensibility of these relations with the percent threshold:", "Now \u2014 instead of using this small table, let\u2019s use the whole table to compute k-means with BigQuery. With this line, I\u2019m creating a one-hot encoding string that I can use later to define the 4,000+ columns I\u2019ll use for k-means:", "And training a k-means model in BigQuery is really easy:", "Now we wait \u2014 while BigQuery shows us the progress of our training:", "And when it\u2019s done, we even get an evaluation of our model:", "Do we really need 4,000 one-hot encoded dimensions to obtain better clusters? Turns out that 500 are enough \u2014 and I like the results better. It also reduces the time for training the model in BigQuery from 24 minutes to 3. The same with only 30 dimensions lowers the time to 90 seconds \u2014 but I like the results better with 500. More on hyper-parameter tuning below.", "Now it\u2019s time to see our results. I\u2019ll even look out for some tags I\u2019m interested in: How are google, amazon, and azure represented in each cluster? These are the 50 groups that k-means clustering found - given the 1-hot encoding of related tags we did earlier in this post. Some results make a lot of sense - while others give great insight into what are the prevalent surrounding technologies to any Stack Overflow tag. Naming each centroid is always a challenge. Here I used the top 5 centroid weight vectors - see how below.", "The code I used to create and display the previous results:", "Note that I joined my results with ML.CENTROIDS() - which gives me the top differentiating occurring tags for each centroid - even if they are not part of each cluster.", "Are you surprised by the results? Or surprised by how easy was to run our k-means modeling with BigQuery? Or curious for why I chose distance-type: 'COSINE' for this problem? Now it\u2019s your turn to play :).", "Check the BigQuery docs for creating models and the k-means tutorial.", "How would you choose the best parameters? Check Lak Lakshmanan post for hyper-parameter tuning. Lak also had some interesting ideas about dimensionality reduction for clustering via matrix factorization \u2014 but we\u2019ll leave that for a future post. As an untested preview:", "Once you have the co-occurrence of tag1 and tag2, treat it as a recommendation problem, i.e. tag2 is what tag1 liked percent of the time. Then, you can do matrix factorization:", "From this matrix factorization, you will have tag1_factors and tag2_factors which are essentially an embedding of the tags learned from the data. Concatenate these and cluster it instead \u2026", "I\u2019m Felipe Hoffa, a Developer Advocate for Google Cloud. Tweet me @felipehoffa, my previous posts on medium.com/@hoffa, and all about BigQuery on reddit.com/r/bigquery \u2014 including predicting when will Stack Overflow reply.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Cloud Advocate at Snowflake \u2744\ufe0f. Originally from Chile, now in San Francisco and around the world. Previously at Google. Let\u2019s talk data."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fef88f902574a&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fclustering-4-000-stack-overflow-tags-with-bigquery-k-means-ef88f902574a&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fclustering-4-000-stack-overflow-tags-with-bigquery-k-means-ef88f902574a&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fclustering-4-000-stack-overflow-tags-with-bigquery-k-means-ef88f902574a&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fclustering-4-000-stack-overflow-tags-with-bigquery-k-means-ef88f902574a&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----ef88f902574a--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----ef88f902574a--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://hoffa.medium.com/?source=post_page-----ef88f902574a--------------------------------", "anchor_text": ""}, {"url": "https://hoffa.medium.com/?source=post_page-----ef88f902574a--------------------------------", "anchor_text": "Felipe Hoffa"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F279fe54c149a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fclustering-4-000-stack-overflow-tags-with-bigquery-k-means-ef88f902574a&user=Felipe+Hoffa&userId=279fe54c149a&source=post_page-279fe54c149a----ef88f902574a---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fef88f902574a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fclustering-4-000-stack-overflow-tags-with-bigquery-k-means-ef88f902574a&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fef88f902574a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fclustering-4-000-stack-overflow-tags-with-bigquery-k-means-ef88f902574a&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://twitter.com/felipehoffa", "anchor_text": "Felipe Hoffa"}, {"url": "http://cloud.google.com/bigquery", "anchor_text": "BigQuery"}, {"url": "https://stackoverflow.blog/2016/12/15/you-can-now-play-with-stack-overflow-data-on-googles-bigquery/", "anchor_text": "here"}, {"url": "https://towardsdatascience.com/bigquery-without-a-credit-card-discover-learn-and-share-199e08d4a064", "anchor_text": "here"}, {"url": "https://en.wikipedia.org/wiki/Davies%E2%80%93Bouldin_index?source=post_page---------------------------", "anchor_text": "Davies-Bouldin index"}, {"url": "https://cloud.google.com/bigquery/docs/reference/rest/v2/models?source=post_page---------------------------#clusteringmetrics", "anchor_text": "Mean squared distance"}, {"url": "https://en.wikipedia.org/wiki/Davies%E2%80%93Bouldin_index?source=post_page---------------------------", "anchor_text": "Davies-Bouldin index"}, {"url": "https://cloud.google.com/bigquery/docs/reference/rest/v2/models?source=post_page---------------------------#clusteringmetrics", "anchor_text": "Mean squared distance"}, {"url": "https://cloud.google.com/bigquery-ml/docs/reference/standard-sql/bigqueryml-syntax-create", "anchor_text": "BigQuery docs for creating models"}, {"url": "https://cloud.google.com/bigquery-ml/docs/kmeans-tutorial", "anchor_text": "k-means tutorial"}, {"url": "https://medium.com/u/247b0630b5d6?source=post_page-----ef88f902574a--------------------------------", "anchor_text": "Lak Lakshmanan"}, {"url": "https://towardsdatascience.com/how-to-do-hyperparameter-tuning-of-a-bigquery-ml-model-29ba273a6563?source=post_page---------------------------", "anchor_text": "hyper-parameter tuning"}, {"url": "https://twitter.com/felipehoffa", "anchor_text": "@felipehoffa"}, {"url": "https://medium.com/@hoffa", "anchor_text": "medium.com/@hoffa"}, {"url": "https://reddit.com/r/bigquery", "anchor_text": "reddit.com/r/bigquery"}, {"url": "https://towardsdatascience.com/when-will-stack-overflow-reply-how-to-predict-with-bigquery-553c24b546a3", "anchor_text": "predicting when will Stack Overflow reply"}, {"url": "https://stackoverflow.blog/2019/07/24/making-sense-of-the-metadata-clustering-4000-stack-overflow-tags-with-bigquery-k-means/", "anchor_text": "https://stackoverflow.blog"}, {"url": "https://medium.com/tag/bigquery?source=post_page-----ef88f902574a---------------bigquery-----------------", "anchor_text": "Bigquery"}, {"url": "https://medium.com/tag/data-science?source=post_page-----ef88f902574a---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----ef88f902574a---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/stackoverflow?source=post_page-----ef88f902574a---------------stackoverflow-----------------", "anchor_text": "Stackoverflow"}, {"url": "https://medium.com/tag/programming?source=post_page-----ef88f902574a---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fef88f902574a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fclustering-4-000-stack-overflow-tags-with-bigquery-k-means-ef88f902574a&user=Felipe+Hoffa&userId=279fe54c149a&source=-----ef88f902574a---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fef88f902574a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fclustering-4-000-stack-overflow-tags-with-bigquery-k-means-ef88f902574a&user=Felipe+Hoffa&userId=279fe54c149a&source=-----ef88f902574a---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fef88f902574a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fclustering-4-000-stack-overflow-tags-with-bigquery-k-means-ef88f902574a&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----ef88f902574a--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fef88f902574a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fclustering-4-000-stack-overflow-tags-with-bigquery-k-means-ef88f902574a&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----ef88f902574a---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----ef88f902574a--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----ef88f902574a--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----ef88f902574a--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----ef88f902574a--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----ef88f902574a--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----ef88f902574a--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----ef88f902574a--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----ef88f902574a--------------------------------", "anchor_text": ""}, {"url": "https://hoffa.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://hoffa.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Felipe Hoffa"}, {"url": "https://hoffa.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "17.8K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F279fe54c149a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fclustering-4-000-stack-overflow-tags-with-bigquery-k-means-ef88f902574a&user=Felipe+Hoffa&userId=279fe54c149a&source=post_page-279fe54c149a--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F399b7ae54013&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fclustering-4-000-stack-overflow-tags-with-bigquery-k-means-ef88f902574a&newsletterV3=279fe54c149a&newsletterV3Id=399b7ae54013&user=Felipe+Hoffa&userId=279fe54c149a&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}