{"url": "https://towardsdatascience.com/next-generation-sequencing-data-analysis-with-pyspark-888a1e0a079", "time": 1683003267.566628, "path": "towardsdatascience.com/next-generation-sequencing-data-analysis-with-pyspark-888a1e0a079/", "webpage": {"metadata": {"title": "Next-Generation Sequencing Data Analysis With PySpark | by Aneesh Panoli | Towards Data Science", "h1": "Next-Generation Sequencing Data Analysis With PySpark", "description": "The rapid growth of Next Generation Sequencing technologies such as single-cell RNA sequencing(scRNA-seq) demands efficient parallel processing and analysis of big data. Hadoop and Spark are the\u2026"}, "outgoing_paragraph_urls": [{"url": "https://colab.research.google.com/", "anchor_text": "Google Colab", "paragraph_index": 3}, {"url": "https://www.ncbi.nlm.nih.gov/sra", "anchor_text": "SRA", "paragraph_index": 6}, {"url": "https://trace.ncbi.nlm.nih.gov/Traces/sra/sra.cgi?view=software#header-global", "anchor_text": "SRA toolkit", "paragraph_index": 6}, {"url": "https://colab.research.google.com/drive/1OZdFuMRKg85gumJejdmGrgDH1NSz0yAT", "anchor_text": "this colab notebook", "paragraph_index": 19}], "all_paragraphs": ["With DNA, you have to be able to tell which genes are turned on or off. Current DNA sequencing cannot do that. The next generation of DNA sequencing needs to be able to do this. If somebody invents this, then we can start to very precisely identify cures for diseases. \u2014 Elon Musk", "The rapid growth of Next Generation Sequencing technologies such as single-cell RNA sequencing(scRNA-seq) demands efficient parallel processing and analysis of big data. Hadoop and Spark are the go-to open-source frameworks for storing and processing massive datasets. The most significant advantage of Spark is its iterative analytics capability combined with in-memory computing architecture. Calling .cache() on a resilient distributed dataset (RDD) effectively saves it in memory and makes it instantly available for computation; thus, the subsequent filter, map, and reduce tasks become instantaneous. Spark has its query language known as Spark SQL, and its MLlib library is highly desirable for machine learning tasks.", "The scRNA-seq can do what Musk pointed out \u2014 figuring out which genes are turned on/off at cellular resolution. But it\u2019s not the silver bullet \u2014 because the regulation of gene expression doesn\u2019t stop at the transcription level. The mRNA or the messenger RNA \u2014 a proxy of protein-coding regions of the gene \u2014 also contains sequences that determine the level of ribosomal protein synthesis. The expressed protein can also undergo a series of post-translational modifications that activate or repress it.", "Over the years, I have loved Google Colab for all my quick and dirty project prototyping. With Colab, you can skip all the initial steps required to get your project off the ground. No need to set up a virtual environment, dependencies, etc. Also, Colab comes with free GPU/TPU for all your machine learning needs.", "First, go to Colab, following the link above, and fire up a new Python 3 notebook. PySpark requires Java (Java 1.8) and Scala, so that we will install them next.", "Now install PySpark. Here we will install pyspark[sql] because it will allow us to deal with .gtf, .bed, .bam, and .sam files later.", "Sequence data from published research is available for download from SRA. Before you can use the sra file, you need to extract .fastq from it using the fastq-dump tool of the SRA toolkit. Instead of SRA files, you may directly download .fastq, .fa.gz, or .fastq.gz formats; these files can now be read with PySpark.", "Be mindful of the file size.", "At the core of PySpark is the resilient distributed dataset (RDD); it represents an immutable partitioned collection of your data that can be operated in parallel.", "You begin by initializing a spark context.", "It\u2019s also a good practice to pass in an optimal configuration for your workflow.", "Now it\u2019s time to read and transform our data to RDD.", "Let\u2019s extract just the sequences from the data.", "Take a look at the first four reads.", "How about finding the length of the reads? It takes only a line of code!", "Next, compute the average length of the reads.", "Finally, let\u2019s do the base count. First, we will split the sequences into individual bases using list(), then use flatMap to merge the lists into a single one. Then we go through respective bases and create a tuple with the first element as the base and \u20181\u2019 as its value. Then we use reduceByKey to aggregate values by the first element \u2014 key \u2014 of the tuple.", "We only care about A, T, G, and C here; the rest are artifacts. As you can see, these sequences are GC-rich.", "I have only scratched the surface here, and you can do many cool things with PySpark. I will come back with more in another piece.", "You can find the code examples in this colab notebook.", "I hope I have covered enough basics here to get you started. Talk to you next time.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Ph.D., Data Scientist, Computational Biology, Game Developer, Full-stack Python/Django, Stock Trader"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F888a1e0a079&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnext-generation-sequencing-data-analysis-with-pyspark-888a1e0a079&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnext-generation-sequencing-data-analysis-with-pyspark-888a1e0a079&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnext-generation-sequencing-data-analysis-with-pyspark-888a1e0a079&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnext-generation-sequencing-data-analysis-with-pyspark-888a1e0a079&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----888a1e0a079--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----888a1e0a079--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@aneeshpanoli?source=post_page-----888a1e0a079--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@aneeshpanoli?source=post_page-----888a1e0a079--------------------------------", "anchor_text": "Aneesh Panoli"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F91bf3d29def8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnext-generation-sequencing-data-analysis-with-pyspark-888a1e0a079&user=Aneesh+Panoli&userId=91bf3d29def8&source=post_page-91bf3d29def8----888a1e0a079---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F888a1e0a079&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnext-generation-sequencing-data-analysis-with-pyspark-888a1e0a079&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F888a1e0a079&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnext-generation-sequencing-data-analysis-with-pyspark-888a1e0a079&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://colab.research.google.com/", "anchor_text": "Google Colab"}, {"url": "https://www.ncbi.nlm.nih.gov/sra", "anchor_text": "SRA"}, {"url": "https://trace.ncbi.nlm.nih.gov/Traces/sra/sra.cgi?view=software#header-global", "anchor_text": "SRA toolkit"}, {"url": "https://cwiki.apache.org/", "anchor_text": "https://cwiki.apache.org/"}, {"url": "https://colab.research.google.com/drive/1OZdFuMRKg85gumJejdmGrgDH1NSz0yAT", "anchor_text": "this colab notebook"}, {"url": "https://medium.com/tag/data-science?source=post_page-----888a1e0a079---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/bioinformatics?source=post_page-----888a1e0a079---------------bioinformatics-----------------", "anchor_text": "Bioinformatics"}, {"url": "https://medium.com/tag/biology?source=post_page-----888a1e0a079---------------biology-----------------", "anchor_text": "Biology"}, {"url": "https://medium.com/tag/dna-sequencing?source=post_page-----888a1e0a079---------------dna_sequencing-----------------", "anchor_text": "Dna Sequencing"}, {"url": "https://medium.com/tag/towards-data-science?source=post_page-----888a1e0a079---------------towards_data_science-----------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F888a1e0a079&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnext-generation-sequencing-data-analysis-with-pyspark-888a1e0a079&user=Aneesh+Panoli&userId=91bf3d29def8&source=-----888a1e0a079---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F888a1e0a079&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnext-generation-sequencing-data-analysis-with-pyspark-888a1e0a079&user=Aneesh+Panoli&userId=91bf3d29def8&source=-----888a1e0a079---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F888a1e0a079&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnext-generation-sequencing-data-analysis-with-pyspark-888a1e0a079&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----888a1e0a079--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F888a1e0a079&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnext-generation-sequencing-data-analysis-with-pyspark-888a1e0a079&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----888a1e0a079---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----888a1e0a079--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----888a1e0a079--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----888a1e0a079--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----888a1e0a079--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----888a1e0a079--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----888a1e0a079--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----888a1e0a079--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----888a1e0a079--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@aneeshpanoli?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@aneeshpanoli?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Aneesh Panoli"}, {"url": "https://medium.com/@aneeshpanoli/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "139 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F91bf3d29def8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnext-generation-sequencing-data-analysis-with-pyspark-888a1e0a079&user=Aneesh+Panoli&userId=91bf3d29def8&source=post_page-91bf3d29def8--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Feacd15a9aa3f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnext-generation-sequencing-data-analysis-with-pyspark-888a1e0a079&newsletterV3=91bf3d29def8&newsletterV3Id=eacd15a9aa3f&user=Aneesh+Panoli&userId=91bf3d29def8&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}