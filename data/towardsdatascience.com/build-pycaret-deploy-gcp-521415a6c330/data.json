{"url": "https://towardsdatascience.com/build-pycaret-deploy-gcp-521415a6c330", "time": 1683010681.080538, "path": "towardsdatascience.com/build-pycaret-deploy-gcp-521415a6c330/", "webpage": {"metadata": {"title": "Build with PyCaret: Deploy on Google Cloud Platform | by MA Raza, Ph.D. | Towards Data Science", "h1": "Build with PyCaret: Deploy on Google Cloud Platform", "description": "In this story, I have developed a working tutorial on deploying a model trained with pycaret on Google Cloud Platform. This tutorial can be used to deploy any machine learning model(s) with slight\u2026"}, "outgoing_paragraph_urls": [{"url": "https://aws.amazon.com/", "anchor_text": "AWS", "paragraph_index": 1}, {"url": "https://www.pycaret.org", "anchor_text": "source", "paragraph_index": 2}, {"url": "https://pycaret.org/reg101/", "anchor_text": "Regression Tutorial (REG101) \u2014 Level Beginner", "paragraph_index": 5}, {"url": "https://medium.com/@prajwal.prashanth22/google-colab-drive-as-persistent-storage-for-long-training-runs-cb82bc1d5b71", "anchor_text": "mounting gdrive", "paragraph_index": 6}, {"url": "https://github.com/DardenDSC/sarah-gets-a-diamond", "anchor_text": "found here", "paragraph_index": 9}, {"url": "https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.read_csv.html", "anchor_text": "(Learn How)", "paragraph_index": 9}, {"url": "https://github.com/pycaret/pycaret", "anchor_text": "pycaret", "paragraph_index": 33}], "all_paragraphs": ["In this story, I have developed a working tutorial on deploying a model trained with pycaret on Google Cloud Platform. This tutorial can be used to deploy any machine learning model(s) with slight modifications.", "We will learn how to deploy models trained with pycaret to Google Cloud Platform. As you might know, pycaret already has support to deploy the trained models on AWS but not with GCP or Azure at the moment. I followed the similar code-practices as used in the library for deploying models on AWS and added essential utilities for GCP deploying.", "PyCaret is an open source, low-code machine learning library in Python that allows you to go from preparing your data to deploying your model within seconds in your choice of notebook environment [source].", "A PyCaret is an autoML framework for citizen data scientists term used in its official documentation. PyCaret is relatively a new library released a few months ago for public use and still under active development. After going through some source code, I realized the current public release lacks support for the deployment of trained/finalized models to Google Cloud Platform. Although, It has support only for deploying on Amazon web services.", "Keeping in a view wide use of GCP as cloud service, I have given a try to add a tutorial on deploying the trained model on google cloud using PyCaret\u2019s way.", "For this tutorial, we will use the Regression Tutorial (REG101) \u2014 Level Beginner for model training.", "We need to mount the google drive to read/write the data in colab environment. Below is the simplest way to mount it. You will be asked to enter the token generated by your access procedure. Here is the link to the article about mounting gdrive", "We will save models locally on Google drive for this tutorial.", "Let us create a directory to save models locally.", "You can download the data from the original source found here and load it using pandas (Learn How) or you can use PyCaret\u2019s data repository to load the data using the get_data() function (This will require internet connection).", "Let us prepare a modeling pipeline using PyCaret\u2019s setup module.", "For this tutorial, we model the data using Light GBM from many options implemented in PyCaret. You can choose any model of your choice but that is not the focus of this tutorial.", "Let us train the model also called tuning the model in PyCaret\u2019s terminologies.", "Below are the plots to see the residual errors for the model", "Let us plot the prediction errors vs true values of target.", "feature importance is a very informative plot to see the contribution of each feature in the model.", "Another way to analyze the performance of models is to use the evaluate_model() function which displays a user interface for all of the available plots for a given model. It internally uses the plot_model() function.", "The Label column is added onto the data_unseen set. The label is the predicted value using the final_lightgbm model. If you want predictions to be rounded, you can use round parameter inside predict_model().", "Let us first save the model locally", "To load a saved model at a future date in the same or an alternative environment, we would use PyCaret\u2019s load_model() function and then easily apply the saved model on new unseen data for prediction.", "Once the model is loaded in the environment, you can simply use it to predict any new data using the same predict_model() function. Below we have applied the loaded model to predict the same data_unseen that we used in the section above.", "Notice that the results of unseen_predictions and new_prediction are identical.", "Once, we have the trained model the next task is to deploy it to serve the clients. There are various deployment options available however in this section I focus on deploying it on Google Cloud AI platform. I try to use a similar approach as followed in pycaret library for deploying on AWS.", "The pre-requisites to deploy the machine learning models on google cloud are", "Define google cloud project, target bucket, and set the cloud_project Environment variable. Create a google cloud project if not created earlier. Follow the above guide for more information on it.", "We define some utility functions to create a google cloud storage bucket, uploading a blob to storage bucket, and downloading the blob from the storage bucket.", "The codes are taken from Google official documentation and modified slightly based on our requirements here.", "Using the above utilities, use the below code to upload the model to the GCP storage bucket.", "Upload the model to google cloud storage bucket", "Once your model is upload to GCP, you can download anytime to perform the predictions. I follow a simple flow, where the model is downloaded locally or in google drive first, and then using the load_model function, predictions can be generated.", "Use the recently downloaded model from GCP to perform the prediction.", "Follow the below Google colaboratory notebook to reproduce and practice this guide.", "In this tutorial, we learned how to deploy the model to GCP when trained with pycaret library.", "The main objective was to use built-in utils of pycaret to deploy and load the model from GCP. Below are some highlights", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Engineer | Data Scientist | ML Researcher | Educator"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F521415a6c330&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuild-pycaret-deploy-gcp-521415a6c330&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuild-pycaret-deploy-gcp-521415a6c330&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuild-pycaret-deploy-gcp-521415a6c330&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuild-pycaret-deploy-gcp-521415a6c330&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----521415a6c330--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----521415a6c330--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@amjadraza24?source=post_page-----521415a6c330--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@amjadraza24?source=post_page-----521415a6c330--------------------------------", "anchor_text": "MA Raza, Ph.D."}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F43f78dfb3de3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuild-pycaret-deploy-gcp-521415a6c330&user=MA+Raza%2C+Ph.D.&userId=43f78dfb3de3&source=post_page-43f78dfb3de3----521415a6c330---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F521415a6c330&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuild-pycaret-deploy-gcp-521415a6c330&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F521415a6c330&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuild-pycaret-deploy-gcp-521415a6c330&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://aws.amazon.com/", "anchor_text": "AWS"}, {"url": "https://www.pycaret.org", "anchor_text": "source"}, {"url": "https://pycaret.org/reg101/", "anchor_text": "Regression Tutorial (REG101) \u2014 Level Beginner"}, {"url": "https://medium.com/@prajwal.prashanth22/google-colab-drive-as-persistent-storage-for-long-training-runs-cb82bc1d5b71", "anchor_text": "mounting gdrive"}, {"url": "https://github.com/DardenDSC/sarah-gets-a-diamond", "anchor_text": "found here"}, {"url": "https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.read_csv.html", "anchor_text": "(Learn How)"}, {"url": "https://cloud.google.com/ai-platform/prediction/docs/deploying-models#scikit-learn-or-xgboost-model-file", "anchor_text": "Read the Guide"}, {"url": "https://github.com/pycaret/pycaret", "anchor_text": "pycaret"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----521415a6c330---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----521415a6c330---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/pycaret?source=post_page-----521415a6c330---------------pycaret-----------------", "anchor_text": "Pycaret"}, {"url": "https://medium.com/tag/google-cloud-platform?source=post_page-----521415a6c330---------------google_cloud_platform-----------------", "anchor_text": "Google Cloud Platform"}, {"url": "https://medium.com/tag/python?source=post_page-----521415a6c330---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F521415a6c330&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuild-pycaret-deploy-gcp-521415a6c330&user=MA+Raza%2C+Ph.D.&userId=43f78dfb3de3&source=-----521415a6c330---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F521415a6c330&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuild-pycaret-deploy-gcp-521415a6c330&user=MA+Raza%2C+Ph.D.&userId=43f78dfb3de3&source=-----521415a6c330---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F521415a6c330&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuild-pycaret-deploy-gcp-521415a6c330&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----521415a6c330--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F521415a6c330&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuild-pycaret-deploy-gcp-521415a6c330&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----521415a6c330---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----521415a6c330--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----521415a6c330--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----521415a6c330--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----521415a6c330--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----521415a6c330--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----521415a6c330--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----521415a6c330--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----521415a6c330--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@amjadraza24?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@amjadraza24?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "MA Raza, Ph.D."}, {"url": "https://medium.com/@amjadraza24/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "176 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F43f78dfb3de3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuild-pycaret-deploy-gcp-521415a6c330&user=MA+Raza%2C+Ph.D.&userId=43f78dfb3de3&source=post_page-43f78dfb3de3--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F3cd60c3ab90f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuild-pycaret-deploy-gcp-521415a6c330&newsletterV3=43f78dfb3de3&newsletterV3Id=3cd60c3ab90f&user=MA+Raza%2C+Ph.D.&userId=43f78dfb3de3&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}