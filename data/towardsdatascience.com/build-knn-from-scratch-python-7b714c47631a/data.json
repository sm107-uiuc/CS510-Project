{"url": "https://towardsdatascience.com/build-knn-from-scratch-python-7b714c47631a", "time": 1683013803.8262022, "path": "towardsdatascience.com/build-knn-from-scratch-python-7b714c47631a/", "webpage": {"metadata": {"title": "Build kNN from scratch in Python. With k-Fold cross-validation (from\u2026 | by Chaitanya Krishna Kasaraneni | Towards Data Science", "h1": "Build kNN from scratch in Python", "description": "In this article, we shall understand how k-Nearest Neighbors (kNN) algorithm works and build kNN algorithm from ground up. We also shall evaluate our algorithm using the k-Fold cross-validation which\u2026"}, "outgoing_paragraph_urls": [{"url": "https://github.com/chaitanyakasaraneni/knnFromScratch", "anchor_text": "GitHub", "paragraph_index": 8}, {"url": "https://medium.com/datadriveninvestor/k-fold-and-other-cross-validation-techniques-6c03a2563f1e", "anchor_text": "here", "paragraph_index": 30}, {"url": "https://github.com/chaitanyakasaraneni/knnFromScratch", "anchor_text": "GitHub repository", "paragraph_index": 38}, {"url": "https://chaitanyak.me", "anchor_text": "https://chaitanyak.me", "paragraph_index": 42}], "all_paragraphs": ["In this article, we shall understand how k-Nearest Neighbors (kNN) algorithm works and build kNN algorithm from ground up. We also shall evaluate our algorithm using the k-Fold cross-validation which is also developed from scratch.", "After completing this tutorial you will know:", "Prerequisites: Basic understanding of Python and the concept of classes and objects from Object-oriented Programming (OOP)", "k-Nearest Neighbors, kNN for short, is a very simple but powerful technique used for making predictions. The principle behind kNN is to use \u201cmost similar historical examples to the new data.\u201d", "\u2018k\u2019 is a number used to identify similar neighbors for the new data point.", "The entire training dataset is initially stored. When predictions are required for new data, kNN considers the k-most similar neighbors (records) to decide where the new data point will belong to based on feature similarity.", "Once we find the distance or similarity, we choose the top k closest records. After discovering k closest records, we make the prediction by returning the most common outcome or taking the average. As such, kNN can be used for classification or regression problems.", "kNN algorithm doesn\u2019t have a training phase. The model just holds the data until a prediction is required and does no work. For this reason, kNN is often referred to as a \u201clazy learning method\u201d.", "You can follow along using the code available in my GitHub.", "You can also install it by using:", "Choice of K has a drastic impact on the results we obtain from kNN. Better choose an odd number.", "The next step is to calculate distance between two rows in a dataset.", "Problem or data specific methods are used to calculate distance or similarity between two records. In general for tabular or vector data, Euclidean distance is considered as starting point. There are several other similarity or distance metrics such as Manhattan distance, Hamming distance, etc.", "Euclidean distance is defined as the square root of the sum of squared distance (difference) between two points. It is also known as L2 norm.", "Manhattan distance is the sum of the absolute values of the differences between two points", "Hamming distance is used for categorical variables. In simple terms it tells us if the two categorical variables are same or not.", "where \u2018\u03b4\u2019 is used to check equality of the two elements.", "In python, we create a separate class that holds the methods to calculate the distance between two vectors.", "We shall utilize this class to find the nearest neighbors in the next step.", "Neighbors for a piece of new data in the dataset are the top \u2014 k closest instances that we obtain using the distance metrics defined above.", "To locate the neighbors for a new piece of data within a dataset we must first calculate the distance between each record in the dataset to the new piece of data. We can do this by creating an object for the distanceMetric class that we defined above.", "Once distances are calculated, we must sort all of the records in the training dataset by their distance to the new data. We can then select the top k to return as the most similar neighbors.", "We can do this by keeping track of the distance for each record in the dataset as a list, sort the list of lists by the distance and then retrieve the neighbors.", "Now that we know how to get top k \u2014 neighbors from the dataset, we will use them to make predictions.", "In this step, we shall use the top \u2014 k similar neighbors collected from training dataset to make predictions.", "In the case of classification, we can return the most represented class among the neighbors.", "We can achieve this by performing the max() function on the list of output values from the neighbors. Given a list of class values observed in the neighbors, the max() function takes a set of unique class values and calls the count on the list of class values for each class value in the set.", "Below is the complete kNN class:", "Now that we have our predictions, we need to evaluate the performance of our model. For this, we shall use k-Fold Cross Validation which is defined in the next part.", "This technique involves randomly dividing the dataset into k-groups or folds of approximately equal size. The first fold is kept for testing and the model is trained on remaining k-1 folds.", "There are many variants of k-Fold Cross Validation. You can read more about them here.", "In out approach, after each fold, we calculate accuracy, and thus accuracy of k-Fold CV is computed by taking average of the accuracies over k-folds.", "As a first step, we divide the dataset into k- folds.", "Then for each fold in the k-folds, we perform kNN algorithm, get predictions and evaluate the performance using accuracy as evaluation metric.", "The method to split the data into k-Folds:", "Both methods combined into a single class:", "We can execute this by creating an object for k-Fold cross validation method and call the evaluate method as shown below.", "The kfcv.kFCVEvaluate() then splits the data into the specified number of folds and evaluated kNN algorithm by considering top-k neighbors using the distanceMetric specified.", "Examples and implementation can be seen in my GitHub repository.", "In this blog, we have seen:", "Hope you gained some knowledge reading this article. Please remember that this article is just an overview and my understanding of kNN algorithm and kFold Cross validation technique that I read from various online sources.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Software Engineer \u2014 Data at Egen https://chaitanyak.me"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F7b714c47631a&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuild-knn-from-scratch-python-7b714c47631a&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuild-knn-from-scratch-python-7b714c47631a&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuild-knn-from-scratch-python-7b714c47631a&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuild-knn-from-scratch-python-7b714c47631a&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----7b714c47631a--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----7b714c47631a--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://chaitanya-kasaraneni.medium.com/?source=post_page-----7b714c47631a--------------------------------", "anchor_text": ""}, {"url": "https://chaitanya-kasaraneni.medium.com/?source=post_page-----7b714c47631a--------------------------------", "anchor_text": "Chaitanya Krishna Kasaraneni"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fcf4b0eb6b74a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuild-knn-from-scratch-python-7b714c47631a&user=Chaitanya+Krishna+Kasaraneni&userId=cf4b0eb6b74a&source=post_page-cf4b0eb6b74a----7b714c47631a---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F7b714c47631a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuild-knn-from-scratch-python-7b714c47631a&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F7b714c47631a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuild-knn-from-scratch-python-7b714c47631a&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://www.freepik.com/free-vector/apartment-building-with-people-open-window-spaces_7416533.htm#page=1&query=neighbors&position=2", "anchor_text": "Freepik"}, {"url": "https://github.com/chaitanyakasaraneni/knnFromScratch", "anchor_text": "GitHub"}, {"url": "https://github.com/chaitanyakasaraneni/simple-kNN", "anchor_text": "https://github.com/chaitanyakasaraneni/simple-kNN"}, {"url": "https://scikit-learn.org/stable/modules/cross_validation.html", "anchor_text": "sklearn documentation"}, {"url": "https://medium.com/datadriveninvestor/k-fold-and-other-cross-validation-techniques-6c03a2563f1e", "anchor_text": "here"}, {"url": "https://github.com/chaitanyakasaraneni/knnFromScratch", "anchor_text": "GitHub repository"}, {"url": "https://medium.com/tag/data-science?source=post_page-----7b714c47631a---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----7b714c47631a---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/k-nearest-neighbours?source=post_page-----7b714c47631a---------------k_nearest_neighbours-----------------", "anchor_text": "K Nearest Neighbours"}, {"url": "https://medium.com/tag/k-nearest-neighbors?source=post_page-----7b714c47631a---------------k_nearest_neighbors-----------------", "anchor_text": "K Nearest Neighbors"}, {"url": "https://medium.com/tag/k-fold?source=post_page-----7b714c47631a---------------k_fold-----------------", "anchor_text": "K Fold"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F7b714c47631a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuild-knn-from-scratch-python-7b714c47631a&user=Chaitanya+Krishna+Kasaraneni&userId=cf4b0eb6b74a&source=-----7b714c47631a---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F7b714c47631a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuild-knn-from-scratch-python-7b714c47631a&user=Chaitanya+Krishna+Kasaraneni&userId=cf4b0eb6b74a&source=-----7b714c47631a---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F7b714c47631a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuild-knn-from-scratch-python-7b714c47631a&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----7b714c47631a--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F7b714c47631a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuild-knn-from-scratch-python-7b714c47631a&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----7b714c47631a---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----7b714c47631a--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----7b714c47631a--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----7b714c47631a--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----7b714c47631a--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----7b714c47631a--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----7b714c47631a--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----7b714c47631a--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----7b714c47631a--------------------------------", "anchor_text": ""}, {"url": "https://chaitanya-kasaraneni.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://chaitanya-kasaraneni.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Chaitanya Krishna Kasaraneni"}, {"url": "https://chaitanya-kasaraneni.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "74 Followers"}, {"url": "https://chaitanyak.me", "anchor_text": "https://chaitanyak.me"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fcf4b0eb6b74a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuild-knn-from-scratch-python-7b714c47631a&user=Chaitanya+Krishna+Kasaraneni&userId=cf4b0eb6b74a&source=post_page-cf4b0eb6b74a--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F1f45fd9b6e7a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuild-knn-from-scratch-python-7b714c47631a&newsletterV3=cf4b0eb6b74a&newsletterV3Id=1f45fd9b6e7a&user=Chaitanya+Krishna+Kasaraneni&userId=cf4b0eb6b74a&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}