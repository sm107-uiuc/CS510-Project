{"url": "https://towardsdatascience.com/space-science-with-python-density-estimators-in-the-sky-87fbcfb089a6", "time": 1683010582.8014789, "path": "towardsdatascience.com/space-science-with-python-density-estimators-in-the-sky-87fbcfb089a6/", "webpage": {"metadata": {"title": "Space Science with Python \u2014 Density Estimators in the Sky | by Thomas Albin | Towards Data Science", "h1": "Space Science with Python \u2014 Density Estimators in the Sky", "description": "Last week was Asteroid Day! A day that was introduced to remind us that cosmic threats are real \u2026 not only for the Dinosaurs, but also in recent decades like the Tunguska event in 1908 or the Meteor\u2026"}, "outgoing_paragraph_urls": [{"url": "https://scikit-learn.org/stable/", "anchor_text": "scikit-learn", "paragraph_index": 4}, {"url": "https://numpy.org/", "anchor_text": "numpy", "paragraph_index": 6}, {"url": "https://pandas.pydata.org/", "anchor_text": "pandas", "paragraph_index": 6}, {"url": "https://tqdm.github.io/", "anchor_text": "tqdm", "paragraph_index": 6}, {"url": "https://matplotlib.org/", "anchor_text": "maptlotlib", "paragraph_index": 6}, {"url": "https://github.com/ThomasAlbin/SpaceScienceTutorial/tree/master/part17", "anchor_text": "GitHub repository", "paragraph_index": 6}, {"url": "https://numpy.org/doc/stable/reference/generated/numpy.radians.html", "anchor_text": "radians", "paragraph_index": 7}, {"url": "https://www.statsmodels.org/stable/index.html", "anchor_text": "statsmodels", "paragraph_index": 10}, {"url": "https://matplotlib.org/3.1.1/api/_as_gen/matplotlib.pyplot.imshow.html", "anchor_text": "imshow", "paragraph_index": 17}], "all_paragraphs": ["Last week was Asteroid Day! A day that was introduced to remind us that cosmic threats are real \u2026 not only for the Dinosaurs, but also in recent decades like the Tunguska event in 1908 or the Meteor of Chelyabinsk in the year 2013.", "Observation surveys, follow up measurements, simulations, and so on are required to catalogue and understand our very cosmic vicinity. Currently, there are no larger objects on a direct collision course with our blue planet. However, observational errors propagate through to data and do not allow us to determine the position of an object with 100 % accuracy. The error-bars depend on the number of observations, observational conditions, total observation time, the distance to the object, its movement and brightness and other factors. It is a multi-dimensional error that can only be faced with more and more and even more data.", "Luckily, 2020 JX1 is a \u201cgood\u201d asteroid and the error-bars during the recent fly-by were quite small (considering cosmic scales).", "But X, Y and Z coordinates do not help us at all \u2026 we need to set ecliptic, equatorial or azimuthal coordinates for our telescopes. Further, we have a solution space of Cartesian coordinates. How can we translate this solution space to a proper ecliptic coordinate system function? Let\u2019s find out!", "scikit-learn is a great resource for data science and machine learning algorithms. The library covers classifications, dimension reduction, as well as feature engineering and also clustering methods. The sophisticated documentation provides examples for miscellaneous use cases: One example covers the application of Kernel Density Estimators (KDEs) in spherical coordinates. Instead of the Euclidean metric, this example uses the so-called Haversine metric that is applied on the longitude and latitude values in radians:", "A KDE for ecliptic longitude and latitude coordinates appears suitable: Let\u2019s go.", "For this tutorial, we use the already introduced libraries numpy, pandas, tqdm and maptlotlib. We then load the data that were created last time (the file is also part of the GitHub repository).", "Now, we convert the ecliptic longitude and latitude values to radians, using the numpy function radians.", "There are several ways to determine the optimal bandwidth for KDEs: cross validation, Grid Search or by using a simple rule-of-thumb like Scott\u2019s rule. We take a look at Scott\u2019s rule that scales with the number of samples, but also with the standard deviation. We compute the standard deviation of the longitude and latitude values:", "The standard deviation of the longitude values is 50 % higher than for the latitude ones. Thus, the rule-of-thumb would result in 2 different bandwidths. Currently the scikit-learn KDE methods do not consider different bandwidths for different dimensions \u2026", "Are there other KDE implementations in Python? Luckily, yes! statsmodels provides several functions for statistics and statistical data exploration. The KDE section of statsmodels provides a multivariate version of a KDE:", "The bandwidth computation can be done via several rules-of-thumb or cross validation. However, there is currently no Haversine metric support implemented.", "Consequently both methods have their advantage and trade-offs:", "The user needs to determine its requirements and goals. Which trade-offs are acceptable? What does one need? These are difficult questions to answer and as a (data) scientist one has to document every decision and consideration.", "In our case, the spherical distortion should not affect our results severely. The data points are quite close to the ecliptic plane and the solution space is within a few arcminutes. We import the required statsmodels submodule in line 5, get the longitude and latitude values in line 8 and train the KDE model in line 11 to 13 using the the normal reference input.", "Do we get different bandwidth results for different bandwidth determination methods? Let\u2019s recompute the model with the cross validation (line 4) and print the results:", "Indeed, the resulting bandwidths for the longitude becomes smaller and the latitude one becomes larger! Both values are almost similar and one could consider the Haversine method from scikit-learn. Anyway, we stay with the normal reference solution.", "In a final step we would like to visualize the results in a plot. statsmodels provides a prediction function for our KDE model. But, we need a certain output format for the matplotlib function imshow. This function will allow us to visualise this 3 dimensional KDE (longitude, latitude plus probability density function (pdf)).", "The computation needs to be done in \u201clatitude slices\u201d. We iterate through the latitude solution space in a for-loop (line 8 following) and compute the pdf for the entire longitude solution space (line 15 to 19, computation in line 22). The final results are stored in a placeholder array (defined in line 4, stored in line 25). Finally, the array is converted to a numpy array (line 28). In line 31 we need to invert the resulting array, since we started with the minimum latitude value: however, matplotlib\u2019s imshow logic goes top-to-bottom.", "Now we can plot the pdf and the original longitude/latitude data points as a scatter plot. A dark mode is set in line 2 and the figure is defined in line 5. The scatter plot of the data points is generated in line 8 to 10 and the imshow function in line 14 to 19 plots the KDE based pdf. Finally, we set a grid (line 22) and get rid off the scientific notation (line 25 and 26). Labels are set (line 29 and 30) and the resulting plot is stored in line 33. Let\u2019s take a look:", "The figure shows the ecliptic latitude vs. the ecliptic longitude in degrees. The white dots represent the original data: They represent possible sky coordinates of the asteroid 2020 JX1 at midnight at the Asteroid Day 2020. The colour map in the background is the resulting KDE pdf. Brighter colours correspond to a higher appearance/detection probability than the darker areas. Thus, a follow-up telescope needs to cover this area of uncertainty at this particular time to detect the asteroid!", "Different KDE implementations have different advantages and disadvantages that were listed above. And although we did not consider the Haversine metric in our case, the resulting KDE pdf appears quite suitable. The discrete solution space scatter plot was transformed to an area of uncertainty. Within this area of uncertainty, a telescope operator needs to identify a moving object: our asteroid 2020 JX1! Considering the velocity vector of the asteroid, an apparent movement in the sky can be computed, too. But this task is left for you as a small programming assignment.", "Please note that the area of uncertainty is quite small. There are far worse cases where telescope operators and astronomers have to look for a needle in a haystack. And we are not talking about a few, but hundreds of objects. Continuous operations and scientific work are required, now and in the future, to keep us and our home planet safe from unwanted stellar visitors.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Scientist and Engineer. Astrophysicist and Solar System researcher \u2014 Now working in the automotive industry"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F87fbcfb089a6&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fspace-science-with-python-density-estimators-in-the-sky-87fbcfb089a6&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fspace-science-with-python-density-estimators-in-the-sky-87fbcfb089a6&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fspace-science-with-python-density-estimators-in-the-sky-87fbcfb089a6&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fspace-science-with-python-density-estimators-in-the-sky-87fbcfb089a6&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----87fbcfb089a6--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----87fbcfb089a6--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://thomas-albin.medium.com/?source=post_page-----87fbcfb089a6--------------------------------", "anchor_text": ""}, {"url": "https://thomas-albin.medium.com/?source=post_page-----87fbcfb089a6--------------------------------", "anchor_text": "Thomas Albin"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fe5af1ec51465&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fspace-science-with-python-density-estimators-in-the-sky-87fbcfb089a6&user=Thomas+Albin&userId=e5af1ec51465&source=post_page-e5af1ec51465----87fbcfb089a6---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F87fbcfb089a6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fspace-science-with-python-density-estimators-in-the-sky-87fbcfb089a6&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F87fbcfb089a6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fspace-science-with-python-density-estimators-in-the-sky-87fbcfb089a6&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://towardsdatascience.com/tagged/space-science-with-python", "anchor_text": "Space Science with Python"}, {"url": "https://towardsdatascience.com/tagged/space-science-with-python", "anchor_text": "tutorial series"}, {"url": "https://unsplash.com/@jeremyperkins?utm_source=medium&utm_medium=referral", "anchor_text": "Jeremy Perkins"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://towardsdatascience.com/space-science-with-python-uncertain-movements-of-an-asteroid-f651b94f7008", "anchor_text": "Space Science with Python \u2014 Uncertain Movements of an AsteroidPart 17 of the tutorial series. Today (30th June) is Asteroid Day and we will start to deep dive into the science of\u2026towardsdatascience.com"}, {"url": "https://towardsdatascience.com/space-science-with-python-space-maps-747c7d1eaf7f", "anchor_text": "Space Science with Python \u2014 Space mapsPart 5 of the tutorial series shows how to calculate and understand coordinate systems that are used for all upcoming\u2026towardsdatascience.com"}, {"url": "https://scikit-learn.org/stable/", "anchor_text": "scikit-learn"}, {"url": "https://scikit-learn.org/stable/auto_examples/neighbors/plot_species_kde.html", "anchor_text": "Kernel Density Estimate of Species Distributions - scikit-learn 0.23.1 documentationscikit-learn: machine learning in Pythonscikit-learn.org"}, {"url": "https://numpy.org/", "anchor_text": "numpy"}, {"url": "https://pandas.pydata.org/", "anchor_text": "pandas"}, {"url": "https://tqdm.github.io/", "anchor_text": "tqdm"}, {"url": "https://matplotlib.org/", "anchor_text": "maptlotlib"}, {"url": "https://github.com/ThomasAlbin/SpaceScienceTutorial/tree/master/part17", "anchor_text": "GitHub repository"}, {"url": "https://numpy.org/doc/stable/reference/generated/numpy.radians.html", "anchor_text": "radians"}, {"url": "https://www.statsmodels.org/stable/index.html", "anchor_text": "statsmodels"}, {"url": "https://www.statsmodels.org/stable/generated/statsmodels.nonparametric.kernel_density.KDEMultivariate.html", "anchor_text": "statsmodels.nonparametric.kernel_density.KDEMultivariate - statsmodelsEdit descriptionwww.statsmodels.org"}, {"url": "https://matplotlib.org/3.1.1/api/_as_gen/matplotlib.pyplot.imshow.html", "anchor_text": "imshow"}, {"url": "https://medium.com/tag/python?source=post_page-----87fbcfb089a6---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/space?source=post_page-----87fbcfb089a6---------------space-----------------", "anchor_text": "Space"}, {"url": "https://medium.com/tag/science?source=post_page-----87fbcfb089a6---------------science-----------------", "anchor_text": "Science"}, {"url": "https://medium.com/tag/data-science?source=post_page-----87fbcfb089a6---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/space-science-with-python?source=post_page-----87fbcfb089a6---------------space_science_with_python-----------------", "anchor_text": "Space Science With Python"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F87fbcfb089a6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fspace-science-with-python-density-estimators-in-the-sky-87fbcfb089a6&user=Thomas+Albin&userId=e5af1ec51465&source=-----87fbcfb089a6---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F87fbcfb089a6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fspace-science-with-python-density-estimators-in-the-sky-87fbcfb089a6&user=Thomas+Albin&userId=e5af1ec51465&source=-----87fbcfb089a6---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F87fbcfb089a6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fspace-science-with-python-density-estimators-in-the-sky-87fbcfb089a6&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----87fbcfb089a6--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F87fbcfb089a6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fspace-science-with-python-density-estimators-in-the-sky-87fbcfb089a6&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----87fbcfb089a6---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----87fbcfb089a6--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----87fbcfb089a6--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----87fbcfb089a6--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----87fbcfb089a6--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----87fbcfb089a6--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----87fbcfb089a6--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----87fbcfb089a6--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----87fbcfb089a6--------------------------------", "anchor_text": ""}, {"url": "https://thomas-albin.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://thomas-albin.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Thomas Albin"}, {"url": "https://thomas-albin.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "432 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fe5af1ec51465&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fspace-science-with-python-density-estimators-in-the-sky-87fbcfb089a6&user=Thomas+Albin&userId=e5af1ec51465&source=post_page-e5af1ec51465--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fe56e0e06b404&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fspace-science-with-python-density-estimators-in-the-sky-87fbcfb089a6&newsletterV3=e5af1ec51465&newsletterV3Id=e56e0e06b404&user=Thomas+Albin&userId=e5af1ec51465&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}