{"url": "https://towardsdatascience.com/selecting-optimal-parameters-for-xgboost-model-training-c7cd9ed5e45e", "time": 1682995370.782824, "path": "towardsdatascience.com/selecting-optimal-parameters-for-xgboost-model-training-c7cd9ed5e45e/", "webpage": {"metadata": {"title": "Selecting Optimal Parameters for XGBoost Model Training | by Andrej Baranovskij | Towards Data Science", "h1": "Selecting Optimal Parameters for XGBoost Model Training", "description": "Blog post which walks through the approach to select optimal parameters for XGBoost model training"}, "outgoing_paragraph_urls": [{"url": "https://raw.githubusercontent.com/jbrownlee/Datasets/master/pima-indians-diabetes.names", "anchor_text": "Pima Indians Diabetes Database", "paragraph_index": 1}, {"url": "https://raw.githubusercontent.com/jbrownlee/Datasets/master/pima-indians-diabetes.data.csv", "anchor_text": "here", "paragraph_index": 1}, {"url": "https://bit.ly/2I7VKhr", "anchor_text": "Jupyter Notebook \u2014 Forget CSV, fetch data from DB with Python", "paragraph_index": 15}, {"url": "https://machinelearningmastery.com/avoid-overfitting-by-early-stopping-with-xgboost-in-python/", "anchor_text": "Avoid Overfitting By Early Stopping With XGBoost In Python", "paragraph_index": 16}], "all_paragraphs": ["There is always a bit of luck involved when selecting parameters for Machine Learning model training. Lately, I work with gradient boosted trees and XGBoost in particular. We are using XGBoost in the enterprise to automate repetitive human tasks. While training ML models with XGBoost, I created a pattern to choose parameters, which helps me to build new models quicker. I will share it in this post, hopefully you will find it useful too.", "I\u2019m using Pima Indians Diabetes Database for the training, CSV data can be downloaded from here.", "This is the Python code which runs XGBoost training step and builds a model. Training is executed by passing pairs of train/test data, this helps to evaluate training quality ad-hoc during model construction:", "Key parameters in XGBoost(the ones which would affect model quality greatly), assuming you already selected max_depth (more complex classification task, deeper the tree), subsample (equal to evaluation data percentage), objective (classification algorithm):", "When model.fit is executed with verbose=True, you will see each training run evaluation quality printed out. At the end of the log, you should see which iteration was selected as the best one. It might be the number of training rounds is not enough to detect the best iteration, then XGBoost will select the last iteration to build the model.", "With matpotlib library we can plot training results for each run (from XGBoost output). This helps to understand if iteration which was chosen to build the model was the best one possible. Here we are using sklearn library to evaluate model accuracy and then plotting training results with matpotlib:", "Let\u2019s describe my approach to select parameters (n_estimators, learning_rate, early_stopping_rounds) for XGBoost training.", "Step 1. Start with what you feel works best based on your experience or what makes sense", "With the first attempt, we already get good results for Pima Indians Diabetes dataset. Training was stopped at iteration 237. Classification error plot shows a lower error rate around iteration 237. This means learning rate 0.01 is suitable for this dataset and early stopping of 10 iterations (if the result doesn\u2019t improve in the next 10 iterations) works.", "Step 2. Experiment with learning rate, try to set a smaller learning rate parameter and increase number of learning iterations", "Smaller learning rate wasn\u2019t working for this dataset. Classification error almost doesn\u2019t change and XGBoost log loss doesn\u2019t stabilize even with 500 iterations.", "Step 3. Try to increase the learning rate.", "With increased learning rate, the algorithm learns quicker, it stops already at iteration Nr. 27. XGBoost log loss error is stabilizing, but the overall classification accuracy is not ideal.", "Step 4. Select optimal learning rate from the first step and increase early stopping (to give the algorithm more chances to find a better result).", "A slightly better result is produced with 78.74% accuracy \u2014 this is visible in the classification error plot.", "Blog post \u2014 Jupyter Notebook \u2014 Forget CSV, fetch data from DB with Python", "Blog post \u2014 Avoid Overfitting By Early Stopping With XGBoost In Python", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fc7cd9ed5e45e&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fselecting-optimal-parameters-for-xgboost-model-training-c7cd9ed5e45e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fselecting-optimal-parameters-for-xgboost-model-training-c7cd9ed5e45e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fselecting-optimal-parameters-for-xgboost-model-training-c7cd9ed5e45e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fselecting-optimal-parameters-for-xgboost-model-training-c7cd9ed5e45e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----c7cd9ed5e45e--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----c7cd9ed5e45e--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://andrejusb.medium.com/?source=post_page-----c7cd9ed5e45e--------------------------------", "anchor_text": ""}, {"url": "https://andrejusb.medium.com/?source=post_page-----c7cd9ed5e45e--------------------------------", "anchor_text": "Andrej Baranovskij"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fbbd1211c851b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fselecting-optimal-parameters-for-xgboost-model-training-c7cd9ed5e45e&user=Andrej+Baranovskij&userId=bbd1211c851b&source=post_page-bbd1211c851b----c7cd9ed5e45e---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc7cd9ed5e45e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fselecting-optimal-parameters-for-xgboost-model-training-c7cd9ed5e45e&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc7cd9ed5e45e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fselecting-optimal-parameters-for-xgboost-model-training-c7cd9ed5e45e&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://raw.githubusercontent.com/jbrownlee/Datasets/master/pima-indians-diabetes.names", "anchor_text": "Pima Indians Diabetes Database"}, {"url": "https://raw.githubusercontent.com/jbrownlee/Datasets/master/pima-indians-diabetes.data.csv", "anchor_text": "here"}, {"url": "https://github.com/abaranovskis-redsamurai/automation-repo/blob/master/diabetes_redsamurai_db.ipynb", "anchor_text": "GitHub"}, {"url": "https://bit.ly/2I7VKhr", "anchor_text": "Jupyter Notebook \u2014 Forget CSV, fetch data from DB with Python"}, {"url": "https://machinelearningmastery.com/avoid-overfitting-by-early-stopping-with-xgboost-in-python/", "anchor_text": "Avoid Overfitting By Early Stopping With XGBoost In Python"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----c7cd9ed5e45e---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/xgboost?source=post_page-----c7cd9ed5e45e---------------xgboost-----------------", "anchor_text": "Xgboost"}, {"url": "https://medium.com/tag/python?source=post_page-----c7cd9ed5e45e---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/programming?source=post_page-----c7cd9ed5e45e---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fc7cd9ed5e45e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fselecting-optimal-parameters-for-xgboost-model-training-c7cd9ed5e45e&user=Andrej+Baranovskij&userId=bbd1211c851b&source=-----c7cd9ed5e45e---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fc7cd9ed5e45e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fselecting-optimal-parameters-for-xgboost-model-training-c7cd9ed5e45e&user=Andrej+Baranovskij&userId=bbd1211c851b&source=-----c7cd9ed5e45e---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc7cd9ed5e45e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fselecting-optimal-parameters-for-xgboost-model-training-c7cd9ed5e45e&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----c7cd9ed5e45e--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fc7cd9ed5e45e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fselecting-optimal-parameters-for-xgboost-model-training-c7cd9ed5e45e&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----c7cd9ed5e45e---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----c7cd9ed5e45e--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----c7cd9ed5e45e--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----c7cd9ed5e45e--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----c7cd9ed5e45e--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----c7cd9ed5e45e--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----c7cd9ed5e45e--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----c7cd9ed5e45e--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----c7cd9ed5e45e--------------------------------", "anchor_text": ""}, {"url": "https://andrejusb.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://andrejusb.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Andrej Baranovskij"}, {"url": "https://andrejusb.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "1.2K Followers"}, {"url": "https://github.com/katanaml", "anchor_text": "https://github.com/katanaml"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fbbd1211c851b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fselecting-optimal-parameters-for-xgboost-model-training-c7cd9ed5e45e&user=Andrej+Baranovskij&userId=bbd1211c851b&source=post_page-bbd1211c851b--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fd22cc5338107&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fselecting-optimal-parameters-for-xgboost-model-training-c7cd9ed5e45e&newsletterV3=bbd1211c851b&newsletterV3Id=d22cc5338107&user=Andrej+Baranovskij&userId=bbd1211c851b&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}