{"url": "https://towardsdatascience.com/machine-learning-guide-learning-by-doing-afe732afde39", "time": 1683006965.928811, "path": "towardsdatascience.com/machine-learning-guide-learning-by-doing-afe732afde39/", "webpage": {"metadata": {"title": "Machine Learning Guide\u2014 Learning by Doing | by Soner Y\u0131ld\u0131r\u0131m | Towards Data Science", "h1": "Machine Learning Guide\u2014 Learning by Doing", "description": "I strongly believe that an efficient way of learning how to do something is actually doing it. \u201cLearning by doing\u201d style also applies to machine learning. Ofcourse a comprehensive understanding of\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.kaggle.com/doaaalsenani/usa-cers-dataset", "anchor_text": "here", "paragraph_index": 2}, {"url": "http://linkedin.com/in/soneryildirim/", "anchor_text": "linkedin.com/in/soneryildirim/", "paragraph_index": 63}, {"url": "http://twitter.com/snr14", "anchor_text": "twitter.com/snr14", "paragraph_index": 63}], "all_paragraphs": ["I strongly believe that an efficient way of learning how to do something is actually doing it. \u201cLearning by doing\u201d style also applies to machine learning. Ofcourse a comprehensive understanding of the concepts and theory is needed but our machine learning skills will be inadequate without being able to implement actual models.", "In this post, I will walk you through the process of building a machine learning model starting from exploratory data analysis to finally reach model evaluation. This will be a simple model but it will definitely help you understand the concepts and procedures. I will try to explain each step in detail as well as providing the code.", "We will try to predict the prices of cars from auctions. The dataset is available here on kaggle. The main sections of the post are:", "Let\u2019s start with reading the dataset into a pandas dataframe and take a look at it:", "The dataset includes 13 features of 2499 cars. Some of the features are important when determining the price of a car while some are redundant. For example, \u201cvin\u201d, \u201clot\u201d and \u201cUnnamed: 0\u201d columns have no effect on the price. These three columns represent kind of an ID for a car. Since the dataset is taken from a website in US, I think the country column only includes \u201cusa\u201d. Let\u2019s check:", "Not all but overwhelming majority is \u201cusa\u201d so there is no point in using \u201ccountry\u201d column as a feature in our model. So the columns that we will not use in the model are:", "Let\u2019s drop these columns using drop function:", "We pass in two parameters in addition to a list of columns to be dropped. Axis=1 indicates we are dropping columns and inplace parameter is set to True to save the changes in the dataframe.", "Now the dataframe has less columns:", "We will build a supervised machine learning model to perform a regression task. Supervised learning means we have a target that we want to predict. Supervised learning can be grouped under two main categories:", "The price column is our target variable (dependent variable) and the other columns are features (independent variables) that we will use to predict the price.", "Let\u2019s also check if there is any missing value in our dataset:", "This dataset is pre-cleaned so it does not have any missing values but checking and handling missing values is a good practice to start with. In most cases, we will have missing values and should learn well how to detect and handle them. df.isna().sum() returns the number of missing values in each column. By adding one more summation, we can see the total number of missing values in the entire dataframe. The following is a detailed post on how to find and handle missing values:", "It is important to check the data types of columns and change if there are unsuitable datatypes.", "They seem fine. If the dataset has lots of observations (rows), we could use \u201ccategory\u201d datatype instead of object in order to reduce memory usage.", "I always start with checking the target variable. Target variable is what we struggle to predict. At the end of the way, we will evaluate the model based on how close our predictions are to the target. So knowing the target variable well is a good practice. Let\u2019s check the distribution of the target variable. We first need to import data visualization libraries that we will use during EDA process:", "The price variable is not normally distributed. It is right-skewed meaning the tail of the distribution is longer on the right side than on the left side. Another way to prove skewness is comparing mean and median. If mean is higher than the median, the distribution is right-skewed. Mean is the average value and median is the value in the middle. So if mean is higher than the median, we have more samples on the upper side of the median.", "Mean is higher than median, as expected. So, there are more of expensive cars than of cheaper cars.", "We have 8 features. Let\u2019s start with exloring the \u201cbrand\u201d feaute:", "There are 28 different brands but the first 6 categories contain most of the cars.", "Almost 94% of the cars belong to six brands. Remaining 6% are distributed among 22 different brands. We can mark these 22 brands as other. We first create a list that includes these 22 brands and then use pandas replace function on \u201cbrand\u201d column:", "Let\u2019s check if the operation was successful:", "It is a good practice to check your work as you go through. If you only check at the end, you may have hard time finding out the cause of errors.", "It is time to check if how price changes according to different brands. Boxplot is an informative tool for this task.", "The line in the boxes shows the average price. Ford cars have the highest average price but please keep in mind that almost half of the cars in the dataset are ford. It might be useful when building and evaluating our model. There are also some extreme values (i.e. outliers) represented with block dots. We will handle outliers later on. The height of the boxplots represent how spread out the values are. The dataset includes more dodge cars than chevrolet cars but price of chevrolet cars are more spread out than dodge cars. Variety of models might be causing this spread out. Let\u2019s check how many models each brand has:", "Although there are more dodge cars than chevrolet cars, number of models of chevrolet is more than double of dodge which I think explains the difference in price range. Let\u2019s again use boxplot to see price distribution depending on models:", "I chose dodge brand as example. As seen in the boxplot, price range significantly changes depending on model.", "There are 127 models in the entire dataset but 50 models cover almost 94% of cars so we can mark the remaining models as other.", "We have covered brand and model. Let\u2019s check the \u201ctitle_status\u201d column. It indicates whether a car is clean or salvage which is definitely a factor in determining the price. Let\u2019s confirm:", "We do not have many salvage cars but it is a must-have feature with the remarkable price difference.", "The \u201ccolor\u201d column is similar to \u201cbrand\u201d column in terms of number of categories they have.", "There are 49 different colors but 90% of cars belong to 6 different colors. We can mark the remaining colors as other like we did in \u201cbrand\u201d column.", "Let\u2019s see which colors we have now:", "Average prices are close. It is a good practice to also check for extreme values (i.e. outliers).", "The image above tells us two important things:", "We have some cars that have extremely high prices. These outliers are not grouped in a particular color. From the figure above, it seems like all of the outliers are above 45000. Let\u2019s check how many outliers we have and decide if we can afford to drop them:", "There are 102 cars above 45000 which makes up 4% of entire dataset. I think we can drop these samples. In some cases, 4% is too much to drop so it is up to you how to mark and handle outliers. There is not a strict definition of outliers.", "Year and mileage definitely changes the price of car so we will use these features in the model. I prefer to convert the \u201cyear\u201d column to \u201cage\u201d by substracting it from the current year:", "Condition indicates time to the end of auction which I think may increase the demand and thus the price. However, we cannot use it in its current format. We should represent it with a proper data type which is integer showing number of minutes.", "There are many way to do this task. Feel free to try different methods. I will do it as follows:", "Note: There are some rows in condition column with \u201cListing Expired\u201d. For those rows, I will replace \u201cExpired\u201d with zero and \u201cListing\u201d with one so that the remaining time becomes zero.", "Another useful tool in EDA process is correlation matrix which can be used to find the correlations among continuous features. The corr() method can be applied on dataframe and the results can also be visualized using a heatmap:", "It seems like price is not correlated with time_left but there is significant negative correlation between price and age or mileage. This is expected because older cars are cheaper.", "We have explored the dataset as well as clean some of part it. But, we are not done yet.", "We have categorical features such as brand and color. These features need to represented in a format that a model can process. We cannot just input strings in a model. We first need to convert the categories into numbers (Label Encoding). If a categorical variable is not ordinal (i.e. there is not a hierarchical order in them), it is not enough to just do label encoding. We need to represent the categories with binary columns. This can be done using \u201cdummy\u201d or \u201cone hot\u201d encoding. For example, we may \u201cDodge\u201d label as 3 and \u201cGMC\u201d as 1. If we just do label encoding on not ordinal categorical variables, a model would think category 3 is somewhat more important than category 1 which is not true. One Hot Encoding represents each category as a column which only take two values, 1 and 0. For a car with \u201cDodge\u201d brand, only the value in \u201cDodge\u201d column becomes 1 and other columns are 0. In this way, we make sure there is not a hierarchy among categories.", "We also need to normalize the numerical data so that the values are in the same range. Otherwise, the model might give more importance to the higher values. For example, the values in mileage column are much higher than the values in age column. We can normalize these values in the range of [0,1] so that the maximum values for each column becomes 1 and the minimum becomes zero.", "Since the categorical variables in our dataset are not ordinal, label encoding is not enough. Therefore, we can directly apply pandas get_dummies function to do represent categorical variables with columns assigned to each category.", "We can do the normalization manually with a few simple math operations but I prefer to use MinMaxScaler() function of scikit-learn.", "As we can see, all of the values are between 0 and 1.", "After the preprocessing is done, we can combine categorical and numerical features. The next step is to separate independent variables and target (dependent) variable.", "We have 60 independent variables and a target variable.", "In predictive analytics, we build machine learning models to make predictions on new, previously unseen samples. The whole purpose is to be able to predict the unknown. But the models cannot just make predictions out of the blue. We show some samples to the model and train it. Then we expect the model to make predictions on samples from the same distribution. In order to train the model and then test it, we need to divide the dataset into two subsets. One is training and the other one is test.", "The separation of training and test set can easily be done using train_test_split function of scikit-learn.", "We will use 80% of data in training and remaining 20% to test the model.", "I will implement two different models.", "R-squared is a regression score function. It measures how much of the variation in the target variables is explained by the independent variables. The closer the R-squared value is to 1, the better the performance of model. R-squared scores of training and test sets are very close so the model is not overfitting. It seems like regularization works well. However, the performance of the model in terms of prediction power is not good enough because R-squared scores are not close to 1.", "As the results show, there is significant increase in R-squared score.", "There is a slight difference between the values of training and test sets but I think this is acceptable with the data we have. We can create a model that has an R-squared value very close to 1 on training set but the performance on test set will be very low.", "The main reason is the limited data. For complex models, we normally need lots of data to build a decent and robust model. The categorical variables in the dataset have many categories but not enough data for each category. Therefore, the first thing we should do to improve the model is to look for more data.", "Another way to improve the performance is hyperparameter tuning. Hyperparameters define the properties of a model that we can adjust. For example, I tried different values for the following hyperparameters of gradient boosting regressor:", "There is no strict rule to determine optimum values for these parameters. We need to find the right balance. Feel free to try different values for these parameters and see how the performance changes. Please do not limit yourself to what we did in exploratory data anaysis section. You can always dig deeper to explore the dataset to find out the correlations and underlying structure of data.", "Thank you for reading. Please let me know if you have any feedback.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Scientist | Top 10 Writer in AI and Data Science | linkedin.com/in/soneryildirim/ | twitter.com/snr14"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fafe732afde39&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-guide-learning-by-doing-afe732afde39&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-guide-learning-by-doing-afe732afde39&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-guide-learning-by-doing-afe732afde39&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-guide-learning-by-doing-afe732afde39&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----afe732afde39--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----afe732afde39--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://sonery.medium.com/?source=post_page-----afe732afde39--------------------------------", "anchor_text": ""}, {"url": "https://sonery.medium.com/?source=post_page-----afe732afde39--------------------------------", "anchor_text": "Soner Y\u0131ld\u0131r\u0131m"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F2cf6b549448&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-guide-learning-by-doing-afe732afde39&user=Soner+Y%C4%B1ld%C4%B1r%C4%B1m&userId=2cf6b549448&source=post_page-2cf6b549448----afe732afde39---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fafe732afde39&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-guide-learning-by-doing-afe732afde39&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fafe732afde39&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-guide-learning-by-doing-afe732afde39&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@roadtripwithraj?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Road Trip with Raj"}, {"url": "https://unsplash.com/s/photos/learning?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://www.kaggle.com/doaaalsenani/usa-cers-dataset", "anchor_text": "here"}, {"url": "https://towardsdatascience.com/handling-missing-values-with-pandas-b876bf6f008f", "anchor_text": "Handling Missing Values with PandasA complete tutorial on how to detect and handle missing valuestowardsdatascience.com"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----afe732afde39---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----afe732afde39---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/data-science?source=post_page-----afe732afde39---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/programming?source=post_page-----afe732afde39---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fafe732afde39&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-guide-learning-by-doing-afe732afde39&user=Soner+Y%C4%B1ld%C4%B1r%C4%B1m&userId=2cf6b549448&source=-----afe732afde39---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fafe732afde39&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-guide-learning-by-doing-afe732afde39&user=Soner+Y%C4%B1ld%C4%B1r%C4%B1m&userId=2cf6b549448&source=-----afe732afde39---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fafe732afde39&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-guide-learning-by-doing-afe732afde39&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----afe732afde39--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fafe732afde39&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-guide-learning-by-doing-afe732afde39&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----afe732afde39---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----afe732afde39--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----afe732afde39--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----afe732afde39--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----afe732afde39--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----afe732afde39--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----afe732afde39--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----afe732afde39--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----afe732afde39--------------------------------", "anchor_text": ""}, {"url": "https://sonery.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://sonery.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Soner Y\u0131ld\u0131r\u0131m"}, {"url": "https://sonery.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "21K Followers"}, {"url": "http://linkedin.com/in/soneryildirim/", "anchor_text": "linkedin.com/in/soneryildirim/"}, {"url": "http://twitter.com/snr14", "anchor_text": "twitter.com/snr14"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F2cf6b549448&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-guide-learning-by-doing-afe732afde39&user=Soner+Y%C4%B1ld%C4%B1r%C4%B1m&userId=2cf6b549448&source=post_page-2cf6b549448--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F7cdf5377373a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-guide-learning-by-doing-afe732afde39&newsletterV3=2cf6b549448&newsletterV3Id=7cdf5377373a&user=Soner+Y%C4%B1ld%C4%B1r%C4%B1m&userId=2cf6b549448&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}