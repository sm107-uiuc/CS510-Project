{"url": "https://towardsdatascience.com/clustering-metrics-better-than-the-elbow-method-6926e1f723a6", "time": 1683000267.43761, "path": "towardsdatascience.com/clustering-metrics-better-than-the-elbow-method-6926e1f723a6/", "webpage": {"metadata": {"title": "Clustering metrics better than the elbow-method | by Tirthajyoti Sarkar | Towards Data Science", "h1": "Clustering metrics better than the elbow-method", "description": "What metric to use for visualizing and determining an optimal number of clusters much better than the usual practice \u2014 elbow method."}, "outgoing_paragraph_urls": [{"url": "https://medium.com/machine-learning-for-humans/unsupervised-learning-f45587588294", "anchor_text": "unsupervised machine learning", "paragraph_index": 1}, {"url": "https://towardsdatascience.com/understanding-k-means-clustering-in-machine-learning-6a6e67336aa1", "anchor_text": "k-means clustering", "paragraph_index": 3}, {"url": "https://bl.ocks.org/rpgove/0060ff3b656618e9136b", "anchor_text": "elbow method", "paragraph_index": 7}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.cluster.KMeans.html", "anchor_text": "k-means estimator", "paragraph_index": 11}, {"url": "https://en.wikipedia.org/wiki/Silhouette_(clustering)", "anchor_text": "Silhouette Coefficient", "paragraph_index": 14}, {"url": "https://en.wikipedia.org/wiki/Bayesian_information_criterion", "anchor_text": "Bayesian Information Criterion", "paragraph_index": 25}, {"url": "https://www.geeksforgeeks.org/ml-expectation-maximization-algorithm/", "anchor_text": "Expectation-Maximization (EM) algorithm", "paragraph_index": 26}, {"url": "https://github.com/tirthajyoti/Machine-Learning-with-Python/blob/master/Clustering-Dimensionality-Reduction/Clustering_metrics.ipynb", "anchor_text": "Here is the Jupyter notebook", "paragraph_index": 34}, {"url": "https://github.com/tirthajyoti?tab=repositories", "anchor_text": "GitHub", "paragraph_index": 37}, {"url": "https://www.linkedin.com/in/tirthajyoti-sarkar-2127aa7/", "anchor_text": "add me on LinkedIn", "paragraph_index": 37}, {"url": "https://twitter.com/tirthajyotiS", "anchor_text": "follow me on Twitter.", "paragraph_index": 37}], "all_paragraphs": ["Clustering is an important part of the machine learning pipeline for business or scientific enterprises utilizing data science. As the name suggests, it helps to identify congregations of closely related (by some measure of distance) data points in a blob of data, which, otherwise, would be difficult to make sense of.", "However, mostly, the process of clustering falls under the realm of unsupervised machine learning. And unsupervised ML is a messy business.", "There is no known answers or labels to guide the optimization process or measure our success against. We are in the uncharted territory.", "It is, therefore, no surprise, that a popular method like k-means clustering does not seem to provide a completely satisfactory answer when we ask the basic question:", "\u201cHow would we know the actual number of clusters, to begin with?\u201d", "This question is critically important because of the fact that the process of clustering is often a precursor to further processing of the individual cluster data and therefore, the amount of computational resource may depend on this measurement.", "In the case of a business analytics problem, repercussion could be worse. Clustering is often done for such analytics with the goal of market segmentation. It is, therefore, easily conceivable that, depending on the number of clusters, appropriate marketing personnel will be allocated to the problem. Consequently, a wrong assessment of the number of clusters can lead to sub-optimum allocation of precious resources.", "For the k-means clustering method, the most common approach for answering this question is the so-called elbow method. It involves running the algorithm multiple times over a loop, with an increasing number of cluster choice and then plotting a clustering score as a function of the number of clusters.", "What is the score or metric which is being plotted for the elbow method? Why is it called the \u2018elbow\u2019 method?", "A typical plot looks like following,", "The score is, in general, a measure of the input data on the k-means objective function i.e. some form of intra-cluster distance relative to inner-cluster distance.", "For example, in Scikit-learn\u2019s k-means estimator, a score method is readily available for this purpose.", "But look at the plot again. It can get confusing sometimes. Is it 4, 5, or 6, that we should take as the optimal number of clusters here?", "Not so obvious always, is it?", "The Silhouette Coefficient is calculated using the mean intra-cluster distance (a) and the mean nearest-cluster distance (b) for each sample. The Silhouette Coefficient for a sample is (b - a) / max(a, b). To clarify, b is the distance between a sample and the nearest cluster that the sample is not a part of. We can compute the mean Silhouette Coefficient over all samples and use this as a metric to judge the number of clusters.", "Here is a video from Orange on this topic,", "For illustration, we generated random data points using Scikit-learn\u2019s make_blob function over 4 feature dimensions and 5 cluster centers. So, the ground truth of the problem is that the data is generated around 5 cluster centers. However, the k-means algorithm has no way of knowing this.", "The clusters can be plotted (pairwise features) as follows,", "Next, we run k-means algorithm with a choice of k=2 to k=12 and calculate the default k-means score and the mean silhouette coefficient for each run and plot them side by side.", "The difference could not be starker. The mean silhouette coefficient increases up to the point when k=5 and then sharply decreases for higher values of k i.e. it exhibits a clear peak at k=5, which is the number of clusters the original dataset was generated with.", "Silhouette coefficient exhibits a peak characteristic as compared to the gentle bend in the elbow method. This is easier to visualize and reason with.", "If we increase the Gaussian noise in the data generation process, the clusters look more overlapped.", "In this case, the default k-means score with elbow method produces even more ambiguous result. In the elbow plot below, it is difficult to pick a suitable point where the real bend occurs. Is it 4, 5, 6, or 7?", "But the silhouette coefficient plot still manages to maintain a peak characteristic around 4 or 5 cluster centers and make our life easier.", "In fact, if you look back at the overlapped clusters, you will see that mostly there are 4 clusters visible \u2014 although the data was generated using 5 cluster centers, due to high variance, only 4 clusters are structurally showing up. Silhouette coefficient picks up this behavior easily and shows the optimal number of clusters somewhere between 4 and 5.", "There are other excellent metrics for determining the true count of the clusters such as Bayesian Information Criterion (BIC) but they can be applied only if we are willing to extend the clustering algorithm beyond k-means to the more generalized version \u2014 Gaussian Mixture Model (GMM).", "Basically, a GMM treats a blob of data as a superimposition of multiple Gaussian datasets with separate mean and variances. Then it applies the Expectation-Maximization (EM) algorithm to determine these mean and variances approximately.", "You may recognize the term BIC from statistical analysis or your previous interaction with linear regression. BIC and AIC (Akaike Information Criterion) are used as regularization techniques in linear regression for the variable selection process.", "BIC/AIC is used for regularization of linear regression model.", "The idea is applied in a similar manner here for BIC. In theory, extremely complex clusters of data can also be modeled as a superimposition of a large number of Gaussian datasets. There is no restriction on how many Gaussians to use for this purpose.", "But this is similar to increasing model complexity in linear regression, where a large number of features can be used to fit any arbitrarily complex data, only to lose the generalization power, as the overly complex model fits the noise instead of the true pattern.", "The BIC method penalizes a large number of Gaussians and tries to keep the model simple enough to explain the given data pattern.", "The BIC method penalizes a large number of Gaussians i.e. an overly complex model.", "Consequently, we can run the GMM algorithm for a range of cluster centers, and the BIC score will increase up to a point, but after that will start decreasing as the penalty term grows.", "Here is the Jupyter notebook for this article. Feel free to fork and play with it.", "We discussed a couple of alternative options to the often-used elbow method for picking up the right number of clusters in an unsupervised learning setting using the k-means algorithm.", "We showed that Silhouette coefficient and BIC score (from the GMM extension of k-means) are better alternatives to the elbow method for visually discerning the optimal number of clusters.", "If you have any questions or ideas to share, please contact the author at tirthajyoti[AT]gmail.com. Also, you can check the author\u2019s GitHub repositories for other fun code snippets in Python, R, and machine learning resources. If you are, like me, passionate about machine learning/data science, please feel free to add me on LinkedIn or follow me on Twitter.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Sr. Director of AI/ML platform | Stories on Artificial Intelligence, Data Science, and ML | Speaker, Open-source contributor, Author of multiple DS books"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F6926e1f723a6&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fclustering-metrics-better-than-the-elbow-method-6926e1f723a6&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fclustering-metrics-better-than-the-elbow-method-6926e1f723a6&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fclustering-metrics-better-than-the-elbow-method-6926e1f723a6&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fclustering-metrics-better-than-the-elbow-method-6926e1f723a6&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----6926e1f723a6--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----6926e1f723a6--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@tirthajyoti?source=post_page-----6926e1f723a6--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@tirthajyoti?source=post_page-----6926e1f723a6--------------------------------", "anchor_text": "Tirthajyoti Sarkar"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fcb9d97d4b61a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fclustering-metrics-better-than-the-elbow-method-6926e1f723a6&user=Tirthajyoti+Sarkar&userId=cb9d97d4b61a&source=post_page-cb9d97d4b61a----6926e1f723a6---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F6926e1f723a6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fclustering-metrics-better-than-the-elbow-method-6926e1f723a6&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F6926e1f723a6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fclustering-metrics-better-than-the-elbow-method-6926e1f723a6&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://medium.com/machine-learning-for-humans/unsupervised-learning-f45587588294", "anchor_text": "unsupervised machine learning"}, {"url": "https://medium.com/machine-learning-for-humans/unsupervised-learning-f45587588294", "anchor_text": "Machine Learning for Humans, Part 3: Unsupervised LearningClustering and dimensionality reduction: k-means clustering, hierarchical clustering, PCA, SVD.medium.com"}, {"url": "https://towardsdatascience.com/understanding-k-means-clustering-in-machine-learning-6a6e67336aa1", "anchor_text": "k-means clustering"}, {"url": "https://www.singlegrain.com/digital-marketing/strategists-guide-marketing-segmentation/", "anchor_text": "https://www.singlegrain.com/digital-marketing/strategists-guide-marketing-segmentation/"}, {"url": "https://bl.ocks.org/rpgove/0060ff3b656618e9136b", "anchor_text": "elbow method"}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.cluster.KMeans.html", "anchor_text": "k-means estimator"}, {"url": "https://en.wikipedia.org/wiki/Silhouette_(clustering)", "anchor_text": "Silhouette Coefficient"}, {"url": "https://en.wikipedia.org/wiki/Bayesian_information_criterion", "anchor_text": "Bayesian Information Criterion"}, {"url": "https://www.geeksforgeeks.org/ml-expectation-maximization-algorithm/", "anchor_text": "Expectation-Maximization (EM) algorithm"}, {"url": "https://towardsdatascience.com/gaussian-mixture-models-explained-6986aaf5a95", "anchor_text": "Gaussian Mixture Models ExplainedIn the world of Machine Learning, we can distinguish two main areas: Supervised and unsupervised learning. The main\u2026towardsdatascience.com"}, {"url": "https://github.com/tirthajyoti/Machine-Learning-with-Python/blob/master/Clustering-Dimensionality-Reduction/Clustering_metrics.ipynb", "anchor_text": "Here is the Jupyter notebook"}, {"url": "https://github.com/tirthajyoti?tab=repositories", "anchor_text": "GitHub"}, {"url": "https://www.linkedin.com/in/tirthajyoti-sarkar-2127aa7/", "anchor_text": "add me on LinkedIn"}, {"url": "https://twitter.com/tirthajyotiS", "anchor_text": "follow me on Twitter."}, {"url": "https://www.linkedin.com/in/tirthajyoti-sarkar-2127aa7/", "anchor_text": "Tirthajyoti Sarkar - Sr. Principal Engineer - Semiconductor, AI, Machine Learning - ON\u2026Making data science/ML concepts easy to understand through writing: https://medium.com/@tirthajyoti Open-source and fun\u2026www.linkedin.com"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----6926e1f723a6---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----6926e1f723a6---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/technology?source=post_page-----6926e1f723a6---------------technology-----------------", "anchor_text": "Technology"}, {"url": "https://medium.com/tag/programming?source=post_page-----6926e1f723a6---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----6926e1f723a6---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F6926e1f723a6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fclustering-metrics-better-than-the-elbow-method-6926e1f723a6&user=Tirthajyoti+Sarkar&userId=cb9d97d4b61a&source=-----6926e1f723a6---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F6926e1f723a6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fclustering-metrics-better-than-the-elbow-method-6926e1f723a6&user=Tirthajyoti+Sarkar&userId=cb9d97d4b61a&source=-----6926e1f723a6---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F6926e1f723a6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fclustering-metrics-better-than-the-elbow-method-6926e1f723a6&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----6926e1f723a6--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F6926e1f723a6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fclustering-metrics-better-than-the-elbow-method-6926e1f723a6&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----6926e1f723a6---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----6926e1f723a6--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----6926e1f723a6--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----6926e1f723a6--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----6926e1f723a6--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----6926e1f723a6--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----6926e1f723a6--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----6926e1f723a6--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----6926e1f723a6--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@tirthajyoti?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@tirthajyoti?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Tirthajyoti Sarkar"}, {"url": "https://medium.com/@tirthajyoti/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "12.5K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fcb9d97d4b61a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fclustering-metrics-better-than-the-elbow-method-6926e1f723a6&user=Tirthajyoti+Sarkar&userId=cb9d97d4b61a&source=post_page-cb9d97d4b61a--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fb285331282ca&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fclustering-metrics-better-than-the-elbow-method-6926e1f723a6&newsletterV3=cb9d97d4b61a&newsletterV3Id=b285331282ca&user=Tirthajyoti+Sarkar&userId=cb9d97d4b61a&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}