{"url": "https://towardsdatascience.com/rethinking-the-autonomous-agent-a-q-learning-behavior-system-8839a07c10b6", "time": 1682994117.906208, "path": "towardsdatascience.com/rethinking-the-autonomous-agent-a-q-learning-behavior-system-8839a07c10b6/", "webpage": {"metadata": {"title": "Rethinking the Autonomous Agent. This essay introduces a Q learning\u2026 | by Aaron Krumins | Towards Data Science", "h1": "Rethinking the Autonomous Agent", "description": "This essay introduces a Q learning based behavior system for embodied agents including robots and video game characters. Most recent reinforcement learning(RL) success stories have focused on\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.unrealengine.com/marketplace/artificial-intelligence-emotions", "anchor_text": "Autonomous Emotions Toolkit", "paragraph_index": 2}, {"url": "https://medium.com/datadriveninvestor/reinforcement-learning-towards-an-emotion-based-behavior-system-73e833c1ba75", "anchor_text": "elsewhere", "paragraph_index": 2}, {"url": "https://www.unrealengine.com/marketplace/artificial-intelligence-q-learning", "anchor_text": "project files", "paragraph_index": 2}, {"url": "https://www.sciencedirect.com/science/article/abs/pii/S0376635714003027", "anchor_text": "examples of animal behavior", "paragraph_index": 12}], "all_paragraphs": ["This essay introduces a Q learning based behavior system for embodied agents including robots and video game characters.", "Most recent reinforcement learning(RL) success stories have focused on achieving superhuman levels of performance in some virtual task \u2014 be it a video game or a test of robotic control. A separate and less sensational branch of reinforcement learning is what could be called normative reinforcement learning, and seeks to mimic subjective notions of human or animal behavior. Here the goal is not to optimize towards an arbitrary level of perfection but rather to replicate something that is \u201chuman-like\u201d or \u201canimal-like\u201d. While this approach has yet to garner the same headlines as other examples of RL, it will undoubtedly generate many of the important use cases of the future. Consider the advent of open world video games that demand high fidelity representations of human and animal behavior, or the case of elderly care robots where superhuman levels of performance might actually feel alien and disorientating.", "In this essay I introduce a behavior system for embodied agents using the popular Q learning algorithm and aimed at normative reinforcement learning. While geared to game engines, the intuition can be extended to other platforms and will hopefully inspire a variety of use cases. Q-learning is also the foundation for more advanced systems of intelligent behavior such as those found in the Autonomous Emotions Toolkit which I have written about elsewhere. While in this article I will take a high level walk through of the behavior system, those wishing a more in depth treatment can obtain the download the project files for the behavior system with an accompanying tutorial.", "Q learning is one of many reinforcement learning techniques and has a number of advantages over similar algorithms \u2014 namely it is simple and robust. A very cursory introduction to Q learning follows. Q learning can be broken up into a training phase and exploitation phase of activity. During the training phase the agent explores its environment, taking random actions. During this time it populates a table, called the Q table, with value associations regarding the actions it has taken and the rewards it has received. This then becomes the basis for how the agent chooses to make decisions in the exploitation phase of its activity. Actions that led to rewards get repeated in the exploitation phase. Rewards can also take negative values if one wishes the agent to avoid some action. Thus Q learning supplies both a stick and a carrot to drive character behavior in a manner consistent with how humans and many other animals learn. It can be used to replace or supplement the utility based calculations that previously endowed artificial agents with dynamic lifelike behavior.", "In the behavior system presented, I make use of use of Q learning and it\u2019s tables to drive learning in a synthetic agent or NPC (Non Player Character). The Q learning algorithm is basically a method for backward induction, allowing the agent to redistribute reward information backwards in time across the states and actions that got it to the desired location. A reward requiring an arbitrary long series of actions can thus be parceled out along preceding states that the agent took to get there. When this process is repeated enough times, like cream rising to the surface, the agent learns which actions and environmental cues were instrumental in getting to the reward and which were not.", "The Q learning equation is given below, where state and action pairs refer to coordinates within the Q table and Rewards table respectively and gamma is a fixed discount rate between 0 and 1. Gamma controls how much the agent values present rewards vs. future ones.", "In the behavior system presented, Q learning is used solve a match to sample task in which the NPC learns that it must activate a switch within the game environment at the same time that a light is on in order to receive a \u201cfood reward\u201d. The match to sample task has been used in a wide variety of animal learning experiments that explore associative learning and working memory.", "An example of a real match to sample task carried out on primates. Image Citation: Porrino LJ, Daunais JB, Rogers GA, Hampson RE, Deadwyler SA (2005) Facilitation of Task Performance and Removal of the Effects of Sleep Deprivation by an Ampakine (CX717) in Nonhuman Primates. PLoS Biol 3(9): e299.", "The key point is that the agent must learn to predict that it can take an action to receive a reward only during specific circumstance. In the match to sample task on which Q learning behavior system is tested, the agent learns that it can receive a reward when a light is on and it first touches a switch and then proceeds to the gold food bowl. The same action taken when the green light is off will not generate the reward.", "The setup for the task begins with a training phase in which the agent randomly travels between four locations, 3 food bowls and one switch, represented by balls and a cone respectively. During training period, it learns associations about the values of each of these elements, how they are affected by the light that periodically turns on and off, and its own actions.", "Screen grab from the Q learning Behavior System as the agent learns to solve the match to sample task.", "After exploring long enough, the agent will display intentional behavior by first going to the switch (cone) and then going to the food bowl when the light is on in order to receive rewards. The same system can be used to provide a wide variety of intentional behaviors, including avoiding enemy players, collecting health points, and many of the behaviors a human or animal is capable of manifesting within a game environment. In a modified version of this example, the agent learns to approach the player\u2019s character for \u201cfood rewards\u201d the same way a dog or cat might learn to approach a human master for a treat.", "Unlike other reinforcement learning tasks, this one can be calibrated to produce results that mimic real world cognitive agents. Adding a simple learning rate to the Q-algorithm, one can produce learning curves that mimic those of animal test subjects. Thus the match to sample task provides a way to fine tune an agents \u201cbrain\u201d and produce normative results that are consistent with many examples of animal behavior under similar conditions.", "Aaron Krumins is a freelance developer of AI related software.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Aaron Krumins is the author of \u201cOutsmarted \u2014 The Promise and Peril of Reinforcement Learning\u201d and currently works as a freelance machine learning consultant"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F8839a07c10b6&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frethinking-the-autonomous-agent-a-q-learning-behavior-system-8839a07c10b6&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frethinking-the-autonomous-agent-a-q-learning-behavior-system-8839a07c10b6&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frethinking-the-autonomous-agent-a-q-learning-behavior-system-8839a07c10b6&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frethinking-the-autonomous-agent-a-q-learning-behavior-system-8839a07c10b6&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----8839a07c10b6--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----8839a07c10b6--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://aaron-krumins.medium.com/?source=post_page-----8839a07c10b6--------------------------------", "anchor_text": ""}, {"url": "https://aaron-krumins.medium.com/?source=post_page-----8839a07c10b6--------------------------------", "anchor_text": "Aaron Krumins"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F700bb1fd579c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frethinking-the-autonomous-agent-a-q-learning-behavior-system-8839a07c10b6&user=Aaron+Krumins&userId=700bb1fd579c&source=post_page-700bb1fd579c----8839a07c10b6---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F8839a07c10b6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frethinking-the-autonomous-agent-a-q-learning-behavior-system-8839a07c10b6&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F8839a07c10b6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frethinking-the-autonomous-agent-a-q-learning-behavior-system-8839a07c10b6&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://www.flickr.com/photos/ekilby/", "anchor_text": "Eric Kilby"}, {"url": "https://www.unrealengine.com/marketplace/artificial-intelligence-emotions", "anchor_text": "Autonomous Emotions Toolkit"}, {"url": "https://medium.com/datadriveninvestor/reinforcement-learning-towards-an-emotion-based-behavior-system-73e833c1ba75", "anchor_text": "elsewhere"}, {"url": "https://www.unrealengine.com/marketplace/artificial-intelligence-q-learning", "anchor_text": "project files"}, {"url": "https://www.sciencedirect.com/science/article/abs/pii/S0376635714003027", "anchor_text": "examples of animal behavior"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----8839a07c10b6---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----8839a07c10b6---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/reinforcement-learning?source=post_page-----8839a07c10b6---------------reinforcement_learning-----------------", "anchor_text": "Reinforcement Learning"}, {"url": "https://medium.com/tag/q-learning?source=post_page-----8839a07c10b6---------------q_learning-----------------", "anchor_text": "Q Learning"}, {"url": "https://medium.com/tag/game-development?source=post_page-----8839a07c10b6---------------game_development-----------------", "anchor_text": "Game Development"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F8839a07c10b6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frethinking-the-autonomous-agent-a-q-learning-behavior-system-8839a07c10b6&user=Aaron+Krumins&userId=700bb1fd579c&source=-----8839a07c10b6---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F8839a07c10b6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frethinking-the-autonomous-agent-a-q-learning-behavior-system-8839a07c10b6&user=Aaron+Krumins&userId=700bb1fd579c&source=-----8839a07c10b6---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F8839a07c10b6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frethinking-the-autonomous-agent-a-q-learning-behavior-system-8839a07c10b6&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----8839a07c10b6--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F8839a07c10b6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frethinking-the-autonomous-agent-a-q-learning-behavior-system-8839a07c10b6&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----8839a07c10b6---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----8839a07c10b6--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----8839a07c10b6--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----8839a07c10b6--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----8839a07c10b6--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----8839a07c10b6--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----8839a07c10b6--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----8839a07c10b6--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----8839a07c10b6--------------------------------", "anchor_text": ""}, {"url": "https://aaron-krumins.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://aaron-krumins.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Aaron Krumins"}, {"url": "https://aaron-krumins.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "176 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F700bb1fd579c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frethinking-the-autonomous-agent-a-q-learning-behavior-system-8839a07c10b6&user=Aaron+Krumins&userId=700bb1fd579c&source=post_page-700bb1fd579c--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F2b84a10369ed&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frethinking-the-autonomous-agent-a-q-learning-behavior-system-8839a07c10b6&newsletterV3=700bb1fd579c&newsletterV3Id=2b84a10369ed&user=Aaron+Krumins&userId=700bb1fd579c&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}