{"url": "https://towardsdatascience.com/explain-nlp-models-with-lime-shap-5c5a9f84d59b", "time": 1682996957.413771, "path": "towardsdatascience.com/explain-nlp-models-with-lime-shap-5c5a9f84d59b/", "webpage": {"metadata": {"title": "Explain NLP models with LIME & SHAP | by Susan Li | Towards Data Science", "h1": "Explain NLP models with LIME & SHAP", "description": "Last week, I gave a talk on \u201cHands-on Feature Engineering for NLP\u201d at QCon New York. As a very small part of the presentation, I gave a brief demo on how LIME & SHAP work in terms of text\u2026"}, "outgoing_paragraph_urls": [{"url": "https://qconnewyork.com/ny2019/presentation/techniques-and-best-practices-prepping-data-ml-projects", "anchor_text": "Hands-on Feature Engineering for NLP", "paragraph_index": 0}, {"url": "https://qconnewyork.com/", "anchor_text": "QCon New York", "paragraph_index": 0}, {"url": "https://github.com/marcotcr/lime", "anchor_text": "LIME", "paragraph_index": 0}, {"url": "https://github.com/slundberg/shap", "anchor_text": "SHAP", "paragraph_index": 0}, {"url": "https://en.wikipedia.org/wiki/Natural_language_processing", "anchor_text": "NLP", "paragraph_index": 2}, {"url": "https://github.com/marcotcr/lime", "anchor_text": "LIME", "paragraph_index": 3}, {"url": "https://github.com/slundberg/shap", "anchor_text": "SHAP", "paragraph_index": 3}, {"url": "https://storage.googleapis.com/tensorflow-workshop-examples/stack-overflow-data.csv", "anchor_text": "Stack Overflow questions tags classification data set", "paragraph_index": 4}, {"url": "https://marcotcr.github.io/lime/tutorials/Lime%20-%20multiclass.html", "anchor_text": "LIME tutorial", "paragraph_index": 6}, {"url": "https://stackoverflow.blog/2019/05/06/predicting-stack-overflow-tags-with-googles-cloud-ai/", "anchor_text": "this tutorial", "paragraph_index": 13}, {"url": "https://github.com/susanli2016/NLP-with-Python/blob/master/LIME_SHAP_StackOverflow.ipynb", "anchor_text": "Jupyter notebook", "paragraph_index": 14}, {"url": "https://github.com/susanli2016/NLP-with-Python/blob/master/LIME_SHAP_StackOverflow.ipynb", "anchor_text": "Github", "paragraph_index": 14}, {"url": "https://www.linkedin.com/in/susanli/", "anchor_text": "https://www.linkedin.com/in/susanli/", "paragraph_index": 16}], "all_paragraphs": ["Last week, I gave a talk on \u201cHands-on Feature Engineering for NLP\u201d at QCon New York. As a very small part of the presentation, I gave a brief demo on how LIME & SHAP work in terms of text classification explainability.", "I decided to write a blog post about them because they are fun, easy to use and visually compelling.", "All machine learning models that operate in higher dimensions than what can be directly visualized by the human mind can be referred as black box models which come down to the interpretability of the models. In particular in the field of NLP, it\u2019s always the case that the dimension of the features are very huge, explaining feature importance is getting much more complicated.", "LIME & SHAP help us provide an explanation not only to end users but also ourselves about how a NLP model works.", "Using the Stack Overflow questions tags classification data set, we are going to build a multi-class text classification model, then applying LIME & SHAP separately to explain the model. Because we have done text classification many times before, we will quickly build the NLP models and focus on the models interpretability.", "Our objective here is not to produce the highest results. I wanted to dive into LIME & SHAP as soon as possible and that\u2019s what happened next.", "From now on, it\u2019s the fun part. The following code snippets were largely borrowed from LIME tutorial.", "We randomly select a document in test set, it happens to be a document that labeled as sql, and our model predicts it as sql as well. Using this document, we generate explanations for label 4 which is sql and label 8 which is python.", "It is obvious that this document has the highest explanation for label sql. We also notice that the positive and negative signs are with respect to a particular label, such as word \u201csql\u201d is positive towards class sql while negative towards class python, and vice versa.", "We are going to generate labels for the top 2 classes for this document.", "It gives us sql and python.", "Let me try to explain this visualization:", "We may want to zoom in and study the explanations for class sql, as well as the document itself.", "The following process were learned from this tutorial.", "There are a lot to learn in terms of machine learning interpretability with LIME & SHAP. I have only covered a tiny piece for NLP. Jupyter notebook can be found on Github. Enjoy the fun!", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Changing the world, one post at a time. Sr Data Scientist, Toronto Canada. https://www.linkedin.com/in/susanli/"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F5c5a9f84d59b&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fexplain-nlp-models-with-lime-shap-5c5a9f84d59b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fexplain-nlp-models-with-lime-shap-5c5a9f84d59b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fexplain-nlp-models-with-lime-shap-5c5a9f84d59b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fexplain-nlp-models-with-lime-shap-5c5a9f84d59b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----5c5a9f84d59b--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----5c5a9f84d59b--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://actsusanli.medium.com/?source=post_page-----5c5a9f84d59b--------------------------------", "anchor_text": ""}, {"url": "https://actsusanli.medium.com/?source=post_page-----5c5a9f84d59b--------------------------------", "anchor_text": "Susan Li"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F731d8566944a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fexplain-nlp-models-with-lime-shap-5c5a9f84d59b&user=Susan+Li&userId=731d8566944a&source=post_page-731d8566944a----5c5a9f84d59b---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F5c5a9f84d59b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fexplain-nlp-models-with-lime-shap-5c5a9f84d59b&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F5c5a9f84d59b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fexplain-nlp-models-with-lime-shap-5c5a9f84d59b&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://qconnewyork.com/ny2019/presentation/techniques-and-best-practices-prepping-data-ml-projects", "anchor_text": "Hands-on Feature Engineering for NLP"}, {"url": "https://qconnewyork.com/", "anchor_text": "QCon New York"}, {"url": "https://github.com/marcotcr/lime", "anchor_text": "LIME"}, {"url": "https://github.com/slundberg/shap", "anchor_text": "SHAP"}, {"url": "https://en.wikipedia.org/wiki/Natural_language_processing", "anchor_text": "NLP"}, {"url": "https://github.com/marcotcr/lime", "anchor_text": "LIME"}, {"url": "https://github.com/slundberg/shap", "anchor_text": "SHAP"}, {"url": "https://storage.googleapis.com/tensorflow-workshop-examples/stack-overflow-data.csv", "anchor_text": "Stack Overflow questions tags classification data set"}, {"url": "https://marcotcr.github.io/lime/tutorials/Lime%20-%20multiclass.html", "anchor_text": "LIME tutorial"}, {"url": "https://stackoverflow.blog/2019/05/06/predicting-stack-overflow-tags-with-googles-cloud-ai/", "anchor_text": "this tutorial"}, {"url": "https://github.com/susanli2016/NLP-with-Python/blob/master/LIME_SHAP_StackOverflow.ipynb", "anchor_text": "Jupyter notebook"}, {"url": "https://github.com/susanli2016/NLP-with-Python/blob/master/LIME_SHAP_StackOverflow.ipynb", "anchor_text": "Github"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----5c5a9f84d59b---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/nlp?source=post_page-----5c5a9f84d59b---------------nlp-----------------", "anchor_text": "NLP"}, {"url": "https://medium.com/tag/nlp-tutorial?source=post_page-----5c5a9f84d59b---------------nlp_tutorial-----------------", "anchor_text": "Nlp Tutorial"}, {"url": "https://medium.com/tag/python?source=post_page-----5c5a9f84d59b---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/text-classification?source=post_page-----5c5a9f84d59b---------------text_classification-----------------", "anchor_text": "Text Classification"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F5c5a9f84d59b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fexplain-nlp-models-with-lime-shap-5c5a9f84d59b&user=Susan+Li&userId=731d8566944a&source=-----5c5a9f84d59b---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F5c5a9f84d59b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fexplain-nlp-models-with-lime-shap-5c5a9f84d59b&user=Susan+Li&userId=731d8566944a&source=-----5c5a9f84d59b---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F5c5a9f84d59b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fexplain-nlp-models-with-lime-shap-5c5a9f84d59b&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----5c5a9f84d59b--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F5c5a9f84d59b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fexplain-nlp-models-with-lime-shap-5c5a9f84d59b&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----5c5a9f84d59b---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----5c5a9f84d59b--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----5c5a9f84d59b--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----5c5a9f84d59b--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----5c5a9f84d59b--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----5c5a9f84d59b--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----5c5a9f84d59b--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----5c5a9f84d59b--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----5c5a9f84d59b--------------------------------", "anchor_text": ""}, {"url": "https://actsusanli.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://actsusanli.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Susan Li"}, {"url": "https://actsusanli.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "27K Followers"}, {"url": "https://www.linkedin.com/in/susanli/", "anchor_text": "https://www.linkedin.com/in/susanli/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F731d8566944a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fexplain-nlp-models-with-lime-shap-5c5a9f84d59b&user=Susan+Li&userId=731d8566944a&source=post_page-731d8566944a--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F1f2b19329694&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fexplain-nlp-models-with-lime-shap-5c5a9f84d59b&newsletterV3=731d8566944a&newsletterV3Id=1f2b19329694&user=Susan+Li&userId=731d8566944a&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}