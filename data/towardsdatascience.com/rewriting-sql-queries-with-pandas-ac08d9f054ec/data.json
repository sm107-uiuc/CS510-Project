{"url": "https://towardsdatascience.com/rewriting-sql-queries-with-pandas-ac08d9f054ec", "time": 1683018377.985845, "path": "towardsdatascience.com/rewriting-sql-queries-with-pandas-ac08d9f054ec/", "webpage": {"metadata": {"title": "Rewriting SQL Queries with Pandas | by Soner Y\u0131ld\u0131r\u0131m | Towards Data Science", "h1": "Rewriting SQL Queries with Pandas", "description": "Pandas is a Python library for data analysis and manipulation. SQL is a programming language that is used to handle relational databases. What they have in common is that both Pandas and SQL operate\u2026"}, "outgoing_paragraph_urls": [{"url": "http://linkedin.com/in/soneryildirim/", "anchor_text": "linkedin.com/in/soneryildirim/", "paragraph_index": 32}, {"url": "http://twitter.com/snr14", "anchor_text": "twitter.com/snr14", "paragraph_index": 32}], "all_paragraphs": ["Pandas is a Python library for data analysis and manipulation. SQL is a programming language that is used to handle relational databases. What they have in common is that both Pandas and SQL operate on tabular data (i.e. tables consist of rows and columns).", "Since both Pandas and SQL deal with tabular data, similar operations or queries can be completed using either one. In this article, we will rewrite SQL queries with Pandas syntax. Thus, it will be a practical guide for both of them.", "I have an SQL table and a Pandas dataframe that contains 15 rows and 4 columns. Let\u2019s start with displaying the first 5 rows.", "We have some data about items sold at different retail stores. In the following examples, I will write down a query task and complete it with both SQL and Pandas.", "Task: Find the average price of items for each store.", "We need to group the prices based on store id column and calculate the average value for each store.", "In SQL, we apply the aggregate function (avg) while selecting the column. The group by clause groups the prices based on the categories in the store id column.", "In Pandas, we first use the groupby function and then apply the aggregation.", "Task: Modify the result in the previous example by renaming the price column as \u201caverage_price\u201d and sorting the stores based on average price.", "In SQL, we will use the AS keyword for renaming and add the order by clause at the end to sort the results.", "In Pandas, there are many options for renaming the price column. I will be using the named agg method. The sort_values function is used to sort the results.", "Task: Find all the items whose store id is 3.", "We just need to filter the rows based on store id column. In SQL, it is done by using the where clause.", "It is also a pretty simple operation in Pandas.", "Task: Find the most expensive item sold at each store.", "This task involves both group by and aggregation. In SQL, the max function is applied to the price column and the values are grouped by the store id.", "In Pandas, we first group the selected columns by the store id and then apply the max function.", "Task: Find all the items that contains the word \u2018egg\u2019.", "This task involves filtering but different than the ones we have done in the previous example. In SQL, we will use the like keyword with the where clause.", "The \u2018%egg%\u2019 notation indicates that we want every description that involves the \u2018egg\u2019 character sequence in it.", "In Pandas, we will use the contains function of the str accessor.", "Task: Find all the items that contains the word \u201cliter\u201d in the description and more expensive than 2 dollars.", "It is similar to the task in the previous example with one additional condition.", "In SQL, we can place multiple conditions in the where clause.", "In Pandas, we can apply multiple filtering conditions as below:", "Task: Find all the items whose description starts with \u2018ice\u2019.", "This is another text based filtering. In SQL, we can either use the like operator or the left function to compare the first three characters of the description with \u2018ice\u2019.", "In Pandas, we can use the startswith function of the str accessor.", "Both Pandas and SQL are popular tools used in the field of data science. They are proven to be efficient and practical. If you are working or plan to work in data science domain, I strongly suggest to learn both.", "We have done some basic queries to retrieve data using both Pandas and SQL. It is a good practice to compare them by doing the same operations. It will improve your practical skills as well as the understanding of the syntax.", "Thank you for reading. Please let me know if you have any feedback.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Scientist | Top 10 Writer in AI and Data Science | linkedin.com/in/soneryildirim/ | twitter.com/snr14"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fac08d9f054ec&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frewriting-sql-queries-with-pandas-ac08d9f054ec&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frewriting-sql-queries-with-pandas-ac08d9f054ec&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frewriting-sql-queries-with-pandas-ac08d9f054ec&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frewriting-sql-queries-with-pandas-ac08d9f054ec&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----ac08d9f054ec--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----ac08d9f054ec--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://sonery.medium.com/?source=post_page-----ac08d9f054ec--------------------------------", "anchor_text": ""}, {"url": "https://sonery.medium.com/?source=post_page-----ac08d9f054ec--------------------------------", "anchor_text": "Soner Y\u0131ld\u0131r\u0131m"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F2cf6b549448&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frewriting-sql-queries-with-pandas-ac08d9f054ec&user=Soner+Y%C4%B1ld%C4%B1r%C4%B1m&userId=2cf6b549448&source=post_page-2cf6b549448----ac08d9f054ec---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fac08d9f054ec&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frewriting-sql-queries-with-pandas-ac08d9f054ec&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fac08d9f054ec&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frewriting-sql-queries-with-pandas-ac08d9f054ec&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@coffeegeek?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Coffee Geek"}, {"url": "https://unsplash.com/s/photos/compare?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://medium.com/tag/data-science?source=post_page-----ac08d9f054ec---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----ac08d9f054ec---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----ac08d9f054ec---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/python?source=post_page-----ac08d9f054ec---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/sql?source=post_page-----ac08d9f054ec---------------sql-----------------", "anchor_text": "Sql"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fac08d9f054ec&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frewriting-sql-queries-with-pandas-ac08d9f054ec&user=Soner+Y%C4%B1ld%C4%B1r%C4%B1m&userId=2cf6b549448&source=-----ac08d9f054ec---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fac08d9f054ec&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frewriting-sql-queries-with-pandas-ac08d9f054ec&user=Soner+Y%C4%B1ld%C4%B1r%C4%B1m&userId=2cf6b549448&source=-----ac08d9f054ec---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fac08d9f054ec&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frewriting-sql-queries-with-pandas-ac08d9f054ec&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----ac08d9f054ec--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fac08d9f054ec&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frewriting-sql-queries-with-pandas-ac08d9f054ec&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----ac08d9f054ec---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----ac08d9f054ec--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----ac08d9f054ec--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----ac08d9f054ec--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----ac08d9f054ec--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----ac08d9f054ec--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----ac08d9f054ec--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----ac08d9f054ec--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----ac08d9f054ec--------------------------------", "anchor_text": ""}, {"url": "https://sonery.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://sonery.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Soner Y\u0131ld\u0131r\u0131m"}, {"url": "https://sonery.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "21K Followers"}, {"url": "http://linkedin.com/in/soneryildirim/", "anchor_text": "linkedin.com/in/soneryildirim/"}, {"url": "http://twitter.com/snr14", "anchor_text": "twitter.com/snr14"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F2cf6b549448&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frewriting-sql-queries-with-pandas-ac08d9f054ec&user=Soner+Y%C4%B1ld%C4%B1r%C4%B1m&userId=2cf6b549448&source=post_page-2cf6b549448--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F7cdf5377373a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frewriting-sql-queries-with-pandas-ac08d9f054ec&newsletterV3=2cf6b549448&newsletterV3Id=7cdf5377373a&user=Soner+Y%C4%B1ld%C4%B1r%C4%B1m&userId=2cf6b549448&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}