{"url": "https://towardsdatascience.com/the-complete-guide-to-linear-regression-in-python-3d3f8f06bf8", "time": 1682996714.151838, "path": "towardsdatascience.com/the-complete-guide-to-linear-regression-in-python-3d3f8f06bf8/", "webpage": {"metadata": {"title": "The Complete Guide to Linear Regression in Python | by Marco Peixeiro | Towards Data Science", "h1": "The Complete Guide to Linear Regression in Python", "description": "This article attempts to be the reference you need when it comes to understanding and performing linear regression. Although the algorithm is simple, only a few truly understand the underlying\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.youtube.com/channel/UC-0lpiwlftqwC7znCcF83qg?view_as=subscriber", "anchor_text": "YouTube channel", "paragraph_index": 3}, {"url": "https://github.com/marcopeix/ISL-linear-regression", "anchor_text": "here", "paragraph_index": 43}, {"url": "https://towardsdatascience.com/linear-regression-understanding-the-theory-7e53ac2831b5", "anchor_text": "post", "paragraph_index": 61}], "all_paragraphs": ["This article attempts to be the reference you need when it comes to understanding and performing linear regression. Although the algorithm is simple, only a few truly understand the underlying principles.", "First, we will dig deep into the theory of linear regression to understand its inner workings. Then, we will implement the algorithm in Python to model a business problem.", "I hope this article finds its way to your bookmarks! For now, let\u2019s get to it!", "For hands-on video tutorials on machine learning, deep learning, and artificial intelligence, checkout my YouTube channel.", "Linear regression is probably the simplest approach for statistical learning. It is a good starting point for more advanced approaches, and in fact, many fancy statistical learning techniques can be seen as an extension of linear regression. Therefore, understanding this simple model will build a good base before moving on to more complex approaches.", "Linear regression is very good to answer the following questions:", "Let\u2019s assume we only have one variable and one target. Then, linear regression is expressed as:", "In the equation above, the betas are the coefficients. These coefficients are what we need in order to make predictions with our model.", "So how do we find these parameters?", "To find the parameters, we need to minimize the least squares or the sum of squared errors. Of course, the linear model is not perfect and it will not predict all the data accurately, meaning that there is a difference between the actual value and the prediction. The error is easily calculated with:", "But why are the errors squared?", "We square the error, because the prediction can be either above or below the true value, resulting in a negative or positive difference respectively. If we did not square the errors, the sum of errors could decrease because of negative differences and not because the model is a good fit.", "Also, squaring the errors penalizes large differences, and so the minimizing the squared errors \u201cguarantees\u201d a better model.", "Let\u2019s take a look at a graph to better understand.", "In the graph above, the red dots are the true data and the blue line is linear model. The grey lines illustrate the errors between the predicted and the true values. The blue line is thus the one that minimizes the sum of the squared length of the grey lines.", "After some math that is too heavy for this article, you can finally estimate the coefficients with the following equations:", "Where x bar and y bar represent the mean.", "Now that you have coefficients, how can you tell if they are relevant to predict your target?", "The best way is to find the p-value. The p-value is used to quantify statistical significance; it allows to tell whether the null hypothesis is to be rejected or not.", "For any modelling task, the hypothesis is that there is some correlation between the features and the target. The null hypothesis is therefore the opposite: there is no correlation between the features and the target.", "So, finding the p-value for each coefficient will tell if the variable is statistically significant to predict the target. As a general rule of thumb, if the p-value is less than 0.05: there is a strong relationship between the variable and the target.", "You found out that your variable was statistically significant by finding its p-value. Great!", "Now, how do you know if your linear model is any good?", "To assess that, we usually use the RSE (residual standard error) and the R\u00b2 statistic.", "The first error metric is simple to understand: the lower the residual errors, the better the model fits the data (in this case, the closer the data is to a linear relationship).", "As for the R\u00b2 metric, it measures the proportion of variability in the target that can be explained using a feature X. Therefore, assuming a linear relationship, if feature X can explain (predict) the target, then the proportion is high and the R\u00b2 value will be close to 1. If the opposite is true, the R\u00b2 value is then closer to 0.", "In real life situations, there will never be a single feature to predict a target. So, do we perform linear regression on one feature at a time? Of course not. We simply perform multiple linear regression.", "The equation is very similar to simple linear regression; simply add the number of predictors and their corresponding coefficients:", "Previously, in simple linear regression, we assess the relevancy of a feature by finding its p-value.", "In the case of multiple linear regression, we use another metric: the F-statistic.", "Here, the F-statistic is calculated for the overall model, whereas the p-value is specific to each predictor. If there is a strong relationship, then F will be much larger than 1. Otherwise, it will be approximately equal to 1.", "How larger than 1 is large enough?", "This is hard to answer. Usually, if there is a large number of data points, F could be slightly larger than 1 and suggest a strong relationship. For small data sets, then the F value must be way larger than 1 to suggest a strong relationship.", "Why can\u2019t we use the p-value in this case?", "Since we are fitting many predictors, we need to consider a case where there are a lot of features (p is large). With a very large amount of predictors, there will always be about 5% of them that will have, by chance, a very small p-value even though they are not statistically significant. Therefore, we use the F-statistic to avoid considering unimportant predictors as significant predictors.", "Just like in simple linear regression, the R\u00b2 can be used for multiple linear regression. However, know that adding more predictors will always increase the R\u00b2 value, because the model will necessarily better fit the training data.", "Yet, this does not mean it will perform well on test data (making predictions for unknown data points).", "Having multiple predictors in a linear model means that some predictors may have an influence on other predictors.", "For example, you want to predict the salary of a person, knowing her age and number of years spent in school. Of course, the older the person, the more time that person could have spent in school. So how do we model this interaction effect?", "Consider this very simple example with 2 predictors:", "As you can see, we simply multiply both predictors together and associate a new coefficient. Simplifying the formula, we see now that the coefficient is influenced by the value of another feature.", "As a general rule, if we include the interaction model, we should include the individual effect of a feature, even if its p-value is not significant. This is known as the hierarchical principle. The rationale behind this is that if two predictors are interacting, then including their individual contribution will have a small impact on the model.", "Alright! Now that we know how it works, let\u2019s make it work! We will work through both a simple and multiple linear regression in Python and I will show how to assess the quality of the parameters and the overall model in both situations.", "You can grab the code and the data here.", "I strongly recommend that you follow and recreate the steps in your own Jupyter notebook to take full advantage of this tutorial.", "The data set contains information about money spent on advertisement and their generated sales. Money was spent on TV, radio and newspaper ads.", "The objective is to use linear regression to understand how advertisement spending impacts sales.", "The advantage of working with Python is that we have access to many libraries that allow us to rapidly read data, plot the data, and perform a linear regression.", "I like to import all the necessary libraries on top of the notebook to keep everything organized. Import the following:", "Assuming that you downloaded the data set, place it in a data directory within your project folder. Then, read the data like so:", "To see what the data looks like, we do the following:", "As you can see, the column Unnamed: 0 is redundant. Hence, we remove it.", "Alright, our data is clean and ready for linear regression!", "For simple linear regression, let\u2019s consider only the effect of TV ads on sales. Before jumping right into the modelling, let\u2019s take a look at what the data looks like.", "We use matplotlib , a popular Python plotting library to make a scatter plot.", "Run this cell of code and you should see this graph:", "As you can see, there is a clear relationship between the amount spent on TV ads and sales.", "Let\u2019s see how we can generate a linear approximation of this data.", "Yes! It is that simple to fit a straight line to the data set and see the parameters of the equation. In this case, we have", "Let\u2019s visualize how the line fits the data.", "From the graph above, it seems that a simple linear regression can explain the general impact of amount spent on TV ads and sales.", "Now, if you remember from this post, to see if the model is any good, we need to look at the R\u00b2 value and the p-value from each coefficient.", "Which gives you this lovely output:", "Looking at both coefficients, we have a p-value that is very low (although it is probably not exactly 0). This means that there is a strong correlation between these coefficients and the target (Sales).", "Then, looking at the R\u00b2 value, we have 0.612. Therefore, about 60% of the variability of sales is explained by the amount spent on TV ads. This is okay, but definitely not the best we can to accurately predict the sales. Surely, spending on newspaper and radio ads must have a certain impact on sales.", "Let\u2019s see if a multiple linear regression will perform better.", "Just like for simple linear regression, we will define our features and target variable and use scikit-learn library to perform linear regression.", "Nothing more! From this code cell, we get the following equation:", "Of course, we cannot visualize the impact of all three mediums on sales, since it has a total of four dimensions.", "Notice that the coefficient for newspaper is negative, but also fairly small. Is it relevant to our model? Let\u2019s see by calculating the F-statistic, R\u00b2 value and p-value for each coefficient.", "As you must expect, the procedure here is very similar to what we did in simple linear regression.", "As you can see, the R\u00b2 is much higher than that of simple linear regression, with a value of 0.897!", "Also, the F-statistic is 570.3. This is much greater than 1, and since our data set if fairly small (only 200 data points), it demonstrates that there is a strong relationship between ad spending and sales.", "Finally, because we only have three predictors, we can consider their p-value to determine if they are relevant to the model or not. Of course, you notice that the third coefficient (the one for newspaper) has a large p-value. Therefore, ad spending on newspaper is not statistically significant. Removing that predictor would slightly reduce the R\u00b2 value, but we might make better predictions.", "You rock \ud83e\udd18. Congratulations on making it to the end, you are now a master of linear regression!", "As aforementioned, this might not be the top performing algorithm, but is is important to understand linear regression as it forms the basis of more complex statistical learning approaches.", "I hope you will refer back to this article sometime.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Senior data scientist | Author | Instructor. I write hands-on articles with a focus on practical skills."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F3d3f8f06bf8&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-complete-guide-to-linear-regression-in-python-3d3f8f06bf8&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-complete-guide-to-linear-regression-in-python-3d3f8f06bf8&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-complete-guide-to-linear-regression-in-python-3d3f8f06bf8&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-complete-guide-to-linear-regression-in-python-3d3f8f06bf8&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----3d3f8f06bf8--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----3d3f8f06bf8--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@marcopeixeiro?source=post_page-----3d3f8f06bf8--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@marcopeixeiro?source=post_page-----3d3f8f06bf8--------------------------------", "anchor_text": "Marco Peixeiro"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F741c1c8fcfbd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-complete-guide-to-linear-regression-in-python-3d3f8f06bf8&user=Marco+Peixeiro&userId=741c1c8fcfbd&source=post_page-741c1c8fcfbd----3d3f8f06bf8---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F3d3f8f06bf8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-complete-guide-to-linear-regression-in-python-3d3f8f06bf8&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F3d3f8f06bf8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-complete-guide-to-linear-regression-in-python-3d3f8f06bf8&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://www.youtube.com/channel/UC-0lpiwlftqwC7znCcF83qg?view_as=subscriber", "anchor_text": "YouTube channel"}, {"url": "https://github.com/marcopeix/ISL-linear-regression", "anchor_text": "here"}, {"url": "https://towardsdatascience.com/linear-regression-understanding-the-theory-7e53ac2831b5", "anchor_text": "post"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----3d3f8f06bf8---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----3d3f8f06bf8---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----3d3f8f06bf8---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/programming?source=post_page-----3d3f8f06bf8---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/tag/python?source=post_page-----3d3f8f06bf8---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F3d3f8f06bf8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-complete-guide-to-linear-regression-in-python-3d3f8f06bf8&user=Marco+Peixeiro&userId=741c1c8fcfbd&source=-----3d3f8f06bf8---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F3d3f8f06bf8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-complete-guide-to-linear-regression-in-python-3d3f8f06bf8&user=Marco+Peixeiro&userId=741c1c8fcfbd&source=-----3d3f8f06bf8---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F3d3f8f06bf8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-complete-guide-to-linear-regression-in-python-3d3f8f06bf8&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----3d3f8f06bf8--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F3d3f8f06bf8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-complete-guide-to-linear-regression-in-python-3d3f8f06bf8&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----3d3f8f06bf8---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----3d3f8f06bf8--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----3d3f8f06bf8--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----3d3f8f06bf8--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----3d3f8f06bf8--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----3d3f8f06bf8--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----3d3f8f06bf8--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----3d3f8f06bf8--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----3d3f8f06bf8--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@marcopeixeiro?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@marcopeixeiro?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Marco Peixeiro"}, {"url": "https://medium.com/@marcopeixeiro/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "3.6K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F741c1c8fcfbd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-complete-guide-to-linear-regression-in-python-3d3f8f06bf8&user=Marco+Peixeiro&userId=741c1c8fcfbd&source=post_page-741c1c8fcfbd--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F9835bccb3d51&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-complete-guide-to-linear-regression-in-python-3d3f8f06bf8&newsletterV3=741c1c8fcfbd&newsletterV3Id=9835bccb3d51&user=Marco+Peixeiro&userId=741c1c8fcfbd&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://www.manning.com/books/time-series-forecasting-in-python-book", "anchor_text": "Time Series Forecasting in Python2022"}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}