{"url": "https://towardsdatascience.com/how-to-turn-physics-into-an-optimization-problem-11b3fbf83062", "time": 1683001190.767034, "path": "towardsdatascience.com/how-to-turn-physics-into-an-optimization-problem-11b3fbf83062/", "webpage": {"metadata": {"title": "How To Turn Physics into an Optimization Problem | by Mark Saroufim | Towards Data Science", "h1": "How To Turn Physics into an Optimization Problem", "description": "This post is mostly about a tool called Lagrangian Mechanics which lets you solve physical problems like an optimization problem. Lagrangian Mechanics has a huge benefit over traditional Newtonian\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.youtube.com/watch?v=pVVMNsidI0g&t=156s", "anchor_text": "this series", "paragraph_index": 44}, {"url": "https://www.amazon.com/Structure-Interpretation-Classical-Mechanics-Press/dp/0262028964/ref=sr_1_1?dchild=1&keywords=structure+and+interpretation+of+classical+mechanics&qid=1617667933&s=books&sr=1-1", "anchor_text": "Structure and Interpretation of Classical Mechanics", "paragraph_index": 67}, {"url": "https://github.com/MasonProtter/Symbolics.jl", "anchor_text": "https://github.com/MasonProtter/Symbolics.jl", "paragraph_index": 68}, {"url": "https://www.amazon.com/Nonlinear-Dynamics-Student-Solutions-Manual/dp/0813349109/ref=sr_1_1?dchild=1&keywords=nonlinear+dynamics&qid=1617667808&sr=8-1", "anchor_text": "Non Linear Dynamics and Chaos", "paragraph_index": 72}, {"url": "https://observablehq.com/@rreusser/domain-coloring-for-complex-functions?collection=@observablehq/webgl", "anchor_text": "Observable Notebook on domain coloring by Ricky Reusser", "paragraph_index": 74}, {"url": "https://arxiv.org/pdf/1611.01652.pdf", "anchor_text": "here", "paragraph_index": 75}, {"url": "https://medium.com/@marksaroufim/technical-books-i-%EF%B8%8F-4af8f3ddd205", "anchor_text": "Technical Books I love.", "paragraph_index": 80}], "all_paragraphs": ["This post is mostly about a tool called Lagrangian Mechanics which lets you solve physical problems like an optimization problem.", "In Machine Learning you minimize the loss between the prediction and the label to find the best predictor", "In Lagrangian Mechanics you minimize the total action of a system to find its motion", "Lagrangian Mechanics has a huge benefit over traditional Newtonian Mechanics in that it\u2019s representation invariant which means you have the freedom to choose the easiest representation to work with.", "As an example we\u2019ll discuss the simplest kind of robot, a 2-d pendulum \u2014 each of your limbs is a pendulum and your body is made up of a bunch of pendulums.", "What we\u2019re interested in this case is describing the motion of the center of the mass at the end of the string so at every time t we need to find 3 variables", "v is the rate of change of p over time", "a is the rate of change of v over time", "So we really just need to predict a single variable p.", "p is a sequence of positions of a body from a starting time s to a final time", "But how exactly do we go about representing the position of the center of the mass exactly? The obvious first choice is to use Cartesian coordinates x, y.", "But now we\u2019re faced with a dilemma \u2014 should we center coordinates on the ball itself, the wall, someplace else? Is there any principled way of deciding which coordinate is better?", "An alternate representation we could use for the pendulum is:", "We can fully characterize all the possible positions of the pendulum", "Taken together you just end up with the polar coordinates.", "The Polar and Cartesian representations are isomorphic (same mathematically) but polar has more advantages in this case.", "l never changes through the evolution of the system so effectively we can describe the motion of this entire system using only 1 variable \u03b8 instead of 2 variables x and y.", "One major reason that the \u03b8 representation is better is because if we\u2019re trying from time t to predict the position of the ball at time t + 1 there are only 3 possible solutions", "In the Cartesian setting, the solution lies somewhere on the x, y plane but there infinitely many possible directions from time t to t + 1.", "But in the Polar setting, the solution can only go in one of two directions.", "The circle is the configuration space as in the set of all realizable solutions to the pendulum problem and the specific path the particle takes via this space describes its actual movement and is called the configuration path.", "Studying the \u201cshapes\u201d of systems in this manner is part of larger field called Topology. Topology is tremendously useful to study the motion of physical systems so here\u2019s a taste of it.", "Let\u2019s take a more complex system, a double pendulum \u2014 imagine the first ball as your elbow and you can see how this represents something a bit more interesting, namely your arm.", "You can describe this system via two angles", "If you fix the first angle then configuration space of the second angle is again a circle so the new space for both angles would look like.", "And since there are infinitely many small circles on top of the larger one the shape we end up with is the famous torus (donut) from topology.", "Each point on this 3-d object represents a possible solution to where the double pendulum can be. We\u2019re essentially characterizing the solution of this system as a space.", "The actual motion of an example pendulum is then described by a path on this torus.", "If you work with Newtonian Mechanics and need to change your representation to see what works best you need to re-derive all your formulas which when you go into the double pendulum realm involves some tricky trigonometry.", "The Lagrangian L on the other hand is representation independent which means.", "Now let\u2019s define what the Lagrangian is and see how it works.", "Now we know that we can describe the motion of a system using a path but which path will a system actually take in its configuration space?", "All physical processes take the path that minimizes total action.", "A famous example is refraction where the light bends because it\u2019s faster for it to do so.", "The Lagrangian of a system L can be understood as its \u201cliveliness\u201d. It\u2019s defined formally as", "where T is the kinetic energy and V is the potential energy.", "The kinetic energy T is always the same", "And the potential energy depends on the type of system being described but for us, we\u2019ll mostly be looking at gravitational potential", "The more famous conservation of energy law takes the sum of potential and kinetic energy and it\u2019s been tremendously reliable in pruning out bad physics theories.", "What the conservation of energy law tells us is that no new energy can be created and no energy can be lost. Instead, we have a trade-off where if T increases then V decreases and if T decreases then V increases.", "The total action generated by a system is denoted S and can be calculated by summing up all the Lagrangian of each position the configuration space.", "So now that we can derive the Lagrangian L of any system, how do we get the minimum S and the path that generates it.", "The transition from Lagrangian to a solution is done via the Euler-Lagrange equation which will find the path of least action.", "The formula looks more complicated than it actually is and it\u2019s best understood via a couple of examples.", "Both of my examples are heavily inspired by this series", "Suppose we have a ball of mass m falling to the ground", "The kinetic energy T is only a function of y because there is no sideways movement", "The Euler Lagrange equation will only be a function of y so we can simplify it", "So we end up with deriving Newton\u2019s law from scratch \ud83e\udd2f", "The last example was to show you how Lagrangian Mechanics works but it\u2019s not an example where Lagrangian Mechanics shines.", "Lagrangian Mechanics shines when the system is complex with many variables that would be painfully difficult to model with Newtonian Mechanics.", "So we\u2019re going to instead imagine that we have some sort of moving cart with mass M with a dangling pendulum of mass m. My head hurts thinking about the number of different forces I need to model here.", "Thankfully Lagrangian makes solving this system far easier since we can just sum up each objects Lagrangian independently.", "We can model the position of the cart and ball with 2 variables each for a total of 4 or we can use a trick where we change the coordinate system to make our lives easier.", "We make the following 2 substitutions", "With this change of variable in place, we can derive the Lagrangian L.", "Remember, nature doesn't\u2019 care about how we represent it", "Kinetic energy is easy. The cart only moves in the x direction and the pendulum can move both in the x and y direction.", "Once you have L you can just apply the Euler Lagrange equation to see how this system behaves.", "Contrast this approach to the Newtonian Mechanics one where", "The difference between Newtonian Mechanics and Lagrangian Mechanics is the difference between imperative and declarative programming. An efficient declarative paradigm like Lagrangian Mechanics will always be preferable in the same that SQL is preferred over UNIX scripting.", "A final advantage of Lagrangian mechanics that I want to briefly touch on is that it\u2019s trivial to add constraints to a system.", "A constraint is some function that f such that", "f could be a constraint on the max velocity or it could be a constraint on how far a joint can bend or it can be a constraint on how soft the collision of two objects should be.", "You can have as many constraints as you want", "And all you need to is instead of plugging L into the Euler Lagrange equation you would plug in where \u03bb\u2019s are weights for how important each constraint is. This trick is called \u201cLagrangian Multipliers\u201d and is used extensively in convex optimization.", "Even though Lagrangian Mechanics is a powerful idea that lets you heavily simplify implementing physics engines, as far as I know, it\u2019s not a mainstream idea yet. If you do know of any physics engines that do use it, please let me know and I\u2019ll describe how it works in a real physics engine in a future blog post.", "The first time I saw a full implementation of Lagrangian Mechanics was in the fantastic book \u2014 Structure and Interpretation of Classical Mechanics. The implementation here is in LISP which is a great language to learn but in my experience a tough language to use on larger projects.", "So instead I\u2019d recommend taking a look at the project https://github.com/MasonProtter/Symbolics.jl which offers a Julia implementation heavily inspired by the SICM implementation.", "The README specifically talks about the harmonic oscillator which is just a fancy term for a weight attached to a spring.", "Lagrangian mechanics makes it easy for us to figure out the path that a system will take but it doesn\u2019t give us much insight into the velocity that the point in the configuration space has. So with only Lagrangian mechanics we can\u2019t really picture how a system is fully evolving.", "Hamiltonian Mechanics is a third way to solve physical problems which instead of working in configuration space works in phase space.", "This is a large topic in of itself which is really useful to describe dynamical systems and is used at length in Non Linear Dynamics and Chaos", "I\u2019m planning another blog post on this topic so I\u2019ll just put some images that should motivate you to want to learn more.", "If you enjoyed this post I\u2019d highly recommend you check out this Observable Notebook on domain coloring by Ricky Reusser", "A new nascent field in research has been Differentiable Physics. An example of a great paper is here.", "Any sort of sort of physical prediction involves writing and solving lots of differential equations so the idea is you write a Physics engine in a differentiable language like Pytorch or Flux.jl and then get to evaluate derivatives in linear time.", "The main benefit of this approach is that you only need to describe how your systems needs to evolve(forward pass) and you get the derivatives for free (backward pass).", "Personally, I find this to be the most exciting research area in Machine Learning today.", "I\u2019ll be talking more about Automatic Differentiation in a future blog post so this idea will become crystal clear soon.", "Many Mathematical techniques that have great applications in Physics are making their way to Machine Learning and Robotics. So there\u2019s a couple of references I recommend to get started with this new math that goes beyond linear algebra and basic calculus. I recommend many books in this list \u2192 Technical Books I love.", "In particular, in a future blog post, I\u2019d like to talk more about the topology of configuration spaces and will show you how to apply these ideas to simply describe the motion of 3-d robots.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F11b3fbf83062&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-turn-physics-into-an-optimization-problem-11b3fbf83062&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-turn-physics-into-an-optimization-problem-11b3fbf83062&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-turn-physics-into-an-optimization-problem-11b3fbf83062&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-turn-physics-into-an-optimization-problem-11b3fbf83062&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----11b3fbf83062--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----11b3fbf83062--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://marksaroufim.medium.com/?source=post_page-----11b3fbf83062--------------------------------", "anchor_text": ""}, {"url": "https://marksaroufim.medium.com/?source=post_page-----11b3fbf83062--------------------------------", "anchor_text": "Mark Saroufim"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F426d54390627&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-turn-physics-into-an-optimization-problem-11b3fbf83062&user=Mark+Saroufim&userId=426d54390627&source=post_page-426d54390627----11b3fbf83062---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F11b3fbf83062&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-turn-physics-into-an-optimization-problem-11b3fbf83062&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F11b3fbf83062&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-turn-physics-into-an-optimization-problem-11b3fbf83062&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://towardsdatascience.com/tagged/thoughts-and-theory", "anchor_text": "Thoughts and Theory"}, {"url": "https://www.youtube.com/watch?v=pVVMNsidI0g&t=156s", "anchor_text": "this series"}, {"url": "https://www.amazon.com/Structure-Interpretation-Classical-Mechanics-Press/dp/0262028964/ref=sr_1_1?dchild=1&keywords=structure+and+interpretation+of+classical+mechanics&qid=1617667933&s=books&sr=1-1", "anchor_text": "Structure and Interpretation of Classical Mechanics"}, {"url": "https://github.com/MasonProtter/Symbolics.jl", "anchor_text": "https://github.com/MasonProtter/Symbolics.jl"}, {"url": "https://github.com/MasonProtter/Symbolics.jl", "anchor_text": "https://github.com/MasonProtter/Symbolics.jl"}, {"url": "https://www.amazon.com/Nonlinear-Dynamics-Student-Solutions-Manual/dp/0813349109/ref=sr_1_1?dchild=1&keywords=nonlinear+dynamics&qid=1617667808&sr=8-1", "anchor_text": "Non Linear Dynamics and Chaos"}, {"url": "https://creativecommons.org/licenses/by-sa/4.0", "anchor_text": "CC BY-SA 4.0"}, {"url": "https://commons.wikimedia.org/wiki/User:Krishnavedala", "anchor_text": "Krishnavedala"}, {"url": "https://en.wikipedia.org/wiki/Phase_portrait#/media/File:Pendulum_phase_portrait.svg", "anchor_text": "https://en.wikipedia.org/wiki/Phase_portrait#/media/File:Pendulum_phase_portrait.svg"}, {"url": "https://observablehq.com/@rreusser/domain-coloring-for-complex-functions?collection=@observablehq/webgl", "anchor_text": "Observable Notebook on domain coloring by Ricky Reusser"}, {"url": "https://arxiv.org/pdf/1611.01652.pdf", "anchor_text": "here"}, {"url": "https://medium.com/@marksaroufim/technical-books-i-%EF%B8%8F-4af8f3ddd205", "anchor_text": "Technical Books I love."}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----11b3fbf83062---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/robotics?source=post_page-----11b3fbf83062---------------robotics-----------------", "anchor_text": "Robotics"}, {"url": "https://medium.com/tag/deep-dives?source=post_page-----11b3fbf83062---------------deep_dives-----------------", "anchor_text": "Deep Dives"}, {"url": "https://medium.com/tag/mechanics?source=post_page-----11b3fbf83062---------------mechanics-----------------", "anchor_text": "Mechanics"}, {"url": "https://medium.com/tag/thoughts-and-theory?source=post_page-----11b3fbf83062---------------thoughts_and_theory-----------------", "anchor_text": "Thoughts And Theory"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F11b3fbf83062&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-turn-physics-into-an-optimization-problem-11b3fbf83062&user=Mark+Saroufim&userId=426d54390627&source=-----11b3fbf83062---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F11b3fbf83062&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-turn-physics-into-an-optimization-problem-11b3fbf83062&user=Mark+Saroufim&userId=426d54390627&source=-----11b3fbf83062---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F11b3fbf83062&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-turn-physics-into-an-optimization-problem-11b3fbf83062&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----11b3fbf83062--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F11b3fbf83062&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-turn-physics-into-an-optimization-problem-11b3fbf83062&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----11b3fbf83062---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----11b3fbf83062--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----11b3fbf83062--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----11b3fbf83062--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----11b3fbf83062--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----11b3fbf83062--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----11b3fbf83062--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----11b3fbf83062--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----11b3fbf83062--------------------------------", "anchor_text": ""}, {"url": "https://marksaroufim.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://marksaroufim.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Mark Saroufim"}, {"url": "https://marksaroufim.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "675 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F426d54390627&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-turn-physics-into-an-optimization-problem-11b3fbf83062&user=Mark+Saroufim&userId=426d54390627&source=post_page-426d54390627--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F6f02e82219a8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-turn-physics-into-an-optimization-problem-11b3fbf83062&newsletterV3=426d54390627&newsletterV3Id=6f02e82219a8&user=Mark+Saroufim&userId=426d54390627&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}