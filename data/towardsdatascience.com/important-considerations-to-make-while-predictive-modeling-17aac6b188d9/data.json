{"url": "https://towardsdatascience.com/important-considerations-to-make-while-predictive-modeling-17aac6b188d9", "time": 1683014968.28641, "path": "towardsdatascience.com/important-considerations-to-make-while-predictive-modeling-17aac6b188d9/", "webpage": {"metadata": {"title": "Important Considerations when Predictive Modeling with Tabular Data | by Rohan Kotwani | Towards Data Science", "h1": "Important Considerations when Predictive Modeling with Tabular Data", "description": "Overall, I found the course helpful and insightful, 4.79/5. There were many ideas that I had not considered before so I am posting some of my notes here. More than likely, you have seen most of these\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.coursera.org/learn/competitive-data-science/home/welcome", "anchor_text": "link", "paragraph_index": 0}, {"url": "https://github.com/freedomtowin/data-eng-util/blob/master/machine-learning/mean-encoding-regularization.py", "anchor_text": "here", "paragraph_index": 5}, {"url": "https://github.com/Far0n/xgbfi", "anchor_text": "link", "paragraph_index": 7}, {"url": "https://towardsdatascience.com/how-does-xgboost-work-748bc75c58aa", "anchor_text": "concise explanation", "paragraph_index": 11}, {"url": "https://xgboost.readthedocs.io/en/latest/tutorials/model.html", "anchor_text": "documentation", "paragraph_index": 11}, {"url": "https://arxiv.org/pdf/1603.02754.pdf", "anchor_text": "the original paper", "paragraph_index": 11}], "all_paragraphs": ["Overall, I found the course helpful and insightful, 4.79/5. There were many ideas that I had not considered before so I am posting some of my notes here. More than likely, you have seen most of these ideas so I will try to focus on the most interesting ones. Here is the link to the course.", "Steps 1, 2 ,3 are part of nearly every data exploration pipeline. Step 4, 5, 6 involve plotting and comparing features, i.e., with pd.crosstab, correlation matrices, or aggregated data.", "K-Fold Validation is arguably the most important step in the modeling processes. The predictions on the out-of-fold (OOF) sample are used to assess the average performance of a model. This is also used for hyper-parameter tuning and model performance comparison. Interestingly, the variation of the performance across K-folds can be used for diagnostic purposes as well, i.e., checking how volatile the predictions are in each fold.", "Target leakage is a loaded topic. Basically, we don\u2019t want the model to learn from information that is not available in the production environment. Index features, or combination of index features, can potentially lead to target leakage. More generally, target leakage can be anything that leads to good model performance and also low added-value.", "Here is a summary of common loss functions and metrics.", "Mean encoding is a potentially strong tool, but it also has a high chance of adding bias. The bias can be mitigated by using OOF K-Fold imputation, Leave One Out Imputation, Smoothing Mean Encoding, and Expanding Mean Encoding. Some sample code for these strategies can be found on my GitHub here.", "The K-Fold CV mean encoding strategy can be summarized by the following:", "Interactions between categorical variables can also be mean-encoded. Apparently, it is possible to data mine feature interactions from XGBoost, here is the link. It might be possible to create your own function to do this by counting the number of time two features occur together in a random forest.", "An ensemble strategy uses the outputs of several models into a single predictive model, usually improving the result.", "Averaging model outputs together can reduce noise in any one model. The ensemble weights can be tuned using K-Fold CV. The weights can also be tuned for specific categories or target classes.", "Bagging: creates different versions of the same model and averages the results together. Different models are created by changing the random seed, model parameters, row selection, and/or column selection.", "Boosting: converts many weak learners to a strong estimator by training ML models sequentially one after the other where each model is built to correct the errors of the previous model. In gradient boosted decision trees (i.e. XGBoost), the gradient and Hessian matrices are used to determine which feature are worth splitting. Here are some useful link on how XGBoost works: concise explanation, documentation, the original paper.", "Here is short summary of the boosting algorithm: the first iteration calculates the error from the mean value of the target, where the mean value is the 1st model in the prediction stack. All subsequent model are scaled by a learning rate, eta*. The number of model estimators should be inversely proportional to the learning rate.", "Scikit-learn has an implementation to create a boosted solution for a custom model, sklearn.ensemble.AdaBoostClassifier.", "Stacking: combines a diverse set of models in another model, i.e., random forest, linear models, etc. This process requires mitigating target leakage. The output from the 1st set of models should not be used to train the 2nd layer for data that the 1st layer has \u201cseen\u201d before. There are various stacking strategies for various situations.", "Here is an excerpt from week 4 of the course:", "b) Meta holdout scheme with OOF meta-features", "c) Meta KFold scheme with OOF meta-features", "d) Holdout scheme with OOF meta-features", "e) KFold scheme with OOF meta-features", "f) KFold scheme in time series", "In time-series task we usually have a fixed period of time we are asked to predict. Like day, week, month or arbitrary period with duration of T.", "g) KFold scheme in time series with limited amount of data", "We may often encounter a situation, where scheme f) is not applicable, especially with limited amount of data. For example, when we have only years 2014, 2015, 2016 in train and we need to predict for a whole year 2017 in test. In such cases scheme c) could be of help, but with one constraint: KFold split should be done with the respect to the time component. For example, in case of data with several years we would treat each year as a fold.", "A pseudo labeling approach can be used to include the test set into training (more data can be better). Use the predicted class (semi-supervised) or randomly assign class from the class distribution. The test set predictions are also calculated with cross-validation.", "It is fairly easy to code up these concepts, but it is difficult to code them with the flexibility to test multiple hypotheses. Getting to grand master status in tabular data competitions is very difficult in 2020. Getting a gold medal require getting to the top 0.2% on the leaderboard. I am currently ranked 4,400 out of all Kaggle competitors with only 2 bronze metals. Usually, there are thousands of competitors of which can use similar methods or strategies. The overall strategies could be similar for the top 10%, but the scores can vary wildly with minor variations in feature development, brute-force hyper parameter tuning, and random seeds. Having a flexible workflow is very important. The minimum computational threshold for these competitions has greatly increased the past few years. To be competitive you need high end specs, i.e., 32GB+ RAM, 6 cores+, 2080 TI GPU+. I do think its worth doing a few tabular data competitions to brush up on your predictive modeling skills.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F17aac6b188d9&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimportant-considerations-to-make-while-predictive-modeling-17aac6b188d9&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimportant-considerations-to-make-while-predictive-modeling-17aac6b188d9&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimportant-considerations-to-make-while-predictive-modeling-17aac6b188d9&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimportant-considerations-to-make-while-predictive-modeling-17aac6b188d9&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----17aac6b188d9--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----17aac6b188d9--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://rohankotwani.medium.com/?source=post_page-----17aac6b188d9--------------------------------", "anchor_text": ""}, {"url": "https://rohankotwani.medium.com/?source=post_page-----17aac6b188d9--------------------------------", "anchor_text": "Rohan Kotwani"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F7db535a7549e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimportant-considerations-to-make-while-predictive-modeling-17aac6b188d9&user=Rohan+Kotwani&userId=7db535a7549e&source=post_page-7db535a7549e----17aac6b188d9---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F17aac6b188d9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimportant-considerations-to-make-while-predictive-modeling-17aac6b188d9&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F17aac6b188d9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimportant-considerations-to-make-while-predictive-modeling-17aac6b188d9&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://www.kaggle.com/progression", "anchor_text": "https://www.kaggle.com/progression"}, {"url": "https://www.coursera.org/learn/competitive-data-science/home/welcome", "anchor_text": "link"}, {"url": "https://github.com/freedomtowin/data-eng-util/blob/master/machine-learning/mean-encoding-regularization.py", "anchor_text": "here"}, {"url": "https://github.com/Far0n/xgbfi", "anchor_text": "link"}, {"url": "https://towardsdatascience.com/how-does-xgboost-work-748bc75c58aa", "anchor_text": "concise explanation"}, {"url": "https://xgboost.readthedocs.io/en/latest/tutorials/model.html", "anchor_text": "documentation"}, {"url": "https://arxiv.org/pdf/1603.02754.pdf", "anchor_text": "the original paper"}, {"url": "https://medium.com/tag/data-science?source=post_page-----17aac6b188d9---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/predictive-modeling?source=post_page-----17aac6b188d9---------------predictive_modeling-----------------", "anchor_text": "Predictive Modeling"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F17aac6b188d9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimportant-considerations-to-make-while-predictive-modeling-17aac6b188d9&user=Rohan+Kotwani&userId=7db535a7549e&source=-----17aac6b188d9---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F17aac6b188d9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimportant-considerations-to-make-while-predictive-modeling-17aac6b188d9&user=Rohan+Kotwani&userId=7db535a7549e&source=-----17aac6b188d9---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F17aac6b188d9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimportant-considerations-to-make-while-predictive-modeling-17aac6b188d9&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----17aac6b188d9--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F17aac6b188d9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimportant-considerations-to-make-while-predictive-modeling-17aac6b188d9&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----17aac6b188d9---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----17aac6b188d9--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----17aac6b188d9--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----17aac6b188d9--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----17aac6b188d9--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----17aac6b188d9--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----17aac6b188d9--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----17aac6b188d9--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----17aac6b188d9--------------------------------", "anchor_text": ""}, {"url": "https://rohankotwani.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://rohankotwani.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Rohan Kotwani"}, {"url": "https://rohankotwani.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "160 Followers"}, {"url": "https://www.linkedin.com/in/rkotwani/", "anchor_text": "https://www.linkedin.com/in/rkotwani/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F7db535a7549e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimportant-considerations-to-make-while-predictive-modeling-17aac6b188d9&user=Rohan+Kotwani&userId=7db535a7549e&source=post_page-7db535a7549e--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F7719c6bbf2fa&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimportant-considerations-to-make-while-predictive-modeling-17aac6b188d9&newsletterV3=7db535a7549e&newsletterV3Id=7719c6bbf2fa&user=Rohan+Kotwani&userId=7db535a7549e&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}