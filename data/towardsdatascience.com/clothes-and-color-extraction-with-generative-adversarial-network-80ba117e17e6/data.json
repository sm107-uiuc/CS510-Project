{"url": "https://towardsdatascience.com/clothes-and-color-extraction-with-generative-adversarial-network-80ba117e17e6", "time": 1683000362.266237, "path": "towardsdatascience.com/clothes-and-color-extraction-with-generative-adversarial-network-80ba117e17e6/", "webpage": {"metadata": {"title": "Clothes and color extraction with Generative Adversarial Network | by Aytan Abdullayeva | Towards Data Science", "h1": "Clothes and color extraction with Generative Adversarial Network", "description": "Image segmentation: In computer vision, image segmentation is the process of partitioning a digital image into multiple segments (sets of pixels). The goal of segmentation is to simplify the\u2026"}, "outgoing_paragraph_urls": [{"url": "https://en.wikipedia.org/wiki/Ian_Goodfellow", "anchor_text": "Ian Goodfellow", "paragraph_index": 4}, {"url": "https://github.com/bearpaw/clothing-co-parsing", "anchor_text": "Clothing Co parsing(CCP) dataset", "paragraph_index": 7}, {"url": "https://github.com/eriklindernoren/Keras-GAN/tree/master/pix2pix", "anchor_text": "source", "paragraph_index": 8}, {"url": "https://github.com/matterport/Mask_RCNN", "anchor_text": "source", "paragraph_index": 17}], "all_paragraphs": ["Let\u2019s briefly go through the key notions used in this article.", "Image segmentation: In computer vision, image segmentation is the process of partitioning a digital image into multiple segments (sets of pixels). The goal of segmentation is to simplify the representation of an image into something that is more meaningful and easier to analyze.", "There are two levels of granularity within the segmentation process:", "Neural Network is a computational learning system that uses a network of functions to understand and translate a data input of one form into a desired output, usually in another form. The concept of the artificial neural network was inspired by human biology and the way neurons of the human brain function together to understand inputs from human senses.", "Generative Adversarial Network(GAN) is a specific type of neural network(Invented by Ian Goodfellow and his colleagues in 2014) which consists of two networks: the Generator part and the Discriminator part. In the training process these networks compete with each other, thus improving one another. The training process starts with random noise, the generator generates output from the noise (because input is some random data, initial outputs are also noisy). The Discriminator compares output with the data from the dataset and realizes that it is far from the pieces from the original dataset so it returns a negative result to the generator. Over time, the generator produces better outputs according to the feedback collected from the discriminator. In the end, the discriminator finds it hard to understand whether the output produced by the generator is original or fake. The key point of this training process is to find the probability density function for the training set and using this function to generate new pieces which do not exist in the dataset.", "So many interesting applications of GAN exist: text-to-image, image-to-image translations, image resolution enhancement, detecting fake paintings, fake face generator (by NVIDIA) etc.", "In this post I\u2019m going to focus on Image-to-image translation.", "For the training process I\u2019ve used Clothing Co parsing(CCP) dataset which contains:", "For training purposes only 1000 pixel-wise segmented images are used. As a network model I used pix2pix implementation of GAN in Keras from the following repo source. I\u2019ve changed the initial code slightly. The size of the model\u2019s input/output was 256x256(input image resolution). For better quality I changed this size to 512x768.", "Why did I decide to use a GAN network? Segmentation tasks could also be done by CNNs. But in comparison to CNNs, a GAN model could learn from lack of data and generate better results. In the training process, the generator saw both original images and their paired pixel-wise segmented versions from the training set.", "First, I tried to train the network with an original CCP dataset, meaning for 59 classes. The experiment failed because the distribution of different types of clothes in the dataset was different, and also, the training set contains a small number of instances per some classes. For example, the number of trousers/pants is about 400, while the number of t-shirts is less than hundred. So an imbalanced and small dataset caused a poor quality of segmentation in inference mode. Then I experimented with merging some classes together (pants/trousers/jeans, all types of shoes, all types of bags etc.). This step reduced the number of classes to 29, but still the quality of segmentation was not as good as desired.", "Finally, I succeeded with a model for \u201cfour classes\u201d: background, skin, hair and all clothes and accessories on the person. This kind of dataset is balanced, because all images in the training set contain instances of all four classes (almost all images with hair). The model trained 3000 epochs for 1k images.", "While testing in inference mode with hundreds of images, I realized that the model is sensitive to background: input images for non-blurred background, clothes and background have similar colors. These are cases of failure. For the artificial neural network model, cases of failure are normal, since it doesn\u2019t learn things as the human brain does. Because the network learns from shapes, colors, and a lot of features which are not obvious to humans, we can\u2019t predict with certainty how it\u2019ll work in different cases.", "But our model works quite well for images with blurry backgrounds:", "So how can we solve this problem? I tried to replace the background of the original image with a solid color manually and realized that with this kind of input the model produces much better results. But how can this job be automated? Mask-RCNN to the rescue!", "Mask R-CNN is an extension of the Object detection algorithm Faster R-CNN with an extra mask head. The extra mask head allows us to pixel-wise segment each object and also extract each object separately without any background.", "I\u2019m going to use a mask (for a person) generated by the Mask-RCNN model.", "I used the following implementation of mask-rcnn in keras: source", "So before feeding the input image into our model, the preprocessing job is done. First the person is segmented from the input image using the Mask-RCNN model and the mask it produces. With this mask we could substitute all pixels which do not belong to the person with a solid color. In our case it\u2019s grey. I tried 3 colors (black, white, grey) for the background, and only grey passed the tests (The reason for this is not clear to me, it\u2019s magic! I hope to find the answer very soon).", "Thus instead of feeding original image to the model, background changed version is provided as an input.", "So far so good. But how can we use these pixel-wise segmented images?", "It\u2019s possible to cut clothes from the image, and besides that to get the main colors of the clothes, as well as skin and hair color. The cut off process for different classes from the segmented image is done by color thresholding, thus we get masks for them. For this purpose I\u2019ve used HSV (Hue, Saturation, Value) color space. The reason why we would use this space instead of RGB is because HSV space describes colors similarly to the way the human eye tends to perceive them. In RGB color space all three components are related to color light, but in HSV space, hue vary relatively less than the changes in external lightning. For example, two shades of red might have similar hue values, but totally different R, G and B values.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F80ba117e17e6&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fclothes-and-color-extraction-with-generative-adversarial-network-80ba117e17e6&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fclothes-and-color-extraction-with-generative-adversarial-network-80ba117e17e6&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fclothes-and-color-extraction-with-generative-adversarial-network-80ba117e17e6&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fclothes-and-color-extraction-with-generative-adversarial-network-80ba117e17e6&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----80ba117e17e6--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----80ba117e17e6--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@ayten.mamedova5?source=post_page-----80ba117e17e6--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@ayten.mamedova5?source=post_page-----80ba117e17e6--------------------------------", "anchor_text": "Aytan Abdullayeva"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F153cb78db7e8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fclothes-and-color-extraction-with-generative-adversarial-network-80ba117e17e6&user=Aytan+Abdullayeva&userId=153cb78db7e8&source=post_page-153cb78db7e8----80ba117e17e6---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F80ba117e17e6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fclothes-and-color-extraction-with-generative-adversarial-network-80ba117e17e6&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F80ba117e17e6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fclothes-and-color-extraction-with-generative-adversarial-network-80ba117e17e6&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://towardsdatascience.com/review-deepmask-instance-segmentation-30327a072339", "anchor_text": "source"}, {"url": "https://en.wikipedia.org/wiki/Ian_Goodfellow", "anchor_text": "Ian Goodfellow"}, {"url": "https://github.com/bearpaw/clothing-co-parsing", "anchor_text": "Clothing Co parsing(CCP) dataset"}, {"url": "https://github.com/eriklindernoren/Keras-GAN/tree/master/pix2pix", "anchor_text": "source"}, {"url": "https://medium.com/@fractaldle/mask-r-cnn-unmasked-c029aa2f1296", "anchor_text": "source"}, {"url": "https://github.com/matterport/Mask_RCNN", "anchor_text": "source"}, {"url": "https://www.zara.com/ie/en/vertical-stripe-t-shirt-p00722426.html", "anchor_text": "source"}, {"url": "https://www.zara.com/uk/en/t-shirt-with-contrast-pocket-p01165176.html", "anchor_text": "image source"}, {"url": "https://deepai.org/machine-learning-glossary-and-terms/neural-network", "anchor_text": "https://deepai.org/machine-learning-glossary-and-terms/neural-network"}, {"url": "https://medium.com/@fractaldle/mask-r-cnn-unmasked-c029aa2f1296", "anchor_text": "https://medium.com/@fractaldle/mask-r-cnn-unmasked-c029aa2f1296"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----80ba117e17e6---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/computer-vision?source=post_page-----80ba117e17e6---------------computer_vision-----------------", "anchor_text": "Computer Vision"}, {"url": "https://medium.com/tag/neural-networks?source=post_page-----80ba117e17e6---------------neural_networks-----------------", "anchor_text": "Neural Networks"}, {"url": "https://medium.com/tag/gans?source=post_page-----80ba117e17e6---------------gans-----------------", "anchor_text": "Gans"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----80ba117e17e6---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F80ba117e17e6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fclothes-and-color-extraction-with-generative-adversarial-network-80ba117e17e6&user=Aytan+Abdullayeva&userId=153cb78db7e8&source=-----80ba117e17e6---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F80ba117e17e6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fclothes-and-color-extraction-with-generative-adversarial-network-80ba117e17e6&user=Aytan+Abdullayeva&userId=153cb78db7e8&source=-----80ba117e17e6---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F80ba117e17e6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fclothes-and-color-extraction-with-generative-adversarial-network-80ba117e17e6&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----80ba117e17e6--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F80ba117e17e6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fclothes-and-color-extraction-with-generative-adversarial-network-80ba117e17e6&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----80ba117e17e6---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----80ba117e17e6--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----80ba117e17e6--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----80ba117e17e6--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----80ba117e17e6--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----80ba117e17e6--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----80ba117e17e6--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----80ba117e17e6--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----80ba117e17e6--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@ayten.mamedova5?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@ayten.mamedova5?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Aytan Abdullayeva"}, {"url": "https://medium.com/@ayten.mamedova5/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "36 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F153cb78db7e8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fclothes-and-color-extraction-with-generative-adversarial-network-80ba117e17e6&user=Aytan+Abdullayeva&userId=153cb78db7e8&source=post_page-153cb78db7e8--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F48c568815fb5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fclothes-and-color-extraction-with-generative-adversarial-network-80ba117e17e6&newsletterV3=153cb78db7e8&newsletterV3Id=48c568815fb5&user=Aytan+Abdullayeva&userId=153cb78db7e8&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}