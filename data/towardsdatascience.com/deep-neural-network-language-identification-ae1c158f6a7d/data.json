{"url": "https://towardsdatascience.com/deep-neural-network-language-identification-ae1c158f6a7d", "time": 1683013021.388056, "path": "towardsdatascience.com/deep-neural-network-language-identification-ae1c158f6a7d/", "webpage": {"metadata": {"title": "Deep Neural Network Language Identification | by Conor O'Sullivan | Towards Data Science", "h1": "Deep Neural Network Language Identification", "description": "Language identification can be an important step in a Natural Language Processing (NLP) problem. It involves trying to predict the natural language of a piece of text. It is important to know the\u2026"}, "outgoing_paragraph_urls": [{"url": "https://translate.google.com/", "anchor_text": "google translate", "paragraph_index": 0}, {"url": "https://github.com/conorosully/medium-articles", "anchor_text": "GitHub", "paragraph_index": 1}, {"url": "https://downloads.tatoeba.org/exports/", "anchor_text": "dataset", "paragraph_index": 2}, {"url": "https://machinelearningmastery.com/gentle-introduction-bag-words-model/", "anchor_text": "bag-of-words", "paragraph_index": 5}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.feature_extraction.text.CountVectorizer.html", "anchor_text": "CountVectorizer", "paragraph_index": 9}, {"url": "http://www.flaticon.com/", "anchor_text": "www.flaticon.com", "paragraph_index": 23}, {"url": "https://support.flaticon.com/hc/en-us/articles/202798201-What-are-Flaticon-Premium-licenses-", "anchor_text": "Premium Plan", "paragraph_index": 23}], "all_paragraphs": ["Language identification can be an important step in a Natural Language Processing (NLP) problem. It involves trying to predict the natural language of a piece of text. It is important to know the language of text before other actions (i.e. translation/ sentiment analysis) can be taken. For instance, if you go to google translate the box you type in says \u2018Detect Language\u2019. This is because Google is first trying to identify the language of your sentence before it can be translated.", "There are several different approaches to language identification and, in this article, we\u2019ll explore one in detail. That is using a Neural Network and character n-grams as features. In the end, we show that an accuracy of over 98% can be achieved with this approach. Along the way, we will discuss key pieces of code and you can find the full project on GitHub. Firstly, we\u2019ll discuss the dataset that we\u2019ll use to train our Neural Network.", "The dataset is provided by Tatoeba. The full dataset consists of 6,872,356 sentences in 328 unique languages. To simplify our problem we will consider:", "We can see an example of a sentence from each language in Table 1. Our objective is to create a model that can predict the Target Variable using the Text provided.", "We load the dataset and do some initial processing in the code below. We first filter the dataset to get sentences of the desired length and language. We randomly select 50,000 sentences from each of these languages so that we have 300,000 rows in total. These sentences are then split into a training (70%), validation (20%) and test (10%) set.", "Before we can fit a model, we have to transform our dataset into a form that a Neural Network will understand. In other words, we need to extract features from our list of sentences to create a feature matrix. We do this using character n-grams which are sets of n consecutive characters. This is a similar approach to a bag-of-words model except we are using characters and not words.", "For our language identification problem, we will be using character 3-grams/trigrams (i.e. sets of 3 consecutive characters). In Figure 2, we see an example of how sentences can be vectorised using trigrams. Firstly, we get all the trigrams from the sentences. To reduce the feature space, we take a subset of these trigrams. We use this subset to vectorise the sentences. The vector for the first sentence is [2,0,1,0,0] as the trigram \u2018is_\u2019 occurs twice and \u2018his\u2019 occurs once in the sentence.", "The process for creating our trigram feature matrix is similar but a bit more complicated. In the next section, we will dive into the code used to create the matrix. Before that, it is worth having a general overview of how we create our feature matrix. The steps taken are:", "We can see an example of such a feature matrix in Table 2. The top row gives each of the 663 trigrams. Then each of the numbered rows gives one of the sentences in our dataset. The numbers within the matrix give the number of times that trigram occurs within the sentence. For example, \u201cj\u2019a\u201d occurs once in sentence 2.", "In this section, we go over the code used to create the training feature matrix in Table 2 and the validation/ testing feature matrix. We make extensive use of the CountVectorizer package provided by SciKit Learn. This package allows us to vectorised text based on some vocabulary list (i.e. a list of words/ characters). In our case, the vocabulary list is a set of 663 trigrams.", "Firstly, we have to create this vocabulary list. We start by obtaining the 200 most common trigrams from each language. This is done using the get_trigrams function in the code below. This function takes a list of sentences and will return the list of the 200 most common trigrams from these sentences.", "In the code below, we loop over each of the 6 languages. For each language, we get the relevant sentences from the training set. We then use the get_trigrams function to obtain the 200 most common trigrams and add them to a set. In the end, as the languages share some common trigrams, we have a set of 663 unique trigrams. We use these to create a vocabulary list.", "The vocabulary list is then used by the CountVectorisor package to vectorise each of the sentences in our training set. The result is the feature matrix in Table 2 that we saw previously.", "The final step, before we can train our model, is to scale our feature matrix. This will help our Neural Network to converge to the optimal parameter weights. In the code below, we scale the training matrix using min-max scaling.", "We also need to obtain the feature matrices for the validation and testing datasets. In the code below, we vectorise and scale the 2 sets as we did with the training set. It is important to note that we used the vocabulary list as well as the min/max values obtained from the training set. This is to avoid any data leakage.", "We now have the datasets in a form ready to be used to train our Neural Network. Before we do that, it would be useful to explore the dataset and build up a bit of an intuition around how well these features will do at predicting the languages. Figure 2 gives the number of trigrams each language has in common with the others. For example, English and German have 55 of their most common trigrams in common.", "With 127, we see that Spanish and Portuguese have the most trigrams in common. This makes sense as, among all the languages, these two are the most lexically similar. What this means is that, using these features, our model may find it difficult to distinguish Spanish from Portuguese and visa versa. Similarly, Portuguese and German have the least trigrams in common and we could expect our model to be better at distinguishing these languages.", "Before choosing the final model structure, I did a bit of hyperparameter tuning. I varied the number of nodes in the hidden layers, the number of epochs and the batch-size. The hyperparameter combination that achieved the highest accuracy on the validation set was chosen for the final model.", "The final model has 3 hidden layers with 500, 500 and 250 nodes respectfully. The output layer has 6 nodes, one for each language. The hidden layers all have ReLU activation functions and, as mentioned, the output layer has a softmax activation function. We train this model using 4 epochs and a batch size of 100. Using our training set and one-hot encoded target variable list, we train this DDN in the code below. In the end, we achieve a training accuracy of 99.70%.", "During the model training process, the model can become biased towards the training set as well as the validation set. So it is best to determine the model accuracy on an unseen test set. The final accuracy on the test set was 98.26%. This is lower than the training accuracy of 99.70% suggesting that some overfitting to the training set has occurred.", "We can get a better idea of how well the model does for each language by looking at the confusion matrix in Figure 3. The red diagonal gives the number of correct predictions for each language. The off-diagonal numbers give the number of times a language was incorrectly predicted as another. For example, German is incorrectly predicted as English 10 times. We see that the model most often confuses either Portuguese for Spanish (124 times) or Spanish for Portuguese (61 times). This follows from what we saw when exploring our features.", "The code used to create this confusion matrix is given below. Firstly, we use our model trained above to make predictions on the test set. Using these predicted languages and the actual languages, we create a confusion matrix and visualise it using a seaborn heatmap.", "In the end, the test accuracy of 98.26% leaves room for improvement. In terms of feature selection, we have kept things simple and have just selected the 200 most common trigrams for each language. A more complicated approach could help us differentiate the languages that are more similar. For example, we could select trigrams that are common in Spanish but not so common in Portuguese and visa versa. We could also experiment with different models. Hopefully, this is a good starting point for your language identification experiments.", "All images are my own or obtain from www.flaticon.com. In the case of the latter, I have a \u201cFull license\u201d as defined under their Premium Plan.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Scientist | Writer | Houseplant Addict | I write about IML, XAI, Algorithm Fairness and Data Exploration | New article (nearly) every week!"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fae1c158f6a7d&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-neural-network-language-identification-ae1c158f6a7d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-neural-network-language-identification-ae1c158f6a7d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-neural-network-language-identification-ae1c158f6a7d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-neural-network-language-identification-ae1c158f6a7d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----ae1c158f6a7d--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----ae1c158f6a7d--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://conorosullyds.medium.com/?source=post_page-----ae1c158f6a7d--------------------------------", "anchor_text": ""}, {"url": "https://conorosullyds.medium.com/?source=post_page-----ae1c158f6a7d--------------------------------", "anchor_text": "Conor O'Sullivan"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F4ae48256fb37&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-neural-network-language-identification-ae1c158f6a7d&user=Conor+O%27Sullivan&userId=4ae48256fb37&source=post_page-4ae48256fb37----ae1c158f6a7d---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fae1c158f6a7d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-neural-network-language-identification-ae1c158f6a7d&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fae1c158f6a7d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-neural-network-language-identification-ae1c158f6a7d&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://www.flaticon.com/premium-icon/cyborg_901032", "anchor_text": "flaticon"}, {"url": "https://translate.google.com/", "anchor_text": "google translate"}, {"url": "https://github.com/conorosully/medium-articles", "anchor_text": "GitHub"}, {"url": "https://downloads.tatoeba.org/exports/", "anchor_text": "dataset"}, {"url": "https://machinelearningmastery.com/gentle-introduction-bag-words-model/", "anchor_text": "bag-of-words"}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.feature_extraction.text.CountVectorizer.html", "anchor_text": "CountVectorizer"}, {"url": "https://keras.io/", "anchor_text": "keras"}, {"url": "http://www.flaticon.com/", "anchor_text": "www.flaticon.com"}, {"url": "https://support.flaticon.com/hc/en-us/articles/202798201-What-are-Flaticon-Premium-licenses-", "anchor_text": "Premium Plan"}, {"url": "https://www.researchgate.net/publication/290102620_Language_identification_A_neural_network_approach", "anchor_text": "https://www.researchgate.net/publication/290102620_Language_identification_A_neural_network_approach"}, {"url": "https://www.sciencedirect.com/science/article/abs/pii/S0885230812000058", "anchor_text": "https://www.sciencedirect.com/science/article/abs/pii/S0885230812000058"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----ae1c158f6a7d---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----ae1c158f6a7d---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----ae1c158f6a7d---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/neural-networks?source=post_page-----ae1c158f6a7d---------------neural_networks-----------------", "anchor_text": "Neural Networks"}, {"url": "https://medium.com/tag/towards-data-science?source=post_page-----ae1c158f6a7d---------------towards_data_science-----------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fae1c158f6a7d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-neural-network-language-identification-ae1c158f6a7d&user=Conor+O%27Sullivan&userId=4ae48256fb37&source=-----ae1c158f6a7d---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fae1c158f6a7d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-neural-network-language-identification-ae1c158f6a7d&user=Conor+O%27Sullivan&userId=4ae48256fb37&source=-----ae1c158f6a7d---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fae1c158f6a7d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-neural-network-language-identification-ae1c158f6a7d&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----ae1c158f6a7d--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fae1c158f6a7d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-neural-network-language-identification-ae1c158f6a7d&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----ae1c158f6a7d---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----ae1c158f6a7d--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----ae1c158f6a7d--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----ae1c158f6a7d--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----ae1c158f6a7d--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----ae1c158f6a7d--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----ae1c158f6a7d--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----ae1c158f6a7d--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----ae1c158f6a7d--------------------------------", "anchor_text": ""}, {"url": "https://conorosullyds.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://conorosullyds.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Conor O'Sullivan"}, {"url": "https://conorosullyds.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "3.3K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F4ae48256fb37&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-neural-network-language-identification-ae1c158f6a7d&user=Conor+O%27Sullivan&userId=4ae48256fb37&source=post_page-4ae48256fb37--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F93bef42da4fd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-neural-network-language-identification-ae1c158f6a7d&newsletterV3=4ae48256fb37&newsletterV3Id=93bef42da4fd&user=Conor+O%27Sullivan&userId=4ae48256fb37&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}