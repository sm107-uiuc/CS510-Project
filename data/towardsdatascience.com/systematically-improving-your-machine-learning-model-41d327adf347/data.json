{"url": "https://towardsdatascience.com/systematically-improving-your-machine-learning-model-41d327adf347", "time": 1683016757.03467, "path": "towardsdatascience.com/systematically-improving-your-machine-learning-model-41d327adf347/", "webpage": {"metadata": {"title": "Systematically Improving Your Machine Learning Model | by Kurtis Pykes | Towards Data Science", "h1": "Systematically Improving Your Machine Learning Model", "description": "When working on a Machine learning task, it\u2019s highly likely the process will be extremely iterative due to the nature of Machine Learning, which involves a computer learning without being explicitly\u2026"}, "outgoing_paragraph_urls": [{"url": "https://en.wikipedia.org/wiki/Learning_curve_(machine_learning)", "anchor_text": "Wikipedia", "paragraph_index": 9}, {"url": "https://machinelearningmastery.com/learning-curves-for-diagnosing-machine-learning-model-performance/", "anchor_text": "Learning Curves for Diagnosing Machine Learning Performance", "paragraph_index": 20}, {"url": "http://t.co/z8Cp77lVza", "anchor_text": "http://t.co/z8Cp77lVza", "paragraph_index": 31}, {"url": "https://en.wikipedia.org/wiki/Tf%E2%80%93idf#:~:text=In%20information%20retrieval%2C%20tf%E2%80%93idf,in%20a%20collection%20or%20corpus.", "anchor_text": "TF-IDF", "paragraph_index": 37}], "all_paragraphs": ["When working on a Machine learning task, it\u2019s highly likely the process will be extremely iterative due to the nature of Machine Learning, which involves a computer learning without being explicitly programmed.", "Similar to how we work on mock exams to improve ourselves in an attempt to achieve higher grades on the real exam, we use mock instances \u2014 better known as validation data \u2014 to infer how we can expect to do when the model is placed in the real world.", "If you think of how we improve by using mock exams, it generally consist of identifying what we have done wrong and revisit those subjects. Likewise, if we could identify the areas in which our machine learning models makes errors, we can revisit those places and make some adjustments to improve our model \u201cmock score\u201d in turn implying we will achieve a better result when the model meets the real world.", "Therefore, before we can begin to understand the type of errors our Machine Learning model is making we ought to have made some sort of attempt at trying to predict something already \u2014 we need to take the exam. Hence, many experienced practitioners would advise beginning practitioners to start with a simple algorithm that can be implemented quickly and tested on validation data.", "This implementation does not have to be extremely great. As long as we are able to make predictions and gain some sort of insight into our data we can begin to improve our model systematically.", "An example of a quick and dirty implementation is the beginning of my Twitter Sentiment Analysis project.", "Note: For the rest of this article, I will be making references to this project. Please familiarise yourself with what was done by reading the article below before carrying on with this post.", "In this project, the aim is to predict whether a tweet is about a disaster or not given the tweet, location, and keyword (although not all tweets are accompanied by location or keyword).", "\u201cLet evidence guide you on where to spend your time rather than use gut feeling which is often wrong\u201d \u2014 Andrew Ng", "In machine learning, a learning curve (or training curve) shows the validation and training score of an estimator for varying numbers of training samples. It is a tool to find out how much a machine learning model benefits from adding more training data and whether the estimator suffers more from a variance error or a bias error (Source: Wikipedia).", "Learning Curves are extremely useful for sanity checks on whether your Machine Learning algorithm is working correctly or if you want to improve the performance of your machine learning algorithm \u2014 We will be applying a learning curve to the classifier we used for Twitter sentiment classification at some stage to better understand better our model.", "Given we have a training and test set, it\u2019s important to understand how the classifiers perform depending on the size of the training set. Therefore, learning curves are a plot of the model's performance which is often denoted as cost against the size of the training and test set.", "Note: I prefer to do all analysis and exploratory work in a Juypter notebook as I\u2019ve done to generate the outputs shown in Figure 1. See the Github Channel for.", "From the learning curve, we can see our model is not doing particularly well on the training data and is doing severely bad on the validation data. The large gap between the training score and validation score suggests there is a large variance between the model predictions on training and validation data. However, since this is a Kaggle dataset, adding more data isn\u2019t necessarily something that is straightforward (though it may be useful in the real-world to overcome this problem).", "However, after some analysis of my data I realized that the preprocessing I had done was the error. I attempted to add the 3 text columns ( text, location, keyword) together to make one column containing all of our text, but the location and keyword columns have missing values, so when I added those columns to the text column without first dealing with the missing values, the function deleted a number of tweets \u2014 see Figure 2.", "Therefore, it is likely we have deleted too much data which is making it difficult for the model to learn well. Hence, we can easily repeat this process but instead correct how we add all the columns together by filling the missing values with a \u201cnone\u201d marker \u2014 see Figure 3 for the result.", "But the all-important question is did this slight change improve our model? We can answer this question by checking in with our learning curve once again.", "You bet it improved the model! The model is performing much better on the training and the cross-validation data. However, there is still a large variance between the scores on our training data and our cross-validation sets. At this point, you\u2019ll see many Kagglers rush to the more powerful models. This is not necessarily bad, but there may be times where you have limited resources in the real-world and you need a model that can work in production, which is not the case for many of the winning solutions on Kaggle.", "Instead, we will first perform something known as error analysis to get a better look at some things that we can adjust to improve our models fit on new instances.", "Note: The small preprocessing change we made took our public leaderboard score from 0.71008 to 0.79374.", "For a more in-depth tutorial about Learning curves, I recommend viewing \u201cLearning Curves for Diagnosing Machine Learning Performance\u201d by Jason Brownlee at Machine Learning Mastery.", "Error analysis is a process where we manually identify the examples in our validation data that our model predicted incorrectly. The idea of this is to identify systematic trends based on the errors that our model made.", "To provide a similar scenario of error analysis, we can use our exam preparation example we used above. Say we have just completed a math mock exam and now we are marking our work and see we got 40/60. We would now go through the paper and see what it was we got wrong and mark them into certain categories:", "The table above informs us that among the 20 errors that we made, 15% of those errors were to do with calculus, 25% were to do with Statistics, and 60% was to do with Linear Algebra. Based on this information what would you now seek to improve first?", "Hopefully, you said you would spend your time trying to improve your Linear Algebra skills because if you improve that, that would add a more significant boost to your overall score on the new mock paper than if you were to improve statistics or calculus first.", "Therefore in a Machine Learning setting, you could say error analysis is what provides direction for where to go next when you are attempting to improve your machine learning model. You simply identify the systematic trends in the errors the model made on the validation data (i.e. Tweets with hashtags were always classified a certain way, or tweets with URLs were always classified incorrectly).", "Let\u2019s do some error analysis using our Twitter Sentiment Data. The first thing I will do is take 100 misclassified instances (therefore 20 from each fold). Next, I will create a Dataframe which I will save as a CSV file containing the original tweet, the processed tweet, the actual score, and the predicted score.", "Please note that there may be some offensive language used in some of the tweets.", "After that, I will manually examine the errors and categorize them into separate headings. We do this by manually examining the errors based on various factors such as the type of tweet (i.e. news report, experience, opinion), and the actual errors being made that we believe if corrected for can improve the algorithm (i.e. metaphorical errors, spelling mistakes, sarcasm).", "Fortunately, I\u2019ve done this task as an example with 50 randomly selected misclassified instances (ideally you may want to do it on more, but this is just an example) based on the type of tweet. Here are my findings:", "There are 32% mislabeled examples from the 50 random misclassified samples that we took. Meaning, they do not come across as a disaster and they are labelled as a disaster or they are not a disaster and they are labelled disaster, from my own opinion.", "\u201cI liked a @YouTube video http://t.co/z8Cp77lVza Boeing 737 takeoff in snowstorm. HD cockpit view + ATC audio \u2014 Episode 18snowstormPorthcawl\u201d", "\u2026is labelled as being a disaster, but a human wouldn\u2019t instantly class this as NOT being a disaster.", "\u201c@PrablematicLA @Adweek I\u2019m actually currently dressed for a snowstorm\u2026despite being in the middle of a Texas summer. Thanks office A/C.snowstormAustin, TX\u201d.", "This is marked as being a disaster but we can easily tell it is not necessarily a disaster. It may be a disaster for the person making the tweet but in the general publics eye this is not a disaster that one would be concerned about.", "The data we are using is a Kaggle Dataset so going back to relabel instances won\u2019t necessarily be beneficial for us since the test data we have no access to would also probably be labelled accordingly. However, in a real-world scenario I\u2019d definitely seek clarity on the definition of the term disaster in the context that we are using it. Based upon the definition, we may have to relabel the data again or look at the 2nd types of tweets our algorithm made errors on and begin working on improving our algorithms ability on those.", "Error analysis is very beneficial for determining what sort of errors our algorithm is making, hence providing us with good insight to what we can improve to provide us with the most significant improvement to our model. On the other hand, Error analysis is incapable of distinguishing whether something like stemming or how we vectorize the text is beneficial to the final solution, and the only solution is to try it and evaluate the change on the evaluation metric.", "With that being said, let\u2019s attempt to use TF-IDF to convert our text into vectors.", "This didn\u2019t improve our score of 0.79374 so I would not continue with TF-IDF, or I may try tf-idf without stemming, etc.", "If you enjoyed this post, you\u2019d also like:", "You\u2019ve now see the iterative nature of Machine Learning practically\u2026 I personally like to use evidence as much as possible when I am attempting to improve my machine learning models. I try to understand the bias-variance of the model with learning curves and then use error analysis to allot my time to the task that will provide the most significant improvement to the model if I were to improve at that task.", "Thank you for reading to the end, feel free to shoot me a message on LinkedIn:", "If you are interested in starting your own blog, subscribe to me on youtube for all my best tips on how you may get started:", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F41d327adf347&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsystematically-improving-your-machine-learning-model-41d327adf347&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsystematically-improving-your-machine-learning-model-41d327adf347&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsystematically-improving-your-machine-learning-model-41d327adf347&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsystematically-improving-your-machine-learning-model-41d327adf347&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----41d327adf347--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----41d327adf347--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://kurtispykes.medium.com/?source=post_page-----41d327adf347--------------------------------", "anchor_text": ""}, {"url": "https://kurtispykes.medium.com/?source=post_page-----41d327adf347--------------------------------", "anchor_text": "Kurtis Pykes"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F5ba760786877&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsystematically-improving-your-machine-learning-model-41d327adf347&user=Kurtis+Pykes&userId=5ba760786877&source=post_page-5ba760786877----41d327adf347---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F41d327adf347&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsystematically-improving-your-machine-learning-model-41d327adf347&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F41d327adf347&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsystematically-improving-your-machine-learning-model-41d327adf347&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@grstocks?utm_source=medium&utm_medium=referral", "anchor_text": "GR Stocks"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://towardsdatascience.com/predicting-tweet-sentiment-with-machine-learning-3599c8add259", "anchor_text": "Predicting Tweet Sentiment with Machine LearningSentiment analysis on Tweetstowardsdatascience.com"}, {"url": "https://en.wikipedia.org/wiki/Learning_curve_(machine_learning)", "anchor_text": "Wikipedia"}, {"url": "https://towardsdatascience.com/predicting-tweet-sentiment-with-machine-learning-3599c8add259", "anchor_text": "Twitter Sentiment Data"}, {"url": "https://machinelearningmastery.com/learning-curves-for-diagnosing-machine-learning-model-performance/", "anchor_text": "Learning Curves for Diagnosing Machine Learning Performance"}, {"url": "http://t.co/z8Cp77lVza", "anchor_text": "http://t.co/z8Cp77lVza"}, {"url": "https://en.wikipedia.org/wiki/Tf%E2%80%93idf#:~:text=In%20information%20retrieval%2C%20tf%E2%80%93idf,in%20a%20collection%20or%20corpus.", "anchor_text": "TF-IDF"}, {"url": "https://towardsdatascience.com/using-machine-learning-to-detect-fraud-f204910389cf", "anchor_text": "Using Machine Learning To Detect FraudThe beginning of an End-to-End Machine Learning Projecttowardsdatascience.com"}, {"url": "https://towardsdatascience.com/how-to-make-your-data-science-projects-stand-out-b91d3861a885", "anchor_text": "How To Make Your Data Science Projects Stand OutCreate an effective READMEtowardsdatascience.com"}, {"url": "https://towardsdatascience.com/getting-started-with-sentiment-analysis-731531ec880d", "anchor_text": "Getting Started With Sentiment AnalysisNotes From Natural Language Processing Specialization Course1 Week1towardsdatascience.com"}, {"url": "https://www.linkedin.com/in/kurtispykes/", "anchor_text": "Kurtis Pykes - Data Scientist - Freelance, self-employed | LinkedInView Kurtis Pykes' profile on LinkedIn, the world's largest professional community. Kurtis has 3 jobs listed on their\u2026www.linkedin.com"}, {"url": "https://www.youtube.com/channel/UCu6zdBQhvEY5_j-ifHWljYw?view_as=subscriber", "anchor_text": "Kurtis PykesEnjoy the videos and music you love, upload original content, and share it all with friends, family, and the world on\u2026www.youtube.com"}, {"url": "https://medium.com/tag/education?source=post_page-----41d327adf347---------------education-----------------", "anchor_text": "Education"}, {"url": "https://medium.com/tag/innovation?source=post_page-----41d327adf347---------------innovation-----------------", "anchor_text": "Innovation"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----41d327adf347---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/technology?source=post_page-----41d327adf347---------------technology-----------------", "anchor_text": "Technology"}, {"url": "https://medium.com/tag/advice?source=post_page-----41d327adf347---------------advice-----------------", "anchor_text": "Advice"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F41d327adf347&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsystematically-improving-your-machine-learning-model-41d327adf347&user=Kurtis+Pykes&userId=5ba760786877&source=-----41d327adf347---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F41d327adf347&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsystematically-improving-your-machine-learning-model-41d327adf347&user=Kurtis+Pykes&userId=5ba760786877&source=-----41d327adf347---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F41d327adf347&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsystematically-improving-your-machine-learning-model-41d327adf347&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----41d327adf347--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F41d327adf347&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsystematically-improving-your-machine-learning-model-41d327adf347&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----41d327adf347---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----41d327adf347--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----41d327adf347--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----41d327adf347--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----41d327adf347--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----41d327adf347--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----41d327adf347--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----41d327adf347--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----41d327adf347--------------------------------", "anchor_text": ""}, {"url": "https://kurtispykes.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://kurtispykes.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Kurtis Pykes"}, {"url": "https://kurtispykes.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "9.3K Followers"}, {"url": "https://www.fullstackfreelancershub.com/wisdom-wednesday", "anchor_text": "https://www.fullstackfreelancershub.com/wisdom-wednesday"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F5ba760786877&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsystematically-improving-your-machine-learning-model-41d327adf347&user=Kurtis+Pykes&userId=5ba760786877&source=post_page-5ba760786877--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Ffde3d752d24c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsystematically-improving-your-machine-learning-model-41d327adf347&newsletterV3=5ba760786877&newsletterV3Id=fde3d752d24c&user=Kurtis+Pykes&userId=5ba760786877&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}