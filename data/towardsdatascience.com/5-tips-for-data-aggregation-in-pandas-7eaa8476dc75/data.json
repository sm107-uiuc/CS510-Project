{"url": "https://towardsdatascience.com/5-tips-for-data-aggregation-in-pandas-7eaa8476dc75", "time": 1683014183.591872, "path": "towardsdatascience.com/5-tips-for-data-aggregation-in-pandas-7eaa8476dc75/", "webpage": {"metadata": {"title": "5 tips for data aggregation in pandas | by Zolzaya Luvsandorj | Towards Data Science", "h1": "5 tips for data aggregation in pandas", "description": "When doing data analysis, being able to skillfully aggregate data plays an important role. Pandas provides many useful methods, some of which are perhaps less popular than others. Moreover, even for\u2026"}, "outgoing_paragraph_urls": [{"url": "https://pandas.pydata.org/pandas-docs/stable/getting_started/install.html", "anchor_text": "pandas", "paragraph_index": 3}, {"url": "https://seaborn.pydata.org/installing.html", "anchor_text": "seaborn", "paragraph_index": 3}, {"url": "https://www.python.org/about/gettingstarted/", "anchor_text": "this", "paragraph_index": 4}, {"url": "https://pandas.pydata.org/pandas-docs/stable/user_guide/10min.html", "anchor_text": "this", "paragraph_index": 4}, {"url": "https://vincentarelbundock.github.io/Rdatasets/doc/reshape2/tips.html", "anchor_text": "here", "paragraph_index": 7}, {"url": "https://vincentarelbundock.github.io/Rdatasets/doc/reshape2/tips.html", "anchor_text": "\u201cOne waiter recorded information about each tip he received over a period of a few months working in one restaurant.\u201d", "paragraph_index": 8}, {"url": "https://zluvsand.medium.com/membership", "anchor_text": "my referral link", "paragraph_index": 46}, {"url": "https://towardsdatascience.com/writing-5-common-sql-queries-in-pandas-90b52f17ad76", "anchor_text": "Writing 5 common SQL queries in pandas", "paragraph_index": 47}, {"url": "https://towardsdatascience.com/5-tips-for-pandas-users-e73681d16d17", "anchor_text": "5 tips for pandas users", "paragraph_index": 47}, {"url": "https://towardsdatascience.com/transforming-variables-in-a-pandas-dataframe-bce2c6ef91a1", "anchor_text": "How to transform variables in a pandas DataFrame", "paragraph_index": 47}, {"url": "https://zluvsand.github.io/", "anchor_text": "https://zluvsand.github.io/", "paragraph_index": 49}], "all_paragraphs": ["When doing data analysis, being able to skillfully aggregate data plays an important role. Pandas provides many useful methods, some of which are perhaps less popular than others. Moreover, even for the well-known methods, we could increase its utility by tweaking its arguments further or complement it with other methods. With these considerations, here are 5 tips on data aggregation in pandas in case you haven\u2019t across these before:", "In this post, I will demonstrate how they are useful with examples. I also hope these tips will help you write a clear, concise and readable code.", "I assume the reader (\ud83d\udc40 yes, you!) has:\u25fc\ufe0f access to and is familiar with Python including installing packages, defining functions and other basic tasks\u25fc\ufe0f working knowledge using pandas including basic data manipulation.", "Make sure you have both pandas and seaborn installed if you haven\u2019t already.", "If you are new to Python, this is a good place to get started. If you haven\u2019t used pandas before, this is a good resource to check out.", "I have used and tested the scripts in Python 3.7.1 in Jupyter Notebook.", "We will use seaborn\u2019s tips dataset to illustrate my tips.", "Details about this dataset including data dictionary can be found here (this source is actually for R, but it appears to be referring to the same underlying dataset). I have quoted their data description below for quick access:", "\u201cOne waiter recorded information about each tip he received over a period of a few months working in one restaurant.\u201d", "You are probably already familiar with this series function: value_counts(). Running df['day'].value_counts() will give us the counts of unique values in day variable. If we specify normalize=True inside the method, it will give us percentages instead. This is useful for a single variable, but sometimes we need to see counts by multiple variables. For instance, if we wanted to get counts by day and time, one way to get this is to use groupby() + size() + unstack():", "Another more flexible way is to use crosstab():", "Using crosstab() has some advantages. Firstly, it\u2019s easy to get row and column subtotals - we just add margins=True:", "Isn\u2019t it awesome? Secondly, we can easily get percentages instead of counts by tweaking the normalize argument:", "In this example, we got table percentages by setting normalize=True. This is equivalent to setting it to normalize='all'. For row percentages, we use normalize='index' and normalize='columns' for column percentages. We could further extend the variable sets for columns and rows too:", "After discovering crosstab(), I now use it regularly when using pandas.", "You may already know about both groupby() and describe(). But have you used them together? By using these two together, we can check the summary statistics of a numeric variable by unique values in a categorical column with just one line like this:", "We can see how the summary statistics of tip compare across days.", "In this post, we will use agg(), the alias of aggregate(). However, both can be used interchangeably.", "You may probably know the basic aggregation syntax like this one:", "Here are some alternative ways to get the same output with agg():", "In this simple example, there isn\u2019t a clear advantage why one should use agg() over the first alternative. However, using agg() gives us more flexibility when we want to look at output of multiple aggregate functions. For instance, we can get both mean and standard deviation at one go by either passing a list or a dictionary to agg().", "If we ever had to rename the output columns, instead of doing this:", "we could do either of these more succinctly:", "Using either list or dictionary so far has worked equally. However, using list is more concise if we want to inspect a same set of summary statistics for multiple variables.", "On the other hand, sometimes using dictionary is the way to go. With dictionary, we can specify different sets of aggregate functions for each variable:", "There are many aggregate functions to use:", "On top of these, we could use any Series or DataFrame method inside agg(). For instance, to see the highest two tips by day, we use:", "We can see that some of the biggest tips were on Saturday. \ud83d\udcb0", "In addition, we could use lambda functions too:", "This extends the possibility of what we could do! \ud83d\ude0e", "Let\u2019s say we needed to get the mean tip by 2 variables. A common approach is to use groupby():", "But a slightly better way to do this is to use pivot_table():", "Here, we didn\u2019t specify the arguments because we have provided the values to the method in the correct order. Here is another version of the same code where all arguments are explicitly specified:", "This version is probably more readable. I think readability won\u2019t be compromised if we omit the first argument name to be slightly more concise:", "We will keep this format moving forward.", "By default, pivot_table() gives us mean values. However, we can easily change to our preferred function such as sum() by specifying it to the aggfunc argument:", "Similar to crosstab(), it's also easy to get subtotals with pivot_table().", "We can also pass dictionary to aggfunc to customise the aggregate functions for each variable passed to values argument. Another useful argument is fill_value where we specify what values we want to see if the output is missing. Let\u2019s see an example exemplifying these points:", "With pivot_table(), you know exactly which variables would be in rows and columns and no reshaping the data is necessary.", "This tip is useful when we want to append the group aggregate measures back to the ungrouped data. Here is an example to clarify this:", "In this example, newly created variable avg_tip_by_gender shows average tip by gender. In other words, mean tip by gender from below have been added back to the ungrouped data.", "Now, let\u2019s take a slightly more advanced example:", "Here, using lambda function, we did 3 things for variable tip:", "x.mean(): Find mean by gender.x-x.mean(): Find the distance from mean by gender.(x-x.mean())/x.std(): Find the distance in units of standard deviation.", "That\u2019s what we find in the first row of n_sd_from_gender_avg_tip. For this record, the tip amount was about 1.57 standard deviations lower than the average tip among female customers.", "Voila\u2755 These were my current top data aggregation tips in pandas!", "Would you like to access more content like this? Medium members get unlimited access to any articles on Medium. If you become a member using my referral link, a portion of your membership fee will directly go to support me.", "Thank you for reading my post. Hope you find my tips useful \u2702\ufe0f. If you are interested to learn more about pandas, here are links to my other posts:\u25fc\ufe0f\ufe0f Writing 5 common SQL queries in pandas\u25fc\ufe0f\ufe0f 5 tips for pandas users\u25fc\ufe0f\ufe0f How to transform variables in a pandas DataFrame", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Scientist \ud83d\udca1| Growth Mindset \ud83d\udd11 | Math Lover \ud83d\udd22 | Melbourne, AU \ud83d\udc28 | https://zluvsand.github.io/"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F7eaa8476dc75&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F5-tips-for-data-aggregation-in-pandas-7eaa8476dc75&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2F5-tips-for-data-aggregation-in-pandas-7eaa8476dc75&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F5-tips-for-data-aggregation-in-pandas-7eaa8476dc75&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2F5-tips-for-data-aggregation-in-pandas-7eaa8476dc75&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----7eaa8476dc75--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----7eaa8476dc75--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://zluvsand.medium.com/?source=post_page-----7eaa8476dc75--------------------------------", "anchor_text": ""}, {"url": "https://zluvsand.medium.com/?source=post_page-----7eaa8476dc75--------------------------------", "anchor_text": "Zolzaya Luvsandorj"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F5bca2b935223&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F5-tips-for-data-aggregation-in-pandas-7eaa8476dc75&user=Zolzaya+Luvsandorj&userId=5bca2b935223&source=post_page-5bca2b935223----7eaa8476dc75---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F7eaa8476dc75&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F5-tips-for-data-aggregation-in-pandas-7eaa8476dc75&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F7eaa8476dc75&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F5-tips-for-data-aggregation-in-pandas-7eaa8476dc75&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://pandas.pydata.org/pandas-docs/stable/getting_started/install.html", "anchor_text": "pandas"}, {"url": "https://seaborn.pydata.org/installing.html", "anchor_text": "seaborn"}, {"url": "https://www.python.org/about/gettingstarted/", "anchor_text": "this"}, {"url": "https://pandas.pydata.org/pandas-docs/stable/user_guide/10min.html", "anchor_text": "this"}, {"url": "https://vincentarelbundock.github.io/Rdatasets/doc/reshape2/tips.html", "anchor_text": "here"}, {"url": "https://vincentarelbundock.github.io/Rdatasets/doc/reshape2/tips.html", "anchor_text": "\u201cOne waiter recorded information about each tip he received over a period of a few months working in one restaurant.\u201d"}, {"url": "https://unsplash.com/@bolotohodova?utm_source=medium&utm_medium=referral", "anchor_text": "Polina Razorilova"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://zluvsand.medium.com/membership", "anchor_text": "my referral link"}, {"url": "https://towardsdatascience.com/writing-5-common-sql-queries-in-pandas-90b52f17ad76", "anchor_text": "Writing 5 common SQL queries in pandas"}, {"url": "https://towardsdatascience.com/5-tips-for-pandas-users-e73681d16d17", "anchor_text": "5 tips for pandas users"}, {"url": "https://towardsdatascience.com/transforming-variables-in-a-pandas-dataframe-bce2c6ef91a1", "anchor_text": "How to transform variables in a pandas DataFrame"}, {"url": "https://medium.com/tag/pandas?source=post_page-----7eaa8476dc75---------------pandas-----------------", "anchor_text": "Pandas"}, {"url": "https://medium.com/tag/python?source=post_page-----7eaa8476dc75---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/data-manipulation?source=post_page-----7eaa8476dc75---------------data_manipulation-----------------", "anchor_text": "Data Manipulation"}, {"url": "https://medium.com/tag/data-analysis?source=post_page-----7eaa8476dc75---------------data_analysis-----------------", "anchor_text": "Data Analysis"}, {"url": "https://medium.com/tag/data-science?source=post_page-----7eaa8476dc75---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F7eaa8476dc75&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F5-tips-for-data-aggregation-in-pandas-7eaa8476dc75&user=Zolzaya+Luvsandorj&userId=5bca2b935223&source=-----7eaa8476dc75---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F7eaa8476dc75&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F5-tips-for-data-aggregation-in-pandas-7eaa8476dc75&user=Zolzaya+Luvsandorj&userId=5bca2b935223&source=-----7eaa8476dc75---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F7eaa8476dc75&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F5-tips-for-data-aggregation-in-pandas-7eaa8476dc75&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----7eaa8476dc75--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F7eaa8476dc75&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F5-tips-for-data-aggregation-in-pandas-7eaa8476dc75&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----7eaa8476dc75---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----7eaa8476dc75--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----7eaa8476dc75--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----7eaa8476dc75--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----7eaa8476dc75--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----7eaa8476dc75--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----7eaa8476dc75--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----7eaa8476dc75--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----7eaa8476dc75--------------------------------", "anchor_text": ""}, {"url": "https://zluvsand.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://zluvsand.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Zolzaya Luvsandorj"}, {"url": "https://zluvsand.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "2.3K Followers"}, {"url": "https://zluvsand.github.io/", "anchor_text": "https://zluvsand.github.io/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F5bca2b935223&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F5-tips-for-data-aggregation-in-pandas-7eaa8476dc75&user=Zolzaya+Luvsandorj&userId=5bca2b935223&source=post_page-5bca2b935223--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fea8899bb3fba&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F5-tips-for-data-aggregation-in-pandas-7eaa8476dc75&newsletterV3=5bca2b935223&newsletterV3Id=ea8899bb3fba&user=Zolzaya+Luvsandorj&userId=5bca2b935223&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}