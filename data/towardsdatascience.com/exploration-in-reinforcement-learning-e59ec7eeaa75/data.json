{"url": "https://towardsdatascience.com/exploration-in-reinforcement-learning-e59ec7eeaa75", "time": 1682995938.382949, "path": "towardsdatascience.com/exploration-in-reinforcement-learning-e59ec7eeaa75/", "webpage": {"metadata": {"title": "Exploration in Reinforcement Learning | by Ziad SALLOUM | Towards Data Science", "h1": "Exploration in Reinforcement Learning", "description": "Update: The best way of learning and practicing Reinforcement Learning is by going to http://rl-lab.com Everyone is confronted with the same dilemma on a daily basis: should I keep doing what I do\u2026"}, "outgoing_paragraph_urls": [{"url": "http://rl-lab.com/", "anchor_text": "http://rl-lab.com", "paragraph_index": 0}], "all_paragraphs": ["Update: The best way of learning and practicing Reinforcement Learning is by going to http://rl-lab.com", "Everyone is confronted with the same dilemma on a daily basis: should I keep doing what I do, or should I try something else. For example should I go to my preferred restaurant or should I try a new one, should I keep my current job or should I find a new one, etc\u2026", "In Reinforcement Learning, this type of decision is called exploitation when you keep doing what you were doing, and exploration when you try something new.", "Naturally this raises a question about how much to exploit and how much to explore.", "However, there is a problem in exploration which is that we don\u2019t really know what would be the outcome, it could be better than the current situation or it could be worse.", "Humans, try to get as much information as possible before making the move, for example before we try a new restaurant we read reviews or ask friends who already tried it. In Reinforcement Learning on the other hand, it is not possible to do that, but there are some techniques that will help figuring out the best strategy.", "Logically when we try something new and the result comes unsatisfying we regret our decision. If the new restaurant was bad, we regret going there and we consider whatever amount we paid as a complete loss. So we regret this amount.", "As we keep paying for bad decisions the amount of losses grows as well as the level of regret. So it should be a good idea to keep the amount of losses and the level of regret to the minimum.", "Can we do that?The answer is, yes it is possible, at least in RL.", "First we need to define the regret in RL. To do so we start by defining the optimal action a* as the action that gives the highest reward.", "So we define the regret L, over the course of T attempts, as the difference between the reward generated by the optimal action a* multiplied by T, and the sum from 1 to T of each reward of an arbitrary action.", "It can be proven that as T goes to infinity the regret tends to a lower bound of C . log T.", "Greedy and Epsilon Greedy exploration methods are fairly easy to understand and to implement, but they suffer from major setback which is they have sub-optimal regret. As a matter of fact the regret of both Greedy and Epsilon Greedy grows linearly by the time.", "This is easy to intuitively understand, as the Greedy will lock on one action that happened to have good results at one point of time but it is not in reality the optimal action. So Greedy will keep exploiting this action while ignoring the others which might be better. It Exploits too much.", "The Epsilon Greedy on the other hand, explores too much because even when one action seem to be the optimal one, the methods keeps allocating a fixed percentage of the time for exploration, thus missing opportunities and increasing total regret.", "Conversely the decaying Epsilon Greedy methods, tries to decrease the percentage dedicated for exploration as time goes by. This can give optimal regret as shown in the graph below.", "However the challenge is to be able to perform the right decaying process.", "Optimism in face of uncertainty is an approach to enhance the exploration and minimize the total regret.", "Suppose we have three slots machine with different probability distribution, that we don\u2019t know exactly, but after few trials we think that we have the following shapes of distribution. Keep in mind that these are drawn out of experience and do not necessarily reflect the truth.", "The green Q(a3) distribution has rather narrow base because of small interval [1.8 , 3.2], the red Q(a2) has a larger interval [0 , 4], and lastly the blue Q(a1) has the largest interval [-1.8 , 5.2].So the question is what action should we pick next.", "According to the Optimism in Face of Uncertainty principle, we choose the action that present a higher reward than the others even if it has a higher uncertainty. Looking at the graph we easily find that Q(a1) might have a higher reward (5.2) than the others so we chose it even though it has a higher uncertainty (it can be 5.2 as it can be -1.8).", "Suppose action a1 was taken and the distributions becomes like the following:", "We now know that the blue distribution has lesser maximum than the other two. So we are less uncertain about it, and the next action will be chosen from another distribution, the red one for example.", "This is the principle, but how will be implemented in reality ?This is what UCB1 is about.", "In the previous paragraph we talked about taking the action which has, potentially, the greatest return even if this is not certain.However, the question remains is how to find this maximum value?", "One way to do that is to estimate it by adding a term called upper confidence bound U\ud835\udc61(a) to the Q\ud835\udc61(a) for each action then select the action that has the maximum Q\ud835\udc61(a) + U\ud835\udc61(a).", "It goes without saying that U\ud835\udc61(a) is not constant, but should vary with time and experience.What we mean is as time goes by and we frequently select action (a), we become more and more certain of what to expect as Q(a), which is by itself an average, so U\ud835\udc61(a) should shrink as we become more confident of Q(a).", "The formula of U\ud835\udc61(a) is as follows", "where t is the total number of trials, and N\ud835\udc61(a) is the number of times action (a) was selected.This formula clearly shows that as t increases the numerator also increases but logarithmically (e.g. slowly) while when the action (a) is selected then N\ud835\udc61(a) increases by one however the U\ud835\udc61(a) decreases sharply.", "So U\ud835\udc61(a) is a way to regulate the selection of action (a) based on many times we have already selected this action in the past. In other words, it provides us with more certainty on what reward it might return.", "The final algorithm stipulates that for each iteration we compute Q\ud835\udc61(a) + U\ud835\udc61(a) for all actions and we select the action that has the highest Q\ud835\udc61(a) + U\ud835\udc61(a) value:", "This approach of explore vs exploit guarantees to have a logarithmic regret.", "IMPORTANT: UCB1 does not assume anything regarding the types of the distribution, even though in the graphs above they look like Gaussian but they can be anything.", "Let\u2019s assume that we know that the reward distributions are Gaussian : \u211b(r) = \ud835\udca9(r, \u03bc, \u03c3)", "The algorithm becomes as picking the action that maximises the standard deviation of Q(a)", "Also known as posterior sampling, it is a method that takes samples from each distribution then selects the action from the sample that has the maximum value.After taking the action and collecting the reward we update the distribution from which we took the action in order to reflect the result that we got.", "Of course this needs more explanation than that.", "Consider a dice, which we don\u2019t know if it is biased or not, actually we have no information whatsoever about it. So we assume, as a start, that this is fair dice and the probabilities of getting any number are all equal to 1/6.So the initial belief is that the probability distribution is uniform and equals to 1/6. This is called the Prior distribution and it constitutes a belief or an assumption (it might be a false one) that we have regarding the underlying probability distribution of the dice.Now we start throwing the dice and collect results, and with each result we update the Prior distribution, to make it reflect the reality of the experiment. The new distribution is now called the Posterior distribution. We keep repeating this process a large number of iterations in which the Posterior at iteration (i) becomes the Prior at iteration (i+1), until we reach a stage where the final Posterior distribution is very close to the real underlying distribution.For example if, we notice that after a large number of throws we have one number that is preponderant than the others, it means that the distribution can\u2019t be uniform, and most probably the dice is biased.", "Now the questions that arises, is how do we update the Prior distribution to obtain the Posterior distribution ?", "To answer this question let\u2019s start by defining the Beta distribution:Beta distribution is a family of continuous probability distributions defined on the interval [0, 1] parametrized by two positive parameters \u03b1 and \u03b2, that determine the shape of the distribution.", "You can think of the Beta distribution as a family of distributions where each of its member is different than the other according to the values of the parameters \ud835\udf70, \u03b2.", "The following are some samples of shapes that Beta distribution can have following the values that \ud835\udf70, \u03b2 can have.", "Sampling consists of randomly getting a value from the distribution, but since the distribution might not be uniform the value that is returned by the sampling is most likely to be from the region where the distribution peaks.", "For example, take the third graph in the second row from the above set of graphs. This distribution peaks at the around 0.84. So when sampling from this distribution it is more likely to have value around 0.84, than having a value less than 0.4 for instance.", "Now suppose you have multiple actions each with its unknown reward distribution. We use Thompson sampling to discover which action is the best (it maximises the average rewards). We start by assuming a certain distribution such as Beta(1,1) which is a uniform distribution for each action, then we samples those distributions, and select the action that has the highest sample value.Once the selected action is executed and the reward is collected, the distribution of the selected action is updated.", "Let\u2019s take the following example of a multi-armed bandits (slot machines).The example consists of three multi-armed bandits: blue, red and purple.Since we don\u2019t know anything about the underlying distribution of these bandits we assume they are uniform. We sample from these distributions and we get the following results: blue = 0.4, red = 0.5, purple = 0.7It turns out that the purple has the highest sample value, so we pull the arm of the purple machine. Let\u2019s suppose that we didn\u2019t win, so we need to update our belief of the purple distribution by increasing the \u03b2 parameter by one to become Beta(1, 2) which will give the first graph below.", "We sample again, and this time the red distribution got the highest sample value, so we pull the arm of the red machine and we win. We update the red distribution by increasing \ud835\udf70 by one, and we get the second graph (column 2, row 1).As we continue to sample from all of the distributions we notice that the blue one is getting more wins than the others, so the update gives it more advantage over the rest, and distribution starts to present a peak of likelyhood towards the high values (> 0.8). This means that we are more exploiting the blue machine than exploring the other two. In other words we are more and more convinced that we have found the optimal action.", "This article exposed some of the mostly used exploration techniques employed in Reinforcement Learning. The major take away from it, is to know that exploring actions that have low priority of being optimal is a waste of time and resources. For this reason it is important to use a exploration methods that minimize regrets, so that the learning phase becomes faster and more efficient.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fe59ec7eeaa75&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fexploration-in-reinforcement-learning-e59ec7eeaa75&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fexploration-in-reinforcement-learning-e59ec7eeaa75&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fexploration-in-reinforcement-learning-e59ec7eeaa75&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fexploration-in-reinforcement-learning-e59ec7eeaa75&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----e59ec7eeaa75--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----e59ec7eeaa75--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://zsalloum.medium.com/?source=post_page-----e59ec7eeaa75--------------------------------", "anchor_text": ""}, {"url": "https://zsalloum.medium.com/?source=post_page-----e59ec7eeaa75--------------------------------", "anchor_text": "Ziad SALLOUM"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F1f2b933522e2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fexploration-in-reinforcement-learning-e59ec7eeaa75&user=Ziad+SALLOUM&userId=1f2b933522e2&source=post_page-1f2b933522e2----e59ec7eeaa75---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe59ec7eeaa75&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fexploration-in-reinforcement-learning-e59ec7eeaa75&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe59ec7eeaa75&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fexploration-in-reinforcement-learning-e59ec7eeaa75&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@dariuszsankowski?utm_source=medium&utm_medium=referral", "anchor_text": "Dariusz Sankowski"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "http://rl-lab.com/", "anchor_text": "http://rl-lab.com"}, {"url": "https://dataorigami.net/blogs/napkin-folding/79031811-multi-armed-bandits", "anchor_text": "https://dataorigami.net/blogs/napkin-folding/79031811-multi-armed-bandits"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----e59ec7eeaa75---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----e59ec7eeaa75---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/reinforcement-learning?source=post_page-----e59ec7eeaa75---------------reinforcement_learning-----------------", "anchor_text": "Reinforcement Learning"}, {"url": "https://medium.com/tag/exploration?source=post_page-----e59ec7eeaa75---------------exploration-----------------", "anchor_text": "Exploration"}, {"url": "https://medium.com/tag/exploitation?source=post_page-----e59ec7eeaa75---------------exploitation-----------------", "anchor_text": "Exploitation"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fe59ec7eeaa75&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fexploration-in-reinforcement-learning-e59ec7eeaa75&user=Ziad+SALLOUM&userId=1f2b933522e2&source=-----e59ec7eeaa75---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fe59ec7eeaa75&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fexploration-in-reinforcement-learning-e59ec7eeaa75&user=Ziad+SALLOUM&userId=1f2b933522e2&source=-----e59ec7eeaa75---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe59ec7eeaa75&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fexploration-in-reinforcement-learning-e59ec7eeaa75&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----e59ec7eeaa75--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fe59ec7eeaa75&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fexploration-in-reinforcement-learning-e59ec7eeaa75&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----e59ec7eeaa75---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----e59ec7eeaa75--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----e59ec7eeaa75--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----e59ec7eeaa75--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----e59ec7eeaa75--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----e59ec7eeaa75--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----e59ec7eeaa75--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----e59ec7eeaa75--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----e59ec7eeaa75--------------------------------", "anchor_text": ""}, {"url": "https://zsalloum.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://zsalloum.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Ziad SALLOUM"}, {"url": "https://zsalloum.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "845 Followers"}, {"url": "https://rl-lab.com", "anchor_text": "https://rl-lab.com"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F1f2b933522e2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fexploration-in-reinforcement-learning-e59ec7eeaa75&user=Ziad+SALLOUM&userId=1f2b933522e2&source=post_page-1f2b933522e2--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F408fc441c93b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fexploration-in-reinforcement-learning-e59ec7eeaa75&newsletterV3=1f2b933522e2&newsletterV3Id=408fc441c93b&user=Ziad+SALLOUM&userId=1f2b933522e2&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}