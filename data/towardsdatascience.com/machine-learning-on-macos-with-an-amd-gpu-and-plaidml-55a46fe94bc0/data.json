{"url": "https://towardsdatascience.com/machine-learning-on-macos-with-an-amd-gpu-and-plaidml-55a46fe94bc0", "time": 1683017716.636137, "path": "towardsdatascience.com/machine-learning-on-macos-with-an-amd-gpu-and-plaidml-55a46fe94bc0/", "webpage": {"metadata": {"title": "Machine Learning on macOS with an AMD GPU and PlaidML | by Alex Wulff | Towards Data Science", "h1": "Machine Learning on macOS with an AMD GPU and PlaidML", "description": "Anyone who has tried to train a neural network with TensorFlow on macOS knows that the process kind of sucks. TensorFlow can only leverage the CPU on Macs, as GPU-accelerated training requires an\u2026"}, "outgoing_paragraph_urls": [{"url": "https://amzn.to/3gJBlN3", "anchor_text": "Radeon RX580 eGPU", "paragraph_index": 3}, {"url": "https://plaidml.github.io/plaidml/docs/install.html#macos", "anchor_text": "install PlaidML via pip", "paragraph_index": 4}, {"url": "https://github.com/plaidml/plaidml", "anchor_text": "PlaidML GitHub page", "paragraph_index": 10}, {"url": "https://www.intel.com/content/www/us/en/artificial-intelligence/plaidml.html", "anchor_text": "appears to be involved", "paragraph_index": 11}, {"url": "https://alexwulff.medium.com", "anchor_text": "more of my writing here", "paragraph_index": 12}, {"url": "https://www.alexwulff.com", "anchor_text": "www.alexwulff.com", "paragraph_index": 12}, {"url": "http://amzn.to/341cywA", "anchor_text": "amzn.to/341cywA", "paragraph_index": 14}, {"url": "http://www.AlexWulff.com", "anchor_text": "www.AlexWulff.com", "paragraph_index": 14}], "all_paragraphs": ["Anyone who has tried to train a neural network with TensorFlow on macOS knows that the process kind of sucks. TensorFlow can only leverage the CPU on Macs, as GPU-accelerated training requires an Nvidia chipset (there is a fork of TensorFlow that can use GPUs on macOS, but it\u2019s still in alpha). Most large models take orders of magnitude more time to train on a CPU than on even a simple GPU.", "To make matters worse, many Macs have powerful discreet AMD GPUs that are forced to sit idle while training. TensorFlow only supports Nvidia devices, which are incompatible with macOS. This is where plaidML comes in. Rather than pay for time on a cloud-based system or purchase a new machine, you can install PlaidML and use it to train Keras models right on your Mac\u2019s graphics processor.", "TensorFlow serves as a backend for Keras, interpreting Keras\u2019 high-level Python syntax and converting it to instructions that can be executed in parallel on specialized hardware like a GPU. PlaidML is an alternative backend for Keras that supports parallelization frameworks other than Nvidia\u2019s CUDA. On a Mac, you can use PlaidML to train Keras models on your CPU, your CPU\u2019s integrated graphics, a discreet AMD graphics processor, or even an external AMD GPU connected via Thunderbolt 3.", "I first started poking around with PlaidML because I was looking for a way to train a deep convolutional neural network on a very large image dataset. I attempted to do this in Google\u2019s Colab, but the online tool proved to be very frustrating for long-running jobs. I had a Radeon RX580 eGPU gathering dust, so I wanted a way to use it to train models locally with my MacBook.", "After a few quick steps, I was up and running with PlaidML. Here\u2019s how you can use it on your system. First, install PlaidML via pip. I highly recommend using virtual environments here to isolate your PlaidML installation from the rest of you system.", "PlaidML\u2019s power comes with its simplicity. After installation, activating your GPU is as simple as running", "After selecting whether or not you want to enable experimental features, this tool will ask you which computational device you\u2019d like to use. You should see a list like the following:", "The first option is my CPU, the second is the Intel integrated graphics inside my CPU, the third option is the discreet AMD GPU in my 15\" MacBook Pro, and the fourth option is my RX 580 eGPU. I absolutely love how easy it is to switch processors; this allows me to train simple models on-the-go with my laptops\u2019s discreet GPU and use my eGPU for heavier tasks.", "The only caveat here is you no longer have access to TensorFlow features such as TensorFlow Datasets. All code you write needs to be in pure Keras. I haven\u2019t found this to be much of a limitation, and it leads to more portable software anyways. PlaidML also works with Nvidia GPUs, so if you work on a team that uses different GPU architectures PlaidML makes things very easy. Using PlaidML as Keras\u2019 backend is as simple as the following:", "And that\u2019s literally it. Below is a complete example that you can try on your own system after installing PlaidML. It trains a very simple neural network with one hidden layer that sums input vectors.", "You can try this on different computing devices. You will likely find that training this model on your CPU is faster, as the dataset is very small and the model very simple. You will notice a significant speedup for more complex models, however. You can find some heavier tests on the PlaidML GitHub page.", "So far, PlaidML has been awesome. Intel now appears to be involved in some way with PlaidML\u2019s development, so hopefully, this will ensure that PlaidML is around for a long time.", "I hope you found this article useful. Check out more of my writing here, and my website www.alexwulff.com.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "I'm a Harvard student, maker, and radio enthusiast. Check out my book on radio communications at amzn.to/341cywA and my website at www.AlexWulff.com"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F55a46fe94bc0&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-on-macos-with-an-amd-gpu-and-plaidml-55a46fe94bc0&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-on-macos-with-an-amd-gpu-and-plaidml-55a46fe94bc0&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-on-macos-with-an-amd-gpu-and-plaidml-55a46fe94bc0&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-on-macos-with-an-amd-gpu-and-plaidml-55a46fe94bc0&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----55a46fe94bc0--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----55a46fe94bc0--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://alexwulff.medium.com/?source=post_page-----55a46fe94bc0--------------------------------", "anchor_text": ""}, {"url": "https://alexwulff.medium.com/?source=post_page-----55a46fe94bc0--------------------------------", "anchor_text": "Alex Wulff"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F1d787d902a0c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-on-macos-with-an-amd-gpu-and-plaidml-55a46fe94bc0&user=Alex+Wulff&userId=1d787d902a0c&source=post_page-1d787d902a0c----55a46fe94bc0---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F55a46fe94bc0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-on-macos-with-an-amd-gpu-and-plaidml-55a46fe94bc0&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F55a46fe94bc0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-on-macos-with-an-amd-gpu-and-plaidml-55a46fe94bc0&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://github.com/plaidml/plaidml", "anchor_text": "PlaidML"}, {"url": "https://amzn.to/3gJBlN3", "anchor_text": "Radeon RX580 eGPU"}, {"url": "https://plaidml.github.io/plaidml/docs/install.html#macos", "anchor_text": "install PlaidML via pip"}, {"url": "https://github.com/plaidml/plaidml", "anchor_text": "PlaidML GitHub page"}, {"url": "https://www.intel.com/content/www/us/en/artificial-intelligence/plaidml.html", "anchor_text": "appears to be involved"}, {"url": "https://alexwulff.medium.com", "anchor_text": "more of my writing here"}, {"url": "https://www.alexwulff.com", "anchor_text": "www.alexwulff.com"}, {"url": "https://medium.com/tag/tech?source=post_page-----55a46fe94bc0---------------tech-----------------", "anchor_text": "Tech"}, {"url": "https://medium.com/tag/technology?source=post_page-----55a46fe94bc0---------------technology-----------------", "anchor_text": "Technology"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----55a46fe94bc0---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/ai?source=post_page-----55a46fe94bc0---------------ai-----------------", "anchor_text": "AI"}, {"url": "https://medium.com/tag/apple?source=post_page-----55a46fe94bc0---------------apple-----------------", "anchor_text": "Apple"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F55a46fe94bc0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-on-macos-with-an-amd-gpu-and-plaidml-55a46fe94bc0&user=Alex+Wulff&userId=1d787d902a0c&source=-----55a46fe94bc0---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F55a46fe94bc0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-on-macos-with-an-amd-gpu-and-plaidml-55a46fe94bc0&user=Alex+Wulff&userId=1d787d902a0c&source=-----55a46fe94bc0---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F55a46fe94bc0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-on-macos-with-an-amd-gpu-and-plaidml-55a46fe94bc0&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----55a46fe94bc0--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F55a46fe94bc0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-on-macos-with-an-amd-gpu-and-plaidml-55a46fe94bc0&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----55a46fe94bc0---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----55a46fe94bc0--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----55a46fe94bc0--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----55a46fe94bc0--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----55a46fe94bc0--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----55a46fe94bc0--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----55a46fe94bc0--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----55a46fe94bc0--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----55a46fe94bc0--------------------------------", "anchor_text": ""}, {"url": "https://alexwulff.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://alexwulff.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Alex Wulff"}, {"url": "https://alexwulff.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "350 Followers"}, {"url": "http://amzn.to/341cywA", "anchor_text": "amzn.to/341cywA"}, {"url": "http://www.AlexWulff.com", "anchor_text": "www.AlexWulff.com"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F1d787d902a0c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-on-macos-with-an-amd-gpu-and-plaidml-55a46fe94bc0&user=Alex+Wulff&userId=1d787d902a0c&source=post_page-1d787d902a0c--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fb4695a01864f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-on-macos-with-an-amd-gpu-and-plaidml-55a46fe94bc0&newsletterV3=1d787d902a0c&newsletterV3Id=b4695a01864f&user=Alex+Wulff&userId=1d787d902a0c&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}