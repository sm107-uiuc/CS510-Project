{"url": "https://towardsdatascience.com/super-charged-similarity-metric-calculations-969116abd948", "time": 1683003269.979959, "path": "towardsdatascience.com/super-charged-similarity-metric-calculations-969116abd948/", "webpage": {"metadata": {"title": "Super-charged similarity metric calculations | by David Mezzetti | Towards Data Science", "h1": "Super-charged similarity metric calculations", "description": "Similarity detection is a common method used to identify items that share traits but not necessarily the same features. Product recommendations and related articles are often driven by similarity\u2026"}, "outgoing_paragraph_urls": [], "all_paragraphs": ["Similarity detection is a common method used to identify items that share traits but not necessarily the same features. Product recommendations and related articles are often driven by similarity metrics. Cosine similarity is the most popular and will be covered here. This article will evaluate the performance of cosine similarity in Python using NumPy and TensorFlow.", "NumPy is a robust and mature library for working with large multi-dimensional matrices. NumPy has a rich collection of linear algebra functions. It\u2019s well-tuned and runs very fast on CPUs.", "TensorFlow is a math and machine learning library that can utilize both the CPU and GPU. TensorFlow is well proven in production and used to power advanced machine learning algorithms. It also has a rich collection of linear algebra functions. Most of what you can do with NumPy can also be done in TensorFlow.", "Both are great libraries and both can compute similarity metrics between data sets.", "NumPy and TensorFlow can be installed via pip if not already installed. This article is using NumPy 1.17.4 and TensorFlow 2.1", "The following sample code shows how to calculate cosine similarity in NumPy and TensorFlow.", "Running the above will produce output similar to the following. There will also be a lot of TensorFlow messages, it\u2019s important you see the top line in bold to ensure the GPU is being used.", "The top two arrays show a 5x5 array for x and 1x5 for y. It also shows the cosine similarity for y against each row in x, calculated with NumPy and TensorFlow.", "Let's try to time the calculations with more data.", "For the first test, we\u2019ll try two small arrays, calculating cosine similarity between a 1000x25 array for x and a 50x25 array for y.", "Running the above will produce the following output:", "In this case, NumPy is faster than TensorFlow, even though TensorFlow is GPU enabled. As with all software development, there is no one size meets all answer to a problem. NumPy still does have a place and it will perform better with small data.", "There is overhead to copy data from the CPU to the GPU and overhead to build the GPU graph to execute. As data grows, the overhead will be negligible compared to the overall run time, let's try a larger data array.", "We\u2019ll run almost the exact same code as above except we\u2019ll increase the array size.", "TensorFlow is now 3x faster than NumPy. The overhead of copying data to the GPU and compiling the GPU graph is now worth the performance trade-off.", "Let's try with an even larger array.", "TensorFlow is 8x faster in this case. The performance gain will continue to grow rapidly as long as the data set can fit on the GPU.", "Calculating cosine similarity will get you an array of floats from 0 to 1, with 1 being most similar and 0 being least. For most use cases, you\u2019ll want to calculate similarity along with the best associated records. You can do that both in NumPy and TensorFlow as follows.", "The above code gets a list of indices sorted by the highest cosine similarity. The top record is selected and printed.", "Both NumPy and TensorFlow have their place. GPUs don\u2019t just make everything faster in all cases. Use NumPy for smaller data sets and TensorFlow for larger sets. Always test on your own data to see what works best in your specific situation.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Founder/CEO at NeuML \u2014 applying machine learning to solve everyday problems. Previously co-founded and built Data Works into a successful IT services company."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F969116abd948&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsuper-charged-similarity-metric-calculations-969116abd948&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsuper-charged-similarity-metric-calculations-969116abd948&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsuper-charged-similarity-metric-calculations-969116abd948&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsuper-charged-similarity-metric-calculations-969116abd948&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----969116abd948--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----969116abd948--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@davidmezzetti?source=post_page-----969116abd948--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@davidmezzetti?source=post_page-----969116abd948--------------------------------", "anchor_text": "David Mezzetti"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fbd6fa5e6030&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsuper-charged-similarity-metric-calculations-969116abd948&user=David+Mezzetti&userId=bd6fa5e6030&source=post_page-bd6fa5e6030----969116abd948---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F969116abd948&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsuper-charged-similarity-metric-calculations-969116abd948&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F969116abd948&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsuper-charged-similarity-metric-calculations-969116abd948&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@jneric?utm_source=medium&utm_medium=referral", "anchor_text": "Joe Neric"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://medium.com/tag/data-science?source=post_page-----969116abd948---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----969116abd948---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/numpy?source=post_page-----969116abd948---------------numpy-----------------", "anchor_text": "Numpy"}, {"url": "https://medium.com/tag/tensorflow?source=post_page-----969116abd948---------------tensorflow-----------------", "anchor_text": "TensorFlow"}, {"url": "https://medium.com/tag/towards-data-science?source=post_page-----969116abd948---------------towards_data_science-----------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F969116abd948&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsuper-charged-similarity-metric-calculations-969116abd948&user=David+Mezzetti&userId=bd6fa5e6030&source=-----969116abd948---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F969116abd948&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsuper-charged-similarity-metric-calculations-969116abd948&user=David+Mezzetti&userId=bd6fa5e6030&source=-----969116abd948---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F969116abd948&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsuper-charged-similarity-metric-calculations-969116abd948&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----969116abd948--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F969116abd948&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsuper-charged-similarity-metric-calculations-969116abd948&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----969116abd948---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----969116abd948--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----969116abd948--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----969116abd948--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----969116abd948--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----969116abd948--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----969116abd948--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----969116abd948--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----969116abd948--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@davidmezzetti?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@davidmezzetti?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "David Mezzetti"}, {"url": "https://medium.com/@davidmezzetti/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "616 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fbd6fa5e6030&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsuper-charged-similarity-metric-calculations-969116abd948&user=David+Mezzetti&userId=bd6fa5e6030&source=post_page-bd6fa5e6030--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F752e5f25d5d1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsuper-charged-similarity-metric-calculations-969116abd948&newsletterV3=bd6fa5e6030&newsletterV3Id=752e5f25d5d1&user=David+Mezzetti&userId=bd6fa5e6030&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}