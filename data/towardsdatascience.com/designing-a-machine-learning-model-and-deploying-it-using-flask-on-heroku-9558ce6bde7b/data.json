{"url": "https://towardsdatascience.com/designing-a-machine-learning-model-and-deploying-it-using-flask-on-heroku-9558ce6bde7b", "time": 1682994324.6928918, "path": "towardsdatascience.com/designing-a-machine-learning-model-and-deploying-it-using-flask-on-heroku-9558ce6bde7b/", "webpage": {"metadata": {"title": "Designing a Machine Learning model and deploying it using Flask on Heroku | by Ritvik Khanna | Towards Data Science", "h1": "Designing a Machine Learning model and deploying it using Flask on Heroku", "description": "We build a prediction model on historic data using different machine learning algorithms and classifiers, plot the results and calculate the accuracy of the model on the testing data. Now what? To\u2026"}, "outgoing_paragraph_urls": [{"url": "http://flask.pocoo.org/", "anchor_text": "Flask", "paragraph_index": 0}, {"url": "https://www.heroku.com/", "anchor_text": "Heroku", "paragraph_index": 0}, {"url": "https://archive.ics.uci.edu/ml/datasets/adult", "anchor_text": "here", "paragraph_index": 1}, {"url": "https://towardsdatascience.com/comparative-study-of-classifiers-in-predicting-the-income-range-of-a-person-from-a-census-data-96ce60ee5a10", "anchor_text": "here", "paragraph_index": 1}, {"url": "https://archive.ics.uci.edu/ml/datasets/adult", "anchor_text": "here", "paragraph_index": 2}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.LabelEncoder.html", "anchor_text": "label encoder", "paragraph_index": 4}, {"url": "https://docs.python.org/2/library/pickle.html", "anchor_text": "pickle", "paragraph_index": 7}, {"url": "https://github.com/ritvikkhanna09/Income-Prediction-Webapp/blob/master/WebApp/flaskr/templates/index.html", "anchor_text": "here", "paragraph_index": 9}, {"url": "https://www.heroku.com/", "anchor_text": "Heroku", "paragraph_index": 26}, {"url": "https://devcenter.heroku.com/articles/git", "anchor_text": "heroku git", "paragraph_index": 26}, {"url": "https://git-scm.com/book/en/v2/Getting-Started-Installing-Git", "anchor_text": "Git", "paragraph_index": 27}, {"url": "https://devcenter.heroku.com/articles/heroku-cli", "anchor_text": "Heroku", "paragraph_index": 27}], "all_paragraphs": ["We build a prediction model on historic data using different machine learning algorithms and classifiers, plot the results and calculate the accuracy of the model on the testing data. Now what? To put it to use in order to predict the new data we have to deploy it over the internet so that the outside world can use it. In this article I talk about how I trained a machine learning model, created a web application on it using Flask and deployed it using Heroku.", "Decision Tree is a well known supervised machine learning algorithm because its ease to use, resilient and flexible. I have implemented the algorithm on Adult dataset from UCI machine learning repository [here]. In one of my previous articles I have in-depth explained the dataset and compared different classifiers I trained on it. Please feel free to check it out [here].", "It consists of 14 attributes and a class label telling whether the income of the individual is less than or more than 50K a year. These attributes range from the age of the person, the working class label to relationship status and the race the person belongs to. The information about all the attributes can be found here.", "At first we find and remove any missing values from the data. I have replaced the missing values with the mode value in that column. There are many other ways to replace missing values but for this type of dataset it seemed most optimal.", "To fit the data into prediction model, we need convert categorical values to numerical ones. Before that, we will evaluate if any transformation on categorical columns are necessary. Discretisation is a common way to make categorical data more tidy and meaningful. I applied discretisation on column marital_status where they are narrowed down to only to values married or not married. Later I apply label encoder in the remaining data columns. Also there are two redundant columns {\u2018education\u2019, \u2018educational-num\u2019}, therefore I have removed one of them.", "Now this is what the data set looks like:", "After preprocessing the data for each classifier depending on how the data is fed, we then slice the data separating the labels with the attributes. Now, we split the dataset into two halves, one for training and on for testing. This is achieved using train_test_split() function of sklearn.", "With this we achieve an accuracy of 84% approximately. Now in order to use this model with new unknown data we need to save the model so that we can predict the values later. For this we make use of pickle in python which is a powerful algorithm for serializing and de-serializing a Python object structure.", "There are a number of web dev frameworks like Angular.js, React.js, Node.js written in javascript and others like PHP, ASP.net and many more. But here we have used python to training our machine learning model why not create a web app using the same as well. Flask is a python based microframework used for developing small scale websites. Let\u2019s get on with it !", "For predicting the income from various attributes we first need to collect the data(new attribute values) and then use the decision tree model we build above to predict whether the income is more than 50K or less. Therefore, in order to collect the data we create html form which would contain all the different options to select from each attribute. Here, I have created a simple form using html only. You can review the code from [here]. If you want to make the form more interactive you can do so as well.", "Important: in-order to predict the data correctly the corresponding values of each label should match with the value of each input selected.", "For example \u2014 In the attribute Relationship there are 6 categorical values. These are converted to numerical like this {\u2018Husband\u2019: 0, \u2018Not-in-family\u2019: 1, \u2018Other-relative\u2019: 2, \u2018Own-child\u2019: 3, \u2018Unmarried\u2019: 4, \u2018Wife\u2019: 5}. Therefore we need to put the same values to the html form.", "In the gist preprocessing.py above I have created a dictionary mapping_dict which stores the numerical values of all the categorical labels in the form of key and value. This would help in creating the html form.", "Till now we have created the html form and now to host the static pages we need to use flask.", "Before starting with the coding part, we need to download flask and some other libraries. Here, we make use of virtual environment, where all the libraries are managed and makes both the development and deployment job easier.", "After the virtual environment is created we activate it.", "Lets create folder templates. In your application, you will use templates to render HTML which will display in the user\u2019s browser. This folder contains our html form file index.html.", "Create script.py file in the project folder and copy the following code.", "Here we import the libraries, then using app=Flask(__name__) we create an instance of flask. @app.route('/') is used to tell flask what url should trigger the function index() and in the function index we use render_template('index.html') to display the script index.html in the browser.", "When someone submits the form, the webpage should display the predicted value of income. For this, we require the model file(model.pkl) we created before, in the same project folder.", "Here after the form is submitted, the form values are stored in variable to_predict_list in the form of dictionary. We convert it into a list of the dictionary\u2019s values and pass it as an argument to ValuePredictor() function. In this function, we load the model.pkl file and predict the new values and return the result.", "This result/prediction(Income more than or less than 50k) is then passed as an argument to the template engine with the html page to be displayed.", "Create the following result.html file and add it to templates folder.", "Run the application again and it should predict the income after submitting the form.", "We have successfully created the Webapp. Now it\u2019s time to use heroku to deploy it.", "This is how our project layout looks like \u2014", "Heroku is a platform as a service (PaaS) that enables developers to build, run, and operate applications entirely in the cloud. In this project we deploy using heroku git.", "For this we need to install git as well as heroku CLI onto our system. Please refer to these links \u2014 [Git],[Heroku]. Now, visit Heroku and create an account.", "At first we need to download gunicorn to our virtual environment venv. We can use pip to download it.", "Gunicorn handles requests and takes care of complicated things like threading very easily and the server that we use to run Flask locally when we\u2019re developing our application isn\u2019t good at handling real requests, therefore we use gunicorn.", "In our local machine, we have installed a lot of libraries and other important files like flask, gunicorn, sklearn etc. We need to tell heroku that our project requires all these libraries to successfully run the application. This is done by creating a requirements.txt file.", "Procfile is a text file in the root directory of your application, to explicitly declare what command should be executed to start your app. This is an essential requirement for heroku.", "This file tells heroku we want to use the web process with the command gunicorn and the app name.", "In our project folder we have a lot of hidden or unnecessary files which we do not want to deploy to heroku. For example venv, instance folders or .cache files. In order to not include them we create a .gitignore file.", "This is how our project layout looks like \u2014", "Now our project is ready to be pushed to heroku.", "Open terminal and execute the following commands \u2014", "This is will ask for your heroku credentials. Now, we need to create a heroku app.", "This will create a heroku app with a system generated url. We can manually change the url later using a set of commands.", "This initialises the repo, adds all the codes and commits it with a message.", "This will push the entire app on heroku and open the url in the browser.", "It was that simple. We created a machine learning model, trained it, created a web application to predict new data using the model and deployed it on the internet using heroku. And did all of it in python!", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "I write on stuff that fascinate me and on interesting projects I do. Enjoy :)"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F9558ce6bde7b&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdesigning-a-machine-learning-model-and-deploying-it-using-flask-on-heroku-9558ce6bde7b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdesigning-a-machine-learning-model-and-deploying-it-using-flask-on-heroku-9558ce6bde7b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdesigning-a-machine-learning-model-and-deploying-it-using-flask-on-heroku-9558ce6bde7b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdesigning-a-machine-learning-model-and-deploying-it-using-flask-on-heroku-9558ce6bde7b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----9558ce6bde7b--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----9558ce6bde7b--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@ritvikkhanna09?source=post_page-----9558ce6bde7b--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@ritvikkhanna09?source=post_page-----9558ce6bde7b--------------------------------", "anchor_text": "Ritvik Khanna"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F56eae54bc970&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdesigning-a-machine-learning-model-and-deploying-it-using-flask-on-heroku-9558ce6bde7b&user=Ritvik+Khanna&userId=56eae54bc970&source=post_page-56eae54bc970----9558ce6bde7b---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F9558ce6bde7b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdesigning-a-machine-learning-model-and-deploying-it-using-flask-on-heroku-9558ce6bde7b&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F9558ce6bde7b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdesigning-a-machine-learning-model-and-deploying-it-using-flask-on-heroku-9558ce6bde7b&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "http://flask.pocoo.org/", "anchor_text": "Flask"}, {"url": "https://www.heroku.com/", "anchor_text": "Heroku"}, {"url": "https://gaps.cornell.edu/sites/gaps.cornell.edu/files/shared/images/Decision-Tree-4.gif", "anchor_text": "source"}, {"url": "https://archive.ics.uci.edu/ml/datasets/adult", "anchor_text": "here"}, {"url": "https://towardsdatascience.com/comparative-study-of-classifiers-in-predicting-the-income-range-of-a-person-from-a-census-data-96ce60ee5a10", "anchor_text": "here"}, {"url": "https://archive.ics.uci.edu/ml/datasets/adult", "anchor_text": "here"}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.LabelEncoder.html", "anchor_text": "label encoder"}, {"url": "https://docs.python.org/2/library/pickle.html", "anchor_text": "pickle"}, {"url": "https://github.com/ritvikkhanna09/Income-Prediction-Webapp/blob/master/WebApp/flaskr/templates/index.html", "anchor_text": "here"}, {"url": "http://127.0.0.1:5000/", "anchor_text": "http://127.0.0.1:5000/"}, {"url": "https://www.heroku.com/", "anchor_text": "Heroku"}, {"url": "https://devcenter.heroku.com/articles/git", "anchor_text": "heroku git"}, {"url": "https://git-scm.com/book/en/v2/Getting-Started-Installing-Git", "anchor_text": "Git"}, {"url": "https://devcenter.heroku.com/articles/heroku-cli", "anchor_text": "Heroku"}, {"url": "https://income-predictor-from-census.herokuapp.com", "anchor_text": "https://income-predictor-from-census.herokuapp.com"}, {"url": "https://medium.com/tag/python?source=post_page-----9558ce6bde7b---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/flask?source=post_page-----9558ce6bde7b---------------flask-----------------", "anchor_text": "Flask"}, {"url": "https://medium.com/tag/heroku?source=post_page-----9558ce6bde7b---------------heroku-----------------", "anchor_text": "Heroku"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----9558ce6bde7b---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/ai?source=post_page-----9558ce6bde7b---------------ai-----------------", "anchor_text": "AI"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F9558ce6bde7b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdesigning-a-machine-learning-model-and-deploying-it-using-flask-on-heroku-9558ce6bde7b&user=Ritvik+Khanna&userId=56eae54bc970&source=-----9558ce6bde7b---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F9558ce6bde7b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdesigning-a-machine-learning-model-and-deploying-it-using-flask-on-heroku-9558ce6bde7b&user=Ritvik+Khanna&userId=56eae54bc970&source=-----9558ce6bde7b---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F9558ce6bde7b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdesigning-a-machine-learning-model-and-deploying-it-using-flask-on-heroku-9558ce6bde7b&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----9558ce6bde7b--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F9558ce6bde7b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdesigning-a-machine-learning-model-and-deploying-it-using-flask-on-heroku-9558ce6bde7b&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----9558ce6bde7b---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----9558ce6bde7b--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----9558ce6bde7b--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----9558ce6bde7b--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----9558ce6bde7b--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----9558ce6bde7b--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----9558ce6bde7b--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----9558ce6bde7b--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----9558ce6bde7b--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@ritvikkhanna09?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@ritvikkhanna09?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Ritvik Khanna"}, {"url": "https://medium.com/@ritvikkhanna09/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "315 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F56eae54bc970&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdesigning-a-machine-learning-model-and-deploying-it-using-flask-on-heroku-9558ce6bde7b&user=Ritvik+Khanna&userId=56eae54bc970&source=post_page-56eae54bc970--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fusers%2F56eae54bc970%2Flazily-enable-writer-subscription&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdesigning-a-machine-learning-model-and-deploying-it-using-flask-on-heroku-9558ce6bde7b&user=Ritvik+Khanna&userId=56eae54bc970&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}