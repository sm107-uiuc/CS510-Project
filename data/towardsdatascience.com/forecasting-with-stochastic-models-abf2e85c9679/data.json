{"url": "https://towardsdatascience.com/forecasting-with-stochastic-models-abf2e85c9679", "time": 1683009097.750439, "path": "towardsdatascience.com/forecasting-with-stochastic-models-abf2e85c9679/", "webpage": {"metadata": {"title": "Forecasting with Stochastic Models | by Kurtis Pykes | Towards Data Science", "h1": "Forecasting with Stochastic Models", "description": "We all want to know the future. Imagine the power we\u2019d possess if we knew what was going to happen in the future, we could alter it to get more suitable results, bet on it for financial gain, or even\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.kaggle.com/c/m5-forecasting-accuracy/data", "anchor_text": "Link", "paragraph_index": 9}, {"url": "https://www.kaggle.com/kurtispykes/m5-forecasting-late-bloomers-eda", "anchor_text": "here", "paragraph_index": 10}, {"url": "https://en.wikipedia.org/wiki/Mean_absolute_scaled_error", "anchor_text": "Mean Absolute Scaled Error", "paragraph_index": 13}, {"url": "https://robjhyndman.com/papers/foresight.pdf", "anchor_text": "here", "paragraph_index": 13}, {"url": "https://en.wikipedia.org/wiki/Unit_root_test#:~:text=In%20statistics%2C%20a%20unit%20root,depending%20on%20the%20test%20used.", "anchor_text": "unit root test", "paragraph_index": 21}, {"url": "https://en.wikipedia.org/wiki/Dickey%E2%80%93Fuller_test", "anchor_text": "Dickey-Fuller", "paragraph_index": 21}, {"url": "https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.diff.html", "anchor_text": "documentation here", "paragraph_index": 22}, {"url": "https://people.duke.edu/~rnau/411arim3.htm", "anchor_text": "This is a great resource to learn more about ACF and PACF plots", "paragraph_index": 26}, {"url": "https://en.wikipedia.org/wiki/Autoregressive_integrated_moving_average", "anchor_text": "here", "paragraph_index": 33}, {"url": "https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.cumsum.html", "anchor_text": "Documentation", "paragraph_index": 38}, {"url": "https://www.linkedin.com/in/kurtispykes/", "anchor_text": "https://www.linkedin.com/in/kurtispykes/", "paragraph_index": 41}, {"url": "http://OTexts.com/fpp2.", "anchor_text": "Forecasting: Principles and Practice, 2nd Edition", "paragraph_index": 42}, {"url": "https://arxiv.org/ftp/arxiv/papers/1302/1302.6613.pdf", "anchor_text": "An Introduction Study on Time Series Modelling and Forecasting", "paragraph_index": 43}], "all_paragraphs": ["We all want to know the future. Imagine the power we\u2019d possess if we knew what was going to happen in the future, we could alter it to get more suitable results, bet on it for financial gain, or even budget better. Although we can not outright determine what will happen in the future, we can build somewhat of an intuition of what it may be like.", "We hear often from self-improvement evangelist that we can distinguish how we have arrived at our present point in life by reflecting on our past actions. Thereby, to some degree we can predict the trajectory of our lives if we continue on a particular path. This is the essence of Time-series analysis. As stated in Adhikari, R and Agrawal, R. (2013). An Introduction Study on Time Series Modelling and Forecasting, \u201cThe main aim of time-series modelling is to carefully collect and rigorously study the past observations of a time-series to develop an appropriate model which describes the inherent structure of the series. This model is then used to generate future values for the series, i.e. to make forecast. Time-series forecasting thus can be termed as the act of predicting the future by understanding the past.\u201d", "\u201cThe present moment is an accumulation of past decisions\u201d \u2014 Unknown", "A popular and frequently used stochastic time-series model is the ARIMA model. It assumes that the time-series is linear and follows a particular known statistical distribution, such as the normal distribution, and has subclass of other models such as the Autoregressive (AR) model, the Moving average (MA) model, and the Autoregressive Moving Average (ARMA) model of which the ARIMA model was based on. Before effectively applying the ARIMA model to a problem, there are some things that we should understand about our data as you\u2019ll come to understand by the end of this post.", "Things to know - The 4 main components of a time series:", "Trend \u2192 The propensity of a a time series to increase, decrease or stagnate over a long period of time.", "Seasonality \u2192 Fluctuations within a year that are regular and predictable.", "Cyclical \u2192 Medium term changes in the series that repeat in cycles.", "Irregularities \u2192 Unpredictable influences that are not regular and do not repeat in a particular pattern.", "To download the data, click this Link and follow the instructions.", "The data I will be using in this article is from the M5 Forecasting - Accuracy competition on Kaggle, which is currently still live (at the time of writing this article). The competition challenges competitors of whom have been provided with hierarchical sales data \u2014 thanks to Walmart- from 3 different states (California, Texas and Wisconsin) to forecast the sales 28 days into the future. For access to the code generated in this article can be found on a Kaggle Notebook that I created, which can be found here or in the link below.", "Here are the frameworks we must import to perform the task at hand.", "I have done some preprocessing to the data to make use of it\u2019s hierarchical structure.", "The competition is evaluated on RMSSE (Root Mean Squared Scaled Error), which is derived from the MASE (Mean Absolute Scaled Error) that was designed to be invariant and symmetric \u2014 you can learn more about forecast accuracy metrics here (the difference for this competition is that the A(Absoulute) in MASE is replaced with S(Squared) for Mean Squared Scaled Error and we take the Root of this for RMSSE).", "Understanding the concept of stationarity is important as it has high impact on the type of model that we can fit to our data to forecast future values. We refer to a time-series as stationary when its properties do not depend on the time at which the series was observed. Some criteria for stationarity are as follows:", "Simply, a time-series that is stationary will have no predictable patterns in the long term. For the mathematicians, a random process is known to be stationary when the joint distribution remains the same over time. Let\u2019s look at some random items from our data to see whether they are stationary.", "The ARMA model is a combination of the Autoregressive and Moving Average models. This traditional approach requires the data to be stationary, however, things do not always work out as we\u2019d expect in the real world. In-fact, in the real world, data is much more likely to be non-stationary, hence the birth of ARIMA which uses a clever technique called differencing to make non-stationary data stationary.", "Differencing computes the change between consecutive observations in the original series, which helps to stabilize the mean since it removes the changes in the level of a series \u2014 This has the effect of eliminating (or reducing) seasonality and trend. This technique is widely used for non-stationary data such as financial and economic data. The ARIMA model adopts the differencing technique to convert a time-series that is non-stationary to a stationary time-series. We can express the differenced series mathematically as shown in Figure 2.", "When the differenced data does not appear to stationary, we can do differencing a 2nd time \u2014 It\u2019s almost never required for you to go past the 2nd order in practice \u2014 which can be expressed mathematically in Figure 3.", "We can also get the difference of an observation and another observation from the same season. This phenomenon is known as seasonal differencing.", "Occasionally, we may be required to take the ordinary differences (this is the differencing technique we discuss in Figure 2.Referred to as first differences meaning the differences at lag 1) and seasonal differences to make our data stationary.", "In python, we can use visualization and/or unit root test to determine whether differencing is required for our data \u2014 not there are other methods to determine stationarity. There are many different unit root test which have different assumption, but we will be using the Dickey-Fuller. Below I will visualize a store and try to determine whether you think it is stationary before you look at the results of the dickey-fuller test.", "The p-value is greater than the significance level that we set (0.05) therefore we do not reject the null hypothesis that there is unit roots in our data. In other words, our data is non-stationary \u2014 it does not meet the criteria for stationarity that we described above, hence why we must do some differencing for our data to become stationary. Pandas has a cool function DataFrame.diff() that does this for us \u2014 you can read more in the documentation here.", "The ARIMA model has hyperparameters, p, d and q that must be defined. Autocorrelation Function (ACF) and Partial Autocorrelation function (PACF) plots make determining the order p, and q of the model easier.", "The ACF plot shows the autocorrelation of the time-series, meaning that we can measure the relationship between the y_t and y_{t-k}. The simplest way to put this is as the coefficients of correlation between a time-series and the lags of itself.", "PACF plots show a measure of relationship between y_t and y_{t-k} after the effects of lags are removed. If we think of correlation, it\u2019s the interdependence of variables. The \u201cpartial\u201d correlation talks of the correlation between them that is not explained by their mutual correlations with a specified set of other variables. When we adjust this for autocorrelation, we speak of the correlation between a time-series and a lag of itself that is not explained by correlations from lower order lags.", "This is a great resource to learn more about ACF and PACF plots.", "Let\u2019s see some of our visualizations\u2026", "This suggest that we should try to fit an AR(8) model to our data, which I have done in the next section.", "Lag/Backshift notation is an extremely useful notation device. Various sources use different notation to denote Lag, L or Backshift, B.", "The Autoregression, AR(p), model generates forecast by using a linear combination of past variables of the variable. We can think of autoregression as regression of the variable against itself.", "Moving Average, MA(q), model on the other hand uses past forecast errors instead of past values, in a regression like model. Therefore, we can think of each forecast value to be a weighted moving average of the past few forecast errors.", "All roads lead to this point. If we combine differencing, our autoregression model and moving average model, we get ARIMA(p, d, q).", "Note that it is often much easier to use lag notation to denote the ARIMA model. You can learn more about how to do this here.", "p = The order of the Autoregressive part of the model", "d= The degree of first differencing in our model", "q = The order of the Moving average part of the model", "We can have a closer look\u2026", "To see how we done against actual predictions, we must first go back to the original scale of the data to compare. There is a useful cumsum() function we can use in pandas \u2014 Documentation.", "I have joined this competition a little late, but there is still sufficient time to better this result (which I will be sharing with you all).", "A useful flow chart was provided by Rob Hyndman in the book Forecasting: Principles and Practice which is extremely useful. A link to the online book will be in the Other Resources section below.", "Thank you for taking the time to read this article. I am a self-taught Data Scientist from London, England. I can be reached via LinkedIn via https://www.linkedin.com/in/kurtispykes/. Please do not hesitate to reach out to me, meeting new people is awesome.", "Forecasting: Principles and Practice, 2nd Edition", "An Introduction Study on Time Series Modelling and Forecasting", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fabf2e85c9679&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fforecasting-with-stochastic-models-abf2e85c9679&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fforecasting-with-stochastic-models-abf2e85c9679&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fforecasting-with-stochastic-models-abf2e85c9679&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fforecasting-with-stochastic-models-abf2e85c9679&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----abf2e85c9679--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----abf2e85c9679--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://kurtispykes.medium.com/?source=post_page-----abf2e85c9679--------------------------------", "anchor_text": ""}, {"url": "https://kurtispykes.medium.com/?source=post_page-----abf2e85c9679--------------------------------", "anchor_text": "Kurtis Pykes"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F5ba760786877&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fforecasting-with-stochastic-models-abf2e85c9679&user=Kurtis+Pykes&userId=5ba760786877&source=post_page-5ba760786877----abf2e85c9679---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fabf2e85c9679&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fforecasting-with-stochastic-models-abf2e85c9679&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fabf2e85c9679&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fforecasting-with-stochastic-models-abf2e85c9679&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@drew_beamer?utm_source=medium&utm_medium=referral", "anchor_text": "Drew Beamer"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://www.kaggle.com/c/m5-forecasting-accuracy/data", "anchor_text": "Link"}, {"url": "https://www.kaggle.com/kurtispykes/m5-forecasting-late-bloomers-eda", "anchor_text": "here"}, {"url": "https://www.kaggle.com/kurtispykes/a-look-at-arima-model-for-forecasting", "anchor_text": "A look at ARIMA model for ForecastingExplore and run machine learning code with Kaggle Notebooks | Using data from M5 Forecasting - Accuracywww.kaggle.com"}, {"url": "https://en.wikipedia.org/wiki/Mean_absolute_scaled_error", "anchor_text": "Mean Absolute Scaled Error"}, {"url": "https://robjhyndman.com/papers/foresight.pdf", "anchor_text": "here"}, {"url": "https://en.wikipedia.org/wiki/Unit_root_test#:~:text=In%20statistics%2C%20a%20unit%20root,depending%20on%20the%20test%20used.", "anchor_text": "unit root test"}, {"url": "https://en.wikipedia.org/wiki/Dickey%E2%80%93Fuller_test", "anchor_text": "Dickey-Fuller"}, {"url": "https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.diff.html", "anchor_text": "documentation here"}, {"url": "https://people.duke.edu/~rnau/411arim3.htm", "anchor_text": "This is a great resource to learn more about ACF and PACF plots"}, {"url": "https://people.duke.edu/~rnau/411arim3.htm", "anchor_text": "Identifying the orders of AR and MA terms in an ARIMA model"}, {"url": "http://OTexts.com/fpp2.", "anchor_text": "OTexts.com/fpp2."}, {"url": "https://en.wikipedia.org/wiki/Autoregressive_integrated_moving_average", "anchor_text": "here"}, {"url": "http://OTexts.com/fpp2", "anchor_text": "OTexts.com/fpp2"}, {"url": "https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.cumsum.html", "anchor_text": "Documentation"}, {"url": "http://OTexts.com/fpp2.", "anchor_text": "OTexts.com/fpp2."}, {"url": "https://www.linkedin.com/in/kurtispykes/", "anchor_text": "https://www.linkedin.com/in/kurtispykes/"}, {"url": "http://OTexts.com/fpp2.", "anchor_text": "Forecasting: Principles and Practice, 2nd Edition"}, {"url": "https://arxiv.org/ftp/arxiv/papers/1302/1302.6613.pdf", "anchor_text": "An Introduction Study on Time Series Modelling and Forecasting"}, {"url": "https://en.wikipedia.org/wiki/Autoregressive_integrated_moving_average", "anchor_text": "Autoregressive Integrated Moving Average"}, {"url": "https://medium.com/tag/data-science?source=post_page-----abf2e85c9679---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----abf2e85c9679---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----abf2e85c9679---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/ai?source=post_page-----abf2e85c9679---------------ai-----------------", "anchor_text": "AI"}, {"url": "https://medium.com/tag/towards-data-science?source=post_page-----abf2e85c9679---------------towards_data_science-----------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fabf2e85c9679&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fforecasting-with-stochastic-models-abf2e85c9679&user=Kurtis+Pykes&userId=5ba760786877&source=-----abf2e85c9679---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fabf2e85c9679&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fforecasting-with-stochastic-models-abf2e85c9679&user=Kurtis+Pykes&userId=5ba760786877&source=-----abf2e85c9679---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fabf2e85c9679&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fforecasting-with-stochastic-models-abf2e85c9679&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----abf2e85c9679--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fabf2e85c9679&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fforecasting-with-stochastic-models-abf2e85c9679&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----abf2e85c9679---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----abf2e85c9679--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----abf2e85c9679--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----abf2e85c9679--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----abf2e85c9679--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----abf2e85c9679--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----abf2e85c9679--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----abf2e85c9679--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----abf2e85c9679--------------------------------", "anchor_text": ""}, {"url": "https://kurtispykes.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://kurtispykes.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Kurtis Pykes"}, {"url": "https://kurtispykes.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "9.3K Followers"}, {"url": "https://www.fullstackfreelancershub.com/wisdom-wednesday", "anchor_text": "https://www.fullstackfreelancershub.com/wisdom-wednesday"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F5ba760786877&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fforecasting-with-stochastic-models-abf2e85c9679&user=Kurtis+Pykes&userId=5ba760786877&source=post_page-5ba760786877--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Ffde3d752d24c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fforecasting-with-stochastic-models-abf2e85c9679&newsletterV3=5ba760786877&newsletterV3Id=fde3d752d24c&user=Kurtis+Pykes&userId=5ba760786877&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}