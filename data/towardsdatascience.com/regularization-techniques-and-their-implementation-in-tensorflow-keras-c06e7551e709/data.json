{"url": "https://towardsdatascience.com/regularization-techniques-and-their-implementation-in-tensorflow-keras-c06e7551e709", "time": 1683006895.627823, "path": "towardsdatascience.com/regularization-techniques-and-their-implementation-in-tensorflow-keras-c06e7551e709/", "webpage": {"metadata": {"title": "Regularization Techniques And Their Implementation In TensorFlow(Keras) | by Richmond Alake | Towards Data Science", "h1": "Regularization Techniques And Their Implementation In TensorFlow(Keras)", "description": "Deep Neural Networks(DNN) have a vast amount of weights parameters internal to the architecture that learn a range of values. These range of values are the essential key to enabling the neural\u2026"}, "outgoing_paragraph_urls": [{"url": "https://medium.com/u/c2958659896a?source=post_page-----c06e7551e709--------------------------------", "anchor_text": "Raimi Karim", "paragraph_index": 7}, {"url": "https://medium.com/u/31b07253bc35?source=post_page-----c06e7551e709--------------------------------", "anchor_text": "Renu Khandelwal", "paragraph_index": 7}, {"url": "https://en.wikipedia.org/wiki/Elastic_net_regularization", "anchor_text": "\u2018Elastic Net regularization", "paragraph_index": 16}, {"url": "https://github.com/zalandoresearch/fashion-mnist", "anchor_text": "fashion-MNIST dataset", "paragraph_index": 20}, {"url": "https://machinelearningmastery.com/dropout-for-regularizing-deep-neural-networks/", "anchor_text": "Dropout", "paragraph_index": 35}, {"url": "https://en.wikipedia.org/wiki/Early_stopping", "anchor_text": "Early Stopping", "paragraph_index": 35}], "all_paragraphs": ["Deep Neural Networks(DNN) have a vast amount of weights parameters internal to the architecture that learn a range of values. These range of values are the essential key to enabling the neural network to solve huge complex functions.", "The deeper a neural network is, the more representational power it possesses, but, there is a shortcoming that occurs as the number of weight parameter increases. This shortcoming is that the neural network is more prone to overfitting the training dataset.", "Overfitting: This problem involves the algorithm predicting new instances of patterns presented to it, based too closely on instances of patterns it observed and learnt during training. This can cause the machine-learning algorithm to not generalize accurately to unseen data. Overfitting can occur if the training data does not accurately represent the distribution of test data. Overfitting can be fixed by reducing the number of features in the training data and reducing the complexity of the network through various techniques", "Regularization techniques reduce the possibility of a neural network overfitting by constraining the range of values that the weight values within the network hold(more on this later).", "This article introduces two regularization strategies that impose constraining terms on the results of loss functions.", "The loss function is a method that quantifies \u2018how well\u2019 a machine learning model performs. The quantification is an output(cost) based on a set of inputs, which are referred to as parameter values. The parameter values are used to estimate a prediction, and the \u2018loss\u2019 is the difference between the predictions and the actual values.", "This article won\u2019t focus on the maths of regularization. Instead, this article presents some standard regularization methods and how to implement them within neural networks using TensorFlow(Keras).", "For more details on the maths, these article by Raimi Karim and Renu Khandelwal present L1 and L2 regularization maths reasonably.", "From the previous section, we can understand that the regularization technique acts on the weights parameters within neural networks. More specifically, it modifies the result loss function, which in turn modifies the weight values produced.", "L1 regularization effect on the neural network weight values is that it penalizes weight values that are close to 0 by making them equal to 0. Negative weight values also take a value of 0; so if a weight value is -2, under the effect of L1 regularization, it becomes 0.", "The general intuition with L1 regularization is that, if a weight value is close to 0 or very small, then it\u2019s negligible when it comes to the overall performance of the model, therefore making it 0 does not affect the model\u2019s performance and can reduce the memory capacity of the model.", "I know I said I wouldn\u2019t get into the maths, but the mathematical notation below should be relatively easy to understand.", "We have our loss function, in this case, Mean squared error.", "Then we add the product of the sum of the absolute values of the weights and the regularization hyperparameter value, represented by the lambda symbol ().", "\u2018i\u2019 in the mathematical notation represent the index of the current weight, and \u2019n\u2019 represents the total number of weights values within the layer. \u2018W\u2019 represents the weight value.", "L2 regularization also penalizes weight values. For both small weight values and relatively large ones, L2 regularization transforms the values to a number close to 0, but not quite 0.", "If you were to combine the effect of L1 and L2 regularization techniques, then you would arrive at \u2018Elastic Net regularization\u2019.", "Regularization techniques effect is imposed on the neural network during training and not inference.", "Now we have some basic understanding of regularization(feel free to explore the maths of both methods) and some examples, let\u2019s see how they are implemented.", "The first step is to import tools and libraries that are utilized to either implement or support the implementation of the neural network.", "The dataset we\u2019ll be utilizing is the trivial fashion-MNIST dataset.", "The fashion-MNIST dataset contains 70,000 images of clothing. More specifically, it includes 60,000 training examples and 10,000 testing examples, that are all grayscale images with dimension 28 x 28 categorized into ten classes.", "Preparation of the dataset includes the normalization of the training image and test images by dividing each pixel value by 255.0. This places the pixel value within the range 0 and 1.", "A validation portion of the dataset is also created at this stage. This group of the dataset is utilized during training to assess the performance of the network at various iterations.", "Next, we implement a simple model using the Keras Sequential API. The hidden layers in our model have a variety of regularization techniques used.", "To add a regularizer to a layer, you simply have to pass in the prefered regularization technique to the layer\u2019s keyword argument \u2018kernel_regularizer\u2019.", "The Keras regularization implementation methods can provide a parameter that represents the regularization hyperparameter value. This is shown in some of the layers below.", "Keras provides an implementation of the l1 and l2 regularizers that we will utilize in some of the hidden layers in the code snippet below. Also, we include a layer that leverages both l1 and l2 regularization.", "And that\u2019s all there is to implementing various regularization techniques within neural networks. Not too difficult.", "In the next snippet of code we set and specify the optimization algorithm used to train the implemented neural network; along with the loss function and hyperparameters such as learning rate and the number of epochs.", "The evaluation of the model performance is conducted using the test data set aside earlier.", "With evaluation results, you can decide to fine-tune the network hyperparameters or move forward to production after observing the accuracy of the evaluation over the test dataset.", "The implemented model will probably have a better performance on the test dataset if the regularization terms on the loss function were excluded from the layers and trained for the same number of epochs.", "Regularization is more commonly utilized in a deeper neural network with millions of parameters and more features.", "I hope you the reader now have an intuition on the variety of regularization techniques and how they can be implemented.", "It might be of interest to explore other regularization methods within neural network implementation and training, such as Dropout or Early Stopping.", "Below is the GitHub repository for the code included in this article.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Machine Learning Content Creator with 1M+ views\u2014 Computer Vision Engineer. Interested in gaining and sharing knowledge on Technology and Finance"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fc06e7551e709&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fregularization-techniques-and-their-implementation-in-tensorflow-keras-c06e7551e709&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fregularization-techniques-and-their-implementation-in-tensorflow-keras-c06e7551e709&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fregularization-techniques-and-their-implementation-in-tensorflow-keras-c06e7551e709&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fregularization-techniques-and-their-implementation-in-tensorflow-keras-c06e7551e709&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----c06e7551e709--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----c06e7551e709--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://richmondalake.medium.com/?source=post_page-----c06e7551e709--------------------------------", "anchor_text": ""}, {"url": "https://richmondalake.medium.com/?source=post_page-----c06e7551e709--------------------------------", "anchor_text": "Richmond Alake"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F88797ba3f2f6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fregularization-techniques-and-their-implementation-in-tensorflow-keras-c06e7551e709&user=Richmond+Alake&userId=88797ba3f2f6&source=post_page-88797ba3f2f6----c06e7551e709---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc06e7551e709&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fregularization-techniques-and-their-implementation-in-tensorflow-keras-c06e7551e709&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc06e7551e709&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fregularization-techniques-and-their-implementation-in-tensorflow-keras-c06e7551e709&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@herfrenchness?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Clarisse Croset"}, {"url": "https://unsplash.com/s/photos/machine-learning?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://medium.com/u/c2958659896a?source=post_page-----c06e7551e709--------------------------------", "anchor_text": "Raimi Karim"}, {"url": "https://medium.com/u/31b07253bc35?source=post_page-----c06e7551e709--------------------------------", "anchor_text": "Renu Khandelwal"}, {"url": "https://medium.com/datadriveninvestor/l1-l2-regularization-7f1b4fe948f2", "anchor_text": "L1 L2 RegularizationIn this article, we will understand why do we need regularization, what is regularization, what are different types of\u2026medium.com"}, {"url": "https://towardsdatascience.com/intuitions-on-l1-and-l2-regularisation-235f2db4c261", "anchor_text": "Intuitions on L1 and L2 RegularisationHow can they prevent overfitting?towardsdatascience.com"}, {"url": "https://en.wikipedia.org/wiki/Elastic_net_regularization", "anchor_text": "\u2018Elastic Net regularization"}, {"url": "https://www.tensorflow.org/", "anchor_text": "TensorFlow"}, {"url": "https://keras.io/", "anchor_text": "Keras"}, {"url": "https://github.com/zalandoresearch/fashion-mnist", "anchor_text": "fashion-MNIST dataset"}, {"url": "https://machinelearningmastery.com/dropout-for-regularizing-deep-neural-networks/", "anchor_text": "Dropout"}, {"url": "https://en.wikipedia.org/wiki/Early_stopping", "anchor_text": "Early Stopping"}, {"url": "https://github.com/RichmondAlake/tensorflow_2_tutorials/blob/master/09_regularization.ipynb", "anchor_text": "RichmondAlake/tensorflow_2_tutorialsPermalink Dismiss GitHub is home to over 50 million developers working together to host and review code, manage\u2026github.com"}, {"url": "https://towardsdatascience.com/batch-normalization-in-neural-networks-code-d7c9b88da9f5", "anchor_text": "Batch Normalization In Neural Networks (Code)Implemented With TensorFlow (Keras)towardsdatascience.com"}, {"url": "https://towardsdatascience.com/5-soft-skills-you-need-as-a-machine-learning-engineer-and-why-41ef6854cef6", "anchor_text": "5 Soft Skills You Need As A Machine Learning Engineer (And Why)Includes tips on becoming a useful component of any workforcetowardsdatascience.com"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----c06e7551e709---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----c06e7551e709---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----c06e7551e709---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----c06e7551e709---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/programming?source=post_page-----c06e7551e709---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fc06e7551e709&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fregularization-techniques-and-their-implementation-in-tensorflow-keras-c06e7551e709&user=Richmond+Alake&userId=88797ba3f2f6&source=-----c06e7551e709---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fc06e7551e709&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fregularization-techniques-and-their-implementation-in-tensorflow-keras-c06e7551e709&user=Richmond+Alake&userId=88797ba3f2f6&source=-----c06e7551e709---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc06e7551e709&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fregularization-techniques-and-their-implementation-in-tensorflow-keras-c06e7551e709&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----c06e7551e709--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fc06e7551e709&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fregularization-techniques-and-their-implementation-in-tensorflow-keras-c06e7551e709&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----c06e7551e709---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----c06e7551e709--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----c06e7551e709--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----c06e7551e709--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----c06e7551e709--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----c06e7551e709--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----c06e7551e709--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----c06e7551e709--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----c06e7551e709--------------------------------", "anchor_text": ""}, {"url": "https://richmondalake.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://richmondalake.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Richmond Alake"}, {"url": "https://richmondalake.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "7.3K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F88797ba3f2f6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fregularization-techniques-and-their-implementation-in-tensorflow-keras-c06e7551e709&user=Richmond+Alake&userId=88797ba3f2f6&source=post_page-88797ba3f2f6--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F366f35b0b39b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fregularization-techniques-and-their-implementation-in-tensorflow-keras-c06e7551e709&newsletterV3=88797ba3f2f6&newsletterV3Id=366f35b0b39b&user=Richmond+Alake&userId=88797ba3f2f6&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}