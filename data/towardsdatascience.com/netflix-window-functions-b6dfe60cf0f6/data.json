{"url": "https://towardsdatascience.com/netflix-window-functions-b6dfe60cf0f6", "time": 1683006195.9910452, "path": "towardsdatascience.com/netflix-window-functions-b6dfe60cf0f6/", "webpage": {"metadata": {"title": "Netflix & Window Functions. A quick intro to window functions and a\u2026 | by Taylor Brownlow | Towards Data Science", "h1": "Netflix & Window Functions", "description": "If you\u2019re anything like me, you\u2019ve found yourself watching a lot more Netflix these days. And if you\u2019re even more like me, you\u2019ve been dying to get your hands on some data to prove it. Luckily, you\u2026"}, "outgoing_paragraph_urls": [{"url": "https://count.co/n/nS97P4kEGwe", "anchor_text": "download your own viewing history from Netflix", "paragraph_index": 1}, {"url": "https://count.co/n/0erWed0YsMF", "anchor_text": "here", "paragraph_index": 5}, {"url": "https://count.co", "anchor_text": "Count", "paragraph_index": 6}, {"url": "https://count.us14.list-manage.com/subscribe?u=cb976a2c8a5001582f457b949&id=99e559dc4e", "anchor_text": "here", "paragraph_index": 7}, {"url": "https://count.us14.list-manage.com/subscribe?u=cb976a2c8a5001582f457b949&id=99e559dc4e", "anchor_text": "here", "paragraph_index": 32}], "all_paragraphs": ["If you\u2019re anything like me, you\u2019ve found yourself watching a lot more Netflix these days. And if you\u2019re even more like me, you\u2019ve been dying to get your hands on some data to prove it.", "Luckily, you can download your own viewing history from Netflix, and have a data party all on your own! \ud83e\udd73", "Even more good news: this turns out to be an excellent example of how to take advantage of the powerful and elusive window function. This family of functions is often considered \u2018advanced\u2019 SQL, and therefore, not as commonly used as they should be.", "In the analysis below, you\u2019ll learn more about what window functions are, and more importantly, how to get the most out of them.", "So if you\u2019re looking to see what all the window function hype is about, or are tired of trying to explain window functions to others, or just really want to know how much TV I watch, this is for you.", "2. Or, if you prefer to read, you can check out the final analysis here, or I\u2019ve replicated the final notebook below!", "Before you begin, if you need a little primer on window functions, we\u2019ve got you covered. The following guide is written in Count but the content is applicable to any SQL tool!", "It can be hard to find pragmatic data training materials for you and your team to get better with data. We curate the best there is and share it in our weekly newsletter. Sign-up here if you want to see what it\u2019s all about.", "Determine how often I am \u2018binge-watching\u2019 on Netflix, and if that has increased since the \u2018shelter-in-place\u2019 directive began in March 2020.", "The data comes from Netflix looking like this:", "The Title field has all the important bits in it. So, I decided to split on \u201c:\u201d to separate out the Show or Movie title, from the Season, and Episode name.", "Depending on the tool you\u2019re using, the code to do this will look different, but they should all have the same result.", "You may want to spend more time here depending on your objective, but for me, this was enough!", "It\u2019s always a good idea to take some time getting to know your data before you dive into any analysis.", "Through this step, I found one very key finding:", "Netflix only gives you the most recent time you\u2019ve watched each show \ud83d\ude29.", "Very disappointing. This makes it difficult, impossible really, to model past viewing activity since there could be a lot of shows that I used to watch (Friends), and still watch (Friends), that will only be counted recently.", "Since I\u2019m looking to understand my binge-watching behaviour, I need to define what that is exactly.", "I decided to define binge-watching as:", "So, how do we get there\u2026", "Right now, the data looks like this:", "And I need it to look like this:", "And to do this we need window functions! There\u2019s a quick primer on window functions here:", "The steps I take to take to do that are:", "2. Use row numbers or indexes to work out how many episodes there were", "3. Work out the date that the episode before this one was watched. For the streak start rows, this will be equal to the end date of the previous streak", "After doing those 3 steps, I\u2019m getting closer:", "4. Filter for just streak starts", "5. Pull in the row number and the last watch date from the leading row:", "6. And, lastly a little math:", "From these two charts I can say:", "That is the extent of my personal data I\u2019m willing to share today, but you can imagine how you could take this analysis further if you wanted to (and I hope you do). If you did your own analysis of Netflix data, please let us know how it went in the comments!", "It can be hard to find pragmatic data training materials for you and your team to get better with data. We curate the best there is and share it in our weekly newsletter. Sign-up here if you want to see what it\u2019s all about.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fb6dfe60cf0f6&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnetflix-window-functions-b6dfe60cf0f6&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnetflix-window-functions-b6dfe60cf0f6&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnetflix-window-functions-b6dfe60cf0f6&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnetflix-window-functions-b6dfe60cf0f6&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----b6dfe60cf0f6--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----b6dfe60cf0f6--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://taylor-count.medium.com/?source=post_page-----b6dfe60cf0f6--------------------------------", "anchor_text": ""}, {"url": "https://taylor-count.medium.com/?source=post_page-----b6dfe60cf0f6--------------------------------", "anchor_text": "Taylor Brownlow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fcdc63fa2a06e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnetflix-window-functions-b6dfe60cf0f6&user=Taylor+Brownlow&userId=cdc63fa2a06e&source=post_page-cdc63fa2a06e----b6dfe60cf0f6---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb6dfe60cf0f6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnetflix-window-functions-b6dfe60cf0f6&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb6dfe60cf0f6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnetflix-window-functions-b6dfe60cf0f6&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://count.co/n/nS97P4kEGwe", "anchor_text": "download your own viewing history from Netflix"}, {"url": "https://count.co/n/0erWed0YsMF", "anchor_text": "here"}, {"url": "https://count.co", "anchor_text": "Count"}, {"url": "https://count.co/n/0erWed0YsMF", "anchor_text": "My Netflix ProjectRecently I learned that Netflix will provide you with all of the information they have on you. Curiosity got the best\u2026count.co"}, {"url": "https://count.us14.list-manage.com/subscribe?u=cb976a2c8a5001582f457b949&id=99e559dc4e", "anchor_text": "here"}, {"url": "https://count.co/sql-resources/bigquery-standard-sql/window-functions-explained", "anchor_text": "Window Functions Explained | BigQuery Syntax and Examples | CountEverything you need to know about SQL window functions. Window functions, or Analytic functions as they're called in\u2026count.co"}, {"url": "https://count.co/n/r8jQNna2nOF", "anchor_text": "here"}, {"url": "https://count.co/n/r8jQNna2nOF", "anchor_text": "here"}, {"url": "https://count.us14.list-manage.com/subscribe?u=cb976a2c8a5001582f457b949&id=99e559dc4e", "anchor_text": "here"}, {"url": "https://medium.com/tag/data?source=post_page-----b6dfe60cf0f6---------------data-----------------", "anchor_text": "Data"}, {"url": "https://medium.com/tag/how-to?source=post_page-----b6dfe60cf0f6---------------how_to-----------------", "anchor_text": "How To"}, {"url": "https://medium.com/tag/data-analysis?source=post_page-----b6dfe60cf0f6---------------data_analysis-----------------", "anchor_text": "Data Analysis"}, {"url": "https://medium.com/tag/sql?source=post_page-----b6dfe60cf0f6---------------sql-----------------", "anchor_text": "Sql"}, {"url": "https://medium.com/tag/netflix?source=post_page-----b6dfe60cf0f6---------------netflix-----------------", "anchor_text": "Netflix"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fb6dfe60cf0f6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnetflix-window-functions-b6dfe60cf0f6&user=Taylor+Brownlow&userId=cdc63fa2a06e&source=-----b6dfe60cf0f6---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fb6dfe60cf0f6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnetflix-window-functions-b6dfe60cf0f6&user=Taylor+Brownlow&userId=cdc63fa2a06e&source=-----b6dfe60cf0f6---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb6dfe60cf0f6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnetflix-window-functions-b6dfe60cf0f6&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----b6dfe60cf0f6--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fb6dfe60cf0f6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnetflix-window-functions-b6dfe60cf0f6&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----b6dfe60cf0f6---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----b6dfe60cf0f6--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----b6dfe60cf0f6--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----b6dfe60cf0f6--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----b6dfe60cf0f6--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----b6dfe60cf0f6--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----b6dfe60cf0f6--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----b6dfe60cf0f6--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----b6dfe60cf0f6--------------------------------", "anchor_text": ""}, {"url": "https://taylor-count.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://taylor-count.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Taylor Brownlow"}, {"url": "https://taylor-count.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "4.3K Followers"}, {"url": "https://count.co", "anchor_text": "https://count.co"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fcdc63fa2a06e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnetflix-window-functions-b6dfe60cf0f6&user=Taylor+Brownlow&userId=cdc63fa2a06e&source=post_page-cdc63fa2a06e--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Ff2ca940da932&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnetflix-window-functions-b6dfe60cf0f6&newsletterV3=cdc63fa2a06e&newsletterV3Id=f2ca940da932&user=Taylor+Brownlow&userId=cdc63fa2a06e&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}