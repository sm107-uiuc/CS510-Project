{"url": "https://towardsdatascience.com/how-to-create-a-custom-loss-function-keras-3a89156ec69b", "time": 1683005912.3880389, "path": "towardsdatascience.com/how-to-create-a-custom-loss-function-keras-3a89156ec69b/", "webpage": {"metadata": {"title": "How to Create a Custom Loss Function | Keras | by Shiva Verma | Towards Data Science", "h1": "How to Create a Custom Loss Function | Keras", "description": "The Loss Function is one of the important components of Neural Network. Loss is nothing but a prediction error of Neural Net. And the method to calculate the loss is called Loss Function. Loss is\u2026"}, "outgoing_paragraph_urls": [{"url": "https://towardsdatascience.com/understanding-different-loss-functions-for-neural-networks-dd1ed0274718", "anchor_text": "blog", "paragraph_index": 2}], "all_paragraphs": ["The Loss Function is one of the important components of Neural Network. Loss is nothing but a prediction error of Neural Net. And the method to calculate the loss is called Loss Function.", "Loss is used to calculate the gradients for the neural net. And gradients are used to update the weights. This is how a Neural Net is trained.", "Keras has many inbuilt loss functions, which I have covered in one of my previous blog. These loss functions are enough for many typical Machine Learning tasks such as Classification and Regression.", "But there might be some tasks where we need to implement a custom loss function, which I will be covering in this Blog.", "Before starting, let\u2019s quickly review how we use an inbuilt loss function in Keras.", "Following is a simple example of using an inbuilt loss function.", "Here we used in-built categorical_crossentropy loss function, which is mostly used for the classification task. We pass the name of the loss function in model.compile() method.", "We can create a custom loss function simply as follows.", "There are following rules you have to follow while building a custom loss function.", "Let\u2019s look at an example for better understanding.", "Let\u2019s say, you have designed a Neural Net for some regression task, which outputs a vector [x1, x2] of length 2.", "Assume that value x2 is more important than x1, and you want it to be really close to the target value. For this scenario, you can create a custom MSE (mean squared error) loss function which penalizes prediction error for x2 more than x1.", "Here I am multiplying loss values with weights 0.3 and 0.7, giving more penalty to the second value, which is the x2. You can decide the weights as per your requirement.", "I have also written down the shape of variables in the code snippet. You can see the shape of the final loss would be(batch_size,), means one loss value for each data point.", "Now you can simply plug this loss function to your model.", "Now you already know how to build a custom loss function. You can also create custom evaluation metrics in the exact similar way. Here I have created a Mean Absolute Error(MAE) metrics and plugged it into model.compile() method.", "If you want to understand the concept of Dimensions and Shapes. You can go through the following article where I am explaining these concepts in detail.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Machine Learning Engineer | Available for consultancy | shivajbd@gmail.com"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F3a89156ec69b&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-create-a-custom-loss-function-keras-3a89156ec69b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-create-a-custom-loss-function-keras-3a89156ec69b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-create-a-custom-loss-function-keras-3a89156ec69b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-create-a-custom-loss-function-keras-3a89156ec69b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----3a89156ec69b--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----3a89156ec69b--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://shiva-verma.medium.com/?source=post_page-----3a89156ec69b--------------------------------", "anchor_text": ""}, {"url": "https://shiva-verma.medium.com/?source=post_page-----3a89156ec69b--------------------------------", "anchor_text": "Shiva Verma"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F264e4c28977e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-create-a-custom-loss-function-keras-3a89156ec69b&user=Shiva+Verma&userId=264e4c28977e&source=post_page-264e4c28977e----3a89156ec69b---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F3a89156ec69b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-create-a-custom-loss-function-keras-3a89156ec69b&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F3a89156ec69b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-create-a-custom-loss-function-keras-3a89156ec69b&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@isaacmsmith?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Isaac Smith"}, {"url": "https://unsplash.com/s/photos/graph?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://towardsdatascience.com/understanding-different-loss-functions-for-neural-networks-dd1ed0274718", "anchor_text": "blog"}, {"url": "https://towardsdatascience.com/understanding-axes-and-dimensions-numpy-pandas-606407a5f950", "anchor_text": "Understanding Axes and Dimensions | Numpy | PandasKnow how to apply a function along various axis in Data.towardsdatascience.com"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----3a89156ec69b---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/programming?source=post_page-----3a89156ec69b---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/tag/data-science?source=post_page-----3a89156ec69b---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----3a89156ec69b---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/neural-networks?source=post_page-----3a89156ec69b---------------neural_networks-----------------", "anchor_text": "Neural Networks"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F3a89156ec69b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-create-a-custom-loss-function-keras-3a89156ec69b&user=Shiva+Verma&userId=264e4c28977e&source=-----3a89156ec69b---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F3a89156ec69b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-create-a-custom-loss-function-keras-3a89156ec69b&user=Shiva+Verma&userId=264e4c28977e&source=-----3a89156ec69b---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F3a89156ec69b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-create-a-custom-loss-function-keras-3a89156ec69b&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----3a89156ec69b--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F3a89156ec69b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-create-a-custom-loss-function-keras-3a89156ec69b&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----3a89156ec69b---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----3a89156ec69b--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----3a89156ec69b--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----3a89156ec69b--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----3a89156ec69b--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----3a89156ec69b--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----3a89156ec69b--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----3a89156ec69b--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----3a89156ec69b--------------------------------", "anchor_text": ""}, {"url": "https://shiva-verma.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://shiva-verma.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Shiva Verma"}, {"url": "https://shiva-verma.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "1.1K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F264e4c28977e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-create-a-custom-loss-function-keras-3a89156ec69b&user=Shiva+Verma&userId=264e4c28977e&source=post_page-264e4c28977e--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F4e2b64ff1845&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-create-a-custom-loss-function-keras-3a89156ec69b&newsletterV3=264e4c28977e&newsletterV3Id=4e2b64ff1845&user=Shiva+Verma&userId=264e4c28977e&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}