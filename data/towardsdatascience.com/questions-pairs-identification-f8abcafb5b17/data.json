{"url": "https://towardsdatascience.com/questions-pairs-identification-f8abcafb5b17", "time": 1682995404.4442098, "path": "towardsdatascience.com/questions-pairs-identification-f8abcafb5b17/", "webpage": {"metadata": {"title": "Question pairs identification. There are no stupid questions\u2026only\u2026 | by Kirti Pande | Towards Data Science", "h1": "Question pairs identification", "description": "You have a burning question \u2014 you login to Quora, post your question and wait for responses. There is a chance that what you asked is truly unique but more often than not if you have a question\u2026"}, "outgoing_paragraph_urls": [{"url": "https://medium.com/u/14b152ad8569?source=post_page-----f8abcafb5b17--------------------------------", "anchor_text": "Jui Gupta", "paragraph_index": 1}, {"url": "https://medium.com/u/140754e8ee4d?source=post_page-----f8abcafb5b17--------------------------------", "anchor_text": "Sagar Chadha", "paragraph_index": 1}, {"url": "https://medium.com/u/7dcece871f74?source=post_page-----f8abcafb5b17--------------------------------", "anchor_text": "Cuiting Zhong", "paragraph_index": 1}], "all_paragraphs": ["You have a burning question \u2014 you login to Quora, post your question and wait for responses. There is a chance that what you asked is truly unique but more often than not if you have a question, someone has had it too. Did you notice that Quora tells you that a similar question has been asked before and gives you links directing you to it? How does Quora detect that the question you just asked matches with the other questions already asked before?", "Intrigued by this question, my team \u2014 Jui Gupta, Sagar Chadha, Cuiting Zhong and I decided to work on the Kaggle Quora duplicate questions challenge. The goal was to use sophisticated techniques to understand question semantics and highlight duplicate (similar) questions.", "But why would a company want to highlight duplicate questions?", "The data set consisted of around 400,000 pairs of questions organized in the form of 6 columns as explained -", "qid 1, qid 2: The unique ID of each question in the pair", "Question 1, question 2: The actual textual contents of the questions.", "is_duplicate: Label is 0 for questions which are semantically different and 1 for questions which essentially would have only one answer (duplicate questions). 63% of the questions pairs are semantically non-similar and 37% are duplicate questions pairs.", "An analysis of the data showed the most common words in the questions were the following -", "Duplicate questions marked as not duplicate", "We also found some question pairs that, although duplicate, were marked as 0 in the labels. Some of these are shown below -", "The labels for these questions were changed to 1 to improve the accuracy of the model!", "A very simple approach to detecting similarity between a pair of questions would be to look at unique words in the first question that are also present in the second question as a ratio of the total words in both questions. This number could then be used in a simple model such as logistic regression to predict duplicate versus different questions.", "This approach has limitations since two questions with very few words in common can still have the same meaning. This could be due to different sentence structures, use of synonyms, etc. Consider the sentences \u201cWhat to do to be a data scientist\u201d and \u201cWhat qualities make a good data scientist\u201d. While these have very few common words (exclude stopwords), the intent of the asker is the same. In order to go beyond comparing words in a sentence, we need a way to understand the semantic meaning of the questions in consideration.", "Generating sentence embedding is a three step process -", "The process described above creates a data tensor from our text data of dimensions \u2014 (200000, 25, 300) for each of question 1 and question 2. This serves a dual purpose -", "The data tensor so created is then sent through a neural network model for training which we describe below.", "The embedding created using the methodology above is then to be passed through the network drawn above. Let\u2019s see what is happening in the network above -", "Time Distributed Dense Layers \u2014 These are used for temporal data when we want to apply the same transformation to every time-step. In our data set, each question has 25 words which correspond to 25 time steps. We use a dense layer with 300 hidden inputs \u2014 since our data has 300 dimensional embedding, we get 90,000 + 300 (bias) = 90,300 weights for the layer. Both question 1 and question 2 pass through similar time distributed layers.", "The below diagram makes clear the transformation \u2014", "Each of the 300 hidden units in the time distributed dense layer (shown in orange) connect with the word vectors at each time step (shown in blue) and produce higher order representations (shown in green). All the dense layer units have the \u2018Relu\u2019 activation for non-linearity.", "Lambda layers \u2014 Lambdas in Keras are like the \u2018def\u2019 keyword in python \u2014 they allow us to use custom layers in our model. We use the lambda layer on the higher order representations obtained after the time distributed dense layers to get an average sense of the meanings of all the words in the question.", "Computing the average, in essence, computes an aggregate representation of the question in 300 dimension. This encapsulates the meaning of the entire question in those dimensions. Average is just one of the possible aggregations, there are others possible aggregations such as max, sum, etc.", "The simple bag of embedding model architecture mentioned above did achieve a pretty good accuracy. Then why bother to use Bidirectional LSTM and attention layer?", "When we went back and manually checked the question pairs causing the highest mis-classifications, we found that it was mostly due to the longer sentences. This makes sense because we had not accounted for a way to capture and implement words in the previous and future state into our present state. This requires to implement an adaptive gating mechanism which is provided by networks like LSTMs. On researching we were lucky to find a paper on using Bidirectional LSTMs for relational classification, which was used in tasks like image captioning, question answering and so on.", "Now coming to the model, the changes we made involved adding a Bidirectional LSTM after the word embedding stage to incorporate higher level features into out embedding vectors. After this, unlike before where we were concatenating the questions, we implement attention by carrying out similarity between the pairs.", "Attention layer \u2014 Unlike the previous bag of words the attention layer involves calculation of a dot product between the questions followed by a dense layer without any non linearity.", "After finishing modeling, how did we evaluate our models?", "Since it was a binary classification task we used the binary cross entropy (log loss) to calculate our accuracy.", "The baseline accuracy is 63% because that\u2019s how our data was split. Here\u2019s the model performance for models we built.", "None of this work could have been done on our own. Check out the following references to get access to all the great resources we used:", "Feel free to let us know what you think and ways we can improve upon what we have! :)", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Sr. Data Scientist | Walmart Labs"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Ff8abcafb5b17&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fquestions-pairs-identification-f8abcafb5b17&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fquestions-pairs-identification-f8abcafb5b17&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fquestions-pairs-identification-f8abcafb5b17&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fquestions-pairs-identification-f8abcafb5b17&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----f8abcafb5b17--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----f8abcafb5b17--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@kirti.kp.94?source=post_page-----f8abcafb5b17--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@kirti.kp.94?source=post_page-----f8abcafb5b17--------------------------------", "anchor_text": "Kirti Pande"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F12116ee2bf36&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fquestions-pairs-identification-f8abcafb5b17&user=Kirti+Pande&userId=12116ee2bf36&source=post_page-12116ee2bf36----f8abcafb5b17---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ff8abcafb5b17&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fquestions-pairs-identification-f8abcafb5b17&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ff8abcafb5b17&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fquestions-pairs-identification-f8abcafb5b17&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://medium.com/u/14b152ad8569?source=post_page-----f8abcafb5b17--------------------------------", "anchor_text": "Jui Gupta"}, {"url": "https://medium.com/u/140754e8ee4d?source=post_page-----f8abcafb5b17--------------------------------", "anchor_text": "Sagar Chadha"}, {"url": "https://medium.com/u/7dcece871f74?source=post_page-----f8abcafb5b17--------------------------------", "anchor_text": "Cuiting Zhong"}, {"url": "https://www.aclweb.org/anthology/P/P16/P16-2034.pdf", "anchor_text": "https://www.aclweb.org/anthology/P/P16/P16-2034.pd"}, {"url": "https://nlp.stanford.edu/pubs/snli_paper.pdf", "anchor_text": "https://nlp.stanford.edu/pubs/snli_paper.pdf"}, {"url": "https://www.kaggle.com/c/quora-question-pairs/data", "anchor_text": "https://www.kaggle.com/c/quora-question-pairs/data"}, {"url": "https://github.com/bradleypallen/keras-quora-question-pairs", "anchor_text": "https://github.com/bradleypallen/keras-quora-question-pairs"}, {"url": "https://github.com/Smerity/keras_snli", "anchor_text": "https://github.com/Smerity/keras_snli"}, {"url": "https://towardsdatascience.com/building-a-question-answering-system-part-1-9388aadff507", "anchor_text": "https://towardsdatascience.com/building-a-question-answering-system-part-1-9388aadff507"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----f8abcafb5b17---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----f8abcafb5b17---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/quora?source=post_page-----f8abcafb5b17---------------quora-----------------", "anchor_text": "Quora"}, {"url": "https://medium.com/tag/questions?source=post_page-----f8abcafb5b17---------------questions-----------------", "anchor_text": "Questions"}, {"url": "https://medium.com/tag/attention?source=post_page-----f8abcafb5b17---------------attention-----------------", "anchor_text": "Attention"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Ff8abcafb5b17&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fquestions-pairs-identification-f8abcafb5b17&user=Kirti+Pande&userId=12116ee2bf36&source=-----f8abcafb5b17---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Ff8abcafb5b17&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fquestions-pairs-identification-f8abcafb5b17&user=Kirti+Pande&userId=12116ee2bf36&source=-----f8abcafb5b17---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ff8abcafb5b17&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fquestions-pairs-identification-f8abcafb5b17&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----f8abcafb5b17--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Ff8abcafb5b17&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fquestions-pairs-identification-f8abcafb5b17&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----f8abcafb5b17---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----f8abcafb5b17--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----f8abcafb5b17--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----f8abcafb5b17--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----f8abcafb5b17--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----f8abcafb5b17--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----f8abcafb5b17--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----f8abcafb5b17--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----f8abcafb5b17--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@kirti.kp.94?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@kirti.kp.94?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Kirti Pande"}, {"url": "https://medium.com/@kirti.kp.94/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "110 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F12116ee2bf36&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fquestions-pairs-identification-f8abcafb5b17&user=Kirti+Pande&userId=12116ee2bf36&source=post_page-12116ee2bf36--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fusers%2F12116ee2bf36%2Flazily-enable-writer-subscription&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fquestions-pairs-identification-f8abcafb5b17&user=Kirti+Pande&userId=12116ee2bf36&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}