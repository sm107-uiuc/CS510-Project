{"url": "https://towardsdatascience.com/cheat-sheet-to-implementing-7-methods-for-selecting-optimal-number-of-clusters-in-python-898241e1d6ad", "time": 1683015641.8676212, "path": "towardsdatascience.com/cheat-sheet-to-implementing-7-methods-for-selecting-optimal-number-of-clusters-in-python-898241e1d6ad/", "webpage": {"metadata": {"title": "Cheat sheet for implementing 7 methods for selecting the optimal number of clusters in Python | by Indraneel Dutta Baruah | Towards Data Science", "h1": "Cheat sheet for implementing 7 methods for selecting the optimal number of clusters in Python", "description": "Segmentation provides a data driven angle for examining meaningful segments that executives can use to take targeted actions and improve business outcomes. Many executives run the risk of making\u2026"}, "outgoing_paragraph_urls": [{"url": "https://archive.ics.uci.edu/ml/datasets/clickstream+data+for+online+shopping", "anchor_text": "data", "paragraph_index": 2}, {"url": "https://towardsdatascience.com/one-hot-encoding-standardization-pca-data-preparation-steps-for-segmentation-in-python-24d07671cf0b", "anchor_text": "One Hot Encoding, Standardization, PCA: Data preparation for segmentation in python", "paragraph_index": 4}, {"url": "http://www.stanford.edu/~hastie/Papers/gap.pdf", "anchor_text": "Tibshirani, Walther and Hastie in their 2001 paper", "paragraph_index": 5}, {"url": "https://www.mdpi.com/2571-8800/2/2/16/pdf", "anchor_text": "paper", "paragraph_index": 11}, {"url": "https://www.scikit-yb.org/en/latest/", "anchor_text": "YellowBrick", "paragraph_index": 12}, {"url": "https://www.researchgate.net/publication/323588077_The_silhouette_width_criterion_for_clustering_and_association_mining_to_select_image_features", "anchor_text": "paper", "paragraph_index": 17}, {"url": "https://iopscience.iop.org/article/10.1088/1757-899X/569/5/052024/pdf", "anchor_text": "paper", "paragraph_index": 22}, {"url": "https://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.102.4114&rep=rep1&type=pdf", "anchor_text": "here", "paragraph_index": 26}, {"url": "http://www.linkedin.com/in/indraneel-dutta-baruah-ds", "anchor_text": "LinkedIn", "paragraph_index": 36}, {"url": "https://github.com/IDB-FOR-DATASCIENCE", "anchor_text": "Github", "paragraph_index": 36}, {"url": "https://medium.com/@indraneeldb1993ds", "anchor_text": "Medium", "paragraph_index": 36}], "all_paragraphs": ["Segmentation provides a data driven angle for examining meaningful segments that executives can use to take targeted actions and improve business outcomes. Many executives run the risk of making decisions based on overgeneralizations because they utilize a one-size-fits-all approach to assess their business ecosystem. Segmentation, however, improves decision-making by providing multiple meaningful lenses to break apart data and take action.", "One of the most perplexing issues we face while trying to segment customers or products is choosing the ideal number of segments. This is a key parameter for multiple clustering algorithms like K means, agglomerative clustering and GMM clustering. Unless our data has just 2 or 3 dimensions, it is not possible to visually understand the clusters present in the data. And in most practical applications, we will have more than 3 dimensions. This blog will help the readers understand and quickly implement the most popular techniques for selecting optimal number of clusters:", "For this exercise, we will be working with clickstream data from an online store offering clothing for pregnant women. It has data from April 2008 to August 2008 and includes variables like product category, location of the photo on the webpage, country of origin of the IP address and product price in US dollars. Before selecting optimal number of clusters, we will need to prepare the data for segmentation.", "I encourage you to check out the article below for an in-depth explanation of different steps for preparing data for segmentation before proceeding further:", "One Hot Encoding, Standardization, PCA: Data preparation for segmentation in python", "The gap statistic was developed by Stanford researchers Tibshirani, Walther and Hastie in their 2001 paper. The idea behind their approach was to find a way to compare cluster compactness with a null reference distribution of the data, i.e. a distribution with no obvious clustering. Their estimate for the optimal number of clusters is the value for which cluster compactness on the original data falls the farthest below this reference curve. This information is contained in the following formula for the gap statistic:", "where Wk is measure of the compactness of our clustering based on the Within-Cluster-Sum of Squared Errors (WSS):", "Within-Cluster-Sum of Squared Errors is calculated by the inertia_ attribute of KMeans function as follows:", "Calculating gap statistic in python for k means clustering involves the following steps:", "As seen in Figure 1, the gap statistics is maximized with 29 clusters and hence, we can chose 29 clusters for our K means.", "It is the most popular method for determining the optimal number of clusters. The method is based on calculating the Within-Cluster-Sum of Squared Errors (WSS) for different number of clusters (k) and selecting the k for which change in WSS first starts to diminish.", "The idea behind the elbow method is that the explained variation changes rapidly for a small number of clusters and then it slows down leading to an elbow formation in the curve. The elbow point is the number of clusters we can use for our clustering algorithm. Further details on this method can be found in this paper by Chunhui Yuan and Haitao Yang.", "We will be using the YellowBrick library which can implement the elbow method with few lines of code. It is a wrapper around Scikit-Learn and has some cool machine learning visualizations!", "The KElbowVisualizer function fits the KMeans model for a range of clusters values between 2 to 30. As shown in Figure 2, the elbow point is achieved with 8 clusters which is highlighted by the function itself. The function also informs us about how much time was needed to plot models for various numbers of clusters through the green line.", "The Silhouette Coefficient for a point i is defined as follows:", "where b(i) is the smallest average distance of point i to all points in any other cluster and a(i) is the average distance of i from all other points in its cluster. For example, if we have only 3 clusters A,B and C and i belongs to cluster C, then b(i) is calculated by measuring the average distance of i from every point in cluster A, the average distance of i from every point in cluster B and taking the smallest resulting value. The Silhouette Coefficient for the dataset is the average of the Silhouette Coefficient of individual points.", "The Silhouette Coefficient tells us if individual points are correctly assigned to their clusters. We can use the following thumb rules while using Silhouette Coefficient:", "For more details on this method, please refer to this 2018 paper by N. Kaoungku, K. Suksut , R. Chanklan and K. Kerdprasop. We will be using the KElbowVisualizer function to implement Silhouette Coefficient for K means clustering algorithm:", "The optimal number of clusters based on Silhouette Score is 4.", "The Calinski-Harabasz Index is based on the idea that clusters that are (1) themselves very compact and (2) well-spaced from each other are good clusters. The index is calculated by dividing the variance of the sums of squares of the distances of individual objects to their cluster center by the sum of squares of the distance between the cluster centers. Higher the Calinski-Harabasz Index value, better the clustering model. The formula for Calinski-Harabasz Index is defined as:", "where k is the number of clusters, n is the number of records in data, BCSM (between cluster scatter matrix) calculates separation between clusters and WCSM (within cluster scatter matrix) calculates compactness within clusters.", "KElbowVisualizer function is able to calculate Calinski-Harabasz Index as well:", "As seen in Figure 4, the Calinski Harabasz Index is maximized when number of clusters is 2 for the K means clustering algorithm. To dig deeper on this index, kindly refer to this paper by Xu Wang and Yusheng Xu.", "The Davies-Bouldin (DB) Index is defined as:", "where n is the count of clusters and \u03c3i is the average distance of all points in cluster i from the cluster centre ci.", "Like silhouette coefficient and Calinski-Harabasz index, the DB index captures both the separation and compactness of the clusters.This is due to the fact that the measure\u2019s \u2018max\u2019 statement repeatedly selects the values where the average point is farthest away from its center, and where the centers are closest together. But unlike silhouette coefficient and Calinski-Harabasz index, as DB index falls, the clustering improves.", "As seen in Figure 5, the Davies Bouldin score is minimized with 4 clusters and can be considered for the k means algorithm. Further details on the DB score can be found here in a paper by Slobodan Petrovic.", "This technique is specific to the agglomerative hierarchical method of clustering. The agglomerative hierarchical method of clustering starts by considering each point as a separate cluster and starts joining points to clusters in a hierarchical fashion based on their distances. In a separate blog, we will focus on the details of this method. To get the optimal number of clusters for hierarchical clustering, we make use a dendrogram which is tree-like chart that shows the sequences of merges or splits of clusters.", "If two clusters are merged, the dendrogram will join them in a graph and the height of the join will be the distance between those clusters. We will plot the graph using the dendogram function from scipy library.", "As shown in Figure 6, we can chose the optimal number of clusters based on hierarchical structure of the dendrogram. As highlighted by other cluster validation metrics, 4 clusters can be considered for the agglomerative hierarchical as well.", "Bayesian information criterion (BIC) score is a method for scoring a model which is using the maximum likelihood estimation framework. The BIC statistic is calculated as follows:", "where L is the maximized value of the likelihood function of the model, k is the number of parameters and n is the number of records", "The lower the BIC score, better is the model. We can use the BIC score for the Gaussian Mixture Modelling approach for clustering. We will discuss details of this model in a separate blog but key thing to note here is that in the model we need to select number of clusters as well as type of covariance. We try out various combinations of the parameters and select the model with the lowest BIC score.", "In this post, we learnt about 7 different methods to select optimal number of clusters for various clustering algorithms.", "Finally, given the multiple metrics we have for selecting optimal number of clusters, we can take the average/median/mode across various metrics to be the optimal number of clusters.", "Do you have any questions or suggestions about this blog? Please feel free to drop in a note.", "If you, like me, are passionate about AI, Data Science, or Economics, please feel free to add/follow me on LinkedIn, Github and Medium.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Striving for excellence in solving business problems using AI!"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F898241e1d6ad&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcheat-sheet-to-implementing-7-methods-for-selecting-optimal-number-of-clusters-in-python-898241e1d6ad&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcheat-sheet-to-implementing-7-methods-for-selecting-optimal-number-of-clusters-in-python-898241e1d6ad&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcheat-sheet-to-implementing-7-methods-for-selecting-optimal-number-of-clusters-in-python-898241e1d6ad&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcheat-sheet-to-implementing-7-methods-for-selecting-optimal-number-of-clusters-in-python-898241e1d6ad&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----898241e1d6ad--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----898241e1d6ad--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://indraneeldb1993ds.medium.com/?source=post_page-----898241e1d6ad--------------------------------", "anchor_text": ""}, {"url": "https://indraneeldb1993ds.medium.com/?source=post_page-----898241e1d6ad--------------------------------", "anchor_text": "Indraneel Dutta Baruah"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F2dabdd5d632a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcheat-sheet-to-implementing-7-methods-for-selecting-optimal-number-of-clusters-in-python-898241e1d6ad&user=Indraneel+Dutta+Baruah&userId=2dabdd5d632a&source=post_page-2dabdd5d632a----898241e1d6ad---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F898241e1d6ad&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcheat-sheet-to-implementing-7-methods-for-selecting-optimal-number-of-clusters-in-python-898241e1d6ad&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F898241e1d6ad&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcheat-sheet-to-implementing-7-methods-for-selecting-optimal-number-of-clusters-in-python-898241e1d6ad&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@mehrshadr", "anchor_text": "Mehrshad Rajabi"}, {"url": "https://unsplash.com/?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://archive.ics.uci.edu/ml/datasets/clickstream+data+for+online+shopping", "anchor_text": "data"}, {"url": "https://towardsdatascience.com/one-hot-encoding-standardization-pca-data-preparation-steps-for-segmentation-in-python-24d07671cf0b", "anchor_text": "One Hot Encoding, Standardization, PCA: Data preparation for segmentation in python"}, {"url": "http://www.stanford.edu/~hastie/Papers/gap.pdf", "anchor_text": "Tibshirani, Walther and Hastie in their 2001 paper"}, {"url": "https://www.mdpi.com/2571-8800/2/2/16/pdf", "anchor_text": "paper"}, {"url": "https://www.scikit-yb.org/en/latest/", "anchor_text": "YellowBrick"}, {"url": "https://www.researchgate.net/publication/323588077_The_silhouette_width_criterion_for_clustering_and_association_mining_to_select_image_features", "anchor_text": "paper"}, {"url": "https://iopscience.iop.org/article/10.1088/1757-899X/569/5/052024/pdf", "anchor_text": "paper"}, {"url": "https://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.102.4114&rep=rep1&type=pdf", "anchor_text": "here"}, {"url": "http://www.linkedin.com/in/indraneel-dutta-baruah-ds", "anchor_text": "LinkedIn"}, {"url": "https://github.com/IDB-FOR-DATASCIENCE", "anchor_text": "Github"}, {"url": "https://medium.com/@indraneeldb1993ds", "anchor_text": "Medium"}, {"url": "https://medium.com/tag/clustering?source=post_page-----898241e1d6ad---------------clustering-----------------", "anchor_text": "Clustering"}, {"url": "https://medium.com/tag/segmentation?source=post_page-----898241e1d6ad---------------segmentation-----------------", "anchor_text": "Segmentation"}, {"url": "https://medium.com/tag/python?source=post_page-----898241e1d6ad---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/ai?source=post_page-----898241e1d6ad---------------ai-----------------", "anchor_text": "AI"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----898241e1d6ad---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F898241e1d6ad&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcheat-sheet-to-implementing-7-methods-for-selecting-optimal-number-of-clusters-in-python-898241e1d6ad&user=Indraneel+Dutta+Baruah&userId=2dabdd5d632a&source=-----898241e1d6ad---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F898241e1d6ad&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcheat-sheet-to-implementing-7-methods-for-selecting-optimal-number-of-clusters-in-python-898241e1d6ad&user=Indraneel+Dutta+Baruah&userId=2dabdd5d632a&source=-----898241e1d6ad---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F898241e1d6ad&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcheat-sheet-to-implementing-7-methods-for-selecting-optimal-number-of-clusters-in-python-898241e1d6ad&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----898241e1d6ad--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F898241e1d6ad&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcheat-sheet-to-implementing-7-methods-for-selecting-optimal-number-of-clusters-in-python-898241e1d6ad&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----898241e1d6ad---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----898241e1d6ad--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----898241e1d6ad--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----898241e1d6ad--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----898241e1d6ad--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----898241e1d6ad--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----898241e1d6ad--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----898241e1d6ad--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----898241e1d6ad--------------------------------", "anchor_text": ""}, {"url": "https://indraneeldb1993ds.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://indraneeldb1993ds.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Indraneel Dutta Baruah"}, {"url": "https://indraneeldb1993ds.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "204 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F2dabdd5d632a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcheat-sheet-to-implementing-7-methods-for-selecting-optimal-number-of-clusters-in-python-898241e1d6ad&user=Indraneel+Dutta+Baruah&userId=2dabdd5d632a&source=post_page-2dabdd5d632a--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F29e48c7d07d1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcheat-sheet-to-implementing-7-methods-for-selecting-optimal-number-of-clusters-in-python-898241e1d6ad&newsletterV3=2dabdd5d632a&newsletterV3Id=29e48c7d07d1&user=Indraneel+Dutta+Baruah&userId=2dabdd5d632a&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}