{"url": "https://towardsdatascience.com/fast-ai-deep-learnings-part-i-eye-in-the-sky-417e97c3e6bb", "time": 1682993600.538906, "path": "towardsdatascience.com/fast-ai-deep-learnings-part-i-eye-in-the-sky-417e97c3e6bb/", "webpage": {"metadata": {"title": "Eye in the Sky \u2014 Image Classification using Transfer Learning and Data Augmentation | by Murali M K | Towards Data Science", "h1": "Eye in the Sky \u2014 Image Classification using Transfer Learning and Data Augmentation", "description": "Becoming a fighter pilot was my childhood dream, and watching planes until they clear my sight is still an excitement. When I was thinking about a data set to start applying my learnings on Computer\u2026"}, "outgoing_paragraph_urls": [{"url": "http://course.fast.ai/", "anchor_text": "fast.ai", "paragraph_index": 0}, {"url": "http://course.fast.ai/", "anchor_text": "fast.ai", "paragraph_index": 1}, {"url": "https://twitter.com/jeremyphoward?ref_src=twsrc%5Egoogle%7Ctwcamp%5Eserp%7Ctwgr%5Eauthor", "anchor_text": "Jeremey Howard", "paragraph_index": 1}, {"url": "https://www.coursera.org/specializations/deep-learning", "anchor_text": "Deep Learning Specialization", "paragraph_index": 1}, {"url": "https://github.com/murali-munna/deep-learning-fastai", "anchor_text": "here on github", "paragraph_index": 2}, {"url": "https://github.com/hardikvasa/google-images-download", "anchor_text": "python package", "paragraph_index": 3}, {"url": "http://teleported.in/posts/decoding-resnet-architecture/", "anchor_text": "this excellent article", "paragraph_index": 5}, {"url": "http://arxiv.org/abs/1506.01186", "anchor_text": "Cyclical Learning Rates for Training Neural Networks", "paragraph_index": 10}], "all_paragraphs": ["Becoming a fighter pilot was my childhood dream, and watching planes until they clear my sight is still an excitement. When I was thinking about a data set to start applying my learnings on Computer Vision from fast.ai, that was my motivation to play with them.", "This is the first part of my series Fast.AI Deep Learnings. For those who don\u2019t know, fast.ai is an online course on Deep Learning taught by Jeremey Howard, former Kaggle President and #1 competitor. I felt his top-down approach as a perfect complementary after I finished Andrew NG\u2019s Deep Learning Specialization on Coursera.", "I am going to give an end-to-end implementation of planes vs. helicopters classification, and let\u2019s see how the CNN architecture differentiates wings vs. blades. The complete code for execution can be found here on github.", "I thought of not using any existing datasets, so I downloaded images from google myself. I have used Firefox\u2019s Google Image Downloader, which is a convenient extension tool to download images. I also found this python package useful to automate this process for multiple tags. With a total of 216 planes and 350 helicopters, let\u2019s look at the sample pictures in the dataset.", "Our dataset looks diverse enough (at least the airplanes) with pictures ranging from regular passenger flights, propellers, fighters, toy planes, combat helicopters, and gigantic house movers. Let\u2019s see how our NN tackles them.", "We will be using ResNet34 pre-trained model, which won the 2015 ImageNet competition. Since ImageNet contains a diversified clicked pictures, this architecture will be suited well for this problem. You can go through this excellent article to decode the ResNet architecture, and the underlying philosophy is to use a deeper network without experiencing degradation in convergence.", "\u201c You should not be using smaller networks because you are afraid of overfitting. Instead, you should use as big of a neural network as your computational budget allows, and use other regularization techniques to control overfitting \u201d \u2014 CS231n", "With 5 epochs, batch size of 8, and learning rate of 0.01, we are able to achieve an accuracy of around ~90%.", "Although there are planes that are difficult to identify (the one on fire and the \u2018Heathrow\u2019 one), the incorrectly classified helicopters seem to be not that different from the correct ones.", "The learning rate determines how quickly or how slowly you want to update the weights. Although for a small dataset (~500 images) like ours, it wouldn\u2019t matter much, but learning rate significantly affects model performance/convergence.", "We are going to use the technique developed in the paper, Cyclical Learning Rates for Training Neural Networks, where we simply keep increasing the learning rate from a minimal value, until the loss stops decreasing. We are going to use LR of 1e-2 based on the plots below.", "If we train the model for more epochs, it will start over-fitting (training loss becomes less, whereas validation loss doesn\u2019t). The model will start learning features specific to these data points rather than generalizing. To overcome this, we are going to create more data using Data Augmentation. For this problem, we will be using horizontal flipping and zooming (up to 1.1x). Make sure you do relevant augmentation \u2014 For letters/digits, any flipping doesn\u2019t make sense, whereas for satellite images, we can flip and rotate the images as we want.", "We can see that the accuracy has improved to 92.3% after passing this augmented data. Note that we are still using the pre-trained weights and only training the final FC layers.", "Learning rate Annealing: Though we found that 1e-2 as the ideal learning rate, we have actually started with that and gradually decreased it as the training progresses. This is because, as we get closer to optimal weights, we should be taking smaller steps.", "Stochastic Gradient Descent with Restarts: Using the above technique for one epoch cycle, we would restart the learning rate again from 10e-2 and continue the process. The idea behind this is to encourage our model to jump out of this optimal space and find (if any) a stable and accurate optimal space. Combining these two, the learning rate progresses like this \u2014", "Unfreezing pre-trained layers: Now, since we have trained enough our final layers, we will unfreeze the pre-trained ResNet layers and fine-tune them. Since these layers have already been trained on imageNet photos and the initial layers will have more general-purpose features, we would be using differential learning rate so as to tune them carefully. So, initial layers will use 1e-4, middles ones 1e-3 and our FC layers 1e-2 as before.", "We see that the accuracy didn\u2019t change much but improved to 93%. We still see that the validation loss is 0.21 whereas training loss is at 0.12, and I feel there\u2019s still room to improve the model, but we will stop here for now. I think that there are more variety of planes but not enough examples to learn those features (that\u2019s why I think we see a lot of planes being misclassified below).", "Test Time Augmentation: This is an excellent approach to use the power of augmentation while validating/testing. TTA makes predictions not just on the images in your validation set, but also makes predictions on several randomly augmented versions of them too. It then takes the average prediction from these images, and uses that. We achieved an accuracy of 94.4%, a pretty good jump considering this simple yet effective technique.", "Looking at the confusion matrix, there are 7 planes which are predicted as helicopters (these seem to be the incorrect ones after the initial model itself), and we did a good job at predicting helicopters. Maybe with more images of airplanes we might be reaching higher accuracy.", "Thank you so much for reading untill the end. We have used transfer learning, data augmentation, and differential learning rate annealing to classify planes vs. helicopters to a very decent accuracy of 94.4% with a small dataset (~500 images). Please clap and share if you like and also let me know in the comments if anything is unclear or can be improved upon.", "To know practical tips for beginner in Data Science, check out this post.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Science | Machine Learning | Search and Recommender Systems | Piano |Classical Music | Psychology | Cinema"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F417e97c3e6bb&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffast-ai-deep-learnings-part-i-eye-in-the-sky-417e97c3e6bb&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffast-ai-deep-learnings-part-i-eye-in-the-sky-417e97c3e6bb&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffast-ai-deep-learnings-part-i-eye-in-the-sky-417e97c3e6bb&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffast-ai-deep-learnings-part-i-eye-in-the-sky-417e97c3e6bb&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----417e97c3e6bb--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----417e97c3e6bb--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@murali_munna?source=post_page-----417e97c3e6bb--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@murali_munna?source=post_page-----417e97c3e6bb--------------------------------", "anchor_text": "Murali M K"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F9049a2aeeed7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffast-ai-deep-learnings-part-i-eye-in-the-sky-417e97c3e6bb&user=Murali+M+K&userId=9049a2aeeed7&source=post_page-9049a2aeeed7----417e97c3e6bb---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F417e97c3e6bb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffast-ai-deep-learnings-part-i-eye-in-the-sky-417e97c3e6bb&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F417e97c3e6bb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffast-ai-deep-learnings-part-i-eye-in-the-sky-417e97c3e6bb&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@dann?utm_source=medium&utm_medium=referral", "anchor_text": "Dan"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "http://course.fast.ai/", "anchor_text": "fast.ai"}, {"url": "http://course.fast.ai/", "anchor_text": "fast.ai"}, {"url": "https://twitter.com/jeremyphoward?ref_src=twsrc%5Egoogle%7Ctwcamp%5Eserp%7Ctwgr%5Eauthor", "anchor_text": "Jeremey Howard"}, {"url": "https://www.coursera.org/specializations/deep-learning", "anchor_text": "Deep Learning Specialization"}, {"url": "https://github.com/murali-munna/deep-learning-fastai", "anchor_text": "here on github"}, {"url": "https://github.com/hardikvasa/google-images-download", "anchor_text": "python package"}, {"url": "http://teleported.in/posts/decoding-resnet-architecture/", "anchor_text": "this excellent article"}, {"url": "http://arxiv.org/abs/1506.01186", "anchor_text": "Cyclical Learning Rates for Training Neural Networks"}, {"url": "https://github.com/murali-munna/deep-learning-fastai", "anchor_text": "https://github.com/murali-munna/deep-learning-fastai"}, {"url": "https://towardsdatascience.com/practical-tips-for-beginners-in-data-science-debunking-few-myths-30537117a4e4", "anchor_text": "Practical Tips for Beginners in Data Science. Debunking few Myths!When I started my journey and where I am right now, there has been a lot of learning through professional experience\u2026towardsdatascience.com"}, {"url": "https://www.linkedin.com/in/muralimohanakrishnadandu/", "anchor_text": "LinkedIn"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----417e97c3e6bb---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----417e97c3e6bb---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----417e97c3e6bb---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/data-science?source=post_page-----417e97c3e6bb---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/analytics?source=post_page-----417e97c3e6bb---------------analytics-----------------", "anchor_text": "Analytics"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F417e97c3e6bb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffast-ai-deep-learnings-part-i-eye-in-the-sky-417e97c3e6bb&user=Murali+M+K&userId=9049a2aeeed7&source=-----417e97c3e6bb---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F417e97c3e6bb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffast-ai-deep-learnings-part-i-eye-in-the-sky-417e97c3e6bb&user=Murali+M+K&userId=9049a2aeeed7&source=-----417e97c3e6bb---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F417e97c3e6bb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffast-ai-deep-learnings-part-i-eye-in-the-sky-417e97c3e6bb&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----417e97c3e6bb--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F417e97c3e6bb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffast-ai-deep-learnings-part-i-eye-in-the-sky-417e97c3e6bb&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----417e97c3e6bb---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----417e97c3e6bb--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----417e97c3e6bb--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----417e97c3e6bb--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----417e97c3e6bb--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----417e97c3e6bb--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----417e97c3e6bb--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----417e97c3e6bb--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----417e97c3e6bb--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@murali_munna?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@murali_munna?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Murali M K"}, {"url": "https://medium.com/@murali_munna/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "136 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F9049a2aeeed7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffast-ai-deep-learnings-part-i-eye-in-the-sky-417e97c3e6bb&user=Murali+M+K&userId=9049a2aeeed7&source=post_page-9049a2aeeed7--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fd2b275292fc7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffast-ai-deep-learnings-part-i-eye-in-the-sky-417e97c3e6bb&newsletterV3=9049a2aeeed7&newsletterV3Id=d2b275292fc7&user=Murali+M+K&userId=9049a2aeeed7&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}