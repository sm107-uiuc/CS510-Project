{"url": "https://towardsdatascience.com/graph-convolutional-nets-for-classifying-covid-19-incidence-on-states-3a8c20ebac2b", "time": 1683006031.131642, "path": "towardsdatascience.com/graph-convolutional-nets-for-classifying-covid-19-incidence-on-states-3a8c20ebac2b/", "webpage": {"metadata": {"title": "Graph convolutional nets for classifying COVID-19 incidence on states | by JOS\u00c9 MANUEL N\u00c1POLES DUARTE | Towards Data Science", "h1": "Graph convolutional nets for classifying COVID-19 incidence on states", "description": "Note from the editors: Towards Data Science is a Medium publication primarily based on the study of data science and machine learning. We are not health professionals or epidemiologists, and the\u2026"}, "outgoing_paragraph_urls": [{"url": "http://towardsdatascience.com/", "anchor_text": "Towards Data Science", "paragraph_index": 0}, {"url": "https://www.who.int/emergencies/diseases/novel-coronavirus-2019/situation-reports", "anchor_text": "here", "paragraph_index": 0}, {"url": "https://flourish.studio/", "anchor_text": "https://flourish.studio/", "paragraph_index": 18}, {"url": "https://github.com/napoles-uach/covid19mx/blob/master/dgl_map.ipynb", "anchor_text": "https://github.com/napoles-uach/covid19mx/blob/master/dgl_map.ipynb", "paragraph_index": 22}], "all_paragraphs": ["Note from the editors: Towards Data Science is a Medium publication primarily based on the study of data science and machine learning. We are not health professionals or epidemiologists, and the opinions of this article should not be interpreted as professional advice. To learn more about the coronavirus pandemic, you can click here.", "First, I want to say that it seems to me of enormous importance that online media gives the opportunity to present to the world the efforts being made by the scientific-technological communities in times as urgent as those we currently live in. It is necessary to disseminate the information that is being generated to a speed that could compete with the speed of spread of the pandemic caused by the SARS COV2 virus causing the disease known as COVID-19. The virus has become a personal enemy of scientists and in many cases it is an unknown enemy for which you have to invent a way to combat it since we don\u2019t really know how (if you are not an epidemiologist or something related). Of course, the best tool is to maintain physical distance and hygiene measures that have been said and repeated so much. But as scientists we have tools that can be used in one way or another in the fight against the epidemic and we must try to make our contributions however small they may be. That is what I believe and that is why I present this small work that is more an invitation to review the usefulness of the so-called Graph Convolutional Neural Networks (GCNN\u2019s) in the study of the behavior of the COVID-19. But I must clarify that the results that I present should not be taken as predictions, since it is a very preliminary scheme and surely other factors than those used here will have to be taken into account. That said, let\u2019s get to work !!", "A relatively simple way to enter the world of GCNN\u2019s is using the DGL library, which apart from having different implementations, also has good documentation ( I encourage you to review the tutorial for the problem of \u201cZachary\u2019s karate club\u201d [1] that I refer to for our case.), so I will build on this library in what follows. I am very engaged with Google Colaboratory or \u201cColab\u201d as it allows to rapidly test prototype projects in Python which are extremely portable, so the code I present works for a Colab Notebook (See at the end of this post for a link to the Notebook).", "First we need to install dgl with pip, and we will use pandas, and numpy also, so we proceed to import them,", "Optionally we can also install chart_studio and call Plotly to make interactive charts as I showed in the previous post [2].", "A graph is made up of a set of nodes and their edges that define connectivity. If it were a molecule for example, the nodes would be the atoms that compose it while the bonds between them would be the edges [3]. However, if we want to transfer this idea to a geographic map, we must decide what are nodes and what are edges. One way is to take the nodes as the states of a country, but the edges can be several things. Here, I have decided to define the edges as the common borders between two given states. To do this, I have taken the map of the Mexican Republic with 31 states + Mexico City and I have listed the connections between each of them. The following figure shows the map of Mexico with the numbering taken in this work:", "At this point, I wish there was an adjacency matrix associated with each country, which would make the process I just described easier. Anyway, the connections that I determined, ultimately form that adjacency matrix encoded as the source points (src) and the destination points (dst). This can be delivered to DGL by giving the source and destination points ensuring that the information is bidirectional. This is accomplished with the following function:", "The graph G with this definition consists of 32 nodes and 264 edges and we can visualize it using networkx:", "The resulting graph can be identified visually, and (with a little imagination) with the map of Mexico, noticing that nodes 1 and 2 form the Baja California peninsula, while nodes 30, 22 and 3 form the Yucatan peninsula. So for now it seems everything is going well.", "To use GCNN we have to featurize the nodes. For that, I am going to use a one-hot encoding scheme.", "The one-hot vector is multiplied by the population density taken from [4], the following figure shows the population density for each of the states for 2015.", "In order to make a semi-supervised approach, I take two nodes (states) for each of three levels (Low, Medium, High) following the official information in [5] . This information is stored in two tensors, labeled_nodes to identify the states, and labels to indicate the three levels of incidence (defined according to the situation today, April 17, 2020), being \u201c0\u201d for states with a low level, \u201c1\u201d for those with a medium level and \u201c2\u201d for those with a high level:", "Here is the correspondence between the names of the states, their number and the associated level:", "These nodes are the ones that the GCNN learns about and will try to predict the levels that correspond to the rest of the unlabeled nodes.", "According to Kipf [6] a multi-layer GCNN learns from a graph \ud835\udca2=(\ud835\udcb1,\u2130) taking as input 1) an input N\u00d7 D feature matrix X, where N is the number of nodes and D is the number of features per node; and 2) a matrix representation of the graph structure like the Adjacency matrix A. The general form of a GCNN has the following propagation rule for a given neural network layer:", "where f is a non-linear function, H\u2070=X, and after a number of l=L layers, we get an output Z feature matrix of N\u00d7F dimension, where F is the number of features per node. More details on GCNN can be found at greater length in [3,6]. In our case, it is enough to keep in mind that we want to input a feature vector of N = 32 and to obtain three categories: Low, Medium, and High, thus F=3. Below is the code for the GCNN structure:", "The last piece of code is the training loop, where we use Adam optimizer as implemented in Pytorch with learning rate of 0.01. The GCNN is trained with the input labels for the six labeled nodes, and at each iteration log_softmax and loss functions are applied as well as back propagation just like in any neural network:", "We can make a DataFrame with the all_logits array for the last epoch. Then for each node we get the index of the maximum of the three labels. That will indicate the prediction for each node.", "I have found that Flourish (https://flourish.studio/) allows to graph maps in a very simple way and with very good results, so this time I have chosen to use this tool. The states with blue represent those with low level (0), the red ones for medium level (1) and yellow for high level (2):", "What\u2019s Next?1) Identify more representative descriptors for the spread of COVID-19. For instance, it could be interesting to use the incidence rate per 100,000 inhabitants that is an indicator of how effectively the disease spreads or it could also be the mobility in transport stations in the municipalities of each state.2) Define the graph not for the borders between states, but for the roads that connect the cities and give some weight to the influx.3) Review the predictions for other countries where the maximum contagion point has already been passed, such as China or Italy.", "Conclusion: Taking as a link the borders between the states, it is assumed that there is a communication between the nodes, which may represent the fact that the flow of people between different states is not being canceled. Clearly by stopping the migration of people, the links are broken and that would have to modify the prediction of a neural network like the one presented here. Probably the result would be a minor effect due to a state with high rates on its neighbors.", "Acknowledgement: I want to thank PhD. Jaime Ra\u00fal Adame Gallegos from the Autonomous University of Chihuahua for his kind review and suggestions in the writing of this document.", "The code shown above can be opened using Google Colaboratory in this link: https://github.com/napoles-uach/covid19mx/blob/master/dgl_map.ipynb", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Physics/ML Lecturer at FCQ-UACH. Member of the Streamlit Creators program."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F3a8c20ebac2b&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgraph-convolutional-nets-for-classifying-covid-19-incidence-on-states-3a8c20ebac2b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgraph-convolutional-nets-for-classifying-covid-19-incidence-on-states-3a8c20ebac2b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgraph-convolutional-nets-for-classifying-covid-19-incidence-on-states-3a8c20ebac2b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgraph-convolutional-nets-for-classifying-covid-19-incidence-on-states-3a8c20ebac2b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----3a8c20ebac2b--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----3a8c20ebac2b--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://jnapoles.medium.com/?source=post_page-----3a8c20ebac2b--------------------------------", "anchor_text": ""}, {"url": "https://jnapoles.medium.com/?source=post_page-----3a8c20ebac2b--------------------------------", "anchor_text": "JOS\u00c9 MANUEL N\u00c1POLES DUARTE"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fc5da38f6292e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgraph-convolutional-nets-for-classifying-covid-19-incidence-on-states-3a8c20ebac2b&user=JOS%C3%89+MANUEL+N%C3%81POLES+DUARTE&userId=c5da38f6292e&source=post_page-c5da38f6292e----3a8c20ebac2b---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F3a8c20ebac2b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgraph-convolutional-nets-for-classifying-covid-19-incidence-on-states-3a8c20ebac2b&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F3a8c20ebac2b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgraph-convolutional-nets-for-classifying-covid-19-incidence-on-states-3a8c20ebac2b&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "http://towardsdatascience.com/", "anchor_text": "Towards Data Science"}, {"url": "https://www.who.int/emergencies/diseases/novel-coronavirus-2019/situation-reports", "anchor_text": "here"}, {"url": "https://flourish.studio/", "anchor_text": "https://flourish.studio/"}, {"url": "https://github.com/napoles-uach/covid19mx/blob/master/dgl_map.ipynb", "anchor_text": "https://github.com/napoles-uach/covid19mx/blob/master/dgl_map.ipynb"}, {"url": "https://docs.dgl.ai/en/0.4.x/tutorials/basics/1_first.html", "anchor_text": "https://docs.dgl.ai/en/0.4.x/tutorials/basics/1_first.html"}, {"url": "https://medium.com/@jnapoles/tracking-covid19-with-pandas-and-plotly-open-source-graphing-library-maps-d24baf31aac4", "anchor_text": "https://medium.com/@jnapoles/tracking-covid19-with-pandas-and-plotly-open-source-graphing-library-maps-d24baf31aac4"}, {"url": "https://towardsdatascience.com/practical-graph-neural-networks-for-molecular-machine-learning-5e6dee7dc003", "anchor_text": "https://towardsdatascience.com/practical-graph-neural-networks-for-molecular-machine-learning-5e6dee7dc003"}, {"url": "https://www.inegi.org.mx/app/tabulados/interactivos/?px=Poblacion_07&bd=Poblacion", "anchor_text": "https://www.inegi.org.mx/app/tabulados/interactivos/?px=Poblacion_07&bd=Poblacion"}, {"url": "https://covid19.sinave.gob.mx/", "anchor_text": "https://covid19.sinave.gob.mx/"}, {"url": "http://tkipf.github.io/graph-convolutional-networks/", "anchor_text": "http://tkipf.github.io/graph-convolutional-networks/"}, {"url": "https://medium.com/tag/covid-19?source=post_page-----3a8c20ebac2b---------------covid_19-----------------", "anchor_text": "Covid-19"}, {"url": "https://medium.com/tag/graph?source=post_page-----3a8c20ebac2b---------------graph-----------------", "anchor_text": "Graph"}, {"url": "https://medium.com/tag/convolutional-network?source=post_page-----3a8c20ebac2b---------------convolutional_network-----------------", "anchor_text": "Convolutional Network"}, {"url": "https://medium.com/tag/gcnn?source=post_page-----3a8c20ebac2b---------------gcnn-----------------", "anchor_text": "Gcnn"}, {"url": "https://medium.com/tag/geography?source=post_page-----3a8c20ebac2b---------------geography-----------------", "anchor_text": "Geography"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F3a8c20ebac2b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgraph-convolutional-nets-for-classifying-covid-19-incidence-on-states-3a8c20ebac2b&user=JOS%C3%89+MANUEL+N%C3%81POLES+DUARTE&userId=c5da38f6292e&source=-----3a8c20ebac2b---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F3a8c20ebac2b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgraph-convolutional-nets-for-classifying-covid-19-incidence-on-states-3a8c20ebac2b&user=JOS%C3%89+MANUEL+N%C3%81POLES+DUARTE&userId=c5da38f6292e&source=-----3a8c20ebac2b---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F3a8c20ebac2b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgraph-convolutional-nets-for-classifying-covid-19-incidence-on-states-3a8c20ebac2b&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----3a8c20ebac2b--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F3a8c20ebac2b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgraph-convolutional-nets-for-classifying-covid-19-incidence-on-states-3a8c20ebac2b&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----3a8c20ebac2b---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----3a8c20ebac2b--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----3a8c20ebac2b--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----3a8c20ebac2b--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----3a8c20ebac2b--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----3a8c20ebac2b--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----3a8c20ebac2b--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----3a8c20ebac2b--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----3a8c20ebac2b--------------------------------", "anchor_text": ""}, {"url": "https://jnapoles.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://jnapoles.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "JOS\u00c9 MANUEL N\u00c1POLES DUARTE"}, {"url": "https://jnapoles.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "289 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fc5da38f6292e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgraph-convolutional-nets-for-classifying-covid-19-incidence-on-states-3a8c20ebac2b&user=JOS%C3%89+MANUEL+N%C3%81POLES+DUARTE&userId=c5da38f6292e&source=post_page-c5da38f6292e--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F6699105d7d26&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgraph-convolutional-nets-for-classifying-covid-19-incidence-on-states-3a8c20ebac2b&newsletterV3=c5da38f6292e&newsletterV3Id=6699105d7d26&user=JOS%C3%89+MANUEL+N%C3%81POLES+DUARTE&userId=c5da38f6292e&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}