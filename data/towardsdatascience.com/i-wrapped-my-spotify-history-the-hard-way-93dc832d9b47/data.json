{"url": "https://towardsdatascience.com/i-wrapped-my-spotify-history-the-hard-way-93dc832d9b47", "time": 1683001849.399363, "path": "towardsdatascience.com/i-wrapped-my-spotify-history-the-hard-way-93dc832d9b47/", "webpage": {"metadata": {"title": "I wrapped my Spotify history the hard way. | by Tim Burks | Towards Data Science", "h1": "I wrapped my Spotify history the hard way.", "description": "By now, Spotify users everywhere have gotten their 2019 Wrapped results. I wasn\u2019t too surprised by mine, partly because I knew I\u2019d spent a lot of time exercising to music by a soon-to-be-returning\u2026"}, "outgoing_paragraph_urls": [{"url": "https:/spotify.com/wrapped/", "anchor_text": "2019 Wrapped", "paragraph_index": 0}, {"url": "https://www.forbes.com/sites/stevebaltin/2019/11/01/confirmed-rage-against-the-machine-to-reunite-in-2020-headline-coachella/#5d56860812b1", "anchor_text": "soon-to-be-returning band from the 90s", "paragraph_index": 0}, {"url": "https://www.makeuseof.com/tag/download-privacy-data-spotify/", "anchor_text": "privacy data download", "paragraph_index": 0}, {"url": "https://www.spotify.com/ca-en/account/privacy/", "anchor_text": "https://www.spotify.com/ca-en/account/privacy/", "paragraph_index": 1}, {"url": "https://ico.org.uk/for-organisations/guide-to-data-protection/guide-to-the-general-data-protection-regulation-gdpr/individual-rights/right-of-access/", "anchor_text": "as the GDPR requires", "paragraph_index": 2}, {"url": "https://www.spotify.com/us/privacy/", "anchor_text": "Privacy Center", "paragraph_index": 3}, {"url": "https://www.rush.com/band/", "anchor_text": "Rush", "paragraph_index": 3}, {"url": "https://open.spotify.com/track/0Z0s6dw0zw2ENU1gVjlLV6?si=UzTRYEAHRyCl_wmpkG-HlQ", "anchor_text": "Subdivisions", "paragraph_index": 5}, {"url": "https://open.spotify.com/artist/2Hkut4rAAyrQxRdof7FVJq?si=67GmcS_USUW7k-j8hWjwNQ", "anchor_text": "Rush", "paragraph_index": 5}, {"url": "https://www.postgresql.org/download/linux/ubuntu/", "anchor_text": "here", "paragraph_index": 8}, {"url": "https://github.com/gnormal/gnorm", "anchor_text": "gnorm", "paragraph_index": 10}, {"url": "https://github.com/gnormal/postgres-go", "anchor_text": "postgres-go", "paragraph_index": 10}, {"url": "https://github.com/gnormal/postgres-go", "anchor_text": "postgres-go", "paragraph_index": 10}, {"url": "https://github.com/gnormal/gnorm", "anchor_text": "gnorm", "paragraph_index": 10}, {"url": "https://github.com/gnormal/postgres-go/blob/master/README.md", "anchor_text": "README", "paragraph_index": 10}, {"url": "https://gist.github.com/timburks/5a13e4cceb421220b96bd417b1d305bf", "anchor_text": "Here\u2019s a gist", "paragraph_index": 13}, {"url": "https://hasura.io/", "anchor_text": "Hasura", "paragraph_index": 18}, {"url": "https://docs.hasura.io/1.0/graphql/manual/deployment/docker/index.html", "anchor_text": "a little reading", "paragraph_index": 18}, {"url": "https://open.spotify.com/artist/36E7oYfz3LLRto6l2WmDcD?si=2DyZcn8eSN2CUuzUyXHYvw", "anchor_text": "Pulp", "paragraph_index": 20}, {"url": "https://open.spotify.com/track/2fXKyAyPrEa24c6PJyqznF?si=pJa3ZqCGT3eZrw_mZEeVLQ", "anchor_text": "Common People", "paragraph_index": 20}, {"url": "https://pusher.com/tutorials/spotify-history-react-node", "anchor_text": "View Your Live Spotify History with React and Node", "paragraph_index": 21}, {"url": "https://developer.spotify.com/documentation/web-api/", "anchor_text": "Spotify Web API", "paragraph_index": 21}, {"url": "https://developer.spotify.com/documentation/web-api/reference/player/get-recently-played/", "anchor_text": "Get a Current User\u2019s Recently Played Tracks", "paragraph_index": 21}, {"url": "https://developer.spotify.com/documentation/web-api/reference/personalization/get-users-top-artists-and-tracks/", "anchor_text": "Get a User\u2019s Top Artists and Tracks", "paragraph_index": 21}, {"url": "https://developer.spotify.com/documentation/web-api/reference/player/get-information-about-the-users-current-playback/", "anchor_text": "Get Information About The User\u2019s Current Playback", "paragraph_index": 21}, {"url": "https://developer.spotify.com/documentation/web-api/reference/player/start-a-users-playback/", "anchor_text": "Start/Resume a User\u2019s Playback", "paragraph_index": 21}, {"url": "https://en.wikipedia.org/wiki/Turntable.fm", "anchor_text": "shared jukebox", "paragraph_index": 21}], "all_paragraphs": ["By now, Spotify users everywhere have gotten their 2019 Wrapped results. I wasn\u2019t too surprised by mine, partly because I knew I\u2019d spent a lot of time exercising to music by a soon-to-be-returning band from the 90s, but also because I\u2019d recently used Spotify\u2019s privacy data download to take a direct look at my history for the last year, which Spotify keeps in exhaustive detail.", "It begins with a request at https://www.spotify.com/ca-en/account/privacy/, where (down near the bottom), Spotify users can request a download that includes \u201ca copy of your playlists, searches, streaming history for the past year, a list of items saved in your library, the number of followers you have, the number and names of the other users and artists you follow, and your payment and subscription data.\u201d", "That seems like a lot! The website says that it can take up to 30 days (as the GDPR requires), but in my experience (two requests), it took three or four days to get an email containing a link. The link points to a zip file that\u2019s available for two weeks. Unzipping the archive, I found these files:", "Details on how Spotify uses this are in Spotify\u2019s Privacy Center, but the file names are mostly self-explanatory. You\u2019ll see that credit card details are blocked-out and that we don\u2019t get identities of any accounts we follow or that follow us, but if you want to know your listening history, it\u2019s all here! Looking into the files named StreamingHistory[0-2].json, I found that each had up to 10,000 records per file, and each record described one streaming play, including both its time and duration. For example, on November 22, 2018, I was nostalgically listening to Rush:", "Partial plays are included, and streams could be as short as 0ms, which I guess corresponds to quick skips through playlists.", "You might be surprised (as I was) to find that this excludes the Spotify URIs for artists and tracks. For example, the Spotify URI for Subdivisions is spotify:track:0Z0s6dw0zw2ENU1gVjlLV6 and the URI for Rush is spotify:artist:2Hkut4rAAyrQxRdof7FVJq. But that probably just means that this data is more meant for human consumption than for machines.", "I decided to analyze my streaming history with Go, and started by writing some code to read the contents of one of my streaming history files:", "I could have done the rest of this directly in Go, but since I was also wanting to brush up on PostgreSQL, I decided to load these records into a local database to analyze them with SQL.", "Since I had already installed PostgreSQL on my desktop Ubuntu machine (instructions here), my first step was to come up with a schema for the data. I decided to normalize it, separating artists, tracks, and streaming plays into separate tables.", "I put this in a file and loaded it directly into PostgreSQL from the command line (after first creating the playtime database withcreatedb playtime):", "Next I needed a way to load the data into PostgreSQL from Go. While looking through various options, I discovered gnorm and postgres-go, which generates Go support code directly from a database schema. The postgres-go repo contains templates that gnorm uses, and makes a few assumptions that sent me back to revise my database schema. From the README:", "There are a few things these templates assume \u2014 if a column has a primary key that has a default, we\u2019ll ignore the primary key on insert and let the database generate the key (e.g. a uuid or auto-incrementing integer). This avoids the problem where Go code\u2019s zero value is a valid value, so you forget to set an ID and it gets inserted with ID == 0 (which is usually wrong).", "Other assumptions \u2014 columns called updated_at and created_at are assumed to be generated by the database, and thus are never inserted or updated manually and are returned (along with ids) on insert using Postgres\u2019 RETURNING statement.", "With this loaded into my database, I was able to generate support code with gnorm gen and expand my Go program to loop through my play history and create entries for the artists, tracks, and plays that were listed. Here\u2019s a gist with my final main.go.", "With my history loaded into PostgreSQL, generating my \u201cwrapped\u201d lists just required running the right SQL command. Here\u2019s one that returns my top ten tracks with total time played:", "Running it with psql -U postgres -d playtime -a -f toptracks.sql produced the following table:", "(As mentioned earlier, I did a lot of running with RATM this year!) Here\u2019s a query that returned my top ten artists:", "I haven\u2019t explored further, but can imagine ranking my top tracks by month, by day of the week, or by time of day (\u201ctop workout tracks\u201d, \u201ctop morning music\u201d, etc).", "Announced in 2018, Hasura creates a GraphQL interface for PostgreSQL databases. With a little reading, I found that I could run Hasura in a Docker container and attach it to my local database:", "This gave me a local console that I could use to explore my database, and with a few clicks I was able to accept Hakura\u2019s defaults and turn my key relationships into a rich GraphQL schema. Here\u2019s a GraphQL query of tracks with their artists:", "And here\u2019s a query that shows each time I streamed Pulp\u2019s Common People:", "With Spotify APIs, much more information is available in real time. Here\u2019s a nice tutorial that describes how to View Your Live Spotify History with React and Node. It uses the Spotify Web API to Get a Current User\u2019s Recently Played Tracks. Other API functions include one to Get a User\u2019s Top Artists and Tracks and methods that Get Information About The User\u2019s Current Playback and Start/Resume a User\u2019s Playback. Anyone want to build a shared jukebox?", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Software developer in the SF Bay area. Electronic Design Automation, iOS apps, and now API tools for the world\u2019s largest computer."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F93dc832d9b47&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fi-wrapped-my-spotify-history-the-hard-way-93dc832d9b47&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fi-wrapped-my-spotify-history-the-hard-way-93dc832d9b47&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fi-wrapped-my-spotify-history-the-hard-way-93dc832d9b47&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fi-wrapped-my-spotify-history-the-hard-way-93dc832d9b47&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----93dc832d9b47--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----93dc832d9b47--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://timburks.medium.com/?source=post_page-----93dc832d9b47--------------------------------", "anchor_text": ""}, {"url": "https://timburks.medium.com/?source=post_page-----93dc832d9b47--------------------------------", "anchor_text": "Tim Burks"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F2a6645c2a1ab&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fi-wrapped-my-spotify-history-the-hard-way-93dc832d9b47&user=Tim+Burks&userId=2a6645c2a1ab&source=post_page-2a6645c2a1ab----93dc832d9b47---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F93dc832d9b47&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fi-wrapped-my-spotify-history-the-hard-way-93dc832d9b47&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F93dc832d9b47&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fi-wrapped-my-spotify-history-the-hard-way-93dc832d9b47&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https:/spotify.com/wrapped/", "anchor_text": "2019 Wrapped"}, {"url": "https://www.forbes.com/sites/stevebaltin/2019/11/01/confirmed-rage-against-the-machine-to-reunite-in-2020-headline-coachella/#5d56860812b1", "anchor_text": "soon-to-be-returning band from the 90s"}, {"url": "https://www.makeuseof.com/tag/download-privacy-data-spotify/", "anchor_text": "privacy data download"}, {"url": "https://www.spotify.com/ca-en/account/privacy/", "anchor_text": "https://www.spotify.com/ca-en/account/privacy/"}, {"url": "https://ico.org.uk/for-organisations/guide-to-data-protection/guide-to-the-general-data-protection-regulation-gdpr/individual-rights/right-of-access/", "anchor_text": "as the GDPR requires"}, {"url": "https://www.spotify.com/us/privacy/", "anchor_text": "Privacy Center"}, {"url": "https://www.rush.com/band/", "anchor_text": "Rush"}, {"url": "https://open.spotify.com/track/0Z0s6dw0zw2ENU1gVjlLV6?si=UzTRYEAHRyCl_wmpkG-HlQ", "anchor_text": "Subdivisions"}, {"url": "https://open.spotify.com/artist/2Hkut4rAAyrQxRdof7FVJq?si=67GmcS_USUW7k-j8hWjwNQ", "anchor_text": "Rush"}, {"url": "https://www.postgresql.org/download/linux/ubuntu/", "anchor_text": "here"}, {"url": "https://github.com/gnormal/gnorm", "anchor_text": "gnorm"}, {"url": "https://github.com/gnormal/postgres-go", "anchor_text": "postgres-go"}, {"url": "https://github.com/gnormal/postgres-go", "anchor_text": "postgres-go"}, {"url": "https://github.com/gnormal/gnorm", "anchor_text": "gnorm"}, {"url": "https://github.com/gnormal/postgres-go/blob/master/README.md", "anchor_text": "README"}, {"url": "https://gist.github.com/timburks/5a13e4cceb421220b96bd417b1d305bf", "anchor_text": "Here\u2019s a gist"}, {"url": "https://hasura.io/", "anchor_text": "Hasura"}, {"url": "https://docs.hasura.io/1.0/graphql/manual/deployment/docker/index.html", "anchor_text": "a little reading"}, {"url": "https://open.spotify.com/artist/36E7oYfz3LLRto6l2WmDcD?si=2DyZcn8eSN2CUuzUyXHYvw", "anchor_text": "Pulp"}, {"url": "https://open.spotify.com/track/2fXKyAyPrEa24c6PJyqznF?si=pJa3ZqCGT3eZrw_mZEeVLQ", "anchor_text": "Common People"}, {"url": "https://pusher.com/tutorials/spotify-history-react-node", "anchor_text": "View Your Live Spotify History with React and Node"}, {"url": "https://developer.spotify.com/documentation/web-api/", "anchor_text": "Spotify Web API"}, {"url": "https://developer.spotify.com/documentation/web-api/reference/player/get-recently-played/", "anchor_text": "Get a Current User\u2019s Recently Played Tracks"}, {"url": "https://developer.spotify.com/documentation/web-api/reference/personalization/get-users-top-artists-and-tracks/", "anchor_text": "Get a User\u2019s Top Artists and Tracks"}, {"url": "https://developer.spotify.com/documentation/web-api/reference/player/get-information-about-the-users-current-playback/", "anchor_text": "Get Information About The User\u2019s Current Playback"}, {"url": "https://developer.spotify.com/documentation/web-api/reference/player/start-a-users-playback/", "anchor_text": "Start/Resume a User\u2019s Playback"}, {"url": "https://en.wikipedia.org/wiki/Turntable.fm", "anchor_text": "shared jukebox"}, {"url": "https://medium.com/tag/golang?source=post_page-----93dc832d9b47---------------golang-----------------", "anchor_text": "Golang"}, {"url": "https://medium.com/tag/spotify?source=post_page-----93dc832d9b47---------------spotify-----------------", "anchor_text": "Spotify"}, {"url": "https://medium.com/tag/postgresql?source=post_page-----93dc832d9b47---------------postgresql-----------------", "anchor_text": "Postgresql"}, {"url": "https://medium.com/tag/data-science?source=post_page-----93dc832d9b47---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/music?source=post_page-----93dc832d9b47---------------music-----------------", "anchor_text": "Music"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F93dc832d9b47&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fi-wrapped-my-spotify-history-the-hard-way-93dc832d9b47&user=Tim+Burks&userId=2a6645c2a1ab&source=-----93dc832d9b47---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F93dc832d9b47&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fi-wrapped-my-spotify-history-the-hard-way-93dc832d9b47&user=Tim+Burks&userId=2a6645c2a1ab&source=-----93dc832d9b47---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F93dc832d9b47&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fi-wrapped-my-spotify-history-the-hard-way-93dc832d9b47&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----93dc832d9b47--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F93dc832d9b47&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fi-wrapped-my-spotify-history-the-hard-way-93dc832d9b47&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----93dc832d9b47---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----93dc832d9b47--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----93dc832d9b47--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----93dc832d9b47--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----93dc832d9b47--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----93dc832d9b47--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----93dc832d9b47--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----93dc832d9b47--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----93dc832d9b47--------------------------------", "anchor_text": ""}, {"url": "https://timburks.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://timburks.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Tim Burks"}, {"url": "https://timburks.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "1.6K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F2a6645c2a1ab&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fi-wrapped-my-spotify-history-the-hard-way-93dc832d9b47&user=Tim+Burks&userId=2a6645c2a1ab&source=post_page-2a6645c2a1ab--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F8f606b80cf18&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fi-wrapped-my-spotify-history-the-hard-way-93dc832d9b47&newsletterV3=2a6645c2a1ab&newsletterV3Id=8f606b80cf18&user=Tim+Burks&userId=2a6645c2a1ab&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}