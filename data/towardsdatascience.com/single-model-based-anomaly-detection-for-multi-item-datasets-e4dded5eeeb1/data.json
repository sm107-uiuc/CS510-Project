{"url": "https://towardsdatascience.com/single-model-based-anomaly-detection-for-multi-item-datasets-e4dded5eeeb1", "time": 1683017530.063589, "path": "towardsdatascience.com/single-model-based-anomaly-detection-for-multi-item-datasets-e4dded5eeeb1/", "webpage": {"metadata": {"title": "Single Model-Based Anomaly Detection for Multi-Item Datasets | by Halil Ertan | Towards Data Science", "h1": "Single Model-Based Anomaly Detection for Multi-Item Datasets", "description": "Detecting anomalies on time series has a comprehensive usage field in many different domains. Most corresponding studies are carried out on datasets including only one item. To be more clear, with\u2026"}, "outgoing_paragraph_urls": [{"url": "https://en.wikipedia.org/wiki/Roaming", "anchor_text": "Roaming", "paragraph_index": 5}, {"url": "https://en.wikipedia.org/wiki/Standard_score", "anchor_text": "z-scores", "paragraph_index": 13}], "all_paragraphs": ["Detecting anomalies on time series has a comprehensive usage field in many different domains. Most corresponding studies are carried out on datasets including only one item. To be more clear, with \u201citem\u201d term, I refer to an exact device in anomaly detection in traffic values of a device in telco domain, or anomaly detection in energy consumption of a device in the energy domain. Similarly, it might suit to an exact brand for anomaly detection in sales amount in the retail domain. These examples can be extended for other domains as well.", "What about anomaly detection in datasets including multi items which is very common in real-life scenarios? Think about a dataset consists of thousands of different device and traffic values flowing through them. Each of them has its own pattern and behaviour, which means that thousands of different models fitting to each device.", "You might come up with a few workarounds in such situations. One possible and direct solution is developing a separate model for each item which probably leads to the highest accuracy. An important drawback for this methodology is obviously performance issues. If you have 1000 unique items in your dataset, you need 1000 different models to develop. In real life, you can even have much more unique items in the problem on which you are working. The more unique items you have in the dataset, the more complex solutions you implement. It is not the only a problem in terms of maintenance, but also a problem in terms of performance regarding resource usage.", "An alternative solution is to cluster similar behavioural items into the same clusters and develop a model for each cluster. This will result in better outputs with respect to complexity and performance issues by making compromising on accuracy.", "In this writing, I will mention an alternative approach for anomaly detection in multi-item datasets in which items have different patterns depending on the same factors. The rest of the writing is based on the implementation of this approach on a real dataset.", "Roaming in the telco domain is basically about using your own mobile phone in another country you visit. Telco companies continue to provide service for their customers in their international visits via a local service provider in the visited country. In order to get high customer satisfaction, telco companies monitor service quality of their own customers even if they are abroad. Within this scope, our target is to understand patterns and detect anomalies in the service quality customers experience in a foreign country and take an action accordingly. For this purpose, I am using a real dataset of a prominent telco company in Turkey.", "The data consist of 5 columns, those are time, operator name and 3 different KPIs. These KPIs are simply about service quality metrics and represent 3 months periods between July 2020 - October 2020. I anonymized the data because of the strict privacy issues. The data are received hourly and include summarized KPI values in the corresponding time range for each operator. The original data include more than 1000 different operators from different countries. For the sake of simplicity, I am working on a subset which corresponds to only 30 different operators.", "As you can guess, each operator has a different pattern. Each country receives different numbers of visitors from Turkey in each month of the year which, for instance, directly affects the call attempts number. Additionally, countries might have different time zones according to Turkey. So, you are likely to encounter with different usage volumes in Germany and Indian at 5 p.m based on Turkey time zone.", "The data have some missing rows due to impairments in the data flow. Handling missing values are out of the scope of this writing. Thus, I simply fill the gaps in the data with the mean of previous and next values of KPI values for the corresponding operator.", "Visualization always undertakes a critical role for any kinds of data science project just like in our approach here. I try to figure out the factors which shape the pattern of behaviours of KPI values for each operator.", "For this purpose, I randomly pick two operators and plot the KPI_1 values of them along the time axes. To be more understandable, I use only last week values. I am not able to analyze the seasonal pattern because of working on 3 months period. Keep in mind that these KPI values are deeply affected by the pandemic as a result of limitation policies in travelling between countries. As an initial observation, KPI values are dependent on the hour of the day and dependent on the day of the week. These inferences are generally straightforward and can be obtained without visualization. However, I encourage you to exploit visualization before making any decision and spend much more time on this step.", "The most critical part is to compose a pattern table which simply reflects the pattern of each item according to the factors which are found out in the visualization part. While composing the pattern table, I assume that the features of each item fit a normal distribution, so I calculate the mean and standard deviation of the KPI values in a simple manner.", "Before composing the pattern table, I split the dataset into train and test. And then, compose the pattern table by only using feature values in the train set.", "After composing the pattern table, the z-scores of each KPI values for each row are calculated. In other saying, deviations of each KPI values from their own patterns are estimated by taking into account pattern determining factors.", "I use Isolation Forest as the anomaly detection model, which is one of the alternatives among the lots of anomaly detection models. The crucial point is to feed the model with the calculated z-scores of each row. In other words, I take into consideration the deviation of each KPI values from the corresponding pattern.", "Actually, there is no need to use an anomaly detection model. You can even estimate a general weighted z-score value for each row together with a threshold value and come up with a more primitive solution in order to detect anomalies.", "In this approach, there are a few assumptions as you might notice. First of all, I assume that each features follow a pattern dependent on only some inferred factors which are operators (items), hour and weekday in our case. Note that, each operators has a different pattern but dependent on the same factors. Secondly, features fit normal distribution in the light of these inferred factors. Thirdly, correlations between the features are not taken into consideration while detecting anomalies.", "In fact, all these assumptions come together with their limitations and weaknesses. However, this approach can be utilized in a simple time series for anomaly detection problems including multiple items as an alternative. My goal is to give a simple insight about this approach, so I don\u2019t spend much time in each step. In a real-life scenario, determining the factors which shape the behaviours of each item correctly is very crucial. For this reason, detailed analyses are needed for especially in the visualization part. Each features even might be affected by different factors, not common factors.", "As I mentioned before, the dataset is affected profoundly by the pandemic. To get more robust results, it should be worked with more clear data or a subset of the data.", "Thanks for reading, I appreciate any feedback.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fe4dded5eeeb1&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsingle-model-based-anomaly-detection-for-multi-item-datasets-e4dded5eeeb1&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsingle-model-based-anomaly-detection-for-multi-item-datasets-e4dded5eeeb1&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsingle-model-based-anomaly-detection-for-multi-item-datasets-e4dded5eeeb1&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsingle-model-based-anomaly-detection-for-multi-item-datasets-e4dded5eeeb1&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----e4dded5eeeb1--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----e4dded5eeeb1--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@hertan06?source=post_page-----e4dded5eeeb1--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@hertan06?source=post_page-----e4dded5eeeb1--------------------------------", "anchor_text": "Halil Ertan"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F763c2473497e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsingle-model-based-anomaly-detection-for-multi-item-datasets-e4dded5eeeb1&user=Halil+Ertan&userId=763c2473497e&source=post_page-763c2473497e----e4dded5eeeb1---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe4dded5eeeb1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsingle-model-based-anomaly-detection-for-multi-item-datasets-e4dded5eeeb1&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe4dded5eeeb1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsingle-model-based-anomaly-detection-for-multi-item-datasets-e4dded5eeeb1&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@yvesalarie?utm_source=medium&utm_medium=referral", "anchor_text": "Yves Alarie"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://en.wikipedia.org/wiki/Roaming", "anchor_text": "Roaming"}, {"url": "https://en.wikipedia.org/wiki/Standard_score", "anchor_text": "z-scores"}, {"url": "https://medium.com/tag/python?source=post_page-----e4dded5eeeb1---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/anomaly-detection?source=post_page-----e4dded5eeeb1---------------anomaly_detection-----------------", "anchor_text": "Anomaly Detection"}, {"url": "https://medium.com/tag/time-series?source=post_page-----e4dded5eeeb1---------------time_series-----------------", "anchor_text": "Time Series"}, {"url": "https://medium.com/tag/isolation-forests?source=post_page-----e4dded5eeeb1---------------isolation_forests-----------------", "anchor_text": "Isolation Forests"}, {"url": "https://medium.com/tag/unsupervised-learning?source=post_page-----e4dded5eeeb1---------------unsupervised_learning-----------------", "anchor_text": "Unsupervised Learning"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fe4dded5eeeb1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsingle-model-based-anomaly-detection-for-multi-item-datasets-e4dded5eeeb1&user=Halil+Ertan&userId=763c2473497e&source=-----e4dded5eeeb1---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fe4dded5eeeb1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsingle-model-based-anomaly-detection-for-multi-item-datasets-e4dded5eeeb1&user=Halil+Ertan&userId=763c2473497e&source=-----e4dded5eeeb1---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe4dded5eeeb1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsingle-model-based-anomaly-detection-for-multi-item-datasets-e4dded5eeeb1&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----e4dded5eeeb1--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fe4dded5eeeb1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsingle-model-based-anomaly-detection-for-multi-item-datasets-e4dded5eeeb1&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----e4dded5eeeb1---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----e4dded5eeeb1--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----e4dded5eeeb1--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----e4dded5eeeb1--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----e4dded5eeeb1--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----e4dded5eeeb1--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----e4dded5eeeb1--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----e4dded5eeeb1--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----e4dded5eeeb1--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@hertan06?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@hertan06?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Halil Ertan"}, {"url": "https://medium.com/@hertan06/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "360 Followers"}, {"url": "https://www.linkedin.com/in/hertan/", "anchor_text": "https://www.linkedin.com/in/hertan/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F763c2473497e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsingle-model-based-anomaly-detection-for-multi-item-datasets-e4dded5eeeb1&user=Halil+Ertan&userId=763c2473497e&source=post_page-763c2473497e--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F1cb1e544f3e0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsingle-model-based-anomaly-detection-for-multi-item-datasets-e4dded5eeeb1&newsletterV3=763c2473497e&newsletterV3Id=1cb1e544f3e0&user=Halil+Ertan&userId=763c2473497e&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}