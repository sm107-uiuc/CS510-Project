{"url": "https://towardsdatascience.com/magic-of-the-sobel-operator-bbbcb15af20d", "time": 1683016331.689754, "path": "towardsdatascience.com/magic-of-the-sobel-operator-bbbcb15af20d/", "webpage": {"metadata": {"title": "Magic of the Sobel Operator. Finally, the moment you have all been\u2026 | by Aaron Dougherty | Towards Data Science", "h1": "Magic of the Sobel Operator", "description": "Finally, the moment you have all been waiting for, the next in our unsupervised Bayesian inference series: Our (not so) deep dive into the Sobel Operator. A truly magical edge detection algorithm, it\u2026"}, "outgoing_paragraph_urls": [{"url": "https://towardsdatascience.com/the-power-of-local-binary-patterns-3134178af1c7", "anchor_text": "as seen in my recent blog on LBP", "paragraph_index": 4}, {"url": "https://towardsdatascience.com/the-power-of-local-binary-patterns-3134178af1c7", "anchor_text": "see my other blog for more details on this technique", "paragraph_index": 14}], "all_paragraphs": ["Finally, the moment you have all been waiting for, the next in our unsupervised Bayesian inference series: Our (not so) deep dive into the Sobel Operator.", "A truly magical edge detection algorithm, it enables low-level feature extraction and dimensionality reduction, essentially reducing noise in the image. It has been particularly useful in facial recognition applications.", "The 1968 love child of Irwin Sobel and Gary Feldman (Stanford Artificial Intelligence Laboratory), this algorithm was the inspiration of many modern edge detection techniques. By convolving two opposing kernels or masks over a given image (e.g. see below-left) (each capable of detecting either horizontal or vertical edges), we can create a less noisy, smoothed out representation (see below-right).", "Presented as a discrete differential operator technique for gradient approximation computation of the image intensity function, in plain English, the algorithm detects changes in pixel channel values (usually luminance) by differentiating the difference between each pixel (the anchor pixel) and its surrounding pixels (essentially approximating the derivative of an image).", "This results in smoothing the original image and producing a lower dimension output, where low-level geometric features can be seen more clearly. These outputs can then be used as inputs into more complex classification algorithms, or as examples used for unsupervised probabilistic clustering via Kullback-Leibler Divergence (KLD) (as seen in my recent blog on LBP).", "Generating our lower dimension output requires us to take the derivative of the image. First, we calculate the derivate in both the x and y directions. We create two 3x3 kernels (see matrices), with zeros along the centre of the corresponding axis, twos in the centre squares perpendicular to the central zero and ones in each of the corners. Each of the non-zero values should be positive on top/to the right of the zeros (dependent on axis) and negative on their corresponding side. These kernels are named Gx and Gy.", "These kernels will then convolve over our image, placing the central pixel of each kernel over each pixel in the image. We use matrix multiplication to calculate the intensity value of a new corresponding pixel in an output image, for each kernel. Therefore, we end up with two output images (one for each cartesian direction).", "The aim is to find the difference/change between the pixel in the image and all pixels in the gradient matrix (kernel) (Gx and Gy). More mathematically, this can be expressed as.", "We are technically not convolving anything. Although we like to refer to \u2018convolutions\u2019 in AI and machine learning circles, a convolution would involve flipping the original image. Mathematically speaking, when we refer to convolutions, we are really calculating the cross-correlation between each 3x3 area of the input and the mask for each pixel. The output image is the overall covariance between the mask and the input. This is how the edges are detected.", "The calculated values for each matrix multiplication between the mask and 3x3 section of the input are summed to produce the final value for the pixel in the output image. This generates a new image which contains information about the presence of vertical and horizontal edges present in the original image. This is a geometric feature representation of the original image. Further, because this operator is guaranteed to produce the same output each time, this technique allows for stable edge detection for image segmentation tasks.", "From these outputs, we can calculate both the gradient magnitude and the gradient direction (using the arctangent operator) at any given pixel (x,y):", "From this we can ascertain that those pixels with large magnitudes are more likely to be an edge in the image, whilst the direction informs us about the edge orientation (although the direction isn\u2019t needed for generating our output).", "Here is a simple implementation of the Sobel operator in python (using NumPy) to give you a feel for the process (for all of you budding coders out there).", "This implementation is a python variant of the Wikipedia pseudocode example, aiming to show how you might implement this algorithm, whilst also demonstrating the various steps in the process.", "Although the gradient approximation produced by this operator is relatively crude, it does provide an extremely computationally efficient method of computing edges, corners and other geometric features of images. In turn, it has paved the way for a number of dimensionality reduction and feature extraction techniques, such as Local Binary Patterns (see my other blog for more details on this technique).", "Relying on exclusively geometric features does risk losing important information during the encoding of our data, however, the trade-off is what allows fast preprocessing of the data and in turn, fast training. Therefore this technique is especially useful in scenarios where texture and geometric features can be considered highly important in defining the input. This is why face recognition can be completed with a relatively high degree of accuracy using the Sobel operator. However, this technique may not be the best choice if trying to classify or group inputs which use colour as their main differentiating factor.", "This method is still extremely effective for gaining a low-dimensional representation of geometric features and an excellent starting point for dimensionality and noise reduction, prior to using other classifiers or for use in Bayesian inference methodologies.", "[1] D. Kroon, 2009, Short Paper University Twente, Numerical Optimization of Kernel Based Image Derivatives.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Machine Learning Engineer \u2014 Cyted Ltd. Building the next generation of AI-based Computational Histopathology diagnostics. Machine Vision, NLP, Bayesian Models."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fbbbcb15af20d&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmagic-of-the-sobel-operator-bbbcb15af20d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmagic-of-the-sobel-operator-bbbcb15af20d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmagic-of-the-sobel-operator-bbbcb15af20d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmagic-of-the-sobel-operator-bbbcb15af20d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----bbbcb15af20d--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----bbbcb15af20d--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://aarondougherty95.medium.com/?source=post_page-----bbbcb15af20d--------------------------------", "anchor_text": ""}, {"url": "https://aarondougherty95.medium.com/?source=post_page-----bbbcb15af20d--------------------------------", "anchor_text": "Aaron Dougherty"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F695aa18b7782&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmagic-of-the-sobel-operator-bbbcb15af20d&user=Aaron+Dougherty&userId=695aa18b7782&source=post_page-695aa18b7782----bbbcb15af20d---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fbbbcb15af20d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmagic-of-the-sobel-operator-bbbcb15af20d&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fbbbcb15af20d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmagic-of-the-sobel-operator-bbbcb15af20d&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@juliusdrost", "anchor_text": "Julius Drost"}, {"url": "http://unsplash.com", "anchor_text": "Unsplash"}, {"url": "https://scikit-image.org/", "anchor_text": "Scikit-Image"}, {"url": "https://scikit-image.org/docs/dev/auto_examples/edges/plot_edge_filter.html", "anchor_text": "Sobel Operator implementation"}, {"url": "https://scikit-image.org/", "anchor_text": "SciKit-Image"}, {"url": "https://towardsdatascience.com/the-power-of-local-binary-patterns-3134178af1c7", "anchor_text": "as seen in my recent blog on LBP"}, {"url": "https://towardsdatascience.com/the-power-of-local-binary-patterns-3134178af1c7", "anchor_text": "see my other blog for more details on this technique"}, {"url": "https://en.wikipedia.org/wiki/Sobel_operator", "anchor_text": "https://en.wikipedia.org/wiki/Sobel_operator"}, {"url": "https://medium.com/tag/sobel?source=post_page-----bbbcb15af20d---------------sobel-----------------", "anchor_text": "Sobel"}, {"url": "https://medium.com/tag/sobel-filter?source=post_page-----bbbcb15af20d---------------sobel_filter-----------------", "anchor_text": "Sobel Filter"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----bbbcb15af20d---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----bbbcb15af20d---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/machine-vision?source=post_page-----bbbcb15af20d---------------machine_vision-----------------", "anchor_text": "Machine Vision"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fbbbcb15af20d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmagic-of-the-sobel-operator-bbbcb15af20d&user=Aaron+Dougherty&userId=695aa18b7782&source=-----bbbcb15af20d---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fbbbcb15af20d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmagic-of-the-sobel-operator-bbbcb15af20d&user=Aaron+Dougherty&userId=695aa18b7782&source=-----bbbcb15af20d---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fbbbcb15af20d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmagic-of-the-sobel-operator-bbbcb15af20d&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----bbbcb15af20d--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fbbbcb15af20d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmagic-of-the-sobel-operator-bbbcb15af20d&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----bbbcb15af20d---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----bbbcb15af20d--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----bbbcb15af20d--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----bbbcb15af20d--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----bbbcb15af20d--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----bbbcb15af20d--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----bbbcb15af20d--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----bbbcb15af20d--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----bbbcb15af20d--------------------------------", "anchor_text": ""}, {"url": "https://aarondougherty95.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://aarondougherty95.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Aaron Dougherty"}, {"url": "https://aarondougherty95.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "22 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F695aa18b7782&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmagic-of-the-sobel-operator-bbbcb15af20d&user=Aaron+Dougherty&userId=695aa18b7782&source=post_page-695aa18b7782--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F8b8a218a3426&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmagic-of-the-sobel-operator-bbbcb15af20d&newsletterV3=695aa18b7782&newsletterV3Id=8b8a218a3426&user=Aaron+Dougherty&userId=695aa18b7782&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}