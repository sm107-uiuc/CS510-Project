{"url": "https://towardsdatascience.com/conversational-ai-with-bert-made-easy-1608ce23e58b", "time": 1683009899.091139, "path": "towardsdatascience.com/conversational-ai-with-bert-made-easy-1608ce23e58b/", "webpage": {"metadata": {"title": "Conversational AI with BERT Made Easy | by Brandon Janes | Towards Data Science", "h1": "Conversational AI with BERT Made Easy", "description": "For over a year I have been trying to automate appointment scheduling using NLP and python, and I finally got it to work thanks to an amazing free open-source dialogue tool called Rasa. The truth is\u2026"}, "outgoing_paragraph_urls": [{"url": "https://rasa.com/", "anchor_text": "Rasa", "paragraph_index": 2}, {"url": "https://blog.rasa.com/introducing-dual-intent-and-entity-transformer-diet-state-of-the-art-performance-on-a-lightweight-architecture/", "anchor_text": "Dual Intent Entity Transformer", "paragraph_index": 2}, {"url": "https://www.kunan.com.ar/", "anchor_text": "Kunan S.A.", "paragraph_index": 2}, {"url": "https://rasa.com/docs/rasa/user-guide/installation/", "anchor_text": "Rasa", "paragraph_index": 7}, {"url": "https://www.youtube.com/watch?v=rlAQWbhwqLA&list=PL75e0qA87dlHQny7z43NduZHPo6qd-cRc", "anchor_text": "tutorial", "paragraph_index": 7}, {"url": "https://huggingface.co/transformers/pretrained_models.html", "anchor_text": "the HuggingFace website", "paragraph_index": 10}, {"url": "https://github.com/kunan-sa/the-conversational-ai-pipeline", "anchor_text": "github", "paragraph_index": 12}], "all_paragraphs": ["For over a year I have been trying to automate appointment scheduling using NLP and python, and I finally got it to work thanks to an amazing free open-source dialogue tool called Rasa.", "The truth is a year ago, when I started this project, the tools I am using now were hardly available. Certainly not in the easy-to-use form that we find them today. As a testament to how quickly this science of artificial intelligence and NLP is moving, this time last year (June 2019) transformers like BERT had barely left the domain of academic research and were just beginning to be seen in production at tech giants like Google and Facebook. The BERT paper itself was only published in October 2018 (links to papers below).", "Today, thanks to open-source platforms like Rasa and HuggingFace, BERT and other transformer architectures are available in an easy plug-and-play manner. Moreover, the data scientists at Rasa have developed a special transformer-based classifier called the Dual Intent Entity Transformer or DIET classifier that is tailor-made for the task of extracting entities and classifying intents simultaneously, which is exactly what we do with our product MyTurn, an appointment scheduling virtual assistant developed with my team at Kunan S.A. in Argentina.", "For quantitative folks out there, after I replaced ye ole Sklearn-based classifier with DIET my F1 score surged in both entity extraction and intent classification by more than 30 percent!!!! Compare SklearnIntentClassifier with diet_BERT_combined in the figures below. If you have ever designed machine learning models, you\u2019d know that 30 percent is huge. Like that time you realized you had parked your car on the hose to the sprinkler. What a wonderful surprise when things work the way they should!", "Is it science or art? It\u2019s neither. It\u2019s trying every possible combination of hyperparameters and choosing the configuration that gives you the highest metrics. It\u2019s called grid search.", "It\u2019s important to note that BERT is not a magic pill. In fact, for my specific task and training data, the BERT pretrained word embeddings alone did not provide good results (see diet_BERT_only above). These results were significantly worse than the old Sklearn-based classifier of 2019. Perhaps this can be explained by the regional jargon and colloquialisms found in the informal Spanish chats of C\u00f3rdoba, Argentina, from where our training data was generated. The multilingual pretrained BERT embeddings we used were \u201ctrained on cased text in the top 104 languages with the largest Wikipedias,\u201d according to HuggingFace documentation.", "However, the highest performing model we obtained was by training custom features on our own C\u00f3rdoba data using DIET and then combining these supervised embeddings with the BERT pretrained embeddings in a feed forward layer (see results in diet_BERT_combined above). The small diagram below shows how \u201csparse features,\u201d trained on C\u00f3rdoba data, can be combined with BERT \u201cpretrained embeddings\u201d in a feed forward layer. This option is ideal for Spanish language projects with little training data. That being said, the combined model performed only slightly better than the model that used DIET with no BERT pretrained embeddings (see results for diet_without_BERT above). This means for non-English language chatbots with a moderate amount of training data, the DIET architecture is probably all you need.", "After installing Rasa, and building an assistant to your needs (I suggest watching Rasa\u2019s YouTube tutorial before doing this), the implementation of BERT embeddings is so easy it is almost disappointing.", "Below is an example of the configuration file we used. The long list of hyperparameters may seem overwhelming, but trust me, this is much easier than it was a year ago.", "You must download the BERT dependencies:", "To integrate BERT or any of the other pretrained models available on the HuggingFace website, just replace the model_weights hyperparemeter in following line with whatever pretrainined embeddings you want to use.", "We used bert-base-multilingual-cased because is was the best model available for Spanish.", "See our github for full examples of configuration files mentioned in this article and additional links.", "The beauty of Rasa is that it streamlines model training for Natural Language Understanding (NLU), Named Entity Recognition (NER) and Dialogue Management (DM), the three essential tools needed for task-oriented dialogue systems. Although we did a lot of good programming to make our system work as well as it does, you could probably get away with about 80 percent of building a Rasa virtual assistant without any real Python skills.", "With exciting advancements in NLP, such as transformers and pretrained word embeddings, the field of conversational AI has leaped forward in recent years, from bots that say, \u201cSorry, I don\u2019t understand,\u201d to truly becoming feasible solutions to daily tasks that once required tedious human work.", "Philosophically, the goal of this technology is not to replace humans with robots, but rather to assign the repetitive and \u201crobotic\u201d daily tasks, such as data entry or appointment scheduling, to virtual assistants, and reserve the brainspace of humans for the types of work that require skills that only humans have, such as creativity and critical thinking. MyTurn is a simple but prescient example of how conversational AI is not a tool reserved for Big Tech companies, but is in fact accessible to everybody through free and open-source technologies like Rasa and HuggingFace.", "Tom Bocklisch, Joey Faulkner, Nick Pawlowski, Alan Nichol, Rasa: Open Source Language Understanding and Dialogue Management,15 December 2017", "Ashish Vaswani, Noam Shazeer, Niki Parmar, Jakob Uszkoreit, Llion Jones, Attention Is All You Need, 6 December 2017", "Jianfeng Gao (Microsoft), Micahel Galley (Microsoft), Lihong Li (Google), Neural Approaches to Conversational AI: Question Answering, Task-Oriented Dialogues and Social Chatbots, 10 September 2019", "Jacob Devlin Ming-Wei Chang Kenton Lee Kristina Toutanova Google AI Language, BERT: Pre-training of Deep Bidirectional Transformers for Language Understanding, 11 October 2018", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Freedom of information journalist-turned data scientist, interested in bringing data to life through machine learning and Python."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F1608ce23e58b&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fconversational-ai-with-bert-made-easy-1608ce23e58b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fconversational-ai-with-bert-made-easy-1608ce23e58b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fconversational-ai-with-bert-made-easy-1608ce23e58b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fconversational-ai-with-bert-made-easy-1608ce23e58b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----1608ce23e58b--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----1608ce23e58b--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://bubjanes.medium.com/?source=post_page-----1608ce23e58b--------------------------------", "anchor_text": ""}, {"url": "https://bubjanes.medium.com/?source=post_page-----1608ce23e58b--------------------------------", "anchor_text": "Brandon Janes"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fd75d6b021c61&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fconversational-ai-with-bert-made-easy-1608ce23e58b&user=Brandon+Janes&userId=d75d6b021c61&source=post_page-d75d6b021c61----1608ce23e58b---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F1608ce23e58b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fconversational-ai-with-bert-made-easy-1608ce23e58b&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F1608ce23e58b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fconversational-ai-with-bert-made-easy-1608ce23e58b&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://rasa.com/", "anchor_text": "Rasa"}, {"url": "https://blog.rasa.com/introducing-dual-intent-and-entity-transformer-diet-state-of-the-art-performance-on-a-lightweight-architecture/", "anchor_text": "Dual Intent Entity Transformer"}, {"url": "https://www.kunan.com.ar/", "anchor_text": "Kunan S.A."}, {"url": "https://rasa.com/docs/rasa/user-guide/installation/", "anchor_text": "Rasa"}, {"url": "https://www.youtube.com/watch?v=rlAQWbhwqLA&list=PL75e0qA87dlHQny7z43NduZHPo6qd-cRc", "anchor_text": "tutorial"}, {"url": "https://huggingface.co/transformers/pretrained_models.html", "anchor_text": "the HuggingFace website"}, {"url": "https://github.com/kunan-sa/the-conversational-ai-pipeline", "anchor_text": "github"}, {"url": "https://medium.com/tag/chatbots?source=post_page-----1608ce23e58b---------------chatbots-----------------", "anchor_text": "Chatbots"}, {"url": "https://medium.com/tag/nlp?source=post_page-----1608ce23e58b---------------nlp-----------------", "anchor_text": "NLP"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----1608ce23e58b---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/ai?source=post_page-----1608ce23e58b---------------ai-----------------", "anchor_text": "AI"}, {"url": "https://medium.com/tag/bert?source=post_page-----1608ce23e58b---------------bert-----------------", "anchor_text": "Bert"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F1608ce23e58b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fconversational-ai-with-bert-made-easy-1608ce23e58b&user=Brandon+Janes&userId=d75d6b021c61&source=-----1608ce23e58b---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F1608ce23e58b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fconversational-ai-with-bert-made-easy-1608ce23e58b&user=Brandon+Janes&userId=d75d6b021c61&source=-----1608ce23e58b---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F1608ce23e58b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fconversational-ai-with-bert-made-easy-1608ce23e58b&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----1608ce23e58b--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F1608ce23e58b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fconversational-ai-with-bert-made-easy-1608ce23e58b&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----1608ce23e58b---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----1608ce23e58b--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----1608ce23e58b--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----1608ce23e58b--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----1608ce23e58b--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----1608ce23e58b--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----1608ce23e58b--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----1608ce23e58b--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----1608ce23e58b--------------------------------", "anchor_text": ""}, {"url": "https://bubjanes.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://bubjanes.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Brandon Janes"}, {"url": "https://bubjanes.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "47 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fd75d6b021c61&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fconversational-ai-with-bert-made-easy-1608ce23e58b&user=Brandon+Janes&userId=d75d6b021c61&source=post_page-d75d6b021c61--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fa91cb7a5d13b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fconversational-ai-with-bert-made-easy-1608ce23e58b&newsletterV3=d75d6b021c61&newsletterV3Id=a91cb7a5d13b&user=Brandon+Janes&userId=d75d6b021c61&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}