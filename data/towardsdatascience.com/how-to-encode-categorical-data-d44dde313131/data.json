{"url": "https://towardsdatascience.com/how-to-encode-categorical-data-d44dde313131", "time": 1683003834.7207649, "path": "towardsdatascience.com/how-to-encode-categorical-data-d44dde313131/", "webpage": {"metadata": {"title": "How to Encode Categorical Data. 12 different encoding techniques from\u2026 | by Huy Bui | Towards Data Science", "h1": "How to Encode Categorical Data", "description": "In this notebook, I will introduce different approaches to encode categorical data. I want to write it in a simple language with a little math involved. They are 12 basic encoding schemes that you\u2026"}, "outgoing_paragraph_urls": [{"url": "https://github.com/williamhuybui/Blog-Encoding-Scheme", "anchor_text": "here", "paragraph_index": 1}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.feature_extraction.FeatureHasher.html", "anchor_text": "scikit-learn", "paragraph_index": 16}, {"url": "https://stats.idre.ucla.edu/r/library/r-library-contrast-coding-systems-for-categorical-variables/#HELMERT", "anchor_text": "Read more.", "paragraph_index": 21}, {"url": "http://www.statsmodels.org/dev/contrasts.html", "anchor_text": "Read more", "paragraph_index": 22}, {"url": "https://kiwidamien.github.io/james-stein-encoder.html", "anchor_text": "here", "paragraph_index": 33}, {"url": "https://en.wikipedia.org/wiki/M-estimator", "anchor_text": "here", "paragraph_index": 34}], "all_paragraphs": ["In this notebook, I will introduce different approaches to encode categorical data. I want to write it in a simple language with a little math involved. They are 12 basic encoding schemes that you should put in your tool kit. For convenience purposes, I will also provide the scikit-learn version and the library corresponding to each method.", "By the end of this post, I hope that you would have a better idea of how to deal with categorical data. You can find my code here.", "There are three main routes to encode the string data type:", "Classic Encoders: well known and widely used", "Contrast Encoders: an innovative way to encode data by looking at different levels of features", "Bayesian Encoders: a more advanced method that uses the target as a foundation for encoding", "And there are many more! However, once you know how these most common encoding schemes work, you will find it fairly easy to google the other one.", "Let\u2019s create a random pokemon data set!", "I am a big fan and a hard Pokemon grinder. I often go to the Pokemon database to see which Pokemon should be in my team. There are 4 features that would affect my choices: type, size, stats, and legendary. I created this sample data with only 10 observations to better illustrate the different encoding techniques and bring some joy to myself!", "We started with the most basic techniques, classic encoders. As the name suggests, these encoders are well known and widely used. Their concept is also pretty straight-forward.", "The ordinal features are features that have an order. This type of data is also called ordinal data. Let\u2019s look at the Height column in the data frame. The categories are: very short, short, normal, tall, very tall and it makes sense to put them in increasing/decreasing order. By encoding the columns manually, we can significantly boost the model performance.", "Let\u2019s look at the column Type. This is nominal data which is the opposite to ordinal data in the Height column. The easiest way to turn this column into numerical is to use one-hot encoding by following the 2 steps", "The get_dummiesfunction in pandas can achieve this goal", "Imagine that you have 200 different categories. One-hot encoding will create 200 different columns. That a lot of columns will takes up a lot of memory. It the meantime, binary encoding only need 8 columns. It takes advantage of the binary system and so there might be multiple ones in a row. The logical explanation behind binary encoding is:", "In the code below, I will add the encounter step column so you can see how it works.", "Give each category the probability (occurrence/total event). This means that if there are two categories in a column with the same probability (3 fire and 3 bugs), you cannot really tell the difference between them after being frequency encoded. The trade-off is no new column will be introduced.", "Hashing converts categorical variables to a higher dimensional space of integers. I won\u2019t comment on the methodology much here since scikit-learn explains it very well.", "The n_feature is the number of columns you want to add. These new columns distinguish the corresponding category. However, you can adjust to any number. This is like binary encoding on steroids!", "Note: What is a good number of returning features? If m are distinct features, and n_feature=k , then m<2^k", "Contrast encoding allows for recentering of categorical variables such that the intercept of a model is not the mean of one level of a category, but instead, the mean of all data points in the data set.", "Many people argue that these encodings are not very effective. However, I will leave them here as references.", "Helmert encoding compares each level of a categorical variable to the mean of the subsequent levels. Read more.", "In backward difference encoding, the mean of the dependent variable for a level is compared with the mean of the dependent variable for the prior level. Read more", "The general idea of this method is to take the target into account.", "Target-based encoding basically means using the target to encode categorical features. The formula for it is:", "In the table below, Legendary is our target. Since there are only 1 out of 3 Fire pokemon that are legendary, its value is 1/3. Think about target encoding as frequency encoding on the target!", "Note: There are some different version that multiplies the output by a (Laplace)smoothing value. This is to avoid data leakage.", "Leave One Out Encoding (LOOE) is very similar to target encoding but excludes the current row\u2019s target when calculating the mean target for a level to reduce the effect of outliers.", "Additionally, you can add some (Gaussian) noise to the data to prevent overfitting by changing the sigma value between 0 and 1.", "Weight of Evidence Encoding (WoE) is a measure of how much the evidence supports or undermines a hypothesis.", "where adj is the adjacent factor is a function that avoids division by 0.", "Note: We can adjust the adj factor by changing regularization. (By default it is 1). When setting it equal to 0. You come back to the original WOE and may encounter division by 0", "This is target encoding but is more robust. James-Stein (JS) is it works best for the feature that has a normal distribution. JS is defined by the formula:", "The weight B depends on the variances \u03c3(y) and \u03c3(yi). More about this method here.", "M-Estimate encoder is a simplified version of Target Encoder. The stands for maximum likelihood-type. It has only one hyper-parameter m, which represents the power of regularization. The higher the value of m results into stronger shrinking. Recommended values m are in the range of 1 to 100. More about it here.", "There is no single formula for encoding a feature. However, if you understand the 12 encoding techniques I introduced above, you would be able to move fast. Moreover, it always worth tries all the techniques that apply to the feature and decides which one works best. Try to input different regularization coefficient values and see if they increase your score. The cheat-sheet below will help you make some initial decisions.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fd44dde313131&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-encode-categorical-data-d44dde313131&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-encode-categorical-data-d44dde313131&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-encode-categorical-data-d44dde313131&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-encode-categorical-data-d44dde313131&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----d44dde313131--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----d44dde313131--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@williamhuybui?source=post_page-----d44dde313131--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@williamhuybui?source=post_page-----d44dde313131--------------------------------", "anchor_text": "Huy Bui"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F1369614bb5e2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-encode-categorical-data-d44dde313131&user=Huy+Bui&userId=1369614bb5e2&source=post_page-1369614bb5e2----d44dde313131---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fd44dde313131&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-encode-categorical-data-d44dde313131&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fd44dde313131&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-encode-categorical-data-d44dde313131&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://github.com/williamhuybui/Blog-Encoding-Scheme", "anchor_text": "here"}, {"url": "https://github.com/williamhuybui/Blog-Encoding-Scheme", "anchor_text": "Huy Bui"}, {"url": "https://github.com/williamhuybui/Blog-Encoding-Scheme", "anchor_text": "Huy Bui"}, {"url": "https://github.com/williamhuybui/Blog-Encoding-Scheme", "anchor_text": "Huy Bui"}, {"url": "https://github.com/williamhuybui/Blog-Encoding-Scheme", "anchor_text": "Huy Bui"}, {"url": "https://github.com/williamhuybui/Blog-Encoding-Scheme", "anchor_text": "Huy Bui"}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.feature_extraction.FeatureHasher.html", "anchor_text": "scikit-learn"}, {"url": "https://github.com/williamhuybui/Blog-Encoding-Scheme", "anchor_text": "Huy Bui"}, {"url": "https://stats.idre.ucla.edu/r/library/r-library-contrast-coding-systems-for-categorical-variables/#HELMERT", "anchor_text": "Read more."}, {"url": "https://github.com/williamhuybui/Blog-Encoding-Scheme", "anchor_text": "Huy Bui"}, {"url": "http://www.statsmodels.org/dev/contrasts.html", "anchor_text": "Read more"}, {"url": "https://github.com/williamhuybui/Blog-Encoding-Scheme", "anchor_text": "Huy Bui"}, {"url": "https://github.com/williamhuybui/Blog-Encoding-Scheme", "anchor_text": "Huy Bui"}, {"url": "https://github.com/williamhuybui/Blog-Encoding-Scheme", "anchor_text": "Huy Bui"}, {"url": "https://github.com/williamhuybui/Blog-Encoding-Scheme", "anchor_text": "Huy Bui"}, {"url": "https://kiwidamien.github.io/james-stein-encoder.html", "anchor_text": "here"}, {"url": "https://github.com/williamhuybui/Blog-Encoding-Scheme", "anchor_text": "Huy Bui"}, {"url": "https://en.wikipedia.org/wiki/M-estimator", "anchor_text": "here"}, {"url": "https://github.com/williamhuybui/Blog-Encoding-Scheme", "anchor_text": "Huy Bui"}, {"url": "https://medium.com/tag/encoding?source=post_page-----d44dde313131---------------encoding-----------------", "anchor_text": "Encoding"}, {"url": "https://medium.com/tag/categorical-data?source=post_page-----d44dde313131---------------categorical_data-----------------", "anchor_text": "Categorical Data"}, {"url": "https://medium.com/tag/cardinals?source=post_page-----d44dde313131---------------cardinals-----------------", "anchor_text": "Cardinals"}, {"url": "https://medium.com/tag/curse-of-dimensionality?source=post_page-----d44dde313131---------------curse_of_dimensionality-----------------", "anchor_text": "Curse Of Dimensionality"}, {"url": "https://medium.com/tag/data-science?source=post_page-----d44dde313131---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fd44dde313131&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-encode-categorical-data-d44dde313131&user=Huy+Bui&userId=1369614bb5e2&source=-----d44dde313131---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fd44dde313131&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-encode-categorical-data-d44dde313131&user=Huy+Bui&userId=1369614bb5e2&source=-----d44dde313131---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fd44dde313131&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-encode-categorical-data-d44dde313131&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----d44dde313131--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fd44dde313131&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-encode-categorical-data-d44dde313131&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----d44dde313131---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----d44dde313131--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----d44dde313131--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----d44dde313131--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----d44dde313131--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----d44dde313131--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----d44dde313131--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----d44dde313131--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----d44dde313131--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@williamhuybui?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@williamhuybui?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Huy Bui"}, {"url": "https://medium.com/@williamhuybui/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "227 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F1369614bb5e2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-encode-categorical-data-d44dde313131&user=Huy+Bui&userId=1369614bb5e2&source=post_page-1369614bb5e2--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F40c7e9b9d260&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-encode-categorical-data-d44dde313131&newsletterV3=1369614bb5e2&newsletterV3Id=40c7e9b9d260&user=Huy+Bui&userId=1369614bb5e2&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}