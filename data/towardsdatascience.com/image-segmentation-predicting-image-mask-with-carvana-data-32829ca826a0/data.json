{"url": "https://towardsdatascience.com/image-segmentation-predicting-image-mask-with-carvana-data-32829ca826a0", "time": 1683006571.598465, "path": "towardsdatascience.com/image-segmentation-predicting-image-mask-with-carvana-data-32829ca826a0/", "webpage": {"metadata": {"title": "Image Segmentation: Predicting Image Mask with Carvana Data | by Rachel Zhiqing Zheng | Towards Data Science", "h1": "Image Segmentation: Predicting Image Mask with Carvana Data", "description": "In my previous blog, we have ventured into the realm of image classification, where the task is to identify a label or class for input images. In our previous context, where we classified dog photos\u2026"}, "outgoing_paragraph_urls": [{"url": "https://medium.com/analytics-vidhya/beginners-guide-on-image-classification-vgg-19-resnet-50-and-inceptionresnetv2-with-tensorflow-4909c6478941", "anchor_text": "my previous blog", "paragraph_index": 0}, {"url": "https://github.com/ZeeTsing/Carvana_challenge", "anchor_text": "here", "paragraph_index": 2}, {"url": "https://www.kaggle.com/c/carvana-image-masking-challenge/overview", "anchor_text": "data set", "paragraph_index": 3}, {"url": "https://lmb.informatik.uni-freiburg.de/people/ronneber/u-net/", "anchor_text": "U-Net here", "paragraph_index": 20}], "all_paragraphs": ["In my previous blog, we have ventured into the realm of image classification, where the task is to identify a label or class for input images. In our previous context, where we classified dog photos, one could learn what type of dogs is identified by the algorithm. However, suppose one wants to know if the dogs are accompanied by its owner or if there are two dogs in the image and location of such objects etc. In this case one would need to use image segmentation instead.", "Imagine that each pixel of the image is given certain classes. Take the car picture for example, there could be three classes: the car, the road and rest of the background. These classes \u201ctells\u201d the computer which pixel belongs to what class. The task of image segmentation is to train a neural network that is able to predict pixel-wise classes for the input images. The output of prediction is called a \u201cmask\u201d of the image. The technique is useful in object recognition, face recognition, medical image analysis and satellite image analysis etc.", "In this project, we will train neural networks to predict image mask for Carvana data using two different approaches and the code repository can be found here.", "The data set sources from an image masking challenge hosted on Kaggle from Carvana.", "There are only two classes present:", "Each car has 16 different positions of high quality photos of 1918*1280 pixel. In train set, there are 318 cars, total 5088 images; and 6254 cars in test set, total 100,064 images. We will use train set to split train and validate data while the test set will be completely unseen by the model.", "For data preprocessing, we chose to simply horizontally flip the images using Keras image processing.", "When formulating the task, we realize that producing image mask is similar to a classification task for the model predicts a class label for each pixel. Therefore, evaluation metric used for classification task, such as accuracy, seems a natural choice for this task, doesn\u2019t it? However, this is not the case and we would need to introduce a new metric for this task. Here I will illustrate with an example using the data set.", "The image on the left is a true mask randomly selected from the train set. The yellow area is the car and purple the background. We also observe that foreground represents 18% of the total pixels while background 82%. In general, the car (foreground) represents less than 20% of the total image size.", "Suppose that we have a prediction of mask which is totally purple, in other words it predicts only background appears in the image and no foreground detected.", "If we evaluate with accuracy, it gives us a decent score of 82% for the background is correctly predicted. Sounds awesome?", "However, image segmentation learns not only what is in the image but also where. Accuracy as a metric would not be able to capture the information of \u201cwhere\u201d. In this case, we introduce dice coefficient to capture the \u201cwhat\u201d and \u201cwhere\u201d at the same time.", "Dice coefficient measures the similarity between two images, class by class. A score of 1 means the two images are completely identical while 0 means completely different. If we take the same example as above, dice coefficient gives a score of 41%.", "Total Pixels for both images combined = 200 (for simplicity, let\u2019s assume it is 100 pixel per picture instead of the real number of pixels)", "Foreground (Car): Area of Overlap = 0", "Background: Area of Overlap = 82", "We will use dice coefficient as the main metric to evaluate our model performance and accuracy would be monitored as an indicator. The code snippet below defines the dice coefficient used for the project. Dice coefficient can be used in dice loss which is (1-dice coefficient). The smooth variable is used to help with backpropagation by not getting the term close to zero as well as preventing overfitting with a relatively large value.", "Our first model is a naive three layer convolution model which is acting as a simple base line. The input picture is the original picture with 3 channels and resized to smaller size for faster training.", "Loss function used is binary cross entropy and metrics monitored are dice coefficient and accuracy.", "Then we moved on to a model structure called U-Net after some research. It is an effective model structure for image segmentation. A U-Net network has two parts: an encoder (downsampler) and decoder (upsampler). It looks like a U shape on the original notation.", "The left side is encoder where the data is condensed into a smaller but deeper matrix. The right side then decodes using the encoder\u2019s output as well as the encoder\u2019s respective input (skip connection). You can learn more about U-Net here.", "Loss function used is binary cross entropy and metrics monitored are dice coefficient and accuracy.", "The result shows that U-Net model is superior to the naive model by far, which is expected.", "The model also generalizes quite well for unseen data. Here are a few unseen images shown below with its predicted mask.", "The project was concluded within two weeks and there is room to improve.", "The loss function (binary cross entropy) was chosen for simplicity of and readiness. It is not necessarily the best loss function for this type of task. One can consider using a mixture of dice loss and binary cross entropy or dice loss.", "When we visualize the images with the highest error from the train set, we realize the common issues found are missing borderline, missing parts if close to shadow and missing fine details like an antenna.", "I hope you enjoy reading it! Stay home and stay safe.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Passionate Data Scientist | Enjoy learning and sharing"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F32829ca826a0&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimage-segmentation-predicting-image-mask-with-carvana-data-32829ca826a0&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimage-segmentation-predicting-image-mask-with-carvana-data-32829ca826a0&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimage-segmentation-predicting-image-mask-with-carvana-data-32829ca826a0&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimage-segmentation-predicting-image-mask-with-carvana-data-32829ca826a0&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----32829ca826a0--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----32829ca826a0--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@zzq.rain?source=post_page-----32829ca826a0--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@zzq.rain?source=post_page-----32829ca826a0--------------------------------", "anchor_text": "Rachel Zhiqing Zheng"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F428d15aa04fe&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimage-segmentation-predicting-image-mask-with-carvana-data-32829ca826a0&user=Rachel+Zhiqing+Zheng&userId=428d15aa04fe&source=post_page-428d15aa04fe----32829ca826a0---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F32829ca826a0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimage-segmentation-predicting-image-mask-with-carvana-data-32829ca826a0&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F32829ca826a0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimage-segmentation-predicting-image-mask-with-carvana-data-32829ca826a0&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@introspectivedsgn", "anchor_text": "@introspectivedsgn"}, {"url": "https://medium.com/analytics-vidhya/beginners-guide-on-image-classification-vgg-19-resnet-50-and-inceptionresnetv2-with-tensorflow-4909c6478941", "anchor_text": "my previous blog"}, {"url": "https://github.com/ZeeTsing/Carvana_challenge", "anchor_text": "here"}, {"url": "https://www.kaggle.com/c/carvana-image-masking-challenge/overview", "anchor_text": "data set"}, {"url": "https://lmb.informatik.uni-freiburg.de/people/ronneber/u-net/", "anchor_text": "U-Net here"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----32829ca826a0---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/image-segmentation?source=post_page-----32829ca826a0---------------image_segmentation-----------------", "anchor_text": "Image Segmentation"}, {"url": "https://medium.com/tag/unet?source=post_page-----32829ca826a0---------------unet-----------------", "anchor_text": "Unet"}, {"url": "https://medium.com/tag/computer-vision?source=post_page-----32829ca826a0---------------computer_vision-----------------", "anchor_text": "Computer Vision"}, {"url": "https://medium.com/tag/image?source=post_page-----32829ca826a0---------------image-----------------", "anchor_text": "Image"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F32829ca826a0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimage-segmentation-predicting-image-mask-with-carvana-data-32829ca826a0&user=Rachel+Zhiqing+Zheng&userId=428d15aa04fe&source=-----32829ca826a0---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F32829ca826a0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimage-segmentation-predicting-image-mask-with-carvana-data-32829ca826a0&user=Rachel+Zhiqing+Zheng&userId=428d15aa04fe&source=-----32829ca826a0---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F32829ca826a0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimage-segmentation-predicting-image-mask-with-carvana-data-32829ca826a0&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----32829ca826a0--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F32829ca826a0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimage-segmentation-predicting-image-mask-with-carvana-data-32829ca826a0&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----32829ca826a0---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----32829ca826a0--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----32829ca826a0--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----32829ca826a0--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----32829ca826a0--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----32829ca826a0--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----32829ca826a0--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----32829ca826a0--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----32829ca826a0--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@zzq.rain?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@zzq.rain?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Rachel Zhiqing Zheng"}, {"url": "https://medium.com/@zzq.rain/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "66 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F428d15aa04fe&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimage-segmentation-predicting-image-mask-with-carvana-data-32829ca826a0&user=Rachel+Zhiqing+Zheng&userId=428d15aa04fe&source=post_page-428d15aa04fe--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F8217621b056e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimage-segmentation-predicting-image-mask-with-carvana-data-32829ca826a0&newsletterV3=428d15aa04fe&newsletterV3Id=8217621b056e&user=Rachel+Zhiqing+Zheng&userId=428d15aa04fe&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}