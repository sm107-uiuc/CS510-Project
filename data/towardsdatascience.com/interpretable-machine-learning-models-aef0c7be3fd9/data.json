{"url": "https://towardsdatascience.com/interpretable-machine-learning-models-aef0c7be3fd9", "time": 1683002588.9453208, "path": "towardsdatascience.com/interpretable-machine-learning-models-aef0c7be3fd9/", "webpage": {"metadata": {"title": "Interpretable Machine Learning Models | by Hennie de Harder | Towards Data Science", "h1": "Interpretable Machine Learning Models", "description": "A machine learning model from Amazon selected only males from a pile of resumes\u00b9. Another model fired teachers who were underperforming, according to the model\u00b2. Such models are discriminatory and\u2026"}, "outgoing_paragraph_urls": [{"url": "https://medium.com/@hennie_de_harder/model-agnostic-methods-for-interpreting-any-machine-learning-model-4f10787ef504", "anchor_text": "a different article", "paragraph_index": 1}, {"url": "https://www.kaggle.com/ronitf/heart-disease-uci", "anchor_text": "Heart Disease UCI dataset on Kaggle", "paragraph_index": 3}, {"url": "https://github.com/henniedeharder/interpretability-heart/blob/master/Demo_Forest_SHAP_Heart.ipynb", "anchor_text": "GitHub", "paragraph_index": 4}, {"url": "https://github.com/henniedeharder/interpretability-heart/blob/master/Demo_Forest_SHAP_Heart.ipynb", "anchor_text": "the notebook", "paragraph_index": 12}, {"url": "https://victorzhou.com/blog/gini-impurity/", "anchor_text": "Gini Impurity", "paragraph_index": 15}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.tree.DecisionTreeClassifier.html#sklearn.tree.DecisionTreeClassifier.feature_importances_", "anchor_text": "Gini importance", "paragraph_index": 18}, {"url": "https://medium.com/@hennie_de_harder/model-agnostic-methods-for-interpreting-any-machine-learning-model-4f10787ef504", "anchor_text": "the next article", "paragraph_index": 19}, {"url": "https://www.reuters.com/article/us-amazon-com-jobs-automation-insight/amazon-scraps-secret-ai-recruiting-tool-that-showed-bias-against-women-idUSKCN1MK08G", "anchor_text": "Amazon scraps secret AI recruiting tool that showed bias against women", "paragraph_index": 20}, {"url": "https://stats.idre.ucla.edu/other/mult-pkg/faq/general/faq-how-do-i-interpret-odds-ratios-in-logistic-regression/", "anchor_text": "How do I interpret odds ratios in logistic regression?", "paragraph_index": 21}], "all_paragraphs": ["A machine learning model from Amazon selected only males from a pile of resumes\u00b9. Another model fired teachers who were underperforming, according to the model\u00b2. Such models are discriminatory and can be bad for society. They can make wrong decisions and affect people\u2019s lives in a negative way. To solve this problem, you can start interpreting your models. Interpretability means that a human can understand the cause of the decision.", "A lot of research has been done on the interpretability of machine learning models. There are different ways to interpret your machine learning models. The easiest split is between interpretable models and model-agnostic methods. Interpretable models are models who explain themselves, for instance from a decision tree you can easily extract decision rules. Model-agnostic methods are methods you can use for any machine learning model, from support vector machines to neural nets. In this article, the focus will be on interpretable models, like linear regression, logistic regression and decision trees. Here\u2019s a different article about model-agnostic methods.", "A field where you can use model interpretability is health care. To find out how a model decides whether or not a person has heart disease, we use a dataset from the Cleveland database with the following features:", "We will try to predict the target with logistic regression and a decision tree and interpret the models we have built. You can find the Heart Disease UCI dataset on Kaggle.", "The code for this article about interpretable models (and for the article about model-agnostic methods) can be found on GitHub.", "Models you can interpret are, among others, linear regression models, logistic regression models and decision trees. So there is no need for a model-agnostic method in these cases, although you could use them too for more insights. We will build a logistic regression model and decision tree on the dataset and see how we can interpret the results, after a short note about linear regression.", "In linear regression you can use the weights (or coefficients) to find out which features are the most important, these are the features with the highest weight. If, for one record, you add one to a feature value while keeping the others the same the prediction will increase by the weight of the feature.", "For logistic regression, the way to interpret is a bit different because a coefficient is the natural logarithm of the odds ratio. To interpret the coefficients, you need to do the transformation from the coefficient to the odds ratio. We can use the functions below:", "According to the first two equations, we can replace b with ln(a), to get a. So if we raise e to the power of the natural logarithm of the odds ratio (equal to the coefficient we get from a logistic regression model), we get the odds ratio.", "Great! After this transformation, it\u2019s a bit the same as linear regression, but instead of increasing it when you change one feature value it will change by a factor. An odds ratio with a value around 1 has the least impact, while a higher or lower one has more influence\u00b3.", "So let\u2019s build a logistic regression model on the heart disease dataset to understand what happens. We got the following coefficients for each feature, and we can transform them (e raised to the power of the coefficient) to receive the odds ratio. You can see the values in the table below, the values are sorted in descending order:", "Now we can start interpreting the model:", "When results like this seems strange, the best thing to do is investigate your data. You might be wondering why age and cholesterol level have a really low impact. This model tells us that a higher cholesterol level is a bit better than a lower one. Is this the truth? The big difference between males and females also raises questions! To investigate this we could use a target plot, you can find one for the gender feature in the notebook on GitHub.", "Let\u2019s see what a decision tree shows us! Decision trees are like a rule system, you start in the root node and then you follow the path for a record to a leaf node where you can see the prediction. It\u2019s harder to interpret when your tree has a higher depth, but still doable.", "Below you can see an image of a decision tree, build on the heart disease dataset.", "On every decision node you see four lines with text. The first line represents the decision rule. If the condition is true for a record, you follow the left branche, if it\u2019s false, you follow the right one. Gini, on the second line, is the value of the Gini Impurity, the lower this value, the better the split\u2074. The third and fourth line show how many samples from the training set are in the current node and how they are divided. You might wonder what the colors mean. If a node is orange or blue, it means that for the largest part of the samples in this node the target variable (having a heart disease) is equal to zero or one, respectively. The darker the color, the more homogeneous the node.", "So let\u2019s take a record from the test set and follow the nodes of the tree to see what the final prediction will be. This is the new record:", "Let\u2019s start in the root node of the decision tree. The decision rule is: feature X\u2082 (cp, chest pain type) smaller than or equal to 0.5. For our new record, the value is 0, so smaller than 0.5. This statement is true and we follow the left branche. The following feature is X\u2081\u2081 (ca, number of major vessels colored by fluoroscopy), this value is greater than 0.5, so the statement is false and we continue to see if X\u2083 (trestbps, resting blood pressure) is smaller or equal to 109. This is not the case, since it is equal to 150. So false again. The next node checks if X\u2081 (sex) is smaller than 0.5. No, it\u2019s 1 for this record, he is male. Now we found the leaf node for this record, the prediction is 0. This prediction is correct! So for this record, the model uses only four features, cp, ca, trestbps and sex.", "Okay, that\u2019s a way to find out why one record has a certain prediction. With just the image of the tree, it\u2019s difficult to see which features are important to the model. We can extract feature importances of trees in different ways. The easiest way is to use the feature importances of scikit-learn. The importance of a feature is computed as the (normalized) total reduction of the criterion brought by that feature. It is also known as the Gini importance.", "Should you trust these feature importances? You could say that features like cp, ca, chol and age are really important in predicting a heart disease. It\u2019s possible they do, but first test your model! Keep in mind that those feature importances are based only on the training set and the current tree. The way feature importances are calculated in scikit-learn isn\u2019t the best one. It is better to use one of the model-agnostic methods, like permutation feature importance. Curious? Read about it in the next article about model-agnostic methods!", "[1] J. Dastin, Amazon scraps secret AI recruiting tool that showed bias against women (2018), Reuters", "[3] How do I interpret odds ratios in logistic regression?, UCLA: Statistical Consulting Group", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "\ud83d\udcc8 Data Scientist with a passion for math \ud83d\udcbb Currently working at IKEA and BigData Republic \ud83d\udca1 I share tips & tricks and fun side projects"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Faef0c7be3fd9&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finterpretable-machine-learning-models-aef0c7be3fd9&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finterpretable-machine-learning-models-aef0c7be3fd9&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finterpretable-machine-learning-models-aef0c7be3fd9&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finterpretable-machine-learning-models-aef0c7be3fd9&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----aef0c7be3fd9--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----aef0c7be3fd9--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://hennie-de-harder.medium.com/?source=post_page-----aef0c7be3fd9--------------------------------", "anchor_text": ""}, {"url": "https://hennie-de-harder.medium.com/?source=post_page-----aef0c7be3fd9--------------------------------", "anchor_text": "Hennie de Harder"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Ffb96be98b7b9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finterpretable-machine-learning-models-aef0c7be3fd9&user=Hennie+de+Harder&userId=fb96be98b7b9&source=post_page-fb96be98b7b9----aef0c7be3fd9---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Faef0c7be3fd9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finterpretable-machine-learning-models-aef0c7be3fd9&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Faef0c7be3fd9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finterpretable-machine-learning-models-aef0c7be3fd9&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@fabulu75?utm_source=medium&utm_medium=referral", "anchor_text": "Fabrice Villard"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://medium.com/@hennie_de_harder/model-agnostic-methods-for-interpreting-any-machine-learning-model-4f10787ef504", "anchor_text": "a different article"}, {"url": "https://www.kaggle.com/ronitf/heart-disease-uci", "anchor_text": "Heart Disease UCI dataset on Kaggle"}, {"url": "https://github.com/henniedeharder/interpretability-heart/blob/master/Demo_Forest_SHAP_Heart.ipynb", "anchor_text": "GitHub"}, {"url": "https://github.com/henniedeharder/interpretability-heart/blob/master/Demo_Forest_SHAP_Heart.ipynb", "anchor_text": "the notebook"}, {"url": "https://victorzhou.com/blog/gini-impurity/", "anchor_text": "Gini Impurity"}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.tree.DecisionTreeClassifier.html#sklearn.tree.DecisionTreeClassifier.feature_importances_", "anchor_text": "Gini importance"}, {"url": "https://medium.com/@hennie_de_harder/model-agnostic-methods-for-interpreting-any-machine-learning-model-4f10787ef504", "anchor_text": "the next article"}, {"url": "https://www.reuters.com/article/us-amazon-com-jobs-automation-insight/amazon-scraps-secret-ai-recruiting-tool-that-showed-bias-against-women-idUSKCN1MK08G", "anchor_text": "Amazon scraps secret AI recruiting tool that showed bias against women"}, {"url": "https://we.riseup.net/assets/404114/Weapons+of+Math+Destruction+Cathy+O%27Neil.pdf", "anchor_text": "Weapons Of Math Destruction"}, {"url": "https://stats.idre.ucla.edu/other/mult-pkg/faq/general/faq-how-do-i-interpret-odds-ratios-in-logistic-regression/", "anchor_text": "How do I interpret odds ratios in logistic regression?"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----aef0c7be3fd9---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/interpretability?source=post_page-----aef0c7be3fd9---------------interpretability-----------------", "anchor_text": "Interpretability"}, {"url": "https://medium.com/tag/decision-tree?source=post_page-----aef0c7be3fd9---------------decision_tree-----------------", "anchor_text": "Decision Tree"}, {"url": "https://medium.com/tag/logistic-regression?source=post_page-----aef0c7be3fd9---------------logistic_regression-----------------", "anchor_text": "Logistic Regression"}, {"url": "https://medium.com/tag/coefficient?source=post_page-----aef0c7be3fd9---------------coefficient-----------------", "anchor_text": "Coefficient"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Faef0c7be3fd9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finterpretable-machine-learning-models-aef0c7be3fd9&user=Hennie+de+Harder&userId=fb96be98b7b9&source=-----aef0c7be3fd9---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Faef0c7be3fd9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finterpretable-machine-learning-models-aef0c7be3fd9&user=Hennie+de+Harder&userId=fb96be98b7b9&source=-----aef0c7be3fd9---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Faef0c7be3fd9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finterpretable-machine-learning-models-aef0c7be3fd9&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----aef0c7be3fd9--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Faef0c7be3fd9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finterpretable-machine-learning-models-aef0c7be3fd9&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----aef0c7be3fd9---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----aef0c7be3fd9--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----aef0c7be3fd9--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----aef0c7be3fd9--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----aef0c7be3fd9--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----aef0c7be3fd9--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----aef0c7be3fd9--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----aef0c7be3fd9--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----aef0c7be3fd9--------------------------------", "anchor_text": ""}, {"url": "https://hennie-de-harder.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://hennie-de-harder.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Hennie de Harder"}, {"url": "https://hennie-de-harder.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "1K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Ffb96be98b7b9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finterpretable-machine-learning-models-aef0c7be3fd9&user=Hennie+de+Harder&userId=fb96be98b7b9&source=post_page-fb96be98b7b9--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F262470d3fe9a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finterpretable-machine-learning-models-aef0c7be3fd9&newsletterV3=fb96be98b7b9&newsletterV3Id=262470d3fe9a&user=Hennie+de+Harder&userId=fb96be98b7b9&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}