{"url": "https://towardsdatascience.com/time-to-change-data-track-your-personal-finance-with-power-bi-using-pivot-and-python-5839a6f804e7", "time": 1683003282.540163, "path": "towardsdatascience.com/time-to-change-data-track-your-personal-finance-with-power-bi-using-pivot-and-python-5839a6f804e7/", "webpage": {"metadata": {"title": "Time to Change (Data) \u2014 Track Your Personal Finance With Power BI Using Pivot and Python. | by Sebastian Zolg \ud83e\udd1d | Towards Data Science", "h1": "Time to Change (Data) \u2014 Track Your Personal Finance With Power BI Using Pivot and Python.", "description": "Wouldn\u2019t it be nice to learn something new about pivot and python in Power BI while building a better way to track your personal finance?"}, "outgoing_paragraph_urls": [{"url": "https://github.com/sebastianzolg/dynamic-pivot-in-powerbi", "anchor_text": "Github repository", "paragraph_index": 3}, {"url": "https://datachant.com/2018/05/14/automatic-detection-of-column-types-in-powerquery/", "anchor_text": "here", "paragraph_index": 34}, {"url": "http://sebastianzolg.de", "anchor_text": "sebastianzolg.de", "paragraph_index": 50}], "all_paragraphs": ["Wouldn\u2019t it be nice to learn something new about pivot and python in Power BI while building a better way to track your personal finance?", "If you want this Dashboard \ud83d\udc47 then this story is for you!", "Besides the fun part, we learn the following:", "Download the sample data from my Github repository.", "Let\u2019s have a quick look at our data.", "Open the personal-spendings.xlsx file in Excel and notice its simple structure. The idea is to make it easy for you to add data from various different places like your bank account or any project you\u2019re working on.", "Feel free to add as many details as you want, but keep it simple to enter the data so tracking it is not too hard. We let Power BI do the heavy work for us.", "Pivot is the process of transforming our data dimensions into a new form. In our case, we want our initial Categories as a feature matrix with the Amount as the values.", "The challenge with a pivot in Power BI is the effort needed to introduce new labels (columns) after initial modeling.", "This is because Power BI references columns and other elements statically by name. This forces us to touch our model every time we introduce a new category. We need a solution for this!", "In Power BI, click Get Data, select Excel and click Connect. Open the sample data from my Github repository or choose your own dataset.", "Select the Finance spreadsheet, review the data and click Transform.", "As a first step, we transform our columns Month and Year into one single Date column.", "Select both columns and click Merge Columns.", "Select Custom as the separator type and use a slash (/) as the separator. Name the column Date and hit the OK button. Done!", "Now it is time to pivot our data into the target structure where the Categories become our columns, and the Amount our values.", "Make sure you\u2019ve selected the Category column, then click Pivot Column.", "Select Amount from the values drop-down field. In case we have multiple entries in the same month, we want Power BI to use Sum as the aggregation function.", "The result should look like on the screen below.", "To address our requirements we use a single Python script in Power BI.", "Click Run Python script and insert the script below.", "Let\u2019s break it down and see what this python script does for us.", "First, we dynamically select all columns that have data type number. This way we don\u2019t hard reference any column and can easily add new ones.", "Next, we replace all our null values with the number 0.", "Now that we have all numeric columns already selected, we simply call the abs() function on all its rows to convert all negative numbers into its absolute equivalent.", "Finally, we sum up all rows and their numeric columns. We store the result in a new column called GrandTotal.", "To use the result we click Table to expand the dataset.", "After running the Python Snippet, Power BI tried to auto-detect the data types and didn\u2019t do a good job here.", "Furthermore, this step added a hard reference to named columns.", "As we want it to be fully dynamic, we remove the Change Type step from the Applied Steps panel by clicking the X icon next to it.", "Wait a moment! How can we dynamically type data when we\u2019re not able to use Power BI type detection for this? We need a function!", "Right-click on the Queries panel and select New Query > Blank Query.", "First, we give our new query function a nice name, something like AutoDetectAndTransformTypes.", "Next, we bring up the editor by clicking the Advanced Editor icon. Insert the script below and click Done.", "How does this work? This script is inspired by the article here. Kudos to the author. The article explains very well, what the script does. However, I introduced some simplifications and another way of type detection.", "In short, the script goes over every column and tries to infer the correct data type by checking each value. It then builds a map of columns and data types and passes it back to Power BI.", "Now we invoke this function by clicking the fx icon in the formula bar.", "Don\u2019t see the formula bar? Go to View and check the box next to Formula Bar.", "To invoke the function on our dataset enter the formula below and hit enter.", "Done! As you can see, our function worked very well and converted all numeric values to type Decimal Number and the date field to type date.", "To start visualizing your data, click Close & Apply.", "Now that we have the data in such an easy shape we can easily build a nice-looking report. I leave it with you to do it yourself.", "In case you don\u2019t want to do it yourself, I\u2019ve put the Power BI template next to the data file in my Github repository. Simply clone the whole repository and open the dynamic-pivot-in-powerbi.pbit file from the same directory.", "Thanks to our pivoted model, this is all drag and drop of visuals. No-code or formula needed.", "Let\u2019s see the power of this solution in action. Open the raw data in Excel and introduce any new Category at the bottom of the list. Don\u2019t forget to save it.", "Back in Power BI, the only thing you have to do is to refresh your data.", "Hit Refresh, select any visual on your dashboard and see the newly added category automatically appear in your Fields list. Tick the box next to it and you\u2019re done.", "Of course, this field is also part of the Grand Total calculation. Everything is fully dynamic.", "That\u2019s it! You did a great job.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "I\u2019m an IT professional with experience in enterprise mobility, workplace, cloud technologies, and software development. sebastianzolg.de"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F5839a6f804e7&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftime-to-change-data-track-your-personal-finance-with-power-bi-using-pivot-and-python-5839a6f804e7&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftime-to-change-data-track-your-personal-finance-with-power-bi-using-pivot-and-python-5839a6f804e7&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftime-to-change-data-track-your-personal-finance-with-power-bi-using-pivot-and-python-5839a6f804e7&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftime-to-change-data-track-your-personal-finance-with-power-bi-using-pivot-and-python-5839a6f804e7&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----5839a6f804e7--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----5839a6f804e7--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@sebastian.zolg?source=post_page-----5839a6f804e7--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@sebastian.zolg?source=post_page-----5839a6f804e7--------------------------------", "anchor_text": "Sebastian Zolg \ud83e\udd1d"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F57d0ca35a604&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftime-to-change-data-track-your-personal-finance-with-power-bi-using-pivot-and-python-5839a6f804e7&user=Sebastian+Zolg+%F0%9F%A4%9D&userId=57d0ca35a604&source=post_page-57d0ca35a604----5839a6f804e7---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F5839a6f804e7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftime-to-change-data-track-your-personal-finance-with-power-bi-using-pivot-and-python-5839a6f804e7&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F5839a6f804e7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftime-to-change-data-track-your-personal-finance-with-power-bi-using-pivot-and-python-5839a6f804e7&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://github.com/sebastianzolg/dynamic-pivot-in-powerbi", "anchor_text": "Github repository"}, {"url": "https://github.com/sebastianzolg/dynamic-pivot-in-powerbi", "anchor_text": "sebastianzolg/dynamic-pivot-in-powerbigithub.com"}, {"url": "https://datachant.com/2018/05/14/automatic-detection-of-column-types-in-powerquery/", "anchor_text": "here"}, {"url": "https://medium.com/tag/power-bi?source=post_page-----5839a6f804e7---------------power_bi-----------------", "anchor_text": "Power Bi"}, {"url": "https://medium.com/tag/microsoft?source=post_page-----5839a6f804e7---------------microsoft-----------------", "anchor_text": "Microsoft"}, {"url": "https://medium.com/tag/citizen-data-scientist?source=post_page-----5839a6f804e7---------------citizen_data_scientist-----------------", "anchor_text": "Citizen Data Scientist"}, {"url": "https://medium.com/tag/office-365?source=post_page-----5839a6f804e7---------------office_365-----------------", "anchor_text": "Office 365"}, {"url": "https://medium.com/tag/data-science?source=post_page-----5839a6f804e7---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F5839a6f804e7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftime-to-change-data-track-your-personal-finance-with-power-bi-using-pivot-and-python-5839a6f804e7&user=Sebastian+Zolg+%F0%9F%A4%9D&userId=57d0ca35a604&source=-----5839a6f804e7---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F5839a6f804e7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftime-to-change-data-track-your-personal-finance-with-power-bi-using-pivot-and-python-5839a6f804e7&user=Sebastian+Zolg+%F0%9F%A4%9D&userId=57d0ca35a604&source=-----5839a6f804e7---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F5839a6f804e7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftime-to-change-data-track-your-personal-finance-with-power-bi-using-pivot-and-python-5839a6f804e7&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----5839a6f804e7--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F5839a6f804e7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftime-to-change-data-track-your-personal-finance-with-power-bi-using-pivot-and-python-5839a6f804e7&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----5839a6f804e7---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----5839a6f804e7--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----5839a6f804e7--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----5839a6f804e7--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----5839a6f804e7--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----5839a6f804e7--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----5839a6f804e7--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----5839a6f804e7--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----5839a6f804e7--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@sebastian.zolg?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@sebastian.zolg?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Sebastian Zolg \ud83e\udd1d"}, {"url": "https://medium.com/@sebastian.zolg/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "189 Followers"}, {"url": "http://sebastianzolg.de", "anchor_text": "sebastianzolg.de"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F57d0ca35a604&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftime-to-change-data-track-your-personal-finance-with-power-bi-using-pivot-and-python-5839a6f804e7&user=Sebastian+Zolg+%F0%9F%A4%9D&userId=57d0ca35a604&source=post_page-57d0ca35a604--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F51d6dfcfa94d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftime-to-change-data-track-your-personal-finance-with-power-bi-using-pivot-and-python-5839a6f804e7&newsletterV3=57d0ca35a604&newsletterV3Id=51d6dfcfa94d&user=Sebastian+Zolg+%F0%9F%A4%9D&userId=57d0ca35a604&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}