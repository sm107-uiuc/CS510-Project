{"url": "https://towardsdatascience.com/how-to-build-an-image-automatic-rotator-in-24-hours-3137769f240c", "time": 1683013214.950541, "path": "towardsdatascience.com/how-to-build-an-image-automatic-rotator-in-24-hours-3137769f240c/", "webpage": {"metadata": {"title": "How to build an image automatic rotator in 24 hours | by Ricardo Pinto | Towards Data Science", "h1": "How to build an image automatic rotator in 24 hours", "description": "Recently, I was challenged to do this task which basically asked to use neural networks to predict the image orientation (upright, upside down, left or right) and with that prediction rotate the\u2026"}, "outgoing_paragraph_urls": [{"url": "https://gist.github.com/csaftoiu/9fccaf47fd8f96cd378afd8fdd0d63c1", "anchor_text": "task", "paragraph_index": 0}, {"url": "https://github.com/Rpinto02/Image_Rotator", "anchor_text": "here", "paragraph_index": 23}], "all_paragraphs": ["Recently, I was challenged to do this task which basically asked to use neural networks to predict the image orientation (upright, upside down, left or right) and with that prediction rotate the image to the correct position (upright), all of this in 24 hours!", "My experience with neural networks up to this point was using the Multi-layer Perceptron inside Scikit-learn, and I had never tackled image processing. Which meant it was time to bang my head against the wall!", "The training set was composed of approximately 50 thousand images with their label stored in a csv that looked like this:", "In the challenge description it was hinted the use of the CIFAR10 model and the respective example on Keras. So, for a neural network beginner like myself, this was a huge leap.", "The plus side of neural networks is that there is no need to reinvent the wheel, there are already many pre-trained networks for diverse purposes and they are available for anyone.", "With one problem solved, but still running against time, I had focus on the image processing.", "Well, several hours, stackoverflow posts and image processing test functions later, I was finally able to convert these images into vectors, however I still needed to attach the label to each vector. At this point desperation took over.", "I needed a process that: read the file, transformed the name of the file into a string, read the csv which entry matched the file to then read the label and add it to the image converted vector.", "However, even an image reduced to 32x32 represents a 3072 size vector (32x32x3, you have to remember that each pixel has a value for green, red and blue), this meant repeating the process described above in a 3073 features (vector + label) per roughly 50 thousand rows matrix, which was enough for my modest local machine to roll over the corner and cry. This only increased the despair.", "But I decided that at the very least I would learn how to solve this issue in the remaining 16 hours. Further investigation and a couple of failed tests later I found the Image Data Generator from Keras, and let me tell you: what a delightful tool!", "Image processing has a series of implications due to its size and complexity, but with this tool everything is solved with the right parameters.", "We can simply transform the file with the image\u2019s label and store it into a pandas dataframe, set the path to the images, set the size to convert the images into, set if it\u2019s the training or validation set, and we can even set batch size for this process, solving our local machine issues. This among many other options, like reading the image\u2019s labels through distinct folders, or convert the images into a grey scale.", "We repeat this for the train and validation sets and we are good to go to train a neural network with only a dozen lines of code, like the following.", "This was when I finally saw the light at the end of the tunnel.", "There were still 10 hours to go, but I had still had to run the model, evaluate it and use it to correct the images in the test set (with no label).", "After setting the epochs and steps per epoch it was time to \u201csleep\u201d dreaming with neural networks and image processing, while the model run.", "3 hours remaining and a 95,94% accuracy it was time to start wrapping things and build an image rotator, a repository and document everything to complete the challenge.", "1,5 hours to the end and the moment of truth arrived, testing the rotator:", "Nice, it seems to be working! \ud83d\udcaa", "Not only that, it is perfect! \u2728", "Afterwards I saved the corrected images, organized the repository and submitted the challenge with only 3 minutes left.", "Till this day no one replied me saying how the model behaved in the test set, but one thing is certain I learnt two important lessons:", "One, the Image Data Generator from Keras is an excellent tool, and second, a good portion of the solving process in a data science challenge is to find the right tools for that problem.", "My solution for this challenge can be found here.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Scientist with a civil engineering background. Water polo player. Loves ML/AI, data, decision science, gaming, manga."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F3137769f240c&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-build-an-image-automatic-rotator-in-24-hours-3137769f240c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-build-an-image-automatic-rotator-in-24-hours-3137769f240c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-build-an-image-automatic-rotator-in-24-hours-3137769f240c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-build-an-image-automatic-rotator-in-24-hours-3137769f240c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----3137769f240c--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----3137769f240c--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://rpinto02.medium.com/?source=post_page-----3137769f240c--------------------------------", "anchor_text": ""}, {"url": "https://rpinto02.medium.com/?source=post_page-----3137769f240c--------------------------------", "anchor_text": "Ricardo Pinto"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fb7d6719f9ca0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-build-an-image-automatic-rotator-in-24-hours-3137769f240c&user=Ricardo+Pinto&userId=b7d6719f9ca0&source=post_page-b7d6719f9ca0----3137769f240c---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F3137769f240c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-build-an-image-automatic-rotator-in-24-hours-3137769f240c&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F3137769f240c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-build-an-image-automatic-rotator-in-24-hours-3137769f240c&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@urielsc26", "anchor_text": "Uriel SC"}, {"url": "https://unsplash.com/", "anchor_text": "Unsplash"}, {"url": "https://gist.github.com/csaftoiu/9fccaf47fd8f96cd378afd8fdd0d63c1", "anchor_text": "task"}, {"url": "https://gotwarcraft.com/ten-tips-earning-more-gold-wow/", "anchor_text": "gotwarcraft"}, {"url": "https://github.com/Rpinto02/Image_Rotator", "anchor_text": "here"}, {"url": "https://medium.com/tag/data-science?source=post_page-----3137769f240c---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/neural-networks?source=post_page-----3137769f240c---------------neural_networks-----------------", "anchor_text": "Neural Networks"}, {"url": "https://medium.com/tag/image-processing?source=post_page-----3137769f240c---------------image_processing-----------------", "anchor_text": "Image Processing"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F3137769f240c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-build-an-image-automatic-rotator-in-24-hours-3137769f240c&user=Ricardo+Pinto&userId=b7d6719f9ca0&source=-----3137769f240c---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F3137769f240c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-build-an-image-automatic-rotator-in-24-hours-3137769f240c&user=Ricardo+Pinto&userId=b7d6719f9ca0&source=-----3137769f240c---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F3137769f240c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-build-an-image-automatic-rotator-in-24-hours-3137769f240c&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----3137769f240c--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F3137769f240c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-build-an-image-automatic-rotator-in-24-hours-3137769f240c&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----3137769f240c---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----3137769f240c--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----3137769f240c--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----3137769f240c--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----3137769f240c--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----3137769f240c--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----3137769f240c--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----3137769f240c--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----3137769f240c--------------------------------", "anchor_text": ""}, {"url": "https://rpinto02.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://rpinto02.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Ricardo Pinto"}, {"url": "https://rpinto02.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "76 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fb7d6719f9ca0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-build-an-image-automatic-rotator-in-24-hours-3137769f240c&user=Ricardo+Pinto&userId=b7d6719f9ca0&source=post_page-b7d6719f9ca0--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Ff971a30ee17b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-build-an-image-automatic-rotator-in-24-hours-3137769f240c&newsletterV3=b7d6719f9ca0&newsletterV3Id=f971a30ee17b&user=Ricardo+Pinto&userId=b7d6719f9ca0&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}