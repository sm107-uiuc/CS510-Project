{"url": "https://towardsdatascience.com/building-a-crypto-ml-web-app-5f7dd1442568", "time": 1683007370.535319, "path": "towardsdatascience.com/building-a-crypto-ml-web-app-5f7dd1442568/", "webpage": {"metadata": {"title": "Building a Crypto ML Web App. Predicting Ethereum investor profile\u2026 | by Jan Osolnik | Towards Data Science", "h1": "Building a Crypto ML Web App", "description": "This project aims to connect the Ethereum dataset, machine learning, and cloud technologies in a single project. The outcome is an unsupervised ML data product, accessible through a web UI. It\u2026"}, "outgoing_paragraph_urls": [{"url": "https://github.com/josolnik/MLND", "anchor_text": "Github", "paragraph_index": 1}, {"url": "https://en.wikipedia.org/wiki/Investor_profile", "anchor_text": "an investor profile", "paragraph_index": 4}, {"url": "https://cloud.google.com/blog/products/data-analytics/ethereum-bigquery-public-dataset-smart-contract-analytics", "anchor_text": "available on BigQuery", "paragraph_index": 5}, {"url": "https://etherscan.io/chart/address", "anchor_text": "100 million unique Ethereum addresses", "paragraph_index": 11}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.metrics.silhouette_score.html", "anchor_text": "Silhouette score", "paragraph_index": 13}, {"url": "https://pandas-gbq.readthedocs.io/en/latest/", "anchor_text": "Pandas_gbq", "paragraph_index": 24}, {"url": "https://googleapis.dev/python/bigquery/latest/index.html", "anchor_text": "Google-cloud-bigquery", "paragraph_index": 24}, {"url": "https://scikit-learn.org/stable/", "anchor_text": "Scikit-learn", "paragraph_index": 24}, {"url": "https://github.com/blockchain-etl/awesome-bigquery-views", "anchor_text": "Awesome Bigquery views", "paragraph_index": 27}], "all_paragraphs": ["This project aims to connect the Ethereum dataset, machine learning, and cloud technologies in a single project. The outcome is an unsupervised ML data product, accessible through a web UI. It predicts the investor profile (cluster) based on the features constructed on-the-fly with the provided Ethereum address and its publicly available data.", "The project code is available on Github.", "The project combines blockchain data, machine learning, and cloud managed services into a final product as a web app. Ethereum data is available as a GCP public dataset.", "The web app predicts the investor profile (cluster) of an Ethereum address that is entered in the user interface. This is based on three features that are extracted from the data source: Current balance, unique transfers, and unique tokens held.", "In the finance lingo, an investor profile defines an individual\u2019s preference in investing decisions. Examples of this are risk-averse/risk-tolerant, diversity of asset classes and individual assets, investment in growth stocks or value stocks, etc. In this project, it refers to any kind of investing behavior that can be quantified and used to differentiate between different Ethereum addresses.", "The data is available on BigQuery and is ready to be used. The challenge is in modeling the data and using it to feed the ML models. The data is not labeled which is why the problem is formulated as an unsupervised machine learning task. As pricing data is both more accessible and monetizable, most of the crypto machine learning projects focus on predicting that.", "On the other hand, this project focuses on behavioral footprints of individual addresses (investors) and clustering them based on available transactional data.", "AWS's cloud services were used to provide the model in the web UI. AWS SageMaker for all the machine learning steps and to serve the model as a prediction endpoint. This is then triggered as a Lambda function through the deployed API endpoint with API Gateway. This endpoint is used to predict the Ethereum investor profile in the web UI.", "While the data on public blockchains are open, there are not many machine learning applications yet (apart from price predictions) that leverage them. One of the reasons is that the underlying data structures are based on OLTP systems which are difficult to analyze (as opposed to OLAP).", "For every transaction that is executed on the public blockchains, there is a trace that we can analyze. As opposed to other asset classes, we have available data into the behavior of individual investors. The aim of the project is to answer the question:", "Can we use the principle of BYOD (bring your own data) and cluster an Ethereum investor only with the provided address?", "Considering the complexity of the problem, I didn't expect to get results that would be necessarily insightful. There are currently almost 100 million unique Ethereum addresses which are highly diverse. The goal was to build a workable solution. And for that, some assumptions needed to be made.", "One core (over)simplifying assumption is that one address equals one investor. This is hard to argue as there are many subgroups in the Ethereum ecosystem such as miners, exchanges, and ICO wallets. Meanwhile, differentiating between those is beyond the scope of this project which focuses on building a proof of concept pipeline.", "With a given number of clusters, each model clusters all the sampled Ethereum addresses into separate clusters. The metric used in this project is the Silhouette score. The coefficient is calculated using the mean intra-cluster distance and the mean nearest-cluster distance for each sample. This is ideal for the use-case as we don\u2019t have ground truth values available.", "A sample of 10000 Ethereum addresses is extracted. As some of them don\u2019t satisfy the further conditions in the specified query, about 8000 are available in the data frame. As is visible in the below table, the minimum threshold for ether_balance is 1 Ether. This was an arbitrarily set boundary as a lot of Ethereum addresses have a zero balance.", "The mean is 138 Ether (at the moment about 25k euros as of May 15, 2020) which indicates the skewness of the distribution when we look at the 75th percentile value. While the 75th percentile is less than 13 Ether, the average is 138. There are clearly some strong outliers in the sample such as the largest value with 300000 Ether balance.", "The unique_tokens feature is not as dispersed at the Ether balance. The usual value varies from 2 unique tokens to 8 tokens held.", "The Unique_transfers feature varies widely. While the mean number of transfers is 26, the largest amount is 28560. We can see that the top 25% of addresses generate most of the transfers as none of the addresses in the 75 percentile has more than 1 transfer.", "Below is a scatter matrix below for all constructed features. As it\u2019s clear in the visualization, there is a power-law distribution present in both eth_balance and unique_transfers features. The vast majority of the cumulative value of both is generated by a minority of addresses.", "Meanwhile, there is not much correlation visible between different features.", "There is a correlation heatmap below for all available features. As was already indicated above, there is little correlation between different features. That\u2019s a positive sign as we want to explore different areas of the feature space with different features. If there would be a strong correlation we could be explaining the same phenomena with different features.", "The techniques used to predict clusters are all unsupervised machine learning algorithms. The chosen ones are K-means, Gaussian Mixture Models, and Hierarchical clustering.", "As in K-means, the boundaries between clusters are always linear, the other two algorithms are used to handle more complicated boundaries. Also, the possibility to extend the analysis further by measuring the probability or uncertainty of cluster assignments. This is not done in the analysis but it\u2019s a possible extension.", "The benchmark model for the project is the K-means algorithm\u2019s Silhouette Score. After that, more sophisticated algorithms are used to compare the performance. As a rule of thumb, a Silhouette score of 0.5 is defined as a threshold for the solution to be considered with a reasonable performance.", "There are quite a few Python modules used in the project. Meanwhile, these are some that are core for the implementation. Pandas_gbq library was used to query the BigQuery Ethereum data source. Google-cloud-bigquery was used to authenticate into the GCP service account. Scikit-learn was used as a tool for all models.", "AWS services used in the project:", "Two tables from the Ethereum public data source are used:", "Awesome Bigquery views Github page was used to construct the SQL queries and get a better understanding of the Ethereum data model.", "Below we can see some examples for the constructed features for different Ethereum addresses.", "After that, Sklearn\u2019s pipeline functionality is used to preprocess the features. We normalize them to make sure that the features are useful to feed into the models. This is done by using power transform, standard scaling, and PCA transformation. PCA transformation might be redundant here as there are only three features mapped to three components but can be useful if the feature set is expanded and the dimensionality needs to be reduced considering the sample size.", "With the final set of features, all three clustering algorithm alternatives are trained: K-means model, GMM model, and Hierarchical clustering model.", "The visualization below plots the number of instances in each of the 4 clusters.", "The chosen number of clusters is 4. It\u2019s chosen based on trial and error of different values. As the performance of alternative algorithms doesn\u2019t improve the Silhouette coefficient considerably, K-means is used in the solution that is used in the model that is deployed.", "After the training using the training script, the trained model\u2019s metadata is combined with the prediction script to predict the cluster value of individual Ethereum addresses.", "The prediction script performs on-the-fly calculation of feature values of the provided Ethereum address. It queries the Ethereum data source and returns the normalized feature values. These are then used as input into the trained model which returns the predicted cluster value.", "The final solution is a prediction endpoint triggered as a Lambda function through the API Gateway. The Lambda function is a cloud function based on a serverless architecture. It is deployed through the API Gateway as an API that can be used in the user interface of the web app.", "Whenever a user enters an Ethereum address and presses the Submit button, the predicted cluster value is shown in the user interface.", "The final result is a web app that returns an investor profile based on the user\u2019s provided Ethereum address. The user doesn\u2019t need to provide any of their own personal data as all data that is needed can be extracted from the publicly-available Ethereum data source.", "The models are evaluated based on the Silhouette score. As there are currently more than 100 million existing Ethereum addresses, it is hard to reliably sample the addresses without making some explicit rules such as filtering out non-trivial balance amounts.", "The model is evaluated empirically with the chosen metric. K-means\u2019s Silhouette score is 0.38. As there are no ground truth values available there is no way to test this objectively in a scalable manner. On the other hand, the chosen metric quantifies well how different clusters are differentiated in the feature space.", "The final solution is tested in a web app where the predicted cluster value is extracted for a sample Ethereum address.", "Considering the performance it\u2019s clear that there is not enough variance in the data extracted to be able to create interpretable clusters. When looking at different clusters it was not possible to find meaningful naming of clusters either.", "The 0.5 thresholds for the Silhouette coefficient are not achieved which means that considering this metric we can\u2019t describe the models to have a strong grasp of the underlying data. Meanwhile, the main goal of the project was to build a minimum viable solution that can then be improved.", "The biggest bottlenecks of performance are the features that are fed into the models. With a better understanding of the underlying data model, we could construct a better feature set.", "Besides that, the preprocessing could be improved. Besides that, the number of clusters was chosen with trial and error with the same values across all algorithms. This could be sped up by using some more sophisticated analysis (Silhouette analysis).", "This project shows how it's possible to relatively quickly set up a machine learning pipeline and provide it as a data product in the web UI.", "Considering the maturation of both data science and crypto industries, we will slowly see a shift where it will become more common to bring these technologies together in a way that was not possible before.", "With cloud-managed services, a lot of complexity is abstracted away which helps data scientists who are often not trained in software engineering and DevOps/MLOps. Besides that, high-level APIs can help engineers build data products that were previously available only to specialized data professionals. With the progress of these domains, we can see a great deal of learning from each other which will enable a new paradigm of software products.", "Some other projects working on crypto data solutions:", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F5f7dd1442568&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-a-crypto-ml-web-app-5f7dd1442568&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-a-crypto-ml-web-app-5f7dd1442568&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-a-crypto-ml-web-app-5f7dd1442568&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-a-crypto-ml-web-app-5f7dd1442568&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----5f7dd1442568--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----5f7dd1442568--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://josolnik.medium.com/?source=post_page-----5f7dd1442568--------------------------------", "anchor_text": ""}, {"url": "https://josolnik.medium.com/?source=post_page-----5f7dd1442568--------------------------------", "anchor_text": "Jan Osolnik"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fdf462b6141b9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-a-crypto-ml-web-app-5f7dd1442568&user=Jan+Osolnik&userId=df462b6141b9&source=post_page-df462b6141b9----5f7dd1442568---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F5f7dd1442568&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-a-crypto-ml-web-app-5f7dd1442568&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F5f7dd1442568&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-a-crypto-ml-web-app-5f7dd1442568&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/", "anchor_text": "Unsplash"}, {"url": "https://github.com/josolnik/MLND", "anchor_text": "Github"}, {"url": "https://en.wikipedia.org/wiki/Investor_profile", "anchor_text": "an investor profile"}, {"url": "https://cloud.google.com/blog/products/data-analytics/ethereum-bigquery-public-dataset-smart-contract-analytics", "anchor_text": "available on BigQuery"}, {"url": "https://etherscan.io/chart/address", "anchor_text": "100 million unique Ethereum addresses"}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.metrics.silhouette_score.html", "anchor_text": "Silhouette score"}, {"url": "https://pandas-gbq.readthedocs.io/en/latest/", "anchor_text": "Pandas_gbq"}, {"url": "https://googleapis.dev/python/bigquery/latest/index.html", "anchor_text": "Google-cloud-bigquery"}, {"url": "https://scikit-learn.org/stable/", "anchor_text": "Scikit-learn"}, {"url": "https://github.com/blockchain-etl/awesome-bigquery-views", "anchor_text": "Awesome Bigquery views"}, {"url": "https://www.udacity.com/course/machine-learning-engineer-nanodegree--nd009t", "anchor_text": "Udacity MLND"}, {"url": "https://github.com/willprice221/ethereum_clustering", "anchor_text": "Clustering Ethereum addresses"}, {"url": "https://github.com/ShrutiAppiah/crypto-forecasting-with-neuralnetworks", "anchor_text": "Crypto price prediction"}, {"url": "https://www.kaggle.com/mrisdal/visualizing-average-ether-costs-over-time", "anchor_text": "Querying Ethereum data 101"}, {"url": "https://github.com/blockchain-etl/token-recommender", "anchor_text": "Token recommender"}, {"url": "https://medium.com/intotheblock/machine-learning-for-cryptocurrencies-challenges-and-opportunities-slide-deck-video-and-ideas-9fd281adbe1c", "anchor_text": "Machine learning for crypto-currencies"}, {"url": "https://medium.com/tag/data-science?source=post_page-----5f7dd1442568---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/cryptocurrency?source=post_page-----5f7dd1442568---------------cryptocurrency-----------------", "anchor_text": "Cryptocurrency"}, {"url": "https://medium.com/tag/ethereum?source=post_page-----5f7dd1442568---------------ethereum-----------------", "anchor_text": "Ethereum"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----5f7dd1442568---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/aws?source=post_page-----5f7dd1442568---------------aws-----------------", "anchor_text": "AWS"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F5f7dd1442568&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-a-crypto-ml-web-app-5f7dd1442568&user=Jan+Osolnik&userId=df462b6141b9&source=-----5f7dd1442568---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F5f7dd1442568&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-a-crypto-ml-web-app-5f7dd1442568&user=Jan+Osolnik&userId=df462b6141b9&source=-----5f7dd1442568---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F5f7dd1442568&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-a-crypto-ml-web-app-5f7dd1442568&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----5f7dd1442568--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F5f7dd1442568&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-a-crypto-ml-web-app-5f7dd1442568&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----5f7dd1442568---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----5f7dd1442568--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----5f7dd1442568--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----5f7dd1442568--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----5f7dd1442568--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----5f7dd1442568--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----5f7dd1442568--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----5f7dd1442568--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----5f7dd1442568--------------------------------", "anchor_text": ""}, {"url": "https://josolnik.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://josolnik.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Jan Osolnik"}, {"url": "https://josolnik.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "259 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fdf462b6141b9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-a-crypto-ml-web-app-5f7dd1442568&user=Jan+Osolnik&userId=df462b6141b9&source=post_page-df462b6141b9--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F4527b1f0f44f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-a-crypto-ml-web-app-5f7dd1442568&newsletterV3=df462b6141b9&newsletterV3Id=4527b1f0f44f&user=Jan+Osolnik&userId=df462b6141b9&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}