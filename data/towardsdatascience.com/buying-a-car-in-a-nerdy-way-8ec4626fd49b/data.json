{"url": "https://towardsdatascience.com/buying-a-car-in-a-nerdy-way-8ec4626fd49b", "time": 1683011358.413832, "path": "towardsdatascience.com/buying-a-car-in-a-nerdy-way-8ec4626fd49b/", "webpage": {"metadata": {"title": "Buying a car (in a nerdy way). Nerd search engine to find good deals\u2026 | by Cintia Bruscantini | Towards Data Science", "h1": "Buying a car (in a nerdy way)", "description": "I\u2019m not one of those people who can name a car\u2019s model, brand, year, by seeing the car\u2019s optics (or by seeing the whole car for that matter). So when having to make a selection of which car to buy\u2026"}, "outgoing_paragraph_urls": [{"url": "https://shap.readthedocs.io/en/latest/", "anchor_text": "SHAP library", "paragraph_index": 11}, {"url": "https://towardsdatascience.com/explain-your-model-with-the-shap-values-bc36aac4de3d", "anchor_text": "click here", "paragraph_index": 11}], "all_paragraphs": ["I\u2019m not one of those people who can name a car\u2019s model, brand, year, by seeing the car\u2019s optics (or by seeing the whole car for that matter). So when having to make a selection of which car to buy, out of thousands of options available, my selection will be as good as random. I can go online, scroll through a bunch of photos, but they all kind of look the same to me.", "So I decided to do what I know best, solve the problem in the nerdiest way. :)", "My goal is to buy a second-hand car that maximizes the value I can get for a specific budget I have in mind. Again, I have no idea what value is in this context, because I have no clue about cars. But let\u2019s assume there is a function y = f(X) that can tell us the price (y) of a car given the car\u2019s characteristics (X, aka features). Value is not an objective metric, it is how much the \u201cmarket thinks\u201d that the price of a car should change by adding/removing a specific feature (e.g. 3-door vs. 5-door car). The \u201cmarket thinks\u201d is what people collectively agree, mathematically the expectation of the distribution of the price difference of a car with and without a given feature.", "In a \u201cperfectly-knowledgable\u201d world, everyone would know the function y = f(X), and use it to set the price of the car they want to sell.", "Although there are online price calculators and tables with model-year-km price recommendations (which are approximations to y = f(X)), not everyone goes through the process of estimating their car price in this way. Moreover, the perception of value of a specific buyer or a seller might be different (y\u2019=f\u2019(X)) than what the market thinks (y = f(X)). E.g., a seller might assign some value to selling the car today as opposed to waiting, for which she is willing to drop the car\u2019s price, but I, as a buyer, have no value attached to that, so I will see this car as a sale opportunity.", "Because I have no particular personal thoughts on my own price-value relation (y\u2019=f\u2019(X)), I\u2019ll try to find what the market thinks (y=f(X)) for those features I care about (X*). For example, I don\u2019t mind about the car\u2019s color, but let\u2019s assume that white cars tend to be cheaper, and let\u2019s assume that I don\u2019t know about that. Because the car\u2019s color is not in X*, y*=f(X*) will not make any distinction on price between the same car on white or black version, and y* will be somewhere in between (depending on the amount of white and black cars I use to find the function y*=f(X*)). When checking the actual asking price of the white (y_white) and the black (y_black) car, I should find that y_white<y*<y_black. Thus, I can use the difference between the actual price and the predicted price to find what would look like good deals for me. The more negative the y_actual-y*, the better the deal is. In our example, y_white-y*<0 and y_black-y*>0. Therefore, the final output of such a process will be the suggestion to \u201cbuy a white car\u201d.", "All of this long introduction is the justification why building a model (i.e. estimating y*=f(X*)) to predict second-hand car prices can help an inexpert person like me to make a data-driven decision, without really having to learn about cars, trusting that \u201cthe market\u201d has all the relevant information on the data and I can extract it to make a more informed decision.", "The features (X*) I considered for building the model were:", "The model trained is a simple GradientBoostingRegressor, with a grid-search for hyperparameter tuning, and k-fold cross-validation.", "In order to know which of the features is more relevant to predict car prices, one can check the model\u2019s feature importance plot:", "Seems that the starting price point (price when the car was new) is the most relevant thing to know in order to predict second-hand car prices, followed by how old the car is and what is its mileage.", "One can also use the SHAP library to have a better understanding of what is the relation between the features and the prediction. There is a nice explanation of SHAP values in this article: click here.", "For instance, in the SHAP summary plot, one can see that the price predicted is mostly impacted by the original price of the car: the lower the original price (blueish color), the lower the price predicted (SHAP value below 0). The SHAP value of a feature represents how much knowing that feature\u2019s value changes the output of the model for that sample\u2019s prediction. Numerical features have a straightforward explanation, but categorical features are a little harder to interpret because they were Label Encoded, i.e. category strings were converted to numbers. For example, label encoding the feature transmission transforms \u201cautomatic\u201d to 0 and \u201cmanual\u201d to 1; so transmission redish points correspond to higher values, thus 1: manual. The price predicted difference between transmission redish points (manual) and blueish ones (automatic) is roughly 1000\u20ac. This ~1k\u20ac is the value the market assigns for a car having an automatic gearbox instead of a manual one.", "The SHAP dependency plots show the effect a single feature has on the price predicted by the model. Each dot in the plot is a single prediction on the dataset. The value in the x-axis is the feature and the y-axis is the SHAP value for that feature. The color corresponds to a second feature that may have an interaction effect with the feature we are plotting. For example, the original price seems to have a non-linear relationship with the price predicted: the higher the original price, the higher the prediction, but going from a 15k\u20ac to 20k\u20ac new car price increases the second-hand car predicted price more than going from 35k\u20ac to 40k\u20ac (roughly 1k\u20ac vs. 500\u20ac). In the same plot, one can see that for the same original price, e.g. 20k\u20ac, the higher the mileage, the lower the price predicted, and that difference can have roughly a 1.5k\u20ac impact on the price predicted.", "According to the SHAP dependency plots, there is a (rather) linear relationship between the car price predicted and both the mileage and the car age in days. Roughly, every 75000 km increase in the mileage, the predicted price drops by 1k\u20ac. Similarly, a car that is 1000 days older, has a 1k\u20ac drop in the predicted price. These are the general rule of thumbs, but it doesn\u2019t mean that is true for each individual car.", "It is also possible to understand how each car\u2019s price is predicted by the model, by plotting a SHAP force plot. For example, the next plot shows that the base value for car prices should be around 10100\u20ac, which corresponds to the average value of the car prices. However, the price predicted for a specific car shown in this example is lower, namely 9233\u20ac. This is mainly because of the high mileage (101685 km) and the car\u2019s age (3110 days) which drops the price ~400\u20ac and ~1.3k\u20ac respectively. The original price of the car was 19811\u20ac, which contributes to adding less than 250\u20ac to the price predicted by the model. The rest of the contributions to get from the base value (10100\u20ac) to the model output value (9233\u20ac) can be observed on the plot.", "Something I was curious to know is if cars with a lower consumption (higher km/l) will have higher average yearly mileage. Given the joint distribution of consumption and yearly mileage shown in the plot below, there seems to be not such a clear relation.", "Now that we created the model y*=f(X*), we can proceed to use the price predicted to find deals using y_actual-y*. I decided to build my own nerd search engine, where instead of showing a list of car options and their photos (as any selling car website generally does), I will plot the y* (predicted price) vs. y_actual (asking price). If a car falls in the 1:1 line (y_actual=y*), it means that the asking price is fair. As mentioned in the introduction, I\u2019m actually interested in those cars for which y_actual<y*. If you want to use my search engine, click on the \u201cResult\u201d tab below. I recommend you to check the desktop version because the mobile does not scale well.", "There are 2 tabs, \u201cAutomatic\u201d shows only automatic gearbox cars, and \u201cAll cars\u201d which have both manual and automatic (actually there are even some semi-automatic ones, I had no idea that existed). Each point in the plot is a car, the x-axis represents the price predicted [\u20ac] by the model (y*), and the y-axis is the asking price [\u20ac] (y_actual). The size of the dots is correlated with the car\u2019s consumption. The dots\u2019 colors are correlated with an annual total spent (one-year tax expenses plus an average spent for fuel depending on the car\u2019s consumption plus actual price minus price predicted by the model for the same car next year, which is the output of the model when I increase the mileage by 14000 km and the car\u2019s age by 365 days). I also added some filters, in case you want to look for a specific brand, mileage, etc.", "In this plot, good-deal cars are those dots that are further away from the 1:1 line, towards the right, i.e. price predicted>>actual price. If you click on the dot, you will be redirected to the car\u2019s link and will be able to see the car\u2019s photos and more info. If you get redirected to a search list, then that\u2019s because the car was already sold.", "The data used for training the model and showed in the previous plots is from second-hand car prices being offered on a website in July 2020 in the Netherlands. I had used some pre-filters before getting the data, such as cars with less than 180000 km, less than 17k\u20ac, from at least 2012.", "Finally, after all this analysis, the best deal I could find is this:", "I think I\u2019m going to ask for a second opinion\u2026", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "I\u2019m a Data Scientist, electronic engineer, with a PhD in Engineering, working on dynamic pricing, and with research background on remote sensing."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F8ec4626fd49b&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuying-a-car-in-a-nerdy-way-8ec4626fd49b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuying-a-car-in-a-nerdy-way-8ec4626fd49b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuying-a-car-in-a-nerdy-way-8ec4626fd49b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuying-a-car-in-a-nerdy-way-8ec4626fd49b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----8ec4626fd49b--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----8ec4626fd49b--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@cintibrus?source=post_page-----8ec4626fd49b--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@cintibrus?source=post_page-----8ec4626fd49b--------------------------------", "anchor_text": "Cintia Bruscantini"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fe76d4e97036d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuying-a-car-in-a-nerdy-way-8ec4626fd49b&user=Cintia+Bruscantini&userId=e76d4e97036d&source=post_page-e76d4e97036d----8ec4626fd49b---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F8ec4626fd49b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuying-a-car-in-a-nerdy-way-8ec4626fd49b&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F8ec4626fd49b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuying-a-car-in-a-nerdy-way-8ec4626fd49b&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://pixabay.com/users/dtavres-8137151/?utm_source=link-attribution&utm_medium=referral&utm_campaign=image&utm_content=3250015", "anchor_text": "Dave Tavres"}, {"url": "https://pixabay.com/?utm_source=link-attribution&utm_medium=referral&utm_campaign=image&utm_content=3250015", "anchor_text": "Pixabay"}, {"url": "https://shap.readthedocs.io/en/latest/", "anchor_text": "SHAP library"}, {"url": "https://towardsdatascience.com/explain-your-model-with-the-shap-values-bc36aac4de3d", "anchor_text": "click here"}, {"url": "https://pixabay.com/users/rhonda_jenkins-23203/", "anchor_text": "Ronda Jenkins"}, {"url": "https://pixabay.com/?utm_source=link-attribution&utm_medium=referral&utm_campaign=image&utm_content=3250015", "anchor_text": "Pixabay"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----8ec4626fd49b---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----8ec4626fd49b---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/model?source=post_page-----8ec4626fd49b---------------model-----------------", "anchor_text": "Model"}, {"url": "https://medium.com/tag/cars?source=post_page-----8ec4626fd49b---------------cars-----------------", "anchor_text": "Cars"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----8ec4626fd49b---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F8ec4626fd49b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuying-a-car-in-a-nerdy-way-8ec4626fd49b&user=Cintia+Bruscantini&userId=e76d4e97036d&source=-----8ec4626fd49b---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F8ec4626fd49b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuying-a-car-in-a-nerdy-way-8ec4626fd49b&user=Cintia+Bruscantini&userId=e76d4e97036d&source=-----8ec4626fd49b---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F8ec4626fd49b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuying-a-car-in-a-nerdy-way-8ec4626fd49b&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----8ec4626fd49b--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F8ec4626fd49b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuying-a-car-in-a-nerdy-way-8ec4626fd49b&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----8ec4626fd49b---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----8ec4626fd49b--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----8ec4626fd49b--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----8ec4626fd49b--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----8ec4626fd49b--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----8ec4626fd49b--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----8ec4626fd49b--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----8ec4626fd49b--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----8ec4626fd49b--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@cintibrus?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@cintibrus?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Cintia Bruscantini"}, {"url": "https://medium.com/@cintibrus/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "63 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fe76d4e97036d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuying-a-car-in-a-nerdy-way-8ec4626fd49b&user=Cintia+Bruscantini&userId=e76d4e97036d&source=post_page-e76d4e97036d--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F612d97cf9969&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuying-a-car-in-a-nerdy-way-8ec4626fd49b&newsletterV3=e76d4e97036d&newsletterV3Id=612d97cf9969&user=Cintia+Bruscantini&userId=e76d4e97036d&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}