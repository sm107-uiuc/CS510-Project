{"url": "https://towardsdatascience.com/machine-comprehension-with-bert-6eadf16c87c1", "time": 1683004795.444431, "path": "towardsdatascience.com/machine-comprehension-with-bert-6eadf16c87c1/", "webpage": {"metadata": {"title": "Machine Comprehension with BERT. In 2018, Google\u2019s BERT beat human\u2026 | by Edward Qian | Towards Data Science", "h1": "Machine Comprehension with BERT", "description": "In 2018, Google's BERT beat human annotators at reading comprehension. Now, you can set this Machine Comprehension system up in under 30 minutes."}, "outgoing_paragraph_urls": [{"url": "https://github.com/edwardcqian/bert_QA", "anchor_text": "here", "paragraph_index": 0}, {"url": "https://arxiv.org/pdf/1606.05250.pdf", "anchor_text": "paper SQuAD: 100,000+ Questions for Machine Comprehension of Text,", "paragraph_index": 4}, {"url": "https://github.com/edwardcqian/bert_QA", "anchor_text": "here", "paragraph_index": 8}, {"url": "https://runnable.com/docker/getting-started/", "anchor_text": "these instruction", "paragraph_index": 10}, {"url": "https://runnable.com/docker/introduction-to-docker-compose", "anchor_text": "here", "paragraph_index": 10}, {"url": "https://drive.google.com/file/d/1lHVdsgLayL20CkVMOQFq6Ji85leS7FCA/view?usp=sharing", "anchor_text": "here", "paragraph_index": 14}, {"url": "https://github.com/huggingface/transformers", "anchor_text": "huggingface", "paragraph_index": 17}, {"url": "https://www.dscrashcourse.com/", "anchor_text": "https://www.dscrashcourse.com/", "paragraph_index": 25}], "all_paragraphs": ["The Github repository with the code can be found here. The article will go over how to set this up. Estimated time: under 30 minutes.", "Machine (Reading) Comprehension is the field of NLP where we teach machines to understand and answer questions using unstructured text.", "In 2016, StanfordNLP put together the SQuAD (Stanford Question Answering Dataset) dataset which consisted of over 100,000 question answer pairs formulated from Wikipedia articles. The challenge was to train a machine learning model to answer questions based on a contextual document. When provided with a contextual document (free form text) and a question, the model would return the subset of the text most likely to answer the question.", "Top AI practitioners around the world tackled this problem, but after two years, no model beat the human benchmark. However, at the end of 2018, the brilliant minds at Google Brain introduced BERT (Bidirectional Encoder Representations from Transformers), a general purpose language understanding model. With some fine-tuning, this model was able to surpass the human benchmark when compared against the SQuAD test set.", "From the paper SQuAD: 100,000+ Questions for Machine Comprehension of Text, these were the metrics used for evaluation:", "Exact match. This metric measures the percentage of predictions that match any one of the ground truth answers exactly.", "(Macro-averaged) F1 score. This metric measures the average overlap between the prediction and ground truth answer. We treat the prediction and ground truth as bags of tokens, and compute their F1. We take the maximum F1 over all of the ground truth answers for a given question, and then average over all of the questions.", "Based on the initial SQuAD dataset:", "Today, I will show you how to c\u0336h\u0336e\u0336a\u0336t\u0336 \u0336o\u0336n\u0336 \u0336y\u0336o\u0336u\u0336r\u0336 \u0336g\u0336r\u0336a\u0336d\u0336e\u0336 \u03363\u0336 \u0336h\u0336o\u0336m\u0336e\u0336w\u0336o\u0336r\u0336k set up your own reading comprehension system using BERT. The Github repository with the code can be found here.", "To get started, you will need Docker. \ud83d\udc33", "Docker is useful for containerizing applications. We will be using Docker to make this work more usable and the results more reproducible. Follow these instruction to install Docker on your system. You\u2019ll also need docker-compose, which comes natively with Docker on macos and windows. If you are using Linux, you can install it here.", "All the code and necessary dependencies are in the repo with the exception of the SQuAD data and the pre-trained weights. Note: the data is only required if you want to train the model yourself. If not, you can use the weights I pre-trained. Another note: I wouldn\u2019t recommend training the model unless you have a powerful GPU or a lot of time.", "If you want to train the model yourself \u2026", "If you want to use pre-trained weights \u2026", "I already trained the model against the SQuAD 2.0 dataset. You can download them here. Unzip the file and save the content asbert_QA/weights.", "Docker containers are work environments built using instructions provided in the docker image. We need a docker-compose.yaml config file to define what our container will look like.", "I made a custom docker image for huggingface\u2019s Pytorch transformers which you can find on dockerhub. For the purpose of this tutorial, you will not need to pull any images as the config file already does that. The config file will also mount our local bert_QA folder as /workspace in the container.", "Skip this step if you are using my pre-trained weights. We will be using the default training script provided by huggingface to train the model.", "Run this in the bash shell:", "Note: if you don\u2019t have a GPU, per_gpu_train_batch_size will not do anything", "This will train and save the model weights to the weights directory.", "Now let\u2019s use the model to do some cool stuff.", "Start an ipython session in the shell and import the ModelInference module to load weights from weights/. Pass the contextual document as a parameter to mi.add_target_text(). After the corpus has been ingested, use mi.evaluate() to ask questions. The module will only return an answer if the model is confident the answer exists in the text. Otherwise, the model will output \u201cNo valid answers found.\u201d.", "NLP has gone a long way over the past few years. Pre-trained BERT weights had a similar impact to NLP as AlexNet for image recognition. It has enabled numerous novel applications of natural language understanding.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Check out my website for learning Data Science: https://www.dscrashcourse.com/"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F6eadf16c87c1&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-comprehension-with-bert-6eadf16c87c1&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-comprehension-with-bert-6eadf16c87c1&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-comprehension-with-bert-6eadf16c87c1&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-comprehension-with-bert-6eadf16c87c1&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----6eadf16c87c1--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----6eadf16c87c1--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://edwardcqian.medium.com/?source=post_page-----6eadf16c87c1--------------------------------", "anchor_text": ""}, {"url": "https://edwardcqian.medium.com/?source=post_page-----6eadf16c87c1--------------------------------", "anchor_text": "Edward Qian"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F9ab35c11801&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-comprehension-with-bert-6eadf16c87c1&user=Edward+Qian&userId=9ab35c11801&source=post_page-9ab35c11801----6eadf16c87c1---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F6eadf16c87c1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-comprehension-with-bert-6eadf16c87c1&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F6eadf16c87c1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-comprehension-with-bert-6eadf16c87c1&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@lazycreekimages?utm_source=medium&utm_medium=referral", "anchor_text": "Michael Dziedzic"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://github.com/edwardcqian/bert_QA", "anchor_text": "here"}, {"url": "https://www.coursera.org/specializations/deep-learning?ranMID=40328&ranEAID=J2RDo*Rlzkk&ranSiteID=J2RDo.Rlzkk-XtffRH2JEnDifWa3VrZJ1A&siteID=J2RDo.Rlzkk-XtffRH2JEnDifWa3VrZJ1A&utm_content=2&utm_medium=partners&utm_source=linkshare&utm_campaign=J2RDo*Rlzkk", "anchor_text": "Deep LearningBecome a Deep Learning expert. Master the fundamentals of deep learning and break into AI. Filled Star Filled Star\u2026www.coursera.org"}, {"url": "https://arxiv.org/pdf/1606.05250.pdf", "anchor_text": "paper SQuAD: 100,000+ Questions for Machine Comprehension of Text,"}, {"url": "https://github.com/edwardcqian/bert_QA", "anchor_text": "here"}, {"url": "https://runnable.com/docker/getting-started/", "anchor_text": "these instruction"}, {"url": "https://runnable.com/docker/introduction-to-docker-compose", "anchor_text": "here"}, {"url": "https://rajpurkar.github.io/SQuAD-explorer/", "anchor_text": "here"}, {"url": "https://drive.google.com/file/d/1lHVdsgLayL20CkVMOQFq6Ji85leS7FCA/view?usp=sharing", "anchor_text": "here"}, {"url": "https://github.com/huggingface/transformers", "anchor_text": "huggingface"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----6eadf16c87c1---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----6eadf16c87c1---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/nlp?source=post_page-----6eadf16c87c1---------------nlp-----------------", "anchor_text": "NLP"}, {"url": "https://medium.com/tag/technology?source=post_page-----6eadf16c87c1---------------technology-----------------", "anchor_text": "Technology"}, {"url": "https://medium.com/tag/programming?source=post_page-----6eadf16c87c1---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F6eadf16c87c1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-comprehension-with-bert-6eadf16c87c1&user=Edward+Qian&userId=9ab35c11801&source=-----6eadf16c87c1---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F6eadf16c87c1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-comprehension-with-bert-6eadf16c87c1&user=Edward+Qian&userId=9ab35c11801&source=-----6eadf16c87c1---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F6eadf16c87c1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-comprehension-with-bert-6eadf16c87c1&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----6eadf16c87c1--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F6eadf16c87c1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-comprehension-with-bert-6eadf16c87c1&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----6eadf16c87c1---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----6eadf16c87c1--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----6eadf16c87c1--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----6eadf16c87c1--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----6eadf16c87c1--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----6eadf16c87c1--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----6eadf16c87c1--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----6eadf16c87c1--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----6eadf16c87c1--------------------------------", "anchor_text": ""}, {"url": "https://edwardcqian.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://edwardcqian.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Edward Qian"}, {"url": "https://edwardcqian.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "44 Followers"}, {"url": "https://www.dscrashcourse.com/", "anchor_text": "https://www.dscrashcourse.com/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F9ab35c11801&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-comprehension-with-bert-6eadf16c87c1&user=Edward+Qian&userId=9ab35c11801&source=post_page-9ab35c11801--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F8c88a84abc2b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-comprehension-with-bert-6eadf16c87c1&newsletterV3=9ab35c11801&newsletterV3Id=8c88a84abc2b&user=Edward+Qian&userId=9ab35c11801&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}