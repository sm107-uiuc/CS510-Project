{"url": "https://towardsdatascience.com/start-version-controlling-your-machine-learning-datasets-2b872e109856", "time": 1683001883.871948, "path": "towardsdatascience.com/start-version-controlling-your-machine-learning-datasets-2b872e109856/", "webpage": {"metadata": {"title": "Start Version Controlling your Machine Learning Datasets | by Elle O'Brien, Ph.D. | Towards Data Science", "h1": "Start Version Controlling your Machine Learning Datasets", "description": "In a lot of machine learning projects I\u2019ve worked on this past year, my dataset changed several times throughout the lifetime of the experiment. When I work with biomedical data, for example, new\u2026"}, "outgoing_paragraph_urls": [{"url": "https://pudding.cool/2019/11/big-hair/", "anchor_text": "image segmentation,", "paragraph_index": 0}, {"url": "https://www.kdnuggets.com/2018/10/introduction-active-learning.html", "anchor_text": "active learning", "paragraph_index": 0}, {"url": "https://news.ycombinator.com/item?id=13560074", "anchor_text": "git is not ideal for binaries", "paragraph_index": 1}, {"url": "http://vision.stanford.edu/aditya86/ImageNetDogs/", "anchor_text": "Stanford Dogs dataset", "paragraph_index": 3}, {"url": "https://github.com/andronovhopf/Dog_Breed_Classifier", "anchor_text": "scripts to construct this dataset are on GitHub", "paragraph_index": 4}, {"url": "https://dvc.org/doc", "anchor_text": "Get Started", "paragraph_index": 13}, {"url": "https://github.com/andronovhopf/Dog_Breed_Classifier/blob/master/breed_classifier.py", "anchor_text": "code here", "paragraph_index": 14}, {"url": "https://github.com/andronovhopf/Dog_Breed_Classifier", "anchor_text": "project repo", "paragraph_index": 17}], "all_paragraphs": ["In a lot of machine learning projects I\u2019ve worked on this past year, my dataset changed several times throughout the lifetime of the experiment. When I work with biomedical data, for example, new data arrive almost weekly. And in some experiments I\u2019ve been doing with image segmentation, I\u2019ve been using a technique called active learning to gradually grow my training dataset.", "All of this has left me with some unease that while my code is version controlled with git, my datasets and trained models are often not (due to a combination of file size constraints, and the fact that git is not ideal for binaries). Every time I retrain my models with new data, I end up either overwriting my existing model, or filling my project directory with many slightly different versions of the trained model with slightly different file names. Like this:", "OK, I do try to pick better filenames. But still \u2014 this approach is unsystematic and hard to exactly reproduce. It feels unscientific. I recently learned about DVC, an open-source version control system that works in complement with git to track changes large datasets and model files (and spoiler: I am joining DVC in January 2020!). I tried it out and really like the way it adds structure to dynamic ML problems- kind of like how adopting git encouraged me to take up better coding practices. I want to share a bit about how versioning a dataset for an ML experiment looks.", "Let\u2019s start with a toy problem. I have a data directory full of images from the Stanford Dogs dataset, a wonderful repository of dog pictures that are tagged by breed. Say I want to build a classifier to discriminate between two breeds of fluffy dogs, the Afghan Hound and the Maltese.", "To begin with, I have 100 images of each breed (scripts to construct this dataset are on GitHub, so clone the repo if you\u2019d like to follow along). But I know the dataset could change in the future: more images could be added, I could decide to exclude some images, or I (or someone on my team) could accidentally delete a file. Each of these changes would have consequences for the model that gets fit to our data.", "With a very small dataset like this, I could conceivably use git. With a larger dataset, I could move to git-lfs (although this has space limitations too- and, in my experience with biomedical research data at a university hospital, some institutions won\u2019t allow it without going through an audit procedure). But, imagining a much bigger dataset- not to mention the large trained model files I\u2019m about to generate- you can start to see where this approach gets sticky.", "Here\u2019s where DVC comes in. DVC is a version control system that is built around git, so the syntax is very similar \u2014 once you make a folder on your local machine where your project code (such as your ML model) will be stored, you run", "Note that if you\u2019re following along with the code we provided, you\u2019ll have the entire Stanford Dog Dataset downloaded in your project directory- we don\u2019t care about tracking this, so run", "Next, you\u2019ll need to pick a location where DVC will handle the storage of various versions of your data and models, called a data remote. The remote can be a storage location of your choice- I\u2019ll use an S3 bucket, but you could use a GCP bucket, Azure blob storage, your own in-house file server, or even a local directory. One benefit of using external storage is that a new user on a different machine (say, a collaborator) can easily jump in and start reproducing your ML project. In particular, cloud storage scales well, so you can avoid a lot of the frustration of running out of disk space as your dataset grows (which has happened to me and is really the worst way to spend an afternoon). Bottom line: I recommend cloud storage for your data science projects whenever you can.", "Here\u2019s how we add the S3 bucket as my remote for this project:", "Next, we initiate tracking of the dataset. In our code example, the dataset currently resides in a subdirectory of the project directory called \u201cdata\u201d.", "This creates a .dvc file, which is a lightweight text file that indexes the current state of our dataset (open it up in a text editor if you\u2019re curious!). This .dvc is tracked with git like any other text file.", "Finally, we\u2019ll git commit and dvc push- after running these commands, git is now tracking your dataset by way of the .dvc file in your project directory, and the contents of your data files are now in the S3 bucket.", "For more details about configuring dvc for your specific workflow, check out the Get Started docs.", "Now, let\u2019s run a classifier on the dataset. This one uses the pretrained VGG-16 weights to create features for each image, and then a fully connected layer is trained to map those features to a category label (you can see the code here). The specifics of the classifier \u2014 the language, architecture, and choice of framework \u2014 aren\u2019t important for this example.", "(Why did we specify PYTHONHASHSEED=0? You don\u2019t have to, but it\u2019ll ensure that you get the exact same results I do if you\u2019re following along- we\u2019re keeping random number seeds consistent).", "After the model trains, you\u2019ll have a model file in your project directory. Saved models can be tracked with DVC also. Let\u2019s dvc add, and then git commit to do that.", "Let\u2019s say that an animal shelter suddenly sends us even more pictures of dogs, and we want to retrain our model to take advantage of this new data. Now we add another 100 pictures of each breed to the data directory (if you\u2019re following along on your own machine, the script grow_dog_dataset.sh in the project repo will do this!). We can confirm this by running", "These images aren\u2019t yet tracked by DVC, so let\u2019s add them:", "And let\u2019s train the model again. Cool, it looks like we\u2019ve got an improvement.", "Again, we can dvc add and git commit to track the .h5 model file. Since the latest commit is tracking both the latest version of the trained model as well as the dataset it was trained on, they\u2019re effectively bound together in the history of the project.", "So I\u2019m ready to go to production with this amazing Maltese/Afghan Hound classifier, classifying all the dogs I meet, until I realize that I\u2019ve made a mistake. Perhaps the shelter accidentally sent me a bunch of Pembroke Corgi pictures, mislabeled as Malteses, that I failed to notice before training. Because we\u2019ve been versioning the dataset, though, this kind of error is easily resolvable (and without making untracked, irreversible file deletions).", "There are two ways we can handle this\u2026", "If we know exactly what files are erroneous, we can delete those images only. Then, update the state of the project with", "We\u2019d naturally want to retrain the model so it stays synced with the dataset.", "Option 2. Revert the project to a previous state.", "If we don\u2019t know which images are problematic, we might want to just scrap all of our recent changes to the project and revert to the version before the last wave of dog pictures arrived. To do this, we can use git checkout and dvc checkout:", "Now look inside the data directory: there are only 200 files (100 of each breed) again.", "The trained model in our project directory reflects this version of the dataset, too.", "ML projects rarely proceed in a straight line of progress \u2014 not just because finding the right model is anything but linear, but because datasets themselves change. There are certainly homemade ways to track and manage those changes, but DVC can help in several ways:", "Besides all these practical reasons, though, my main reason is that version control is simply good practice. I try to be systematic and careful, but sometimes during experimentation, I lose track of the ways my dataset has changed. DVC, like git, helps me stick to best practices for reproducible, shareable science.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F2b872e109856&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fstart-version-controlling-your-machine-learning-datasets-2b872e109856&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fstart-version-controlling-your-machine-learning-datasets-2b872e109856&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fstart-version-controlling-your-machine-learning-datasets-2b872e109856&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fstart-version-controlling-your-machine-learning-datasets-2b872e109856&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----2b872e109856--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----2b872e109856--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@andronovhopf?source=post_page-----2b872e109856--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@andronovhopf?source=post_page-----2b872e109856--------------------------------", "anchor_text": "Elle O'Brien, Ph.D."}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F5f5ca6c5e456&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fstart-version-controlling-your-machine-learning-datasets-2b872e109856&user=Elle+O%27Brien%2C+Ph.D.&userId=5f5ca6c5e456&source=post_page-5f5ca6c5e456----2b872e109856---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F2b872e109856&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fstart-version-controlling-your-machine-learning-datasets-2b872e109856&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F2b872e109856&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fstart-version-controlling-your-machine-learning-datasets-2b872e109856&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://pudding.cool/2019/11/big-hair/", "anchor_text": "image segmentation,"}, {"url": "https://www.kdnuggets.com/2018/10/introduction-active-learning.html", "anchor_text": "active learning"}, {"url": "https://news.ycombinator.com/item?id=13560074", "anchor_text": "git is not ideal for binaries"}, {"url": "http://vision.stanford.edu/aditya86/ImageNetDogs/", "anchor_text": "Stanford Dogs dataset"}, {"url": "https://github.com/andronovhopf/Dog_Breed_Classifier", "anchor_text": "scripts to construct this dataset are on GitHub"}, {"url": "https://dvc.org/doc", "anchor_text": "Get Started"}, {"url": "https://github.com/andronovhopf/Dog_Breed_Classifier/blob/master/breed_classifier.py", "anchor_text": "code here"}, {"url": "https://github.com/andronovhopf/Dog_Breed_Classifier", "anchor_text": "project repo"}, {"url": "https://medium.com/tag/git?source=post_page-----2b872e109856---------------git-----------------", "anchor_text": "Git"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----2b872e109856---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----2b872e109856---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/version-control?source=post_page-----2b872e109856---------------version_control-----------------", "anchor_text": "Version Control"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----2b872e109856---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F2b872e109856&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fstart-version-controlling-your-machine-learning-datasets-2b872e109856&user=Elle+O%27Brien%2C+Ph.D.&userId=5f5ca6c5e456&source=-----2b872e109856---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F2b872e109856&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fstart-version-controlling-your-machine-learning-datasets-2b872e109856&user=Elle+O%27Brien%2C+Ph.D.&userId=5f5ca6c5e456&source=-----2b872e109856---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F2b872e109856&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fstart-version-controlling-your-machine-learning-datasets-2b872e109856&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----2b872e109856--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F2b872e109856&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fstart-version-controlling-your-machine-learning-datasets-2b872e109856&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----2b872e109856---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----2b872e109856--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----2b872e109856--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----2b872e109856--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----2b872e109856--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----2b872e109856--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----2b872e109856--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----2b872e109856--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----2b872e109856--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@andronovhopf?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@andronovhopf?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Elle O'Brien, Ph.D."}, {"url": "https://medium.com/@andronovhopf/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "1.1K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F5f5ca6c5e456&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fstart-version-controlling-your-machine-learning-datasets-2b872e109856&user=Elle+O%27Brien%2C+Ph.D.&userId=5f5ca6c5e456&source=post_page-5f5ca6c5e456--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fd96006a78f0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fstart-version-controlling-your-machine-learning-datasets-2b872e109856&newsletterV3=5f5ca6c5e456&newsletterV3Id=d96006a78f0&user=Elle+O%27Brien%2C+Ph.D.&userId=5f5ca6c5e456&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}