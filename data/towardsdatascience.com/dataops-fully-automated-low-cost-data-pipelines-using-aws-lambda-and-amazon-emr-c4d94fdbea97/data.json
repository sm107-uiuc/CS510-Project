{"url": "https://towardsdatascience.com/dataops-fully-automated-low-cost-data-pipelines-using-aws-lambda-and-amazon-emr-c4d94fdbea97", "time": 1683012401.900516, "path": "towardsdatascience.com/dataops-fully-automated-low-cost-data-pipelines-using-aws-lambda-and-amazon-emr-c4d94fdbea97/", "webpage": {"metadata": {"title": "DataOps \u2014 Fully Automated, Low Cost Data Pipelines using AWS Lambda and Amazon EMR | by Manoj Kukreja | Towards Data Science", "h1": "DataOps \u2014 Fully Automated, Low Cost Data Pipelines using AWS Lambda and Amazon EMR", "description": "Progression is continuous. Taking a flashback journey through my 25 years career in information technology, I have experienced several phases of progression and adaptation. From a newly hired recruit\u2026"}, "outgoing_paragraph_urls": [{"url": "http://www.datafence.com", "anchor_text": "Datafence Cloud Academy", "paragraph_index": 23}], "all_paragraphs": ["Progression is continuous. Taking a flashback journey through my 25 years career in information technology, I have experienced several phases of progression and adaptation.", "From a newly hired recruit who carefully watched every single SQL command run to completion to a confident DBA who scripted hundreds of SQL\u2019s and ran them together as batch jobs using the Cron scheduler. In the modern era I adapted to DAG tools like Oozie and Airflow that not only provide job scheduling but can to run a series of jobs as data pipelines in an automated fashion.", "Lately, the adoption of cloud has changed the whole meaning of automation.", "In the cloud era, we can design automation methods that were previously unheard of. I admit that cloud storage resources are getting cheaper by the day but the compute resources (high CPU and memory) are still relatively expensive. Keeping that in mind, wouldn\u2019t it be super cool if DataOps can help us save on compute costs. Let\u2019s find out how this can be done:", "Typically, we run data pipelines as follows:", "Data collection at regular time intervals (daily, hourly or by the minute) saved to storage like S3. This is usually followed up by data processing jobs using permanently spawned distributed computing clusters like EMR.", "Pros: Processing Jobs run on a schedule. Permanent cluster can be utilized for other purposes like querying using Hive, streaming workloads etc.", "Cons: There can be a delay between the time data arrives vs. when it gets processed. Compute resources may not be optimally utilized. There may be under utilization at times, therefore wasting expensive $$$", "Here is an alternative that can help achieve the right balance between operation and costs. This method may not apply to all use cases, but if it does then rest assured it will save you a lot of $$$.", "In this method the storage layer stays pretty much the same, except an event notification is added to the storage that invokes a Lambda function when new data arrives. In turn the Lambda function invokes the creation of a transient EMR cluster for data processing. A transient EMR cluster is a special type of cluster that deploys, runs the data processing job and then self-destructs.", "Pros: Processing jobs can start as soon as the data is available. No waits. Compute resources optimally utilized. Only pay for what you use and save $$$.", "Cons: Cluster cannot be utilized for other purposes like querying using Hive, streaming workloads etc.", "Here is how the entire process is handled technically:", "Create a new S3 Bucket for running the demo. Remember to change the bucket name since S3 bucket name are globally unique.", "Create a role for the Lambda Function", "Create the Lambda Function in AWS", "Finally, let's create the S3 event notification. This notification will invoke the Lambda function above.", "Let's kick off the process by copying data to S3", "If everything ran OK you should be able to see a running Cluster in EMR with Status=Starting", "After some time the EMR cluster should change to Status=Terminated.", "To check if the Spark program was successful check the S3 folder as below:", "Moving into the next phase of Data Engineering and Data Science automation of data pipelines is becoming a critical operation. If done correctly it carries a potential for streamlining not only operations but resource costs as well.", "Hope you gained some valuable insights from the article above. Feel free to contact me if you need further clarifications and advice.", "I hope this article was helpful. AWS Data Lake & DataOps is covered as part of the AWS Big Data Analytics course offered by Datafence Cloud Academy. The course is taught online by myself on weekends.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Author, Big Data Engineering, Data Science, Data Lakes, Cloud Computing and IT security specialist."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fc4d94fdbea97&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdataops-fully-automated-low-cost-data-pipelines-using-aws-lambda-and-amazon-emr-c4d94fdbea97&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdataops-fully-automated-low-cost-data-pipelines-using-aws-lambda-and-amazon-emr-c4d94fdbea97&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdataops-fully-automated-low-cost-data-pipelines-using-aws-lambda-and-amazon-emr-c4d94fdbea97&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdataops-fully-automated-low-cost-data-pipelines-using-aws-lambda-and-amazon-emr-c4d94fdbea97&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----c4d94fdbea97--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----c4d94fdbea97--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://mkukreja1.medium.com/?source=post_page-----c4d94fdbea97--------------------------------", "anchor_text": ""}, {"url": "https://mkukreja1.medium.com/?source=post_page-----c4d94fdbea97--------------------------------", "anchor_text": "Manoj Kukreja"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F4076fc16cb6a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdataops-fully-automated-low-cost-data-pipelines-using-aws-lambda-and-amazon-emr-c4d94fdbea97&user=Manoj+Kukreja&userId=4076fc16cb6a&source=post_page-4076fc16cb6a----c4d94fdbea97---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc4d94fdbea97&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdataops-fully-automated-low-cost-data-pipelines-using-aws-lambda-and-amazon-emr-c4d94fdbea97&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc4d94fdbea97&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdataops-fully-automated-low-cost-data-pipelines-using-aws-lambda-and-amazon-emr-c4d94fdbea97&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://pixabay.com/users/ar130405-423602/?utm_source=link-attribution&utm_medium=referral&utm_campaign=image&utm_content=2082642", "anchor_text": "ar130405"}, {"url": "https://pixabay.com/?utm_source=link-attribution&utm_medium=referral&utm_campaign=image&utm_content=2082642", "anchor_text": "Pixabay"}, {"url": "https://s3.console.aws.amazon.com/s3/#", "anchor_text": "2020-08-07_2PM'"}, {"url": "http://www.datafence.com", "anchor_text": "Datafence Cloud Academy"}, {"url": "https://medium.com/tag/aws?source=post_page-----c4d94fdbea97---------------aws-----------------", "anchor_text": "AWS"}, {"url": "https://medium.com/tag/emr?source=post_page-----c4d94fdbea97---------------emr-----------------", "anchor_text": "Emr"}, {"url": "https://medium.com/tag/data?source=post_page-----c4d94fdbea97---------------data-----------------", "anchor_text": "Data"}, {"url": "https://medium.com/tag/data-science?source=post_page-----c4d94fdbea97---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/aws-ec2?source=post_page-----c4d94fdbea97---------------aws_ec2-----------------", "anchor_text": "Aws Ec2"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fc4d94fdbea97&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdataops-fully-automated-low-cost-data-pipelines-using-aws-lambda-and-amazon-emr-c4d94fdbea97&user=Manoj+Kukreja&userId=4076fc16cb6a&source=-----c4d94fdbea97---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fc4d94fdbea97&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdataops-fully-automated-low-cost-data-pipelines-using-aws-lambda-and-amazon-emr-c4d94fdbea97&user=Manoj+Kukreja&userId=4076fc16cb6a&source=-----c4d94fdbea97---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc4d94fdbea97&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdataops-fully-automated-low-cost-data-pipelines-using-aws-lambda-and-amazon-emr-c4d94fdbea97&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----c4d94fdbea97--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fc4d94fdbea97&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdataops-fully-automated-low-cost-data-pipelines-using-aws-lambda-and-amazon-emr-c4d94fdbea97&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----c4d94fdbea97---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----c4d94fdbea97--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----c4d94fdbea97--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----c4d94fdbea97--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----c4d94fdbea97--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----c4d94fdbea97--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----c4d94fdbea97--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----c4d94fdbea97--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----c4d94fdbea97--------------------------------", "anchor_text": ""}, {"url": "https://mkukreja1.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://mkukreja1.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Manoj Kukreja"}, {"url": "https://mkukreja1.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "626 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F4076fc16cb6a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdataops-fully-automated-low-cost-data-pipelines-using-aws-lambda-and-amazon-emr-c4d94fdbea97&user=Manoj+Kukreja&userId=4076fc16cb6a&source=post_page-4076fc16cb6a--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Ffc0268f00243&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdataops-fully-automated-low-cost-data-pipelines-using-aws-lambda-and-amazon-emr-c4d94fdbea97&newsletterV3=4076fc16cb6a&newsletterV3Id=fc0268f00243&user=Manoj+Kukreja&userId=4076fc16cb6a&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}