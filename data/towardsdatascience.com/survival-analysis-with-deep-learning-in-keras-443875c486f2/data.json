{"url": "https://towardsdatascience.com/survival-analysis-with-deep-learning-in-keras-443875c486f2", "time": 1683004028.025305, "path": "towardsdatascience.com/survival-analysis-with-deep-learning-in-keras-443875c486f2/", "webpage": {"metadata": {"title": "Survival Analysis with Deep Learning in Keras | by Marco Cerliani | Towards Data Science", "h1": "Survival Analysis with Deep Learning in Keras", "description": "Survival Analysis is a particular branch of statistics for analyzing the expected duration of time until one or more events happen. It is also called \u2018Time to Event\u2019 Analysis as the goal is to\u2026"}, "outgoing_paragraph_urls": [{"url": "https://towardsdatascience.com/survival-analysis-with-lightgbm-plus-poisson-regression-6b3cc897af82", "anchor_text": "post", "paragraph_index": 2}, {"url": "https://www.kaggle.com/marklvl/bike-sharing-dataset", "anchor_text": "dataset", "paragraph_index": 3}, {"url": "https://towardsdatascience.com/survival-analysis-with-lightgbm-plus-poisson-regression-6b3cc897af82", "anchor_text": "post", "paragraph_index": 6}], "all_paragraphs": ["Survival Analysis is a particular branch of statistics for analyzing the expected duration of time until one or more events happen. It is also called \u2018Time to Event\u2019 Analysis as the goal is to estimate the Time for some Events of interest to occur. Its applications in machine learning have no limits: It\u2019s common to apply those kinds of techniques in problems of life expectation, customer retention, predictive maintenance and more.", "At first glance, Survival Function estimation appears to be a hard job, but after some experiences and basic mathematical concepts, it\u2019s not so prohibitive! The best starting point consists to have clear ideas in mind, we need to know what is for us the Time and the Events. Only then we can proceed to develop a model that can provide a reliable prediction of the Survival Function for entities of interest. With some tricks, we can take advantage of the mapping properties of the Survival Function and work with other forms of its derivation (like Hazard Function).", "I\u2019ve provided the clarification of these intuitions in a previous post where I also use Gradient Boosting Methods (like LGBM) to estimate Survival Functions in a not common scenario. In this post, I try to follow the same target: estimate density functions but adopting Neural Networks.", "The dataset we utilize contains the two-year historical data, from 2011 to 2012, of the Capital Bikeshare system in Washington D.C., available in daily and hourly format. Various predictors are provided to produce forecasts like temporal or weather regressors. Now we consider the hour format because we need a good amount of data to fit our Neural Network Models.", "Our scope is to predict how many hourly bike rentals are registered under some kind of temporal and weather conditions for casual users.", "At first sight, this task can be easily carried out like a simple regression problem. We try to make things spicier, adopting a survival approach. We have to estimate the Cumulative Density Function (CDF) of the number of casual users for each hour. In this scenario, our Time variable is represented by the number of casual users registered so far while the Event date is defined at the end of the hours as the total count of users. Our model will learn which is the probability to register some users minor than a certain quantity.", "To deal with this problem, maintaining the survival approach, linear or boosting methods (as done in the previous post), require to respect some basic assumptions in order to provide a correct estimation of the survival function. This also involves, for example, to play a little bit with data or to apply a simple mapping to our target. With Neural Networks we don\u2019t care about this, we only have to choose the correct structure and feed it with a good amount of data.", "In general, we can make two different choices when we build our Survival Deep Learning model: deal with the problem with regression or classification. These methods enable to estimate our desired Survival Function providing a different loss minimization procedure, which involves handling our targets in two different formats.", "Estimate Survival Functions with Neural Network and regression implies to estimate directly the CDF for each hour. The CDFs are 0 when the number of casual users is less than the true count while 1 after this value. To grant an equal length for our target density functions we fixed the maximum number of user reachable as 400. Below the structure of the network we use. It gets as input the values of our external predictors (weather and time features) and as output try to replicate our density function. The sigmoid activation in the last layer is useful to clip the final values among 0 and 1. The training is computed minimizing the mean squared error loss.", "We calculate the goodness of our model directly on the whole probability function involved estimate by our model. For this reason, we use the Continuous Ranked Probability Score (CRPS) as a performance metric.", "We predict the whole survival curves for each hourly sample and in the end, we reach 0.074 CRPS on our test data, which is better than a simple model based on a dummy estimation of the test Survival Functions with the CDF derived from the train (0.121 CRPS).", "With the classification approach, we handle targets literally as one-hot instances. Our target, with length equal to the max amount of users reachable, is equal to 1 in correspondence of the exact count registered while it is 0 otherwise. Our model is trained to predict the exact count of casual users reached so far. For this reason, our Neural Network tries to minimize the categorical cross-entropy and has a final softmax activation function.", "During prediction, in order to obtain our desired Survival Function, we have to simply post-process the output applying a cumulative sum transformation for each prediction. With our estimated Survival Functions we can calculate our performance on the test set as done before. With the classification approach, we reach 0.091 CRPS, which is better than a simple model based on a dummy estimation of the test Survival Functions with the CDF derived from the train (0.121 CRPS).", "In this post, we develop Survival Neural Network structures that are able to estimate the Survival Function given some external predictors. The particularity of our work consists of changing the point of view when approaching a standard regression problem. We solve the task providing a survival interpretation of the problem and showing the strategies which enable us to estimate Survival Density Functions with Deep Learning.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F443875c486f2&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsurvival-analysis-with-deep-learning-in-keras-443875c486f2&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsurvival-analysis-with-deep-learning-in-keras-443875c486f2&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsurvival-analysis-with-deep-learning-in-keras-443875c486f2&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsurvival-analysis-with-deep-learning-in-keras-443875c486f2&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----443875c486f2--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----443875c486f2--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@cerlymarco?source=post_page-----443875c486f2--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@cerlymarco?source=post_page-----443875c486f2--------------------------------", "anchor_text": "Marco Cerliani"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fc843902314c7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsurvival-analysis-with-deep-learning-in-keras-443875c486f2&user=Marco+Cerliani&userId=c843902314c7&source=post_page-c843902314c7----443875c486f2---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F443875c486f2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsurvival-analysis-with-deep-learning-in-keras-443875c486f2&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F443875c486f2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsurvival-analysis-with-deep-learning-in-keras-443875c486f2&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@evgenit?utm_source=medium&utm_medium=referral", "anchor_text": "Evgeni Tcherkasski"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://towardsdatascience.com/survival-analysis-with-lightgbm-plus-poisson-regression-6b3cc897af82", "anchor_text": "post"}, {"url": "https://www.kaggle.com/marklvl/bike-sharing-dataset", "anchor_text": "dataset"}, {"url": "https://towardsdatascience.com/survival-analysis-with-lightgbm-plus-poisson-regression-6b3cc897af82", "anchor_text": "post"}, {"url": "https://github.com/cerlymarco/MEDIUM_NoteBook", "anchor_text": "CHECK MY GITHUB REPO"}, {"url": "https://www.linkedin.com/in/marco-cerliani-b0bba714b/", "anchor_text": "Linkedin"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----443875c486f2---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----443875c486f2---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/survival-analysis?source=post_page-----443875c486f2---------------survival_analysis-----------------", "anchor_text": "Survival Analysis"}, {"url": "https://medium.com/tag/neural-networks?source=post_page-----443875c486f2---------------neural_networks-----------------", "anchor_text": "Neural Networks"}, {"url": "https://medium.com/tag/towards-data-science?source=post_page-----443875c486f2---------------towards_data_science-----------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F443875c486f2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsurvival-analysis-with-deep-learning-in-keras-443875c486f2&user=Marco+Cerliani&userId=c843902314c7&source=-----443875c486f2---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F443875c486f2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsurvival-analysis-with-deep-learning-in-keras-443875c486f2&user=Marco+Cerliani&userId=c843902314c7&source=-----443875c486f2---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F443875c486f2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsurvival-analysis-with-deep-learning-in-keras-443875c486f2&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----443875c486f2--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F443875c486f2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsurvival-analysis-with-deep-learning-in-keras-443875c486f2&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----443875c486f2---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----443875c486f2--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----443875c486f2--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----443875c486f2--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----443875c486f2--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----443875c486f2--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----443875c486f2--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----443875c486f2--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----443875c486f2--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@cerlymarco?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@cerlymarco?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Marco Cerliani"}, {"url": "https://medium.com/@cerlymarco/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "6K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fc843902314c7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsurvival-analysis-with-deep-learning-in-keras-443875c486f2&user=Marco+Cerliani&userId=c843902314c7&source=post_page-c843902314c7--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fe2412974851a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsurvival-analysis-with-deep-learning-in-keras-443875c486f2&newsletterV3=c843902314c7&newsletterV3Id=e2412974851a&user=Marco+Cerliani&userId=c843902314c7&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}