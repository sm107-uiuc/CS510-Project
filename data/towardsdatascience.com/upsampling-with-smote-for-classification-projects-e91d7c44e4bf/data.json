{"url": "https://towardsdatascience.com/upsampling-with-smote-for-classification-projects-e91d7c44e4bf", "time": 1683000874.938703, "path": "towardsdatascience.com/upsampling-with-smote-for-classification-projects-e91d7c44e4bf/", "webpage": {"metadata": {"title": "Upsampling with SMOTE for Classification Projects | by Jonathan Keller | Towards Data Science", "h1": "Upsampling with SMOTE for Classification Projects", "description": "Really? Just me? Alright, I probably should explain. I was recently working with a wine dataset on a classification problem. Basically I had values for the chemical composition of the wine and\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.theguardian.com/science/2011/apr/14/expensive-wine-cheap-plonk-taste", "anchor_text": "people aren\u2019t really that good", "paragraph_index": 2}], "all_paragraphs": ["Do you ever think to yourself: \u201cThere\u2019s not enough bad wine in the world.\u201d?", "Really? Just me? Alright, I probably should explain. I was recently working with a wine dataset on a classification problem. Basically I had values for the chemical composition of the wine and average user ratings, ostensibly on a rating scale of 1\u201310, with 10 being the highest.", "Now it turns out people aren\u2019t really that good at telling high end wine from the cheap stuff. That made my premise pretty simple: identify the wines that taste like vinegar to most people, and any other wine would be fine for most restaurants. So I divided \u201cbad\u201d wine (in this experiment, those rated 3 and 4) from \u201cgood\u201d wine (everything else).", "There was a problem though: I didn\u2019t have enough of the plonk.", "My red wine dataset had only 61 \u201cbad\u201d wines compared to 1286 \u201cgood\u201d ones. That\u2019s a 21:1 \u201cgood\u201d to \u201cbad\u201d ratio there. As is, my model is pretty likely to simply predict the majority class every time. I\u2019ll need to find a way to balance out the classes. If only someone had run into this problem before\u2026", "Right, of course. Every data scientist has run into this problem. I knew that. The answer, obviously, was resampling.", "First a quick note on resampling in general. There are basically two big tents when it comes to resampling: oversampling and undersampling. Undersampling is the process of randomly selecting observations from the majority class (in this case, \u201cgood\u201d wine) so that it has an equivalent number of observations to the minority class (so for example, I\u2019d end up with 61 \u201cgood\u201d wines and 61 \u201cbad\u201d wines). That doesn\u2019t work in my case, as undersampling would mean I\u2019m losing most of my observations, and thus, my information.", "So oversampling then. Oversampling is when we create new observations for the minority class, that don\u2019t exist in the data as we have it. Normally this is accomplished by making copies of observations from the minority class and adding them to the dataset, so you can increase the size of the minority class.", "The good news is that your model will learn considerably more about your minority class and won\u2019t just predict the majority class for a given observation. The bad news is that it\u2019s also possibly going to overfit to the characteristics of those observations you\u2019ve just duplicated multiple times. That\u2019s where SMOTE comes in.", "SMOTE stands for Synthetic Minority Over-Sampling Technique. SMOTE is performing the same basic task as basic resampling (creating new data points for the minority class) but instead of simply duplicating observations, it creates new observations along the lines of a randomly chosen point and its nearest neighbors. Basically you\u2019re simulating some additional variation in the data (within the established bounds of your minority class), reducing the danger of overfitting (although not eliminating it).", "The next question (and a big one for me) is how large should we make the minority class? To answer that question, I need to think about what I\u2019m trying to optimize my model for. In my case, I\u2019m trying to correctly identify \u201cbad\u201d wines. I\u2019m ok with incorrectly classifying a few wines as \u201cbad\u201d that actually are ok, because there are a lot of wine options in the world, but I want to make sure that we find the plonk. That means that I need to optimize for recall in order to avoid false negatives.", "Now that I know what I\u2019m optimizing for, what ratio of majority:minority should I aim for? I\u2019ve seen a lot of tutorials which create a 1:1 relationship between the minority and majority classes, but that would mean 1000+ new synthetic observations. After a lot of reading and some experimentation, I ended up with a minority class comprising 15% of the final full dataset.", "This is probably what you are looking for. Here are a couple of functions to actually perform the upsample. Note that this should be done after you\u2019ve done your train/test split. First, we separate the classes:", "And then performing the upsample itself:", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fe91d7c44e4bf&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fupsampling-with-smote-for-classification-projects-e91d7c44e4bf&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fupsampling-with-smote-for-classification-projects-e91d7c44e4bf&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fupsampling-with-smote-for-classification-projects-e91d7c44e4bf&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fupsampling-with-smote-for-classification-projects-e91d7c44e4bf&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----e91d7c44e4bf--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----e91d7c44e4bf--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@jmcneilkeller?source=post_page-----e91d7c44e4bf--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@jmcneilkeller?source=post_page-----e91d7c44e4bf--------------------------------", "anchor_text": "Jonathan Keller"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F71e4031b354&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fupsampling-with-smote-for-classification-projects-e91d7c44e4bf&user=Jonathan+Keller&userId=71e4031b354&source=post_page-71e4031b354----e91d7c44e4bf---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe91d7c44e4bf&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fupsampling-with-smote-for-classification-projects-e91d7c44e4bf&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe91d7c44e4bf&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fupsampling-with-smote-for-classification-projects-e91d7c44e4bf&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://www.researchgate.net/figure/Graphical-representation-of-the-SMOTE-algorithm-a-SMOTE-starts-from-a-set-of-positive_fig2_317489171", "anchor_text": "https://www.researchgate.net/figure/Graphical-representation-of-the-SMOTE-algorithm-a-SMOTE-starts-from-a-set-of-positive_fig2_317489171"}, {"url": "https://www.theguardian.com/science/2011/apr/14/expensive-wine-cheap-plonk-taste", "anchor_text": "people aren\u2019t really that good"}, {"url": "https://arxiv.org/pdf/1106.1813.pdf", "anchor_text": "SMOTE paper"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----e91d7c44e4bf---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/smote?source=post_page-----e91d7c44e4bf---------------smote-----------------", "anchor_text": "Smote"}, {"url": "https://medium.com/tag/oversampling?source=post_page-----e91d7c44e4bf---------------oversampling-----------------", "anchor_text": "Oversampling"}, {"url": "https://medium.com/tag/wine?source=post_page-----e91d7c44e4bf---------------wine-----------------", "anchor_text": "Wine"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fe91d7c44e4bf&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fupsampling-with-smote-for-classification-projects-e91d7c44e4bf&user=Jonathan+Keller&userId=71e4031b354&source=-----e91d7c44e4bf---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fe91d7c44e4bf&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fupsampling-with-smote-for-classification-projects-e91d7c44e4bf&user=Jonathan+Keller&userId=71e4031b354&source=-----e91d7c44e4bf---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe91d7c44e4bf&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fupsampling-with-smote-for-classification-projects-e91d7c44e4bf&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----e91d7c44e4bf--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fe91d7c44e4bf&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fupsampling-with-smote-for-classification-projects-e91d7c44e4bf&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----e91d7c44e4bf---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----e91d7c44e4bf--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----e91d7c44e4bf--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----e91d7c44e4bf--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----e91d7c44e4bf--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----e91d7c44e4bf--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----e91d7c44e4bf--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----e91d7c44e4bf--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----e91d7c44e4bf--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@jmcneilkeller?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@jmcneilkeller?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Jonathan Keller"}, {"url": "https://medium.com/@jmcneilkeller/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "132 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F71e4031b354&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fupsampling-with-smote-for-classification-projects-e91d7c44e4bf&user=Jonathan+Keller&userId=71e4031b354&source=post_page-71e4031b354--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F72ed7f59d563&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fupsampling-with-smote-for-classification-projects-e91d7c44e4bf&newsletterV3=71e4031b354&newsletterV3Id=72ed7f59d563&user=Jonathan+Keller&userId=71e4031b354&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}