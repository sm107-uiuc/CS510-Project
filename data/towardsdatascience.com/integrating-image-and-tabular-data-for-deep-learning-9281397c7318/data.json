{"url": "https://towardsdatascience.com/integrating-image-and-tabular-data-for-deep-learning-9281397c7318", "time": 1683009413.604747, "path": "towardsdatascience.com/integrating-image-and-tabular-data-for-deep-learning-9281397c7318/", "webpage": {"metadata": {"title": "Integrating image and tabular data for deep learning | by Yuan Tian | Towards Data Science", "h1": "Integrating image and tabular data for deep learning", "description": "I recently participated in the SIIM-ISIC Melanoma Classification competition on Kaggle. In this competition, participants are asked to identify melanoma in images of skin lesions. Interestingly, they\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.kaggle.com/c/siim-isic-melanoma-classification", "anchor_text": "SIIM-ISIC Melanoma Classification", "paragraph_index": 0}, {"url": "https://becominghuman.ai/detecting-pneumonia-with-deep-learning-3cf49b640c14", "anchor_text": "CNN", "paragraph_index": 0}, {"url": "https://medium.com/@yuan_tian/predict-ufc-fights-with-deep-learning-e285652b4a6e", "anchor_text": "UFC", "paragraph_index": 0}, {"url": "https://medium.com/@yuan_tian/predicting-league-of-legends-match-outcome-with-embeddings-and-deep-learning-b7d1446c710f", "anchor_text": "League of Legends", "paragraph_index": 0}, {"url": "https://www.kaggle.com/c/siim-isic-melanoma-classification/discussion/155251", "anchor_text": "thread", "paragraph_index": 0}, {"url": "https://github.com/naity/image_tabular", "anchor_text": "image_tabular", "paragraph_index": 0}, {"url": "https://www.kaggle.com/c/siim-isic-melanoma-classification/data", "anchor_text": "here", "paragraph_index": 1}, {"url": "https://www.sciencedirect.com/science/article/pii/S2215016120300832", "anchor_text": "paper", "paragraph_index": 4}, {"url": "https://github.com/fastai/fastai", "anchor_text": "fastai", "paragraph_index": 5}, {"url": "https://github.com/naity/image_tabular", "anchor_text": "image_tabular", "paragraph_index": 6}, {"url": "https://github.com/naity/image_tabular", "anchor_text": "image_tabular", "paragraph_index": 7}, {"url": "https://medium.com/@yuan_tian/predicting-league-of-legends-match-outcome-with-embeddings-and-deep-learning-b7d1446c710f", "anchor_text": "embeddings", "paragraph_index": 9}, {"url": "https://github.com/naity/image_tabular", "anchor_text": "image_tabular", "paragraph_index": 10}, {"url": "https://github.com/naity/image_tabular/blob/master/siim_isic_integrated_model.ipynb", "anchor_text": "notebook", "paragraph_index": 12}, {"url": "https://github.com/naity/image_tabular", "anchor_text": "here", "paragraph_index": 15}, {"url": "https://github.com/naity/image_tabular", "anchor_text": "image_tabular", "paragraph_index": 16}, {"url": "https://github.com/fastai/fastai", "anchor_text": "fastai", "paragraph_index": 16}, {"url": "https://gist.github.com/jwuphysics/f19162d38e1b4fed0030b96411186c3a", "anchor_text": "code", "paragraph_index": 16}], "all_paragraphs": ["I recently participated in the SIIM-ISIC Melanoma Classification competition on Kaggle. In this competition, participants are asked to identify melanoma in images of skin lesions. Interestingly, they also provide metadata about the patient and the anatomic site in addition to the image. In essence, we have both image and structured or tabular data for each example. For the image, we can use a CNN-based model, and for the tabular data, we can use embeddings and fully connected layers as explored in my previous posts on UFC and League of Legends predictions. It is easy to build two separate models for each data modality. But what if we want to build a joint model that trains on both data modalities simultaneously? There are inspiring discussions in the competition forum including this thread. In this post, I will demonstrate how to integrate the two data modalities and train a joint deep learning model using fastai and the image_tabular library, which I created specifically for these tasks.", "The SIIM-ISIC Melanoma Classification dataset can be downloaded here. The training set consists of 32542 benign images and 584 malignant melanoma images. Please note that this dataset is extremely unbalanced. The picture below shows one example from each class. It seems that malignant lesions are larger and more diffused than benign ones.", "As mentioned above, there are metadata available in addition to the images as shown below:", "We can perform some basic analysis to investigate whether some of these features are associated with the target. Interestingly, males are more likely to have malignant melanoma than females, and age also seems to be a risk factor of having malignant melanoma as shown below. In addition, the frequency of malignancy melanoma differs between the locations of the imaged site with the head/neck showing the highest malignancy rate. Therefore, these features contain useful information, and combining them with the images could help our model make better predictions. This makes sense as doctors will probably not only examine images of skin lesions but also consider additional factors in order to make a diagnosis.", "Our approach to integrating both image and tabular data is very similar to the one taken by the winners of the ISIC 2019 Skin Lesion Classification Challenge as described in their paper and shown in the picture below. Basically, we first load the image and tabular data for each sample, which are fed into a CNN model and a fully connected neural network, respectively. Subsequently, the outputs from the two networks will be concatenated and fed into an additional fully connected neural network to generate final predictions.", "To implement the idea, we will be using Pytorch and fastai. More specifically, we will use fastai to load the image and tabular data and package them into fastai LabelLists.", "Next, we will integrate the two data modalities using the image_tabular library, which can be installed by running:", "We will use the get_imagetabdatasets function from image_tabular to integrate image and tabular LabelLists.", "The databunch contains both image and tabular data and is ready to be used for training and prediction.", "Once the data is ready, we can then move on to build the model. First, we need to create a CNN model, resnet50 in this case, and a tabular model using fastai. We will treat sex and anatomic site as categorical features and represent them using embeddings in the tabular model.", "We are now ready to build a joint model, again using the image_tabular library. We can customize the fully connected layers by specifying the layers parameter.", "Finally, we can pack everything into a fastai learner and train the joint model.", "The entire workflow is detailed in this Jupyter notebook.", "The model achieved a ROC AUC score of about 0.87 on the validation set after training for 15 epochs. I subsequently submitted the predictions made by the trained model on the test set to Kaggle and got a public score of 0.864. There is definitely much room for improvement.", "In this post, we used fastai and image_tabular to integrate image and tabular data and built a joint model trained on both data modalities simultaneously. As noted above, there are many opportunities for further improvement. For example, we can try more advanced CNN architectures such as ResNeXt. Another question would be how many neurons should we allocate for image and tabular data before concatenation, in other words, how should we decide the relative importance or weights of the two data modalities? I hope this could serve as a framework for further experimentation and improvement.", "The source code of image_tabular and jupyter notebooks for the SIIM-ISIC Melanoma Classification competition can be found here.", "The image_tabular library relies on the fantastic fastai library and was inspired by the code of John F. Wu.", "I am an immunologist with bioinformatics and programming skills. I am interested in data analysis, machine learning, and deep learning.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F9281397c7318&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintegrating-image-and-tabular-data-for-deep-learning-9281397c7318&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintegrating-image-and-tabular-data-for-deep-learning-9281397c7318&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintegrating-image-and-tabular-data-for-deep-learning-9281397c7318&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintegrating-image-and-tabular-data-for-deep-learning-9281397c7318&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----9281397c7318--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----9281397c7318--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@yuan_tian?source=post_page-----9281397c7318--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@yuan_tian?source=post_page-----9281397c7318--------------------------------", "anchor_text": "Yuan Tian"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F98d39400f6fe&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintegrating-image-and-tabular-data-for-deep-learning-9281397c7318&user=Yuan+Tian&userId=98d39400f6fe&source=post_page-98d39400f6fe----9281397c7318---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F9281397c7318&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintegrating-image-and-tabular-data-for-deep-learning-9281397c7318&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F9281397c7318&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintegrating-image-and-tabular-data-for-deep-learning-9281397c7318&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@ikukevk?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Kevin Ku"}, {"url": "https://towardsdatascience.com/s/photos/machine-learning?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://www.iconfinder.com/ibrandify", "anchor_text": "ibrandify"}, {"url": "https://www.kaggle.com/c/siim-isic-melanoma-classification", "anchor_text": "SIIM-ISIC Melanoma Classification"}, {"url": "https://becominghuman.ai/detecting-pneumonia-with-deep-learning-3cf49b640c14", "anchor_text": "CNN"}, {"url": "https://medium.com/@yuan_tian/predict-ufc-fights-with-deep-learning-e285652b4a6e", "anchor_text": "UFC"}, {"url": "https://medium.com/@yuan_tian/predicting-league-of-legends-match-outcome-with-embeddings-and-deep-learning-b7d1446c710f", "anchor_text": "League of Legends"}, {"url": "https://www.kaggle.com/c/siim-isic-melanoma-classification/discussion/155251", "anchor_text": "thread"}, {"url": "https://github.com/naity/image_tabular", "anchor_text": "image_tabular"}, {"url": "https://www.kaggle.com/c/siim-isic-melanoma-classification/data", "anchor_text": "here"}, {"url": "https://www.sciencedirect.com/science/article/pii/S2215016120300832", "anchor_text": "paper"}, {"url": "https://github.com/fastai/fastai", "anchor_text": "fastai"}, {"url": "https://github.com/naity/image_tabular", "anchor_text": "image_tabular"}, {"url": "https://github.com/naity/image_tabular", "anchor_text": "image_tabular"}, {"url": "https://medium.com/@yuan_tian/predicting-league-of-legends-match-outcome-with-embeddings-and-deep-learning-b7d1446c710f", "anchor_text": "embeddings"}, {"url": "https://github.com/naity/image_tabular", "anchor_text": "image_tabular"}, {"url": "https://github.com/naity/image_tabular/blob/master/siim_isic_integrated_model.ipynb", "anchor_text": "notebook"}, {"url": "https://github.com/naity/image_tabular", "anchor_text": "here"}, {"url": "https://github.com/naity/image_tabular", "anchor_text": "image_tabular"}, {"url": "https://github.com/fastai/fastai", "anchor_text": "fastai"}, {"url": "https://gist.github.com/jwuphysics/f19162d38e1b4fed0030b96411186c3a", "anchor_text": "code"}, {"url": "http://www.ytian.me/", "anchor_text": "www.ytian.me"}, {"url": "https://medium.com/@yuan_tian", "anchor_text": "https://medium.com/@yuan_tian"}, {"url": "https://www.linkedin.com/in/ytianimmune/", "anchor_text": "https://www.linkedin.com/in/ytianimmune/"}, {"url": "https://twitter.com/_ytian_", "anchor_text": "https://twitter.com/_ytian_"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----9281397c7318---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/tabular-data?source=post_page-----9281397c7318---------------tabular_data-----------------", "anchor_text": "Tabular Data"}, {"url": "https://medium.com/tag/image-classification?source=post_page-----9281397c7318---------------image_classification-----------------", "anchor_text": "Image Classification"}, {"url": "https://medium.com/tag/fastai?source=post_page-----9281397c7318---------------fastai-----------------", "anchor_text": "Fastai"}, {"url": "https://medium.com/tag/towards-data-science?source=post_page-----9281397c7318---------------towards_data_science-----------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F9281397c7318&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintegrating-image-and-tabular-data-for-deep-learning-9281397c7318&user=Yuan+Tian&userId=98d39400f6fe&source=-----9281397c7318---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F9281397c7318&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintegrating-image-and-tabular-data-for-deep-learning-9281397c7318&user=Yuan+Tian&userId=98d39400f6fe&source=-----9281397c7318---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F9281397c7318&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintegrating-image-and-tabular-data-for-deep-learning-9281397c7318&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----9281397c7318--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F9281397c7318&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintegrating-image-and-tabular-data-for-deep-learning-9281397c7318&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----9281397c7318---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----9281397c7318--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----9281397c7318--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----9281397c7318--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----9281397c7318--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----9281397c7318--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----9281397c7318--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----9281397c7318--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----9281397c7318--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@yuan_tian?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@yuan_tian?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Yuan Tian"}, {"url": "https://medium.com/@yuan_tian/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "175 Followers"}, {"url": "http://www.ytiancompbio.com", "anchor_text": "www.ytiancompbio.com"}, {"url": "http://www.linkedin.com/in/ytiancompbio", "anchor_text": "www.linkedin.com/in/ytiancompbio"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F98d39400f6fe&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintegrating-image-and-tabular-data-for-deep-learning-9281397c7318&user=Yuan+Tian&userId=98d39400f6fe&source=post_page-98d39400f6fe--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F1f5496065b8e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintegrating-image-and-tabular-data-for-deep-learning-9281397c7318&newsletterV3=98d39400f6fe&newsletterV3Id=1f5496065b8e&user=Yuan+Tian&userId=98d39400f6fe&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}