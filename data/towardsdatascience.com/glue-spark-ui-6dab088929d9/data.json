{"url": "https://towardsdatascience.com/glue-spark-ui-6dab088929d9", "time": 1683009041.933698, "path": "towardsdatascience.com/glue-spark-ui-6dab088929d9/", "webpage": {"metadata": {"title": "Advanced monitoring of AWS glue jobs by enabling spark UI | by Shubham Jain | Towards Data Science", "h1": "Advanced monitoring of AWS glue jobs by enabling spark UI", "description": "Docker container to enable advanced monitoring of aws glue jobs using sparkUI. Launching spark history server to view glue job logs and to optimize them."}, "outgoing_paragraph_urls": [{"url": "https://github.com/jnshubham/glue_sparkui_docker", "anchor_text": "GitHub", "paragraph_index": 31}, {"url": "https://hub.docker.com/repository/docker/jnshubham/glue_sparkui", "anchor_text": "dockerhub", "paragraph_index": 31}], "all_paragraphs": ["Apache spark is currently an indispensable framework when it comes to processing huge datasets. Most of the data engineers and data scientists who are dealing with large amounts of data leverages spark capabilities at some point in time.", "When it comes to understanding of spark, 20% comprises of the code syntax, 30% are the data engineering concepts and the rest 50% is the optimization", "Code syntax consists of the use of functions and the syntax, data engineering concepts reflects the knowledge of SQL, efficient query building and creating optimized query and optimization includes how well the cluster is managed and running the code with the minimal shuffle, dealing with inevitable small files, optimizing joins, dealing with long-running jobs, optimization of skewed datasets and utilizing the complete cluster.", "The syntax definition and data engineering concepts can be learned over time but to optimize the cluster you need to visualize how your cluster is responding to the queries executed over it.", "SparkUI is needed to identify the root cause behind long-running jobs, Visualizing DAGs, OOM issues, disk spills, excessive shuffling, skewed datasets, and overall health of the cluster.", "To use apache spark we need large clusters but sometimes, managing these clusters becomes a bit of additional overhead. So we started leveraging clusters on the cloud using AWS EMR or GCP Dataproc but again we need to manage these clusters and make the most of them. Now there was a need for something where we can run our spark workloads and pay for only what we use. That\u2019s where AWS glue comes into the picture.", "Aws Glue is serverless, therefore we don\u2019t need to manage the clusters or worry about the running cost associated with it. We pay only for the time we utilize the resources and as soon our job is done, the resources are deallocated.", "Every good thing comes with a price, so the catch here is we cannot fully configure our glue jobs in terms of optimization. Also, we cannot view the spark UI for the jobs in realtime, instead, we need to run a Spark History server which allows us to see the Spark UI for the glue jobs.", "To enable the spark UI we need to follow some steps:", "Create a new job and in the monitoring section enable the spark UI option and provide an s3 path for logs generation.", "We will now be creating a Spark History server from which we can visualize the DAG and task details for the glue jobs.", "The Dockerfile for the same is:", "I am taking alpine as the base image as I want this docker container to be very lite in size.", "Installing Java 8, Maven and bash shell", "Fetching spark 2.4 and unzipping as this contains the class for enabling the history server", "Copy pom.xml to the container for installing the dependency and build it using maven", "Removing maven as the build is now successful and also removing the conflicting jars", "Adding the port number to enable the history server, you can change it according to your requirement. We need to add the property to the spark-defaults.conf file.", "You can also change the port number here.", "Adding the entrypoint to the docker container, this entrypoint will enable the spark history server.", "Now build and run the docker container from this file.", "To build the image out of this Dockerfile run the following command:", "You can pull the pre-build image available on the docker hub also.", "To pull the image run the following command:", "To run the container and start the history server run the following commands:", "To run the container with Access key and secret key", "To run the container with the IAM role configured to your EC2 for accessing s3 bucket", "To access the history server enable the port 18080 in security groups inbound rule to allow traffic.", "Once you have some successful logs open the ip:18080 to open the history server which will show the spark ui for the glue jobs:", "You can now visualize the DAGs generated and the query performance. You can also track the time taken by each task and then work on the optimization of the same.", "Hope you all liked the article.", "For more information, visit my GitHub or dockerhub.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F6dab088929d9&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fglue-spark-ui-6dab088929d9&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fglue-spark-ui-6dab088929d9&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fglue-spark-ui-6dab088929d9&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fglue-spark-ui-6dab088929d9&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----6dab088929d9--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----6dab088929d9--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@jnshubham?source=post_page-----6dab088929d9--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@jnshubham?source=post_page-----6dab088929d9--------------------------------", "anchor_text": "Shubham Jain"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fa7eea8d05a87&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fglue-spark-ui-6dab088929d9&user=Shubham+Jain&userId=a7eea8d05a87&source=post_page-a7eea8d05a87----6dab088929d9---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F6dab088929d9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fglue-spark-ui-6dab088929d9&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F6dab088929d9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fglue-spark-ui-6dab088929d9&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@kmuza?utm_source=medium&utm_medium=referral", "anchor_text": "Carlos Muza"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://archive.apache.org/dist/spark/spark-2.4.3/spark-2.4.3-bin-without-hadoop.tgz", "anchor_text": "https://archive.apache.org/dist/spark/spark-2.4.3/spark-2.4.3-bin-without-hadoop.tgz"}, {"url": "https://github.com/jnshubham/glue_sparkui_docker", "anchor_text": "GitHub"}, {"url": "https://hub.docker.com/repository/docker/jnshubham/glue_sparkui", "anchor_text": "dockerhub"}, {"url": "https://medium.com/tag/pyspark?source=post_page-----6dab088929d9---------------pyspark-----------------", "anchor_text": "Pyspark"}, {"url": "https://medium.com/tag/aws?source=post_page-----6dab088929d9---------------aws-----------------", "anchor_text": "AWS"}, {"url": "https://medium.com/tag/spark?source=post_page-----6dab088929d9---------------spark-----------------", "anchor_text": "Spark"}, {"url": "https://medium.com/tag/ec2?source=post_page-----6dab088929d9---------------ec2-----------------", "anchor_text": "Ec2"}, {"url": "https://medium.com/tag/aws-glue?source=post_page-----6dab088929d9---------------aws_glue-----------------", "anchor_text": "Aws Glue"}, {"url": "http://creativecommons.org/licenses/by/4.0/", "anchor_text": "Some rights reserved"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F6dab088929d9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fglue-spark-ui-6dab088929d9&user=Shubham+Jain&userId=a7eea8d05a87&source=-----6dab088929d9---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F6dab088929d9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fglue-spark-ui-6dab088929d9&user=Shubham+Jain&userId=a7eea8d05a87&source=-----6dab088929d9---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F6dab088929d9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fglue-spark-ui-6dab088929d9&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----6dab088929d9--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F6dab088929d9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fglue-spark-ui-6dab088929d9&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----6dab088929d9---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----6dab088929d9--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----6dab088929d9--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----6dab088929d9--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----6dab088929d9--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----6dab088929d9--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----6dab088929d9--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----6dab088929d9--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----6dab088929d9--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@jnshubham?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@jnshubham?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Shubham Jain"}, {"url": "https://medium.com/@jnshubham/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "45 Followers"}, {"url": "https://jnshubham.github.io", "anchor_text": "https://jnshubham.github.io"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fa7eea8d05a87&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fglue-spark-ui-6dab088929d9&user=Shubham+Jain&userId=a7eea8d05a87&source=post_page-a7eea8d05a87--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fusers%2Fa7eea8d05a87%2Flazily-enable-writer-subscription&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fglue-spark-ui-6dab088929d9&user=Shubham+Jain&userId=a7eea8d05a87&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}