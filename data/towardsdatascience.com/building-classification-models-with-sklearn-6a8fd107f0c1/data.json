{"url": "https://towardsdatascience.com/building-classification-models-with-sklearn-6a8fd107f0c1", "time": 1683003519.189947, "path": "towardsdatascience.com/building-classification-models-with-sklearn-6a8fd107f0c1/", "webpage": {"metadata": {"title": "Building Classification Models with Sklearn | by Sadrach Pierre, Ph.D. | Towards Data Science", "h1": "Building Classification Models with Sklearn", "description": "Scikit-learn is an open-source machine learning library for python. It provides a variety of regression, classification, and clustering algorithms. In my previous post, A Brief Tour of Sklearn, I\u2026"}, "outgoing_paragraph_urls": [{"url": "https://towardsdatascience.com/a-brief-tour-of-scikit-learn-sklearn-6e829a9db2fd", "anchor_text": "A Brief Tour of Sklearn", "paragraph_index": 0}, {"url": "https://scikit-learn.org/stable/", "anchor_text": "here", "paragraph_index": 0}, {"url": "https://www.kaggle.com/blastchar/telco-customer-churn", "anchor_text": "here", "paragraph_index": 1}, {"url": "https://github.com/spierre91/medium_code", "anchor_text": "GitHub", "paragraph_index": 32}], "all_paragraphs": ["Scikit-learn is an open-source machine learning library for python. It provides a variety of regression, classification, and clustering algorithms. In my previous post, A Brief Tour of Sklearn, I discussed several methods for regression using the machine learning package. In this post, we will go over some of the basic methods for building classification models. The documentation for this package is extensive and a fantastic resource for every data scientist. You can find the documentation here.", "We will be using the Telco Customer Churn dataset. It can be found here", "First, let\u2019s import the data and print the first five rows:", "We will be using all of the categorical and numerical data to predict Churn. First, we need to convert the categorical columns into numerical values that the neural network can handle. For example, for gender we have:", "Now, let\u2019s define our input and output arrays:", "We will then split our data for training and testing:", "Now all of our necessary variables are defined. Let\u2019s build some models!", "Let\u2019s start with logistic regression. Logistic regression uses a logistic function to predict a binary dependent variable.", "We import the LogisticRegression package as follows:", "Let\u2019s define a logistic regression object, fit our model, and evaluate performance:", "We can visualize the predictions using metrics classification report:", "We can also look at the \u2018roc_auc_score\u2019 and the \u2018f1_score.\u2019 The \u2018roc_auc_score\u2019 is the area under the receiving operating characteristic curve. It is a measure of how well the binary classification model can distinguish classes. A \u2018roc_auc_score\u2019 of 0.5 means the model is unable to distinguish between classes. Values close to 1.0 correspond to a strong separation between classes. The \u2018f1_score\u2019 is the harmonic mean of precision and recall. Similar to \u2018roc_auc_score\u2019, a perfect \u2018f1_score\u2019 is equal to 1.0:", "Now let\u2019s take a look at random forests. Random forest is a tree-based method that ensembles multiple individual decision trees.", "We import the RandomForestClassifier package as follows:", "Let\u2019s define a random forest classification object, fit our model, and evaluate performance:", "And let\u2019s take a look at the metrics classification report:", "We see that the random forest has worse performance than logistic regression. We can also print the feature importance. This allows us to see which variables are most significant for temperature prediction:", "I\u2019d like to point out that by not passing any parameters, like max_depth and n_estimators, I selected default random forest values (which are n_estimators = 10 and max_depth = 10 ). We can further improve performance by optimizing parameters in random forests. This can be done manually or in an automated way using grid search techniques. I will leave the matter of parameter optimization for another post.", "The next method I\u2019ll discuss is called support vector regression. This is an extension of support vector machines (SVM). SVMs construct a set of hyperplanes in high dimensional feature space that can be used for regression and classification problems.", "We import the SVC package as follows:", "Let\u2019s define a support vector classification object, fit our model, and evaluate performance:", "We can visualize the predictions using metrics classification report:", "We can also look at the roc_auc_score and the f1_scores:", "We see that support vector classification performance is slightly worse than logistic regression and slightly better than random forests. Similar to the random forest, SVC takes parameters that can be used to optimize performance. These include the regularization parameter (default C = 1.0), kernel (default kernel = \u2018rbf\u2019) and the kernel coefficient (default gamma = \u2018scale\u2019)", "The final method I will discuss is k-nearest neighbor for classification. K-nearest neighbors use Euclidean distance calculations where the prediction is the average of the k nearest neighbors.", "We import the KNeighborsClassifier package as follows:", "Let\u2019s define a k-nearest neighbor classification object, fit our model, and evaluate performance:", "And let\u2019s take a look at the metrics classification report:", "We can also look at the roc_auc_score and the f1_scores:", "The K-nearest neighbor algorithm also takes hyper-parameters, specifically n_neighbors, which can be selected to minimized error.", "I will stop here but feel free to play around with model feature selection to see if you can improve the performance of some of these models.", "To recap, I outlined a brief introduction to classification using the python machine learning library. I went over how to define model objects, fit models to data, and predict output using logistic regression, random forest, support vector machine, and K-nearest neighbor models.", "I hope this post was informative. The code from this post is available on GitHub. Thank you for reading and happy machine learning!", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Writer for Built In & Towards Data Science. Cornell University Ph. D. in Chemical Physics."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F6a8fd107f0c1&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-classification-models-with-sklearn-6a8fd107f0c1&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-classification-models-with-sklearn-6a8fd107f0c1&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-classification-models-with-sklearn-6a8fd107f0c1&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-classification-models-with-sklearn-6a8fd107f0c1&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----6a8fd107f0c1--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----6a8fd107f0c1--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://spierre91.medium.com/?source=post_page-----6a8fd107f0c1--------------------------------", "anchor_text": ""}, {"url": "https://spierre91.medium.com/?source=post_page-----6a8fd107f0c1--------------------------------", "anchor_text": "Sadrach Pierre, Ph.D."}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F120b86134681&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-classification-models-with-sklearn-6a8fd107f0c1&user=Sadrach+Pierre%2C+Ph.D.&userId=120b86134681&source=post_page-120b86134681----6a8fd107f0c1---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F6a8fd107f0c1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-classification-models-with-sklearn-6a8fd107f0c1&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F6a8fd107f0c1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-classification-models-with-sklearn-6a8fd107f0c1&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://www.pexels.com/@mccutcheon", "anchor_text": "Sharon McCutcheon"}, {"url": "https://www.pexels.com/photo/art-materials-art-supplies-blocks-blur-1148496/", "anchor_text": "Pexels"}, {"url": "https://towardsdatascience.com/a-brief-tour-of-scikit-learn-sklearn-6e829a9db2fd", "anchor_text": "A Brief Tour of Sklearn"}, {"url": "https://scikit-learn.org/stable/", "anchor_text": "here"}, {"url": "https://www.kaggle.com/blastchar/telco-customer-churn", "anchor_text": "here"}, {"url": "https://github.com/spierre91/medium_code", "anchor_text": "GitHub"}, {"url": "https://medium.com/tag/python?source=post_page-----6a8fd107f0c1---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----6a8fd107f0c1---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----6a8fd107f0c1---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/programming?source=post_page-----6a8fd107f0c1---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----6a8fd107f0c1---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F6a8fd107f0c1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-classification-models-with-sklearn-6a8fd107f0c1&user=Sadrach+Pierre%2C+Ph.D.&userId=120b86134681&source=-----6a8fd107f0c1---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F6a8fd107f0c1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-classification-models-with-sklearn-6a8fd107f0c1&user=Sadrach+Pierre%2C+Ph.D.&userId=120b86134681&source=-----6a8fd107f0c1---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F6a8fd107f0c1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-classification-models-with-sklearn-6a8fd107f0c1&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----6a8fd107f0c1--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F6a8fd107f0c1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-classification-models-with-sklearn-6a8fd107f0c1&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----6a8fd107f0c1---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----6a8fd107f0c1--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----6a8fd107f0c1--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----6a8fd107f0c1--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----6a8fd107f0c1--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----6a8fd107f0c1--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----6a8fd107f0c1--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----6a8fd107f0c1--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----6a8fd107f0c1--------------------------------", "anchor_text": ""}, {"url": "https://spierre91.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://spierre91.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Sadrach Pierre, Ph.D."}, {"url": "https://spierre91.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "3.7K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F120b86134681&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-classification-models-with-sklearn-6a8fd107f0c1&user=Sadrach+Pierre%2C+Ph.D.&userId=120b86134681&source=post_page-120b86134681--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F4efebd4f21b7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-classification-models-with-sklearn-6a8fd107f0c1&newsletterV3=120b86134681&newsletterV3Id=4efebd4f21b7&user=Sadrach+Pierre%2C+Ph.D.&userId=120b86134681&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}