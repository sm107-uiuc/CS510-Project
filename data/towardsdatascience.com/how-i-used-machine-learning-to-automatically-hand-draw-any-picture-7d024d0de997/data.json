{"url": "https://towardsdatascience.com/how-i-used-machine-learning-to-automatically-hand-draw-any-picture-7d024d0de997", "time": 1683008391.448422, "path": "towardsdatascience.com/how-i-used-machine-learning-to-automatically-hand-draw-any-picture-7d024d0de997/", "webpage": {"metadata": {"title": "Using Machine Learning to Draw Pictures | Towards Data Science", "h1": "How I Used Machine Learning to Automatically Hand-Draw Any Picture", "description": "Use of K-Nearest Neighbors, K-Means Clustering and optimization algorithms to train machine learning agent to draw any picture."}, "outgoing_paragraph_urls": [{"url": "https://medium.com/u/180dbaaffa4e?source=post_page-----7d024d0de997--------------------------------", "anchor_text": "Savan Patel", "paragraph_index": 18}, {"url": "https://medium.com/u/a823d37636a4?source=post_page-----7d024d0de997--------------------------------", "anchor_text": "Daniel Foley", "paragraph_index": 26}], "all_paragraphs": ["There\u2019s nothing better than making robots do useless things. I\u2019m abysmal when it comes to art, so I decided to play to my strengths and trained an agent to hand-draw any picture for me on MS paint.", "However, let\u2019s be honest. I easily could\u2019ve edited the image, blended some of the pixel colors, and voila! I\u2019ve created the same painting-like image that you saw in the first photo.", "Yes, drawing it in MS Paint is tedious, time-consuming, and quite cumbersome. BUT, it shows that basic knowledge of artificial intelligence, machine learning, and optimization can allow us to make amazing things. Here, I\u2019ll outline how I designed this agent to draw any picture.", "TLDR: Use OpenCV to apply an optional Gaussian filter, extract lines using Canny Edge Detection, and use binary thresholding to make our edges black. There are hyperparameters that control the relative size of the drawing and its detail.", "First things first: we need to extract the edges from our image. That way, the agent knows what lines to sketch. Using OpenCV, we apply a Gaussian filter and use Canny Edge Detection to extract a large majority of the relevant lines to be drawn. Then, after using inverse binary thresholding to make our edges black, we can extract the desired outline for our program to draw!", "I provided three options that mix-matched Gaussian blur kernel sizes and Canny Edge Detection thresholds. Generally, increased Gaussian blur is paired with lower thresholding and vice versa. How do we decide which option to use? Answer: it depends on the image\u2019s detail.", "Some pictures simply have too many indiscernible lines (like a lion\u2019s mane). In these cases, it\u2019s better to use more blur, because we neglect fine lines and notice stronger ones. On the other hand, some pictures might naturally have enough, discernible details that allow us to use less blur.", "There are also two specific hyperparameters to tune. The variable \u201cscale\u201d determines the portion of the screen we want to dedicate to our drawing. The variable \u201cdetail\u201d determines how much detail we want to preserve from the original image.", "After properly fitting the photo within our dedicated section, we use the detail parameter to shrink the photo into an image with a supposed pseudo dimension. This is the dimension in which we will be planning our sketch pathways (the order in which our program is going to draw in the lines). Also, we add define our origin we\u2019ll be drawing from by using the variables startX and startY. This helps us define the translate method to abstract our implementation from the physical drawing.", "TLDR: Use a super convenient mouse cursor controlling library called PyAutoGui. Construct a list of events consisting of pixels to drag the pencil towards, when to lift the pencil, and when to push the pencil.", "Okay, but before we get into planning the sketch pathways, we need to go over how the heck we\u2019re converting our code into a drawing on MS Paint. We can use a library called PyAutoGui that allows us to control mouse events. First, we construct a list of commands (discussed in the next section) consisting of points to drag the cursor towards, when to release left click, and when to hold left click. Then, we process each command and watch it work miracles!", "Here\u2019s simple code that translates a list of commands into mouse events:", "TLDR: Insert all edge pixels into KD-Tree and Hashset. I used a simple algorithm to plan pathways: Start at any edge pixel. Step two, drag the pencil to non-visited, adjacent pixels favoring pixels maintaining the agent\u2019s current direction. Repeat step two until there are no non-visited adjacent pixels. Use K-Nearest Neighbors to find the nearest undrawn edge pixel and repeat until the picture is completely drawn. Other optimizations were made for execution speed.", "Yes, I easily could\u2019ve just taken this processed image and called it a day, but that\u2019s no fun. Instead, we\u2019re going to use supervised learning and a simple algorithm to find efficiently find a route for the agent to draw.", "We need a way to keep track of our edge pixels efficiently. So, we can stick all the edge pixel coordinates into a HashSet and KD Tree. These will keep track of our undrawn edge pixels. This means that once we finish drawing an edge pixel, we remove it from both data structures.", "Okay, so we know how we\u2019re going to keep track of our edge pixels, but how do we determine the order in which we draw them?", "When we humans draw, we try to maintain directionality. Meaning, we sketch things in smooth, continuous strokes, not jumpy or erratic scrubs. So, we use this idea of momentum.", "We can think of our commands as a list of tuples each telling us where to drag our cursor from and to. When our robot plans its path, after we enter a pixel from a certain direction, we decide the next pixel we travel to by favoring undrawn edge pixels that are most similar to that previous direction. In other words, we look at each of the pixel\u2019s eight neighbors, filter out those that are not undrawn edge pixels, and choose the one that maximizes directionality preservation. If there are none adjacent, use K-Nearest Neighbors to start at a new location.", "For a quick brush-up on K-Nearest Neighbors and K-D Trees, here\u2019s a great tutorial from Savan Patel:", "So, we can summarize this algorithm into a few steps:", "This can be put into code:", "On line 39, you\u2019ll notice there is a slight optimization. We tell the agent: if you\u2019re moving in the same exact direction as the previous step, conjoin the two commands together into one. That way, we can draw a single stroke instead of", "HashSets take [amortized] constant time for lookup and deletion. K-D Trees take O(D*Log(N)) for each query. If we denote N as the total number of pixels in the image, we can find the runtime by looking at each part of the algorithm:", "By summing all the parts together, we get an overall, amortized runtime of O(N*Log(N)) to determine drawing pathways. Of course, the physical act of drawing the picture takes far longer than the computation, but let\u2019s not worry about that!", "TLDR: Interpret each point on the image as a 3-dimensional vector representing BGR values. Using K-Means Clustering, divide the set of points into K groups, each corresponding to a color. Then, use the sketch algorithm above to draw each color in.", "There is an option for us to add color to our image. Here, we\u2019ll go over how our agent determines which colors to use given it is limited in how many it can select.", "K-Means Clustering is an unsupervised learning method that is also quite popular. To review, here\u2019s an article from Daniel Foley:", "In this context, we apply K-Means Clustering to determine which colors our agent will use when filling in the picture. We can think of each point on the image as a 3-dimensional vector denoting its BGR value.", "Side note: OpenCV is weird and puts everything in BGR values instead of RGB", "We can use K-Means Clustering to lump each of these pixels into K clusters, each corresponding to one of the K colors the agent is limited to using. This variable K is tunable in the code.", "Unfortunately, I couldn\u2019t automate color selection on MS paint. So, for each cluster, the program prompts the user to change the color of the pen on MS Paint. The prompted color\u2019s BGR value is equal to the mean of the cluster in question.", "Then, we pass all the pixels in this cluster to the same sketch pathways algorithm from before, only this time using a different color. We repeat for each of the clusters.", "Also, we can decide as a hyperparameter if we want to add additional outlines after all color has been filled in. For my taste, I prefer not to put in the outline, but who am I to judge?", "TLDR: Oh, yes! Everything looks great!", "So, what kinds of pictures can this program draw? Well, practically anything. Of course, it sometimes fails to draw proper outlines when the picture has no definite edges or is slightly blurry, but the colors look fantastic. Even better, it\u2019s quite time-consuming to draw a picture, so we\u2019ve only made a few.", "There you have it! We successfully created an automatic [copycat] artist! This goes to show how far even basic machine learning algorithms can take us! Of course, there are infinitely many subfields, aspects, and techniques used in artificial intelligence, but sometimes, it just takes creativity and a bit of elbow grease to see results, no matter how useless the task is.", "From the classic to state-of-the-art, here are related articles discussing artificial intelligence and reinforcement learning:", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Part-time writer \u00b7 Full-time learner \u00b7 PhD Student @ University of Michigan"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F7d024d0de997&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-i-used-machine-learning-to-automatically-hand-draw-any-picture-7d024d0de997&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-i-used-machine-learning-to-automatically-hand-draw-any-picture-7d024d0de997&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-i-used-machine-learning-to-automatically-hand-draw-any-picture-7d024d0de997&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-i-used-machine-learning-to-automatically-hand-draw-any-picture-7d024d0de997&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----7d024d0de997--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----7d024d0de997--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@austinnguyen517?source=post_page-----7d024d0de997--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@austinnguyen517?source=post_page-----7d024d0de997--------------------------------", "anchor_text": "Austin Nguyen"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F6a1b6c5da9ab&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-i-used-machine-learning-to-automatically-hand-draw-any-picture-7d024d0de997&user=Austin+Nguyen&userId=6a1b6c5da9ab&source=post_page-6a1b6c5da9ab----7d024d0de997---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F7d024d0de997&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-i-used-machine-learning-to-automatically-hand-draw-any-picture-7d024d0de997&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F7d024d0de997&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-i-used-machine-learning-to-automatically-hand-draw-any-picture-7d024d0de997&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://freerangestock.com/photos/83995/wooden-jetty-at-sunset--dreamy-looks.html", "anchor_text": "Source"}, {"url": "https://freerangestock.com/photographer/Jack-Moreh/2728", "anchor_text": "Jack Moreh"}, {"url": "https://www.wallpaperup.com/348242/Swallowand039s_Nest_Crimea_evening_Coast_castle_ocean.html", "anchor_text": "Source"}, {"url": "https://www.wallpaperup.com/member/profile/1115", "anchor_text": "BelleDeese"}, {"url": "https://unsplash.com/@niko_photos?utm_source=medium&utm_medium=referral", "anchor_text": "niko photos"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://medium.com/u/180dbaaffa4e?source=post_page-----7d024d0de997--------------------------------", "anchor_text": "Savan Patel"}, {"url": "https://medium.com/machine-learning-101/k-nearest-neighbors-classifier-1c1ff404d265", "anchor_text": "Chapter 4: K Nearest Neighbors ClassifierThe fourth and last basic classifier in supervised learning! K nearest Neighbors. In this post, we will discuss about\u2026medium.com"}, {"url": "https://unsplash.com/@pawel_czerwinski?utm_source=medium&utm_medium=referral", "anchor_text": "Pawe\u0142 Czerwi\u0144ski"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://medium.com/u/a823d37636a4?source=post_page-----7d024d0de997--------------------------------", "anchor_text": "Daniel Foley"}, {"url": "https://towardsdatascience.com/k-means-clustering-8e1e64c1561c", "anchor_text": "K-Means ClusteringMaking Sense of Text Data using Unsupervised Learningtowardsdatascience.com"}, {"url": "https://freerangestock.com/photos/83995/wooden-jetty-at-sunset--dreamy-looks.html", "anchor_text": "Source"}, {"url": "https://freerangestock.com/photographer/Jack-Moreh/2728", "anchor_text": "Jack Moreh"}, {"url": "https://freerangestock.com/photos/83995/wooden-jetty-at-sunset--dreamy-looks.html", "anchor_text": "Source"}, {"url": "https://freerangestock.com/photographer/Jack-Moreh/2728", "anchor_text": "Jack Moreh"}, {"url": "https://www.cutoutandkeep.net/projects/how-to-draw-really-cute-macarons", "anchor_text": "Source:"}, {"url": "https://freerangestock.com/photos/83995/wooden-jetty-at-sunset--dreamy-looks.html", "anchor_text": "Source"}, {"url": "https://freerangestock.com/photographer/Jack-Moreh/2728", "anchor_text": "Jack Moreh"}, {"url": "https://www.wallpaperup.com/348242/Swallowand039s_Nest_Crimea_evening_Coast_castle_ocean.html", "anchor_text": "Source"}, {"url": "https://www.wallpaperup.com/member/profile/1115", "anchor_text": "BelleDeese"}, {"url": "https://towardsdatascience.com/openais-multi-agent-deep-deterministic-policy-gradients-maddpg-9d2dad34c82", "anchor_text": "OpenAI\u2019s MADDPG AlgorithmAn actor-critic approach to multi-agent RL problemstowardsdatascience.com"}, {"url": "https://towardsdatascience.com/how-deepminds-unreal-agent-performed-9-times-better-than-experts-on-atari-9c6ee538404e", "anchor_text": "DeepMind\u2019s UNREAL Algorithm ExplainedDeep reinforcement learning at its finesttowardsdatascience.com"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----7d024d0de997---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----7d024d0de997---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----7d024d0de997---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/science?source=post_page-----7d024d0de997---------------science-----------------", "anchor_text": "Science"}, {"url": "https://medium.com/tag/algorithms?source=post_page-----7d024d0de997---------------algorithms-----------------", "anchor_text": "Algorithms"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F7d024d0de997&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-i-used-machine-learning-to-automatically-hand-draw-any-picture-7d024d0de997&user=Austin+Nguyen&userId=6a1b6c5da9ab&source=-----7d024d0de997---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F7d024d0de997&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-i-used-machine-learning-to-automatically-hand-draw-any-picture-7d024d0de997&user=Austin+Nguyen&userId=6a1b6c5da9ab&source=-----7d024d0de997---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F7d024d0de997&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-i-used-machine-learning-to-automatically-hand-draw-any-picture-7d024d0de997&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----7d024d0de997--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F7d024d0de997&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-i-used-machine-learning-to-automatically-hand-draw-any-picture-7d024d0de997&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----7d024d0de997---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----7d024d0de997--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----7d024d0de997--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----7d024d0de997--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----7d024d0de997--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----7d024d0de997--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----7d024d0de997--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----7d024d0de997--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----7d024d0de997--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@austinnguyen517?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@austinnguyen517?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Austin Nguyen"}, {"url": "https://medium.com/@austinnguyen517/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "208 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F6a1b6c5da9ab&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-i-used-machine-learning-to-automatically-hand-draw-any-picture-7d024d0de997&user=Austin+Nguyen&userId=6a1b6c5da9ab&source=post_page-6a1b6c5da9ab--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F2cb997cef03c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-i-used-machine-learning-to-automatically-hand-draw-any-picture-7d024d0de997&newsletterV3=6a1b6c5da9ab&newsletterV3Id=2cb997cef03c&user=Austin+Nguyen&userId=6a1b6c5da9ab&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}