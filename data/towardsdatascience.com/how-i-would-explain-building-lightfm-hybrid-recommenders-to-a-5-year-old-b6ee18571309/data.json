{"url": "https://towardsdatascience.com/how-i-would-explain-building-lightfm-hybrid-recommenders-to-a-5-year-old-b6ee18571309", "time": 1683010348.566161, "path": "towardsdatascience.com/how-i-would-explain-building-lightfm-hybrid-recommenders-to-a-5-year-old-b6ee18571309/", "webpage": {"metadata": {"title": "How I would explain building \u201cLightFM Hybrid Recommenders\u201d to a 5-year old! | by Dr. Varshita Sher | Towards Data Science", "h1": "How I would explain building \u201cLightFM Hybrid Recommenders\u201d to a 5-year old!", "description": "In recommender systems, the cold-start problem refers to the problem of recommending items to an entirely new user i.e. a user who has not interacted with any of the existing items in your database\u2026"}, "outgoing_paragraph_urls": [{"url": "https://podurama.com/", "anchor_text": "Podurama", "paragraph_index": 2}, {"url": "https://github.com/V-Sher/LightFm_HybridRecommenderSystem/blob/master/LightFM%20Worked%20Example.ipynb", "anchor_text": "Jupyter Notebook", "paragraph_index": 6}, {"url": "https://making.lyst.com/lightfm/docs/index.html", "anchor_text": "documentation", "paragraph_index": 31}, {"url": "https://stackoverflow.com/questions/46924119/lightfm-handling-user-and-item-cold-start", "anchor_text": "Stackoverflow", "paragraph_index": 38}, {"url": "https://github.com/V-Sher/LightFm_HybridRecommenderSystem/blob/master/LightFM%20Worked%20Example.ipynb", "anchor_text": "Github", "paragraph_index": 49}, {"url": "https://varshitasher.medium.com/membership", "anchor_text": "my link", "paragraph_index": 51}, {"url": "https://podurama.com", "anchor_text": "https://podurama.com", "paragraph_index": 53}], "all_paragraphs": ["Note: The 5-yr old must have a working knowledge of Python!", "In recommender systems, the cold-start problem refers to the problem of recommending items to an entirely new user i.e. a user who has not interacted with any of the existing items in your database. In other words, if you create the user-item matrix from your initial training data, you would find no row for this new user. A similar analogy can be used for explaining the cold-start problem in the case of an entirely new item.", "This can be quite inconvenient for you as an app developer, for instance when listeners are trying to look for new podcast suggestions to listen to and you got \u2014 zip, zilch, nada, NOTHING. Well, this was precisely the problem in the initial development phases for our podcast app Podurama. Let\u2019s see how LightFM helped us solve that\u2026", "One of the strong points for LightFM is that the model does not suffer from cold start problem, both user and item cold start. The reason is that LightFM allows building a hybrid recommender system.", "A hybrid recommender is a special kind of recommender that uses both collaborative and content based filtering for making recommendations.", "Put simply, LightFM can use the normal user-item interactions for making predictions for known users. In the case of new users, it can make predictions if it knows some additional information about these new users. This additional information could be features like gender, age, ethnicity, etc and must be fed to the algorithm during training.", "I am going to use a (very) small dummy ratings data and features data because I want to be able to show the intermediate outputs at every stage. If you want to follow along, here is the Jupyter Notebook.", "We have four additional pieces of information about each user \u2014 three boolean features \u2014 f1, f2, f3, and a location feature \u2014 loc, which can take two values for now \u2014 Delhi or Mumbai.", "If you have skimmed over the LightFM documentation, you would know that it likes its input data in a specific format. And thus, we must oblige.", "We need to call the fit method to tell LightFM who the users are, what items we are dealing with, in addition to any user/item features.", "We will be passing three inputs to the fit method:", "Passing the list of users and items is pretty straightforward \u2014 just use the \u2018user\u2019 and \u2018item\u2019 columns from df.", "When it comes to passing the user_features, I would highly recommend passing a list in which each element is in a format like 'feature_name:feature_value' (I promise I will explain why I prefer doing it this way and if there are other alternatives, but for now, just bear with me).", "As you rightly guessed, this list was generated by considering all possible feature_name,feature_value pairs that can be encountered in the training set. For instance, for feature_name equal to loc, there can be two feature_values namely mum and del.", "I have written a small code snippet that lets me generate such a list (I call it uf) :", "Finally, with all the pieces available let's call the fit method on our dataset:", "Now that we have the skeleton dataset ready, we are all set to plug in the actual interactions and ratings into it.", "The input to the build_interactions method is an iterable of interactions where each interaction is a tuple containing three elements:", "The interaction weights simply mean if the user \u2018u\u2019 interacted with the item \u2018i\u2019 how important is this interaction. Looking from the perspective of our example, weights would be the rating we have for each (user, item) pair.", "Another instance where plugging weights could be useful is if we are dealing with (user, song) interaction data. In such a case, I could assign a higher weightage to those interactions in which the user listened to more than 3/4th of the song.", "In summary, the interactions matrix tell us if at all the user interacted with an item and the weights matrix quantifies that particular interaction.", "We can check how these two output matrices look like. Since these are sparse matrices, we can use .todense() method. In both matrices, the rows are the users and columns are the items.", "If you are with me so far, kudos to you. This next part is extremely crucial to understand so you can implement it for your own recommender system as well. (Fun fact: A good chunk of the open issues on LightFM Github page are somehow related to the building user/item features topic).", "One super important thing to remember here is that feature1 , feature2, feature3 , etc should be one of the items present in user_features list that we passed to the fit method in the beginning.", "Thus, for our particular dummy data, the input to the build_user_features should be like:", "Again, I have written a (not so small) code snippet that lets me generate such a list:", "Finally, we must associate each element of the feature_list with the corresponding user ids.", "And voila, we have the desired input for the build_user_features method. Let\u2019s go ahead and call that:", "In the user_features matrix above, the rows are the users, and columns are the user features. There is a 1 present whenever that user has that particular user feature present in training data.", "We can see a total of 10 columns, meaning there exists 10 users features. But why 10 you ask, let\u2019s see!", "If you look at the output above, it will become clear why we have 10 user features. By default, the user id itself is a feature too, so we have three from there. The remaining seven must be familiar since we created them in the beginning.", "This step is pretty straightforward and quite generic. You can, of course, follow the documentation and play around with different loss values or learning_schedule options.", "Do not, I repeat, do not get too excited with high AUC. Remember its just dummy data.", "The predict method takes two inputs:", "This right here is why we were building a hybrid recommender in the first place.", "For a new user, this is what we know - (s)he has values for f1, f2, f3 as 1,1, and 0, respectively. Additionally, their location is Delhi.", "Now, we cannot feed this directly to the predict method. We must convert this input into a form that is understandable by our lightFM model.", "Ideally, the input should look like one of the rows in the user_features matrix (see Figure 1 above).", "I found a piece of code on Stackoverflow that does exactly that \u2014 converts user_feature_list to the required format (in our case a sparse matrix with 10 columns). I have only slightly modified the original code and wrapped it up in a reusable function format_newuser_input here:", "Finally, we can start predicting for the new user:", "Here the first argument i.e. 0 no longers refers to the mapped id for user u1. Instead, it means \u2014 pick the first row of the new_user_features sparse matrix. Passing any value other than 0 will raise an error and rightly so since there are no rows beyond row0 in new_user_features.", "Coming back to the promise I made at the beginning, there are alternatives to building the user_features matrix, provided your data is in a specific format.", "As an example, consider a user feature dataframe like the one below:", "If you observe carefully, each of the three features \u2014 ethnicity, gender, under_30yo, has non-overlapping values. In other words, possible values in the ethnicity column are different from the possible values in the gender column which in turn is different from possible values in the under_30yo column.", "If this is the case, we can simply pass user_featureslist of the form [Asian, Hispanic, Female, Male, no, yes] to fit. Subsequently, we must also update the way we build our user features and thus the input to .build_user_features() should be like:", "This looks great. But now answer this?", "What happens when I have one additional piece of information about each user i.e. a new column \u2018height_under_5ft\u2019 which can take values yes or no?", "In such cases, it might be hard to distinguish the Yes/ No from age vs. Yes/No from height. Therefore, to avoid ambiguity, it would be better to use the feature:value format that we talked about in the beginning and pass user_features = ['eth:Asian', 'eth:Hispanic', 'gender:Male', 'gender:Female', 'age:yes', 'age:no', 'height:yes', 'height:no] to fit and the following input to the .build_usear_features()", "There are a lot of different ways one can take this tutorial forward. For starters, try plugging your real dataset instead of this dummy data and see how well your recommender system performs. You can even try creating item_features using a similar methodology we discussed in this tutorial.", "I haven\u2019t talked much about tuning the model, model evaluations, cross-validations, etc but that's for another time. I hope you enjoyed reading, and feel free to fork my code here on Github to try it out for your purposes. As always, I am curious to know if there are better ways to do some of the things I mentioned.", "Oh I almost forgot, \u201cIf you liked this article, you might also enjoy\u201d (pun intended \ud83d\ude1c)", "I enjoy writing step-by-step beginner\u2019s guides, how-to tutorials, interview questions, decoding terminology used in ML/AI, etc. If you want full access to all my articles (and others too), then you can sign up using my link here.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Senior Data Scientist | Explain like I am 5 | Oxford & SFU Alumni | https://podurama.com"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fb6ee18571309&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-i-would-explain-building-lightfm-hybrid-recommenders-to-a-5-year-old-b6ee18571309&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-i-would-explain-building-lightfm-hybrid-recommenders-to-a-5-year-old-b6ee18571309&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-i-would-explain-building-lightfm-hybrid-recommenders-to-a-5-year-old-b6ee18571309&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-i-would-explain-building-lightfm-hybrid-recommenders-to-a-5-year-old-b6ee18571309&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----b6ee18571309--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----b6ee18571309--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://varshitasher.medium.com/?source=post_page-----b6ee18571309--------------------------------", "anchor_text": ""}, {"url": "https://varshitasher.medium.com/?source=post_page-----b6ee18571309--------------------------------", "anchor_text": "Dr. Varshita Sher"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Ff8ca36def59&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-i-would-explain-building-lightfm-hybrid-recommenders-to-a-5-year-old-b6ee18571309&user=Dr.+Varshita+Sher&userId=f8ca36def59&source=post_page-f8ca36def59----b6ee18571309---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb6ee18571309&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-i-would-explain-building-lightfm-hybrid-recommenders-to-a-5-year-old-b6ee18571309&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb6ee18571309&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-i-would-explain-building-lightfm-hybrid-recommenders-to-a-5-year-old-b6ee18571309&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://imgflip.com/i/47bj0b", "anchor_text": "imgflip"}, {"url": "https://podurama.com/", "anchor_text": "Podurama"}, {"url": "https://github.com/V-Sher/LightFm_HybridRecommenderSystem/blob/master/LightFM%20Worked%20Example.ipynb", "anchor_text": "Jupyter Notebook"}, {"url": "https://making.lyst.com/lightfm/docs/index.html", "anchor_text": "documentation"}, {"url": "https://stackoverflow.com/questions/46924119/lightfm-handling-user-and-item-cold-start", "anchor_text": "Stackoverflow"}, {"url": "https://github.com/lyst/lightfm/issues/372", "anchor_text": "https://github.com/lyst/lightfm/issues/372"}, {"url": "https://github.com/V-Sher/LightFm_HybridRecommenderSystem/blob/master/LightFM%20Worked%20Example.ipynb", "anchor_text": "Github"}, {"url": "https://varshitasher.medium.com/membership", "anchor_text": "my link"}, {"url": "https://towardsdatascience.com/how-to-make-most-of-your-python-debugger-in-vscode-9e05dfce533f", "anchor_text": "How to make most of your python debugger in VSCode?Watch variables, use conditional breakpoints, call stack, exception breakpoint, etc- when working on larger projectstowardsdatascience.com"}, {"url": "https://towardsdatascience.com/understanding-python-imports-init-py-and-pythonpath-once-and-for-all-4c5249ab6355", "anchor_text": "Understanding Python imports, __init__.py and pythonpath \u2014 once and for allLearn how to import packages and modules (and the difference between the two)towardsdatascience.com"}, {"url": "https://towardsdatascience.com/time-series-analysis-using-pandas-in-python-f726d87a97d8", "anchor_text": "Time Series Analysis using Pandas in PythonBonus intro to keywords like seasonality, trend, autocorrelation, and much more.towardsdatascience.com"}, {"url": "https://towardsdatascience.com/deploying-h2o-models-as-apis-using-flask-42065a4fa567", "anchor_text": "Deploying H2o models as APIs using FLASKEnd to end example for model training, tuning, and creating simple APIs (with no technical jargon).towardsdatascience.com"}, {"url": "https://medium.com/tag/recommender-systems?source=post_page-----b6ee18571309---------------recommender_systems-----------------", "anchor_text": "Recommender Systems"}, {"url": "https://medium.com/tag/python?source=post_page-----b6ee18571309---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/data-science?source=post_page-----b6ee18571309---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----b6ee18571309---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/lightfm?source=post_page-----b6ee18571309---------------lightfm-----------------", "anchor_text": "Lightfm"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fb6ee18571309&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-i-would-explain-building-lightfm-hybrid-recommenders-to-a-5-year-old-b6ee18571309&user=Dr.+Varshita+Sher&userId=f8ca36def59&source=-----b6ee18571309---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fb6ee18571309&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-i-would-explain-building-lightfm-hybrid-recommenders-to-a-5-year-old-b6ee18571309&user=Dr.+Varshita+Sher&userId=f8ca36def59&source=-----b6ee18571309---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb6ee18571309&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-i-would-explain-building-lightfm-hybrid-recommenders-to-a-5-year-old-b6ee18571309&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----b6ee18571309--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fb6ee18571309&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-i-would-explain-building-lightfm-hybrid-recommenders-to-a-5-year-old-b6ee18571309&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----b6ee18571309---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----b6ee18571309--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----b6ee18571309--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----b6ee18571309--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----b6ee18571309--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----b6ee18571309--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----b6ee18571309--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----b6ee18571309--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----b6ee18571309--------------------------------", "anchor_text": ""}, {"url": "https://varshitasher.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://varshitasher.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Dr. Varshita Sher"}, {"url": "https://varshitasher.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "3.2K Followers"}, {"url": "https://podurama.com", "anchor_text": "https://podurama.com"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Ff8ca36def59&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-i-would-explain-building-lightfm-hybrid-recommenders-to-a-5-year-old-b6ee18571309&user=Dr.+Varshita+Sher&userId=f8ca36def59&source=post_page-f8ca36def59--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F1aea8fe02d9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-i-would-explain-building-lightfm-hybrid-recommenders-to-a-5-year-old-b6ee18571309&newsletterV3=f8ca36def59&newsletterV3Id=1aea8fe02d9&user=Dr.+Varshita+Sher&userId=f8ca36def59&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}