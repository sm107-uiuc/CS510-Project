{"url": "https://towardsdatascience.com/an-example-of-overfitting-and-how-to-avoid-it-f6739e67f394", "time": 1683007873.094896, "path": "towardsdatascience.com/an-example-of-overfitting-and-how-to-avoid-it-f6739e67f394/", "webpage": {"metadata": {"title": "An example of overfitting and how to avoid it | by Gianluca Malato | Towards Data Science", "h1": "An example of overfitting and how to avoid it", "description": "Overfitting is a tremendous enemy for a data scientist trying to train a supervised model. It will affect performances in a dramatic way and the results can be very dangerous in a production\u2026"}, "outgoing_paragraph_urls": [{"url": "http://YourDataTeacher.com", "anchor_text": "YourDataTeacher.com", "paragraph_index": 36}], "all_paragraphs": ["Overfitting is a tremendous enemy for a data scientist trying to train a supervised model. It will affect performances in a dramatic way and the results can be very dangerous in a production environment.", "But what is overfitting exactly? In this article, I explain how to identify and avoid it.", "Overfitting occurs when your model learns too much from training data and isn\u2019t able to generalize the underlying information. When this happens, the model is able to describe training data very accurately but loses precision on every dataset it has not been trained on. This is completely bad because we want our model to be reasonably good on data that it has never seen before.", "In machine learning, simplicity is the key. We want to generalize the information obtained from the training dataset, so we can surely say that we run the risk of overfitting if we use complex models.", "Complex models will likely over-learn from training data and will think that the random error that drifts training data from the underlying dynamics is actually worth learning from. That\u2019s the exact point at which the model stops generalizing and starts overfitting.", "Complexity is often measured with the number of parameters used by your model during it\u2019s learning procedure. For example, the number of parameters in linear regression, the number of neurons in a neural network, and so on.", "So, the lower the number of the parameters, the higher the simplicity and, reasonably, the lower the risk of overfitting.", "Let\u2019s make a simple example with the help of some Python code.", "I\u2019m going to create a set of 20 points that follow the formula:", "Each point will be added a normally distributed error with 0 mean and 0.05 standard deviation. In real-life data science, data always drifts from the \u201creal\u201d model by a random error.", "Once we have created this dataset, we are going to fit a polynomial model of higher and higher degree and see what happens both in the training set and in the test set. In real life, we don\u2019t know the real model inside our dataset, so we must try different models and see which one fits better.", "We\u2019ll take the first 12 points as the training set and the last 8 points as the test set.", "First, let\u2019s import some useful libraries:", "Let\u2019s now create the sample points:", "As you can see, there\u2019s actually a little noise, just like in real-life fitting.", "Now, let\u2019s split this dataset into training and test.", "We can now define a simple function that, given the training set and the degree of a polynomial, returns a function that represents the mathematical expression of the polynomial that best fits training data.", "Let\u2019s now define another function that plots the dataset and the best fitting polynomial with a specific degree.", "Now, let\u2019s see what happens with a polynomial of degree 1", "As you can see, a polynomial of degree 1 fits training data better than test data, though it could fit better. We could say that the model is not learning properly from training, so it\u2019s not good.", "Let\u2019s see what happens in the opposite case, which is a very high degree polynomial.", "Here\u2019s what happens with a polynomial of degree 7.", "Now the polynomial fits better the training points but it\u2019s completely wrong about the test points.", "A higher degree seems to get us closer to overfitting training data and to low accuracy on test data. Remember that the higher the degree of a polynomial, the higher the number of parameters involved in the learning process, so a high-degree polynomial is a more complex model than a low-degree one.", "Let\u2019s now see the overfitting explicitly. We have 12 training points and it\u2019s easy to prove that the overfitting can be created with a polynomial of degree 11. It\u2019s called Lagrange polynomial.", "Now it\u2019s clear what happens. The polynomial fits training data perfectly but loses precision on the test set. It doesn\u2019t even get close to test points.", "So, the higher the degree of the polynomial, the higher the interpolation precision on training data and the lower the performance on test data.", "The keyword is \u201cinterpolation\u201d. We actually don\u2019t want to interpolate our data, because doing so will make us fit the errors like they were useful data. We don\u2019t want to learn from errors, we want to know the model which is inside errors. That\u2019s why a perfect fit will make a very bad model on unseen data that follow the same dynamics of training data.", "How can we find the right degree of the polynomial? Here comes cross-validation. Since we want our model to perform well on unseen data, we can measure the Root Mean Squared Error of our polynomial with respect to the test data and choose the degree that minimizes this measure.", "With this simple code, we loop through all degrees and calculate RMSE for training and test sets.", "Let\u2019s see the results in the following plot:", "As you can see, we get the lower value of test set RMSE if we choose a polynomial of degree 2, which is the model our data is sampled from.", "We can now take a look at such a model and find out that it\u2019s actually pretty good at describing both training and test data.", "So, if we want to generalize the underlying phenomena that gave birth to our data, we must cross-validate our model on a dataset it hasn\u2019t been trained on. Only in this way we can be safer about overfitting.", "In this simple example, we have seen how overfitting affects model performance and how dangerous it can be if we don\u2019t pay enough attention to cross-validation. Although there are training techniques that are very helpful when it comes to avoiding overfitting (like bagging), we always need to double-check our model in order to make sure it has been trained properly.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Theoretical Physicists, Data Scientist and fiction author. I teach Data Science, statistics and SQL on YourDataTeacher.com. E-mail: gianluca@gianlucamalato.it"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Ff6739e67f394&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fan-example-of-overfitting-and-how-to-avoid-it-f6739e67f394&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fan-example-of-overfitting-and-how-to-avoid-it-f6739e67f394&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fan-example-of-overfitting-and-how-to-avoid-it-f6739e67f394&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fan-example-of-overfitting-and-how-to-avoid-it-f6739e67f394&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----f6739e67f394--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----f6739e67f394--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://gianlucamalato.medium.com/?source=post_page-----f6739e67f394--------------------------------", "anchor_text": ""}, {"url": "https://gianlucamalato.medium.com/?source=post_page-----f6739e67f394--------------------------------", "anchor_text": "Gianluca Malato"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F1f015e9ee21d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fan-example-of-overfitting-and-how-to-avoid-it-f6739e67f394&user=Gianluca+Malato&userId=1f015e9ee21d&source=post_page-1f015e9ee21d----f6739e67f394---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ff6739e67f394&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fan-example-of-overfitting-and-how-to-avoid-it-f6739e67f394&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ff6739e67f394&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fan-example-of-overfitting-and-how-to-avoid-it-f6739e67f394&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://medium.com/tag/data-science?source=post_page-----f6739e67f394---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----f6739e67f394---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----f6739e67f394---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/python?source=post_page-----f6739e67f394---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/programming?source=post_page-----f6739e67f394---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Ff6739e67f394&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fan-example-of-overfitting-and-how-to-avoid-it-f6739e67f394&user=Gianluca+Malato&userId=1f015e9ee21d&source=-----f6739e67f394---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Ff6739e67f394&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fan-example-of-overfitting-and-how-to-avoid-it-f6739e67f394&user=Gianluca+Malato&userId=1f015e9ee21d&source=-----f6739e67f394---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ff6739e67f394&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fan-example-of-overfitting-and-how-to-avoid-it-f6739e67f394&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----f6739e67f394--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Ff6739e67f394&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fan-example-of-overfitting-and-how-to-avoid-it-f6739e67f394&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----f6739e67f394---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----f6739e67f394--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----f6739e67f394--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----f6739e67f394--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----f6739e67f394--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----f6739e67f394--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----f6739e67f394--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----f6739e67f394--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----f6739e67f394--------------------------------", "anchor_text": ""}, {"url": "https://gianlucamalato.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://gianlucamalato.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Gianluca Malato"}, {"url": "https://gianlucamalato.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "2.8K Followers"}, {"url": "http://YourDataTeacher.com", "anchor_text": "YourDataTeacher.com"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F1f015e9ee21d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fan-example-of-overfitting-and-how-to-avoid-it-f6739e67f394&user=Gianluca+Malato&userId=1f015e9ee21d&source=post_page-1f015e9ee21d--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fadb09bc451d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fan-example-of-overfitting-and-how-to-avoid-it-f6739e67f394&newsletterV3=1f015e9ee21d&newsletterV3Id=adb09bc451d&user=Gianluca+Malato&userId=1f015e9ee21d&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}