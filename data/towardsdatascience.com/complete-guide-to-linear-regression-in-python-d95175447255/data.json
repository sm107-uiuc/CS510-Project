{"url": "https://towardsdatascience.com/complete-guide-to-linear-regression-in-python-d95175447255", "time": 1683011387.714783, "path": "towardsdatascience.com/complete-guide-to-linear-regression-in-python-d95175447255/", "webpage": {"metadata": {"title": "Complete Guide to Linear Regression in Python | by Ahmad Bin Shafiq | Towards Data Science", "h1": "Complete Guide to Linear Regression in Python", "description": "Linear Regression is a supervised machine learning algorithm. It predicts a linear relationship between an independent variable (y), based on the given dependant variables (x). Such that the\u2026"}, "outgoing_paragraph_urls": [{"url": "https://towardsdatascience.com/machine-learning-fundamentals-via-linear-regression-41a5d11f5220", "anchor_text": "here", "paragraph_index": 23}], "all_paragraphs": ["Linear Regression is a supervised machine learning algorithm. It predicts a linear relationship between an independent variable (y), based on the given dependant variables (x). Such that the independent variable (y) has the lowest cost.", "To explain the working of Linear Regression, we first have to assume that we have some data, and when we plot that data on a scatter graph, we get a figure something like this.", "Now, if we apply linear regression to it then it will compute a relationship/line between data such that the line is closest to all the points in the data. In other words, it will compute the relationship between temperature (x) and sales of Ice cream (y) and will tell us that at what temperature the sales will be greater and at what temperature the sales will be less.", "How do we find this line/relationship between our data?", "Now, before we dive deep into this, there are some terminologies that we should understand first.", "Hypothesis representation is the equation of our line, that we use to represent the relationship between the given data.", "Now, this equation can be confusing at first and some may find it hard to visualize this as the equation of a line. But if we consider the equation of the line, that is y = mx + c.", "In the equation of the line, m corresponds to the slope, x is the variable with some value, and c is a constant.In hypothesis representation, \u03b81 corresponds to slope, x is the variable with some value, and \u03b80 is a constant.", "So here \u03b80 & \u03b81 are both the parameters, and their initial value is manually set by us but is then further changed for the line to set perfectly in the data.", "Now whenever we first plot our data and compute the line/relationship, we have to select some parameters, like the starting point of that line and slope of the line. So, at first, we don\u2019t know the values of any of these things, and we assume the values of both the parameters and then apply the cost function on our data to check for the error (distance b/w the points and our line).", "Now first I\u2019ll show you the mathematical version of our cost function and then I\u2019ll explain it below.", "So in this cost function, the term ( h\u03b8(x ) \u2014 y ) subtracts the predicted value (x) by our given value (y), and by doing so we find the error (distance) between our line and the given points. Then we take the square of our answer, in case if the obtained value was a negative number. After that we sum over all our training examples and multiply them with 1/2m, to take the mean of our training examples error.", "Elaboration of 1 / 2m (Optional)", "Now, what we see here is that this all equation is multiplied by 1/2m. The m here is to take the mean/average of our error and 2 is here because when we take the derivative of the cost function, that is used in updating the parameters during gradient descent, that 2 in the power gets canceled with the 1/2 multiplier, thus the derivation is cleaner.", "Now, when we have a better understanding of Cost function & Hypothesis Representation, thus we move towards the third term, Gradient Descent.", "So, now we have successfully implemented cost function and have got some cost (error) >> 0. To reduce this cost (error) we apply gradient descent, where we update the values of the parameters \u03b80 & \u03b81 in this case, and keeps updating them until our cost (error) is nearly equal to 0. So, the mathematical equation for gradient descent is as follows", "Okay, so now diving into this formula, we can see that \u03b80 & \u03b81 are constantly being changed until the cost function reaches its minimum value. What it means is that we will keep on changing the values of \u03b80 & \u03b81 until our parameters reaches the value, where the cost (error) will be the smallest.", "Now, if you see we have an equation similar to our cost function here after \u03b1, that is because gradient descent is the derivative of the cost function.", "Here we are multiplying our cost function\u2019s derivative (squared error cost function) with \u03b1 and subtracting it from the current value of \u03b8 at that time, to get a new value of theta (\u03b8).", "We always choose a very small value of \u03b1 because the change in the values of \u03b8 after each iteration depends upon the value of \u03b1 (as seen in the equation). So, by choosing a very small value of \u03b1 our hypothesis takes very small steps and reaches its lowest cost. By using large values of \u03b1 we might start taking large steps and might miss the global minima where our cost (error) would be lowest.", "Clarification of x in the second equation", "Now some may wonder that in the second equation an additional x(i) is being multiplied with our equation, while in the first equation there is nothing there. Well, there is an x(0) present there, being multiplied with our equation, but we don\u2019t write that down because that is the bias and is always equals to 1.", "Now what gradient descent does is it takes small baby steps and in each step, it converges the hypothesis (line) towards a position where our cost (error) would be minimal.", "Read more about Cost Function and Gradient Descent from here.", "Now we have a very good understanding of hypothesis representation, cost function, and gradient descent. So, let\u2019s apply Linear Regression to our dataset.", "Linear Regression can be applied in the following steps :", "Now, when we have a very good understanding of how Linear Regression works, let\u2019s apply it to a dataset using Python\u2019s famous Machine Learning library, Scikit-learn.", "Scikit-learn (also known as sklearn) is a machine learning library for Python. It includes various classification, regression, and clustering algorithms along with support vector machines (SVM), random forests, gradient boosting, k-means and DBSCAN, and is designed to work with the Python libraries like NumPy, Pandas, and SciPy.", "Linear Regression is a very straight forward and easy to use algorithm. Especially with the help of this Scikit learn library, it\u2019s implementation and its use has become quite easy. Now, let\u2019s start using Sklearn.", "First of all, we need some data to apply Linear Regression to it. So, we\u2019ll be using Boston Housing Price dataset from sklearn.", "These keys in dict_keys() each of them contains a whole lot of information and data in them.", "Now to move forward and see our data in an organized and workable from we will create a data-frame using Pandas.", "After our DataFrame is created and our data has been organized. We check the head of our dataset using bostondf.head(). This gives us an overall clarity /image of the dataset.", "Now if we don\u2019t understand what each column is representing we can use print(boston['DESCR']) code that we discussed earlier, to check the details of every column.", "Now after doing some feature engineering on our data, when we feel that our data is now in the right format to pass to our model, we move towards our next step. NOTE: I am not doing feature engineering on this dataset.", "Splitting our dataset into train, test values", "Now when our data is ready to be passed to our model our first step is to split our dataset into two sets i.e training_set and test_set.", "Here, X in X = bostondf contains all the feature/input data (x), that we provide to our model to predict the price of houses (y), and y in y = boston['target']contains the price of houses. So now 67% of our data belongs to training_set and 33% of belongs to test_set because test_size is set to 0.33.", "After successfully splitting our data into the test and training set we will import Linear Regression using sklearn, and fit our training data onto our model and then we\u2019ll predict how well our model has learned from our training data.", "Okay, so what we have done in these couple of steps is that we imported LinearRegression( ) class and made an object of LinearRegression called lr. Then we fitted our training data lr.fit(X_train, y_train) to the model providing it both the input features (X_train) and output values (y_train). After the model had trained on our training data, we then check how well our model has fitted to our training data by using lr.score(X_test, y_test)*100 code. It will predict the prices of the houses based on features provided in X_test, and then it will cross-check these prices with the actual given prices from y_test. It will then give us a float value between 1\u2013100 that will tell us the accuracy of our model.", "Now, after checking the accuracy if our accuracy doesn\u2019t seem to be very motivating, we should go on to the part where we did feature engineering to our dataset and do some more feature engineering. That will surely improve the results.", "CONGRATULATIONS! We have successfully trained our Linear Regression model on the Boston Housing Prices dataset.", "Up until now, we have learned what is Hypothesis Representation, Cost Function, and Gradient Descent and how they work. Also, we have learned how to implement Linear regression on a dataset from scratch and how to build a Machine Learning model using Python famous Machine Learning library i.e Scikit-learn.", "Up until now, we have learned what is Hypothesis Representation, Cost Function, and Gradient Descent and how they work. Also, we have learned how to implement Linear regression on a dataset from scratch and how to build a Machine Learning model using Python famous Machine Learning library i.e Scikit-learn.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fd95175447255&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcomplete-guide-to-linear-regression-in-python-d95175447255&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcomplete-guide-to-linear-regression-in-python-d95175447255&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcomplete-guide-to-linear-regression-in-python-d95175447255&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcomplete-guide-to-linear-regression-in-python-d95175447255&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----d95175447255--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----d95175447255--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@ahmadbinshafiq?source=post_page-----d95175447255--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@ahmadbinshafiq?source=post_page-----d95175447255--------------------------------", "anchor_text": "Ahmad Bin Shafiq"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fe03ed4871fba&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcomplete-guide-to-linear-regression-in-python-d95175447255&user=Ahmad+Bin+Shafiq&userId=e03ed4871fba&source=post_page-e03ed4871fba----d95175447255---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fd95175447255&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcomplete-guide-to-linear-regression-in-python-d95175447255&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fd95175447255&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcomplete-guide-to-linear-regression-in-python-d95175447255&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@emilwidlund?utm_source=medium&utm_medium=referral", "anchor_text": "Emil Widlund"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://medium.com/@ahmadbinshafiq/linear-regression-simplified-for-beginners-dcd3afe0b23f", "anchor_text": "Medium"}, {"url": "https://medium.com/@ahmadbinshafiq/linear-regression-simplified-for-beginners-dcd3afe0b23f", "anchor_text": "Medium"}, {"url": "https://medium.com/@ahmadbinshafiq/linear-regression-simplified-for-beginners-dcd3afe0b23f", "anchor_text": "Medium"}, {"url": "https://medium.com/@ahmadbinshafiq/linear-regression-simplified-for-beginners-dcd3afe0b23f", "anchor_text": "Medium"}, {"url": "https://towardsdatascience.com/machine-learning-fundamentals-via-linear-regression-41a5d11f5220", "anchor_text": "here"}, {"url": "https://www.quora.com/What-is-the-difference-between-linear-regression-and-least-squares", "anchor_text": "Quora"}, {"url": "https://medium.com/tag/linear-regression?source=post_page-----d95175447255---------------linear_regression-----------------", "anchor_text": "Linear Regression"}, {"url": "https://medium.com/tag/python?source=post_page-----d95175447255---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----d95175447255---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----d95175447255---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/scikit-learn?source=post_page-----d95175447255---------------scikit_learn-----------------", "anchor_text": "Scikit Learn"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fd95175447255&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcomplete-guide-to-linear-regression-in-python-d95175447255&user=Ahmad+Bin+Shafiq&userId=e03ed4871fba&source=-----d95175447255---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fd95175447255&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcomplete-guide-to-linear-regression-in-python-d95175447255&user=Ahmad+Bin+Shafiq&userId=e03ed4871fba&source=-----d95175447255---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fd95175447255&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcomplete-guide-to-linear-regression-in-python-d95175447255&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----d95175447255--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fd95175447255&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcomplete-guide-to-linear-regression-in-python-d95175447255&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----d95175447255---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----d95175447255--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----d95175447255--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----d95175447255--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----d95175447255--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----d95175447255--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----d95175447255--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----d95175447255--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----d95175447255--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@ahmadbinshafiq?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@ahmadbinshafiq?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Ahmad Bin Shafiq"}, {"url": "https://medium.com/@ahmadbinshafiq/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "10 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fe03ed4871fba&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcomplete-guide-to-linear-regression-in-python-d95175447255&user=Ahmad+Bin+Shafiq&userId=e03ed4871fba&source=post_page-e03ed4871fba--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fusers%2Fe03ed4871fba%2Flazily-enable-writer-subscription&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcomplete-guide-to-linear-regression-in-python-d95175447255&user=Ahmad+Bin+Shafiq&userId=e03ed4871fba&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}