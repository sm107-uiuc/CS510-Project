{"url": "https://towardsdatascience.com/nlp-in-the-stock-market-8760d062eb92", "time": 1683003423.680498, "path": "towardsdatascience.com/nlp-in-the-stock-market-8760d062eb92/", "webpage": {"metadata": {"title": "NLP in the Stock Market. Leveraging sentiment analysis on 10-k\u2026 | by Roshan Adusumilli | Towards Data Science", "h1": "NLP in the Stock Market", "description": "Machine learning models implemented in trading are often trained on historical stock prices and other quantitative data to predict future stock prices. However, natural language processing (NLP)\u2026"}, "outgoing_paragraph_urls": [{"url": "https://medium.com/@ageitgey/natural-language-processing-is-fun-9a0bff37854e", "anchor_text": "this", "paragraph_index": 2}, {"url": "https://www.udacity.com/course/ai-for-trading--nd880", "anchor_text": "AI for Trading", "paragraph_index": 3}, {"url": "https://github.com/roshan-adusumilli/nlp_10-ks/blob/master/NLP_on_Financial_Statements.ipynb", "anchor_text": "here", "paragraph_index": 3}, {"url": "https://github.com/roshan-adusumilli/nlp_10-ks/blob/master/project_helper.py", "anchor_text": "project_helper", "paragraph_index": 4}, {"url": "https://github.com/udacity/artificial-intelligence-for-trading/tree/master/project/project_5", "anchor_text": "Artificial Intelligence for Trading", "paragraph_index": 29}, {"url": "https://towardsdatascience.com/artificial-intelligence-and-its-application-in-finance-9f1e0588e777", "anchor_text": "https://towardsdatascience.com/artificial-intelligence-and-its-application-in-finance-9f1e0588e777", "paragraph_index": 30}], "all_paragraphs": ["Machine learning models implemented in trading are often trained on historical stock prices and other quantitative data to predict future stock prices. However, natural language processing (NLP) enables us to analyze financial documents such as 10-k forms to forecast stock movements. 10-k forms are annual reports filed by companies to provide a comprehensive summary of their financial performance (these reports are mandated by the Securities and Exchange Commission). Combing through these reports is often tedious for investors. Through sentiment analysis, a subfield of natural language processing, investors can quickly understand if the tone of the report is positive, negative, or litigious etc. The overall sentiment expressed in the 10-k form can then be used to help investors decide if they should invest in the company.", "Natural language processing is a branch of artificial intelligence concerned with teaching computers to read and derive meaning from language. Since language is so complex, computers have to be taken through a series of steps before they can comprehend text. The following is a quick explanation of the steps that appear in a typical NLP pipeline.", "For a more in-depth description of NLP: read this", "After going through these steps, our text is ready for analysis. Now that we understand NLP better, let\u2019s take a look at my code for the project (project 5 from Udacity\u2019s AI for Trading course). Click here to view the full Github repository", "First, we make the necessary imports; project_helper contains various utility and graph functions.", "Then we download the stopwords corpus for removing stopwords and wordnet corpus for lemmatizing.", "10-k documents include information such as company history, organizational structure, executive compensation, equity, subsidiaries, and audited financial statements. To lookup 10-k documents, we use each company\u2019s unique CIK (Central Index Key).", "Now we pull a list of filed 10-ks from the SEC and display Amazon data as an example.", "We received a list of urls pointing to files containing metadata related to each filling. Metadata isn\u2019t relevant to us so we pull the filling by replacing the url with the filling url. Let\u2019s view download progress by using tqdm and look at an example document.", "Break downloaded files into their associated documents, which are sectioned off in the fillings with the tags <DOCUMENT> for the start of each document and </DOCUMENT> for the end of each document.", "Define the get_document_type function to return the type of document given.", "Filter out the non 10-k documents from the fillings using the get_document_type function.", "Remove the html and make all text lowercase to clean up the document text.", "Clean up the documents using the clean_text function.", "Now we lemmatize all the data.", "Use the Loughran-McDonald sentiment word lists to perform sentiment analysis on the 10-ks (this was specifically built for textual analysis related finance).", "Generate sentiment bag of words from the 10-k documents using the sentiment word lists. The bag of words counts the number of sentiment words in each doc.", "Now that we have the bag of words, we can convert it into a boolean array and calculate the jaccard similarity. The jaccard similarity is defined as the size of intersection divided by the size of union of two sets. For example, the jaccard similarity between two sentences is the number of common words between the two sentences divided by the total number of unique words in both sentences combined. The closer the jaccard similarity value is to 1, the more similar the sets are. To more easily understand our calculations, we plot the jaccard similarities.", "From the sentiment word lists, let\u2019s generate sentiment term frequency\u2013inverse document frequency (TFIDF) from the 10-k documents. TFIDF is an information retrieval technique used to reveal how often a word/term appears in the chosen collection of text. Each term is assigned a term frequency (TF) and inverse document frequency (IDF) score. The product of these scores is referred to as the TFIDF weight of the term. Higher TFIDF weights indicate rarer terms and lower TFIDF scores indicate more common terms.", "From our TFIDF values, we can calculate the cosine similarity and plot it over time. Similar to jaccard similarity, cosine similarity is a metric used to determine how similar documents are. Cosine similarity calculates similarity irrespective of size by measuring the cosine of the angle between two vectors projected in a multi-dimensional space. For textual analysis, the two vectors used are usually arrays containing the word counts of two documents.", "Now we\u2019ll evaluate the alpha factors by comparing them against the yearly pricing for stocks. We can download the pricing data from QuoteMedia.", "Alphalens, a python library for performance analysis of alpha factors, uses dataframes, so we have to convert our dictionary into a dataframe.", "Before we can utilize many of the alphalens functions, we need to align the indices and convert the time to unix timestamp.", "We also have to create factor dataframes with unix time for compatibility with alphalen\u2019s factor_rank_autocorrelation and mean_return_by_quantile functions.", "Let\u2019s take a look at the factor returns over time", "As expected, 10-k reports expressing positive sentiment produced the most gains while 10-k reports containing negative sentiment resulted in the most losses.", "Using the Factor Rank Autocorrelation we can analyze how stable the alphas are over time. We want the alpha ranks to remain relatively same from period to period.", "Finally, let\u2019s calculate the Sharpe ratio, which is the average return minus the risk-free return divided by the standard deviation of return on an investment.", "A Sharpe ratio of 1 is considered acceptable, a ratio of 2 is very good, and a ratio of 3 is excellent. As expected, we can see that positive sentiment correlates to a high Sharpe ratio and negative sentiment correlates to a low Sharpe ratio. The other sentiments also correlated to high Sharpe ratios. However, since so many complex factors influence the price of stocks it is infinitely harder to replicate these returns in the real world.", "[1] Udacity, Artificial Intelligence for Trading, Github", "I\u2019m Roshan, a 16 year old passionate about the intersection of artificial intelligence and finance. For a broad view of AI in finance, check out this article: https://towardsdatascience.com/artificial-intelligence-and-its-application-in-finance-9f1e0588e777.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F8760d062eb92&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnlp-in-the-stock-market-8760d062eb92&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnlp-in-the-stock-market-8760d062eb92&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnlp-in-the-stock-market-8760d062eb92&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnlp-in-the-stock-market-8760d062eb92&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----8760d062eb92--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----8760d062eb92--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@roshan.adusumilli?source=post_page-----8760d062eb92--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@roshan.adusumilli?source=post_page-----8760d062eb92--------------------------------", "anchor_text": "Roshan Adusumilli"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F4b91022e00a0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnlp-in-the-stock-market-8760d062eb92&user=Roshan+Adusumilli&userId=4b91022e00a0&source=post_page-4b91022e00a0----8760d062eb92---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F8760d062eb92&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnlp-in-the-stock-market-8760d062eb92&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F8760d062eb92&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnlp-in-the-stock-market-8760d062eb92&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://medium.com/@ageitgey?source=post_page-----9a0bff37854e----------------------", "anchor_text": "Adam Geitgey"}, {"url": "https://medium.com/@ageitgey/natural-language-processing-is-fun-9a0bff37854e", "anchor_text": "this"}, {"url": "https://www.udacity.com/course/ai-for-trading--nd880", "anchor_text": "AI for Trading"}, {"url": "https://github.com/roshan-adusumilli/nlp_10-ks/blob/master/NLP_on_Financial_Statements.ipynb", "anchor_text": "here"}, {"url": "https://github.com/roshan-adusumilli/nlp_10-ks/blob/master/project_helper.py", "anchor_text": "project_helper"}, {"url": "https://www.sec.gov/cgi-bin/browse-edgar?action=getcompany'", "anchor_text": "https://www.sec.gov/cgi-bin/browse-edgar?action=getcompany'"}, {"url": "https://github.com/udacity/artificial-intelligence-for-trading/tree/master/project/project_5", "anchor_text": "Artificial Intelligence for Trading"}, {"url": "https://towardsdatascience.com/artificial-intelligence-and-its-application-in-finance-9f1e0588e777", "anchor_text": "https://towardsdatascience.com/artificial-intelligence-and-its-application-in-finance-9f1e0588e777"}, {"url": "https://www.linkedin.com/in/roshan-adusumilli-96b104194/", "anchor_text": "https://www.linkedin.com/in/roshan-adusumilli-96b104194/"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----8760d062eb92---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/ai-in-finance?source=post_page-----8760d062eb92---------------ai_in_finance-----------------", "anchor_text": "Ai In Finance"}, {"url": "https://medium.com/tag/naturallanguageprocessing?source=post_page-----8760d062eb92---------------naturallanguageprocessing-----------------", "anchor_text": "Naturallanguageprocessing"}, {"url": "https://medium.com/tag/finance?source=post_page-----8760d062eb92---------------finance-----------------", "anchor_text": "Finance"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F8760d062eb92&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnlp-in-the-stock-market-8760d062eb92&user=Roshan+Adusumilli&userId=4b91022e00a0&source=-----8760d062eb92---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F8760d062eb92&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnlp-in-the-stock-market-8760d062eb92&user=Roshan+Adusumilli&userId=4b91022e00a0&source=-----8760d062eb92---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F8760d062eb92&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnlp-in-the-stock-market-8760d062eb92&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----8760d062eb92--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F8760d062eb92&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnlp-in-the-stock-market-8760d062eb92&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----8760d062eb92---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----8760d062eb92--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----8760d062eb92--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----8760d062eb92--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----8760d062eb92--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----8760d062eb92--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----8760d062eb92--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----8760d062eb92--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----8760d062eb92--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@roshan.adusumilli?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@roshan.adusumilli?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Roshan Adusumilli"}, {"url": "https://medium.com/@roshan.adusumilli/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "467 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F4b91022e00a0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnlp-in-the-stock-market-8760d062eb92&user=Roshan+Adusumilli&userId=4b91022e00a0&source=post_page-4b91022e00a0--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F33022f0f4364&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnlp-in-the-stock-market-8760d062eb92&newsletterV3=4b91022e00a0&newsletterV3Id=33022f0f4364&user=Roshan+Adusumilli&userId=4b91022e00a0&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}