{"url": "https://towardsdatascience.com/finrl-for-quantitative-finance-tutorial-for-multiple-stock-trading-7b00763b7530", "time": 1683017136.297152, "path": "towardsdatascience.com/finrl-for-quantitative-finance-tutorial-for-multiple-stock-trading-7b00763b7530/", "webpage": {"metadata": {"title": "FinRL for Quantitative Finance: Tutorial for Multiple Stock Trading | by Bruce Yang ByFinTech | Towards Data Science", "h1": "FinRL for Quantitative Finance: Tutorial for Multiple Stock Trading", "description": "Note from Towards Data Science\u2019s editors: While we allow independent authors to publish articles in accordance with our rules and guidelines, we do not endorse each author\u2019s contribution. You should\u2026"}, "outgoing_paragraph_urls": [{"url": "https://towardsdatascience.com/questions-96667b06af5", "anchor_text": "rules and guidelines", "paragraph_index": 0}, {"url": "https://towardsdatascience.com/readers-terms-b5d780a700a4", "anchor_text": "Reader Terms", "paragraph_index": 0}, {"url": "https://github.com/AI4Finance-LLC/FinRL-Library", "anchor_text": "Github", "paragraph_index": 2}, {"url": "https://github.com/AI4Finance-Foundation/FinRL/blob/master/FinRL_StockTrading_NeurIPS_2018.ipynb", "anchor_text": "Google Colab", "paragraph_index": 2}, {"url": "https://towardsdatascience.com/deep-reinforcement-learning-for-automated-stock-trading-f1dad0126a02", "anchor_text": "previous blog", "paragraph_index": 3}, {"url": "https://github.com/AI4Finance-LLC/FinRL-Library/blob/master/finrl/marketdata/yahoodownloader.py", "anchor_text": "YahooDownloader", "paragraph_index": 17}, {"url": "https://github.com/AI4Finance-LLC/FinRL-Library/blob/master/finrl/preprocessing/preprocessors.py", "anchor_text": "FeatureEngineer", "paragraph_index": 19}, {"url": "https://github.com/AI4Finance-LLC/FinRL-Library/blob/master/finrl/env/environment.py", "anchor_text": "EnvSetup", "paragraph_index": 21}, {"url": "https://github.com/AI4Finance-LLC/FinRL-Library/blob/master/finrl/env/EnvMultipleStock_train.py", "anchor_text": "training", "paragraph_index": 26}, {"url": "https://github.com/AI4Finance-LLC/FinRL-Library/blob/master/finrl/env/EnvMultipleStock_trade.py", "anchor_text": "trading", "paragraph_index": 26}, {"url": "https://github.com/AI4Finance-LLC/FinRL-Library/blob/master/finrl/model/models.py", "anchor_text": "DRLAgent", "paragraph_index": 27}, {"url": "https://arxiv.org/pdf/1801.01290.pdf", "anchor_text": "SAC", "paragraph_index": 28}, {"url": "https://github.com/AI4Finance-LLC/FinRL-Library/blob/master/finrl/trade/backtest.py", "anchor_text": "set of functions", "paragraph_index": 29}, {"url": "https://github.com/quantopian/pyfolio", "anchor_text": "Quantopian pyfolio", "paragraph_index": 29}, {"url": "https://github.com/AI4Finance-Foundation/FinRL/issues", "anchor_text": "Github", "paragraph_index": 32}, {"url": "https://github.com/BruceYanghy", "anchor_text": "https://github.com/BruceYanghy", "paragraph_index": 34}], "all_paragraphs": ["Note from Towards Data Science\u2019s editors: While we allow independent authors to publish articles in accordance with our rules and guidelines, we do not endorse each author\u2019s contribution. You should not rely on an author\u2019s works without seeking professional advice. See our Reader Terms for details.", "This blog is a tutorial based on our paper: FinRL: A Deep Reinforcement Learning Library for Automated Stock Trading in Quantitative Finance, presented at NeurIPS 2020: Deep RL Workshop.", "The Jupyter notebook codes are available on our Github and Google Colab.", "A more complete application of FinRL for multiple stock trading can be found in our previous blog.", "To begin with, I would like explain the logic of multiple stock trading using Deep Reinforcement Learning.", "We use Dow 30 constituents as an example throughout this article, because those are the most popular stocks.", "A lot of people are terrified by the word \u201cDeep Reinforcement Learning\u201d, actually, you can just treat it as a \u201cSmart AI\u201d or \u201cSmart Stock Trader\u201d or \u201cR2-D2 Trader\u201d if you want, and just use it.", "Suppose that we have a well trained DRL agent \u201cDRL Trader\u201d, we want to use it to trade multiple stocks in our portfolio.", "Below are the logic chart of multiple stock trading and a made-up example for demonstration purpose:", "Multiple stock trading is different from single stock trading because as the number of stocks increase, the dimension of the data will increase, the state and action space in reinforcement learning will grow exponentially. So stability and reproducibility are very essential here.", "We introduce a DRL library FinRL that facilitates beginners to expose themselves to quantitative finance and to develop their own stock trading strategies.", "FinRL is characterized by its reproducibility, scalability, simplicity, applicability and extendibility.", "This article is focusing on one of the use cases in our paper: Mutiple Stock Trading. We use one Jupyter notebook to include all the necessary steps.", "This problem is to design an automated trading solution for multiple stock trading. We model the stock trading process as a Markov Decision Process (MDP). We then formulate our trading goal as a maximization problem.", "The components of the reinforcement learning environment are:", "The data of the Dow 30 constituents stocks that we will be using for this case study is obtained from Yahoo Finance API. The data contains Open-High-Low-Close price and volume.", "Install the unstable development version of FinRL:", "FinRL uses a YahooDownloader class to extract data.", "Download and save the data in a pandas DataFrame:", "FinRL uses a FeatureEngineer class to preprocess data.", "In real life trading, the model needs to be updated periodically using rolling windows. In this article, we just cut the data once into train and trade set.", "FinRL uses a EnvSetup class to setup environment.", "The action space is just the number of unique stocks 30. The state space is 181 in this example.", "User-defined Environment: a simulation environment class.", "The environment for training and trading is different in multiple stock trading case.", "Training v.s. Trading: turbulence index is used as a risk aversion signal after the actions generated by the DRL algorithms. Turbulence index should not be included in training, because it is not a part of model training, so only a trading environment should include the risk aversion signal.", "FinRL provides blueprint for training and trading environments in multiple stock trading.", "FinRL uses a DRLAgent class to implement the algorithms.", "We use Soft Actor-Critic (SAC) for multiple stock trading, because it is one of the most recent state-of-art algorithms. SAC is featured by its stability.", "FinRL uses a set of functions to do the backtesting with Quantopian pyfolio.", "The left table is the stats for backtesting performance, the right table is the stats for Index (DJIA) performance.", "I hope you found this article helpful and learned something about using DRL for multiple stock trading!", "Please report any issues to our Github.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Chief Data Scientist, Educator | Quant, Fraud Detection | Guest Lecturer at Columbia University, Author of AI4Finance-Foundation https://github.com/BruceYanghy"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F7b00763b7530&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffinrl-for-quantitative-finance-tutorial-for-multiple-stock-trading-7b00763b7530&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffinrl-for-quantitative-finance-tutorial-for-multiple-stock-trading-7b00763b7530&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffinrl-for-quantitative-finance-tutorial-for-multiple-stock-trading-7b00763b7530&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffinrl-for-quantitative-finance-tutorial-for-multiple-stock-trading-7b00763b7530&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----7b00763b7530--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----7b00763b7530--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://byfintech.medium.com/?source=post_page-----7b00763b7530--------------------------------", "anchor_text": ""}, {"url": "https://byfintech.medium.com/?source=post_page-----7b00763b7530--------------------------------", "anchor_text": "Bruce Yang ByFinTech"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fa878fc45fb3f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffinrl-for-quantitative-finance-tutorial-for-multiple-stock-trading-7b00763b7530&user=Bruce+Yang+ByFinTech&userId=a878fc45fb3f&source=post_page-a878fc45fb3f----7b00763b7530---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F7b00763b7530&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffinrl-for-quantitative-finance-tutorial-for-multiple-stock-trading-7b00763b7530&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F7b00763b7530&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffinrl-for-quantitative-finance-tutorial-for-multiple-stock-trading-7b00763b7530&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://towardsdatascience.com/questions-96667b06af5", "anchor_text": "rules and guidelines"}, {"url": "https://towardsdatascience.com/readers-terms-b5d780a700a4", "anchor_text": "Reader Terms"}, {"url": "https://arxiv.org/abs/2011.09607", "anchor_text": "FinRL: A Deep Reinforcement Learning Library for Automated Stock Trading in Quantitative FinanceAs deep reinforcement learning (DRL) has been recognized as an effective approach in quantitative finance, getting\u2026arxiv.org"}, {"url": "https://github.com/AI4Finance-LLC/FinRL-Library", "anchor_text": "Github"}, {"url": "https://github.com/AI4Finance-Foundation/FinRL/blob/master/FinRL_StockTrading_NeurIPS_2018.ipynb", "anchor_text": "Google Colab"}, {"url": "https://github.com/AI4Finance-Foundation/FinRL", "anchor_text": "GitHub - AI4Finance-Foundation/FinRL: Deep Reinforcement Learning Framework to Automate Trading in\u2026News: we plan to share our codes for both paper trading and live trading. Please share your interests. FinRL is an\u2026github.com"}, {"url": "https://github.com/AI4Finance-Foundation/FinRL/blob/master/FinRL_StockTrading_NeurIPS_2018.ipynb", "anchor_text": "FinRL/FinRL_StockTrading_NeurIPS_2018.ipynb at master \u00b7 AI4Finance-Foundation/FinRLFinRL: Financial Reinforcement Learning Framework. Please star. \ud83d\udd25 - FinRL/FinRL_StockTrading_NeurIPS_2018.ipynb at\u2026github.com"}, {"url": "https://towardsdatascience.com/deep-reinforcement-learning-for-automated-stock-trading-f1dad0126a02", "anchor_text": "previous blog"}, {"url": "https://zulbahrigb.medium.com/macd-indicator-what-is-macd-indicator-how-to-use-it-from-the-graph-372858754569", "anchor_text": "MACD"}, {"url": "https://medium.com/@priceinaction/the-rsi-indicator-explained-e92210d9ffdd", "anchor_text": "RSI"}, {"url": "https://medium.com/datadriveninvestor/commodity-channel-index-cci-2989f46da3e4", "anchor_text": "CCI"}, {"url": "https://medium.com/mudrex/adx-trading-strategy-22cc1b53f93b", "anchor_text": "ADX"}, {"url": "https://github.com/AI4Finance-LLC/FinRL-Library/blob/master/finrl/marketdata/yahoodownloader.py", "anchor_text": "YahooDownloader"}, {"url": "https://github.com/AI4Finance-LLC/FinRL-Library/blob/master/finrl/preprocessing/preprocessors.py", "anchor_text": "FeatureEngineer"}, {"url": "https://github.com/AI4Finance-LLC/FinRL-Library/blob/master/finrl/env/environment.py", "anchor_text": "EnvSetup"}, {"url": "https://github.com/AI4Finance-LLC/FinRL-Library/blob/master/finrl/env/EnvMultipleStock_train.py", "anchor_text": "training"}, {"url": "https://github.com/AI4Finance-LLC/FinRL-Library/blob/master/finrl/env/EnvMultipleStock_trade.py", "anchor_text": "trading"}, {"url": "https://github.com/AI4Finance-LLC/FinRL-Library/blob/master/finrl/model/models.py", "anchor_text": "DRLAgent"}, {"url": "https://arxiv.org/pdf/1801.01290.pdf", "anchor_text": "SAC"}, {"url": "https://github.com/AI4Finance-LLC/FinRL-Library/blob/master/finrl/trade/backtest.py", "anchor_text": "set of functions"}, {"url": "https://github.com/quantopian/pyfolio", "anchor_text": "Quantopian pyfolio"}, {"url": "https://github.com/AI4Finance-Foundation/FinRL/issues", "anchor_text": "Github"}, {"url": "https://medium.com/tag/deep-reinforcement?source=post_page-----7b00763b7530---------------deep_reinforcement-----------------", "anchor_text": "Deep Reinforcement"}, {"url": "https://medium.com/tag/stock-trading?source=post_page-----7b00763b7530---------------stock_trading-----------------", "anchor_text": "Stock Trading"}, {"url": "https://medium.com/tag/markov-decision-process?source=post_page-----7b00763b7530---------------markov_decision_process-----------------", "anchor_text": "Markov Decision Process"}, {"url": "https://medium.com/tag/reinforcement-learning?source=post_page-----7b00763b7530---------------reinforcement_learning-----------------", "anchor_text": "Reinforcement Learning"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----7b00763b7530---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F7b00763b7530&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffinrl-for-quantitative-finance-tutorial-for-multiple-stock-trading-7b00763b7530&user=Bruce+Yang+ByFinTech&userId=a878fc45fb3f&source=-----7b00763b7530---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F7b00763b7530&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffinrl-for-quantitative-finance-tutorial-for-multiple-stock-trading-7b00763b7530&user=Bruce+Yang+ByFinTech&userId=a878fc45fb3f&source=-----7b00763b7530---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F7b00763b7530&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffinrl-for-quantitative-finance-tutorial-for-multiple-stock-trading-7b00763b7530&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----7b00763b7530--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F7b00763b7530&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffinrl-for-quantitative-finance-tutorial-for-multiple-stock-trading-7b00763b7530&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----7b00763b7530---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----7b00763b7530--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----7b00763b7530--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----7b00763b7530--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----7b00763b7530--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----7b00763b7530--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----7b00763b7530--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----7b00763b7530--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----7b00763b7530--------------------------------", "anchor_text": ""}, {"url": "https://byfintech.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://byfintech.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Bruce Yang ByFinTech"}, {"url": "https://byfintech.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "1.3K Followers"}, {"url": "https://github.com/BruceYanghy", "anchor_text": "https://github.com/BruceYanghy"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fa878fc45fb3f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffinrl-for-quantitative-finance-tutorial-for-multiple-stock-trading-7b00763b7530&user=Bruce+Yang+ByFinTech&userId=a878fc45fb3f&source=post_page-a878fc45fb3f--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F6ca58a53196a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffinrl-for-quantitative-finance-tutorial-for-multiple-stock-trading-7b00763b7530&newsletterV3=a878fc45fb3f&newsletterV3Id=6ca58a53196a&user=Bruce+Yang+ByFinTech&userId=a878fc45fb3f&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}