{"url": "https://towardsdatascience.com/the-illustrated-guide-to-classification-metrics-the-basics-cf3c2e9b89b2", "time": 1683007708.219975, "path": "towardsdatascience.com/the-illustrated-guide-to-classification-metrics-the-basics-cf3c2e9b89b2/", "webpage": {"metadata": {"title": "What are Classification Metrics?. An overview of the fundamentals behind\u2026 | by Ygor Serpa | Towards Data Science", "h1": "What are Classification Metrics?", "description": "In my years working with data science, I always found metrics to be a somewhat arcane topic: you know which ones you have to use, but you don\u2019t always understand why. For instance, some works use\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.linkedin.com/in/ygorreboucas/", "anchor_text": "connect with me", "paragraph_index": 51}, {"url": "https://ygorserpa.medium.com/membership", "anchor_text": "subscribing", "paragraph_index": 51}, {"url": "https://stackoverflow.com/", "anchor_text": "StackOverflow", "paragraph_index": 51}, {"url": "https://ygorserpa.medium.com/membership", "anchor_text": "my affiliate link when signing up.", "paragraph_index": 51}], "all_paragraphs": ["In my years working with data science, I always found metrics to be a somewhat arcane topic: you know which ones you have to use, but you don\u2019t always understand why. For instance, some works use specificity, while others use precision. Why is that? In this article, I go over some of the fundamental metrics and the intuition behind them in the hope of demystifying the topic a little bit. And, to do so, I did my best to provide you with illustrations :)", "This is planed as a multi-part series. In this one, I focus on the three primary metrics everyone in the field has to know: accuracy, sensitivity/specificity, and precision/recall, alongside the almighty confusion matrix.", "Without further ado, let\u2019s start with a simple binary problem.", "There are two possible answers: yes, it will rain and no, it will not. Then, we can wait for the next day and see what happens: rain or sun. This is a classic binary classification problem: we have to predict between two outcomes.", "Naturally, there are two ways to be right: you said rain, and it rained, or you said sunny, and it was sunny. Likewise, there are two ways to be wrong: you said rain, and it was sunny, or you said sunny, and it rained all over your head.", "If our task is to predict rain, we shall call rains \u201cpositives\u201d and suns \u201cnegatives\u201d. Saying rain and getting rain is a \u201ctrue positive\u201d while saying sun and getting sun is a \u201ctrue negative\u201d. Conversely, saying rain and getting sun is a \u201cfalse positive\u201d \u2014 a false alarm, and saying sun but getting rain is a \u201cfalse negative\u201d, or a miss-prediction.", "These four possible outcomes are laid out as a matrix, like this:", "This representation is known as a confusion matrix and summarizes the four possibilities: being right about the rain, issuing a false alarm, missing the rain, and being right about the sun. It is known as the confusion matrix because it shows how much the sun is confused with rain (false positives) and how much rain is confused with the sun (false negative).", "You might be thinking, \u201cI don\u2019t like rain! Why rain should be a positive thing?\u201d I agree it is not very intuitive at first. I find it easier to memorize that \u201cnegative\u201d is the \u201cnatural/expected state\u201d. For instance, when detecting a disease, being healthy is negative, and being ill is positive.", "All these names have many other nicknames. For instance, you can use the names \u201chit\u201d, \u201cfalse alarm\u201d, \u201cmiss\u201d, and \u201crejection\u201d, respectively, which are a bit more intuitive. However, standard practice is to use the positives/negatives.", "Here is the same matrix but using the more intuitive terms:", "Using the sick/healthy example, a \u201chit\u201d is when you detected the disease, and a \u201crejection\u201d is when you rejected that the person is ill. Likewise, if you said the person is sick, but he/she isn\u2019t, you gave a false alarm, and if you wrongly said he/she was healthy, you missed the disease.", "In the Netherlands, there are approximately 217 days of rain per year. If you ask a Dutch person if it will rain tomorrow, he/she will tell you it rains every day, and they can\u2019t take it anymore \ud83d\ude22. Taking this answer literally, the confusion matrix of the average dutch person regarding the rain is:", "Our pessimistic Dutch friend got right all the 217 rainy days at the cost of giving 148 false alarms for rain. Since he never said it would be sunny, he never missed any rain saying sun nor got a sunny day right.", "If we asked an entirely optimistic person instead, one that always hoped for sun, we would get the opposite: 148 days of sun correctly predicted as such and 217 showers of rain miss-predicted.", "The problem we face now is: how much better or worse are the predictions of the pessimist Dutch over the overly optimistic Dutch? In other words, how can we quantify how good are these predictions?", "A straightforward way of measuring how good are these predictions is to consider how many predictions were right over the total. This is called accuracy.", "The pessimistic dutch made 217 correct predictions over 365 days, yielding an accuracy of 59% while the overly optimistic was right in only 148 of 365 days, rendering him only 41% accurate. This makes the pessimistic dutch a better model than the overly optimistic one.", "Formally, the correct predictions are TP + TN, while TP + TN + FP + FN is the total number of predictions. Thus, the accuracy can be calculated as:", "Or in simple terms: greens over greens and reds.", "On our rain example, there are clearly more rainy days than sunny days in the Netherlands. Thus, predicting rains right pushes the accuracy higher more than predicting sunny days.", "In extreme cases, what you want to detect might occur only in 1% or less of the cases. For instance, it only rains a couple of days per year in the Sahara, so if you always say \u201csun\u201d, you will be right about 99% of the time.", "In medical circumstances, diseases are often rare, and you need to detect them despite their rarity. It doesn\u2019t cut to say \u201chealthy\u201d to everyone and say you are 94% accurate. You need a better measure. Consider the example:", "In these cases, it pays off to compute the accuracy for positives and negatives separately, so you can measure how well the model performs for one and the other. In simple terms, we need a \u201cpositive accuracy\u201d and a \u201cnegative accuracy\u201d. These are known in the business as sensitivity and specificity:", "Notice how we just split the accuracy formula into two parts: one detects how well we detect positives (hits over misses) and the other how well we detect negatives (rejections over false-alarms). Therefore, if you naively say, \u201ceveryone is healthy!\u201d you will be 0% sensitive and 100% specific, instead of just 94% accurate.", "Accuracy is a summary. It tries to capture everything into a single value. That\u2019s why it is useful: one value is easier to work with than two, but it is also a weakness: it cannot capture every nuance of your problem. On the other hand, the specificity and sensitivity are indicators. They tell you how well your model behaves under specific circumstances.", "You might ask if it is possible to combine both indicators into a single value so that we can have a summary. One cool formula to use is the geometric mean, which is defined as the square root of the product:", "This formula has the beneficial property of averaging out both scores while penalizing unbalanced pairs. For instance, 90% with 90% has a slightly higher rating than 80% with 100%.", "Going back to the Dutch rain, the pessimistic dutchman is 100% sensitive and 0% specific, while the optimistic one is 0% sensitive and 100% specific. Using our G score, both models have G = 0. Thus, they are equally bad under the sensitivity/specificity analysis. Neat.", "In some scenarios, there are too many true negatives to consider. Therefore, all formulas using true negatives won\u2019t work.", "For instance, the object detection task is defined as finding objects and enclosing them with bounding boxes. A true positive is a correctly found object, a false positive is a false detection, a false negative is missing an object, and a true negative is detecting nothing where there is nothing to be detected.", "Pay close attention to the last: a true negative is saying nothing when nothing is expected. In the above image, how many nothings did we correctly managed to not give a bounding box to?", "Another example is Google search. When you look for dogs, all dog sites returned are true positives, non-dog sites are false positives, missed dog sites are false negatives, and the entire remaining internet are true negatives.", "In both examples, if we actually tried to count how many true negatives there are, we would always have +99% specificity, as the number of true negatives would far exceed everything else. In such scenarios, we have to replace the specificity for another metric: precision.", "Notice that the \u201csensitivity\u201d changed its name to \u201crecall\u201d. They are the same metric, with the same formula. This is just a naming convention: when using precision, you call sensitivity \u201crecall\u201d.", "Using the object detection example, recall measures how many objects you detected among all objects while precision measures how many wrong detections you made along the way. Using the Google example, recall is how many (of all) dog sites you returned while precision is the proportion of dog sites to non-dog sites in your results.", "Beware: precision/recall are not substitutes for sensitivity/specificity; they address different issues. The former is only relevant when you cannot compute the true negatives efficiently, or they are far too many. Whenever you can, the sensitivity/specificity is more appropriate.", "Again, these are indicators. To make a summary out of them, we use the harmonic mean, which is computed by doubling the product over the sum:", "The harmonic mean is known as the F-Score. As for the G-Score, it also penalizes unbalanced pairs. However, it does so more powerfully. Thus, to obtain a high F-Score, a model has to have both high precision and high recall.", "Up to this point, you might be asking: and what if we have several classes to predict? Let\u2019s pick a problem:", "First of all, if we have N classes, there are N \u22c5 N possibilities: saying sun and getting sun, saying sun and getting cloudy, saying sun and getting rain, etc. Out of these, there are N ways to be right (one for each class) and N(N-1) ways to be wrong (all the other possibilities). If we plot it all as a confusion matrix, we get the following:", "As before, the accuracy can be defined as the number of predictions we got right (greens) divided by all predictions (greens plus reds).", "To compute the sensitivity and specificity of each class, we have to recast our problem as class vs. not-class. For instance, cloudy vs. not-cloudy. This way, we can extract one binary problem for each class and compute our binary metrics as we did before. Here is an example of sensitivity and specificity:", "One thing that might strike you is that our true negatives (depicted in gray) will grow very large if we add more classes. There are just way more gray cubes than greens and reds. For this reason, sensitivity and specificity make little sense when dealing with multi-class problems.", "For the same reasons above, the precision and recall scores are more suitable for this case, as they do not rely on the number of true negatives (gray boxes). Here is how it is formulated:", "With this, we have a complete set of tools to evaluate our models on binary and multi-class problems, be the classes balanced (accuracy) or unbalanced (specificity/sensitivity or precision/recall).", "Up to now, we saw what are true/false positives and true/false negatives, and what they mean for the binary and multi-class cases. Then, we saw how the accuracy is computed, and that accuracy is a summary: a single value that quantifies how good a model is.", "Later on, we saw that accuracy is not a reliable metric when the classes are unbalanced, as one class tends to dominate the accuracy value. To solve this, we split the formula into a \u201cpositive accuracy\u201d, called sensitivity, and a \u201cnegative accuracy\u201d, called specificity. Using these two values, we have a clearer picture of the model performance for both classes.", "However, in some cases, the number of true negatives might be too high, or even infinite. In that case, the precision and recall scores are used instead, which do not depend on true negatives.", "Finally, we saw that we can compute a G score and an F score as summaries of the sensitivity/specificity and precision/recall scores, respectively. On unbalanced problems, these summaries are more informative than the accuracy score to compare solutions.", "In the following installment of this series, we will take a look at how we can handle models that provide a score instead of an answer. For instance, \u201cI am 60% sure it will rain tomorrow\u201d. In this case, we need to threshold our model to define what are positives and what are negatives. This brings about essential notions such as the ROC curve and the Average Precision scores.", "Feel free to comment or connect with me if you have any questions on this article. If you are new to Medium, I highly recommend subscribing. Medium articles are the perfect pair to StackOverflow for Data and IT professionals, and even more so for new comers. Please consider using my affiliate link when signing up.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Former game developer turned data scientist after falling in love with AI and all its branches."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fcf3c2e9b89b2&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-illustrated-guide-to-classification-metrics-the-basics-cf3c2e9b89b2&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-illustrated-guide-to-classification-metrics-the-basics-cf3c2e9b89b2&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-illustrated-guide-to-classification-metrics-the-basics-cf3c2e9b89b2&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-illustrated-guide-to-classification-metrics-the-basics-cf3c2e9b89b2&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----cf3c2e9b89b2--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----cf3c2e9b89b2--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://ygorserpa.medium.com/?source=post_page-----cf3c2e9b89b2--------------------------------", "anchor_text": ""}, {"url": "https://ygorserpa.medium.com/?source=post_page-----cf3c2e9b89b2--------------------------------", "anchor_text": "Ygor Serpa"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F857d8734c7da&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-illustrated-guide-to-classification-metrics-the-basics-cf3c2e9b89b2&user=Ygor+Serpa&userId=857d8734c7da&source=post_page-857d8734c7da----cf3c2e9b89b2---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fcf3c2e9b89b2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-illustrated-guide-to-classification-metrics-the-basics-cf3c2e9b89b2&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fcf3c2e9b89b2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-illustrated-guide-to-classification-metrics-the-basics-cf3c2e9b89b2&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://towardsdatascience.com/tagged/the-ai-illustrated-guide", "anchor_text": "The AI Illustrated Guide"}, {"url": "https://unsplash.com/@parradesign?utm_source=medium&utm_medium=referral", "anchor_text": "Giorgio Parravicini"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://commons.wikimedia.org/wiki/User:MTheiler", "anchor_text": "MTheiler"}, {"url": "https://creativecommons.org/licenses/by-sa/4.0", "anchor_text": "CC BY-SA 4.0"}, {"url": "https://www.linkedin.com/in/ygorreboucas/", "anchor_text": "connect with me"}, {"url": "https://ygorserpa.medium.com/membership", "anchor_text": "subscribing"}, {"url": "https://stackoverflow.com/", "anchor_text": "StackOverflow"}, {"url": "https://ygorserpa.medium.com/membership", "anchor_text": "my affiliate link when signing up."}, {"url": "https://medium.com/tag/ai?source=post_page-----cf3c2e9b89b2---------------ai-----------------", "anchor_text": "AI"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----cf3c2e9b89b2---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----cf3c2e9b89b2---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----cf3c2e9b89b2---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/the-ai-illustrated-guide?source=post_page-----cf3c2e9b89b2---------------the_ai_illustrated_guide-----------------", "anchor_text": "The Ai Illustrated Guide"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fcf3c2e9b89b2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-illustrated-guide-to-classification-metrics-the-basics-cf3c2e9b89b2&user=Ygor+Serpa&userId=857d8734c7da&source=-----cf3c2e9b89b2---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fcf3c2e9b89b2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-illustrated-guide-to-classification-metrics-the-basics-cf3c2e9b89b2&user=Ygor+Serpa&userId=857d8734c7da&source=-----cf3c2e9b89b2---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fcf3c2e9b89b2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-illustrated-guide-to-classification-metrics-the-basics-cf3c2e9b89b2&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----cf3c2e9b89b2--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fcf3c2e9b89b2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-illustrated-guide-to-classification-metrics-the-basics-cf3c2e9b89b2&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----cf3c2e9b89b2---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----cf3c2e9b89b2--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----cf3c2e9b89b2--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----cf3c2e9b89b2--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----cf3c2e9b89b2--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----cf3c2e9b89b2--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----cf3c2e9b89b2--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----cf3c2e9b89b2--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----cf3c2e9b89b2--------------------------------", "anchor_text": ""}, {"url": "https://ygorserpa.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://ygorserpa.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Ygor Serpa"}, {"url": "https://ygorserpa.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "1.8K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F857d8734c7da&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-illustrated-guide-to-classification-metrics-the-basics-cf3c2e9b89b2&user=Ygor+Serpa&userId=857d8734c7da&source=post_page-857d8734c7da--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F3644829c90d9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-illustrated-guide-to-classification-metrics-the-basics-cf3c2e9b89b2&newsletterV3=857d8734c7da&newsletterV3Id=3644829c90d9&user=Ygor+Serpa&userId=857d8734c7da&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}