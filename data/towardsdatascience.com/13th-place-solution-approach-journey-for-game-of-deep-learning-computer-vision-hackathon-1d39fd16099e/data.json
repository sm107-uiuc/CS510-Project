{"url": "https://towardsdatascience.com/13th-place-solution-approach-journey-for-game-of-deep-learning-computer-vision-hackathon-1d39fd16099e", "time": 1682996672.101653, "path": "towardsdatascience.com/13th-place-solution-approach-journey-for-game-of-deep-learning-computer-vision-hackathon-1d39fd16099e/", "webpage": {"metadata": {"title": "9th Place Solution/Approach/Journey for Game of Deep Learning: Computer Vision Hackathon | by Kiran Kunapuli | Towards Data Science", "h1": "9th Place Solution/Approach/Journey for Game of Deep Learning: Computer Vision Hackathon", "description": "Ship or vessel detection has a wide range of applications, in the areas of maritime safety, fisheries management, marine pollution, defence and maritime security, protection from piracy, illegal\u2026"}, "outgoing_paragraph_urls": [{"url": "https://course.fast.ai/", "anchor_text": "fastai", "paragraph_index": 6}, {"url": "https://medium.com/@hiromi_suenaga/deep-learning-2-part-1-lesson-2-eeae2edd2be4", "anchor_text": "lecture notes", "paragraph_index": 10}, {"url": "https://github.com/Cadene/pretrained-models.pytorch", "anchor_text": "https://github.com/Cadene/pretrained-models.pytorch", "paragraph_index": 11}, {"url": "https://github.com/TheShadow29/FAI-notes/blob/master/notebooks/Using-Pretrained-Pytorch-Models.ipynb", "anchor_text": "tutorial", "paragraph_index": 11}, {"url": "https://course.fast.ai/start_gcp.html", "anchor_text": "tutorial", "paragraph_index": 12}, {"url": "https://news.ycombinator.com/item?id=20050786", "anchor_text": "new SOTA model on ImageNet dataset", "paragraph_index": 15}, {"url": "https://github.com/lukemelas/EfficientNet-PyTorch", "anchor_text": "GitHub repo", "paragraph_index": 15}, {"url": "https://towardsdatascience.com/1st-place-solution-for-intel-scene-classification-challenge-c95cf941f8ed", "anchor_text": "article", "paragraph_index": 15}, {"url": "https://datahack.analyticsvidhya.com/contest/game-of-deep-learning/pvt_lb", "anchor_text": "link", "paragraph_index": 20}, {"url": "https://medium.com/u/c7c686fcd4b?source=post_page-----1d39fd16099e--------------------------------", "anchor_text": "Team AV", "paragraph_index": 21}, {"url": "https://www.analyticsvidhya.com/datahack-summit-2019/", "anchor_text": "DataHack Summit 2019", "paragraph_index": 21}, {"url": "https://www.kaggle.com/kirankunapuli/game-of-dl-efficientnet-kaggle", "anchor_text": "here", "paragraph_index": 22}], "all_paragraphs": ["Ship or vessel detection has a wide range of applications, in the areas of maritime safety, fisheries management, marine pollution, defence and maritime security, protection from piracy, illegal migration, etc.", "Keeping this in mind, a Governmental Maritime and Coastguard Agency is planning to deploy a computer vision based automated system to identify ship type only from the images taken by the survey boats. You have been hired as a consultant to build an efficient model for this project.", "There are 5 classes of ships to be detected which are as follows:", "There are 6252 images in train and 2680 images in test data. The categories of ships and their corresponding codes in the dataset are as follows -", "The Evaluation metric for this competition is weighted F1 Score.", "The public leaderboard is based on randomly selected 30% of the test images, while private leaderboard will be evaluated on the remaining 70% of the test images.", "My preparation for this hackathon started 3 weeks before the start date when it was announced as a Computer Vision Hackathon. I wanted a refresher on Deep Learning, specifically on Computer Vision, so I searched for the best DL tutorial online and stumbled upon a gold mine, fastai!", "It took me full 3 weeks just to finish those 7, two hour-long lessons, by trying to watch them in bits and pieces during my 2-hour long commute to work and with very little practice over the 2 weekends in between.", "The first week of the hack was spent in gaining a deeper understanding of the nuances in the fastai API.", "I started with the built-in resnet50 architecture with pre-trained ImageNet weights to train a model, soon to experiment with various built-in resnet and densenet models. After looking at the performance of various models architectures available in fastai, I decided upon using the built-in resnet152 and densenet161 architectures for building initial models.", "The second week of the hack was where I could learn and achieve a lot. I was going through the 2018 lecture notes of fastai classes and got to know about TTA, lr_find() and learn.recorder.plot(suggestion=True) functions and about Progressive Image Resizing technique which are surprisingly not touched upon in the 2019 version of the course. Using these new tricks I could achieve a single best densenet161 model of 0.974822 score.", "I realised we could use pre-trained models from this great collection, https://github.com/Cadene/pretrained-models.pytorch in fastai and used this tutorial to understand the head and body structure of the fastai models. But when I wanted to use the model architectures such as senet154, se_resnet152, polynet using the Kaggle kernels, I was running out of GPU memory. Learnt about the learn.to_fp16() trick but it was of no use on Tesla K80 of Kaggle kernels as it doesn\u2019t have Tensor cores to take benefit of Mixed Precision training.", "I decided to create a GCP account with a faster GPU Tesla V100 which has Tensor Cores and followed this tutorial. It took about 3 hours for the GPU quota increase request to get processed. I ran the senet154, se_resnet152 models by taking help of Mixed Precision training.", "By now I had about 17 models and I decided to ensemble them. As there were discrete classes in the output category column, I used a simple mode on all the submissions, mode(df, axis=1)[0] which gave a score of 0.980409, helping me break the 0.98 mark.", "By the end of week 2, I had set up a GCP environment for exploring bigger models faster, 8th rank on Public LB, but was almost out of ideas.", "On the fresh Monday morning of the third and last week of the competition, during my everyday routine of scrolling through the HackerNews and Towards Data Science websites, I see that there is a new SOTA model on ImageNet dataset, the EfficientNet. I quickly searched for Pytorch implementation of it and found this amazing GitHub repo which had B0-B3 pre-trained models. I also found this article about the approach of the 1st place winner of the Intel Scene Classification Challenge.", "I could quickly realize that I was missing the Mixup Augmentation technique and the Removing Confusing Images technique which was very helpful for the participant in reaching the top spot. So incorporated these changes in my code and while I was reading about mixup() on the fastai docs page, I learnt about the ResizeMethod.SQUISH method for not centre cropping the image to a specific size like 224*224, but for squishing the whole image into the required size. Then pruned about 100 most confusing images in the train set and made the training set bigger by giving valid_pct=0.1.", "Below is my final get_data function,", "Below is the EfficientNet B3 model in fastai,", "I ran B0, B1, B2, and B3 models with this pipeline of code, with a single best model of B3 giving 0.981322 on the Public LB. Took the mode of these models which gave 0.98224. Ran this pipeline with resnet152 and densenet161 and took the mode of these submissions with the best single B3 model which gave 0.979470 on Public LB. Then the final submission which placed me 5th on Public LB was the mode of 3 top submissions till now which gave a score of 0.988798.", "The final submission severely overfit the Public LB and placed me at the 9th rank on Private LB. My submission of the mode of resnet152, densenet161 and efficientnet-b3 performed the best on Private LB and would have given me a 4th place finish. Here\u2019s the link to Private LB.", "Nevertheless, this hackathon has been an exceptional experience for me. Thanks to Team AV for conducting such an amazing hackathon. Hope to meet you all at the DataHack Summit 2019. \u270c\ufe0f", "Update: Code for training EfficientNet using FastAI is published here. Please upvote the Kaggle kernel if you find it useful.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Scientist at Tokopedia | Curious Human"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F1d39fd16099e&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F13th-place-solution-approach-journey-for-game-of-deep-learning-computer-vision-hackathon-1d39fd16099e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2F13th-place-solution-approach-journey-for-game-of-deep-learning-computer-vision-hackathon-1d39fd16099e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F13th-place-solution-approach-journey-for-game-of-deep-learning-computer-vision-hackathon-1d39fd16099e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2F13th-place-solution-approach-journey-for-game-of-deep-learning-computer-vision-hackathon-1d39fd16099e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----1d39fd16099e--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----1d39fd16099e--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@kirankunapuli?source=post_page-----1d39fd16099e--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@kirankunapuli?source=post_page-----1d39fd16099e--------------------------------", "anchor_text": "Kiran Kunapuli"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F1529cbb9363f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F13th-place-solution-approach-journey-for-game-of-deep-learning-computer-vision-hackathon-1d39fd16099e&user=Kiran+Kunapuli&userId=1529cbb9363f&source=post_page-1529cbb9363f----1d39fd16099e---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F1d39fd16099e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F13th-place-solution-approach-journey-for-game-of-deep-learning-computer-vision-hackathon-1d39fd16099e&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F1d39fd16099e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F13th-place-solution-approach-journey-for-game-of-deep-learning-computer-vision-hackathon-1d39fd16099e&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://datahack.analyticsvidhya.com/contest/game-of-deep-learning/", "anchor_text": "Hosted by Analytics Vidhya"}, {"url": "https://unsplash.com/@vidarnm?utm_source=medium&utm_medium=referral", "anchor_text": "Vidar Nordli-Mathisen"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://course.fast.ai/", "anchor_text": "fastai"}, {"url": "https://medium.com/@hiromi_suenaga/deep-learning-2-part-1-lesson-2-eeae2edd2be4", "anchor_text": "lecture notes"}, {"url": "https://github.com/Cadene/pretrained-models.pytorch", "anchor_text": "https://github.com/Cadene/pretrained-models.pytorch"}, {"url": "https://github.com/TheShadow29/FAI-notes/blob/master/notebooks/Using-Pretrained-Pytorch-Models.ipynb", "anchor_text": "tutorial"}, {"url": "https://course.fast.ai/start_gcp.html", "anchor_text": "tutorial"}, {"url": "https://news.ycombinator.com/item?id=20050786", "anchor_text": "new SOTA model on ImageNet dataset"}, {"url": "https://github.com/lukemelas/EfficientNet-PyTorch", "anchor_text": "GitHub repo"}, {"url": "https://towardsdatascience.com/1st-place-solution-for-intel-scene-classification-challenge-c95cf941f8ed", "anchor_text": "article"}, {"url": "https://datahack.analyticsvidhya.com/contest/game-of-deep-learning/pvt_lb", "anchor_text": "link"}, {"url": "https://medium.com/u/c7c686fcd4b?source=post_page-----1d39fd16099e--------------------------------", "anchor_text": "Team AV"}, {"url": "https://www.analyticsvidhya.com/datahack-summit-2019/", "anchor_text": "DataHack Summit 2019"}, {"url": "https://www.kaggle.com/kirankunapuli/game-of-dl-efficientnet-kaggle", "anchor_text": "here"}, {"url": "https://www.linkedin.com/in/kirankunapuli/", "anchor_text": "LinkedIn"}, {"url": "https://twitter.com/kirankunapuli", "anchor_text": "Twitter"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----1d39fd16099e---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----1d39fd16099e---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/hackathons?source=post_page-----1d39fd16099e---------------hackathons-----------------", "anchor_text": "Hackathons"}, {"url": "https://medium.com/tag/analytics-vidhya?source=post_page-----1d39fd16099e---------------analytics_vidhya-----------------", "anchor_text": "Analytics Vidhya"}, {"url": "https://medium.com/tag/computer-vision?source=post_page-----1d39fd16099e---------------computer_vision-----------------", "anchor_text": "Computer Vision"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F1d39fd16099e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F13th-place-solution-approach-journey-for-game-of-deep-learning-computer-vision-hackathon-1d39fd16099e&user=Kiran+Kunapuli&userId=1529cbb9363f&source=-----1d39fd16099e---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F1d39fd16099e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F13th-place-solution-approach-journey-for-game-of-deep-learning-computer-vision-hackathon-1d39fd16099e&user=Kiran+Kunapuli&userId=1529cbb9363f&source=-----1d39fd16099e---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F1d39fd16099e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F13th-place-solution-approach-journey-for-game-of-deep-learning-computer-vision-hackathon-1d39fd16099e&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----1d39fd16099e--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F1d39fd16099e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F13th-place-solution-approach-journey-for-game-of-deep-learning-computer-vision-hackathon-1d39fd16099e&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----1d39fd16099e---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----1d39fd16099e--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----1d39fd16099e--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----1d39fd16099e--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----1d39fd16099e--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----1d39fd16099e--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----1d39fd16099e--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----1d39fd16099e--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----1d39fd16099e--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@kirankunapuli?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@kirankunapuli?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Kiran Kunapuli"}, {"url": "https://medium.com/@kirankunapuli/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "28 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F1529cbb9363f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F13th-place-solution-approach-journey-for-game-of-deep-learning-computer-vision-hackathon-1d39fd16099e&user=Kiran+Kunapuli&userId=1529cbb9363f&source=post_page-1529cbb9363f--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fef3992c8ff1d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F13th-place-solution-approach-journey-for-game-of-deep-learning-computer-vision-hackathon-1d39fd16099e&newsletterV3=1529cbb9363f&newsletterV3Id=ef3992c8ff1d&user=Kiran+Kunapuli&userId=1529cbb9363f&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}