{"url": "https://towardsdatascience.com/if-history-repeats-itself-fourier-transform-is-a-key-a593ddfa246e", "time": 1683016527.035128, "path": "towardsdatascience.com/if-history-repeats-itself-fourier-transform-is-a-key-a593ddfa246e/", "webpage": {"metadata": {"title": "If history repeats itself, Fourier Transform is a key | by Piero Paialunga | Towards Data Science", "h1": "If history repeats itself, Fourier Transform is a key", "description": "One of the sentences that my professor used to say in high school was that \u201cHistory repeats itself\u201d . The sense of this sentence is obviously related to the fact that we should learn from history\u2026"}, "outgoing_paragraph_urls": [{"url": "https://en.wikipedia.org/wiki/Fourier_transform", "anchor_text": "Fourier Transform", "paragraph_index": 1}, {"url": "https://www.pse.pl/web/pse-eng/data/polish-power-system-operation/load-of-polish-power-system", "anchor_text": "Polish Electrical Load", "paragraph_index": 5}, {"url": "https://www.linkedin.com/in/pieropaialunga/", "anchor_text": "Linkedin", "paragraph_index": 25}, {"url": "https://piero-paialunga.medium.com/subscribe", "anchor_text": "newsletter", "paragraph_index": 25}, {"url": "https://piero-paialunga.medium.com/membership", "anchor_text": "referred member", "paragraph_index": 25}], "all_paragraphs": ["One of the sentences that my professor used to say in high school was that \u201cHistory repeats itself\u201d . The sense of this sentence is obviously related to the fact that we should learn from history, thus being able not to do the same mistakes that we have done in the past.", "Now let\u2019s talk about science. If you have a time series, then you have your data for a (preferably) long time. Let\u2019s assume for a second that history actually does reproduce itself. That will mean that by simply replicating the signal you will extend your data, thus obtaining a twice longer dataset. I know what you\u2019re thinking, and you are right, I\u2019m fooling you. Indeed, what I\u2019m essentially mentioning in these few lines is the Fourier Transform, that states that each periodic signal can be seen as a sum of sines and cosines. Obtaining the amplitude and the phase of each frequency, you have your signal, and you can easily extend it.", "I have a good news and a bad news to give you. The bad news is that you can\u2019t pretend that your data are periodic unless you know that they are indeed periodic for some strange reason. The good news is that sometimes your data does present a semi-periodic pattern, and in those cases Fourier Transform is worth a shot.", "I know, I talk a lot, let\u2019s start with the practice.", "The language that has been used is Python with the following libraries that has been used:", "Let\u2019s take the Polish Electrical Load as an example and let\u2019s give a look to data from 2008 to 2016:", "Each year time step is incredibly easy to distinguish, and if we zoom it out, so does each months, and each week.", "In these cases, a simple approach as Fourier Transform could be an option. Indeed, the idea that it could be applied is that our signal is actually periodic, but it does not seems to be periodic because of the noise, a general linear trend, or other unwanted effects that make our signal non stationary. Let\u2019s move forward!", "The signal has a linear trend, and its mean is not 0. This can disturb the Fourier spectrum and in general we don\u2019t want that the linear trend is seen as a \u201clong frequency component\u201d of our Fourier spectrum. Using the magical scipy library, the signal has been detrended and shifted in order to set its mean to 0.", "Borrowing the Machine Learning terminology, the dataset is divided into three parts:", "If you are a ML specialist, please don\u2019t take the nomenclature too seriously as it doesn\u2019t mach really well with what you know. No offence. Names are names. :)", "Of course if you naively apply the Fourier Transform you can\u2019t expect good results, thats why the algorithm is slightly (I hope) more complicated.", "The Fourier transform implies that data are stationary, but life changes, and love stories end <\\3.", "That\u2019s why each year of the training set has to be taken alone. Each year will give its Fourier transform.", "A mean Fourier transform (F) is obtaining by the sum of each Fourier Transform divided by 7 (there are 7 years on the training set).", "Now let\u2019s consider the validation set signal (2015 Load). The idea is to use the Fourier Transform of the training set, transform it back, and compare the reconstructed signal with the validation set one. The inverse Fourier transform is of course obtained by using numpy FFT algorithm.", "The problem is that, as numpy FFT algorithm is fantastic, it is able to reproduce the signal extremely well, maybe even too well. In fact we want the noise to be out of the reconstructed signal. But what is actually noise?", "You know no-one can answer this question, but a safe warning that one could give you is that the error ( the difference between the original signal (i.e. the 2015 Load) and the reconstructed one) has to be the most possible uncorrelated with the signal . Of course, on the other hand, if we have a 0 signal it is uncorrelated with the original one, but it has no predictive ability. In short, that\u2019s what we want from our model:", "In order to do so, we invoke a magic wizard called threshold. The threshold is a certain value between 0 and 1 that will be multiplied by the highest value of the mean spectrum of the training set (F). All frequencies that are less than t * max(F) are set to 0, the signal is then transformed back to the original space, and both the RMSE and the correlation values have been computed. The best threshold is the one with the lowest RMSE and the lowest correlation as possible.", "This filtered Fourier spectrum has been used to predict the first 10 to 90 days of the 2016 Load, and the results are actually surprising.", "The model is slighly overfitting but the RMSE is still acceptably low, and the errors are in part due to statistical error fluctuation, as it is possible to see from the fact that C is <0.60. Moreover the predictions are actually really good for the first days of the week, while the weekends seem to be more difficult to catch (guys, please, stop drinking too much!)", "A lot of data science challenge are time series challenge (e.g. global climate reports , stock market analysis, solar cycle forecasting etc.). Of course there are more powerful methods to approach the timeseries (RNN, ARMA, ARIMA, SARIMA, etc.) and have a forecast out of them. Nonetheless, as I hope I\u2019ve managed to show with this report, sometimes a good use of simple math concepts could still output very decent results. Being simple math concepts, they also give you full control of what is happening and they are tunable with your own investigation.", "By the way, I don\u2019t really know if history repeats itself, but I do think that we are supposed to live again some moments in a different form, with a different mindset and a different spirit. As Mark Twain once said:", "\u201cHistory doesn\u2019t repeat itself, but it often rhymes\u201d", "If you liked the article and you want to know more about Machine Learning, or you just want to ask me something you can:", "A. Follow me on Linkedin, where I publish all my stories B. Subscribe to my newsletter. It will keep you updated about new stories and give you the chance to text me to receive all the corrections or doubts you may have.C. Become a referred member, so you won\u2019t have any \u201cmaximum number of stories for the month\u201d and you can read whatever I (and thousands of other Machine Learning and Data Science top writer) write about the newest technology available.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "PhD student in Aerospace Engineering at the University of Cincinnati. Master\u2019s degree Physicist, Data Scientist, professional google-searcher."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fa593ddfa246e&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fif-history-repeats-itself-fourier-transform-is-a-key-a593ddfa246e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fif-history-repeats-itself-fourier-transform-is-a-key-a593ddfa246e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fif-history-repeats-itself-fourier-transform-is-a-key-a593ddfa246e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fif-history-repeats-itself-fourier-transform-is-a-key-a593ddfa246e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----a593ddfa246e--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----a593ddfa246e--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://piero-paialunga.medium.com/?source=post_page-----a593ddfa246e--------------------------------", "anchor_text": ""}, {"url": "https://piero-paialunga.medium.com/?source=post_page-----a593ddfa246e--------------------------------", "anchor_text": "Piero Paialunga"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F254e653181d2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fif-history-repeats-itself-fourier-transform-is-a-key-a593ddfa246e&user=Piero+Paialunga&userId=254e653181d2&source=post_page-254e653181d2----a593ddfa246e---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa593ddfa246e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fif-history-repeats-itself-fourier-transform-is-a-key-a593ddfa246e&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa593ddfa246e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fif-history-repeats-itself-fourier-transform-is-a-key-a593ddfa246e&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@jontyson", "anchor_text": "https://unsplash.com/@jontyson"}, {"url": "https://en.wikipedia.org/wiki/Fourier_transform", "anchor_text": "Fourier Transform"}, {"url": "https://www.pse.pl/web/pse-eng/data/polish-power-system-operation/load-of-polish-power-system", "anchor_text": "Polish Electrical Load"}, {"url": "https://www.linkedin.com/in/pieropaialunga/", "anchor_text": "Linkedin"}, {"url": "https://piero-paialunga.medium.com/subscribe", "anchor_text": "newsletter"}, {"url": "https://piero-paialunga.medium.com/membership", "anchor_text": "referred member"}, {"url": "https://medium.com/tag/data-science?source=post_page-----a593ddfa246e---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----a593ddfa246e---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----a593ddfa246e---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/renewable-energy?source=post_page-----a593ddfa246e---------------renewable_energy-----------------", "anchor_text": "Renewable Energy"}, {"url": "https://medium.com/tag/history?source=post_page-----a593ddfa246e---------------history-----------------", "anchor_text": "History"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fa593ddfa246e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fif-history-repeats-itself-fourier-transform-is-a-key-a593ddfa246e&user=Piero+Paialunga&userId=254e653181d2&source=-----a593ddfa246e---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fa593ddfa246e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fif-history-repeats-itself-fourier-transform-is-a-key-a593ddfa246e&user=Piero+Paialunga&userId=254e653181d2&source=-----a593ddfa246e---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa593ddfa246e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fif-history-repeats-itself-fourier-transform-is-a-key-a593ddfa246e&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----a593ddfa246e--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fa593ddfa246e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fif-history-repeats-itself-fourier-transform-is-a-key-a593ddfa246e&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----a593ddfa246e---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----a593ddfa246e--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----a593ddfa246e--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----a593ddfa246e--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----a593ddfa246e--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----a593ddfa246e--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----a593ddfa246e--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----a593ddfa246e--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----a593ddfa246e--------------------------------", "anchor_text": ""}, {"url": "https://piero-paialunga.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://piero-paialunga.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Piero Paialunga"}, {"url": "https://piero-paialunga.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "2.2K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F254e653181d2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fif-history-repeats-itself-fourier-transform-is-a-key-a593ddfa246e&user=Piero+Paialunga&userId=254e653181d2&source=post_page-254e653181d2--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Faea3171bdfd4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fif-history-repeats-itself-fourier-transform-is-a-key-a593ddfa246e&newsletterV3=254e653181d2&newsletterV3Id=aea3171bdfd4&user=Piero+Paialunga&userId=254e653181d2&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}