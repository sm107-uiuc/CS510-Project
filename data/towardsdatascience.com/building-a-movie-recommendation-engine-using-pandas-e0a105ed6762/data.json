{"url": "https://towardsdatascience.com/building-a-movie-recommendation-engine-using-pandas-e0a105ed6762", "time": 1682995878.4184692, "path": "towardsdatascience.com/building-a-movie-recommendation-engine-using-pandas-e0a105ed6762/", "webpage": {"metadata": {"title": "Building A Movie Recommendation Engine Using Pandas | by Nishit Jain | Towards Data Science", "h1": "Building A Movie Recommendation Engine Using Pandas", "description": "Recommendation Engines are the programs which basically compute the similarities between two entities and on that basis, they give us the targeted output. If we look at the root of any recommendation\u2026"}, "outgoing_paragraph_urls": [{"url": "https://github.com/nishitjain/movie-recommendation-system-scratch", "anchor_text": "here", "paragraph_index": 20}, {"url": "http://www.linkedin.com/in/thenishitjain", "anchor_text": "www.linkedin.com/in/thenishitjain", "paragraph_index": 22}], "all_paragraphs": ["Recommendation Engines are the programs which basically compute the similarities between two entities and on that basis, they give us the targeted output. If we look at the root of any recommendation engine, they all are trying to find out the amount of similarity between two entities. Then, the computed similarities can be used to deduce various kinds of recommendations and relationships between them.", "Recommendation Engines are mostly based on the following techniques:", "The most basic form of a recommendation engine would be where the engine recommends the most popular items to all the users. That would be generalized as everyone would be getting similar recommendations as we didn\u2019t personalize the recommendations. These kinds of recommendation engines are based on the Popularity Based Filtering. The use case for this model would be the \u2018Top News\u2019 Section for the day on a news website where the most popular new for everyone is same irrespective of the interests of every user because that makes a logical sense because News is a generalized thing and it has got nothing to do with user\u2019s interests.", "In collaborative filtering, two entities collaborate to deduce recommendations on the basis of certain similarities between them. These filtering techniques are broadly of two types:", "We have a movie lens database and our objective is to apply various kinds of recommendation techniques from scratch using pandas and find out similarities between the users, most popular movies, and personalized recommendations for the targeted user based on user based collaborative filtering. (We are exploring only one of the types because these article is about getting the basic intuition behind the recommendation engines.)", "We are importing pandas and some basic mathematical functions from math library and importing the dataset into a dataframe object.", "Here is how the first 5 rows of our dataset look like.", "In this dataset, we have 4 columns and around 1M rows. Except, unix_timestamp, all the columns are self explanatory. We anyway won\u2019t be using this column in our code. Next, we let\u2019s see out how our movies dataset looks like.", "All the column names are self explanatory. As seen in the above dataframe, the genre column has data with pipe separators which cannot be processed for recommendations as such. Hence, we need to generate columns for every genre type such that if the movie belongs to that genre its value will be 1 otherwise 0 (Sort of one hot encoding). Also, we need to split the release of year out of the movie_title column and generate a new column for it which is again a new and an important feature.", "Here\u2019s how the dataframe looks like after processing it:", "Now, let us write down a few getter functions which will be frequently used in our code so that we do not need to write them again and again and it also increases readability and re-usability of the code.", "In this implementation the similarity between the two users will be calculated on the basis of the distance between the two users (i.e. Euclidean distances) and by calculating Pearson Correlation between the two users.", "We will write two functions, one to calculate the similarity on the basis of euclidean distances and other on the basis of Pearson correlation and you will know why we are writing two functions.", "Calculating similarity scores based on the distances have an inherent problem. We do not have a threshold to decide how much distance between two users is to be considered for calculating whether the users are close enough or far enough. On the other side, this problem is resolved by pearson correlation method as it always returns a value between -1 & 1 which clearly provides us with the boundaries for closeness as we prefer.", "The objective is to find out Most Similar Users to the targeted user. Here we have two metrics to find the score i.e. distance and correlation. Now, we will write a function for this.", "As we can see, the output is list of tuples indicating the similarity scores of the top 5 similar number of the users asked for with user id against the targeted user. The metric used here is Pearson Correlation.", "I don\u2019t know if few of the people have noticed that the most similar users\u2019 logic can be strengthened more by considering other factors as well such as age, sex, occupation etc. Here, we have created our logic on the basis of only one feature i.e. rating.", "The concept is very simple. First, we need to iterate over only those movies not watched(or rated) by the targeted user and the sub-setting items based on the users highly correlated with targeted user. Here, we have used a weighted similarity approach where we have taken product of rating and score into account to make sure that the highly similar users affect the recommendations more than those less similar. Then, we have sorted the list on the basis of score along with movie ids and returned the movie titles against those movie ids. Let us write a function for the same.", "As we can see in the output, we have got the top 10 highly recommended movie for the user with user id 32 using the metric Pearson Correlation. You can do the same exercise with the euclidean distances as metric and I\u2019m sure the results will differ.", "We implemented a movie recommendation engine by just using Pandas and basic math library functions. Also, we got to know the basic intuition behind the recommendation engines. Obviously, there\u2019s a lot more to the recommendation engines than this as there are multiple features and factors which influence the recommendations and not just the ratings. Further more, we will be implementing and deducing our recommendations also based on other features of the users and the movies in the next blog and also explore the infamous technique for recommendation engines i.e. Matrix Factorization using the turicreate library.", "The GitHub repository for the code in the blog can be found here.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Learning from Data | Data Scientist | Wanderer | LinkedIN: www.linkedin.com/in/thenishitjain"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fe0a105ed6762&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-a-movie-recommendation-engine-using-pandas-e0a105ed6762&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-a-movie-recommendation-engine-using-pandas-e0a105ed6762&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-a-movie-recommendation-engine-using-pandas-e0a105ed6762&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-a-movie-recommendation-engine-using-pandas-e0a105ed6762&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----e0a105ed6762--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----e0a105ed6762--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@thenishitjain?source=post_page-----e0a105ed6762--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@thenishitjain?source=post_page-----e0a105ed6762--------------------------------", "anchor_text": "Nishit Jain"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F32b26764953a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-a-movie-recommendation-engine-using-pandas-e0a105ed6762&user=Nishit+Jain&userId=32b26764953a&source=post_page-32b26764953a----e0a105ed6762---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe0a105ed6762&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-a-movie-recommendation-engine-using-pandas-e0a105ed6762&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe0a105ed6762&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-a-movie-recommendation-engine-using-pandas-e0a105ed6762&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://github.com/nishitjain/movie-recommendation-system-scratch", "anchor_text": "here"}, {"url": "https://medium.com/tag/data-science?source=post_page-----e0a105ed6762---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/recommendation-system?source=post_page-----e0a105ed6762---------------recommendation_system-----------------", "anchor_text": "Recommendation System"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----e0a105ed6762---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/pandas?source=post_page-----e0a105ed6762---------------pandas-----------------", "anchor_text": "Pandas"}, {"url": "https://medium.com/tag/data?source=post_page-----e0a105ed6762---------------data-----------------", "anchor_text": "Data"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fe0a105ed6762&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-a-movie-recommendation-engine-using-pandas-e0a105ed6762&user=Nishit+Jain&userId=32b26764953a&source=-----e0a105ed6762---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fe0a105ed6762&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-a-movie-recommendation-engine-using-pandas-e0a105ed6762&user=Nishit+Jain&userId=32b26764953a&source=-----e0a105ed6762---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe0a105ed6762&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-a-movie-recommendation-engine-using-pandas-e0a105ed6762&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----e0a105ed6762--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fe0a105ed6762&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-a-movie-recommendation-engine-using-pandas-e0a105ed6762&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----e0a105ed6762---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----e0a105ed6762--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----e0a105ed6762--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----e0a105ed6762--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----e0a105ed6762--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----e0a105ed6762--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----e0a105ed6762--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----e0a105ed6762--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----e0a105ed6762--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@thenishitjain?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@thenishitjain?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Nishit Jain"}, {"url": "https://medium.com/@thenishitjain/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "108 Followers"}, {"url": "http://www.linkedin.com/in/thenishitjain", "anchor_text": "www.linkedin.com/in/thenishitjain"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F32b26764953a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-a-movie-recommendation-engine-using-pandas-e0a105ed6762&user=Nishit+Jain&userId=32b26764953a&source=post_page-32b26764953a--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fd113167357b9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-a-movie-recommendation-engine-using-pandas-e0a105ed6762&newsletterV3=32b26764953a&newsletterV3Id=d113167357b9&user=Nishit+Jain&userId=32b26764953a&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}