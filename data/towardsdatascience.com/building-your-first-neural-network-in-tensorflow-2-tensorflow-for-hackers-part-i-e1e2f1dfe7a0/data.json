{"url": "https://towardsdatascience.com/building-your-first-neural-network-in-tensorflow-2-tensorflow-for-hackers-part-i-e1e2f1dfe7a0", "time": 1682995657.4936519, "path": "towardsdatascience.com/building-your-first-neural-network-in-tensorflow-2-tensorflow-for-hackers-part-i-e1e2f1dfe7a0/", "webpage": {"metadata": {"title": "Build your first Neural Network in TensorFlow 2 | TensorFlow for Hackers (Part I) | by Venelin Valkov | Towards Data Science", "h1": "Build your first Neural Network in TensorFlow 2 | TensorFlow for Hackers (Part I)", "description": "Build and train your first Neural Network model using TensorFlow 2. Use the model to recognize clothing type from images."}, "outgoing_paragraph_urls": [{"url": "https://www.tensorflow.org/overview", "anchor_text": "TensorFlow", "paragraph_index": 7}, {"url": "https://github.com/zalandoresearch/fashion-mnist", "anchor_text": "Fashion MNIST", "paragraph_index": 11}, {"url": "https://jobs.zalando.com/tech/", "anchor_text": "Zalando", "paragraph_index": 12}, {"url": "https://www.tensorflow.org/api_docs/python/tf/data/Dataset", "anchor_text": "Dataset", "paragraph_index": 22}, {"url": "https://www.tensorflow.org/api_docs/python/tf/one_hot", "anchor_text": "tf.one_hot", "paragraph_index": 23}, {"url": "https://www.tensorflow.org/api_docs/python/tf/data/Dataset#from_tensor_slices", "anchor_text": "from_tensor_slices", "paragraph_index": 26}, {"url": "https://www.tensorflow.org/api_docs/python/tf/data/Dataset#shuffle", "anchor_text": "shuffle", "paragraph_index": 27}, {"url": "https://www.tensorflow.org/api_docs/python/tf/data/Dataset#batch", "anchor_text": "batch", "paragraph_index": 27}, {"url": "https://keras.io/", "anchor_text": "Keras", "paragraph_index": 32}, {"url": "https://www.tensorflow.org/api_docs/python/tf/keras/layers/Reshape", "anchor_text": "Reshape", "paragraph_index": 34}, {"url": "https://www.tensorflow.org/api_docs/python/tf/keras/layers/Dense", "anchor_text": "Dense", "paragraph_index": 35}, {"url": "https://www.tensorflow.org/api_docs/python/tf/train/AdamOptimizer", "anchor_text": "Adam", "paragraph_index": 39}, {"url": "https://www.tensorflow.org/api_docs/python/tf/keras/losses/CategoricalCrossentropy", "anchor_text": "CategoricalCrossentropy", "paragraph_index": 39}, {"url": "https://www.tensorflow.org/api_docs/python/tf/keras/models/Model#fit", "anchor_text": "fit", "paragraph_index": 40}, {"url": "https://www.psychologytoday.com/intl/articles/199403/what-makes-marriage-work", "anchor_text": "What Makes Marriages Work by John Gottman, Nan Silver", "paragraph_index": 47}], "all_paragraphs": ["TL;DR Build and train your first Neural Network model using TensorFlow 2. Use the model to recognize clothing type from images.", "Ok, I\u2019ll start with a secret \u2014 I am THE fashion wizard (as long as we\u2019re talking tracksuits). Fortunately, there are ways to get help, even for someone like me!", "Can you imagine a really helpful browser extension for \u201cfashion accessibility\u201d? Something that tells you what the type of clothing you\u2019re looking at.", "After all, I really need something like this. I found out nothing like this exists, without even searching for it. Let\u2019s make a Neural Network that predicts clothing type from an image!", "Here\u2019s what we are going to do:", "1. Install TensorFlow 22. Take a look at some fashion data3. Transform the data, so it is useful for us4. Create your first Neural Network in TensorFlow 25. Predict what type of clothing is showing on images your Neural Network haven\u2019t seen", "With TensorFlow 2 just around the corner (not sure how far along that corner is thought) making your first Neural Network has never been easier (as far as TensorFlow goes).", "But what is TensorFlow? Machine Learning platform (really Google?) created and open sourced by Google. Note that TensorFlow is not a special purpose library for creating Neural Networks, although it is primarily used for that purpose.", "So, what TensorFlow 2 has in store for us?", "TensorFlow 2.0 focuses on simplicity and ease of use, with updates like eager execution, intuitive higher-level APIs, and flexible model building on any platform", "Alright, let\u2019s check those claims and install TensorFlow 2:", "Your Neural Network needs something to learn from. In Machine Learning that something is called datasets. The dataset for today is called Fashion MNIST.", "Fashion-MNIST is a dataset of Zalando's article images\u2014consisting of a training set of 60,000 examples and a test set of 10,000 examples. Each example is a 28x28 grayscale image, associated with a label from 10 classes.", "In other words, we have 70,000 images of 28 pixels width and 28 pixels height in greyscale. Each image is showing one of 10 possible clothing types. Here is one:", "Here are some images from the dataset along with the clothing they are showing:", "Here are all different types of clothing:", "Now that we got familiar with the data we have let\u2019s make it usable for our Neural Network.", "Let\u2019s start with loading our data into memory:", "Fortunately, TensorFlow has the dataset built-in, so we can easily obtain it.", "Loading it gives us 4 things:x_train \u2014 image (pixel) data for 60,000 clothes. Used for building our model.y_train \u2014 classes (clothing type) for the clothing above. Used for building our model.", "x_val \u2014 image (pixel) data for 10,000 clothes. Used for testing/validating our model.y_val \u2014 classes (clothing type) for the clothing above. Used for testing/validating our model.", "Now, your Neural Network can\u2019t really see images as you do. But it can understand numbers. Each data point of each image in our dataset is pixel data \u2014 a number between 0 and 255. We would like that data to be transformed (Why? While the truth is more nuanced, one can say it helps with training a better model) in the range 0\u20131. How can we do it?", "We will use the Dataset from TensorFlow to prepare our data:", "Let\u2019s unpack what is happening here. What does tf.one_hot do? Let\u2019s say you have the following vector:", "Here is the one-hot encoded version of it:", "It puts 1 at the index position of the number and 0 everywhere else.", "We create Dataset from the data using from_tensor_slices and divide each pixel of the images by 255 to scale it in the 0\u20131 range.", "Then we use shuffle and batch to convert the data into chunks.", "Why shuffle the data, though? We don\u2019t want our model to make predictions based on the order of the training data, so we just shuffle it.", "I am truly sorry for that bad joke:", "You\u2019re doing great! It is time for the fun part, use the data to create your first Neural Network.", "They say TensorFlow 2 has an easy High-level API, let\u2019s take it for a spin:", "Turns out the High-level API is the old Keras API which is great.", "Most Neural Networks are built by \u201cstacking\u201d layers. Think pancakes or lasagna. Your first Neural Network is really simple. It has 5 layers.", "The first (Reshape) layer is called an input layer and takes care of converting the input data for the layers below. Our images are 28*28=784 pixels. We\u2019re just converting the 2D 28x28 array to a 1D 784 array.", "All other layers are Dense (interconnected). You might notice the parameter units, it sets the number of neurons for each layer. The activation parameter specifies a function that decides whether \u201cthe opinion\u201d of a particular neuron, in the layer, should be taken into account and to what degree. There are a lot of activation functions one can use.", "The last (output) layer is a special one. It has 10 neurons because we have 10 different types of clothing in our data. You get the predictions of the model from this layer.", "Right now your Neural Network is plain dumb. It is like a shell without a soul (good that you get that). Let\u2019s train it using our data:", "Training a Neural Network consists of deciding on objective measurement of accuracy and an algorithm that knows how to improve on that.", "TensorFlow allows us to specify the optimizer algorithm we\u2019re going to use \u2014 Adam and the measurement (loss function) \u2014 CategoricalCrossentropy (we\u2019re choosing/classifying 10 different types of clothing). We\u2019re measuring the accuracy of the model during the training, too!", "The actual training takes place when the fit method is called. We give our training and validation data to it and specify how many epochs we\u2019re training for. During one training epoch, all data is shown to the model.", "Here is a sample result of our training:", "I got ~82% accuracy on the validation set after 10 epochs. Lets profit from our model!", "Now that your Neural Network \u201clearned\u201d something lets try it out:", "Recall that we have 10 different clothing types. Our model outputs a probability distribution about how likely each clothing type is shown on an image. To make a decision, we can get the one with the highest probability:", "Here is one correct and one wrong prediction from our model:", "Alright, you got your first Neural Network running and made some predictions! You can take a look at the Google Colaboratory Notebook (including more charts) here:", "One day you might realize that your relationship with Machine Learning is similar to marriage. The problems you might encounter are similar, too! What Makes Marriages Work by John Gottman, Nan Silver lists 5 problems marriages have: \u201cMoney, Kids, Sex, Time, Others\u201d. Here are the Machine Learning counterparts:", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fe1e2f1dfe7a0&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-your-first-neural-network-in-tensorflow-2-tensorflow-for-hackers-part-i-e1e2f1dfe7a0&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-your-first-neural-network-in-tensorflow-2-tensorflow-for-hackers-part-i-e1e2f1dfe7a0&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-your-first-neural-network-in-tensorflow-2-tensorflow-for-hackers-part-i-e1e2f1dfe7a0&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-your-first-neural-network-in-tensorflow-2-tensorflow-for-hackers-part-i-e1e2f1dfe7a0&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----e1e2f1dfe7a0--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----e1e2f1dfe7a0--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://venelinvalkov.medium.com/?source=post_page-----e1e2f1dfe7a0--------------------------------", "anchor_text": ""}, {"url": "https://venelinvalkov.medium.com/?source=post_page-----e1e2f1dfe7a0--------------------------------", "anchor_text": "Venelin Valkov"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F102e34a0beb1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-your-first-neural-network-in-tensorflow-2-tensorflow-for-hackers-part-i-e1e2f1dfe7a0&user=Venelin+Valkov&userId=102e34a0beb1&source=post_page-102e34a0beb1----e1e2f1dfe7a0---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe1e2f1dfe7a0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-your-first-neural-network-in-tensorflow-2-tensorflow-for-hackers-part-i-e1e2f1dfe7a0&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe1e2f1dfe7a0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-your-first-neural-network-in-tensorflow-2-tensorflow-for-hackers-part-i-e1e2f1dfe7a0&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://www.tensorflow.org/overview", "anchor_text": "TensorFlow"}, {"url": "https://github.com/zalandoresearch/fashion-mnist", "anchor_text": "Fashion MNIST"}, {"url": "https://jobs.zalando.com/tech/", "anchor_text": "Zalando"}, {"url": "https://www.tensorflow.org/api_docs/python/tf/data/Dataset", "anchor_text": "Dataset"}, {"url": "https://www.tensorflow.org/api_docs/python/tf/one_hot", "anchor_text": "tf.one_hot"}, {"url": "https://www.tensorflow.org/api_docs/python/tf/data/Dataset#from_tensor_slices", "anchor_text": "from_tensor_slices"}, {"url": "https://www.tensorflow.org/api_docs/python/tf/data/Dataset#shuffle", "anchor_text": "shuffle"}, {"url": "https://www.tensorflow.org/api_docs/python/tf/data/Dataset#batch", "anchor_text": "batch"}, {"url": "https://keras.io/", "anchor_text": "Keras"}, {"url": "https://www.tensorflow.org/api_docs/python/tf/keras/layers/Reshape", "anchor_text": "Reshape"}, {"url": "https://www.tensorflow.org/api_docs/python/tf/keras/layers/Dense", "anchor_text": "Dense"}, {"url": "https://www.tensorflow.org/api_docs/python/tf/train/AdamOptimizer", "anchor_text": "Adam"}, {"url": "https://www.tensorflow.org/api_docs/python/tf/keras/losses/CategoricalCrossentropy", "anchor_text": "CategoricalCrossentropy"}, {"url": "https://www.tensorflow.org/api_docs/python/tf/keras/models/Model#fit", "anchor_text": "fit"}, {"url": "https://colab.research.google.com/drive/1ctyhVlD9Y85KTBma1X9Zf35Q0ha9PCaP", "anchor_text": "colab.research.google.com"}, {"url": "https://www.psychologytoday.com/intl/articles/199403/what-makes-marriage-work", "anchor_text": "What Makes Marriages Work by John Gottman, Nan Silver"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----e1e2f1dfe7a0---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----e1e2f1dfe7a0---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/tensorflow?source=post_page-----e1e2f1dfe7a0---------------tensorflow-----------------", "anchor_text": "TensorFlow"}, {"url": "https://medium.com/tag/keras?source=post_page-----e1e2f1dfe7a0---------------keras-----------------", "anchor_text": "Keras"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----e1e2f1dfe7a0---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fe1e2f1dfe7a0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-your-first-neural-network-in-tensorflow-2-tensorflow-for-hackers-part-i-e1e2f1dfe7a0&user=Venelin+Valkov&userId=102e34a0beb1&source=-----e1e2f1dfe7a0---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fe1e2f1dfe7a0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-your-first-neural-network-in-tensorflow-2-tensorflow-for-hackers-part-i-e1e2f1dfe7a0&user=Venelin+Valkov&userId=102e34a0beb1&source=-----e1e2f1dfe7a0---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe1e2f1dfe7a0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-your-first-neural-network-in-tensorflow-2-tensorflow-for-hackers-part-i-e1e2f1dfe7a0&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----e1e2f1dfe7a0--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fe1e2f1dfe7a0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-your-first-neural-network-in-tensorflow-2-tensorflow-for-hackers-part-i-e1e2f1dfe7a0&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----e1e2f1dfe7a0---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----e1e2f1dfe7a0--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----e1e2f1dfe7a0--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----e1e2f1dfe7a0--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----e1e2f1dfe7a0--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----e1e2f1dfe7a0--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----e1e2f1dfe7a0--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----e1e2f1dfe7a0--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----e1e2f1dfe7a0--------------------------------", "anchor_text": ""}, {"url": "https://venelinvalkov.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://venelinvalkov.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Venelin Valkov"}, {"url": "https://venelinvalkov.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "2.5K Followers"}, {"url": "https://mlexpert.io", "anchor_text": "https://mlexpert.io"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F102e34a0beb1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-your-first-neural-network-in-tensorflow-2-tensorflow-for-hackers-part-i-e1e2f1dfe7a0&user=Venelin+Valkov&userId=102e34a0beb1&source=post_page-102e34a0beb1--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F5323954064aa&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-your-first-neural-network-in-tensorflow-2-tensorflow-for-hackers-part-i-e1e2f1dfe7a0&newsletterV3=102e34a0beb1&newsletterV3Id=5323954064aa&user=Venelin+Valkov&userId=102e34a0beb1&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}