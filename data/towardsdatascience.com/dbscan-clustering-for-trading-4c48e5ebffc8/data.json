{"url": "https://towardsdatascience.com/dbscan-clustering-for-trading-4c48e5ebffc8", "time": 1683003858.554425, "path": "towardsdatascience.com/dbscan-clustering-for-trading-4c48e5ebffc8/", "webpage": {"metadata": {"title": "DBSCAN Clustering for Trading. Developing a pairs trading strategy | by Roshan Adusumilli | Towards Data Science", "h1": "DBSCAN Clustering for Trading", "description": "Pioneered in the 80\u2019s by quantitative analysts at Morgan Stanley, pairs trading is a trading strategy that allows traders to profit in almost any market conditions. This strategy involves monitoring\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.quantopian.com/docs/user-guide/environments/algo-ide", "anchor_text": "Quantopian IDE", "paragraph_index": 3}, {"url": "https://towardsdatascience.com/questions-96667b06af5", "anchor_text": "rules and guidelines", "paragraph_index": 20}, {"url": "https://towardsdatascience.com/readers-terms-b5d780a700a4", "anchor_text": "Reader Terms", "paragraph_index": 20}, {"url": "https://github.com/marketneutral/pairs-trading-with-ML/blob/master/Pairs%2BTrading%2Bwith%2BMachine%2BLearning.ipynb", "anchor_text": "Pairs Trading with Machine Learning", "paragraph_index": 21}, {"url": "https://towardsdatascience.com/artificial-intelligence-and-its-application-in-finance-9f1e0588e777", "anchor_text": "https://towardsdatascience.com/artificial-intelligence-and-its-application-in-finance-9f1e0588e777", "paragraph_index": 22}], "all_paragraphs": ["Pioneered in the 80\u2019s by quantitative analysts at Morgan Stanley, pairs trading is a trading strategy that allows traders to profit in almost any market conditions. This strategy involves monitoring two historically correlated securities. Once a correlation discrepancy such as one stock going up and the other remaining stagnant is identified, the investor goes long on the underperforming security and short on the outperforming security, hoping that the securities return to their historical correlation. In the case that this does happen, the investor makes a profit from the convergence of the prices.", "For example, General Motors and Ford create a similar product (cars), so they share similar stock price movements based on the overall car market. If the price of General Motors stock increases significantly while the price of Ford stock remains the same, someone implementing a pairs trading strategy would short General Motors stock and buy Ford stock, assuming the prices will return to their historical balance point. If General Motors\u2019 stock falls, the investor profits and if Ford\u2019s stock rises, the investor also profits. However, past prices aren\u2019t always indicative of future trends, so this strategy still carries risk. To help us find historically correlated securities, we can use DBSCAN clustering.", "Machine learning can be utilized in many trading strategies and pairs trading is no different. Density-based spatial clustering of applications with noise (DBSCAN) can be used to cluster stocks and exclude the stocks that don\u2019t fit into a cluster. The two parameters for DBSCAN are eps (how close points should be to each other to be considered part of a cluster) and minPoints (the minimum number of points to form a dense region). From these parameters, the DBSCAN algorithm then creates clusters from the set of points we feed it. Points that are in low density regions are classified as outliers. K-means is another popular clustering algorithm, but it is much more sensitive to outliers, which is why we use DBSCAN instead. Now that we understand pairs trading and DBSCAN, let\u2019s jump into the implementation.", "We start off by making the necessary imports. It\u2019s important to note that the imports from Quantopian are intended to be used in the Quantopian IDE.", "The pre-defined universe we\u2019ll be working with is the Q1500 which is a large set of liquid stocks.", "To create our pipeline with we use information from Morningstar.", "Let\u2019s take a look at our data. We see that it contains 1486 stocks and a description of financial health, industry, and market cap.", "We can\u2019t work with stocks without a financial health grade, so we remove them. Two stocks are lacking a financial health grade so they\u2019re removed.", "Now we\u2019ll create a dictionary to replace the categorical data for financial health with numerical scores.", "For a better understanding of our data, we use .describe() to view a few basic metrics such as mean and standard deviation.", "Get the daily returns (the dollar change in a stock\u2019s price as a percentage of the previous day\u2019s closing price) to use in our strategy. Then we look at the daily returns for Apple as an example.", "Similar to what we did with stocks lacking a financial health grade, we\u2019ll have to remove stocks that don\u2019t have a full return series.", "Our next steps are to use principal component analysis to reduce the dimensionality of the returns data and extract the historical latent common factor loadings for each stock, add the market cap/financial health values, and use DBSCAN.", "The total number of possible pairs are over 900,000 so we\u2019ll significantly reduce that number to only pairs that are among the better candidates for our pairs trading strategy.", "Since the data is currently is clustered in 52 dimensions, we can use the T-SNE algorithm to visualize the data in 2D and see the 15 clusters.", "Let\u2019s plot the number of stocks in each cluster.", "We\u2019ll visualize the smaller clusters for historical correlation to see if DBSCAN did its job properly. As we can see, the prices for stocks in the clusters do indeed have a high correlation.", "To validate the cointegration relationship, we can use a function provided to us by Quantopian. Then, we can get our list of pairs.", "We\u2019re left with a list that contains 118 pairs and 88 unique tickers. As our last step, we\u2019ll use T-SNE again to visualize our validated pairs.", "Finally, we accomplished our goal of finding pairs for a pairs trading strategy.", "Note from Towards Data Science\u2019s editors: While we allow independent authors to publish articles in accordance with our rules and guidelines, we do not endorse each author\u2019s contribution. You should not rely on an author\u2019s works without seeking professional advice. See our Reader Terms for details.", "[1] Jonathan Larkin, Pairs Trading with Machine Learning, Github", "I\u2019m Roshan, a 16 year old passionate about the intersection of artificial intelligence and finance. For a broad view of AI in finance, check out this article: https://towardsdatascience.com/artificial-intelligence-and-its-application-in-finance-9f1e0588e777.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F4c48e5ebffc8&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdbscan-clustering-for-trading-4c48e5ebffc8&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdbscan-clustering-for-trading-4c48e5ebffc8&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdbscan-clustering-for-trading-4c48e5ebffc8&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdbscan-clustering-for-trading-4c48e5ebffc8&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----4c48e5ebffc8--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----4c48e5ebffc8--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@roshan.adusumilli?source=post_page-----4c48e5ebffc8--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@roshan.adusumilli?source=post_page-----4c48e5ebffc8--------------------------------", "anchor_text": "Roshan Adusumilli"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F4b91022e00a0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdbscan-clustering-for-trading-4c48e5ebffc8&user=Roshan+Adusumilli&userId=4b91022e00a0&source=post_page-4b91022e00a0----4c48e5ebffc8---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F4c48e5ebffc8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdbscan-clustering-for-trading-4c48e5ebffc8&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F4c48e5ebffc8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdbscan-clustering-for-trading-4c48e5ebffc8&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://stock.adobe.com/11556619?as_campaign=TinEye&as_content=tineye_match&epi1=11556619&tduid=aff1df247d987defa4e98feaca981780&as_channel=affiliate&as_campclass=redirect&as_source=arvato", "anchor_text": "Sharpshot"}, {"url": "https://www.quantopian.com/docs/user-guide/environments/algo-ide", "anchor_text": "Quantopian IDE"}, {"url": "https://www.quantopian.com/lectures/introduction-to-pairs-trading", "anchor_text": "https://www.quantopian.com/lectures/introduction-to-pairs-trading"}, {"url": "https://towardsdatascience.com/questions-96667b06af5", "anchor_text": "rules and guidelines"}, {"url": "https://towardsdatascience.com/readers-terms-b5d780a700a4", "anchor_text": "Reader Terms"}, {"url": "https://github.com/marketneutral/pairs-trading-with-ML/blob/master/Pairs%2BTrading%2Bwith%2BMachine%2BLearning.ipynb", "anchor_text": "Pairs Trading with Machine Learning"}, {"url": "https://towardsdatascience.com/artificial-intelligence-and-its-application-in-finance-9f1e0588e777", "anchor_text": "https://towardsdatascience.com/artificial-intelligence-and-its-application-in-finance-9f1e0588e777"}, {"url": "https://www.linkedin.com/in/roshan-adusumilli-96b104194/", "anchor_text": "https://www.linkedin.com/in/roshan-adusumilli-96b104194/"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----4c48e5ebffc8---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/ai-in-finance?source=post_page-----4c48e5ebffc8---------------ai_in_finance-----------------", "anchor_text": "Ai In Finance"}, {"url": "https://medium.com/tag/finance?source=post_page-----4c48e5ebffc8---------------finance-----------------", "anchor_text": "Finance"}, {"url": "https://medium.com/tag/stocks?source=post_page-----4c48e5ebffc8---------------stocks-----------------", "anchor_text": "Stocks"}, {"url": "https://medium.com/tag/unsupervised-learning?source=post_page-----4c48e5ebffc8---------------unsupervised_learning-----------------", "anchor_text": "Unsupervised Learning"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F4c48e5ebffc8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdbscan-clustering-for-trading-4c48e5ebffc8&user=Roshan+Adusumilli&userId=4b91022e00a0&source=-----4c48e5ebffc8---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F4c48e5ebffc8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdbscan-clustering-for-trading-4c48e5ebffc8&user=Roshan+Adusumilli&userId=4b91022e00a0&source=-----4c48e5ebffc8---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F4c48e5ebffc8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdbscan-clustering-for-trading-4c48e5ebffc8&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----4c48e5ebffc8--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F4c48e5ebffc8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdbscan-clustering-for-trading-4c48e5ebffc8&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----4c48e5ebffc8---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----4c48e5ebffc8--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----4c48e5ebffc8--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----4c48e5ebffc8--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----4c48e5ebffc8--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----4c48e5ebffc8--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----4c48e5ebffc8--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----4c48e5ebffc8--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----4c48e5ebffc8--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@roshan.adusumilli?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@roshan.adusumilli?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Roshan Adusumilli"}, {"url": "https://medium.com/@roshan.adusumilli/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "467 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F4b91022e00a0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdbscan-clustering-for-trading-4c48e5ebffc8&user=Roshan+Adusumilli&userId=4b91022e00a0&source=post_page-4b91022e00a0--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F33022f0f4364&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdbscan-clustering-for-trading-4c48e5ebffc8&newsletterV3=4b91022e00a0&newsletterV3Id=33022f0f4364&user=Roshan+Adusumilli&userId=4b91022e00a0&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}