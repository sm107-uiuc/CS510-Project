{"url": "https://towardsdatascience.com/deploying-models-to-flask-fb62155ca2c4", "time": 1682996903.216249, "path": "towardsdatascience.com/deploying-models-to-flask-fb62155ca2c4/", "webpage": {"metadata": {"title": "Deploying Models to Flask. A walk-through on how to deploy machine\u2026 | by Jeremy Chow | Towards Data Science", "h1": "Deploying Models to Flask", "description": "You\u2019ve built a model using Pandas, Sci-kit Learn, and Jupyter Notebooks. The results look great in your notebooks, but how do you share what you\u2019ve made with others? To share models, we need to\u2026"}, "outgoing_paragraph_urls": [{"url": "https://github.com/jeremyrchow/Harassment-Classifier-App", "anchor_text": "here", "paragraph_index": 0}, {"url": "https://towardsdatascience.com/quantifying-chatroom-toxicity-e755dd2f9ccf", "anchor_text": "chatroom toxicity classifier", "paragraph_index": 2}, {"url": "http://jinja.pocoo.org/docs/2.10/intro/#basic-api-usage", "anchor_text": "Jinja2 HTML templates", "paragraph_index": 10}, {"url": "https://www.w3schools.com/js/js_json_syntax.asp", "anchor_text": "JSON", "paragraph_index": 18}], "all_paragraphs": ["Code for this project can be found here.", "You\u2019ve built a model using Pandas, Sci-kit Learn, and Jupyter Notebooks. The results look great in your notebooks, but how do you share what you\u2019ve made with others?", "To share models, we need to deploy them, ideally to some website, or at minimum using Python files. Today I will walk you through the process of deploying a model to a website using Python and Flask using my chatroom toxicity classifier models as an example. This article assumes you know how to write Python code, know the basics of HTML, and have Flask installed (pip install flask or conda install flask). We\u2019ll start by going into the file structure!", "Flask wants things in a specific folder layout in order for it to load properly. I\u2019ve taken a snapshot of my file structure for this project but there are only a couple important elements listed below:", "Everything else in the image above is not necessary for Flask to operate properly and can be ignored for the rest of this article. Let\u2019s go into how you set these files up!", "To start, you need to make an API Python file. This is the file that contains all the methods that preprocesses your data, loads your model, then runs your model on the data inputs given by the user. Note that this is independent of Flask, in the sense that this is just a python file that runs your model with no Flask functionality. Here is the skeleton of my predictor_api.py file that contains all the functions to run my model:", "This is personal preference and your data processing steps will vary on the type of model you\u2019re doing as well as the data you\u2019re working with, but I break up the functions in this toxic chat classifier into:", "Side note: you\u2019ll want to pass your predictions in a dictionary format, as this is the format that Flask passes information between its templates and your python files.", "Once you\u2019ve set up your functions, you need some way of testing them. This is when we set up a main section to our script:", "The __name__=='__main__' portion will only run if we launch script on the commandline using python script_name.py . This allows us to debug of our functions and add any unit tests in an area of the file that will not run once our app or website is launched. This part of the code is purely for you as the programmer to make sure your functions are working.", "Now your API file should be working. Cool, how do we get it onto a website? This is where Flask comes in. Flask is a Python framework that uses Jinja2 HTML templates to allow you to easily create webpages using Python. The Flask framework deals with a lot of the backend web stuff so that you can do more with just a couple lines of Python code. To get started, you\u2019re going to need to create your app Python file:", "There\u2019s a lot going on here, so I\u2019ll try to break it down into digestible sections.", "First we import flask, and explicitly import request for quality of life purposes. Next, we have", "This goes to the API file we wrote earlier and imports the make_prediction function, which takes in the user input and runs all data preprocessing then outputs our predictions.", "I\u2019m going to skip to the bottom code briefly. As mentioned earlier,", "runs when you run the Python script through the command line. In order to host our web page, we need to run python your_app_name.py. This will call app.run() and run our web page locally, hosted on your computer.", "After initializing the app, we have to tell Flask what we want to do when the web page loads. The line @app.route(\"/\", methods = [\"GET\",\"POST\"]) tells Flask what to do when we load the home page of our website. The GET method is the type of request your web browser will send the website when it accesses the URL of the web page. Don\u2019t worry about the POST method because it\u2019s a request conventionally used when a user want to change a website, and it doesn\u2019t have much relevance for us in this deployment process. If you want to add another page to your website, you can add an:", "The function name under the routing doesn\u2019t mean anything, it just contains the code that will run upon the user reaching that page.", "In the function below the routing, we have request.args. This is a dictionary (JSON) object that contains the information submitted when someone clicks the \u2018Submit\u2019 button on our form. I\u2019ll show below how we assign what is in the request.args object. Once we have the args, we pass it into our model using the function we imported from our other file, then render the tempate with the predicted values that our model spit out by returning:", "This function takes in the html file that our website runs, then passes in our variables outputted from the model x_input, predictions and shoots them to the HTML template as chat_in, prediction . From here, the job of the model is done, and now we just need to worry about displaying the results to the users!", "First we need to make a way for the user to pass in their input to our model. Since we\u2019re taking chat input, let\u2019s make a text box and a submit button.", "When the user enters a value and hits the submit button, it will send a get request to the template and will fill the request.args dictionary with the key being the name flag in our text box. To access the user\u2019s input, we would use request.args['chat_in'] in the our Python app file. We can pass this into the model, as shown above in this line:", "So we\u2019ve made our predictions using our python files, but now it\u2019s time to display them using HTML templates. Templates are just a way to change HTML code so that we can update the user with new values (such as our predictions). My goal isn\u2019t to teach you HTML here, so I\u2019m not going to elaborate on the HTML code (but you can find it in the github link if you\u2019re curious), but basically you will display the passed variable using the following syntax:", "In this example I am displaying the chat_in variable that was passed in our render_template function above. I also display the first element in the dictionary prediction that I passed to the template, which contains multiple models. From a functional standpoint, we are done! From here, you can focus on making your app look pretty and responsive.", "That\u2019s it for Flask! With some extra HTML code and possibly some JavaScript, you can have a pretty and interactive website that runs on your computer. From here, you can deploy the website to a platform of your choice, be it Heroku, Amazon Web Services, or Google Cloud.", "Thanks for reading, and keep an eye out for my next article on deploying to Heroku!", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Scientist passionate about using machine learning to impact business decisions and discover meaningful insights."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Ffb62155ca2c4&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeploying-models-to-flask-fb62155ca2c4&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeploying-models-to-flask-fb62155ca2c4&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeploying-models-to-flask-fb62155ca2c4&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeploying-models-to-flask-fb62155ca2c4&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----fb62155ca2c4--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----fb62155ca2c4--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@jeremyrchow?source=post_page-----fb62155ca2c4--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@jeremyrchow?source=post_page-----fb62155ca2c4--------------------------------", "anchor_text": "Jeremy Chow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fcaf26ba3661a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeploying-models-to-flask-fb62155ca2c4&user=Jeremy+Chow&userId=caf26ba3661a&source=post_page-caf26ba3661a----fb62155ca2c4---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ffb62155ca2c4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeploying-models-to-flask-fb62155ca2c4&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ffb62155ca2c4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeploying-models-to-flask-fb62155ca2c4&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@olloweb?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Agence Olloweb"}, {"url": "https://unsplash.com/search/photos/website?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://github.com/jeremyrchow/Harassment-Classifier-App", "anchor_text": "here"}, {"url": "https://towardsdatascience.com/quantifying-chatroom-toxicity-e755dd2f9ccf", "anchor_text": "chatroom toxicity classifier"}, {"url": "http://jinja.pocoo.org/docs/2.10/intro/#basic-api-usage", "anchor_text": "Jinja2 HTML templates"}, {"url": "http://127.0.0.1:5000/", "anchor_text": "http://127.0.0.1:5000/"}, {"url": "http://twitter.com/app", "anchor_text": "@app"}, {"url": "https://www.w3schools.com/js/js_json_syntax.asp", "anchor_text": "JSON"}, {"url": "https://medium.com/tag/towards-data-science?source=post_page-----fb62155ca2c4---------------towards_data_science-----------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/tag/flask?source=post_page-----fb62155ca2c4---------------flask-----------------", "anchor_text": "Flask"}, {"url": "https://medium.com/tag/data-science?source=post_page-----fb62155ca2c4---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/python?source=post_page-----fb62155ca2c4---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Ffb62155ca2c4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeploying-models-to-flask-fb62155ca2c4&user=Jeremy+Chow&userId=caf26ba3661a&source=-----fb62155ca2c4---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Ffb62155ca2c4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeploying-models-to-flask-fb62155ca2c4&user=Jeremy+Chow&userId=caf26ba3661a&source=-----fb62155ca2c4---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ffb62155ca2c4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeploying-models-to-flask-fb62155ca2c4&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----fb62155ca2c4--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Ffb62155ca2c4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeploying-models-to-flask-fb62155ca2c4&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----fb62155ca2c4---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----fb62155ca2c4--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----fb62155ca2c4--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----fb62155ca2c4--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----fb62155ca2c4--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----fb62155ca2c4--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----fb62155ca2c4--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----fb62155ca2c4--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----fb62155ca2c4--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@jeremyrchow?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@jeremyrchow?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Jeremy Chow"}, {"url": "https://medium.com/@jeremyrchow/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "300 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fcaf26ba3661a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeploying-models-to-flask-fb62155ca2c4&user=Jeremy+Chow&userId=caf26ba3661a&source=post_page-caf26ba3661a--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F5950ea45395a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeploying-models-to-flask-fb62155ca2c4&newsletterV3=caf26ba3661a&newsletterV3Id=5950ea45395a&user=Jeremy+Chow&userId=caf26ba3661a&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}