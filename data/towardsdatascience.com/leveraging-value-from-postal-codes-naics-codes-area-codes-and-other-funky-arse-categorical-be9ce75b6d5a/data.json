{"url": "https://towardsdatascience.com/leveraging-value-from-postal-codes-naics-codes-area-codes-and-other-funky-arse-categorical-be9ce75b6d5a", "time": 1683013405.042945, "path": "towardsdatascience.com/leveraging-value-from-postal-codes-naics-codes-area-codes-and-other-funky-arse-categorical-be9ce75b6d5a/", "webpage": {"metadata": {"title": "Leveraging Value from Postal Codes, NAICS Codes, Area Codes and Other Funky-Arse Categorical Variables in Machine Learning Models | by Shad Griffin | Towards Data Science", "h1": "Leveraging Value from Postal Codes, NAICS Codes, Area Codes and Other Funky-Arse Categorical Variables in Machine Learning Models", "description": "The zip (postal) code you live in says a tremendous amount about you. (At least in North America). Where you live suggests: your annual income, whether you have children, the TV shows you watch and\u2026"}, "outgoing_paragraph_urls": [], "all_paragraphs": ["The zip (postal) code you live in says a tremendous amount about you. (At least in North America). Where you live suggests: your annual income, whether you have children, the TV shows you watch and your political leanings.", "In the United States, there are over 41,000 unique zip codes. Zip codes are largely categorical. There is some broad meaning in the first two digits of the zip code. For example, Hawaii zip codes start with 9 and Maine zip codes start with 0. Beyond, very general geographic information, the codes themselves really provide little value.", "What I if said that Joe lives in 76092? Does that really tell you much about him?", "Now, if I googled that zip code. I would find out that 76092 is Southlake, Texas. Southlake is one of the most affluent areas of Texas. Living in 76092 means that Joe probably makes more than 100k a year and has a college education.", "My point here is that the code itself doesn\u2019t tell us much. We have to find creative ways to extract value from the zip code.", "So, given that zip codes can tell us a great deal about the people who live in them, how do we extract this information and exploit it in a machine learning model?", "One way to deal with categorical variables like zip codes is to split them into dummy variables. This is what \u201cOne Hot Encoder\u201d does. When you have a categorical variable with 41,000 unique values, dummy variables really won\u2019t be much help, unfortunately. Using \u201cOne Hot Encoder\u201d on zip code means you\u2019ll create 40,999 new independent variables. Jeez, what a mess!", "Another approach is something called Mean/Target Encoding. In full disclosure, I have used this technique for over twenty years, and only recently have I heard it called that. It doesn\u2019t really matter though. Whatever you want to call it, it works quite well for categorical variables like zip code, NAICS, census block or any other meaningful categorical variable that has many distinct values.", "In this example, I walk through a customer prospecting use case. The company is looking to grow its customer base but has limited marketing/sales resources. Because they don\u2019t have enough money to contact everyone in the database, they will use a predictive model to predict those prospects most likely to acquire their product. I will not be building a model in this notebook. Rather, I will show you can leverage your historical data and zip code to create features that will build more predictive machine learning models.", "As I write this, it is February 2020. So, the goal is to build a model that will predict 2020. To do this, we will use data from 2019. As we do our feature engineering, it is best not to use the same data you use for your model. Doing so leads to some major causality issues and overfitting. Instead of 2019, I will be using data from 2018 to build my features. So, just to re-cap. I will use 2018 data to build my features. Use 2019 data to build a model and apply that model to current prospects in 2020.", "What if you don\u2019t have multiple years of data? In that case, I would recommend creating a separate sample of the data set to build your features. So, as you build your model, you would split your data into four groups. This would include a Training, a Testing, a Validation and a Feature Building data set.", "And finally, I will be creating summaries that are specific to a customer acquisition problem, but this technique applies to pretty much everything. For example, you could create average costs for supplier codes in health care. Or, Out of Business rates for certain NAICS codes. It is important to understand the process and realize that this technique can be applied to many different situations.", "The first step is to import your python libraries.", "As I mentioned earlier, we hope to build a model on data from 2019 to predict customer acquisition in 2020. To build our features, we will use data from 2018.", "Pull in the 2018 data from Github.", "This is a fairly simple data set. Here is a description of the fields.", "ZIP5 \u2014 The zip code of the individual.", "HAS_CHILDREN \u2014 1 means the individual has children. 0 means they do not.", "PRIMARY_LANGUAGE \u2014 The primary language of the individual.", "INCOME \u2014 Income of the individual.", "AGE_IN_YEARS \u2014 Age of the individual.", "LENGTH_OF_RESIDENCE \u2014 Length of time the individual has resided at their current address.", "HOME_OWNER_RENTER \u2014 O means the individual owns their home.", "CUSTOMER \u2014 indicates if the record belongs to a customer. 1 is a customer 0 is a non-customer.", "CHURN \u2014 1 means the individual canceled their product in 2018. 0 Means they did not cancel.", "ACQ \u2014 1 means the individual acquired the product in 2018.", "REVENUE \u2014 Total Revenue of the Individual in 2018.", "YEAR \u2014 the YEAR of the individual record.", "It may be obvious, but the last five fields are the important ones from a feature engineering perspective. In the next few lines of code, for each zip code we will derive the following.", "ZIP_PENETRATION_RATE \u2014 The percentage of individuals in a zip code who are customers.", "ZIP_CHURN_RATE \u2014 the churn rate of a specific zip code", "ZIP_AQC_RATE \u2014 The customer acquisition rate of the zip code.", "ZIP_AVG_REV \u2014 the average revenue for customers in specific zip code.", "ZIP_MEDIAN_REV \u2014 the median revenue for customers in a specific zip code", "ZIP_CUSTOMERS \u2014 The total number of customers in a specific zip code.", "ZIP_POPULATION \u2014 The total number of Individuals in a specific zip code.", "ZIP_CHURNERS \u2014 The total number of Churners in a specific zip code.", "ZIP _REVENUE \u2014 The total revenue in a specific zip code.", "By creating these new fields, we can extract the value imbedded in zip code.", "Append the features into a single data frame.", "Note that you have to be careful of small sample sizes when calculating averages and ratios. In this example, I only calculate a rate or average for a zip code if there are more than 100 people in the zip code. You want to avoid situations where a metric is high or low only because the sample is small. For example, if you have 2 people in a zip code and one is a customer, the penetration rate would be extremely high (50%). This high number doesn\u2019t mean that the zip code is fertile grounds for prospecting. Maybe it is. Maybe it isn\u2019t. If you only have two people in your sample, the statistic really has no value.", "Like I mentioned earlier, I only use a statistic or ratio if there are more than 100 people are in the zip code. If there is less than 100 people, I use the global average or ratio. Note that there is nothing magical about 100. You should use a number that is logical and meets the needs of your business case. I have also seen examples were people will use a weighted metric if there is a small sample size for a particular group. That is, they will take the cases in the zip code and combine with the global average/ratio in a weighted manner. I think that is a bit over-kill, but if it floats your boat, go for it.", "It is easy to get lost in python code, but let\u2019s take a step back and remember our objective. Our objective is to extract the hidden value inside a categorical variable with 41000 unique values. That is, make a variable useful when the actual values of the variable are not useful. This is what we have done. For example, the value 75001 is not very useful. Knowing, however, that the zip code 75001 has a product penetration rate of .260722 is very useful.", "Now that we have created out zip code level features, we can append them to our modeling data set, 2019 data.", "Collect the data from GitHub. And append the features to the 2019 data.", "Now we can use our features to build an Acquisition Model using ACQ as a dependent variable. The features should allow us to extract the full predictive value from the zip code field.", "One last note. When you actually deploy the model to our 2020 data, use the 2019 data to create your zip code feature variables, not 2018. This makes sense right? The features are extracted from the previous year of data. When we build a model for 2019, this was 2018. When we deploy the model for 2020, this would be 2019.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Economist, Data Scientist and Data Wrangler. Opinions expressed and funny jokes are exclusively mine. Seeking truth from my treehouse on Idiot\u2019s Hill, Texas"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fbe9ce75b6d5a&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fleveraging-value-from-postal-codes-naics-codes-area-codes-and-other-funky-arse-categorical-be9ce75b6d5a&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fleveraging-value-from-postal-codes-naics-codes-area-codes-and-other-funky-arse-categorical-be9ce75b6d5a&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fleveraging-value-from-postal-codes-naics-codes-area-codes-and-other-funky-arse-categorical-be9ce75b6d5a&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fleveraging-value-from-postal-codes-naics-codes-area-codes-and-other-funky-arse-categorical-be9ce75b6d5a&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----be9ce75b6d5a--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----be9ce75b6d5a--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://jshadgriffin.medium.com/?source=post_page-----be9ce75b6d5a--------------------------------", "anchor_text": ""}, {"url": "https://jshadgriffin.medium.com/?source=post_page-----be9ce75b6d5a--------------------------------", "anchor_text": "Shad Griffin"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fb2cb0fe3df91&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fleveraging-value-from-postal-codes-naics-codes-area-codes-and-other-funky-arse-categorical-be9ce75b6d5a&user=Shad+Griffin&userId=b2cb0fe3df91&source=post_page-b2cb0fe3df91----be9ce75b6d5a---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fbe9ce75b6d5a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fleveraging-value-from-postal-codes-naics-codes-area-codes-and-other-funky-arse-categorical-be9ce75b6d5a&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fbe9ce75b6d5a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fleveraging-value-from-postal-codes-naics-codes-area-codes-and-other-funky-arse-categorical-be9ce75b6d5a&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://github.com/shadgriffin/zip_code/blob/master/Leveraging%20Mean/Target%20Encoding.ipynb", "anchor_text": "shadgriffin/zip_codePermalink Dismiss GitHub is home to over 50 million developers working together to host and review code, manage\u2026github.com"}, {"url": "https://raw.githubusercontent.com/shadgriffin/zip_code/master/YEAR_2018_1.csv", "anchor_text": "https://raw.githubusercontent.com/shadgriffin/zip_code/master/YEAR_2018_1.csv"}, {"url": "https://raw.githubusercontent.com/shadgriffin/zip_code/master/YEAR_2018_2.csv", "anchor_text": "https://raw.githubusercontent.com/shadgriffin/zip_code/master/YEAR_2018_2.csv"}, {"url": "https://raw.githubusercontent.com/shadgriffin/zip_code/master/YEAR_2019.csv", "anchor_text": "https://raw.githubusercontent.com/shadgriffin/zip_code/master/YEAR_2019.csv"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fbe9ce75b6d5a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fleveraging-value-from-postal-codes-naics-codes-area-codes-and-other-funky-arse-categorical-be9ce75b6d5a&user=Shad+Griffin&userId=b2cb0fe3df91&source=-----be9ce75b6d5a---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fbe9ce75b6d5a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fleveraging-value-from-postal-codes-naics-codes-area-codes-and-other-funky-arse-categorical-be9ce75b6d5a&user=Shad+Griffin&userId=b2cb0fe3df91&source=-----be9ce75b6d5a---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fbe9ce75b6d5a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fleveraging-value-from-postal-codes-naics-codes-area-codes-and-other-funky-arse-categorical-be9ce75b6d5a&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----be9ce75b6d5a--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fbe9ce75b6d5a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fleveraging-value-from-postal-codes-naics-codes-area-codes-and-other-funky-arse-categorical-be9ce75b6d5a&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----be9ce75b6d5a---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----be9ce75b6d5a--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----be9ce75b6d5a--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----be9ce75b6d5a--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----be9ce75b6d5a--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----be9ce75b6d5a--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----be9ce75b6d5a--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----be9ce75b6d5a--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----be9ce75b6d5a--------------------------------", "anchor_text": ""}, {"url": "https://jshadgriffin.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://jshadgriffin.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Shad Griffin"}, {"url": "https://jshadgriffin.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "196 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fb2cb0fe3df91&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fleveraging-value-from-postal-codes-naics-codes-area-codes-and-other-funky-arse-categorical-be9ce75b6d5a&user=Shad+Griffin&userId=b2cb0fe3df91&source=post_page-b2cb0fe3df91--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F5fc6e6fb5453&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fleveraging-value-from-postal-codes-naics-codes-area-codes-and-other-funky-arse-categorical-be9ce75b6d5a&newsletterV3=b2cb0fe3df91&newsletterV3Id=5fc6e6fb5453&user=Shad+Griffin&userId=b2cb0fe3df91&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}