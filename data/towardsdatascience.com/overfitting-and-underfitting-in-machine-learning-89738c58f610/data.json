{"url": "https://towardsdatascience.com/overfitting-and-underfitting-in-machine-learning-89738c58f610", "time": 1683006112.026192, "path": "towardsdatascience.com/overfitting-and-underfitting-in-machine-learning-89738c58f610/", "webpage": {"metadata": {"title": "Overfitting And Underfitting In Machine Learning | by Ritesh Ranjan | Towards Data Science", "h1": "Overfitting And Underfitting In Machine Learning", "description": "While training models on a dataset, the most common problems people face are overfitting and underfitting. Overfitting is the main cause behind the poor performance of machine learning models. Don\u2019t\u2026"}, "outgoing_paragraph_urls": [{"url": "https://github.com/riteshranjan110/AmazonFineFoodReviewClassification/blob/master/Amazon_Fine_Food_Reviews_Analysis_Decision_Trees.ipynb", "anchor_text": "here", "paragraph_index": 14}, {"url": "https://medium.com/analytics-vidhya/cross-entropy-log-loss-and-intuition-behind-it-364558dca514", "anchor_text": "blog", "paragraph_index": 16}, {"url": "https://medium.com/analytics-vidhya/calibration-in-machine-learning-e7972ac93555", "anchor_text": "blog", "paragraph_index": 17}, {"url": "https://www.linkedin.com/in/riteshranjan11055/", "anchor_text": "https://www.linkedin.com/in/riteshranjan11055/", "paragraph_index": 19}], "all_paragraphs": ["While training models on a dataset, the most common problems people face are overfitting and underfitting. Overfitting is the main cause behind the poor performance of machine learning models. Don\u2019t worry if you have faced the problem of overfitting. Just go through this article. In this article, we will go through a running example to show how to prevent the model from overfitting. Before that let\u2019s understand what overfitting and underfitting are first.", "Our main objective in machine learning is to properly estimate the distribution and probability in training dataset so that we can have a generalized model that can predict the distribution and probability of the test dataset.", "When a model learns the pattern and noise in the data to such extent that it hurts the performance of the model on the new dataset, is termed overfitting. The model fits the data so well that it interprets noise as patterns in the data.", "The problem of overfitting mainly occurs with non-linear models whose decision boundary is non-linear. An example of a linear decision boundary can be a line or a hyperplane in case of logistic regression. As in the above diagram of overfitting, you can see the decision boundary is non-linear. This type of decision boundary is generated by non-linear models such as decision trees.", "We also have parameters in non-linear models by which we can prevent overfitting. We will see this later in this article.", "When the model neither learns from the training dataset nor generalizes well on the test dataset, it is termed as underfitting. This type of problem is not a headache as this can be very easily detected by the performance metrics. If the performance is not good to try other models and you will certainly get good results. Hence, underfitting is not often discussed as often as overfitting is discussed.", "Since we have seen what overfitting and underfitting are, let\u2019s see what good fit means.", "The spot in the middle of underfitting and overfitting is the good fit.", "In the real world, getting a perfect fit model is very difficult. You will not get the perfect fit model in one go. First, you will have a first cut solution which you will use in the production, and then you will retrain this model on the data you gather over time.", "In this section, I will take a real-world case study to demonstrate how to prevent the model from overfitting. We will be using amazon fine food reviews dataset and train decision tree on this dataset. I will also provide a GitHub link for further reference. I am assuming you all know what are decision tree. We will be using the sklearn library.", "You can prevent the model from overfitting by using techniques like K-fold cross-validation and hyperparameter tuning. Generally, people use K-fold cross-validation to do hyperparameter tuning. I will show how to do this by taking an example of a decision tree. First, let me explain what is K-fold cross-validation.", "K-fold cross-validation: In this technique, we generally divide the dataset into three parts. The training part contains 80% data and the test part contains 20% data. Further during training, the training dataset is divided into 80:20 ratio and 80% of data is used for training and 20% is used for cross-validation. In decision trees, hyperparameters are the depth of the tree and the number of data points at each node after which the node will be split. We will see how k-fold cross-validation works. Here I will give an example of 5-fold cross-validation. So training data set will be divided into 5 parts and randomly 4 parts will be selected for training and 1 part for validation. This will be repeated 5 times and the average of the metric will be the final metric for that epoch. In one epoch the depth of the tree and split value is fixed. Ex: In an epoch, we can have the depth of the tree to be 100 and split value at 200. Let the training dataset D is divided into D1, D2, D3, D4, and D5. The calculation of validation is shown below for a fixed value of hyperparameter.", "This helps to monitor the training as during training we validate the model on unseen data. Let us take accuracy as a metric for now. After training A1 is the training accuracy. If both the training accuracy and test accuracy are close then the model has not overfit. If the training result is very good and the test result is poor then the model has overfitted. If the training accuracy and test accuracy is low then the model has underfit. If the model is underfitting or overfitting then we change the value of the hyperparameter and again retrain the model until we get a good fit.", "Hyperparameter tuning: In this, we take a range of all the hyperparameter and then we monitor the cross-validation accuracy on all the possible combinations of hyperparameters. We take that hyperparameter that gave the best accuracy(here we have taken accuracy as a metric). Then we train the model with that hyperparameter and then test it. Following is how cross-validation accuracy is calculated for each hyperparameter combination.", "We can do hyperparameter using the GridSearchCv or RandomSearchCv provided by the sklearn library. GridSearchCv will check the cross-validation on all the possible combinations but RandomSearchCv checks by selecting the combinations randomly. Below is the code to do hyperparameter tuning. To view the complete code click here.", "I hope this clears up what overfitting and underfitting are and how to tackle them.", "Having difficulty in understanding why we cross-entropy. Go through this blog to have a clear intuition.", "If you have difficulty in understanding calibration the go through this blog.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Machine Learning Enthusiast. Writer in Towards Data Science, Analytics Vidhya, and AI In Plain English. LinkedIn: https://www.linkedin.com/in/riteshranjan11055/"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F89738c58f610&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Foverfitting-and-underfitting-in-machine-learning-89738c58f610&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Foverfitting-and-underfitting-in-machine-learning-89738c58f610&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Foverfitting-and-underfitting-in-machine-learning-89738c58f610&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Foverfitting-and-underfitting-in-machine-learning-89738c58f610&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----89738c58f610--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----89738c58f610--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://riteshk981.medium.com/?source=post_page-----89738c58f610--------------------------------", "anchor_text": ""}, {"url": "https://riteshk981.medium.com/?source=post_page-----89738c58f610--------------------------------", "anchor_text": "Ritesh Ranjan"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fb6b2556387fc&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Foverfitting-and-underfitting-in-machine-learning-89738c58f610&user=Ritesh+Ranjan&userId=b6b2556387fc&source=post_page-b6b2556387fc----89738c58f610---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F89738c58f610&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Foverfitting-and-underfitting-in-machine-learning-89738c58f610&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F89738c58f610&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Foverfitting-and-underfitting-in-machine-learning-89738c58f610&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://github.com/riteshranjan110/AmazonFineFoodReviewClassification/blob/master/Amazon_Fine_Food_Reviews_Analysis_Decision_Trees.ipynb", "anchor_text": "here"}, {"url": "https://medium.com/analytics-vidhya/cross-entropy-log-loss-and-intuition-behind-it-364558dca514", "anchor_text": "blog"}, {"url": "https://medium.com/@riteshk981/cross-entropy-log-loss-and-intuition-behind-it-364558dca514", "anchor_text": "Cross-Entropy, Log-Loss, And Intuition Behind ItIn this blog, you will get an intuition behind the use of cross-entropy and log-loss in machine learning.medium.com"}, {"url": "https://medium.com/analytics-vidhya/calibration-in-machine-learning-e7972ac93555", "anchor_text": "blog"}, {"url": "https://medium.com/analytics-vidhya/calibration-in-machine-learning-e7972ac93555", "anchor_text": "Calibration in Machine LearningIn this blog, we will learn what is calibration and why and when we should use it.medium.com"}, {"url": "https://en.wikipedia.org/wiki/Overfitting", "anchor_text": "https://en.wikipedia.org/wiki/Overfitting"}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.RandomizedSearchCV.html", "anchor_text": "https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.RandomizedSearchCV.html"}, {"url": "https://machinelearningmastery.com/overfitting-and-underfitting-with-machine-learning-algorithms/", "anchor_text": "https://machinelearningmastery.com/overfitting-and-underfitting-with-machine-learning-algorithms/"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----89738c58f610---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----89738c58f610---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/computer-science?source=post_page-----89738c58f610---------------computer_science-----------------", "anchor_text": "Computer Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F89738c58f610&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Foverfitting-and-underfitting-in-machine-learning-89738c58f610&user=Ritesh+Ranjan&userId=b6b2556387fc&source=-----89738c58f610---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F89738c58f610&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Foverfitting-and-underfitting-in-machine-learning-89738c58f610&user=Ritesh+Ranjan&userId=b6b2556387fc&source=-----89738c58f610---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F89738c58f610&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Foverfitting-and-underfitting-in-machine-learning-89738c58f610&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----89738c58f610--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F89738c58f610&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Foverfitting-and-underfitting-in-machine-learning-89738c58f610&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----89738c58f610---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----89738c58f610--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----89738c58f610--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----89738c58f610--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----89738c58f610--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----89738c58f610--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----89738c58f610--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----89738c58f610--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----89738c58f610--------------------------------", "anchor_text": ""}, {"url": "https://riteshk981.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://riteshk981.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Ritesh Ranjan"}, {"url": "https://riteshk981.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "68 Followers"}, {"url": "https://www.linkedin.com/in/riteshranjan11055/", "anchor_text": "https://www.linkedin.com/in/riteshranjan11055/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fb6b2556387fc&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Foverfitting-and-underfitting-in-machine-learning-89738c58f610&user=Ritesh+Ranjan&userId=b6b2556387fc&source=post_page-b6b2556387fc--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fad539cca55bd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Foverfitting-and-underfitting-in-machine-learning-89738c58f610&newsletterV3=b6b2556387fc&newsletterV3Id=ad539cca55bd&user=Ritesh+Ranjan&userId=b6b2556387fc&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}