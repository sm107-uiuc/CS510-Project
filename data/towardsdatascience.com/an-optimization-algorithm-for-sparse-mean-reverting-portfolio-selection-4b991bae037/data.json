{"url": "https://towardsdatascience.com/an-optimization-algorithm-for-sparse-mean-reverting-portfolio-selection-4b991bae037", "time": 1683015503.0132911, "path": "towardsdatascience.com/an-optimization-algorithm-for-sparse-mean-reverting-portfolio-selection-4b991bae037/", "webpage": {"metadata": {"title": "An Optimization Algorithm for Sparse Mean-Reverting Portfolio Selection | by Tim Leung, Ph.D. | Towards Data Science", "h1": "An Optimization Algorithm for Sparse Mean-Reverting Portfolio Selection", "description": "we study an approach that combines statistical learning and optimization to construct portfolios with mean-reverting price dynamics. We present the full problem formulation, a specialized projected gradient algorithm to solve the constrained non-convex problem. Numerical examples using empirical price data are provided."}, "outgoing_paragraph_urls": [{"url": "https://papers.ssrn.com/sol3/papers.cfm?abstract_id=3252777", "anchor_text": "paper", "paragraph_index": 22}, {"url": "https://towardsdatascience.com/pairs-trading-with-optimized-positions-exit-rules-811fa0c6be91", "anchor_text": "article", "paragraph_index": 23}, {"url": "https://scholar.google.com/citations?user=P40aOHIAAAAJ&hl=en", "anchor_text": "Google Scholar", "paragraph_index": 24}, {"url": "https://www.linkedin.com/in/timstleung/", "anchor_text": "Linkedin Page", "paragraph_index": 24}, {"url": "https://sites.google.com/site/timleungresearch/research", "anchor_text": "Homepage", "paragraph_index": 24}, {"url": "https://towardsdatascience.com/questions-96667b06af5", "anchor_text": "rules and guidelines", "paragraph_index": 25}, {"url": "https://towardsdatascience.com/readers-terms-b5d780a700a4", "anchor_text": "Reader Terms", "paragraph_index": 25}], "all_paragraphs": ["Motivated by the industry practice of pairs trading and long/short equity strategies, we study an approach that combines statistical learning and optimization to construct portfolios with mean-reverting price dynamics.", "In this article, we present the full problem formulation and discuss a specialized algorithm that exploits the problem structure. Using historical price data, we illustrate the method in a series of numerical examples .", "Given historical data for m assets observed over T time-steps. Our main goal is to find the vector w, the linear combination of assets that comprise our portfolio, such that the corresponding portfolio price process best follows an OU process. The likelihood of an OU process observed over T time-steps is given by", "A major feature of our joint optimization approach is that we simultaneously solve for the optimal portfolio and corresponding parameters for maximum likelihood.", "Minimizing the negative log-likelihood results in the optimization problem", "Given a set of candidate assets, we want to select a small parsimonious subset to build a portfolio. This feature is useful in practice since it reduces transaction costs, execution risks, and the burden of monitoring many stock prices.", "To add this feature to the model, we want to impose a sparsity penalty on the portfolio vector w. While the 1-norm is frequently used, in our case we have already imposed the 1-norm equality constraint ||w||\u2081 = 1 . To obtain sparse solutions (i.e. limiting non-zero weights to a small number), we use the 0-norm and apply a cardinality constraint ||w||\u2080 \u2264\u03b7 to the optimization problem. This constraint limits the maximum number of assets in the portfolio, and is nonconvex.", "In addition to sparsifying the solution, we may also want to promote other features of the portfolio. The penalized likelihood framework is flexible enough to allow these enhancements. An important feature is encapsulated by the mean-reverting coefficient \u03bc; a higher may be desirable. We can seek a higher by promoting a lower c , e.g. with a linear penalty.", "With the new constraint and penalty, the optimization problem becomes", "Our strategy is to first use variable projection as follows:", "This leads us to solve the nonconvex optimization problem with nonconvex constraints:", "If we wish to use gradient descent to iterate, but it\u2019s possible that the next iteration w\u1d62\u208a\u2081 is outside the feasible region.", "In the projected gradient descent, we simply choose the point within the feasible set that is nearest to each iteration. This can be summarized succinctly as", "And here\u2019s the summary of our algorithm:", "We performed experiments with empirical price data from three groups of selected assets:", "Precious Metals: GLD, GDX, GDXJ, SLV, GG, AB", "Large Capital Equities/ETFs: GOOG, JNJ, NKE, MCD, SBUX, SPY, VIG, VO", "Oil Companies/ETFs: BP, COP, CVX, OIL, USO, VLO, XOM", "Data were taken from Yahoo Finance, and give closing stock prices for each asset over the past five years. The first 70% of data (over time) is used for training, and the rest for testing.", "For each group, we progressively augmented the set of candidate assets in pairs and applied our approach. Tables below show the optimized portfolio weights when 2, 4, or 6 assets are allowed, along with the in-sample and out-of-sample negative log likelihoods (nll)of the corresponding portfolios.", "The portfolio nlls are generally decrease as we include more assets, which means we can obtain more OU-representable portfolios as the candidate sets expand.", "Next, we look at the time series of the asset prices and resulting portfolios.", "Our algorithm can be fully automated to process more asset prices and identify price patterns, and in turn discover trading opportunities. This feature of scalability is vital for all machine learning approach to trading. In our paper, we also discuss the speed of our algorithm, which is another important element for algo trading strategies.", "In order to trade a mean-reverting portfolio, one still needs to determine the entry and exit timings along with stop-loss strategies, as discussed in this related article.", "Google Scholar // Linkedin Page // Homepage", "Note from Towards Data Science\u2019s editors: While we allow independent authors to publish articles in accordance with our rules and guidelines, we do not endorse each author\u2019s contribution. You should not rely on an author\u2019s works without seeking professional advice. See our Reader Terms for details.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Boeing Endowed Chair Professor of Applied Math, Director of the Computational Finance & Risk Management (CFRM) Program at University of Washington in Seattle"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F4b991bae037&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fan-optimization-algorithm-for-sparse-mean-reverting-portfolio-selection-4b991bae037&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fan-optimization-algorithm-for-sparse-mean-reverting-portfolio-selection-4b991bae037&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fan-optimization-algorithm-for-sparse-mean-reverting-portfolio-selection-4b991bae037&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fan-optimization-algorithm-for-sparse-mean-reverting-portfolio-selection-4b991bae037&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----4b991bae037--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----4b991bae037--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://timleungresearch.medium.com/?source=post_page-----4b991bae037--------------------------------", "anchor_text": ""}, {"url": "https://timleungresearch.medium.com/?source=post_page-----4b991bae037--------------------------------", "anchor_text": "Tim Leung, Ph.D."}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F11571ce47b1a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fan-optimization-algorithm-for-sparse-mean-reverting-portfolio-selection-4b991bae037&user=Tim+Leung%2C+Ph.D.&userId=11571ce47b1a&source=post_page-11571ce47b1a----4b991bae037---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F4b991bae037&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fan-optimization-algorithm-for-sparse-mean-reverting-portfolio-selection-4b991bae037&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F4b991bae037&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fan-optimization-algorithm-for-sparse-mean-reverting-portfolio-selection-4b991bae037&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@heathermedwards?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Heather M. Edwards"}, {"url": "https://unsplash.com/s/photos/herd?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://papers.ssrn.com/sol3/papers.cfm?abstract_id=3252777", "anchor_text": "paper"}, {"url": "https://towardsdatascience.com/pairs-trading-with-optimized-positions-exit-rules-811fa0c6be91", "anchor_text": "article"}, {"url": "https://doi.org/10.1016/j.automatica.2019.108651", "anchor_text": "https://doi.org/10.1016/j.automatica.2019.108651"}, {"url": "https://doi.org/10.1142/S021902491550020X", "anchor_text": "https://doi.org/10.1142/S021902491550020X"}, {"url": "https://scholar.google.com/citations?user=P40aOHIAAAAJ&hl=en", "anchor_text": "Google Scholar"}, {"url": "https://www.linkedin.com/in/timstleung/", "anchor_text": "Linkedin Page"}, {"url": "https://sites.google.com/site/timleungresearch/research", "anchor_text": "Homepage"}, {"url": "https://towardsdatascience.com/questions-96667b06af5", "anchor_text": "rules and guidelines"}, {"url": "https://towardsdatascience.com/readers-terms-b5d780a700a4", "anchor_text": "Reader Terms"}, {"url": "https://medium.com/tag/optimization?source=post_page-----4b991bae037---------------optimization-----------------", "anchor_text": "Optimization"}, {"url": "https://medium.com/tag/algorithmic-trading?source=post_page-----4b991bae037---------------algorithmic_trading-----------------", "anchor_text": "Algorithmic Trading"}, {"url": "https://medium.com/tag/algorithms?source=post_page-----4b991bae037---------------algorithms-----------------", "anchor_text": "Algorithms"}, {"url": "https://medium.com/tag/portfolio?source=post_page-----4b991bae037---------------portfolio-----------------", "anchor_text": "Portfolio"}, {"url": "https://medium.com/tag/trading?source=post_page-----4b991bae037---------------trading-----------------", "anchor_text": "Trading"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F4b991bae037&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fan-optimization-algorithm-for-sparse-mean-reverting-portfolio-selection-4b991bae037&user=Tim+Leung%2C+Ph.D.&userId=11571ce47b1a&source=-----4b991bae037---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F4b991bae037&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fan-optimization-algorithm-for-sparse-mean-reverting-portfolio-selection-4b991bae037&user=Tim+Leung%2C+Ph.D.&userId=11571ce47b1a&source=-----4b991bae037---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F4b991bae037&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fan-optimization-algorithm-for-sparse-mean-reverting-portfolio-selection-4b991bae037&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----4b991bae037--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F4b991bae037&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fan-optimization-algorithm-for-sparse-mean-reverting-portfolio-selection-4b991bae037&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----4b991bae037---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----4b991bae037--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----4b991bae037--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----4b991bae037--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----4b991bae037--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----4b991bae037--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----4b991bae037--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----4b991bae037--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----4b991bae037--------------------------------", "anchor_text": ""}, {"url": "https://timleungresearch.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://timleungresearch.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Tim Leung, Ph.D."}, {"url": "https://timleungresearch.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "1.8K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F11571ce47b1a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fan-optimization-algorithm-for-sparse-mean-reverting-portfolio-selection-4b991bae037&user=Tim+Leung%2C+Ph.D.&userId=11571ce47b1a&source=post_page-11571ce47b1a--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F44cb6b3abd5f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fan-optimization-algorithm-for-sparse-mean-reverting-portfolio-selection-4b991bae037&newsletterV3=11571ce47b1a&newsletterV3Id=44cb6b3abd5f&user=Tim+Leung%2C+Ph.D.&userId=11571ce47b1a&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}