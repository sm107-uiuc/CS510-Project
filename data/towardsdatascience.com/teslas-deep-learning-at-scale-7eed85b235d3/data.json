{"url": "https://towardsdatascience.com/teslas-deep-learning-at-scale-7eed85b235d3", "time": 1682996100.377037, "path": "towardsdatascience.com/teslas-deep-learning-at-scale-7eed85b235d3/", "webpage": {"metadata": {"title": "Tesla\u2019s Deep Learning at Scale: Using Billions of Miles to Train Neural Networks | by Yarrow Bouchard | Towards Data Science", "h1": "Tesla\u2019s Deep Learning at Scale: Using Billions of Miles to Train Neural Networks", "description": "Tesla\u2019s advantage in training data implies an advantage in object detection, prediction, and path planning/driving policy."}, "outgoing_paragraph_urls": [{"url": "https://hcai.mit.edu/tesla-autopilot-miles-and-vehicles/", "anchor_text": "fleet", "paragraph_index": 1}, {"url": "https://youtu.be/Ucp0TTmvqOE", "anchor_text": "Autonomy Day", "paragraph_index": 5}, {"url": "https://link.medium.com/BKehpVFUtW", "anchor_text": "wrote", "paragraph_index": 6}, {"url": "https://youtu.be/fNgEG5rCav4", "anchor_text": "claims", "paragraph_index": 6}, {"url": "https://deepmind.com/blog/alphastar-mastering-real-time-strategy-game-starcraft-ii/", "anchor_text": "AlphaStar", "paragraph_index": 12}, {"url": "https://twitter.com/oriolvinyalsml/status/1094670648042012673?s=21", "anchor_text": "estimates", "paragraph_index": 12}, {"url": "https://www.theverge.com/2019/2/13/18223356/california-dmv-self-driving-car-disengagement-report-2018", "anchor_text": "deeply limited", "paragraph_index": 23}, {"url": "https://www.vox.com/2017/10/26/16548220/spacex-google-tesla-elon-musk-top-companies-tech-workers", "anchor_text": "found", "paragraph_index": 26}], "all_paragraphs": ["Training data is one of the fundamental factors that determine how well deep neural networks perform. (The other two are the network architecture and optimization algorithm.) As a general principle, more training data leads to better performance. This is why I believe Tesla, not Waymo, has the most promising autonomous vehicles program in the world.", "With a fleet of approximately 500,000 vehicles on the road equipped with what Tesla claims is full self-driving hardware, Tesla\u2019s fleet is driving about as many miles each day \u2013 around 15 million \u2013 as Waymo\u2019s fleet has driven in its entire existence. 15 million miles a day extrapolates to 5.4 billion miles a year, or 200x more than Waymo\u2019s expected total a year from now. Tesla\u2019s fleet is also growing by approximately 5,000 cars per week.", "There are three key areas where data makes a difference:", "One important computer vision task is object detection. Some objects, such as horses, only appear on the road rarely. Whenever a Tesla encounters what the neural network thinks might be a horse (or perhaps just an unrecognized object obstructing a patch of road), the cameras will take a snapshot, which will be uploaded later over wifi. It helps to have vehicles driving billions of miles per year because you can source many examples of rare objects. It stands to reason that, over time, Teslas will become better at recognizing rare objects than Waymo vehicles.", "For common objects, the bottleneck for Waymo and Tesla is most likely paying people to manually label the images. It\u2019s easy to capture more images than you can pay people to label. But for rare objects, the bottleneck for Waymo is likely collecting images in the first place, whereas for Tesla the bottlenecks are likely just labelling and developing the software to trigger snapshots at the right time. This is a much better position to be in.", "Tesla\u2019s Director of AI, Andrej Karpathy, explains in this clip (taken from his Autonomy Day presentation) how Tesla sources images to train object detection:", "Prediction is the ability to anticipate the movements and actions of cars, pedestrians, and cyclists a few seconds ahead of time. Anthony Levandowski, who for years was one of the top engineers at Waymo, recently wrote that \u201cthe reason why nobody has achieved\u201d full autonomy \u201cis because today\u2019s software is not good enough to predict the future.\u201d Levandowski claims the main category of failures for autonomous vehicles is incorrectly predicting the behaviour of nearby cars and pedestrians.", "Tesla\u2019s fleet of approximately 500,000 vehicles is a fantastic resource here. Any time a Tesla makes an incorrect prediction about a car or pedestrian, the Tesla can save a data snapshot to later upload and add to Tesla\u2019s training set. Tesla may be able to upload an abstract representation of the scene (wherein objects are visualized as colour-coded cuboid shapes and pixel-level information is thrown away) produced by its computer vision neural networks, rather than upload video. This would radically reduce the bandwidth and storage requirements of uploading this data.", "Whereas images used to train object detection require human labelling, a prediction neural network can learn correlations between past and future just from temporal sequences of events. What behaviour precedes what behaviour is inherent in any recording (video or abstracted). Andrej Karpathy explains the process in the clip below:", "Since there is no need for humans to label the data, Tesla can train its neural networks on as much useful data as it can collect. This means the size of its training dataset will correlate with its overall mileage. As with object detection, the advantage over Waymo isn\u2019t just more data for predicting common behaviours, but the ability to collect data on rare behaviours seen in rare situations in order to predict those as well.", "Path planning and driving policy refer to the actions that a car takes: staying centred in its lane at the speed limit, changing lanes, passing a slow car, making a left turn on a green light, nudging around a parked car, stopping for a jaywalker, and so on. It seems fiendishly difficult to specify a set of rules that encompass every action a car might ever need to take under any circumstance. One way around this fiendish difficulty is to get a neural network to copy what humans do. This is known as imitation learning (also sometimes called apprenticeship learning, or learning from demonstration).", "The training process is similar to how a neural network learns to predict the behaviour of other road users by drawing correlations between past and future. In imitation learning, a neural network learns to predict what a human driver would do by drawing correlations between what it sees (via the computer vision neural networks) and the actions taken by human drivers.", "Imitation learning recently met with arguably its greatest success yet: AlphaStar. DeepMind used examples from a database of millions of human-played games of StarCraft to train a neural network to play like a human. The network learned the correlations between the game state and human players\u2019 actions, and thereby learned to predict what a human would do when presented with a game state. Using only this training, AlphaStar reached a level of ability that DeepMind estimates would put it roughly in the middle of StarCraft\u2019s competitive rankings. (Afterward, AlphaStar was augmented using reinforcement learning, which is what allowed it to ascend to pro-level ability. A similar augmentation may or may not be possible with self-driving cars \u2013 that\u2019s another topic.)", "Tesla is applying imitation learning to driving tasks, such as how to handle the steep curves of a highway cloverleaf, or how to make a left turn at an intersection. It sounds like Tesla plans to extend imitation learning to more tasks over time, like how and when to change lanes on the highway. Karpathy describes how Tesla uses imitation learning in this clip:", "As with prediction, it may be sufficient to upload an abstract representation of the scene surrounding the car, rather than upload video. This would imply much lower bandwidth and storage requirements.", "Also as with prediction, no human labelling is needed once the data is uploaded. Since the neural network is predicting what a human driver would do given a world state, all it needs are the world state and the driver\u2019s actions. Imitation learning is, in essence, predicting Tesla drivers\u2019 behaviour, rather than predicting the behaviour of other road users that Teslas see around them. As with AlphaStar, all the information needed is contained within the replay of what happened.", "Based on Karpathy\u2019s comments about predicting cut-ins, Tesla can trigger a car to save a replay when it fails to correctly predict whether a vehicle ahead will cut into the Tesla\u2019s lane. Similarly, Tesla may capture replay data when a neural network involved in path planning or driving policy fails to correctly predict the Tesla driver\u2019s actions. Elon Musk has alluded to this capability (or something similar) in the past, although it\u2019s not clear if it\u2019s currently running in Tesla cars.", "The inverse would be when a Tesla is on Autopilot or in the upcoming coming urban semi-autonomous mode and the human driver takes over. This could be a rich source of examples where the system does something incorrectly, and then the human driver promptly demonstrates how to do it correctly.", "Other ways to capture interesting replays include: sudden braking or swerving, automatic emergency braking, crashes or collision warnings, and more sophisticated techniques in machine learning known as anomaly detection and novelty detection. (These same conditions could be also used to trigger replay captures for prediction or camera snapshots for object detection.) If Tesla already knows what it wants to capture, such as left turns at intersections, it can set up a trigger to capture a replay whenever the vision neural networks see a traffic light and the left turn signal is activated, or the steering wheel turns left.", "Tesla has an advantage over Waymo (and other competitors) in three key areas thanks to its fleet of roughly 500,000 vehicles:", "Concerns about collecting the right data, paying people to label it, or paying for bandwidth and storage don\u2019t obviate these advantages. These concerns are addressed by designing good triggers, using data that doesn\u2019t need human labelling, and using abstracted representations (replays) instead of raw video.", "The majority view among business analysts, journalists, and the general public appears to be that Waymo is far in the lead with autonomous driving, and Tesla isn\u2019t close. This view doesn\u2019t make sense when you look at the first principles of neural networks.", "What\u2019s more, AlphaStar is a proof of concept of large-scale imitation learning for complex tasks. If you are skeptical that Tesla\u2019s approach is the right one, or that path planning/driving policy is a tractable problem, you have to explain why imitation learning worked for StarCraft but won\u2019t work for driving.", "I predict that \u2013 barring a radical move by Waymo to increase the size of its fleet \u2013 in the next 1-3 years, the view that Waymo is far in the lead and Tesla is far behind will be widely abandoned. People have been focusing too much on demos that don\u2019t inform us about system robustness, deeply limited disengagement metrics, and Google/Waymo\u2019s access to top machine learning engineers and researchers. They have been focusing too little on training data, particularly for rare objects and behaviours where Waymo doesn\u2019t have enough data to do machine learning well, or at all.", "Simulation isn\u2019t an advantage for Waymo because Tesla (like all autonomous vehicle companies) also uses simulation. More importantly, a simulation can\u2019t generate rare objects and rare behaviours that the simulation\u2019s creators can\u2019t anticipate or don\u2019t know how to model accurately.", "Pure reinforcement learning didn\u2019t work for AlphaStar because the action space of StarCraft is too large for random exploration to hit upon good strategies. So, DeepMind had to bootstrap with imitation learning. This shows a weakness in the supposition that, as with AlphaGo Zero, pure simulated experience will solve any problem. Especially when it comes to a problem like driving where anticipating the behaviour of humans is a key component. Anticipating human behaviour requires empirical information about the real world.", "Observers of the autonomous vehicles space may be underestimating Tesla\u2019s ability to attract top machine learning talent. A survey of tech workers found that Tesla is the 2nd most sought-after company in the Bay Area, one rank behind Google. It also found Tesla is the 4th most sought-after company globally, two ranks behind Google at 2nd place. (Shopify is in 3rd place globally, and SpaceX is in 1st.) It also bears noting that fundamental advances in machine learning are often shared openly by academia, OpenAI, and corporate labs at Google, Facebook, and DeepMind. The difference between what Tesla can do and what Waymo can do may not be that big.", "The big difference between the two companies is data. As Tesla\u2019s fleet grows to 1 million vehicles, its monthly mileage will be about 1 billion miles, 1000x more than Waymo\u2019s monthly rate of about 1 million miles. What that 1000x difference implies for Tesla is superior detection for rare objects, superior prediction for rare behaviours, and superior path planning/driving policy for rare situations. The self-driving challenge is more about handling the 0.001% of miles that contain rare edge cases than the 99.999% of miles that are unremarkable. So, it stands to reason that the company that can collect a large number of training examples from this 0.001% of miles will do better than the companies that can\u2019t.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F7eed85b235d3&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fteslas-deep-learning-at-scale-7eed85b235d3&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fteslas-deep-learning-at-scale-7eed85b235d3&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fteslas-deep-learning-at-scale-7eed85b235d3&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fteslas-deep-learning-at-scale-7eed85b235d3&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----7eed85b235d3--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----7eed85b235d3--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@strangecosmos?source=post_page-----7eed85b235d3--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@strangecosmos?source=post_page-----7eed85b235d3--------------------------------", "anchor_text": "Yarrow Bouchard"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F39e3969bd5b5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fteslas-deep-learning-at-scale-7eed85b235d3&user=Yarrow+Bouchard&userId=39e3969bd5b5&source=post_page-39e3969bd5b5----7eed85b235d3---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F7eed85b235d3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fteslas-deep-learning-at-scale-7eed85b235d3&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F7eed85b235d3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fteslas-deep-learning-at-scale-7eed85b235d3&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@chuttersnap", "anchor_text": "Chuttersnap"}, {"url": "https://hcai.mit.edu/tesla-autopilot-miles-and-vehicles/", "anchor_text": "fleet"}, {"url": "https://youtu.be/Ucp0TTmvqOE", "anchor_text": "Autonomy Day"}, {"url": "https://link.medium.com/BKehpVFUtW", "anchor_text": "wrote"}, {"url": "https://youtu.be/fNgEG5rCav4", "anchor_text": "claims"}, {"url": "https://www.youtube.com/watch?v=tlThdr3O5Qo", "anchor_text": "demo"}, {"url": "https://deepmind.com/blog/alphastar-mastering-real-time-strategy-game-starcraft-ii/", "anchor_text": "AlphaStar"}, {"url": "https://twitter.com/oriolvinyalsml/status/1094670648042012673?s=21", "anchor_text": "estimates"}, {"url": "https://www.theverge.com/2019/2/13/18223356/california-dmv-self-driving-car-disengagement-report-2018", "anchor_text": "deeply limited"}, {"url": "https://www.vox.com/2017/10/26/16548220/spacex-google-tesla-elon-musk-top-companies-tech-workers", "anchor_text": "found"}, {"url": "https://medium.com/tag/self-driving-cars?source=post_page-----7eed85b235d3---------------self_driving_cars-----------------", "anchor_text": "Self Driving Cars"}, {"url": "https://medium.com/tag/technology?source=post_page-----7eed85b235d3---------------technology-----------------", "anchor_text": "Technology"}, {"url": "https://medium.com/tag/transportation?source=post_page-----7eed85b235d3---------------transportation-----------------", "anchor_text": "Transportation"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----7eed85b235d3---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----7eed85b235d3---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F7eed85b235d3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fteslas-deep-learning-at-scale-7eed85b235d3&user=Yarrow+Bouchard&userId=39e3969bd5b5&source=-----7eed85b235d3---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F7eed85b235d3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fteslas-deep-learning-at-scale-7eed85b235d3&user=Yarrow+Bouchard&userId=39e3969bd5b5&source=-----7eed85b235d3---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F7eed85b235d3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fteslas-deep-learning-at-scale-7eed85b235d3&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----7eed85b235d3--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F7eed85b235d3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fteslas-deep-learning-at-scale-7eed85b235d3&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----7eed85b235d3---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----7eed85b235d3--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----7eed85b235d3--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----7eed85b235d3--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----7eed85b235d3--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----7eed85b235d3--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----7eed85b235d3--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----7eed85b235d3--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----7eed85b235d3--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@strangecosmos?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@strangecosmos?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Yarrow Bouchard"}, {"url": "https://medium.com/@strangecosmos/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "1.2K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F39e3969bd5b5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fteslas-deep-learning-at-scale-7eed85b235d3&user=Yarrow+Bouchard&userId=39e3969bd5b5&source=post_page-39e3969bd5b5--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fcf76d0adb71d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fteslas-deep-learning-at-scale-7eed85b235d3&newsletterV3=39e3969bd5b5&newsletterV3Id=cf76d0adb71d&user=Yarrow+Bouchard&userId=39e3969bd5b5&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}