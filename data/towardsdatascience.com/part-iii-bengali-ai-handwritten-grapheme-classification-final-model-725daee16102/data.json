{"url": "https://towardsdatascience.com/part-iii-bengali-ai-handwritten-grapheme-classification-final-model-725daee16102", "time": 1683004479.277388, "path": "towardsdatascience.com/part-iii-bengali-ai-handwritten-grapheme-classification-final-model-725daee16102/", "webpage": {"metadata": {"title": "Part III: Bengali.AI Handwritten Grapheme Classification Final Model | by Michael Harder | Towards Data Science", "h1": "Part III: Bengali.AI Handwritten Grapheme Classification Final Model", "description": "Over the last month, we have been working on creating an accurate Bengali Grapheme classifier. While we have documented our journey before (prior posts linked above), here we will quickly summarize\u2026"}, "outgoing_paragraph_urls": [{"url": "https://medium.com/u/abe8cf70429?source=post_page-----725daee16102--------------------------------", "anchor_text": "David Kebudi", "paragraph_index": 0}, {"url": "https://medium.com/u/da8692cb0f64?source=post_page-----725daee16102--------------------------------", "anchor_text": "Jason Katz", "paragraph_index": 0}, {"url": "https://medium.com/u/8c20c2ac3641?source=post_page-----725daee16102--------------------------------", "anchor_text": "Michael Harder", "paragraph_index": 0}, {"url": "https://medium.com/u/29b5f12bdec0?source=post_page-----725daee16102--------------------------------", "anchor_text": "Naina Wodon", "paragraph_index": 0}, {"url": "https://towardsdatascience.com/bengali-ai-handwritten-grapheme-classification-adaa73762754", "anchor_text": "View Part I of the Series", "paragraph_index": 1}, {"url": "https://medium.com/@michael_harder/part-ii-bengali-ai-handwritten-grapheme-classification-model-enhancements-20961b0805f", "anchor_text": "View Pat II of the Series", "paragraph_index": 2}, {"url": "https://www.kaggle.com/c/bengaliai-cv19", "anchor_text": "Bengali.AI Handwritten Grapheme Classification", "paragraph_index": 4}], "all_paragraphs": ["Work conducted by: David Kebudi, Jason Katz, Michael Harder, and Naina Wodon", "View Part I of the Series", "View Pat II of the Series", "Over the last month, we have been working on creating an accurate Bengali Grapheme classifier. While we have documented our journey before (prior posts linked above), here we will quickly summarize our story and re-introduce the complexities of the task at hand.", "This blog is being produced to further document our team\u2019s efforts in submitting an entry in the Kaggle Bengali.AI Handwritten Grapheme Classification competition. We built several Convolutional Neural Networks (CNN) that correctly identify the properties of any given graphene based on the vowels didactic, consonants diacritic, and grapheme root. While this task was not easy, there are many publicly available Kaggle Kernels that illustrate other teams\u2019 efforts to build the best model (linked below).", "Bengali is the 5th most spoken language in the world, with almost ~13,000 distinct grapheme characters (see figure 1). Bengali characters have three different parts: the 11 vowels, 7 consonants, and 168 roots. This results in a total of ~13,000 possible distinct characters. For reference, the English language has only 250 distinct characters.", "As a first step in developing our solution, we needed to decide how many models we were going to train. The options were (1) training a single model that classifies a Bengali character with 13,000 possible classes, or (2) build 3 distinct models, with each model classifying the consonant diacritic, vowel diacritic, and grapheme root. The second option reduces the number of classes to (168+7+11=) 186, and so we decided to use this approach. While we could have built three different CNNs, this would be a waste of computing power and time. Instead, we built one model with three different component outputs thereby classifying the grapheme root, the vowel diacritic, and the consonant diacritic.", "The code we used to build the first model is referenced below (see figure 2). The initial model comprised of 5 convolution layers with ReLU activation and padding, which ensures that the information contained on the border pixels is preserved. The first layer is followed by batch normalization and a max-pooling layer. After the third and fifth convolutional layers, another max-pooling layer is applied. After the max-pooling layer, the layer is flattened and followed by two dense layers each with ReLU activation and dropout rates of 0.5. Dropout is a technique whereby during training a percentage of neurons, in this case, 50%, are effectively killed forcing the remaining neurons to learn equally well and dispersing the information. Dropout prevents the discriminatory power from concentrating in a few neurons and can slightly improve the overall accuracy of the model. As previously mentioned, the model classifies three different inputs: the grapheme root, the vowel diacritic, and the consonant diacritic. These different components had validation accuracies of 0.6710, 0.9185, and 0.9209 respectively. While the baseline model performed well, we wanted to improve the accuracy values through some common heuristic techniques such as data augmentation, transfer learning, and CNN structure modeling.", "Data Augmentation is a technique that is used to generate new images by modifying existing images in the dataset. The purpose of this technique is to simulate conceivable images that may appear in the test set and to generate data when there is limited training data. These images are then used with the original images to train the CNN.", "The existing images can be modified through rotation, shifting, reflection, and manipulation of color channels among other techniques. Figure 3 below illustrates several examples of shifting an image horizontally and vertically. While we had no shortage of images, we hoped that data augmentation would improve the robustness and accuracy of our model. Unfortunately, data augmentation did not improve our model\u2019s performance. This may be because the characters were handwritten and so there is already quite a bit of variation in the training set.", "In an effort to increase the strength of our model, we considered making use of Transfer Learning. By training an already trained model while keeping the lower levels frozen (see figure 4), we hope to achieve higher accuracy as well as a higher efficiency in training our model.", "There were two main approaches in our transfer learning model. (1) We trained a model, saved it and then used it as an imported model, freezing its higher layers and training it with the new data, (2) we imported a previously trained model, and ran a new model on it, by changing the input/output layers to suit our needs.", "Attempting model approach one; we only used a portion of the training data (50%) to train a simple model. After saving the simple model we froze its\u2019 layers and added layers on top for tuning on the other half of the data (see figure 5).", "This served as a transfer learning technique, that might have given fruitful results. Yet, however, we saw the accuracy and loss perform worse with this technique. One reason this may not have been helpful for us is due to the large number of target classes (186). Where the example we saw had success with this on the popular MNIST dataset only had a total of 10 target classes(see links below).", "In the second attempt, we used a previously trained model to implement transfer learning(linked below). This previously used model uses CMATERdb database (also linked below). It also uses a Conv2D \u2014 MaxPool \u2014 Conv2D \u2014 MaxPool \u2014 DropOut \u2014 FC \u2014 Softmax(Classification), custom model, with their transfer learning model including a ResNet structure. Unfortunately the kernel in Google Cloud Computing and Kaggle failed to compile the new model.", "When we learned during Transfer Learning that the GCP was not able to compile our code, we started considering possible strategies to make the computation of the model more efficient. One of them was Residual Networks (or ResNet). In Part II of this series we explain ResNet in depth. One basic thing to note, ResNet incorporates many residual learning blocks (fee figure 6). While this idea was promising, the accuracy scores were 5% to 10% worse than that of the baseline model.", "After attempting various methods, the final model we submitted to the Kaggle competition had the following construction. First, we apply a convolutional layer with ReLU activation and padding. Next, there is a batch normalization layer followed by a max pooling layer. Then two convolutional layers (both using ReLU activation and padding) followed by a max pooling layer are applied. This sequence of two convolutional layers and a max pooling layer is applied two more times. Following this repeated sequence, a flattening layer is applied before a dense layer with ReLU activation and dropout. One more dense layer with ReLU activation and dropout is applied. Finally, the network splits into three branches depending on the character type (grapheme root, vowel diacritic, or consonant diacritic) the network believes the image is. Depending on this initial classification a final dense layer with a softmax activation is applied with the number of neurons matching the number of classes in the respective character type. The code and network structure can be referenced in figure 7 and figure 8 respectively.", "The grapheme root classification task had the lowest accuracy of our final model of 0.7973 for the training set and 0.7718 for the validation set (see figure 9). As mentioned in the prior posts, this makes sense as this grapheme root has 168 classes to correctly classify.", "The final model finished with a training accuracy of 0.9496 and a validation accuracy of 0.9277 for the vowel diacritic (see figure 10). Lastly, the consonant diacritic had a training accuracy of 0.9557 and validation accuracy was 0.9373 (see figure 11).", "Our team is quite happy with our final model, given the non-trivial task at hand. If we could spend more time on this project we could further improve our CNN by properly leveraging GCP. This would allow us to train our model on more epochs, test a wider range of hyperparameters, and further explore our transfer learning road blocks.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Masters in Data Science student at Brown University"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F725daee16102&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpart-iii-bengali-ai-handwritten-grapheme-classification-final-model-725daee16102&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpart-iii-bengali-ai-handwritten-grapheme-classification-final-model-725daee16102&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpart-iii-bengali-ai-handwritten-grapheme-classification-final-model-725daee16102&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpart-iii-bengali-ai-handwritten-grapheme-classification-final-model-725daee16102&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----725daee16102--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----725daee16102--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@michael_harder?source=post_page-----725daee16102--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@michael_harder?source=post_page-----725daee16102--------------------------------", "anchor_text": "Michael Harder"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F8c20c2ac3641&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpart-iii-bengali-ai-handwritten-grapheme-classification-final-model-725daee16102&user=Michael+Harder&userId=8c20c2ac3641&source=post_page-8c20c2ac3641----725daee16102---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F725daee16102&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpart-iii-bengali-ai-handwritten-grapheme-classification-final-model-725daee16102&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F725daee16102&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpart-iii-bengali-ai-handwritten-grapheme-classification-final-model-725daee16102&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://medium.com/u/abe8cf70429?source=post_page-----725daee16102--------------------------------", "anchor_text": "David Kebudi"}, {"url": "https://medium.com/u/da8692cb0f64?source=post_page-----725daee16102--------------------------------", "anchor_text": "Jason Katz"}, {"url": "https://medium.com/u/8c20c2ac3641?source=post_page-----725daee16102--------------------------------", "anchor_text": "Michael Harder"}, {"url": "https://medium.com/u/29b5f12bdec0?source=post_page-----725daee16102--------------------------------", "anchor_text": "Naina Wodon"}, {"url": "https://towardsdatascience.com/bengali-ai-handwritten-grapheme-classification-adaa73762754", "anchor_text": "View Part I of the Series"}, {"url": "https://medium.com/@michael_harder/part-ii-bengali-ai-handwritten-grapheme-classification-model-enhancements-20961b0805f", "anchor_text": "View Pat II of the Series"}, {"url": "https://www.kaggle.com/jasonkatz33/cnn-draft", "anchor_text": "Final Model Notebook"}, {"url": "https://www.kaggle.com/c/bengaliai-cv19", "anchor_text": "Bengali.AI Handwritten Grapheme Classification"}, {"url": "https://omniglot.com/writing/bengali.htm", "anchor_text": "http://omniglot.com/writing/bengali.htm)"}, {"url": "https://arxiv.org/abs/1512.03385", "anchor_text": "https://arxiv.org/abs/1512.03385"}, {"url": "https://www.kaggle.com/deshwalmahesh/bengali-ai-complete-beginner-tutorial-95-acc/data", "anchor_text": "https://www.kaggle.com/deshwalmahesh/bengali-ai-complete-beginner-tutorial-95-acc/data"}, {"url": "https://www.kaggle.com/chekoduadarsh/tutorial-design-your-own-cnn-layer-by-layer", "anchor_text": "https://www.kaggle.com/chekoduadarsh/tutorial-design-your-own-cnn-layer-by-layer"}, {"url": "https://www.kaggle.com/chekoduadarsh/multi-output-cnn-starter-kit", "anchor_text": "https://www.kaggle.com/chekoduadarsh/multi-output-cnn-starter-kit"}, {"url": "https://www.kaggle.com/kaushal2896/bengali-graphemes-starter-eda-multi-output-cnn", "anchor_text": "https://www.kaggle.com/kaushal2896/bengali-graphemes-starter-eda-multi-output-cnn"}, {"url": "https://www.kaggle.com/pestipeti/bengali-quick-eda", "anchor_text": "https://www.kaggle.com/pestipeti/bengali-quick-eda"}, {"url": "https://www.kaggle.com/gpreda/bengali-ai-handwritten-grapheme-getting-started", "anchor_text": "https://www.kaggle.com/gpreda/bengali-ai-handwritten-grapheme-getting-started"}, {"url": "https://machinelearningmastery.com/how-to-configure-image-data-augmentation-when-training-deep-learning-neural-networks/", "anchor_text": "https://machinelearningmastery.com/how-to-configure-image-data-augmentation-when-training-deep-learning-neural-networks/"}, {"url": "https://keras.io/preprocessing/image/", "anchor_text": "https://keras.io/preprocessing/image/"}, {"url": "https://towardsdatascience.com/exploring-image-data-augmentation-with-keras-and-tensorflow-a8162d89b844", "anchor_text": "https://towardsdatascience.com/exploring-image-data-augmentation-with-keras-and-tensorflow-a8162d89b844"}, {"url": "https://keras.io/examples/mnist_transfer_cnn/", "anchor_text": "https://keras.io/examples/mnist_transfer_cnn/"}, {"url": "https://arxiv.org/html/1902.11133", "anchor_text": "https://arxiv.org/html/1902.11133"}, {"url": "https://github.com/swagato-c/bangla-hwcr-present", "anchor_text": "https://github.com/swagato-c/bangla-hwcr-present"}, {"url": "https://www.researchgate.net/figure/Natural-scenes-and-curvature-detection-a-Photograph-of-Torsten-Wiesel-and-David-Hubel_fig1_311479268", "anchor_text": "https://www.researchgate.net/figure/Natural-scenes-and-curvature-detection-a-Photograph-of-Torsten-Wiesel-and-David-Hubel_fig1_311479268"}, {"url": "https://machinelearningmastery.com/how-to-implement-major-architecture-innovations-for-convolutional-neural-networks/", "anchor_text": "https://machinelearningmastery.com/how-to-implement-major-architecture-innovations-for-convolutional-neural-networks/"}, {"url": "https://arxiv.org/abs/1512.03385", "anchor_text": "https://arxiv.org/abs/1512.03385"}, {"url": "https://arxiv.org/abs/1512.03385", "anchor_text": "https://arxiv.org/abs/1512.03385"}, {"url": "https://medium.com/tag/data-science?source=post_page-----725daee16102---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/image-classification?source=post_page-----725daee16102---------------image_classification-----------------", "anchor_text": "Image Classification"}, {"url": "https://medium.com/tag/image-recognition?source=post_page-----725daee16102---------------image_recognition-----------------", "anchor_text": "Image Recognition"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----725daee16102---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/programming?source=post_page-----725daee16102---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F725daee16102&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpart-iii-bengali-ai-handwritten-grapheme-classification-final-model-725daee16102&user=Michael+Harder&userId=8c20c2ac3641&source=-----725daee16102---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F725daee16102&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpart-iii-bengali-ai-handwritten-grapheme-classification-final-model-725daee16102&user=Michael+Harder&userId=8c20c2ac3641&source=-----725daee16102---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F725daee16102&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpart-iii-bengali-ai-handwritten-grapheme-classification-final-model-725daee16102&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----725daee16102--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F725daee16102&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpart-iii-bengali-ai-handwritten-grapheme-classification-final-model-725daee16102&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----725daee16102---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----725daee16102--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----725daee16102--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----725daee16102--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----725daee16102--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----725daee16102--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----725daee16102--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----725daee16102--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----725daee16102--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@michael_harder?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@michael_harder?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Michael Harder"}, {"url": "https://medium.com/@michael_harder/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "13 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F8c20c2ac3641&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpart-iii-bengali-ai-handwritten-grapheme-classification-final-model-725daee16102&user=Michael+Harder&userId=8c20c2ac3641&source=post_page-8c20c2ac3641--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F6544d303967e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpart-iii-bengali-ai-handwritten-grapheme-classification-final-model-725daee16102&newsletterV3=8c20c2ac3641&newsletterV3Id=6544d303967e&user=Michael+Harder&userId=8c20c2ac3641&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}