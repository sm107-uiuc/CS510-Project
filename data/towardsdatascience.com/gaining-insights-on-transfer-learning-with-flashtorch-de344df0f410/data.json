{"url": "https://towardsdatascience.com/gaining-insights-on-transfer-learning-with-flashtorch-de344df0f410", "time": 1682997066.713093, "path": "towardsdatascience.com/gaining-insights-on-transfer-learning-with-flashtorch-de344df0f410/", "webpage": {"metadata": {"title": "Gaining insights on transfer learning with FlashTorch | by Misa Ogura | Towards Data Science", "h1": "Gaining insights on transfer learning with FlashTorch", "description": "In my last post, I gave an overview of feature visualisation as a field of research and introduced FlashTorch \u2014 an open source feature visualisation toolkit for neural networks built in PyTorch. The\u2026"}, "outgoing_paragraph_urls": [{"url": "https://towardsdatascience.com/feature-visualisation-in-pytorch-saliency-maps-a3f99d08f78a", "anchor_text": "last post", "paragraph_index": 0}, {"url": "https://github.com/MisaOgura/flashtorch", "anchor_text": "GitHub repo", "paragraph_index": 1}, {"url": "https://colab.research.google.com/github/MisaOgura/flashtorch/blob/master/examples/visualise_saliency_with_backprop_colab.ipynb", "anchor_text": "this notebook hosted on Google Colab", "paragraph_index": 1}, {"url": "https://towardsdatascience.com/feature-visualisation-in-pytorch-saliency-maps-a3f99d08f78a", "anchor_text": "Previously", "paragraph_index": 2}, {"url": "https://papers.nips.cc/paper/5347-how-transferable-are-features-in-deep-neural-networks", "anchor_text": "Transfer leaning", "paragraph_index": 10}, {"url": "http://cs231n.github.io/transfer-learning/", "anchor_text": "computer vision", "paragraph_index": 11}, {"url": "https://towardsdatascience.com/deep-transfer-learning-for-natural-language-processing-text-classification-with-universal-1a2c69e5baa9", "anchor_text": "natural language processing", "paragraph_index": 11}, {"url": "https://code.google.com/archive/p/word2vec/", "anchor_text": "Word2Vec", "paragraph_index": 12}, {"url": "https://arxiv.org/abs/1608.06993", "anchor_text": "DenseNet", "paragraph_index": 13}, {"url": "http://www.robots.ox.ac.uk/~vgg/data/flowers/102/index.html", "anchor_text": "102 Category Flower Dataset", "paragraph_index": 13}, {"url": "http://github.com/MisaOgura/flashtorch", "anchor_text": "github.com/MisaOgura/flashtorch", "paragraph_index": 29}], "all_paragraphs": ["In my last post, I gave an overview of feature visualisation as a field of research and introduced FlashTorch \u2014 an open source feature visualisation toolkit for neural networks built in PyTorch.", "The package is available to install via pip. Check out the GitHub repo for the source code. You can also play around with it in this notebook hosted on Google Colab, without needing to install anything!", "Previously, I showed you how to use FlashTorch to visualise what convolutional neural networks (CNNs) \u201cperceive\u201d within inputs images. I did so by creating saliency maps from AlexNet which was pre-trained on the ImageNet classification task. I picked three classes from the task (great grey owl, peacock and toucan) and used images of these classes to inspect what AlexNet has learnt to focus the most within images in identifying these objects.", "In essence, I took a network that I knew would perform well on what I asked it to do and examined its perception: I want us to shift our focus from only looking at test accuracies and start asking what the network is actually doing.", "What is the neural net perceiving?", "Why does it behave the way it does?", "How can we explain its decisions/predictions?", "I created FlashTorch to make answering questions like these easier. And these questions are not just for when you have well-performing networks!", "In reality, it is far more common to have a network that doesn\u2019t perform as well as you want it to. But here again, we are often haunted by accuracy. We tend to jump straight on to training when we see a poor performance, without spending much time to understand why it performs so poorly.", "FlashTorch can help you do that, and I\u2019d like to demonstrate it with an example in the context of transfer learning.", "Transfer leaning in machine learning is a form of knowledge transfer\u200a\u2014\u200aa method where a model that is trained on one task is used, often as a starting point, for another task. The amount of additional training required for the new task depends on the similarity of the original & new tasks, availability of training data etc.", "Transfer learning is often employed in computer vision and natural language processing tasks, as it helps us save compute/time resources by taking advantage of the previous training.", "For example, a network trained on ImageNet (1000 classes) can be repurposed as a dog identifier without much additional training. Or, word embeddings trained on a large corpus of text (such as Word2Vec from Google) can be introduced to another deep neural network to extract vector representation of words from a new corpus.", "To test the power of transfer learning, I decided to make DenseNet, pre-trained on the ImageNet task, into a flower classifier using 102 Category Flower Dataset.", "It turns out that the model, without any further training, performs really poorly \u2014 a whopping test accuracy of 0.1%! If you\u2019ve done the maths already\u2026 I would be better of randomly guessing it myself.", "Intuitively, this perhaps makes sense. There are only a handful of flower classes included in the original ImageNet dataset, so it\u2019s not too difficult to image that asking the model to identify 102 species of flowers is a push.", "Intuition is nice, but I want to make this concrete before moving on to training.", "Let\u2019s use FlashTorch to create saliency maps and visualise what the network is (not) seeing. We\u2019re going to use this image of foxgloves as an example.", "What we can appreciate here is that the network, without additional training, is paying attention to the shape of flower cups. But there are many flowers with similar shape (think bluebells, for instance).", "For us humans, it might be obvious (even if we didn\u2019t know the name of the specie) that what makes this flower unique is the mottled patten inside flower cups. However, the network currently doesn\u2019t know where to pay attention to, apart from the general shape of the flower, because it never really needed to in the old task (ImageNet classification).", "Now that we have an insight on why the network is doing poorly, I feel ready to train it. Eventually, after trial and error, the trained model managed to achieve 98.7% test accuracy.", "Which is great! \u2026 but can we explain why?", "What is it that the network is seeing now, that it wasn\u2019t before?", "The network has learnt to pay less attention to the shape of the flower, and focus intensely to those mottled pattern :)", "Showing what the neural nets have learnt is useful. Taking it to another level and explaining the process of how neural nets learn is another powerful application of feature visualisation techniques.", "With feature visualisation techniques, not only can we obtain better understanding on what neural networks perceive about objects, but also we are better equipped to:", "If you have projects which utilise CNNs in PyTorch, FlashTorch can help you make your projects more interpretable and explainable.", "Please let me know what you think if you use it! I would really appreciate your constructive comments, feedback and suggestions \ud83d\ude4f", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Senior Machine Learning Engineer @Healx | Creator of github.com/MisaOgura/flashtorch | Published Scientist | Co-founder of @womendrivendev"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fde344df0f410&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgaining-insights-on-transfer-learning-with-flashtorch-de344df0f410&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgaining-insights-on-transfer-learning-with-flashtorch-de344df0f410&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgaining-insights-on-transfer-learning-with-flashtorch-de344df0f410&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgaining-insights-on-transfer-learning-with-flashtorch-de344df0f410&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----de344df0f410--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----de344df0f410--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@misaogura?source=post_page-----de344df0f410--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@misaogura?source=post_page-----de344df0f410--------------------------------", "anchor_text": "Misa Ogura"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F50a3a68d8d42&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgaining-insights-on-transfer-learning-with-flashtorch-de344df0f410&user=Misa+Ogura&userId=50a3a68d8d42&source=post_page-50a3a68d8d42----de344df0f410---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fde344df0f410&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgaining-insights-on-transfer-learning-with-flashtorch-de344df0f410&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fde344df0f410&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgaining-insights-on-transfer-learning-with-flashtorch-de344df0f410&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://towardsdatascience.com/feature-visualisation-in-pytorch-saliency-maps-a3f99d08f78a", "anchor_text": "Source"}, {"url": "https://towardsdatascience.com/feature-visualisation-in-pytorch-saliency-maps-a3f99d08f78a", "anchor_text": "last post"}, {"url": "https://github.com/MisaOgura/flashtorch", "anchor_text": "GitHub repo"}, {"url": "https://colab.research.google.com/github/MisaOgura/flashtorch/blob/master/examples/visualise_saliency_with_backprop_colab.ipynb", "anchor_text": "this notebook hosted on Google Colab"}, {"url": "https://towardsdatascience.com/feature-visualisation-in-pytorch-saliency-maps-a3f99d08f78a", "anchor_text": "Previously"}, {"url": "https://papers.nips.cc/paper/5347-how-transferable-are-features-in-deep-neural-networks", "anchor_text": "Transfer leaning"}, {"url": "https://towardsdatascience.com/a-comprehensive-hands-on-guide-to-transfer-learning-with-real-world-applications-in-deep-learning-212bf3b2f27a", "anchor_text": "Source"}, {"url": "http://cs231n.github.io/transfer-learning/", "anchor_text": "computer vision"}, {"url": "https://towardsdatascience.com/deep-transfer-learning-for-natural-language-processing-text-classification-with-universal-1a2c69e5baa9", "anchor_text": "natural language processing"}, {"url": "https://code.google.com/archive/p/word2vec/", "anchor_text": "Word2Vec"}, {"url": "https://arxiv.org/abs/1608.06993", "anchor_text": "DenseNet"}, {"url": "http://www.robots.ox.ac.uk/~vgg/data/flowers/102/index.html", "anchor_text": "102 Category Flower Dataset"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----de344df0f410---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/computer-vision?source=post_page-----de344df0f410---------------computer_vision-----------------", "anchor_text": "Computer Vision"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----de344df0f410---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/neural-networks?source=post_page-----de344df0f410---------------neural_networks-----------------", "anchor_text": "Neural Networks"}, {"url": "https://medium.com/tag/towards-data-science?source=post_page-----de344df0f410---------------towards_data_science-----------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fde344df0f410&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgaining-insights-on-transfer-learning-with-flashtorch-de344df0f410&user=Misa+Ogura&userId=50a3a68d8d42&source=-----de344df0f410---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fde344df0f410&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgaining-insights-on-transfer-learning-with-flashtorch-de344df0f410&user=Misa+Ogura&userId=50a3a68d8d42&source=-----de344df0f410---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fde344df0f410&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgaining-insights-on-transfer-learning-with-flashtorch-de344df0f410&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----de344df0f410--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fde344df0f410&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgaining-insights-on-transfer-learning-with-flashtorch-de344df0f410&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----de344df0f410---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----de344df0f410--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----de344df0f410--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----de344df0f410--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----de344df0f410--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----de344df0f410--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----de344df0f410--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----de344df0f410--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----de344df0f410--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@misaogura?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@misaogura?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Misa Ogura"}, {"url": "https://medium.com/@misaogura/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "725 Followers"}, {"url": "http://github.com/MisaOgura/flashtorch", "anchor_text": "github.com/MisaOgura/flashtorch"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F50a3a68d8d42&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgaining-insights-on-transfer-learning-with-flashtorch-de344df0f410&user=Misa+Ogura&userId=50a3a68d8d42&source=post_page-50a3a68d8d42--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F6151a62e7c24&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgaining-insights-on-transfer-learning-with-flashtorch-de344df0f410&newsletterV3=50a3a68d8d42&newsletterV3Id=6151a62e7c24&user=Misa+Ogura&userId=50a3a68d8d42&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}