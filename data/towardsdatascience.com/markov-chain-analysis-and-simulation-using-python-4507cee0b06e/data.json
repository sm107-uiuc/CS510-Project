{"url": "https://towardsdatascience.com/markov-chain-analysis-and-simulation-using-python-4507cee0b06e", "time": 1683001467.72642, "path": "towardsdatascience.com/markov-chain-analysis-and-simulation-using-python-4507cee0b06e/", "webpage": {"metadata": {"title": "Markov Chain Analysis and Simulation using Python | by Herman Scheepers | Towards Data Science", "h1": "Markov Chain Analysis and Simulation using Python", "description": "A Markov chain is a discrete-time stochastic process that progresses from one state to another with certain probabilities that can be represented by a graph and state transition matrix P as indicated\u2026"}, "outgoing_paragraph_urls": [], "all_paragraphs": ["A Markov chain is a discrete-time stochastic process that progresses from one state to another with certain probabilities that can be represented by a graph and state transition matrix P as indicated below:", "Such chains, if they are first-order Markov Chains, exhibit the Markov property, being that the next state is only dependent on the current state, and not how it got there:", "In this post we look at two separate concepts, the one being simulating from a Markov Chain, and the other calculating its stationary distribution. The stationary distribution is the fraction of time that the system spends in each state as the number of samples approaches infinity. If we have N states, the stationary distribution is a vector of length N, of which the values sum up to 1, since it\u2019s a probability distribution.", "We also look at two examples, a simple toy example, as well as a possible real-world scenario analysis problem.", "Note that in the first implementation below is not a simulation of the state transitions, just a calculation of the stationary distribution.", "Let\u2019s start with an iterative approach to calculating the distribution. What we are doing is raising the transition matrix to the power of the number of iterations:", "The stationary distribution is usually referred to as \u03c0.", "The calculation converges to the stationary distribution quite quickly:", "With Pi being the stationary distribution, as described earlier.", "This may also be accomplished in this case with a linear algebra solution of a set of over-determined equations:", "How we got to this calculation is shown below:", "It can be shown that a Markov chain is stationary with stationary distribution \u03c0 if \u03c0P=\u03c0 and \u03c0i=1", "Where i is a unit column vector \u2014 i.e. the sum of the probabilities must be exactly 1, which may also be expressed as", "And b is a vector of which all elements except the last is 0.", "from which as can solve for Pi, the stationary distribution, provided that the augmented matrix [A|b] rank is equal to the rank of the coefficient matrix A.", "Again, this algorithm implementation can be made generic, extended, and implemented as a class.", "One can simulate from a Markov chain by noting that the collection of moves from any given state (the corresponding row in the probability matrix) form a multinomial distribution. One can thus simulate from a Markov Chain by simulating from a multinomial distribution.", "One way to simulate from a multinomial distribution is to divide a line of length 1 into intervals proportional to the probabilities, and then picking an interval based on a uniform random number between 0 and 1.", "This is illustrated in the function simulate_multinomial below. We start with", "We then use cs, the cumulative sum of probabilities in P in order to proportionally distribute random numbers.", "From the graph, it can be seen that the distribution starts converging to the stationary distribution somewhere after around 400 simulation steps.", "The distribution is quite close to the stationary distribution that we calculated by solving the Markov chain earlier. In fact, rounded to two decimals it is identical: [0.49, 0.42, 0.09].", "As we can see below, reconstructing the state transition matrix from the transition history gives us the expected result:", "This algorithm implementation can be made generic, extended, and implemented as a class.", "It illustrates how compact and concise algorithm implementation can be achieved with Python.", "Let\u2019s say, for a particular demographic, which aligns to high-value customers, we have 4 \u2018competitors\u2019 in a subscription media market (pay-TV, for example), with a relatively stable but changing distribution of [.55, 0.2, 0.1, 0.15], with the last group at 15% not having any particular subscription service, preferring to consume free content on demand.", "The second biggest competitor (b) has just launched a new premium product and the incumbent suspects that it is eroding their market share. They would like to know how it may ultimately impact their market share if they do not intervene. They would also like to understand their own internal churn dynamics, and how it relates to their market share.", "Let\u2019s assume they know they sometimes lose customers to their competitors, including free content, particularly as their high Average Revenue Per User (ARPU) customer base evolves, and that they sometimes gain customers, but they do not understand the full picture.", "So, we imagine they commission us to do a study.", "Here we make a lot of implicit assumptions of the dynamics of the demographic in question to keep things simple. For example, we assume the transition probabilities remain constant.", "Firstly, we do a market survey to understand how consumers are moving between the different providers, and from there we can construct a probability matrix as follows:", "With a,b,c,d representing our market players.", "The market research indicated produced the following estimated probabilities that a consumer would move from one service provider to another:", "The first question we are interested in is what will happen if A keeps on losing customers to B at the estimated rate, taking into consideration all the other churn probabilities.", "Using the matrix solution we derived earlier, and coding it in Python, we can calculate the new stationary distribution.", "However, when we check the rank of the coefficient matrix and the augmented matrix, we notice that, unlike the simpler example, they do not correspond. This means that the analytical problem formulation may not have a unique solution, so we want to check it with one of the other techniques.", "It can be shown that the iterative solution (where we raise the transition matrix to the power of n) does not converge, which leaves us with the simulation option.", "From the above, we can estimate that, in the long run, the stationary distribution will be something like this: [0.19, 0.4, 0.18, 0.23], which is actually very close to the analytical solution.", "In other words, the market share of the incumbent can be expected to drop to around 20%, while the competitor will go up to around 40%.", "From this, we can also see that the analytical and simulation solutions for the more complex problem, which is plausible in the real world, indeed still corresponds.", "I hope you enjoyed this basic introduction on how discrete Markov Chains can be used to solve real-world problems and encourage you to think of questions in your own organization that can be answered in this way. You can also extend the example by calculating how valuable it would be to retain the churning customers, and thus how much it would be worth investing in retention.", "Permission is hereby granted, free of charge, to any person obtaining a copy of this software implied by the code in this article and associated documentation files (the \u201cSoftware\u201d), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:", "The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.", "THE SOFTWARE IS PROVIDED \u201cAS IS\u201d, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Passionate about information systems and the decision sciences"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F4507cee0b06e&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmarkov-chain-analysis-and-simulation-using-python-4507cee0b06e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmarkov-chain-analysis-and-simulation-using-python-4507cee0b06e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmarkov-chain-analysis-and-simulation-using-python-4507cee0b06e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmarkov-chain-analysis-and-simulation-using-python-4507cee0b06e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----4507cee0b06e--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----4507cee0b06e--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@herman.scheepers.ct?source=post_page-----4507cee0b06e--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@herman.scheepers.ct?source=post_page-----4507cee0b06e--------------------------------", "anchor_text": "Herman Scheepers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fa0b49b94d0be&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmarkov-chain-analysis-and-simulation-using-python-4507cee0b06e&user=Herman+Scheepers&userId=a0b49b94d0be&source=post_page-a0b49b94d0be----4507cee0b06e---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F4507cee0b06e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmarkov-chain-analysis-and-simulation-using-python-4507cee0b06e&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F4507cee0b06e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmarkov-chain-analysis-and-simulation-using-python-4507cee0b06e&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://en.wikipedia.org/wiki/Multinomial_distribution", "anchor_text": "https://en.wikipedia.org/wiki/Multinomial_distribution"}, {"url": "https://www.livechatinc.com/blog/churn-rate/", "anchor_text": "https://www.livechatinc.com/blog/churn-rate/"}, {"url": "https://medium.com/tag/markov-chains?source=post_page-----4507cee0b06e---------------markov_chains-----------------", "anchor_text": "Markov Chains"}, {"url": "https://medium.com/tag/simulation?source=post_page-----4507cee0b06e---------------simulation-----------------", "anchor_text": "Simulation"}, {"url": "https://medium.com/tag/data-science?source=post_page-----4507cee0b06e---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/probability-theory?source=post_page-----4507cee0b06e---------------probability_theory-----------------", "anchor_text": "Probability Theory"}, {"url": "https://medium.com/tag/churn?source=post_page-----4507cee0b06e---------------churn-----------------", "anchor_text": "Churn"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F4507cee0b06e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmarkov-chain-analysis-and-simulation-using-python-4507cee0b06e&user=Herman+Scheepers&userId=a0b49b94d0be&source=-----4507cee0b06e---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F4507cee0b06e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmarkov-chain-analysis-and-simulation-using-python-4507cee0b06e&user=Herman+Scheepers&userId=a0b49b94d0be&source=-----4507cee0b06e---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F4507cee0b06e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmarkov-chain-analysis-and-simulation-using-python-4507cee0b06e&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----4507cee0b06e--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F4507cee0b06e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmarkov-chain-analysis-and-simulation-using-python-4507cee0b06e&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----4507cee0b06e---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----4507cee0b06e--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----4507cee0b06e--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----4507cee0b06e--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----4507cee0b06e--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----4507cee0b06e--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----4507cee0b06e--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----4507cee0b06e--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----4507cee0b06e--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@herman.scheepers.ct?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@herman.scheepers.ct?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Herman Scheepers"}, {"url": "https://medium.com/@herman.scheepers.ct/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "103 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fa0b49b94d0be&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmarkov-chain-analysis-and-simulation-using-python-4507cee0b06e&user=Herman+Scheepers&userId=a0b49b94d0be&source=post_page-a0b49b94d0be--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fb398e398808&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmarkov-chain-analysis-and-simulation-using-python-4507cee0b06e&newsletterV3=a0b49b94d0be&newsletterV3Id=b398e398808&user=Herman+Scheepers&userId=a0b49b94d0be&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}