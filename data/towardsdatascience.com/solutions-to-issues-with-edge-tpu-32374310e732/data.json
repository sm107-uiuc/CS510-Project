{"url": "https://towardsdatascience.com/solutions-to-issues-with-edge-tpu-32374310e732", "time": 1683011517.223671, "path": "towardsdatascience.com/solutions-to-issues-with-edge-tpu-32374310e732/", "webpage": {"metadata": {"title": "Solutions to Issues with Edge TPU | by Renu Khandelwal | Towards Data Science", "h1": "Solutions to Issues with Edge TPU", "description": "In this article, I will be sharing some common errors that I faced when working on making the Deep Learning model work on Edge TPU USB Accelerator and the solutions that worked for me. A Coral USB\u2026"}, "outgoing_paragraph_urls": [{"url": "https://github.com/google-coral/edgetpu/issues/74", "anchor_text": "https://github.com/google-coral/edgetpu/issues/74", "paragraph_index": 20}], "all_paragraphs": ["In this article, I will be sharing some common errors that I faced when working on making the Deep Learning model work on Edge TPU USB Accelerator and the solutions that worked for me.", "A Coral USB Accelerator is an Application Specific Integrated Chip(ASIC) that adds TPU computation power to your machine. The additional TPU computing makes inferences at the Edge for a deep learning model faster and easier.", "Plug the USB Accelerator in USB 3.0 port, copy the TFLite Edge Model, along with the script for making inferences, and you are ready to go. It runs on Mac, Windows, and Linux OS.", "To create the Edge TFLite model and make inferences at the Edge using USB Accelerator, you will be using the following steps.", "After converting the model to Tflite, compiling the model for Edge TPU", "This error has no description, and you are left in the dark to solve the issue.", "I created two custom models with the same architecture but different datasets, different numbers of classes to identify and used the same steps to compile the two tflite models.", "One model compiled successfully, while the other model gave the \u201cInternal Compiler Error.\u201d", "Now I knew it was not the model or the steps to create the Edge TPU Model but something related to data.", "My solution was to reduce the image dimensions and voila it worked!!!", "Reducing the image dimensions might have helped with the range of activations used for creating the representative dataset.", "Representative datasets help with an accurate dynamic range of activations, which is used to quantize the model.", "When we quantize a model, we reduce the precision of the numbers used to represent weights, activation, and biases of the TensorFlow model from 32-bit floating points to 8 bit-int, which helps make the model light-weight.", "TFLite and EdgeTPU models are light-weight, and hence we have low latency, faster inference time, and reduced power consumption.", "The below diagram shows the difference in the size of the saved model in H5 format, TFlite model, and EdgeTPU.", "I tried one more thing to solidify my understanding; I tried to compile the same errored model with a higher image dimension(500,500) in a lower version of the Edge TPU runtime version.", "It compiled, but the entire model will run on CPU and not TPU, this was the indication that the quantized model still had some float operations.", "Now the model compiled with the latest version of Edge TPU Compiler.", "With the change in dimension, now most of the operation will run on TPU.", "After the tflite model is successfully complied with the edgetpu_compiler, and we instantiate the interpreter for inference. Error \u201cValueError: Found too many dimensions in the input array of operation \u2018reshape\u2019\u201d is encountered.", "I replied to discussion with my solution on this thread:https://github.com/google-coral/edgetpu/issues/74", "The issue was with the representative dataset that I used for post-training quantization. The dataset used for creating the representative dataset had more images than what I had provided in the images folder.", "My test_dir had 99 images, and I had set the range to 100. When I matched the dataset used for the representative dataset with the no. of images in the folder, then the issue was resolved.", "Step by step, the elimination of variables will lead you to the root cause. I use the 5W, and 1H technique where 5W stands for Who, What, Where, When, Why, and the 1 H stands for How.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "A Technology Enthusiast who constantly seeks out new challenges by exploring cutting-edge technologies to make the world a better place!"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F32374310e732&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsolutions-to-issues-with-edge-tpu-32374310e732&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsolutions-to-issues-with-edge-tpu-32374310e732&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsolutions-to-issues-with-edge-tpu-32374310e732&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsolutions-to-issues-with-edge-tpu-32374310e732&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----32374310e732--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----32374310e732--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://arshren.medium.com/?source=post_page-----32374310e732--------------------------------", "anchor_text": ""}, {"url": "https://arshren.medium.com/?source=post_page-----32374310e732--------------------------------", "anchor_text": "Renu Khandelwal"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F31b07253bc35&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsolutions-to-issues-with-edge-tpu-32374310e732&user=Renu+Khandelwal&userId=31b07253bc35&source=post_page-31b07253bc35----32374310e732---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F32374310e732&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsolutions-to-issues-with-edge-tpu-32374310e732&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F32374310e732&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsolutions-to-issues-with-edge-tpu-32374310e732&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://coral.ai/products/accelerator/", "anchor_text": "https://coral.ai/products/accelerator/"}, {"url": "https://github.com/tensorflow/tensorflow/issues/32319", "anchor_text": "https://github.com/tensorflow/tensorflow/issues/32319"}, {"url": "https://github.com/google-coral/edgetpu/issues/74", "anchor_text": "https://github.com/google-coral/edgetpu/issues/74"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----32374310e732---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/edge-computing?source=post_page-----32374310e732---------------edge_computing-----------------", "anchor_text": "Edge Computing"}, {"url": "https://medium.com/tag/tensorflow?source=post_page-----32374310e732---------------tensorflow-----------------", "anchor_text": "TensorFlow"}, {"url": "https://medium.com/tag/tensorflow-lite?source=post_page-----32374310e732---------------tensorflow_lite-----------------", "anchor_text": "Tensorflow Lite"}, {"url": "https://medium.com/tag/edge-tpu?source=post_page-----32374310e732---------------edge_tpu-----------------", "anchor_text": "Edge Tpu"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F32374310e732&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsolutions-to-issues-with-edge-tpu-32374310e732&user=Renu+Khandelwal&userId=31b07253bc35&source=-----32374310e732---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F32374310e732&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsolutions-to-issues-with-edge-tpu-32374310e732&user=Renu+Khandelwal&userId=31b07253bc35&source=-----32374310e732---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F32374310e732&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsolutions-to-issues-with-edge-tpu-32374310e732&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----32374310e732--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F32374310e732&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsolutions-to-issues-with-edge-tpu-32374310e732&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----32374310e732---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----32374310e732--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----32374310e732--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----32374310e732--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----32374310e732--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----32374310e732--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----32374310e732--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----32374310e732--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----32374310e732--------------------------------", "anchor_text": ""}, {"url": "https://arshren.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://arshren.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Renu Khandelwal"}, {"url": "https://arshren.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "5.9K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F31b07253bc35&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsolutions-to-issues-with-edge-tpu-32374310e732&user=Renu+Khandelwal&userId=31b07253bc35&source=post_page-31b07253bc35--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fb1cb44d62203&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsolutions-to-issues-with-edge-tpu-32374310e732&newsletterV3=31b07253bc35&newsletterV3Id=b1cb44d62203&user=Renu+Khandelwal&userId=31b07253bc35&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}