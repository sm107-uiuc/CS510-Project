{"url": "https://towardsdatascience.com/arima-vs-lstm-forecasting-electricity-consumption-3215b086da77", "time": 1683017643.440586, "path": "towardsdatascience.com/arima-vs-lstm-forecasting-electricity-consumption-3215b086da77/", "webpage": {"metadata": {"title": "ARIMA vs. LSTM: Forecasting Electricity Consumption | by Michael Grogan | Towards Data Science", "h1": "ARIMA vs. LSTM: Forecasting Electricity Consumption", "description": "In this example, the ARIMA and LSTM models are used to predict electricity consumption patterns for the Dublin City Council Civic Offices, Ireland. We can see that for each date, the relevant\u2026"}, "outgoing_paragraph_urls": [{"url": "https://data.gov.ie/dataset/energy-consumption-gas-and-electricity-civic-offices-2009-2012/resource/6091c604-8c94-4b44-ac52-c1694e83d746", "anchor_text": "data.gov.ie", "paragraph_index": 1}, {"url": "https://towardsdatascience.com/automatic-vs-manual-arima-configuration-ceb06fe074da", "anchor_text": "Here are some more detailed results in a follow-up article.", "paragraph_index": 27}, {"url": "https://github.com/MGCodesandStats/energy-weather-modelling", "anchor_text": "here", "paragraph_index": 48}, {"url": "http://michael-grogan.com", "anchor_text": "michael-grogan.com", "paragraph_index": 51}], "all_paragraphs": ["In this example, the ARIMA and LSTM models are used to predict electricity consumption patterns for the Dublin City Council Civic Offices, Ireland.", "The data in question is sourced from data.gov.ie.", "Specifically, the data is provided in terms of kilowatt consumption every 15 minutes.", "Here is the original set of data loaded into Python.", "We can see that for each date, the relevant kilowatt consumption is provided across 15-minute intervals.", "However, in this instance we wish to forecast the total daily consumption and there is expected to be too much volatility if the time series is formed on a 15-minute basis \u2014 so as to make any forecasts quite superficial.", "In this regard, the data is sorted on a daily basis:", "The relevant columns are renamed accordingly, and the kilowatt consumption per day is aggregated.", "A numpy array containing the aggregated daily data is formed:", "Here is a plot of the data:", "An ARIMA model (or an Autoregressive Integrated Moving Average model) is used to take the components of the time series in question (i.e. p, d, and q parameters), and make new forecasts accordingly.", "While pmdarima will be used to select these coordinates automatically, it is important to define the seasonal trend.", "The first 80% of the time series (554 observations) are used as training data. Here is a plot of the autocorrelation function as generated on this training set.", "We can see that the highest positive correlation (after the negative correlations) is identified at lag 7. This indicates that there is a strong correlation with the kilowatt reading 7 days after the original.", "In this regard, the seasonal component for the ARIMA model is identified as m=7.", "Before running the ARIMA model, let\u2019s take a quick look at the 7-day moving average for this time series, in order to better visualise the overall trend.", "We can see that the overall kilowatt consumption seems to be decreasing in the first half of the series, while it increases across the second half.", "Notably, we can see that there is quite a sharp drop halfway through the series, which clearly marks an anomaly in the series.", "This might be due to a power cut or some other event that resulted in a sudden drop in electricity usage. When running the forecasts, we must bear in mind that this \u201ctime series shock\u201d would not necessarily be accounted for by the past data.", "Using the training data, a stepwise search is now conducted using pmdarima to minimise the AIC value, i.e. select the ARIMA model that shows the lowest AIC.", "Now, a prediction can be made for the next 126 days, with the predictions compared to the actual results obtained across the test set.", "The predictions are reshaped in order to ensure the same format across the test set and the predictions:", "The root mean squared error is calculated:", "The mean kilowatt consumption across the test set came in at 3,862. Given that the RMSE error accounts for 33% of the size of the mean, this indicates that the ARIMA model could be doing a better job at forecasting electricity consumption.", "To get a more intuitive look at what is going on, let\u2019s plot the predictions and test data.", "We can see that the ARIMA model has picked up the seasonal trend of the series quite well. That said, the peak consumption predictions in the first half of the graph appear to be quite a bit higher than the actual.", "Moreover, we see that the model fails to capture the drop in kilowatt consumption between roughly days 70\u201380 across the test set. This anomaly may be contributing to the sizeable error we are seeing for the RMSE value, as RMSE is designed to penalise errors on outliers more heavily.", "Note that manually configuring the ARIMA model, i.e. implementing manual selection of the p, d, q coordinates showed an improvement in the forecast accuracy, with an RMSE of 965. Here are some more detailed results in a follow-up article.", "An LSTM model is now implemented on this set of data to examine if the forecast accuracy improves when using this approach.", "The data was manipulated in the same way as above initially, i.e. a daily time series was formed by aggregating the kilowatt consumption every 15 minutes in the space of one day.", "The data is split into training and test data:", "The data is normalized in order to allow the LSTM model to interpret the data properly.", "However, there is a big caveat when it comes to implementing this procedure. The training and test sets must be split separately (as above) before conducting the scaling procedure on each set separately.", "A common mistake when implementing an LSTM model is to simply scale the whole dataset. This is erroneous as the scaler will use the values from the test set as a baseline for the scale, resulting in data leakage back to the training set.", "For instance, let us suppose that a hypothetical training set has a scale from 1\u20131000, and the hypothetical test set has a scale from 1\u20131200. MaxMinScaler will reduce the scale to a number between 0\u20131. Should the data be scaled across both the training and test set concurrently, then MaxMinScaler will use the 1\u20131200 scale as the baseline for the training set as well. This means that the new scale across the training set has been compromised by the test set, resulting in unreliable forecasts.", "Thus, the data in our example is scaled as follows:", "Now that the data is scaled, a lookback period needs to be implemented, i.e. how many prior periods we wish for the LSTM model to take into account when forecasting at time t.", "After trial and error, a lookback period of 5 showed the lowest RMSE when forecasting.", "The input is then reshaped to be of the format samples, time steps, features.", "The LSTM network is defined and trained:", "Here is a plot of the training and validation loss:", "The predictions are generated and then converted back to the original scale (after having been previously converted using MinMaxScaler):", "Now, the prediction accuracy can be computed by comparing the predictions to the actual test data.", "Firstly, here is a plot of the predicted vs actual data.", "The mean value across the test set is 3,909. The size of the RMSE accounts for 10% of the mean, which means the model shows superior performance to ARIMA in predicting electricity consumption trends.", "From the graph, it is also notable that the LSTM model was adept at forecasting the period where there was a lower consumption level than normal. This would be somewhat expected given that the LSTM is a one-step prediction model, i.e. kilowatt consumption at time t cannot be predicted without having the values for the previous five weeks \u2014 it is not a long-range forecast.", "That said, the LSTM model has been more effective at accounting for the volatility in the series.", "In this example, we have seen:", "Many thanks for your time, and the relevant GitHub repository with the dataset and code examples can be found here.", "Disclaimer: This article is written on an \u201cas is\u201d basis and without warranty. It was written with the intention of providing an overview of data science concepts, and should not be interpreted as professional advice. The findings and interpretations in this article are those of the author and are not endorsed by or affiliated with any third parties mentioned in this article.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Science Consultant with expertise in economics, time series analysis, and Bayesian methods | michael-grogan.com"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F3215b086da77&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Farima-vs-lstm-forecasting-electricity-consumption-3215b086da77&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Farima-vs-lstm-forecasting-electricity-consumption-3215b086da77&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Farima-vs-lstm-forecasting-electricity-consumption-3215b086da77&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Farima-vs-lstm-forecasting-electricity-consumption-3215b086da77&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----3215b086da77--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----3215b086da77--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://mgcodesandstats.medium.com/?source=post_page-----3215b086da77--------------------------------", "anchor_text": ""}, {"url": "https://mgcodesandstats.medium.com/?source=post_page-----3215b086da77--------------------------------", "anchor_text": "Michael Grogan"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Feec017a8b178&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Farima-vs-lstm-forecasting-electricity-consumption-3215b086da77&user=Michael+Grogan&userId=eec017a8b178&source=post_page-eec017a8b178----3215b086da77---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F3215b086da77&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Farima-vs-lstm-forecasting-electricity-consumption-3215b086da77&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F3215b086da77&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Farima-vs-lstm-forecasting-electricity-consumption-3215b086da77&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://pixabay.com/users/comfreak-51581/", "anchor_text": "Comfreak"}, {"url": "https://pixabay.com/photos/light-bulb-incandescent-smoke-crack-503881/", "anchor_text": "Pixabay"}, {"url": "https://data.gov.ie/dataset/energy-consumption-gas-and-electricity-civic-offices-2009-2012/resource/6091c604-8c94-4b44-ac52-c1694e83d746", "anchor_text": "data.gov.ie"}, {"url": "https://towardsdatascience.com/automatic-vs-manual-arima-configuration-ceb06fe074da", "anchor_text": "Here are some more detailed results in a follow-up article."}, {"url": "https://github.com/MGCodesandStats/energy-weather-modelling", "anchor_text": "here"}, {"url": "https://data.gov.ie/dataset/energy-consumption-gas-and-electricity-civic-offices-2009-2012/resource/6091c604-8c94-4b44-ac52-c1694e83d746", "anchor_text": "data.gov.ie: Energy Consumption (Gas and Electricity) Civic Offices 2009\u20132012"}, {"url": "https://machinelearningmastery.com/time-series-forecasting-performance-measures-with-python/", "anchor_text": "Machine Learning Mastery: Time Series Forecasting Performance Measures With Python"}, {"url": "https://medium.com/tag/data-science?source=post_page-----3215b086da77---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----3215b086da77---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/time-series-forecasting?source=post_page-----3215b086da77---------------time_series_forecasting-----------------", "anchor_text": "Time Series Forecasting"}, {"url": "https://medium.com/tag/lstm?source=post_page-----3215b086da77---------------lstm-----------------", "anchor_text": "Lstm"}, {"url": "https://medium.com/tag/tensorflow?source=post_page-----3215b086da77---------------tensorflow-----------------", "anchor_text": "TensorFlow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F3215b086da77&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Farima-vs-lstm-forecasting-electricity-consumption-3215b086da77&user=Michael+Grogan&userId=eec017a8b178&source=-----3215b086da77---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F3215b086da77&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Farima-vs-lstm-forecasting-electricity-consumption-3215b086da77&user=Michael+Grogan&userId=eec017a8b178&source=-----3215b086da77---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F3215b086da77&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Farima-vs-lstm-forecasting-electricity-consumption-3215b086da77&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----3215b086da77--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F3215b086da77&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Farima-vs-lstm-forecasting-electricity-consumption-3215b086da77&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----3215b086da77---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----3215b086da77--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----3215b086da77--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----3215b086da77--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----3215b086da77--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----3215b086da77--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----3215b086da77--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----3215b086da77--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----3215b086da77--------------------------------", "anchor_text": ""}, {"url": "https://mgcodesandstats.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://mgcodesandstats.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Michael Grogan"}, {"url": "https://mgcodesandstats.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "1.5K Followers"}, {"url": "http://michael-grogan.com", "anchor_text": "michael-grogan.com"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Feec017a8b178&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Farima-vs-lstm-forecasting-electricity-consumption-3215b086da77&user=Michael+Grogan&userId=eec017a8b178&source=post_page-eec017a8b178--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F3c6e2607915&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Farima-vs-lstm-forecasting-electricity-consumption-3215b086da77&newsletterV3=eec017a8b178&newsletterV3Id=3c6e2607915&user=Michael+Grogan&userId=eec017a8b178&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}