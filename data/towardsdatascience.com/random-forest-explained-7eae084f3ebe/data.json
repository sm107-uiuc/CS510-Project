{"url": "https://towardsdatascience.com/random-forest-explained-7eae084f3ebe", "time": 1683013956.874806, "path": "towardsdatascience.com/random-forest-explained-7eae084f3ebe/", "webpage": {"metadata": {"title": "Random Forest Explained. Random Forest explained simply: An easy\u2026 | by James Thorn | Towards Data Science", "h1": "Random Forest Explained", "description": "In this post, we will explain what a Random Forest model is, see its strengths, how it is built, and what it can be used for. We will go through the theory and intuition of Random Forest, seeing the\u2026"}, "outgoing_paragraph_urls": [{"url": "https://towardsdatascience.com/what-is-boosting-in-machine-learning-2244aa196682", "anchor_text": "Boosting models", "paragraph_index": 34}, {"url": "https://howtolearnmachinelearning.com/books/machine-learning-books/", "anchor_text": "How to Learn Machine Learning", "paragraph_index": 37}, {"url": "https://aigents.co/", "anchor_text": "AIgents.co \u2014 A career community for Data Scientists & Machine Learning Engineers", "paragraph_index": 37}], "all_paragraphs": ["In this post, we will explain what a Random Forest model is, see its strengths, how it is built, and what it can be used for.", "We will go through the theory and intuition of Random Forest, seeing the minimum amount of maths necessary to understand how everything works, without diving into the most complex details.", "Lastly, before we start, here you have some additional resources to skyrocket your Machine Learning career:", "In the Machine Learning world, Random Forest models are a kind of non parametric models that can be used both for regression and classification. They are one of the most popular ensemble methods, belonging to the specific category of Bagging methods.", "Ensemble methods involve using many learners to enhance the performance of any single one of them individually. These methods can be described as techniques that use a group of weak learners (those who on average achieve only slightly better results than a random model) together, in order to create a stronger, aggregated one.", "In our case, Random Forests are an ensemble of many individual Decision Trees. If you are not familiar with Decision Trees, you can learn all about them here:", "One of the main drawbacks of Decision Trees is that they are very prone to over-fitting: they do well on training data, but are not so flexible for making predictions on unseen samples. While there are workarounds for this, like pruning the trees, this reduces their predictive power. Generally they are models with medium bias and high variance, but they are simple and easy to interpret.", "If you are not very confident with the difference between bias and variance, check out the following post:", "Random Forest models combine the simplicity of Decision Trees with the flexibility and power of an ensemble model. In a forest of trees, we forget about the high variance of an specific tree, and are less concerned about each individual element, so we can grow nicer, larger trees that have more predictive power than a pruned one.", "Although Random Forest models don\u2019t offer as much interpret ability as a single tree, their performance is a lot better, and we don\u2019t have to worry so much about perfectly tuning the parameters of the forest as we do with individual trees.", "Okay, I get it, a Random Forest is a collection of individual trees. But why the name Random? Where is the Randomness? Lets find out by learning how a Random Forest model is built.", "Building a random Forest has 3 main phases. We will break down each of them and clarify each of the concepts and steps. Lets go!", "When we build an individual decision tree, we use a training data set and all of the observations. This means that if we are not careful, the tree can adjust very well to this training data, and generalise badly to new, unseen observations. To solve this issue, we stop the tree from growing very large, usually at the cost of reducing its performance.", "To build a Random Forest we have to train N decision trees. Do we train the trees using the same data all the time? Do we use the whole data set? Nope.", "This is where the first random feature comes in. To train each individual tree, we pick a random sample of the entire Data set, like shown in the following figure.", "From looking at this figure, various things can be deduced. First of all, the size of the data used to train each individual tree does not have to be the size of the whole data set. Also, a data point can be present more than once in the data used to train a single tree (like in tree n\u00ba two).", "This is called Sampling with Replacement or Bootstrapping: each data point is picked randomly from the whole data set, and a data point can be picked more than once.", "By using different samples of data to train each individual tree we reduce one of the main problems that they have: they are very fond of their training data. If we train a forest with a lot of trees and each of them has been trained with different data, we solve this problem. They are all very fond of their training data, but the forest is not fond of any specific data point. This allows us to grow larger individual trees, as we do not care so much anymore for an individual tree overfitting.", "If we use a very small portion of the whole data set to train each individual tree, we increase the randomness of the forest (reducing over-fitting) but usually at the cost of a lower performance.", "In practice, by default most Random Forest implementations (like the one from Scikit-Learn) pick the sample of the training data used for each tree to be the same size as the original data set (however it is not the same data set, remember that we are picking random samples).", "This generally provides a good bias-variance compromise.", "If you remember well, for building an individual decision tree, at each node we evaluated a certain metric (like the Gini index, or Information Gain) and picked the feature or variable of the data to go in the node that minimised/maximised this metric.", "This worked decently well when training only one tree, but now we want a whole forest of them! How do we do it? Ensemble models, like Random Forest work best if the individual models (individual trees in our case) are uncorrelated. In Random Forest this is achieved by randomly selecting certain features to evaluate at each node.", "As you can see from the previous image, at each node we evaluate only a subset of all the initial features. For the root node we take into account E, A and F (and F wins). In Node 1 we consider C, G and D (and G wins). Lastly, in Node 2 we consider only A, B, and G (and A wins). We would carry on doing this until we built the whole tree.", "By doing this, we avoid including features that have a very high predictive power in every tree, while creating many un-correlated trees. This is the second sweep of randomness. We do not only use random data, but also random features when building each tree. The greater the tree diversity, the better: we reduce the variance, and get a better performing model.", "Awesome, we have learned how to build a single decision tree. Now, we would repeat this for the N trees, randomly selecting on each node of each of the trees which variables enter the contest for being picked as the feature to split on.", "In conclusion, the whole process goes as follows:", "Once we have built our forest, we are ready to use it to make awesome predictions. Lets see how!", "Making predictions with a Random Forest is very easy. We just have to take each of our individual trees, pass the observation for which we want to make a prediction through them, get a prediction from every tree (summing up to N predictions) and then obtain an overall, aggregated prediction.", "Bootstrapping the data and then using an aggregate to make a prediction is called Bagging, and how this prediction is made depends on the kind of problem we are facing.", "For regression problems, the aggregate decision is the average of the decisions of every single decision tree. For classification problems, the final prediction is the most frequent prediction done by the forest.", "The previous image illustrates this very simple procedure. For the classification problem we want to predict if a certain patient is sick or healthy. For this we pass his medical record and other information through each tree of the random forest, and obtain N predictions (400 in our case). In our example 355 of the trees say that the patient is healthy and 45 say that the patient is sick, therefore the forest decides that the patient is healthy.", "For the regression problem we want to predict the price of a certain house. We pass the characteristics of this new house through our N trees, getting a numerical prediction from each of them. Then, we calculate the average of these predictions and get the final value of 322.750$.", "Simple right? We make a prediction with every individual tree and then aggregate these predictions using the mean (average) or the mode (most frequent value).", "In this post we have seen what a Random Forest is, how it overcomes the main issues of Decision Trees, how they are trained, and used to make predictions. They are very flexible and powerful Machine Learning models that are highly used in commercial and industrial applications, along with Boosting models and Artificial Neural Networks.", "On future posts we will explore tips and tricks of Random Forests and how they can be used for feature selection. Also, if you want to see precisely how they are built, check out the following video by StatQuest, its great:", "That is it! As always, I hope you enjoyed the post.", "For further resources on Machine Learning and Data Science check out the following repository: How to Learn Machine Learning! For career resources (jobs, events, skill tests) go to AIgents.co \u2014 A career community for Data Scientists & Machine Learning Engineers.", "Thank you very much for reading, and have a great day!", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F7eae084f3ebe&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frandom-forest-explained-7eae084f3ebe&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frandom-forest-explained-7eae084f3ebe&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frandom-forest-explained-7eae084f3ebe&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frandom-forest-explained-7eae084f3ebe&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----7eae084f3ebe--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----7eae084f3ebe--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://james-thorn.medium.com/?source=post_page-----7eae084f3ebe--------------------------------", "anchor_text": ""}, {"url": "https://james-thorn.medium.com/?source=post_page-----7eae084f3ebe--------------------------------", "anchor_text": "James Thorn"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F1fd70d25ff14&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frandom-forest-explained-7eae084f3ebe&user=James+Thorn&userId=1fd70d25ff14&source=post_page-1fd70d25ff14----7eae084f3ebe---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F7eae084f3ebe&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frandom-forest-explained-7eae084f3ebe&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F7eae084f3ebe&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frandom-forest-explained-7eae084f3ebe&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/photos/sp-p7uuT0tw", "anchor_text": "Unsplash"}, {"url": "https://howtolearnmachinelearning.com/books/machine-learning-books/", "anchor_text": "How to Learn Machine Learning"}, {"url": "https://aigents.co/", "anchor_text": "AIgents.co \u2014 A career community for Data Scientists & Machine Learning Engineers"}, {"url": "https://z-ai.medium.com/subscribe", "anchor_text": "Subscribe to my exclusive list!Subscribe to my exclusive list! And get all the fresh articles you love <3! By signing up, you will create a Medium\u2026z-ai.medium.com"}, {"url": "https://towardsdatascience.com/decision-trees-explained-3ec41632ceb6", "anchor_text": "Decision Trees ExplainedLearn everything about Decision Trees for Machine Learningtowardsdatascience.com"}, {"url": "https://towardsdatascience.com/quick-bias-variance-trade-off-d4895b126b08", "anchor_text": "Quick Bias/Variance Trade-OffThe Bias/Variance trade-off easily explainedtowardsdatascience.com"}, {"url": "https://www.flaticon.com/free-icon/tree_616707", "anchor_text": "Flaticon"}, {"url": "https://www.flaticon.com/free-icon/tree_616707", "anchor_text": "Flaticon"}, {"url": "https://www.flaticon.com/free-icon/money_2916115?term=Money&page=1&position=4", "anchor_text": "Flaticon"}, {"url": "https://z-ai.medium.com/subscribe", "anchor_text": "Subscribe to my exclusive list!Subscribe to my exclusive list! And get all the fresh articles you love <3! By signing up, you will create a Medium\u2026z-ai.medium.com"}, {"url": "https://towardsdatascience.com/what-is-boosting-in-machine-learning-2244aa196682", "anchor_text": "Boosting models"}, {"url": "https://howtolearnmachinelearning.com/books/machine-learning-books/", "anchor_text": "How to Learn Machine Learning"}, {"url": "https://aigents.co/", "anchor_text": "AIgents.co \u2014 A career community for Data Scientists & Machine Learning Engineers"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----7eae084f3ebe---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----7eae084f3ebe---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/data-science?source=post_page-----7eae084f3ebe---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/startup?source=post_page-----7eae084f3ebe---------------startup-----------------", "anchor_text": "Startup"}, {"url": "https://medium.com/tag/technology?source=post_page-----7eae084f3ebe---------------technology-----------------", "anchor_text": "Technology"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F7eae084f3ebe&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frandom-forest-explained-7eae084f3ebe&user=James+Thorn&userId=1fd70d25ff14&source=-----7eae084f3ebe---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F7eae084f3ebe&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frandom-forest-explained-7eae084f3ebe&user=James+Thorn&userId=1fd70d25ff14&source=-----7eae084f3ebe---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F7eae084f3ebe&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frandom-forest-explained-7eae084f3ebe&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----7eae084f3ebe--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F7eae084f3ebe&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frandom-forest-explained-7eae084f3ebe&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----7eae084f3ebe---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----7eae084f3ebe--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----7eae084f3ebe--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----7eae084f3ebe--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----7eae084f3ebe--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----7eae084f3ebe--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----7eae084f3ebe--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----7eae084f3ebe--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----7eae084f3ebe--------------------------------", "anchor_text": ""}, {"url": "https://james-thorn.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://james-thorn.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "James Thorn"}, {"url": "https://james-thorn.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "3K Followers"}, {"url": "https://howtolearnmachinelearning.com/", "anchor_text": "https://howtolearnmachinelearning.com/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F1fd70d25ff14&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frandom-forest-explained-7eae084f3ebe&user=James+Thorn&userId=1fd70d25ff14&source=post_page-1fd70d25ff14--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F5ad84c2cef18&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frandom-forest-explained-7eae084f3ebe&newsletterV3=1fd70d25ff14&newsletterV3Id=5ad84c2cef18&user=James+Thorn&userId=1fd70d25ff14&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}