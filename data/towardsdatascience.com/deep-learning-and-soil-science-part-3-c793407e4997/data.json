{"url": "https://towardsdatascience.com/deep-learning-and-soil-science-part-3-c793407e4997", "time": 1682994495.417032, "path": "towardsdatascience.com/deep-learning-and-soil-science-part-3-c793407e4997/", "webpage": {"metadata": {"title": "Deep learning and Soil Science \u2014 Part 3 | by Jos\u00e9 Padarian | Towards Data Science", "h1": "Deep learning and Soil Science \u2014 Part 3", "description": "Using transfer learning to \u201cLocalise\u201d a continental soil spectral model to a national context."}, "outgoing_paragraph_urls": [{"url": "https://towardsdatascience.com/deep-learning-and-soil-science-part-1-8c0669b18097", "anchor_text": "first part of the series", "paragraph_index": 1}, {"url": "https://towardsdatascience.com/deep-learning-and-soil-science-part-1-8c0669b18097", "anchor_text": "first part of this Series", "paragraph_index": 4}], "all_paragraphs": ["This is the second article of a Series that I am devoting to the use of Deep Learning in Soil Science. This is an ongoing series and so far it also includes:", "In the first part of the series I introduced a multi-task convolutional neural network (CNN) to simultaneously predict multiple soil properties from spectral data. We observed a significant decrease in the prediction error compared with conventional methods thanks to a) the superior capacity of CNNs to process complex signals, and b) the synergistic effect of multi-task learning.", "In this article I will talk about transfer learning in the context of soil spectroscopy. This is an extension of the previous work, so I will skip concepts like soil spectral data, spectrograms and multi-task learning.", "It is believed that models that were generated within a specific area or soil domain will perform best in that area and perform poorly when applied to other contrasting soil types. In soil science, the high spatial dependency of soil properties means that a model generated for a specific region should be carefully used beyond that spatial domain since they may lose their validity. Conversely, the application of a global, continental or national spectral libraries to local areas or regions can also be problematic. National models often performed poorly when applied in a local area within that country. The same is observed when a global model is applied at country level. This is understandable, as a global or national model usually captures general trends with a greater generalisation, spanning different soil types. On the other hand, a local area may have short-scale variation which cannot be captured by the global models.", "This article uses the term \u201cglobal\u201d model referring to a model calibrated based on a large-scale spectral library (the same European library used in the first part of this Series), while \u201clocal\u201d refers to an area within the \u201cglobal\u201d dataset (country). Both, global and local models are valuable and, ideally, we would like to transfer some of the rules learned by the more general global models to a local domain. In machine learning, this process of sharing intra-domain information is known as transfer learning.", "This work aims to evaluate the effectiveness of transfer learning to \u201clocalise\u201d a general soil spectral calibration model to a national context, simulating a situation where the global dataset is not available for the local user. As far as we know, this is the first time transfer learning has been applied to soil spectroscopy modelling.", "\u201cA comic strip in my possession concerns industrial espionage between firms which manufacture expert systems. One firm has gained a lead in the market by developing super expert systems and another firm employs a spy to find out how they do it. The spy breaks in to the other firm only to discover that they are capturing human experts, removing their brains, slicing them very thin, and inserting the slices into their top-selling model.\u201d", "\u2014 Harry Collins. Humans, machines, and the structure of knowledge.", "As humans, we are capable of applying previously acquired knowledge to tasks that have similar characteristics. Transfer learning, also known as induction learning, is a branch of ML which tries to emulate this process. In our particular case, given a global data domain G and a local data domain L, with L\u2282G, a traditional ML approach considers both domains as different, generating two independent models, f(G) and f(L). In contrast, acknowledging that G and L are somehow related, transfer learning is capable of generating a model f(L\u2019) using part of the generalisations learned by f(G) in conjunction with data domain L\u2019, with L\u2019\u2286L. It is worth noting that, in practice, it is possible that |L\u2019|<<|L|, which gives a considerable advantage to transfer learning, especially when data collection and analysis is limiting.", "The logic behind this procedure is that in the first training (on the global dataset) the algorithm generates an internal representation of the nature of spectral data. To successfully learn this representation the model needs a big volume of observations, which is exactly what the global dataset provides. In the subsequent training (on the local dataset) the model already \u201cknows\u201d how spectral data behaves, requiring just enough observations to fine-tune the model and adjust it to local conditions.", "We used multi-task CNNs to simultaneously predict organic carbon content, cation exchange capacity, clay content and pH. We compared 3 types of models:", "The whole transfer process can be summarised with the following figure:", "In 18 of the 21 countries transfer learning shows a significant improvement for at least one soil property, compared with the Local and Global models. Four countries showed a significant improvement in all four properties. Even in cases where no significant changes were found, there is a clear trend that the transfer model reduced the mean RMSE. In 14 countries the mean RMSE was reduced for all four properties, and in 76 of the total 84 (90.5%) combinations of countries and properties. The Transfer model yielded a mean RMSE decrease, compared with the second best performing model, of 10.5, 11.8, 12.0 and 11.5% for OC, CEC, Clay and pH, respectively.", "In few cases, the Transfer model performed worse than the Global or Local models. The reason is that the error of the global model is much larger than the local one, producing negative transfer. In practice, when developing a local model, it is always useful to determine if the source model (global) is beneficial or not, or if a more aggressive transfer is needed, by tracking the performance of the models during training. Ideally, when a positive transfer occurs, the error of the transfer model should show lower initial and final magnitudes as shown bellow.", "Transfer learning proved to be effective to localise a general soil spectral calibration model generated with a continental dataset. For most of the countries considered in this study, there was an improvement compared with using either a Global (the general model) or Local model (generated only with the data from the respective country).", "Our findings also highlight the importance of global databases. They are crucial for understanding processes at the planetary scale but also important to complement our knowledge at a local scale. Collaboration can be beneficial for everyone, even for data-rich countries or organisations.", "The transfer learning model does not require the global dataset to be available for local training. Once a global model has been calibrated, only the model that needs to be re-trained can be shared. This is a potential solution for the issue of data privacy. Is important to keep in mind that the proposed method is also applicable if the global dataset is available to a local user.", "More details about this work can be found in the corresponding paper.", "Padarian, J., Minasny, B. and McBratney, A.B., 2019. Transfer learning to localise a continental soil vis-NIR calibration model. Geoderma (in press).", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Research Fellow at The University of Sydney. Trying to use Machine Learning for everything related to Geo Sciences\u2026 It mostly works :)"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fc793407e4997&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-and-soil-science-part-3-c793407e4997&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-and-soil-science-part-3-c793407e4997&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-and-soil-science-part-3-c793407e4997&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-and-soil-science-part-3-c793407e4997&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----c793407e4997--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----c793407e4997--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@spadarian?source=post_page-----c793407e4997--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@spadarian?source=post_page-----c793407e4997--------------------------------", "anchor_text": "Jos\u00e9 Padarian"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F3e87fae89f4a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-and-soil-science-part-3-c793407e4997&user=Jos%C3%A9+Padarian&userId=3e87fae89f4a&source=post_page-3e87fae89f4a----c793407e4997---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc793407e4997&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-and-soil-science-part-3-c793407e4997&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc793407e4997&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-and-soil-science-part-3-c793407e4997&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://medium.com/@spadarian/deep-learning-and-soil-science-part-1-8c0669b18097", "anchor_text": "Deep learning and Soil Science \u2014 Part 1Soil spectroscopy to predict soil properties. A multi-task convolutional neural network to predict multiple soil properties from spectrograms.towarsdatascience.com"}, {"url": "https://towardsdatascience.com/deep-learning-and-soil-science-part-2-129e0cb4be94", "anchor_text": "Deep learning and Soil Science \u2014 Part 2Digital Soil Mapping using contextual spatial information. A multi-task CNN to generate soil maps from point information.towardsdatascience.com"}, {"url": "https://towardsdatascience.com/explaining-a-cnn-generated-soil-map-with-shap-f1ec08a041eb", "anchor_text": "Explaining a CNN generated soil map with SHAPUsing SHAP to corroborate that the digital soil mapping CNN is capturing sensible relationships.towardsdatascience.com"}, {"url": "https://towardsdatascience.com/geovec-word-embeddings-for-geosciences-ac1e1e854e19", "anchor_text": "GeoVec: word embeddings for geosciencesAnalogies, categorisation, relatedness and spatial interpolation of word embeddings.towardsdatascience.com"}, {"url": "https://towardsdatascience.com/deep-learning-and-soil-science-part-1-8c0669b18097", "anchor_text": "first part of the series"}, {"url": "https://towardsdatascience.com/deep-learning-and-soil-science-part-1-8c0669b18097", "anchor_text": "first part of this Series"}, {"url": "https://pixabay.com/photo-1787622/", "anchor_text": "https://pixabay.com/photo-1787622/"}, {"url": "https://esdac.jrc.ec.europa.eu/projects/lucas", "anchor_text": "LUCAS dataset"}, {"url": "https://www.researchgate.net/publication/330145641_Transfer_learning_to_localise_a_continental_soil_vis-NIR_calibration_model", "anchor_text": "https://www.researchgate.net/publication/330145641_Transfer_learning_to_localise_a_continental_soil_vis-NIR_calibration_model"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----c793407e4997---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/towards-data-science?source=post_page-----c793407e4997---------------towards_data_science-----------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----c793407e4997---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/soil?source=post_page-----c793407e4997---------------soil-----------------", "anchor_text": "Soil"}, {"url": "https://medium.com/tag/neural-networks?source=post_page-----c793407e4997---------------neural_networks-----------------", "anchor_text": "Neural Networks"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fc793407e4997&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-and-soil-science-part-3-c793407e4997&user=Jos%C3%A9+Padarian&userId=3e87fae89f4a&source=-----c793407e4997---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fc793407e4997&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-and-soil-science-part-3-c793407e4997&user=Jos%C3%A9+Padarian&userId=3e87fae89f4a&source=-----c793407e4997---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc793407e4997&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-and-soil-science-part-3-c793407e4997&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----c793407e4997--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fc793407e4997&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-and-soil-science-part-3-c793407e4997&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----c793407e4997---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----c793407e4997--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----c793407e4997--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----c793407e4997--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----c793407e4997--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----c793407e4997--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----c793407e4997--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----c793407e4997--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----c793407e4997--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@spadarian?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@spadarian?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Jos\u00e9 Padarian"}, {"url": "https://medium.com/@spadarian/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "503 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F3e87fae89f4a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-and-soil-science-part-3-c793407e4997&user=Jos%C3%A9+Padarian&userId=3e87fae89f4a&source=post_page-3e87fae89f4a--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Ff423d6bca138&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-and-soil-science-part-3-c793407e4997&newsletterV3=3e87fae89f4a&newsletterV3Id=f423d6bca138&user=Jos%C3%A9+Padarian&userId=3e87fae89f4a&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}