{"url": "https://towardsdatascience.com/investigating-the-climate-change-with-python-and-spark-part-3-bad5627ffb01", "time": 1683017805.929458, "path": "towardsdatascience.com/investigating-the-climate-change-with-python-and-spark-part-3-bad5627ffb01/", "webpage": {"metadata": {"title": "Investigating the Climate Change with Python and Spark, Part 3 | by Kaya Kupferschmidt | Towards Data Science", "h1": "Investigating the Climate Change with Python and Spark, Part 3", "description": "You are now reading the third and last part of my mini series on analyzing publicly available data to research the climate change. Still, the idea is not to become a real expert in meteorology but to\u2026"}, "outgoing_paragraph_urls": [{"url": "https://github.com/dimajix/weather-analysis", "anchor_text": "GitHub", "paragraph_index": 2}, {"url": "https://towardsdatascience.com/using-python-and-spark-to-research-the-climate-change-part-1-7616b71cefe8", "anchor_text": "The first part of this series", "paragraph_index": 4}, {"url": "https://www.noaa.gov/", "anchor_text": "National Oceanic and Atmospheric Administration", "paragraph_index": 4}, {"url": "https://towardsdatascience.com/using-python-and-spark-to-research-the-climate-change-part-2-e2ac9faba821", "anchor_text": "The second part of the series", "paragraph_index": 4}, {"url": "https://www.dwd.de/", "anchor_text": "Deutscher Wetterdienst", "paragraph_index": 5}, {"url": "https://towardsdatascience.com/using-python-and-spark-to-research-the-climate-change-part-1-7616b71cefe8", "anchor_text": "the first part", "paragraph_index": 7}, {"url": "https://towardsdatascience.com/using-python-and-spark-to-research-the-climate-change-part-2-e2ac9faba821", "anchor_text": "the second part", "paragraph_index": 7}, {"url": "https://en.wikipedia.org/wiki/List_of_FIPS_country_codes", "anchor_text": "FIPS country code", "paragraph_index": 17}, {"url": "https://www.dwd.de", "anchor_text": "Deutscher Wetterdienst", "paragraph_index": 27}, {"url": "https://www.dwd.de/DE/leistungen/zeitreihen/zeitreihen.html", "anchor_text": "https://www.dwd.de/DE/leistungen/zeitreihen/zeitreihen.html", "paragraph_index": 27}], "all_paragraphs": ["You are now reading the third and last part of my mini series on analyzing publicly available data to research the climate change. Still, the idea is not to become a real expert in meteorology but to apply common sense with appropriate tooling to derive some insights, such that everyone with some experience in programming and in working with data can draw their own conclusions. Democratizing data science, yeah!", "As I wrote before, the capability of a broad audience to reproduce scientific insights via commonly available methodologies becomes more and more important in this world, where a growing number of decisions are increasingly based on data and mathematical models while at the same time social media simplifies to spread false information. Along with that idea, this article series is my take for researching climate change and thereby to combat all those false claims by following a more scientific approach \u2014 still without being a climate expert.", "Many details of processing steps are omitted in this article to keep the focus on the general approach. You can find a Jupyter notebook containing the complete working code on GitHub.", "The whole journey from downloading some data until making some pictures is split up into three separate stories since each step already contains lots of information.", "The first part of this series focused on getting some raw weather data from the National Oceanic and Atmospheric Administration (NOAA) and on transforming the data into a more convenient file format. The second part of the series focused on building an aggregated data set which is well suited for answering basic (but nevertheless relevant) questions about the overall weather for each country on a daily basis.", "What is now left is to perform the analysis itself and to draw some conclusions. Specifically I will try to reproduce some graphs from the real weather experts in my country (\u201cDeutscher Wetterdienst\u201d in Germany)", "So what will we learn this time?", "I assume that you already followed the first part and the second part of this series, since we will be building upon the resulting Parquet files again. The good news is that we won\u2019t generate new data sets this time, which would require more free space on your hard drive or SSD.", "As the first step (and to warm up again), let\u2019s read the final data set that we produced in the last article and display its schema:", "As I told you, we will rely on \u201ccommon sense\u201d and we will see where we get with this. So the very obvious idea to proof the climate change is to create some yearly plots \u2014 and that\u2019s not the worst thing to do. But before we follow down this route, please let me restate the systematic shortcomings that we will have to accept:", "I am no weather expert, and therefore my methodology isn\u2019t really correct. Specifically we are working with a huge data set containing weather measurements from weather stations around the world. But most weather stations have only a very limited life span, which means that the metering points change over time and therefore the weather information isn\u2019t strictly comparable between different years having different sets of active weather stations. We also don\u2019t weight the measurements of weather stations according to their distance to other weather stations (which could be an interesting idea) or other fancy stuff. We follow a plain stupid (but still educated) approach ignoring all these important details.", "The simplest thing to do right now is to create a visualization which plots the global average temperature over all countries for all years. We will be using PySpark for the aggregation and Seaborn for the visualization:", "So we see a clear increase of the average global temperature within the data set, but of course common sense tells us that there is something wrong, since the increase of 15\u00b0C between 1920 and 1950 would have already exceeded any worst case scenario that could occur in the future.", "So what could be possible explanations for what we are seeing here? Well, if we exclude any programming mistakes on our side and assuming correct implementations in all libraries, the effect has to reside inside the data set itself in combination with our approach. Remember the disclaimer about all the simplifications and the issues with a continuously changing set of weather stations? Let\u2019s try to investigate if this could be a problem. Since we already lost the individual weather stations in the aggregate, let\u2019s simply count the number of countries per year contained in the data set:", "This plot clearly shows that the data set has a very strong bias until ca 1975 because it contains far too few countries for being representative for the global weather around the whole earth.", "This first investigation shows us that we are somewhat limited with drawing global conclusions about the climate change since the data set cannot be regarded as being \u201crepresentative\u201d for the weather for whole world. Of course things could be different if we had a different data set. But hope is not lost: Why focus on the whole earth when we could also look at an individual country? This is what we will be doing in the next steps.", "Living in Germany for my whole life so I have some first hand experience with the weather of the last couple of decades. Now the obvious question is: Can data support my subjective impression that we indeed have increasingly warmer years with less snow in the winters? Let\u2019s query our data set to find some insights.", "As the first step, we filter all records in the aggregated data set such that we only look at records belonging to a weather station in Germany. To do so, we first have to look up the FIPS country code of Germany, which is GM . You might want to chose a different country code.", "Now we can use the very same PySpark code to calculate the average temperature per year. This time we will instruct Seaborn to perform a linear regression and also plot the result into the same image.", "That looks much better. As we see, the data set doesn\u2019t contain any information about Germany until ca 1925. You might have more or less luck with a different country. But although the overall average temperature fluctuates quite a bit, we can see a solid increase, especially during the last 25 years. Note that the average temperature reaches new maximum values and old minimum values are not reached any more. This coincides with my personal experience of longer summers and \u201cwarm\u201d winters without much snow.", "Of course, one could argue that the effect which I am seeing is again due to the data that I am using \u2014 I will come back to that completely valid and justified objection later.", "By using Seaborn, we can also easily create plots with confidence intervals of the temperatures in all years. This will give us more information than only the average.", "Again we see a clear increase, especially during the last 20 years.", "Since I also had the impression that we had an increasing number of storms during the last years (with very visible harm in the forest) I was also curious if I could find any support in the data \u2014 therefore I also included the wind speed in the PySpark query above.", "The resulting plot above is quite surprising for me: Average wind speed doesn\u2019t change much and the maximum wind speed even decreases. But can we trust the plot? Honestly, I don\u2019t think so: I am not a weather expert, but my gut feelings tell me that \u201caverage wind speed\u201d is not a good metric in the first place. \u201cMaximum wind speed\u201d might be more interesting, but a maximum aggregation loses all information about frequency and lengths of time periods. And finally I am not sure if I interpreted the data correctly, the semantics of wind measurements seem to be more complex than for air temperature.", "So \u201cwind speed\u201d needs some more research to either support or invalidate the plot above. But then again, can we trust the \u201ctemperature charts\u201d? This will be investigated in the next section.", "How do you know if you can trust your results? A very solid option is to compare your results with the results of other people, or even better with the results of other people who actually know what they are doing :)", "In Germany the official authority for weather and climate is the \u201cDeutscher Wetterdienst\u201d (DWD) which actually has its head quarter in Offenbach which is only 10km away from my home. They also provide some plots of the development of the average temperature in Germany over time at https://www.dwd.de/DE/leistungen/zeitreihen/zeitreihen.html.", "There is one interesting aspect of these plots: They are provided per month and not globally for the whole year. The plot above shows how the average temperature in January changed over time \u2014 again with a clear increase during the last 20 years. Actually the temperature changes over many years are not evenly distributed among different months, therefore it makes sense to create different plots per month. This is what we will be doing next and we\u2019ll compare our results with the official plots from the DWD.", "And now plot the results, which a different plot per month:", "These plots now finally offer us the possibility to compare our results with the ones from the officials experts at DWD. When you carefully compare the topmost plot with the plot from DWD, you will clearly see strong similarities, although details may vary. But personally I am more than satisfied the result given the simplistic approach.", "As I said before, the trend of increasing average temperature is not uniformly affecting all months. But if you pick any of the warmer months from April until October, it becomes very apparent again:", "Here you can clearly see, that the average temperature is increasing \u2014 of course there have been Septembers in the past that had a similar average temperature. But those were followed by rather cold or normal Septembers in the later years. Since around 2000 the situation is different and the minimum average temperature is steadily but clearly increasing without any \u201ccold\u201d September in-between.", "Now I reached the end of the actual analysis. Let me recapitulate the whole journey from the first part until the last images:", "For me, I am satisfied with the results so far. But as always, things could be improved.", "Although I hope that you agree that we were able to achieve good results, there are still many details which could be improved or where some additional research would be required:", "When we first had a look at the average temperature for the whole world, we immediately saw that the given data set doesn\u2019t contain enough information to draw reliable conclusions. Many countries were under represented until 1980, which renders the data set to be unusable for truly global investigations.", "But what about the data for individual countries like Germany? The graphs looked okay, but we don\u2019t know how many weather stations were used for individual years. We can assume that more weather stations will increase the overall data quality. A simple idea would be to count the number of distinct weather stations per day and use this information as a basic quality metric for measuring the reliability of any conclusions.", "As I already wrote above, the data contains information on wind speed, but our analysis leaves open many questions, specifically if averaging wind speed is a good metric. Drawing conclusions on wind speed needs more investigations, but would also be interesting.", "Rain fall is another very important topic. In Germany, we have been experiencing a couple of years with unusually little precipitation during the summer months. If the situation doesn\u2019t change in the next years, the lack of rainfall will impose many serious problems since water will become a scarce resource. Something which I didn\u2019t believe would happen within Germany soon until the last year.", "Unfortunately working with precipitation data is much more complex (you are not interested in the \u201caverage\u201d rainfall, but in the total amount per time period instead) and I couldn\u2019t understand the precise semantics of the data, even after consulting the format documentation.", "Climate Change and specifically Global Warming is real. Period.", "Having a somewhat scientific background, I learnt to trust the scientific discourse including peer reviews and incremental improvements in knowledge and understanding. Therefore I never doubted the existence of climate change since most (if not all) experts in that field are strongly convinced of its existence. Of course, an interesting and difficult question is to which degree the human race is responsible for this change \u2014 but as far as I know, the same experts are also convinced that this is the case.", "But trusting experts is one thing \u2014 being able to retrace the results by oneself is even better. And this is even more important in highly debated areas like Climate Change and Global Warming, a topic which one the one side will have a huge impact for young and upcoming generations of humans but which on the other hand is fought out with false information for the sake of short-term profits.", "I hope you enjoyed reading this article and maybe you even learnt something new about working with weather data, PySpark or where to find massive and meaningful amounts of data.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Freelance Big Data and Machine Learning expert at dimajix."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fbad5627ffb01&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finvestigating-the-climate-change-with-python-and-spark-part-3-bad5627ffb01&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finvestigating-the-climate-change-with-python-and-spark-part-3-bad5627ffb01&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finvestigating-the-climate-change-with-python-and-spark-part-3-bad5627ffb01&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finvestigating-the-climate-change-with-python-and-spark-part-3-bad5627ffb01&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://me.dm/@kupferk", "anchor_text": "Mastodon"}, {"url": "https://towardsdatascience.com/?source=post_page-----bad5627ffb01--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----bad5627ffb01--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://kupferk.medium.com/?source=post_page-----bad5627ffb01--------------------------------", "anchor_text": ""}, {"url": "https://kupferk.medium.com/?source=post_page-----bad5627ffb01--------------------------------", "anchor_text": "Kaya Kupferschmidt"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fa1b1c406b9d0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finvestigating-the-climate-change-with-python-and-spark-part-3-bad5627ffb01&user=Kaya+Kupferschmidt&userId=a1b1c406b9d0&source=post_page-a1b1c406b9d0----bad5627ffb01---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fbad5627ffb01&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finvestigating-the-climate-change-with-python-and-spark-part-3-bad5627ffb01&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fbad5627ffb01&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finvestigating-the-climate-change-with-python-and-spark-part-3-bad5627ffb01&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@karsten_wuerth?utm_source=medium&utm_medium=referral", "anchor_text": "Karsten W\u00fcrth"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://github.com/dimajix/weather-analysis", "anchor_text": "GitHub"}, {"url": "https://towardsdatascience.com/using-python-and-spark-to-research-the-climate-change-part-1-7616b71cefe8", "anchor_text": "Getting the data"}, {"url": "https://towardsdatascience.com/using-python-and-spark-to-research-the-climate-change-part-2-e2ac9faba821", "anchor_text": "Preparing the data"}, {"url": "https://towardsdatascience.com/using-python-and-spark-to-research-the-climate-change-part-1-7616b71cefe8", "anchor_text": "The first part of this series"}, {"url": "https://www.noaa.gov/", "anchor_text": "National Oceanic and Atmospheric Administration"}, {"url": "https://towardsdatascience.com/using-python-and-spark-to-research-the-climate-change-part-2-e2ac9faba821", "anchor_text": "The second part of the series"}, {"url": "https://www.dwd.de/", "anchor_text": "Deutscher Wetterdienst"}, {"url": "https://towardsdatascience.com/using-python-and-spark-to-research-the-climate-change-part-1-7616b71cefe8", "anchor_text": "the first part"}, {"url": "https://towardsdatascience.com/using-python-and-spark-to-research-the-climate-change-part-2-e2ac9faba821", "anchor_text": "the second part"}, {"url": "https://en.wikipedia.org/wiki/List_of_FIPS_country_codes", "anchor_text": "FIPS country code"}, {"url": "https://www.dwd.de", "anchor_text": "Deutscher Wetterdienst"}, {"url": "https://www.dwd.de/DE/leistungen/zeitreihen/zeitreihen.html", "anchor_text": "https://www.dwd.de/DE/leistungen/zeitreihen/zeitreihen.html"}, {"url": "https://medium.com/tag/climate-change?source=post_page-----bad5627ffb01---------------climate_change-----------------", "anchor_text": "Climate Change"}, {"url": "https://medium.com/tag/big-data-analytics?source=post_page-----bad5627ffb01---------------big_data_analytics-----------------", "anchor_text": "Big Data Analytics"}, {"url": "https://medium.com/tag/pyspark?source=post_page-----bad5627ffb01---------------pyspark-----------------", "anchor_text": "Pyspark"}, {"url": "https://medium.com/tag/data-science?source=post_page-----bad5627ffb01---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/weather?source=post_page-----bad5627ffb01---------------weather-----------------", "anchor_text": "Weather"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fbad5627ffb01&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finvestigating-the-climate-change-with-python-and-spark-part-3-bad5627ffb01&user=Kaya+Kupferschmidt&userId=a1b1c406b9d0&source=-----bad5627ffb01---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fbad5627ffb01&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finvestigating-the-climate-change-with-python-and-spark-part-3-bad5627ffb01&user=Kaya+Kupferschmidt&userId=a1b1c406b9d0&source=-----bad5627ffb01---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fbad5627ffb01&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finvestigating-the-climate-change-with-python-and-spark-part-3-bad5627ffb01&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----bad5627ffb01--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fbad5627ffb01&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finvestigating-the-climate-change-with-python-and-spark-part-3-bad5627ffb01&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----bad5627ffb01---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----bad5627ffb01--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----bad5627ffb01--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----bad5627ffb01--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----bad5627ffb01--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----bad5627ffb01--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----bad5627ffb01--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----bad5627ffb01--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----bad5627ffb01--------------------------------", "anchor_text": ""}, {"url": "https://kupferk.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://kupferk.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Kaya Kupferschmidt"}, {"url": "https://kupferk.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "223 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fa1b1c406b9d0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finvestigating-the-climate-change-with-python-and-spark-part-3-bad5627ffb01&user=Kaya+Kupferschmidt&userId=a1b1c406b9d0&source=post_page-a1b1c406b9d0--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F874fa4e516b6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finvestigating-the-climate-change-with-python-and-spark-part-3-bad5627ffb01&newsletterV3=a1b1c406b9d0&newsletterV3Id=874fa4e516b6&user=Kaya+Kupferschmidt&userId=a1b1c406b9d0&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}