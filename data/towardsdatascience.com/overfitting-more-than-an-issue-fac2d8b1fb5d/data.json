{"url": "https://towardsdatascience.com/overfitting-more-than-an-issue-fac2d8b1fb5d", "time": 1683007182.57619, "path": "towardsdatascience.com/overfitting-more-than-an-issue-fac2d8b1fb5d/", "webpage": {"metadata": {"title": "Overfitting, more than an issue. I have been working with Machine\u2026 | by Alejandro Puente-Castro | Towards Data Science", "h1": "Overfitting, more than an issue", "description": "I have been working with machine learning and deep learning models for years. Over this time I have found cases where overfitting was not that obvious. As well, I have seen other people like friends\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.linkedin.com/in/alejandro-puente-castro/", "anchor_text": "LinkedIn", "paragraph_index": 26}, {"url": "https://dl.acm.org/doi/abs/10.1145/2939672.2939778", "anchor_text": "\u201cWhy should i trust you?\u2019\u2019 explaining the predictions of any classifier", "paragraph_index": 27}], "all_paragraphs": ["I have been working with machine learning and deep learning models for years. Over this time I have found cases where overfitting was not that obvious. As well, I have seen other people like friends, colleagues, or students that couldn\u2019t identify overfitting in their problems.", "Thereby, I have decided to make this little guide relating cases I have faced where overfitting was difficult to identify, and the main experienced errors while trying to solve it.", "When working with classical machine learning or deep learning problems and their models, like artificial neural networks or SVM used for classification, there is an initial training stage. During training, the model is fed with selected data in order to teach it how to classify given data.", "Once the model is trained with data it is time to test it with new data. This is known as the test stage, and it proves if the model is able or not of abstracting information from data never learned before.", "If the model has good results with training data but bad results with test data it is said that the model is overfitted. These results come from evaluation metrics like accuracy, recall, precision\u2026 Usually, when learning Machine Learning for the first time, it is said that accuracy or recall values during training close to 100% but not during testing imply overfitting.", "Sometimes this is not entirely true. There may be cases with a 70% recall involving overfitting. Therefore, here is a list of cases in which it is not always easy to identify the presence of overfitting.", "This case is the one I see more frequently among bioinformatics problems. Let\u2019s start with an example. In this example, we are bioinformaticians trying to find a deep learning model, which has to be able to detect the presence of neurodegenerative diseases. Neurodegenerative diseases usually have phases, and the earlier they are detected, the more effective the treatment is because the disease has not advanced that far.", "The disease we are focusing on has 3 stages, being stage 1 the initial manifestations of the disease, and stage 3 the most advanced manifestations. Thus, it is more important to detect stage 1 (the class of interest) over stages 2 and 3 because treatment would be more effective.", "During training we achieve the desired situation, we detect stage 1 cases almost perfectly. During the test process, stage 3 cases are the best detected and stage 1 cases are the fewest classified correctly. This is clearly an overfitting problem because the model can\u2019t classify new data.", "Sometimes this does not show as clear as it may seem. When I was learning deep learning I faced a problem like that. My model had a 70% recall for stage 1 when training, being the best classified, and 50% stage 3, being the second-best classified. When testing, recall for stage 1 was 60% but recall for stage 3 was 80%. These results show that the model was not good, but I wasn\u2019t experienced enough to understand it. First, this model was not useful for medical specialists because they want a model that can diagnose diseases when their presence is not that obvious. Second, even when recall for stage 1 didn\u2019t change significantly it did for stage 3. This means that the training data was not able to represent cases that might appear during testing, and the model could not generalize its knowledge.", "As I stated before, this is very frequent among bioinformatic problems and there are scientific papers where authors couldn\u2019t find they were overfitting their models or didn\u2019t solve it in a proper way.", "Most people use data augmentation techniques in order to generate new examples with more variety of cases. This can be useful in several cases, like image enhancement problems. In image restoration problems the models identify artifacts like noise and try to remove them. The more different types of artifacts it learns during training, the better it\u2019ll work with new images. Some authors create new images with artificial noise in order to increment the variety during training.", "In other problems, like medical problems, artificial data can represent cases that can\u2019t exist in nature. Training the model with wrong data may bias it. This is common among students or people who are starting in machine learning. They don\u2019t check augmented data and then have unrealistic cases like this one:", "The second case is the one I see among beginners. When I was a college student I suffered the same problem. There are those problems where used data are strongly unbalanced. For example, in the data set I was using 90% of data was from class 0 and 10% was from class 1.", "When splitting data into testing and training data I used Hold-Out strategy with 80% of data for training and 20% for testing. It is obvious this was a bad idea. During training, model showed great accuracy and recall values. And, those values at testing where high too because data came from the same data set. I didn\u2019t realize in the moment, because I got good results in both training and testing stages.", "When using strongly unbalanced data the model tends to learn the most common class. In my case, class 0. Most people don\u2019t realize the problem is that model classifies most of the examples as a specific class. This happens because that model learned that it is more probable that a given example is from that class, so it doesn\u2019t abstract information from other classes.", "Most of the people in this situation try to solve overfitting removing examples from overrepresented class or repeating data from underrepresented class so each class contains the same number of elements.", "If removing data is the chosen solution, you may be removing important and representative data from the possible range of cases that define that class. Then, it is possible that evaluation metrics for that class get worse because new examples may contain features that model couldn\u2019t learn for abstracting knowledge.", "On the other hand, repeating data might bias the classification of less represented classes. When repeating data most of the examples are repeated multiple times. The model may learn those repeated examples as the most representative of that class and ignore other less represented examples into that class. For example, if we are training an animal classifier and we only repeat images of gray cats, it is possible our model only identifies the gray ones as cats.", "Having little variety of data for a class can also produce a bias in the classification. That is, the model is under fitted and shows poor results during training. A well-known bag is that of Tulio Ribeiro et al. in 2016 [1] where they tested a model that differentiates wolves from huskies. The final result was a model that detected the animal in the image as a wolf if there was snow in the background.", "Sometimes data is hard to obtain. Sometimes there are no available sources or data that are expensive to obtain. When this happens, people tend to use only the little data they have. For example, medical data is hard to obtain. Sometimes researchers only have data from one patient or a few patients (a few sources). This means most of data examples are related and dependent.", "When data are from few sources the model may have a problem when it is deployed for production. In my case, I only had retinal images from one patient and I was trying to make a system for detecting vessels in retinal images. I had to split data into training and testing data doing cross-validation because of the small number of examples. In both training and testing, I obtained good results.", "At deploying the system it was tested in a second patient. As expected, the results were dire. The organs of the human body are usually quite different from each other.", "As in the previous case, the small variety of data in all classes can produce bias and not overfitting. Only cases that were very similar to the few with which the model has been trained were detected.", "When this situation occurs, less experienced people have trouble finding the root of the problem. Therefore, it is better to try different techniques, not only machine learning, in order to be able to make ad-hoc solutions. It would be a quick solution while you can\u2019t have more data.", "The cases explained here are a few examples where people do not usually identify overfitting problems. They are all cases that I encountered personally. I find all of them interesting, especially for people who are just starting out. No one in this world was born knowing everything, practice and experimentation are our best teachers. Never stop learning and experimenting.", "If you have any doubt or correction about this post don\u2019t hesitate to ask or suggest them to me at LinkedIn.", "[1] M. T. Ribeiro, S. Singh, C. Guestrin, \u201cWhy should i trust you?\u2019\u2019 explaining the predictions of any classifier (2016), Proceedings of the 22nd ACM SIGKDD international conference on knowledge discovery and data mining.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Ffac2d8b1fb5d&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Foverfitting-more-than-an-issue-fac2d8b1fb5d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Foverfitting-more-than-an-issue-fac2d8b1fb5d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Foverfitting-more-than-an-issue-fac2d8b1fb5d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Foverfitting-more-than-an-issue-fac2d8b1fb5d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----fac2d8b1fb5d--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----fac2d8b1fb5d--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@AlejandroPuenteCastro?source=post_page-----fac2d8b1fb5d--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@AlejandroPuenteCastro?source=post_page-----fac2d8b1fb5d--------------------------------", "anchor_text": "Alejandro Puente-Castro"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fcfc36ff81872&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Foverfitting-more-than-an-issue-fac2d8b1fb5d&user=Alejandro+Puente-Castro&userId=cfc36ff81872&source=post_page-cfc36ff81872----fac2d8b1fb5d---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ffac2d8b1fb5d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Foverfitting-more-than-an-issue-fac2d8b1fb5d&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ffac2d8b1fb5d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Foverfitting-more-than-an-issue-fac2d8b1fb5d&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://pixabay.com", "anchor_text": "Pixabay"}, {"url": "https://pixabay.com/photos/wrong-way-wrong-way-no-confused-429723/", "anchor_text": "alehigalgo"}, {"url": "https://pixabay.com", "anchor_text": "Pixabay"}, {"url": "https://pixabay.com/illustrations/mri-magnetic-x-ray-skull-head-782457/", "anchor_text": "toubibe"}, {"url": "https://www.linkedin.com/in/alejandro-puente-castro/", "anchor_text": "LinkedIn"}, {"url": "https://dl.acm.org/doi/abs/10.1145/2939672.2939778", "anchor_text": "\u201cWhy should i trust you?\u2019\u2019 explaining the predictions of any classifier"}, {"url": "https://medium.com/tag/overfitting?source=post_page-----fac2d8b1fb5d---------------overfitting-----------------", "anchor_text": "Overfitting"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----fac2d8b1fb5d---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----fac2d8b1fb5d---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Ffac2d8b1fb5d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Foverfitting-more-than-an-issue-fac2d8b1fb5d&user=Alejandro+Puente-Castro&userId=cfc36ff81872&source=-----fac2d8b1fb5d---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Ffac2d8b1fb5d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Foverfitting-more-than-an-issue-fac2d8b1fb5d&user=Alejandro+Puente-Castro&userId=cfc36ff81872&source=-----fac2d8b1fb5d---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ffac2d8b1fb5d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Foverfitting-more-than-an-issue-fac2d8b1fb5d&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----fac2d8b1fb5d--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Ffac2d8b1fb5d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Foverfitting-more-than-an-issue-fac2d8b1fb5d&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----fac2d8b1fb5d---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----fac2d8b1fb5d--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----fac2d8b1fb5d--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----fac2d8b1fb5d--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----fac2d8b1fb5d--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----fac2d8b1fb5d--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----fac2d8b1fb5d--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----fac2d8b1fb5d--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----fac2d8b1fb5d--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@AlejandroPuenteCastro?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@AlejandroPuenteCastro?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Alejandro Puente-Castro"}, {"url": "https://medium.com/@AlejandroPuenteCastro/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "3 Followers"}, {"url": "https://www.linkedin.com/in/alejandro-puente-castro/", "anchor_text": "https://www.linkedin.com/in/alejandro-puente-castro/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fcfc36ff81872&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Foverfitting-more-than-an-issue-fac2d8b1fb5d&user=Alejandro+Puente-Castro&userId=cfc36ff81872&source=post_page-cfc36ff81872--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fusers%2Fcfc36ff81872%2Flazily-enable-writer-subscription&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Foverfitting-more-than-an-issue-fac2d8b1fb5d&user=Alejandro+Puente-Castro&userId=cfc36ff81872&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}