{"url": "https://towardsdatascience.com/building-an-ai-8-ball-with-roberta-2bfbf6f5519b", "time": 1683015878.412732, "path": "towardsdatascience.com/building-an-ai-8-ball-with-roberta-2bfbf6f5519b/", "webpage": {"metadata": {"title": "Building an AI 8-Ball with RoBERTa by Rob Gonsalves | Towards Data Science", "h1": "Building an AI 8-Ball with RoBERTa", "description": "I\u2019ll show you how I built an AI 8-Ball that can answer yes/no questions using the power of the Internet and current Machine Learning techniques."}, "outgoing_paragraph_urls": [{"url": "https://towardsdatascience.com/bert-explained-state-of-the-art-language-model-for-nlp-f8b21a9b6270", "anchor_text": "here", "paragraph_index": 6}, {"url": "https://medium.com/illuin/deep-learning-has-almost-all-the-answers-yes-no-question-answering-with-transformers-223bebb70189", "anchor_text": "here", "paragraph_index": 9}, {"url": "https://colab.research.google.com/github/robgon-art/ai8ball/blob/main/AI_8_Ball_Training.ipynb", "anchor_text": "here", "paragraph_index": 9}, {"url": "https://colab.research.google.com/github/robgon-art/ai8ball/blob/main/AI_8_Ball_Answers.ipynb", "anchor_text": "here", "paragraph_index": 17}, {"url": "https://github.com/robgon-art/ai8ball", "anchor_text": "GitHub", "paragraph_index": 24}, {"url": "https://creativecommons.org/licenses/by-sa/4.0/", "anchor_text": "CC BY-SA license", "paragraph_index": 24}, {"url": "https://arxiv.org/pdf/1907.11692.pdf", "anchor_text": "https://arxiv.org/pdf/1907.11692.pdf", "paragraph_index": 25}, {"url": "https://robgon.medium.com/membership", "anchor_text": "become a member", "paragraph_index": 26}], "all_paragraphs": ["In this post, I\u2019ll show you how I built an AI 8-Ball that can answer yes/no questions using the power of the Internet and current Machine Learning techniques. I\u2019ll start with a high-level description of the system and then get into the details of the components along with excerpts of the Python code. I\u2019ll show how you can get both a percentage no-to-yes answer and a percentage confidence level as outputs. Finally, I\u2019ll give instructions on how to run the AI 8-Ball to answer your own questions.", "Have you ever used a Magic 8-Ball? It was a toy introduced by Mattel in the \u201950s that is still sold today. It\u2019s pretty simple. It\u2019s an over-sized 8-ball that answers yes/no questions. It has a 20-sided die floating in a murky liquid that uses the \u201cmagic\u201d of random choice to answer questions. Of the twenty possible answers, five of them mean no, like \u201cVery doubtful\u201d, five mean maybe, like \u201cReply hazy, try again\u201d, and ten mean yes, like \u201cIt is certain\u201d.", "I built an early prototype of an AI 8-Ball back in 2007, pictured above, and showed it at the MIT Stata Center as part of a group show called COLLISIONcollective C11. My first version used an Artificial Neural Network (ANN) that is tiny by today\u2019s standards, with only 1,056 neural connections. My new version uses an ANN called the large RoBERTa model which has 355 million neural connections [1].", "The AI 8-Ball is built using several existing components for Natural Language Processing (NLP). The heart of the system is the large RoBERTa model, which I fine-tuned to answer yes/no questions using the BoolQ dataset from Google AI [2].", "Users can type in any question, and the system gathers supporting text passages from Wikipedia, The New York Times, and the BoolQ dataset. I employ a system called PyTextRank to extract keywords from the question that are used to look up Wikipedia and NYT articles. I also use the Universal Sentence Encoder [3] from Google to check for similar questions in the BoolQ dataset. If there is a close match, I use the associated text as a third passage.", "All passages, along with the question, are sent into the RoBERTa model to run inferences. Each inference returns three percentages: yes, no, and confidence. The inference with the highest confidence level is reported to the user as the answer. Below is a diagram that shows the components with a sample question and the results.", "BERT is the name of an NLP model that was built and trained by Google. The name stands for Bidirectional Encoder Representations from Transformers. The system is designed to perform common NLP tasks like machine translation, document summarization, and text generation. More info about BERT can be found in Rani Horev\u2019s post here.", "For this project, I\u2019m using the RoBERTa model, which is an improvement on the original BERT. It was designed and trained by researchers at the University of Washington and Facebook. Enhancements for RoBERTa include training the model longer with bigger batches, using more data with longer sequences, as well as other changes to improve accuracy[4].", "BoolQ is a dataset from Google AI that contains about 16K examples of text with corresponding yes/no questions [3]. Each entry contains a question, title, answer, and a passage of text. This dataset can be used to train and test NLP systems for answering yes/no questions. For example, here is one of the entries.", "I fine-tuned the RoBERTa model using the BoolQ dataset, starting with code from Michael Vincent\u2019s post here. I amended his code to use a larger model and set the hyperparameters like the batch size and number of epochs to allow it to be trained in Google Colab. My updated training code is here.", "The Python code below shows how to use RoBERTa for answering yes/no questions. As an example, the first paragraph of the Wikipedia article on the Magic 8-Ball is passed into the model along with six yes/no questions.", "Both the text and the question are tokenized and passed into the model. It returns a vector that contains a yes and no part. Probabilities of the answer being yes or no can be derived using the softmax function in PyTorch. A confidence level can be derived from the length of the vector. Here are the results of the six questions:", "It seems to have answered all questions correctly. Notice how the confidence level varies, but not always in line with the percent yes/no. For example, \u200bthe first sentence of the passage clearly states \u200bthat the Magic 8-Ball is a sphere, so the answer to the first question gets high marks for both yes and confidence. However, the sentence in the passage about inventorship refers to the Magic 8-Ball using the pronoun \u201cit\u201d, so that\u2019s why the answers to questions about inventorship are dropped down a bit in certainty. We\u2019ll use this feature later when mapping to the classic Magic 8-Ball answers.", "The system uses an algorithm called TextRank to extract keywords and phrases from the user\u2019s question[5]. It\u2019s based on the famous PageRank algorithm that Larry Page, et. al, invented for web searches. You pass in a block of text and it returns key phrases ranked by relevance. Here is some sample code that shows how it can extract keywords from a question.", "You can see that it does a good job of extracting the key phrases.", "Now that we have the keywords, we can use them to query Wikipedia and The New York Times to see if there are any relevant articles to use as text passages for the question. Also, we\u2019ll use a search algorithm to find the closest question in the BoolQ dataset using a k-d tree, short for a k-dimensional tree, a data structure used for fast searches of multidimensional data [6]. If the match is close, we\u2019ll use the corresponding text as the third passage. Here is the python code to perform all three searches and pass them into the RoBERTa model to get the results.", "Now that we have the three results, we\u2019ll use this code to see which one has the highest confidence level.", "The above algorithm gives us two output parameters: percentage yes and percentage confidence. In order to map these two parameters to the closest classic Magic 8-Ball answer, I first mapped the 20 answers into a multi-dimensional space using the Universal Sequence Encoder. I then reduced the dimensions to two and rotated the points to align with a no-to-yes horizontal axis and a low-to-high confidence vertical axis. The code to do the mapping is here. The graph below shows the results.", "The two parameters for the final answer are mapped to the classic Magic 8-Ball using this code.", "Here is the output of the AI 8-Ball for the sample question.", "With a yes percentage of 99.52% and a confidence of 100%, it maps to the closest answer, \u201cIt is certain\u201d.", "You can run the AI 8-Ball on Google Colab. Note that you will need a Google account to run it.", "Possible improvements to the AI 8-Ball could include using speech to text for asking questions and adding animation to reveal the answer. These additions might give the project more of a \u201cmagic\u201d feel.", "I would like to thank Jennifer Lim, Oliver Strimpel, Vahid Khorasani Ghassab, and Mahsa Mesgaran for their help with this project.", "All source code for this project is available on GitHub. The sources are released under the CC BY-SA license.", "[1] Yinhan Liu, Myle Ott, Naman Goyal, Jingfei Du, Mandar Joshi, Danqi Chen, Omer Levy, Mike Lewis, Luke Zettlemoyer, Veselin Stoyanov, \u201cRoberta: A robustly optimized BERTpretraining approach\u201d, 2019, https://arxiv.org/pdf/1907.11692.pdf", "To get unlimited access to all articles on Medium, become a member for $5/month. Non-members can only read three locked stories each month.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Robert A. Gonsalves is an artist, inventor, and engineer in the Boston area who researches and writes about the creative uses of AI."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F2bfbf6f5519b&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-an-ai-8-ball-with-roberta-2bfbf6f5519b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-an-ai-8-ball-with-roberta-2bfbf6f5519b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-an-ai-8-ball-with-roberta-2bfbf6f5519b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-an-ai-8-ball-with-roberta-2bfbf6f5519b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----2bfbf6f5519b--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----2bfbf6f5519b--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://robgon.medium.com/?source=post_page-----2bfbf6f5519b--------------------------------", "anchor_text": ""}, {"url": "https://robgon.medium.com/?source=post_page-----2bfbf6f5519b--------------------------------", "anchor_text": "Robert A. Gonsalves"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fc97e6c73c13c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-an-ai-8-ball-with-roberta-2bfbf6f5519b&user=Robert+A.+Gonsalves&userId=c97e6c73c13c&source=post_page-c97e6c73c13c----2bfbf6f5519b---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F2bfbf6f5519b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-an-ai-8-ball-with-roberta-2bfbf6f5519b&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F2bfbf6f5519b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-an-ai-8-ball-with-roberta-2bfbf6f5519b&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://towardsdatascience.com/bert-explained-state-of-the-art-language-model-for-nlp-f8b21a9b6270", "anchor_text": "here"}, {"url": "https://unsplash.com/@ameliaspink?utm_source=medium&utm_medium=referral", "anchor_text": "Amelia Spink"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://medium.com/illuin/deep-learning-has-almost-all-the-answers-yes-no-question-answering-with-transformers-223bebb70189", "anchor_text": "here"}, {"url": "https://colab.research.google.com/github/robgon-art/ai8ball/blob/main/AI_8_Ball_Training.ipynb", "anchor_text": "here"}, {"url": "https://unsplash.com/@timothyeberly?utm_source=medium&utm_medium=referral", "anchor_text": "Timothy Eberly"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://www.flickr.com/photos/9106303@N05/2403514661", "anchor_text": "\u201cNo Video Magic 8- Ball\u201d"}, {"url": "https://www.flickr.com/photos/9106303@N05", "anchor_text": "Mike Licht, NotionsCapital.com"}, {"url": "https://creativecommons.org/licenses/by/2.0/?ref=ccsearch&atype=rich", "anchor_text": "CC BY 2.0"}, {"url": "https://colab.research.google.com/github/robgon-art/ai8ball/blob/main/AI_8_Ball_Answers.ipynb", "anchor_text": "here"}, {"url": "https://colab.research.google.com/github/robgon-art/ai8ball/blob/main/AI_8_Ball.ipynb", "anchor_text": "here"}, {"url": "https://github.com/robgon-art/ai8ball", "anchor_text": "GitHub"}, {"url": "https://creativecommons.org/licenses/by-sa/4.0/", "anchor_text": "CC BY-SA license"}, {"url": "https://arxiv.org/pdf/1907.11692.pdf", "anchor_text": "https://arxiv.org/pdf/1907.11692.pdf"}, {"url": "https://arxiv.org/pdf/1905.10044.pdf", "anchor_text": "https://arxiv.org/pdf/1905.10044.pdf"}, {"url": "https://arxiv.org/pdf/1803.11175.pdf", "anchor_text": "https://arxiv.org/pdf/1803.11175.pdf"}, {"url": "https://arxiv.org/pdf/1810.04805.pdf", "anchor_text": "https://arxiv.org/pdf/1810.04805.pdf"}, {"url": "https://web.eecs.umich.edu/~mihalcea/papers/mihalcea.emnlp04.pdf", "anchor_text": "https://web.eecs.umich.edu/~mihalcea/papers/mihalcea.emnlp04.pdf"}, {"url": "https://arxiv.org/pdf/cs/9901013.pdf", "anchor_text": "https://arxiv.org/pdf/cs/9901013.pdf"}, {"url": "https://robgon.medium.com/membership", "anchor_text": "become a member"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----2bfbf6f5519b---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/roberta?source=post_page-----2bfbf6f5519b---------------roberta-----------------", "anchor_text": "Roberta"}, {"url": "https://medium.com/tag/neural-networks?source=post_page-----2bfbf6f5519b---------------neural_networks-----------------", "anchor_text": "Neural Networks"}, {"url": "https://medium.com/tag/nlp?source=post_page-----2bfbf6f5519b---------------nlp-----------------", "anchor_text": "NLP"}, {"url": "https://medium.com/tag/editors-pick?source=post_page-----2bfbf6f5519b---------------editors_pick-----------------", "anchor_text": "Editors Pick"}, {"url": "https://creativecommons.org/licenses/by-sa/4.0/", "anchor_text": "Some rights reserved"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F2bfbf6f5519b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-an-ai-8-ball-with-roberta-2bfbf6f5519b&user=Robert+A.+Gonsalves&userId=c97e6c73c13c&source=-----2bfbf6f5519b---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F2bfbf6f5519b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-an-ai-8-ball-with-roberta-2bfbf6f5519b&user=Robert+A.+Gonsalves&userId=c97e6c73c13c&source=-----2bfbf6f5519b---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F2bfbf6f5519b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-an-ai-8-ball-with-roberta-2bfbf6f5519b&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----2bfbf6f5519b--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F2bfbf6f5519b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-an-ai-8-ball-with-roberta-2bfbf6f5519b&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----2bfbf6f5519b---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----2bfbf6f5519b--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----2bfbf6f5519b--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----2bfbf6f5519b--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----2bfbf6f5519b--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----2bfbf6f5519b--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----2bfbf6f5519b--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----2bfbf6f5519b--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----2bfbf6f5519b--------------------------------", "anchor_text": ""}, {"url": "https://robgon.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://robgon.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Robert A. Gonsalves"}, {"url": "https://robgon.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "1.6K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fc97e6c73c13c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-an-ai-8-ball-with-roberta-2bfbf6f5519b&user=Robert+A.+Gonsalves&userId=c97e6c73c13c&source=post_page-c97e6c73c13c--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F886e4a42bf8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-an-ai-8-ball-with-roberta-2bfbf6f5519b&newsletterV3=c97e6c73c13c&newsletterV3Id=886e4a42bf8&user=Robert+A.+Gonsalves&userId=c97e6c73c13c&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}