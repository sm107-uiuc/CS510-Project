{"url": "https://towardsdatascience.com/r-and-leaflet-to-create-interactive-choropleth-maps-8515ef83e275", "time": 1683011509.379655, "path": "towardsdatascience.com/r-and-leaflet-to-create-interactive-choropleth-maps-8515ef83e275/", "webpage": {"metadata": {"title": "R and Leaflet to create interactive choropleth maps. | by Eamon O'Connor | Towards Data Science", "h1": "R and Leaflet to create interactive choropleth maps.", "description": "Despite Covid-19 being a big deal in the world, it\u2019s actually been fascinating for data scientists, and in particular data visualisation. It\u2019s probably inspired many into the industry. In decades to\u2026"}, "outgoing_paragraph_urls": [], "all_paragraphs": ["Before I start, here is the link to the full interactive version host on Github Pages.", "I\u2019ll preface this with: this is not a Coronavirus post.", "Despite Covid-19 being a big deal in the world, it\u2019s actually been fascinating for data scientists, and in particular data visualisation. It\u2019s probably inspired many into the industry.", "In decades to come I imagine that universities and online courses will be using Covid-19 datasets to teach data collection, wrangling, visualisation, modelling, etc.", "But before that, the real king of data was arguably politics, so here I will pay fealty to the former ruler of data visualisation and give you a step-by-step of how to build an interactive choropleth map to display election results using R Studio and the Leaflet library.", "We\u2019ll need 2 different sets of data. One with the mapping geometry, and one with the election results.", "The data I\u2019m using is from the Australian Electoral Commission and can be found here:", "Using readShapeSpatial() from the maptools package, we pass the shape file in as it\u2019s ownly required parameter and assign it to a variable. Use the plot() function to see how it looks.", "Read the election data and pass it into a variable", "First we take a look at the structure of the data", "First of all, I don\u2019t like the names of the variables.", "This is looking better Next we\u2019ll take a look at the Division names in the shapefile data. This is important because the electiondata Divisions have to map exactly to the shapefile Divisions", "It looks like the Divisions in the shapefile are under the variable Elect_div", "So far so good. There are 38 levels in both electiondata$Divisions and vicmapdata$Elect_div which is a good start. We can inspect them manually at this size but what if we were doing the whole country, or a much larger one? We need to do this intelligently and have R do the heavy lifting for us.", "The names in both datasets have to match exactly for the 2 datasets to map together properly.", "We do have an inconsistency. It\u2019s telling us that \u201cMcEwen\u201d is in the first vector, but not in the second. Let\u2019s find the position of \u201cMcEwen\u201d in the first vector, and see what is in the corresponding position in the second vector.", "So it\u2019s at position 31. What\u2019s at position 31 in the other vector?", "Ok so it\u2019s small but the first vector has an \u2018E\u2019 where the second has an \u2018e\u2019. To stay inside the code, and not have to fix this manually (remember this needs to be scalable), we\u2019ll map the data from one vector into the other (now that we know everything else is the same)", "Now let\u2019s run a check like we did before to make sure the values match up", "Here comes the fun bit! We\u2019re going to use leaflet instead of the plot function we used above. We\u2019ll pass it our \u2018vicmapdata\u2019. addPolygons will draw the boundaries for us when we set stroke=True We\u2019ll use white lines with a thickness of 1.5", "(View the interactive version at the link at the top of the page)", "At this point, we have 2 data variables. 1 for the mapping data, which we have just demonstrated. Now we need to map our election data to the plot.", "First we\u2019ll create the labels. This means that when we hover our mouse over an electorate, it will tell us the relevant statistics. We\u2019re using some HTML tools for formatting once the plot is rendered.", "Now we\u2019ll plug our mylabels variable into our previous leaflet code chunk", "(View the interactive version at the link at the top of the page)", "So far so good. Now we\u2019ll add some colours. I created a variable called factpal (factor palette). We\u2019re using the colorFactor function from the leaflet library. topo.colors(5) tells the function that we need 5 colours within the topo.colors palette and unique() allows us to assign a colour to a specific level. In this case we want every electorate with the same winning party to be assigned the same colour.", "And now we insert the factpal function into our leaflet code chunk", "(View the interactive version at the link at the top of the page)", "From here we just need to add some text and a legend.", "Text: We need a title and some reference links to the data", "Legend: Which colours equate to which party", "Here is the code for the text labels. We\u2019re essentially just feeding in HTML", "Now we just plug in our title and reference data from above and add the legend which you can see below under the addLegend function.", "(View the interactive version at the link at the top of the page)", "Thank you for reading. See you in the cloud.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Creative Destruction | Web Dev | Data Science. I am a military veteran studying a Masters in Data Science, Strategy and Leadership."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F8515ef83e275&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fr-and-leaflet-to-create-interactive-choropleth-maps-8515ef83e275&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fr-and-leaflet-to-create-interactive-choropleth-maps-8515ef83e275&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fr-and-leaflet-to-create-interactive-choropleth-maps-8515ef83e275&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fr-and-leaflet-to-create-interactive-choropleth-maps-8515ef83e275&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----8515ef83e275--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----8515ef83e275--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://eamon-james-oconnor.medium.com/?source=post_page-----8515ef83e275--------------------------------", "anchor_text": ""}, {"url": "https://eamon-james-oconnor.medium.com/?source=post_page-----8515ef83e275--------------------------------", "anchor_text": "Eamon O'Connor"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fa712101ba3ec&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fr-and-leaflet-to-create-interactive-choropleth-maps-8515ef83e275&user=Eamon+O%27Connor&userId=a712101ba3ec&source=post_page-a712101ba3ec----8515ef83e275---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F8515ef83e275&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fr-and-leaflet-to-create-interactive-choropleth-maps-8515ef83e275&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F8515ef83e275&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fr-and-leaflet-to-create-interactive-choropleth-maps-8515ef83e275&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@marjan_blan?utm_source=medium&utm_medium=referral", "anchor_text": "\u041c\u0430\u0440\u044c\u044f\u043d \u0411\u043b\u0430\u043d | @marjanblan"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://ejooco.github.io/MapStats.github.io/", "anchor_text": "Creating Interactive Maps with Leafletejooco.github.io"}, {"url": "https://aec.gov.au/Electorates/gis/gis_datadownload.htm", "anchor_text": "Federal electoral boundary GIS data for free downloadWhile every care is taken to ensure the accuracy of the data within this product, the owners of the data (including the\u2026aec.gov.au"}, {"url": "https://results.aec.gov.au/24310/Website/HouseDivisionalResults-24310.htm", "anchor_text": "Divisional resultsThis table allows you to search for a division by name. This table is sortable by selecting column headers and you can\u2026results.aec.gov.au"}, {"url": "https://github.com/ejooco", "anchor_text": "https://github.com/ejooco"}, {"url": "https://medium.com/tag/data-visualization?source=post_page-----8515ef83e275---------------data_visualization-----------------", "anchor_text": "Data Visualization"}, {"url": "https://medium.com/tag/leaflet?source=post_page-----8515ef83e275---------------leaflet-----------------", "anchor_text": "Leaflet"}, {"url": "https://medium.com/tag/maps?source=post_page-----8515ef83e275---------------maps-----------------", "anchor_text": "Maps"}, {"url": "https://medium.com/tag/data-science?source=post_page-----8515ef83e275---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/r?source=post_page-----8515ef83e275---------------r-----------------", "anchor_text": "R"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F8515ef83e275&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fr-and-leaflet-to-create-interactive-choropleth-maps-8515ef83e275&user=Eamon+O%27Connor&userId=a712101ba3ec&source=-----8515ef83e275---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F8515ef83e275&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fr-and-leaflet-to-create-interactive-choropleth-maps-8515ef83e275&user=Eamon+O%27Connor&userId=a712101ba3ec&source=-----8515ef83e275---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F8515ef83e275&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fr-and-leaflet-to-create-interactive-choropleth-maps-8515ef83e275&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----8515ef83e275--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F8515ef83e275&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fr-and-leaflet-to-create-interactive-choropleth-maps-8515ef83e275&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----8515ef83e275---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----8515ef83e275--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----8515ef83e275--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----8515ef83e275--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----8515ef83e275--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----8515ef83e275--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----8515ef83e275--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----8515ef83e275--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----8515ef83e275--------------------------------", "anchor_text": ""}, {"url": "https://eamon-james-oconnor.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://eamon-james-oconnor.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Eamon O'Connor"}, {"url": "https://eamon-james-oconnor.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "9 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fa712101ba3ec&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fr-and-leaflet-to-create-interactive-choropleth-maps-8515ef83e275&user=Eamon+O%27Connor&userId=a712101ba3ec&source=post_page-a712101ba3ec--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Ffbb25c464ad6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fr-and-leaflet-to-create-interactive-choropleth-maps-8515ef83e275&newsletterV3=a712101ba3ec&newsletterV3Id=fbb25c464ad6&user=Eamon+O%27Connor&userId=a712101ba3ec&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}