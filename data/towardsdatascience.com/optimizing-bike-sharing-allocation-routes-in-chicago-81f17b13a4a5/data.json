{"url": "https://towardsdatascience.com/optimizing-bike-sharing-allocation-routes-in-chicago-81f17b13a4a5", "time": 1683005899.6264179, "path": "towardsdatascience.com/optimizing-bike-sharing-allocation-routes-in-chicago-81f17b13a4a5/", "webpage": {"metadata": {"title": "Optimizing Shared-Bike Allocation Routes | by Luis Flosi | Towards Data Science", "h1": "Optimizing Shared-Bike Allocation Routes", "description": "A new way to solve the Vehicle Routing Problem for shared bikes in a large city"}, "outgoing_paragraph_urls": [{"url": "https://data.cityofchicago.org/", "anchor_text": "Data Portal", "paragraph_index": 1}, {"url": "https://github.com/LuisFlosi/Shared-Bikes-Optimization", "anchor_text": "GitHub", "paragraph_index": 1}, {"url": "http://apiems2016.conf.tw/site/userdata/1087/papers/0381.pdf", "anchor_text": "this", "paragraph_index": 16}], "all_paragraphs": ["Living in a large city comes with the benefit of a large range of options for getting around. In Chicago, Divvy is the bike sharing company that has over 600 stations throughout the city \u2014 though, often, you may find those stations empty, especially in crowded and popular areas. This can be detrimental to both the company and the customers looking for a cheap, efficient and healthy way to move in the city.", "When looking to apply skills learned from our Masters of Analytics\u2019 Optimization class, our group \u2014 composed of Amy Lin, Divya Ravindran, Grace Yin and Luis Flosi \u2014 decided to tackle the issue of finding the best route for a single Divvy van to travel between select bike stations, collecting and redistributing bikes to minimize the lost opportunity of missing bikes when customers most require them. Fortunately, Divvy has made data publicly available on all trips taken by its bikes in Chicago\u2019s Data Portal. We also collected weather data from Dark Sky to enrich our models. Our final code repository can be found on GitHub.", "We will start by understanding the data, then creating predictive models to understand demand and supply between stations, and finally optimize distribution routes based on two different approaches: linear programming and simulated annealing.", "The data was imported, cleaned and structured during a previous project from a group which Amy was a part of. Our focus was on understanding patterns of ridership between days of the week, hours and months and how those changes might impact the number of bikes in a station.", "What we found was that during peak hours, a considerable number of stations became empty or full. We also found that weekdays have very different patterns than weekends. Finally, seasons also have a big impact on the total number of trips taken, since Chicago can have very harsh winters. The analysis was headed by Amy, who produced the following graphs:", "We identified how our model would be able to solve the problem given the information we had available and what we could reasonably assume:", "Given this scenario, we realized that the main model input that was missing is the forecasted demand for each station at any given day.", "In order to estimate demand, Divya, Grace and Luis created two predictive poisson models that would estimate the number of bikes arriving and leaving each station. They take into account the weather conditions, month, hour and day of the week.", "Although the models showed near-zero chi-square p-value, they also performed well with the test set, showing errors that ranged between -1 to 5 predicted trips. The p-value test can be misleading when predicting low-value rates, so we decided to use this model for predicted trips. However, in a real-life situation, we would certainly develop this model further to be more robust.", "From the models above, we restricted their trips predictions to consider each station\u2019s bike capacity. Finally, we utilized the 95% upper level of forecasted leaving trips as the actual number of trips leaving. We decided to consider the upper level to ensure that there would be no shortage of bikes on most days.", "For the optimization model, we define demand as the number of bikes that need to be transported to a station so it can fulfill all customer trips. A positive demand means that a station has a surplus of bikes for a timeframe. With that in mind, we define demand as:", "Where D = demand, B = bikes available at start of timeframe T, A is the number of bikes arriving during timeframe T and UL as the upper-bound estimation of the number of bikes leaving the station during timeframe T.", "From the number of trips arriving and leaving each station, we were able to aggregate the hourly numbers into the pre-defined timeframes where the optimizations will take place. From there, we only needed to calculate the number of bikes actually available at each station at start of time T (considering post-optimization changes).", "For T = midnight, we assume that the number of bikes available is always the same, equal to the average of the historic period at midnight since Divvy has historically performed allocations at that time. From then, each time frame will have the number of bikes that will be considered: previous timeframe\u2019s allocation results (number of bikes actually available); \u201cA\u201d for the previous timeframe and average of bikes that left the station (NOT the upper-bound).", "Where O is the optimized number of bikes available on the previous timeframe T, A is the number of bikes arriving at station in the previous timeframe and L is the average number of bikes leaving as predicted by the model for the previous time frame.", "We repeat this process for every new timeframe, calculating the optimization model\u2019s input D each time.", "We used two different approaches to optimize the routes for bike allocation. The first is a linear programming problem solved using Julia\u2019s Gurobi solver, and the second is solved using the Simulated Annealing (SA) technique inspired by this research paper\u2019s results that showed that SA can be used to solve VRP problems with much fewer computations.", "Both solutions take into account the same objective function, derived by Amy. We minimize the sum of absolute differences between the expected station inventory and actual inventory after optimization:", "The linear programming solution requires the definition of constraints to which the objective function will be subject to. The constraints not only need to define capacity (such as van and station capacities), but also create route connections and establish distances as the \u201ccost\u201d, for which there will be a maximum cost attainable (meaning the total time a van can travel before the timeframe expires). The functions below were also derived by Amy with support from the rest of the team:", "The main weakness of the previous approach is that it can be extremely computationally intensive. Not only would it take hours or days to run the optimization for all stations at once, there are some cases where as few as 20 stations can take hours to process.", "The paper previously mentioned has found an alternative to a similar VRP model using simulated annealing, an algorithm that randomly selects solutions and evaluates them until it can find the optimal solution. The unique approach of the algorithm, however, is that it allows \u201cbad\u201d solutions in order to escape a local optimum.", "Once we were finished with the scope set by the Optimization class for a final project, we decided to go one step further and implement the SA algorithm in our data to find solutions to scenarios where we had difficulty processing. Even though we only implemented a limited, first-draft version of the SA, we had great results running cases that once took us hours to process using only a few minutes.", "The adaptation of SA for our specific case was made by Luis, and is outlined here. The code can be found in our repository.", "To demonstrate our results, Divya and Grace chose one \u201cdefault\u201d summer day with good visibility during a weekday at the 7pm timeframe, with 29 random stations across Chicago. After Amy processed this case with our linear model, they worked together to produced the following image to demonstrate the resulting route:", "Note that the optimization could be run on any given situation, as long as it has the inputs for demand, capacity constraints and distance / travel time. Also, this is the result from our Winter Quarter presentation, where we used a prior predictive model. Since then, the model was improved as can be seen in our GitHub page.", "In a real-life situation, this could be run ahead of time on any given day to create dynamic routes for vans to optimize bike distributions for a regular work day, weekends, summer or winter, and even extraordinary event days. This would allow Divvy to properly assign bikes the best and fastest way possible, maximizing not only their opportunities but overall customer satisfaction.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Scientist with a passion for entertainment and tech. Previously worked in finance and games industry, and currently pursuing a Masters in Analytics."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F81f17b13a4a5&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Foptimizing-bike-sharing-allocation-routes-in-chicago-81f17b13a4a5&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Foptimizing-bike-sharing-allocation-routes-in-chicago-81f17b13a4a5&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Foptimizing-bike-sharing-allocation-routes-in-chicago-81f17b13a4a5&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Foptimizing-bike-sharing-allocation-routes-in-chicago-81f17b13a4a5&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----81f17b13a4a5--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----81f17b13a4a5--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@du.luis10?source=post_page-----81f17b13a4a5--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@du.luis10?source=post_page-----81f17b13a4a5--------------------------------", "anchor_text": "Luis Flosi"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Faa6f64ed8d94&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Foptimizing-bike-sharing-allocation-routes-in-chicago-81f17b13a4a5&user=Luis+Flosi&userId=aa6f64ed8d94&source=post_page-aa6f64ed8d94----81f17b13a4a5---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F81f17b13a4a5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Foptimizing-bike-sharing-allocation-routes-in-chicago-81f17b13a4a5&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F81f17b13a4a5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Foptimizing-bike-sharing-allocation-routes-in-chicago-81f17b13a4a5&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://data.cityofchicago.org/", "anchor_text": "Data Portal"}, {"url": "https://github.com/LuisFlosi/Shared-Bikes-Optimization", "anchor_text": "GitHub"}, {"url": "http://apiems2016.conf.tw/site/userdata/1087/papers/0381.pdf", "anchor_text": "this"}, {"url": "https://medium.com/tag/optimization?source=post_page-----81f17b13a4a5---------------optimization-----------------", "anchor_text": "Optimization"}, {"url": "https://medium.com/tag/allocation?source=post_page-----81f17b13a4a5---------------allocation-----------------", "anchor_text": "Allocation"}, {"url": "https://medium.com/tag/simulated-annealing?source=post_page-----81f17b13a4a5---------------simulated_annealing-----------------", "anchor_text": "Simulated Annealing"}, {"url": "https://medium.com/tag/linear-programming?source=post_page-----81f17b13a4a5---------------linear_programming-----------------", "anchor_text": "Linear Programming"}, {"url": "https://medium.com/tag/towards-data-science?source=post_page-----81f17b13a4a5---------------towards_data_science-----------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F81f17b13a4a5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Foptimizing-bike-sharing-allocation-routes-in-chicago-81f17b13a4a5&user=Luis+Flosi&userId=aa6f64ed8d94&source=-----81f17b13a4a5---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F81f17b13a4a5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Foptimizing-bike-sharing-allocation-routes-in-chicago-81f17b13a4a5&user=Luis+Flosi&userId=aa6f64ed8d94&source=-----81f17b13a4a5---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F81f17b13a4a5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Foptimizing-bike-sharing-allocation-routes-in-chicago-81f17b13a4a5&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----81f17b13a4a5--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F81f17b13a4a5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Foptimizing-bike-sharing-allocation-routes-in-chicago-81f17b13a4a5&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----81f17b13a4a5---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----81f17b13a4a5--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----81f17b13a4a5--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----81f17b13a4a5--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----81f17b13a4a5--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----81f17b13a4a5--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----81f17b13a4a5--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----81f17b13a4a5--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----81f17b13a4a5--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@du.luis10?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@du.luis10?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Luis Flosi"}, {"url": "https://medium.com/@du.luis10/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "13 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Faa6f64ed8d94&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Foptimizing-bike-sharing-allocation-routes-in-chicago-81f17b13a4a5&user=Luis+Flosi&userId=aa6f64ed8d94&source=post_page-aa6f64ed8d94--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fusers%2Faa6f64ed8d94%2Flazily-enable-writer-subscription&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Foptimizing-bike-sharing-allocation-routes-in-chicago-81f17b13a4a5&user=Luis+Flosi&userId=aa6f64ed8d94&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}