{"url": "https://towardsdatascience.com/did-melania-really-tweet-that-d8038e91e67f", "time": 1682993426.377533, "path": "towardsdatascience.com/did-melania-really-tweet-that-d8038e91e67f/", "webpage": {"metadata": {"title": "Did Melania Really Tweet That?. My models say uh-uh. | by Jason Peterson | Towards Data Science", "h1": "Did Melania Really Tweet That?", "description": "Melania is back! After 24 days out of the public eye, she attended a White House ceremony earlier this week, or at least her body double did. ;) Her absence had stirred a lot of speculation in the\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.rt.com/usa/428833-melania-trump-body-double/", "anchor_text": "or at least her body double did", "paragraph_index": 0}, {"url": "http://www.newsweek.com/melania-trump-silence-tweet-first-lady-950210", "anchor_text": "it didn\u2019t sound like her", "paragraph_index": 2}, {"url": "https://en.wikipedia.org/wiki/Primary_Colors_(novel)", "anchor_text": "made the case that it was the columnist Joe Klein who wrote the book", "paragraph_index": 3}, {"url": "https://www.newyorker.com/magazine/2012/07/23/words-on-trial", "anchor_text": "but it has something to do with tallying word frequencies", "paragraph_index": 4}, {"url": "http://twlets.com/", "anchor_text": "Twlets.com", "paragraph_index": 6}, {"url": "https://twitter.com/melaniatrump?lang=en", "anchor_text": "Melania\u2019s personal tweets", "paragraph_index": 14}, {"url": "https://github.com/AcademiaSinicaNLPLab/sentiment_dataset/blob/master/preprocess.py", "anchor_text": "this one", "paragraph_index": 15}, {"url": "https://en.wikipedia.org/wiki/Tf%E2%80%93idf", "anchor_text": "Wikipedia definition for TF-IDF", "paragraph_index": 21}, {"url": "https://en.wikipedia.org/wiki/Proportionality_(mathematics)", "anchor_text": "proportionally", "paragraph_index": 22}, {"url": "https://www.analyticsvidhya.com/blog/2017/06/word-embeddings-count-word2veec/", "anchor_text": "this post", "paragraph_index": 29}, {"url": "http://nadbordrozd.github.io/blog/2016/05/20/text-classification-with-word2vec/", "anchor_text": "here", "paragraph_index": 42}], "all_paragraphs": ["Melania is back! After 24 days out of the public eye, she attended a White House ceremony earlier this week, or at least her body double did. ;)", "Her absence had stirred a lot of speculation in the media, which she addressed in a tweet on May 30th.", "The trouble was that the tweet didn\u2019t quash speculation as to her whereabouts because it didn\u2019t sound like her. Uncharacteristically angry in tone, it sounded a lot more like Trump. (Or at least it sounded more like Trump\u2019s people than her people.)", "It reminded me of the 90s mystery around who wrote the anonymous book Primary Colors, a thinly-veiled work of fiction \u2014 too thin for some\u2014set in the Clinton White House. A Vassar lit prof and self-styled \u201cforensic linguist\u201d and \u201cstylometrician\u201d made the case that it was the columnist Joe Klein who wrote the book. And later Klein admitted that he did.", "That prof is circumspect about his exact methodologies for inferring authorship (and he\u2019s been wrong as often as right), but it has something to do with tallying word frequencies. (Ring any bells?)", "It all inspired me to conduct a quick Python experiment to try to answer the question of who really wrote the angry tweet above.", "Twlets.com makes this step very easy. You install a Chrome app, visit the Twitter user\u2019s page who\u2019s tweets you want, and click the toolbar icon to download.", "There\u2019s a max number of tweets you can download before you hit a paywall, but its high enough that I was able to download all official POTUS and FLOTUS tweets.", "As of a couple days ago, Melania had only 307 tweets from her official FLOTUS account, versus Trump\u2019s 3,259 tweets from his POTUS account.", "Graphically (just for fun), that imbalance looks like this.", "That\u2019s a lot of orange marbles for The Donald and too few cyan ones for Melania. A more than 10\u2013to-1 imbalance.", "An imbalance like this makes it hard to gauge the accuracy of a model in development. The simplest model, given this imbalance, is to, by default, classify all inputs as belonging to the Trump class, the majority class.", "All of Melania\u2019s tweets will be misclassified by this simple model, but you\u2019ll still have an accuracy rate that is better than 91%.", "We need then to make a model that is much more accurate than 91%. I\u2019m not sure we\u2019ll get there for this little experiment, but that would be the goal.", "(Better would be to balance the data. Were I doing this again, and had I not already blown through my free tweet downloads via Twlets, I would mix some of Melania\u2019s personal tweets in with her official tweets, so as to have as many Melania samples as we have Trump samples. I\u2019ll leave that exercise to future researchers.)", "We need to remove special characters and capitalization from the tweets before vectorizing them. I just used the simple function called clean_str found in many Github NLP repos such as this one.", "I used 85% of my data for training and the remaining 15% for testing (I didn\u2019t use a dev set for this little experiment). That gave me a training set with 2,769 samples and a test set with 489 samples, each a labeled, randomized mix of Trump and Melania tweets.", "The tweet who\u2019s authorship is in question we\u2019ll withhold from both the training and test set. We\u2019ll ask for a prediction for it at the very end of this exercise.", "We need to convert the words in these tweets to numbers so we can feed a classifier of some sort.", "I tried two vectorization techniques, one old, one newer.", "This technique dates from the 1950s. That Vassar prof from the 90s on the trail of Joe Klein would have had this technique at his disposal and almost certainly made use of it.", "The Wikipedia definition for TF-IDF is easy enough to understand:", "The tf-idf value increases proportionally to the number of times a word appears in the document and is offset by the frequency of the word in the corpus, which helps to adjust for the fact that some words appear more frequently in general.", "So, the more times a word appears in a document the higher will be its score. But we subtract from that score if that same word is also common throughout all the documents (the corpus). This weeds out very common words (articles, prepositions, to-be conjugations, etc.), leaving us with high scores for what should be the significant words in a given document.", "This was the technique used to make the pretty wordclouds at the intro. Each word represents a whole tweet from either Trump or Melania. That word was chosen because it has the highest TF-IDF score of all the words in the tweet.", "The sklearn library in Python makes TF-IDF vectorization dead simple. In a couple of lines we can turn the training set into a big sparse array with dimensions that equal number of samples X number of features. Each of those features stands for a word that appears somewhere in the corpus, represented as a TF-IDF score.", "For most documents, most features will have null values because the associated word appears nowhere in the document. Non-null features represent words that appear somewhere in the document, weighted according to how many times they appear in the given document versus the larger corpus.", "These arrays are grist that any model can chew on. That model can be an older-style support vector machine (SVM) or a newer style neural network, a convolutional neural network (ConvNet) or a recurrent neural network (RNN).", "TF-IDF is basically word tallying. It does not capture meaning. Word embeddings attempt to capture meaning.", "They\u2019re complicated to explain, but this post does a good job of it. The gist is that deep learning techniques can be used to digest a whole corpus of words into a low-dimensional embedded matrix. That matrix will be as wide as the number of words in the corpus, but reduced in height to 100 or 300, say. It will, given enough words, almost magically preserve the context in which words tend to get used.", "If we query the model holding this matrix with a word, we\u2019ll get back its 100 or 300 high column vector. These are the embeddings the model has learned for this particular word.", "In the case of documents, such as our tweets, we can query the model for every word in the tweet and then do something as simple as averaging the vectors to create the final input.", "The Gensim library makes it easy-peasy to to learn embeddings in Python.", "Trouble is our training corpus is tiny (7,583 words). That means it\u2019s going to be very dumb in the semantic sense.", "If we ask the model for words similar to, say, \u201cmedia\u201d (yeah, you can do that with this sort of model!), it gives us back some not very semantically related results.", "The cool thing is though that we can load pre-trained models that have been fed very large corpora (Wikipedia pages, say). If we do that, we do get back semantically related results", "We\u2019ve got words now turned into numeric features. We can use those features to train any sort of classification model we like. I used sklearn\u2019s stochastic gradient descent (SGD) classifier, because I wanted to do some super fast training, but, again, you could use something more advanced as well (a ConvNet, say).", "Let\u2019s train an SGD classifier on both the TF-IDF sparse matrices and the pre-trained word embedding vectors.", "We\u2019ve got a couple of trained classification models now. Let\u2019s throw our test samples at the them and see how they perform. Remember we want better accuracy than our baseline of 91%.", "We TF-IDF vectorize the test samples, feed them to the SGD classifier and then evaluation the predictions versus ground-truth labels.", "95.09%! Not amazing, but better than our baseline. And that\u2019s with the old tech.", "How about with the new tech that uses semantically smarter input features?", "A mere 88.75%. Worse than our baseline in fact. The semantic context to the features didn\u2019t help much with our classification challenge. And, if you glance around the Internet, you\u2019ll see quite a few posts (like this one here) where old-skool TF-IDF beats the newer techniques.", "We\u2019ve got one classification model that beats our baseline accuracy and another that doesn\u2019t. Let\u2019s ask them both who they think wrote the tweet.", "First, the TF-IDF fed model . . .", "We vectorize the single tweet in question and get back the prediction.", "Note from the printout of the input tweet, it was labeled with a \u201c1\u201d, as were all Melania tweets.", "But the classifier predicts a \u201c0\u201d label for it, meaning that it thinks Trump wrote it.", "From the printed log probabilities, we can see that it says there\u2019s 71.08% chance that he did.", "What about that lower performing network? We don\u2019t really trust it because of it\u2019s lower-than-baseline accuracy, but let\u2019s ask it anyway.", "There are plenty of caveats to all this.", "In short, none of this would hold up in a court of law. This is meant as fun for data geeks.", "All we can say for sure is that a lot of people\u2019s intuition (mine included) said that the tweet didn\u2019t sound like a Melania tweet, and that one reasonably accurate model produces a data point in favor of these intuitions.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "I like graphs. And drones. Machine Learning too."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fd8038e91e67f&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdid-melania-really-tweet-that-d8038e91e67f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdid-melania-really-tweet-that-d8038e91e67f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdid-melania-really-tweet-that-d8038e91e67f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdid-melania-really-tweet-that-d8038e91e67f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----d8038e91e67f--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----d8038e91e67f--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@jasonpeterson?source=post_page-----d8038e91e67f--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@jasonpeterson?source=post_page-----d8038e91e67f--------------------------------", "anchor_text": "Jason Peterson"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F2aed1312dec8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdid-melania-really-tweet-that-d8038e91e67f&user=Jason+Peterson&userId=2aed1312dec8&source=post_page-2aed1312dec8----d8038e91e67f---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fd8038e91e67f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdid-melania-really-tweet-that-d8038e91e67f&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fd8038e91e67f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdid-melania-really-tweet-that-d8038e91e67f&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://amueller.github.io/word_cloud/auto_examples/a_new_hope.html", "anchor_text": "this code example"}, {"url": "https://www.rt.com/usa/428833-melania-trump-body-double/", "anchor_text": "or at least her body double did"}, {"url": "http://www.newsweek.com/melania-trump-silence-tweet-first-lady-950210", "anchor_text": "it didn\u2019t sound like her"}, {"url": "https://en.wikipedia.org/wiki/Primary_Colors_(novel)", "anchor_text": "made the case that it was the columnist Joe Klein who wrote the book"}, {"url": "https://www.newyorker.com/magazine/2012/07/23/words-on-trial", "anchor_text": "but it has something to do with tallying word frequencies"}, {"url": "http://twlets.com/", "anchor_text": "Twlets.com"}, {"url": "https://twitter.com/melaniatrump?lang=en", "anchor_text": "Melania\u2019s personal tweets"}, {"url": "https://github.com/AcademiaSinicaNLPLab/sentiment_dataset/blob/master/preprocess.py", "anchor_text": "this one"}, {"url": "https://en.wikipedia.org/wiki/Tf%E2%80%93idf", "anchor_text": "Wikipedia definition for TF-IDF"}, {"url": "https://en.wikipedia.org/wiki/Proportionality_(mathematics)", "anchor_text": "proportionally"}, {"url": "https://www.analyticsvidhya.com/blog/2017/06/word-embeddings-count-word2veec/", "anchor_text": "this post"}, {"url": "http://nadbordrozd.github.io/blog/2016/05/20/text-classification-with-word2vec/", "anchor_text": "here"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----d8038e91e67f---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/nlp?source=post_page-----d8038e91e67f---------------nlp-----------------", "anchor_text": "NLP"}, {"url": "https://medium.com/tag/trump?source=post_page-----d8038e91e67f---------------trump-----------------", "anchor_text": "Trump"}, {"url": "https://medium.com/tag/melania-trump?source=post_page-----d8038e91e67f---------------melania_trump-----------------", "anchor_text": "Melania Trump"}, {"url": "https://medium.com/tag/visualization?source=post_page-----d8038e91e67f---------------visualization-----------------", "anchor_text": "Visualization"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fd8038e91e67f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdid-melania-really-tweet-that-d8038e91e67f&user=Jason+Peterson&userId=2aed1312dec8&source=-----d8038e91e67f---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fd8038e91e67f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdid-melania-really-tweet-that-d8038e91e67f&user=Jason+Peterson&userId=2aed1312dec8&source=-----d8038e91e67f---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fd8038e91e67f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdid-melania-really-tweet-that-d8038e91e67f&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----d8038e91e67f--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fd8038e91e67f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdid-melania-really-tweet-that-d8038e91e67f&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----d8038e91e67f---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----d8038e91e67f--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----d8038e91e67f--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----d8038e91e67f--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----d8038e91e67f--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----d8038e91e67f--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----d8038e91e67f--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----d8038e91e67f--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----d8038e91e67f--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@jasonpeterson?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@jasonpeterson?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Jason Peterson"}, {"url": "https://medium.com/@jasonpeterson/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "182 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F2aed1312dec8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdid-melania-really-tweet-that-d8038e91e67f&user=Jason+Peterson&userId=2aed1312dec8&source=post_page-2aed1312dec8--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fusers%2F2aed1312dec8%2Flazily-enable-writer-subscription&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdid-melania-really-tweet-that-d8038e91e67f&user=Jason+Peterson&userId=2aed1312dec8&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}