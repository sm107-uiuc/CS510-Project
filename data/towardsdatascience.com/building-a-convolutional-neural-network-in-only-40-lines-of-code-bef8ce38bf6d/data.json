{"url": "https://towardsdatascience.com/building-a-convolutional-neural-network-in-only-40-lines-of-code-bef8ce38bf6d", "time": 1683007373.6889431, "path": "towardsdatascience.com/building-a-convolutional-neural-network-in-only-40-lines-of-code-bef8ce38bf6d/", "webpage": {"metadata": {"title": "Building a Convolutional Neural Network in only 40 lines of code | by Fran\u00e7ois St-Amant | Towards Data Science", "h1": "Building a Convolutional Neural Network in only 40 lines of code", "description": "Convolutional Neural Networks can be confusing and intimidating for anyone getting into deep learning. In this article, I will show that building a simple CNN is actually quite easy. Keras is a\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.kaggle.com/slothkong/10-monkey-species", "anchor_text": "https://www.kaggle.com/slothkong/10-monkey-species", "paragraph_index": 3}], "all_paragraphs": ["Convolutional Neural Networks can be confusing and intimidating for anyone getting into deep learning. In this article, I will show that building a simple CNN is actually quite easy.", "First, we need to import the modules.", "Keras is a high-level Python neural networks library that runs on top of Tensorflow. Its simple architecture, readability and overall ease of use make it one of the most popular library when it comes to deep learning with Python.", "For this article, I used the \u201c10 monkey species\u201d dataset, available on Kaggle here: https://www.kaggle.com/slothkong/10-monkey-species. It contains 1098 training images and 272 validation images, separated in 10 classes of monkeys.", "Before we begin, make sure the images are stored properly. The structure seen below is necessary for the flow_from_directory function (which we will get to soon) to work.", "Now we begin. First, we have to specify the paths of the images, as well as their target size.", "We then create our generators, which will allow us to do data augmentation and scaling of the images. Be careful to only augment training images, but rescale everything. Rescaling is necessary because having every image in the same [0,1] range will mean that they contribute more evenly during training.", "As a clarification, be mindful that the ImageDataGenerator function does not create new images. Rather, it modifies some of our current training images so that the model is trained on a bigger variety of samples. This helps in avoiding overfitting and it makes the model more apt to predict the class of new monkeys.", "We can then import the images. The flow_from_directory function finds the images in their specified path and resizes them to their target size.", "Epochs and batch size are two very important hyperparameters. One epoch is done when the entire dataset has passed through the network. The batch size is the number of images processed before the model is updated. Adjusting those parameters drastically changes the speed and length of the training.", "We can then build the model itself. Here, I create an extremely simple model, with only one convolution layer and one pooling layer in addition to the input/output layers. Obviously, a more complex model would help improving performance and adding layers is extremely simple, but for this tutorial, I will leave it at that.", "The first convolutional layer requires an input shape, i.e. the shape of the images. The last layer of this CNN uses the softmax activation function, which is appropriate when we have multiple classes (we have 10 here), as it allows the model to calculate probabilities an image belongs to each class. Finally, the model.compile function allows us to specify how the model will learn during training.", "We can then fit the model and evaluate performance on the validation set.", "This super simple model achieves an accuracy of almost 63% on the validation set after only 20 epochs!", "In practice, it would make sense to have many more epochs and to let the model train for as long as it improves.", "There you have it, a Convolutional Neural Network, from start to finish in only 40 lines of code. Not so intimidating anymore is it? Thanks a lot for reading!", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fbef8ce38bf6d&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-a-convolutional-neural-network-in-only-40-lines-of-code-bef8ce38bf6d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-a-convolutional-neural-network-in-only-40-lines-of-code-bef8ce38bf6d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-a-convolutional-neural-network-in-only-40-lines-of-code-bef8ce38bf6d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-a-convolutional-neural-network-in-only-40-lines-of-code-bef8ce38bf6d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----bef8ce38bf6d--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----bef8ce38bf6d--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://francoisstamant.medium.com/?source=post_page-----bef8ce38bf6d--------------------------------", "anchor_text": ""}, {"url": "https://francoisstamant.medium.com/?source=post_page-----bef8ce38bf6d--------------------------------", "anchor_text": "Fran\u00e7ois St-Amant"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F4f8974d28029&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-a-convolutional-neural-network-in-only-40-lines-of-code-bef8ce38bf6d&user=Fran%C3%A7ois+St-Amant&userId=4f8974d28029&source=post_page-4f8974d28029----bef8ce38bf6d---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fbef8ce38bf6d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-a-convolutional-neural-network-in-only-40-lines-of-code-bef8ce38bf6d&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fbef8ce38bf6d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-a-convolutional-neural-network-in-only-40-lines-of-code-bef8ce38bf6d&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/s/photos/monkeys", "anchor_text": "Source"}, {"url": "https://www.kaggle.com/slothkong/10-monkey-species", "anchor_text": "https://www.kaggle.com/slothkong/10-monkey-species"}, {"url": "https://medium.com/tag/convolutional-neural-net?source=post_page-----bef8ce38bf6d---------------convolutional_neural_net-----------------", "anchor_text": "Convolutional Neural Net"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----bef8ce38bf6d---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/python?source=post_page-----bef8ce38bf6d---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/keras?source=post_page-----bef8ce38bf6d---------------keras-----------------", "anchor_text": "Keras"}, {"url": "https://medium.com/tag/tutorial?source=post_page-----bef8ce38bf6d---------------tutorial-----------------", "anchor_text": "Tutorial"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fbef8ce38bf6d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-a-convolutional-neural-network-in-only-40-lines-of-code-bef8ce38bf6d&user=Fran%C3%A7ois+St-Amant&userId=4f8974d28029&source=-----bef8ce38bf6d---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fbef8ce38bf6d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-a-convolutional-neural-network-in-only-40-lines-of-code-bef8ce38bf6d&user=Fran%C3%A7ois+St-Amant&userId=4f8974d28029&source=-----bef8ce38bf6d---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fbef8ce38bf6d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-a-convolutional-neural-network-in-only-40-lines-of-code-bef8ce38bf6d&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----bef8ce38bf6d--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fbef8ce38bf6d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-a-convolutional-neural-network-in-only-40-lines-of-code-bef8ce38bf6d&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----bef8ce38bf6d---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----bef8ce38bf6d--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----bef8ce38bf6d--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----bef8ce38bf6d--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----bef8ce38bf6d--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----bef8ce38bf6d--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----bef8ce38bf6d--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----bef8ce38bf6d--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----bef8ce38bf6d--------------------------------", "anchor_text": ""}, {"url": "https://francoisstamant.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://francoisstamant.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Fran\u00e7ois St-Amant"}, {"url": "https://francoisstamant.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "501 Followers"}, {"url": "https://francoisstamant.medium.com/membership", "anchor_text": "https://francoisstamant.medium.com/membership"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F4f8974d28029&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-a-convolutional-neural-network-in-only-40-lines-of-code-bef8ce38bf6d&user=Fran%C3%A7ois+St-Amant&userId=4f8974d28029&source=post_page-4f8974d28029--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fc94c3a4f2e83&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-a-convolutional-neural-network-in-only-40-lines-of-code-bef8ce38bf6d&newsletterV3=4f8974d28029&newsletterV3Id=c94c3a4f2e83&user=Fran%C3%A7ois+St-Amant&userId=4f8974d28029&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}