{"url": "https://towardsdatascience.com/basic-data-analysis-techniques-every-data-analyst-should-know-part-ii-412e28af849d", "time": 1682996369.488863, "path": "towardsdatascience.com/basic-data-analysis-techniques-every-data-analyst-should-know-part-ii-412e28af849d/", "webpage": {"metadata": {"title": "Basic data analysis techniques every data analyst should know using Python, part II. | by Erfan Nariman | Towards Data Science", "h1": "Basic data analysis techniques every data analyst should know using Python, part II.", "description": "This is the follow-up of the series Basic data analysis technique, every data analyst should know. For those who haven't read part one yet, find it here. In part I we introduced the first set of\u2026"}, "outgoing_paragraph_urls": [{"url": "https://towardsdatascience.com/basic-data-analysis-techniques-every-data-analyst-should-know-using-python-4de80ab52396", "anchor_text": "here.", "paragraph_index": 0}, {"url": "http://pandas.pydata.org/pandas-docs/stable/", "anchor_text": "pandas", "paragraph_index": 3}, {"url": "https://docs.scipy.org/doc/numpy/reference/", "anchor_text": "numpy", "paragraph_index": 3}, {"url": "https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.astype.html", "anchor_text": "Series.astype", "paragraph_index": 13}, {"url": "https://docs.scipy.org/doc/numpy-1.13.0/reference/arrays.datetime.html", "anchor_text": "here.", "paragraph_index": 25}, {"url": "https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.pivot_table.html", "anchor_text": "pivot_table", "paragraph_index": 29}, {"url": "https://en.wikipedia.org/wiki/Pseudocode", "anchor_text": "pseudocode", "paragraph_index": 35}, {"url": "https://towardsdatascience.com/basic-data-analysis-techniques-every-data-analyst-should-know-using-python-4de80ab52396", "anchor_text": "part I", "paragraph_index": 44}, {"url": "https://pandas.pydata.org/pandas-docs/version/0.23/generated/pandas.core.groupby.DataFrameGroupBy.agg.html", "anchor_text": "aggregate", "paragraph_index": 46}, {"url": "https://github.com/ErfPy/MediumArticles", "anchor_text": "Link", "paragraph_index": 49}], "all_paragraphs": ["This is the follow-up of the series Basic data analysis technique, every data analyst should know. For those who haven't read part one yet, find it here.", "In part I we introduced the first set of techniques a starting data analyst should master, we went over: basic filtering, filtering with multiple conditions, aggregation and joins.", "In this part we will build forth on the first part and introduce a new set of techniques:", "Again we will make use of two Python libraries for our analysis, which are: pandas & numpy. If you haven\u2019t installed these two packages yet, use the following code to install them:", "Each column (Series) in pandas has a type assigned to it, this refers to the type of data which is stored in this column.", "The most basic dtypes in Pandas are the following:", "Why is it crucial to have the right types in each column? Because it will define which actions you can perform on your data.", "For example, whenever a column is defined as string you cannot perform calculations on them. For example, we can create a pandas DataFrame with a values column which contains numbers but as object dtype.", "If we check the dtypes of this dataframe with the following code:", "As we can see, our Value column is in object dtype which are strings. So if we try to do a calculation on these values, we will get an error or wrong output:", "For example taking the square of these values:", "And multiplying by 2 will not raise an error, but give us the wrong output:", "The reason it does not raise an error, is because in Python we can concatenate strings by multiplying:", "So to prevent these errors or wrong outputs, we have to convert the type of the columns to the correct ones. And in Pandas we have the Series.astype method for this.", "This method takes the dtype which you want to convert to as an argument:", "Will convert the column to int32 :", "Important note: this is not \u201cinplace\u201d. So we didn\u2019t overwrite the original column in our DataFrame. For that we need the following code:", "If we check the dtypes of our DataFrame again, we can see that the conversion went correctly:", "The conversion of datetime is different from the other dtypes in pandas, since you have many different formats the date can be stored in:", "These are just a couple of the many possibilities and there are formats which can get quite complex. We won\u2019t cover those in these series, but we will in one of my another series called Handling timeseries in Python, which will be published very soon.", "In pandas there are several ways to convert object type to datetime, for now we look at the two most common and used ones:", "Before we dive into some examples, we have to extend our DataFrame with a datetime column first, we can do this with a list of strings that represent dates:", "Which gives us the following DataFrame:", "If we look at the output of print(df.dtypes). We see that our Date column is object type (string).", "The to_datetime function takes a column as input, so in our example it\u2019s df['Date']. The total code looks like the following:", "In our previous examples we used astype to convert string to integer. This time we want datetime64[ns] which is the datetime type from the numpy module as can be found here. So we can pass that to our astype method and convert our strings to datetime:", "Sometimes there\u2019s the need to create certain overviews and to summarize your data in a certain way so it is more readable, plus it\u2019s easier to see valuable information since the data is aggregated.", "Pivoting is one of these techniques that is used a lot in the scenario described above. It gives you the possibility to aggregate data and at the same time transform your data so the index and columns are replaced by the categorical data in two columns from the original dataframe.", "Enough talk, let\u2019s try this method in pandas. First we need a new dataframe, which, as always, we create ourself:", "As we see in our dataframe, each company is repeated three times for each department, which are repeated as well. We can aggregate this data by using pivot_table method in pandas.", "This method takes many arguments which you can find in the documentation, but for now we will look at three of these:", "So in our example it will look like the following:", "When you work with data, there can be the need to add more information to your table based on the columns already present in your table. These columns are called conditional columns since their information depends on other columns.", "If we look at our table about company\u2019s and department size:", "We might want to make a distinction between a big department / small department and define that in a new column called size_indicator.", "For now we put the threshold of a big department on 100. So if we write our logic out in pseudocode, it will look like the following:", "In Python we can apply this logic in several ways, we will look at the two most used methods:", "Since we are going to make use of the numpy module, we have to import this module first:", "In numpy there\u2019s the .where method which works like the following:", "So in our case we have to pass the method the following:", "So that would result in the following:", "List comprehension is a method which can speed up your code significantly compared to a for and if loop while creating lists.", "Same list creation, but with list comprehension:", "Back to our data, we can apply the same logic with the list comprehension to create our Size_indicator column:", "In part I we already took a look at aggregating data with the groupby function in pandas. We were able to apply a single function while applying groupby, for example max or mean of the group.", "In pandas you have to possibility to apply multiple functions while applying groupby to create more extensive overviews.", "This is possible by using the aggregate method. We can pass this method a dictionary with the column name(s) and the function(s) we want to apply:", "As we can see above, we grouped by Company and took the sum and mean of the Employees and the count of Size_indicator.", "So that was it for part II: basic data analysis techniques every data analyst should know, using Python.", "You can find the code of this article on my GitHub in the form of a Jupyter Notebook: Link", "For any questions or other discussion, feel free to comment!", "Expect part III soon, where we look at some new techniques!", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Engineer and Co-founder at Zypp."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F412e28af849d&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbasic-data-analysis-techniques-every-data-analyst-should-know-part-ii-412e28af849d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbasic-data-analysis-techniques-every-data-analyst-should-know-part-ii-412e28af849d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbasic-data-analysis-techniques-every-data-analyst-should-know-part-ii-412e28af849d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbasic-data-analysis-techniques-every-data-analyst-should-know-part-ii-412e28af849d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----412e28af849d--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----412e28af849d--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@erfannariman?source=post_page-----412e28af849d--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@erfannariman?source=post_page-----412e28af849d--------------------------------", "anchor_text": "Erfan Nariman"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fb108b149fb53&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbasic-data-analysis-techniques-every-data-analyst-should-know-part-ii-412e28af849d&user=Erfan+Nariman&userId=b108b149fb53&source=post_page-b108b149fb53----412e28af849d---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F412e28af849d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbasic-data-analysis-techniques-every-data-analyst-should-know-part-ii-412e28af849d&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F412e28af849d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbasic-data-analysis-techniques-every-data-analyst-should-know-part-ii-412e28af849d&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://towardsdatascience.com/tagged/basic-analysis-techniques", "anchor_text": "Basic Analysis Techniques"}, {"url": "https://towardsdatascience.com/basic-data-analysis-techniques-every-data-analyst-should-know-using-python-4de80ab52396", "anchor_text": "here."}, {"url": "http://pandas.pydata.org/pandas-docs/stable/", "anchor_text": "pandas"}, {"url": "https://docs.scipy.org/doc/numpy/reference/", "anchor_text": "numpy"}, {"url": "https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.astype.html", "anchor_text": "Series.astype"}, {"url": "https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.to_datetime.html", "anchor_text": "pandas.to_datetime"}, {"url": "https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.astype.html", "anchor_text": "Series.astype"}, {"url": "https://docs.scipy.org/doc/numpy-1.13.0/reference/arrays.datetime.html", "anchor_text": "here."}, {"url": "https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.pivot_table.html", "anchor_text": "pandas docs"}, {"url": "https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.pivot_table.html", "anchor_text": "pivot_table"}, {"url": "https://en.wikipedia.org/wiki/Pseudocode", "anchor_text": "pseudocode"}, {"url": "https://towardsdatascience.com/basic-data-analysis-techniques-every-data-analyst-should-know-using-python-4de80ab52396", "anchor_text": "part I"}, {"url": "https://pandas.pydata.org/pandas-docs/version/0.23/generated/pandas.core.groupby.DataFrameGroupBy.agg.html", "anchor_text": "aggregate"}, {"url": "https://github.com/ErfPy/MediumArticles", "anchor_text": "Link"}, {"url": "https://medium.com/tag/data-science?source=post_page-----412e28af849d---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/python?source=post_page-----412e28af849d---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/pandas?source=post_page-----412e28af849d---------------pandas-----------------", "anchor_text": "Pandas"}, {"url": "https://medium.com/tag/data-analysis?source=post_page-----412e28af849d---------------data_analysis-----------------", "anchor_text": "Data Analysis"}, {"url": "https://medium.com/tag/basic-analysis-techniques?source=post_page-----412e28af849d---------------basic_analysis_techniques-----------------", "anchor_text": "Basic Analysis Techniques"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F412e28af849d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbasic-data-analysis-techniques-every-data-analyst-should-know-part-ii-412e28af849d&user=Erfan+Nariman&userId=b108b149fb53&source=-----412e28af849d---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F412e28af849d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbasic-data-analysis-techniques-every-data-analyst-should-know-part-ii-412e28af849d&user=Erfan+Nariman&userId=b108b149fb53&source=-----412e28af849d---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F412e28af849d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbasic-data-analysis-techniques-every-data-analyst-should-know-part-ii-412e28af849d&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----412e28af849d--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F412e28af849d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbasic-data-analysis-techniques-every-data-analyst-should-know-part-ii-412e28af849d&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----412e28af849d---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----412e28af849d--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----412e28af849d--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----412e28af849d--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----412e28af849d--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----412e28af849d--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----412e28af849d--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----412e28af849d--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----412e28af849d--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@erfannariman?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@erfannariman?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Erfan Nariman"}, {"url": "https://medium.com/@erfannariman/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "112 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fb108b149fb53&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbasic-data-analysis-techniques-every-data-analyst-should-know-part-ii-412e28af849d&user=Erfan+Nariman&userId=b108b149fb53&source=post_page-b108b149fb53--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F16f53bb15ac6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbasic-data-analysis-techniques-every-data-analyst-should-know-part-ii-412e28af849d&newsletterV3=b108b149fb53&newsletterV3Id=16f53bb15ac6&user=Erfan+Nariman&userId=b108b149fb53&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}