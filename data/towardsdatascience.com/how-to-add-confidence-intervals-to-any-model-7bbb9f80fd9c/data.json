{"url": "https://towardsdatascience.com/how-to-add-confidence-intervals-to-any-model-7bbb9f80fd9c", "time": 1683001320.9414341, "path": "towardsdatascience.com/how-to-add-confidence-intervals-to-any-model-7bbb9f80fd9c/", "webpage": {"metadata": {"title": "How To Add Confidence Intervals to Any Model | by Tyler Folkman | Towards Data Science", "h1": "How To Add Confidence Intervals to Any Model", "description": "It is the first thing your manager asks as you present your latest work. How do you answer? Do you refer to the mean squared error? the R\u00b2 coefficient? How about some example results? These are all\u2026"}, "outgoing_paragraph_urls": [{"url": "https://blogs.sas.com/content/iml/2017/06/28/average-bootstrap-sample-omits-data.html", "anchor_text": "here", "paragraph_index": 4}, {"url": "https://datascienceleadership.substack.com/", "anchor_text": "Get your FREE copy of 11 INCREDIBLY useful resources to MASTER data science", "paragraph_index": 13}, {"url": "https://datascienceleadership.substack.com/", "anchor_text": "https://datascienceleadership.substack.com/", "paragraph_index": 15}], "all_paragraphs": ["It is the first thing your manager asks as you present your latest work. How do you answer? Do you refer to the mean squared error? the R\u00b2 coefficient? How about some example results? These are all great, but I would like to add another technique to your toolkit \u2014 confidence intervals.", "At the end of the day, one of the most important jobs any data scientist has is to help people trust an algorithm that they most likely don\u2019t completely understand.", "One way to help build this trust is to add confidence intervals to your model's predictions. We will define confidence intervals for this article as a way of quantifying the uncertainty of an estimate. This tends to be easier for classification problems. Most algorithms provide probability estimates which can serve as confidence scores. For example, a 90% probability of being a cat should be more confident than a 50% probability.", "For regression problems, though, things tend to get trickier. Most algorithms don\u2019t have a natural way of providing a confidence or probability score. There are many solutions to this problem, one of my favorite being Bayesian models, but I would like to discuss the simplest and easiest method to implement for any machine learning model.", "To start, we first need to define a bootstrap sample. Fortunately, this is easy \u2014 it is a sample of our dataset, with replacement, where the sample size is the same as the dataset size. This means that the average bootstrap sample contains 63.2% of the original observations and omits 36.8%. The omitted 36.8% of the data are duplicated from the 63.2% of the data contained in the sample. You can read more about how these numbers were calculated here.", "This is useful because it is a very simple method by which you can now simulate different underlying datasets while not actually changing the data.", "Here is how you would create 1,000 bootstrap samples of a dataset (assuming your X values are in scaled_df and your labels are in target)", "Once you have 1,000 samples of your data, you can now train your model 1,000 times and obtain different results. The key is that a result is more robust when slight changes to the input data only lead to slight changes in the output. Let\u2019s take a look at our training (using a simple SGD regressor for this example)", "In this example, the result I care about are my model coefficients. You can see in my training loop, that I append them to a list so I can analyze the distribution of the coefficients as seen here:", "What we have are all my features on the x-axis and the distributions (from the 1,000 models) of the coefficients for these features. This can be extremely helpful when trying to understand how much you can trust these coefficient values.", "For example, there are a few variables, such as AGE which span 0. That is not good because not only are you not confident in the point estimate, but you are also not confident in the direction (positive or negative). Other variables, like PTRATIO have a small variance and sit completely on the positive or negative side. These variables give us more confidence.", "You can also define probabilistic ranges. If we look closer at LSTAT we would see the following:", "Hopefully, this was a useful example of how to increase and measure your confidence in any model. While simple, we have demonstrated that bootstrap resampling can be very illuminating and help build trust in your model. This is hardly the only method to provide confidence intervals and I encourage you to use this as a starting point on your quest to build confidence intervals into your models.", "Get your FREE copy of 11 INCREDIBLY useful resources to MASTER data science", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Chief Technology and AI Officer at BEN/TubeBuddy. Get your FREE list of useful data science resources: https://datascienceleadership.substack.com/"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F7bbb9f80fd9c&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-add-confidence-intervals-to-any-model-7bbb9f80fd9c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-add-confidence-intervals-to-any-model-7bbb9f80fd9c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-add-confidence-intervals-to-any-model-7bbb9f80fd9c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-add-confidence-intervals-to-any-model-7bbb9f80fd9c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----7bbb9f80fd9c--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----7bbb9f80fd9c--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@tylerfolkman?source=post_page-----7bbb9f80fd9c--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@tylerfolkman?source=post_page-----7bbb9f80fd9c--------------------------------", "anchor_text": "Tyler Folkman"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F47ca8d25c93f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-add-confidence-intervals-to-any-model-7bbb9f80fd9c&user=Tyler+Folkman&userId=47ca8d25c93f&source=post_page-47ca8d25c93f----7bbb9f80fd9c---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F7bbb9f80fd9c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-add-confidence-intervals-to-any-model-7bbb9f80fd9c&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F7bbb9f80fd9c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-add-confidence-intervals-to-any-model-7bbb9f80fd9c&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@heftiba?utm_source=medium&utm_medium=referral", "anchor_text": "Toa Heftiba"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://blogs.sas.com/content/iml/2017/06/28/average-bootstrap-sample-omits-data.html", "anchor_text": "here"}, {"url": "https://datascienceleadership.substack.com/", "anchor_text": "Get your FREE copy of 11 INCREDIBLY useful resources to MASTER data science"}, {"url": "https://medium.com/tag/data-science?source=post_page-----7bbb9f80fd9c---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----7bbb9f80fd9c---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/technology?source=post_page-----7bbb9f80fd9c---------------technology-----------------", "anchor_text": "Technology"}, {"url": "https://medium.com/tag/programming?source=post_page-----7bbb9f80fd9c---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----7bbb9f80fd9c---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F7bbb9f80fd9c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-add-confidence-intervals-to-any-model-7bbb9f80fd9c&user=Tyler+Folkman&userId=47ca8d25c93f&source=-----7bbb9f80fd9c---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F7bbb9f80fd9c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-add-confidence-intervals-to-any-model-7bbb9f80fd9c&user=Tyler+Folkman&userId=47ca8d25c93f&source=-----7bbb9f80fd9c---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F7bbb9f80fd9c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-add-confidence-intervals-to-any-model-7bbb9f80fd9c&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----7bbb9f80fd9c--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F7bbb9f80fd9c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-add-confidence-intervals-to-any-model-7bbb9f80fd9c&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----7bbb9f80fd9c---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----7bbb9f80fd9c--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----7bbb9f80fd9c--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----7bbb9f80fd9c--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----7bbb9f80fd9c--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----7bbb9f80fd9c--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----7bbb9f80fd9c--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----7bbb9f80fd9c--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----7bbb9f80fd9c--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@tylerfolkman?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@tylerfolkman?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Tyler Folkman"}, {"url": "https://medium.com/@tylerfolkman/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "2.5K Followers"}, {"url": "https://datascienceleadership.substack.com/", "anchor_text": "https://datascienceleadership.substack.com/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F47ca8d25c93f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-add-confidence-intervals-to-any-model-7bbb9f80fd9c&user=Tyler+Folkman&userId=47ca8d25c93f&source=post_page-47ca8d25c93f--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F2ee8b13cc0ac&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-add-confidence-intervals-to-any-model-7bbb9f80fd9c&newsletterV3=47ca8d25c93f&newsletterV3Id=2ee8b13cc0ac&user=Tyler+Folkman&userId=47ca8d25c93f&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}