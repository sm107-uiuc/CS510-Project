{"url": "https://towardsdatascience.com/real-time-face-mask-detector-with-tensorflow-keras-and-opencv-38b552660b64", "time": 1683008052.007932, "path": "towardsdatascience.com/real-time-face-mask-detector-with-tensorflow-keras-and-opencv-38b552660b64/", "webpage": {"metadata": {"title": "Real-Time Face Mask Detector with TensorFlow, Keras, and OpenCV | by Ravindu Senaratne | Towards Data Science", "h1": "Real-Time Face Mask Detector with TensorFlow, Keras, and OpenCV", "description": "In this article, I\u2019ll be using a face mask dataset created by Prajna Bhandary. This dataset consists of 1,376 images belonging to with mask and without mask 2 classes. Our main focus is to detect\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.linkedin.com/feed/update/urn%3Ali%3Aactivity%3A6655711815361761280/", "anchor_text": "Prajna Bhandary", "paragraph_index": 0}, {"url": "https://arxiv.org/abs/1801.04381", "anchor_text": "MobileNetV2", "paragraph_index": 5}, {"url": "https://www.dev47apps.com/", "anchor_text": "DroidCam", "paragraph_index": 8}], "all_paragraphs": ["In this article, I\u2019ll be using a face mask dataset created by Prajna Bhandary. This dataset consists of 1,376 images belonging to with mask and without mask 2 classes.", "Our main focus is to detect whether a person is wearing a mask or not, without getting close to them.", "In simple words, First, we get the image with the face and run it through a cascade classifier. The classifier will give the region of interest of the face (height and width). Secondly, we will resize the region of interest into a 100x100 and pass it to a pre-trained CNN, it will give us the probability as an output.", "The dataset we are using consists of images with different colors, different sizes, and different orientations. Therefore, we need to convert all the images into grayscale because we need to be sure that color should not be a critical point for detecting mask. After that, we need to have all the images in the same size (100x100) before applying it to the neural network.", "This consists of 2 convolutional layers (Two Convo2D 100@3x3). First, you have to load the dataset from data preprocessing. Then you have to configure the convolutional architecture. I\u2019ve included a model.add(Dropout(0.5)) to get rid of overfitting. Since we have two categories(with mask and without mask) we can use binary_crossentropy. You start training for 20 epoch with a model checkpoint.", "Keep in mind, you can use more Convo layers or use external trainers such as MobileNetV2 for better accuracy.", "You can plot the graphs to take better validation decisions. I\u2019ve included it in my repository. Please refer to it.", "First, you have to load the model that we created. Then we set the camera we want as the default.", "Optional \u2014 You can connect your mobile camera (Android/IOS) to OpenCV. Download DroidCam application for both your mobile and PC. And change the code source = cv2.VideoCapture(1)", "Secondly, we need to label the two probabilities (0 forwith_mask and 1 forwithout_mask). After that, we need to set the bounding rectangle color using RGB values. I\u2019ve given RED and GREEN as two colors.", "Inside an infinite loop, we are going to read frame by frame from the camera and convert them to grayscale and detect the faces. And it will be run through a for loop to for each face and detect the region of interest, resize and reshape it to 4D since the training network expects 4D input. For the model, we are going to use the best model available to get the result. This result consists of the probability (result=[P1, P2]) of the with a mask or without a mask. It will be labeled after that.", "You can increase the accuracy if you use MobileNetV2 to fine-tune. We can deploy this model to embedded systems as well. If we deployed it correctly we can help ensure your safety and the safety of others.", "That\u2019s it for the article. I hope it\u2019ll be useful for someone. Thank you and stay safe!", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "AI/ML enthusiast and writer | BSc (Hons) in Information Technology"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F38b552660b64&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Freal-time-face-mask-detector-with-tensorflow-keras-and-opencv-38b552660b64&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Freal-time-face-mask-detector-with-tensorflow-keras-and-opencv-38b552660b64&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Freal-time-face-mask-detector-with-tensorflow-keras-and-opencv-38b552660b64&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Freal-time-face-mask-detector-with-tensorflow-keras-and-opencv-38b552660b64&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----38b552660b64--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----38b552660b64--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@ravindusenaratne?source=post_page-----38b552660b64--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@ravindusenaratne?source=post_page-----38b552660b64--------------------------------", "anchor_text": "Ravindu Senaratne"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Ffa8a7e85927d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Freal-time-face-mask-detector-with-tensorflow-keras-and-opencv-38b552660b64&user=Ravindu+Senaratne&userId=fa8a7e85927d&source=post_page-fa8a7e85927d----38b552660b64---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F38b552660b64&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Freal-time-face-mask-detector-with-tensorflow-keras-and-opencv-38b552660b64&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F38b552660b64&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Freal-time-face-mask-detector-with-tensorflow-keras-and-opencv-38b552660b64&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@macauphotoagency?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Macau Photo Agency"}, {"url": "https://unsplash.com/s/photos/coronavirus?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://www.linkedin.com/feed/update/urn%3Ali%3Aactivity%3A6655711815361761280/", "anchor_text": "Prajna Bhandary"}, {"url": "https://arxiv.org/abs/1801.04381", "anchor_text": "MobileNetV2"}, {"url": "https://www.dev47apps.com/", "anchor_text": "DroidCam"}, {"url": "https://drive.google.com/open?id=1oLIPBOkCuhej-iNTre_qnlQ3b-fWZeEy", "anchor_text": "Face Mask Detector - Google DriveEdit descriptiondrive.google.com"}, {"url": "https://github.com/ravindu9701/Face-Mask-Detector.git", "anchor_text": "ravindu9701/Face-Mask-DetectorContribute to ravindu9701/Face-Mask-Detector development by creating an account on GitHub.github.com"}, {"url": "https://github.com/prajnasb/observations/tree/master/mask_classifier/Data_Generator", "anchor_text": "Prajna\u2019s Github Repo"}, {"url": "https://www.pyimagesearch.com/2020/05/04/covid-19-face-mask-detector-with-opencv-keras-tensorflow-and-deep-learning/", "anchor_text": "Adrian Rosebrock\u2019s Article"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----38b552660b64---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/technology?source=post_page-----38b552660b64---------------technology-----------------", "anchor_text": "Technology"}, {"url": "https://medium.com/tag/startup?source=post_page-----38b552660b64---------------startup-----------------", "anchor_text": "Startup"}, {"url": "https://medium.com/tag/productivity?source=post_page-----38b552660b64---------------productivity-----------------", "anchor_text": "Productivity"}, {"url": "https://medium.com/tag/programming?source=post_page-----38b552660b64---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F38b552660b64&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Freal-time-face-mask-detector-with-tensorflow-keras-and-opencv-38b552660b64&user=Ravindu+Senaratne&userId=fa8a7e85927d&source=-----38b552660b64---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F38b552660b64&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Freal-time-face-mask-detector-with-tensorflow-keras-and-opencv-38b552660b64&user=Ravindu+Senaratne&userId=fa8a7e85927d&source=-----38b552660b64---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F38b552660b64&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Freal-time-face-mask-detector-with-tensorflow-keras-and-opencv-38b552660b64&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----38b552660b64--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F38b552660b64&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Freal-time-face-mask-detector-with-tensorflow-keras-and-opencv-38b552660b64&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----38b552660b64---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----38b552660b64--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----38b552660b64--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----38b552660b64--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----38b552660b64--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----38b552660b64--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----38b552660b64--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----38b552660b64--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----38b552660b64--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@ravindusenaratne?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@ravindusenaratne?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Ravindu Senaratne"}, {"url": "https://medium.com/@ravindusenaratne/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "315 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Ffa8a7e85927d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Freal-time-face-mask-detector-with-tensorflow-keras-and-opencv-38b552660b64&user=Ravindu+Senaratne&userId=fa8a7e85927d&source=post_page-fa8a7e85927d--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fdfcc7c372310&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Freal-time-face-mask-detector-with-tensorflow-keras-and-opencv-38b552660b64&newsletterV3=fa8a7e85927d&newsletterV3Id=dfcc7c372310&user=Ravindu+Senaratne&userId=fa8a7e85927d&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}