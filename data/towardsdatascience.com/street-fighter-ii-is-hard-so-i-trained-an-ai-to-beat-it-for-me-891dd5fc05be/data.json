{"url": "https://towardsdatascience.com/street-fighter-ii-is-hard-so-i-trained-an-ai-to-beat-it-for-me-891dd5fc05be", "time": 1683007750.769356, "path": "towardsdatascience.com/street-fighter-ii-is-hard-so-i-trained-an-ai-to-beat-it-for-me-891dd5fc05be/", "webpage": {"metadata": {"title": "Street Fighter II is Hard, So I Trained an AI To Beat It for Me | by Mehrabi Hasan | Towards Data Science", "h1": "Street Fighter II is Hard, So I Trained an AI To Beat It for Me", "description": "I\u2019ll start off by saying that I am not good at fighting games. Growing up, I would always lose at most games until I came up with the strategy to button smash till I won. Nevertheless, I decided as a\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.linkedin.com/in/mehrabi-hasan/\u2019", "anchor_text": "https://www.linkedin.com/in/mehrabi-hasan/\u2019", "paragraph_index": 18}], "all_paragraphs": ["I\u2019ll start off by saying that I am not good at fighting games. Growing up, I would always lose at most games until I came up with the strategy to button smash till I won. Nevertheless, I decided as a young adult to take on the challenge of Street Fighter II, a beloved game by Capcom. This was one of the games of the \u201990s that inspired a generation of cool-sounding fighting moves and amazing level themes.", "Although the button smashing strategy was effective, I needed a different strategy in order to finish the campaign. Then, after a sudden realization, I managed to land on the idea of training a reinforcement agent to beat it for me. So with the stage set, I decided to take on this journey of training my own model to beat the campaign!", "First, we needed a way to actually implement Street Fighter II into Python. There are a couple of ways to do this, but the simplest way for the sake of time is Gym-Retro. Gym-retro is a Python Package that can transform our game data into a usable environment. Gym-retro comes with premade environments of over 1000 different games. This tool is great because it makes it very simple to implement an artificial agent into the game. It also makes it very simple to extract the actions and rewards for each run.", "The only thing that the initial package was missing are save-states for each level. However, they also released their own integration tool that you can use for this scenario!", "You first need to install it to the folder where you have your gym-retro files and game files. After starting it up, you simply need to take your character to the start of the level which you wanna have a save-state for then export. Short and Simple!", "Finally, after some time, I acquired all the levels which we are going to be using to train our agent. Next, we need to decide on what reinforcement algorithm to use.", "I decided that the algorithm to go with was A2C (Actor Advantage Critic) Model.", "The basic ideas behind this model is that predicting an action for a near-infinite amount of inputs would be almost impossible. So instead we\u2019ll use one neural net, \u201cthe Actor\u201d to explore the current environment and perform an action. Another neural net, \u201cThe Critic\u201d takes the current state and actions and outputs an evaluation. The \u201cActor\u201d then adjusts the probability of performing certain actions based on the \u201cCritics\u201d suggestions. Changing the way the actions are performed is where the advantage comes in. It compares the rewards between the agent performing a certain action versus the average action to take during that state.", "Stable Baselines is the continuation of the initial Baselines Python package by Open AI and features improvements to the original. It includes a number of Reinforcement Learning models to play around with, so definitely check them out! Their A2C model is the one we\u2019ll be utilizing and with that, we have all the moving parts to train our model!", "We\u2019ll be using Google Colab as our Python environment. Using the free version of Colab, we can run a Python notebook on Google\u2019s Cloud Platform and utilize their Tesla K80 GPU for our training. After installing all our packages, its time to create our model. First, we authenticate our Google Drive and import our game files using a Python script included in the Gym-Retro package.", "Next, we\u2019ll create our model. We\u2019ll be using the A2C model we imported earlier on with a CNN policy (best for 2D Game). We\u2019ll also need to initialize our environment by providing which game we\u2019re using as well as what state we want our agent to start at.", "Now for the fun part. We\u2019ll be training our model to actually beat the campaign! The Street Fighter II campaign has Ryu as the only playable character so we\u2019ll be training our model using him. Our model will run through each level 100,000 times and save after each one. Our final results were based on 10 training cycles (1 million iterations for each level). One thing I was curious about was how long the training would take? By utilizing the time package in Python, I was able to see that each training cycle takes about 2 hours.", "After training our model, we\u2019ll want to calculate the amount of reward the agent has gained. We can accomplish this by having the agent play through a level and summing the amount of reward the agent has acquired (Points acquired after winning a match). The model was tested on an easier difficulty than the training, simply because that produced the best results. We\u2019ll also utilize one of the great features in Gym-Retro, which allows you to record your agent playing through the game! The recorded footage is a BK2 file, which can be transformed into an MP4 using another Python script included with Gym-Retro.", "Finally after a long journey, we made an AI capable of beating Street Fighter II! Here is the Video of Ryu_Bot playing through the campaign.", "Although this project gave desirable results, there were a few limitations to this design. First off, this model only works with Ryu. When switching to a separate character, like Guile, the model didn\u2019t perform as well since they have separate inputs for their special moves. For future designs, I would look into training the model using separate characters or comparing and contrasting different reinforcement learning algorithms and seeing which ones perform the best.", "At the end of the day, if you\u2019re curious about getting started using Machine Learning in general, building a RL agent can be very fun and informative. Reinforcement learning has many uses besides video games, like in optimization problems or robotics. There are also a ton of great articles and video series that can help you get started.", "Full Code can be found through Google Colab:", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Student majoring in Data Science that hopes to find new innovations in Big Data and Data Analytics https://www.linkedin.com/in/mehrabi-hasan/\u2019"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F891dd5fc05be&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fstreet-fighter-ii-is-hard-so-i-trained-an-ai-to-beat-it-for-me-891dd5fc05be&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fstreet-fighter-ii-is-hard-so-i-trained-an-ai-to-beat-it-for-me-891dd5fc05be&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fstreet-fighter-ii-is-hard-so-i-trained-an-ai-to-beat-it-for-me-891dd5fc05be&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fstreet-fighter-ii-is-hard-so-i-trained-an-ai-to-beat-it-for-me-891dd5fc05be&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----891dd5fc05be--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----891dd5fc05be--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://hasannehrabia.medium.com/?source=post_page-----891dd5fc05be--------------------------------", "anchor_text": ""}, {"url": "https://hasannehrabia.medium.com/?source=post_page-----891dd5fc05be--------------------------------", "anchor_text": "Mehrabi Hasan"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fd58a90ea805b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fstreet-fighter-ii-is-hard-so-i-trained-an-ai-to-beat-it-for-me-891dd5fc05be&user=Mehrabi+Hasan&userId=d58a90ea805b&source=post_page-d58a90ea805b----891dd5fc05be---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F891dd5fc05be&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fstreet-fighter-ii-is-hard-so-i-trained-an-ai-to-beat-it-for-me-891dd5fc05be&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F891dd5fc05be&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fstreet-fighter-ii-is-hard-so-i-trained-an-ai-to-beat-it-for-me-891dd5fc05be&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@ryanquintal?utm_source=medium&utm_medium=referral", "anchor_text": "Ryan Quintal"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://openai.com/blog/gym-retro/", "anchor_text": "Open AI Gym Retro"}, {"url": "https://en.wikipedia.org/wiki/Reinforcement_learning", "anchor_text": "Algorithm"}, {"url": "https://github.com/hill-a/stable-baselines", "anchor_text": "hill-a/stable-baselinesStable Baselines is a set of improved implementations of reinforcement learning algorithms based on OpenAI Baselines\u2026github.com"}, {"url": "https://giphy.com/gifs/street-fighter-fist-bump-ryu-YwR8wm7KknBok", "anchor_text": "Street Fighter Fist Bump GIF"}, {"url": "https://colab.research.google.com/drive/1cbyrrfqgc2mUu6ZyfYeB20A7-Khksq5-?usp=sharing", "anchor_text": "Google ColaboratoryRyu_Botcolab.research.google.com"}, {"url": "https://retro.readthedocs.io/en/latest/getting_started.html", "anchor_text": "https://retro.readthedocs.io/en/latest/getting_started.html"}, {"url": "https://stable-baselines.readthedocs.io/en/master/", "anchor_text": "https://stable-baselines.readthedocs.io/en/master/"}, {"url": "https://www.youtube.com/watch?v=NyNUYYI-Pdg&t=547s", "anchor_text": "https://www.youtube.com/watch?v=NyNUYYI-Pdg&t=547s"}, {"url": "https://www.youtube.com/channel/UCLA_tAh0hX9bjl6DfCe9OLw", "anchor_text": "https://www.youtube.com/channel/UCLA_tAh0hX9bjl6DfCe9OLw"}, {"url": "https://www.youtube.com/watch?v=O5BlozCJBSE", "anchor_text": "https://www.youtube.com/watch?v=O5BlozCJBSE"}, {"url": "https://medium.com/tag/reinforcement-learning?source=post_page-----891dd5fc05be---------------reinforcement_learning-----------------", "anchor_text": "Reinforcement Learning"}, {"url": "https://medium.com/tag/ai?source=post_page-----891dd5fc05be---------------ai-----------------", "anchor_text": "AI"}, {"url": "https://medium.com/tag/street-fighter-ii?source=post_page-----891dd5fc05be---------------street_fighter_ii-----------------", "anchor_text": "Street Fighter Ii"}, {"url": "https://medium.com/tag/data-science?source=post_page-----891dd5fc05be---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----891dd5fc05be---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F891dd5fc05be&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fstreet-fighter-ii-is-hard-so-i-trained-an-ai-to-beat-it-for-me-891dd5fc05be&user=Mehrabi+Hasan&userId=d58a90ea805b&source=-----891dd5fc05be---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F891dd5fc05be&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fstreet-fighter-ii-is-hard-so-i-trained-an-ai-to-beat-it-for-me-891dd5fc05be&user=Mehrabi+Hasan&userId=d58a90ea805b&source=-----891dd5fc05be---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F891dd5fc05be&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fstreet-fighter-ii-is-hard-so-i-trained-an-ai-to-beat-it-for-me-891dd5fc05be&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----891dd5fc05be--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F891dd5fc05be&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fstreet-fighter-ii-is-hard-so-i-trained-an-ai-to-beat-it-for-me-891dd5fc05be&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----891dd5fc05be---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----891dd5fc05be--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----891dd5fc05be--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----891dd5fc05be--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----891dd5fc05be--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----891dd5fc05be--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----891dd5fc05be--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----891dd5fc05be--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----891dd5fc05be--------------------------------", "anchor_text": ""}, {"url": "https://hasannehrabia.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://hasannehrabia.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Mehrabi Hasan"}, {"url": "https://hasannehrabia.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "14 Followers"}, {"url": "https://www.linkedin.com/in/mehrabi-hasan/\u2019", "anchor_text": "https://www.linkedin.com/in/mehrabi-hasan/\u2019"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fd58a90ea805b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fstreet-fighter-ii-is-hard-so-i-trained-an-ai-to-beat-it-for-me-891dd5fc05be&user=Mehrabi+Hasan&userId=d58a90ea805b&source=post_page-d58a90ea805b--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fusers%2Fd58a90ea805b%2Flazily-enable-writer-subscription&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fstreet-fighter-ii-is-hard-so-i-trained-an-ai-to-beat-it-for-me-891dd5fc05be&user=Mehrabi+Hasan&userId=d58a90ea805b&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}