{"url": "https://towardsdatascience.com/feature-extraction-techniques-d619b56e31be", "time": 1683000804.7617989, "path": "towardsdatascience.com/feature-extraction-techniques-d619b56e31be/", "webpage": {"metadata": {"title": "Feature Extraction Techniques. An end to end guide on how to reduce a\u2026 | by Pier Paolo Ippolito | Towards Data Science", "h1": "Feature Extraction Techniques", "description": "It is nowadays becoming quite common to be working with datasets of hundreds (or even thousands) of features. If the number of features becomes similar (or even bigger!) than the number of\u2026"}, "outgoing_paragraph_urls": [{"url": "https://medium.com/@pierpaoloippolito28/feature-selection-techniques-1bfab5fe0784", "anchor_text": "my previous article", "paragraph_index": 3}, {"url": "https://www.kaggle.com/uciml/mushroom-classification", "anchor_text": "Kaggle Mushroom Classification Dataset", "paragraph_index": 4}, {"url": "https://www.kaggle.com/pierpaolo28/feature-extraction?scriptVersionId=21698205", "anchor_text": "Kaggle", "paragraph_index": 4}, {"url": "https://github.com/pierpaolo28/Artificial-Intelligence-Projects/blob/master/Features%20Analysis/feature-extraction.ipynb", "anchor_text": "my GitHub Account", "paragraph_index": 4}, {"url": "https://towardsdatascience.com/interactive-data-visualization-167ae26016e8", "anchor_text": "Plotly", "paragraph_index": 15}, {"url": "https://medium.com/@pierpaoloippolito28?source=post_page---------------------------", "anchor_text": "follow me on Medium", "paragraph_index": 52}, {"url": "http://eepurl.com/gwO-Dr?source=post_page---------------------------", "anchor_text": "mailing list", "paragraph_index": 52}, {"url": "http://www.compthree.com/blog/autoencoder/", "anchor_text": "http://www.compthree.com/blog/autoencoder/", "paragraph_index": 53}, {"url": "https://linktr.ee/pierpaolo28", "anchor_text": "https://linktr.ee/pierpaolo28", "paragraph_index": 55}], "all_paragraphs": ["It is nowadays becoming quite common to be working with datasets of hundreds (or even thousands) of features. If the number of features becomes similar (or even bigger!) than the number of observations stored in a dataset then this can most likely lead to a Machine Learning model suffering from overfitting. In order to avoid this type of problem, it is necessary to apply either regularization or dimensionality reduction techniques (Feature Extraction). In Machine Learning, the dimensionali of a dataset is equal to the number of variables used to represent it.", "Using Regularization could certainly help reduce the risk of overfitting, but using instead Feature Extraction techniques can also lead to other types of advantages such as:", "Feature Extraction aims to reduce the number of features in a dataset by creating new features from the existing ones (and then discarding the original features). These new reduced set of features should then be able to summarize most of the information contained in the original set of features. In this way, a summarised version of the original features can be created from a combination of the original set.", "Another commonly used technique to reduce the number of feature in a dataset is Feature Selection. The difference between Feature Selection and Feature Extraction is that feature selection aims instead to rank the importance of the existing features in the dataset and discard less important ones (no new features are created). If you are interested in finding out more about Feature Selection, you can find more information about it in my previous article.", "In this article, I will walk you through how to apply Feature Extraction techniques using the Kaggle Mushroom Classification Dataset as an example. Our objective will be to try to predict if a Mushroom is poisonous or not by looking at the given features. All the code used in this post (and more!) is available on Kaggle and on my GitHub Account.", "First of all, we need to import all the necessary libraries.", "The dataset we will be using in this example is shown in the figure below.", "Before feeding this data into our Machine Learning models I decided to divide our data into features (X) and labels (Y) and One Hot Encode all the Categorical Variables.", "Successively, I decided to create a function (forest_test) to divide the input data into train and test sets and then train and test a Random Forest Classifier.", "We can now use this function using the whole dataset and then use it successively to compare these results when using instead of the whole dataset just a reduced version.", "As shown below, training a Random Forest classifier using all the features, led to 100% Accuracy in about 2.2s of training time. In each of the following examples, the training time of each model will be printed out on the first line of each snippet for your reference.", "PCA is one of the most used linear dimensionality reduction technique. When using PCA, we take as input our original data and try to find a combination of the input features which can best summarize the original data distribution so that to reduce its original dimensions. PCA is able to do this by maximizing variances and minimizing the reconstruction error by looking at pair wised distances. In PCA, our original data is projected into a set of orthogonal axes and each of the axes gets ranked in order of importance.", "PCA is an unsupervised learning algorithm, therefore it doesn\u2019t care about the data labels but only about variation. This can lead in some cases to misclassification of data.", "In this example, I will first perform PCA in the whole dataset to reduce our data to just two dimensions and I will then construct a data frame with our new features and their respective labels.", "Using our newly created data frame, we can now plot our data distribution in a 2D scatter plot.", "We can now repeat this same process keeping instead 3 dimensions and creating animations using Plotly (feel free to interact with the animation below!).", "While using PCA, we can also explore how much of the original data variance was preserved using the explained_variance_ratio_ Scikit-learn function. Once calculated the variance ratio, we can then go on creating fancy visualization graphs.", "Running again a Random Forest Classifier using the set of 3 features constructed by PCA (instead of the whole dataset) led to 98% classification accuracy while using just 2 features 95% accuracy.", "Additionally, using our two-dimensional dataset, we can now also visualize the decision boundary used by our Random Forest in order to classify each of the different data points.", "ICA is a linear dimensionality reduction method which takes as input data a mixture of independent components and it aims to correctly identify each of them (deleting all the unnecessary noise). Two input features can be considered independent if both their linear and not linear dependance is equal to zero [1].", "Independent Component Analysis is commonly used in medical applications such as EEG and fMRI analysis to separate useful signals from unhelpful ones.", "As a simple example of an ICA application, let\u2019s consider we are given an audio registration in which there are two different people talking. Using ICA we could, for example, try to identify the two different independent components in the registration (the two different people). In this way, we could make our unsupervised learning algorithm recognise between the different speakers in the conversation.", "Using ICA, we can now again reduce our dataset to just three features, test its accuracy using a Random Forest Classifier and plot the results.", "From the animation below we can see that even though PCA and ICA led to the same accuracy results, they constructed two different 3-Dimensional space distribution.", "LDA is supervised learning dimensionality reduction technique and Machine Learning classifier.", "LDA aims to maximize the distance between the mean of each class and minimize the spreading within the class itself. LDA uses therefore within classes and between classes as measures. This is a good choice because maximizing the distance between the means of each class when projecting the data in a lower-dimensional space can lead to better classification results (thanks to the reduced overlap between the different classes).", "When using LDA, is assumed that the input data follows a Gaussian Distribution (like in this case), therefore applying LDA to not Gaussian data can possibly lead to poor classification results.", "In this example, we will run LDA to reduce our dataset to just one feature, test its accuracy and plot the results.", "Because our data distribution closely follows a Gaussian Distribution, LDA performed really well, in this case, achieving 100% accuracy using a Random Forest Classifier.", "As I mentioned at the beginning of this section, LDA can also be used as a classifier. Therefore, we can now test how an LDA Classifier can perform in this situation.", "Finally, we can now visualize how our two classes distribution looks like creating a distribution plot of our one-dimensional data.", "We have considered so far methods such as PCA and LDA, which are able to perform really well in case of linear relationships between the different features, we will now move on considering how to deal with non-linear cases.", "Locally Linear Embedding is a dimensionality reduction technique based on Manifold Learning. A Manifold is an object of D dimensions which is embedded in an higher-dimensional space. Manifold Learning aims then to make this object representable in its original D dimensions instead of being represented in an unnecessary greater space.", "A typical example used to explain Manifold Learning in Machine Learning is the Swiss Roll Manifold (Figure 6). We are given as input some data which has a distribution resembling the one of a roll (in a 3D space), and we can then unroll it so that to reduce our data into a two-dimensional space.", "Some examples of Manifold Learning algorithms are: Isomap, Locally Linear Embedding, Modified Locally Linear Embedding, Hessian Eigenmapping, etc\u2026", "I will now walk you through how to implement LLE in our example. According to the Scikit-learn documentation [3]:", "Locally linear embedding (LLE) seeks a lower-dimensional projection of the data which preserves distances within local neighborhoods. It can be thought of as a series of local Principal Component Analyses which are globally compared to find the best non-linear embedding.", "We can now run LLE on our dataset to reduce our data dimensionality to 3 dimensions, test the overall accuracy and plot the results.", "t-SNE is non-linear dimensionality reduction technique which is typically used to visualize high dimensional datasets. Some of the main applications of t-SNE are Natural Language Processing (NLP), speech processing, etc\u2026", "t-SNE works by minimizing the divergence between a distribution constituted by the pairwise probability similarities of the input features in the original high dimensional space and its equivalent in the reduced low dimensional space. t-SNE makes then use of the Kullback-Leiber (KL) divergence in order to measure the dissimilarity of the two different distributions. The KL divergence is then minimized using gradient descent.", "When using t-SNE, the higher dimensional space is modelled using a Gaussian Distribution, while the lower-dimensional space is modelled using a Student\u2019s t-distribution. This is done, in order to avoid an imbalance in the neighbouring points distance distribution caused by the translation into a lower-dimensional space.", "We are now ready to use TSNE and reduce our dataset to just 3 features.", "Visualizing the distribution of the resulting features we can clearly see how our data has been nicely separated even though being transformed in a reduced space.", "Testing our Random Forest accuracy using the t-SNE reduced subset confirms that now our classes can be easily separated.", "Autoencoders are a family of Machine Learning algorithms which can be used as a dimensionality reduction technique. The main difference between Autoencoders and other dimensionality reduction techniques is that Autoencoders use non-linear transformations to project data from a high dimension to a lower one.", "There exist different types of Autoencoders such as:", "In this example, we will start by building a basic Autoencoder (Figure 7). The basic architecture of an Autoencoder can be broken down into 2 main components:", "If all the input features are independent of each other, then the Autoencoder will find particularly difficult to encode and decode to input data into a lower-dimensional space.", "Autoencoders can be implemented in Python using Keras API. In this case, we specify in the encoding layer the number of features we want to get our input data reduced to (for this example 3). As we can see from the code snippet below, Autoencoders take X (our input features) as both our features and labels (X, Y).", "For this example, I decided to use ReLu as the activation function for the encoding stage and Softmax for the decoding stage. If I wouldn\u2019t have used non-linear activation functions, then the Autoencoder would have tried to reduce the input data using a linear transformation (therefore giving us a result similar to if we would have used PCA).", "We can now repeat a similar workflow as in the previous examples, this time using a simple Autoencoder as our Feature Extraction Technique.", "I hope you enjoyed this article, thank you for reading!", "If you want to keep updated with my latest articles and projects follow me on Medium and subscribe to my mailing list. These are some of my contacts details:", "[4] Variational Autoencoders are Beautiful, Comp Three Inc. Steven Flores. Accessed at: http://www.compthree.com/blog/autoencoder/", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Analytics @ Swiss Re, TDS Associate Editor and Freelancer. https://linktr.ee/pierpaolo28"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fd619b56e31be&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffeature-extraction-techniques-d619b56e31be&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffeature-extraction-techniques-d619b56e31be&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffeature-extraction-techniques-d619b56e31be&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffeature-extraction-techniques-d619b56e31be&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----d619b56e31be--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----d619b56e31be--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://pierpaoloippolito28.medium.com/?source=post_page-----d619b56e31be--------------------------------", "anchor_text": ""}, {"url": "https://pierpaoloippolito28.medium.com/?source=post_page-----d619b56e31be--------------------------------", "anchor_text": "Pier Paolo Ippolito"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fb8391a6a5f1a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffeature-extraction-techniques-d619b56e31be&user=Pier+Paolo+Ippolito&userId=b8391a6a5f1a&source=post_page-b8391a6a5f1a----d619b56e31be---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fd619b56e31be&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffeature-extraction-techniques-d619b56e31be&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fd619b56e31be&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffeature-extraction-techniques-d619b56e31be&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://blog.datasciencedojo.com/curse-of-dimensionality-python/", "anchor_text": "https://blog.datasciencedojo.com/curse-of-dimensionality-python/"}, {"url": "https://medium.com/@pierpaoloippolito28/feature-selection-techniques-1bfab5fe0784", "anchor_text": "my previous article"}, {"url": "https://www.kaggle.com/uciml/mushroom-classification", "anchor_text": "Kaggle Mushroom Classification Dataset"}, {"url": "https://www.kaggle.com/pierpaolo28/feature-extraction?scriptVersionId=21698205", "anchor_text": "Kaggle"}, {"url": "https://github.com/pierpaolo28/Artificial-Intelligence-Projects/blob/master/Features%20Analysis/feature-extraction.ipynb", "anchor_text": "my GitHub Account"}, {"url": "https://towardsdatascience.com/interactive-data-visualization-167ae26016e8", "anchor_text": "Plotly"}, {"url": "https://medium.com/@pierpaoloippolito28?source=post_page---------------------------", "anchor_text": "follow me on Medium"}, {"url": "http://eepurl.com/gwO-Dr?source=post_page---------------------------", "anchor_text": "mailing list"}, {"url": "https://uk.linkedin.com/in/pier-paolo-ippolito-202917146?source=post_page---------------------------", "anchor_text": "Linkedin"}, {"url": "https://pierpaolo28.github.io/blog/?source=post_page---------------------------", "anchor_text": "Personal Blog"}, {"url": "https://pierpaolo28.github.io/?source=post_page---------------------------", "anchor_text": "Personal Website"}, {"url": "https://towardsdatascience.com/@pierpaoloippolito28?source=post_page---------------------------", "anchor_text": "Medium Profile"}, {"url": "https://github.com/pierpaolo28?source=post_page---------------------------", "anchor_text": "GitHub"}, {"url": "https://www.kaggle.com/pierpaolo28?source=post_page---------------------------", "anchor_text": "Kaggle"}, {"url": "https://blog.paperspace.com/dimension-reduction-with-independent-components-analysis/", "anchor_text": "https://blog.paperspace.com/dimension-reduction-with-independent-components-analysis/"}, {"url": "https://www.researchgate.net/publication/220270207_Iterative_Non-linear_Dimensionality_Reduction_with_Manifold_Sculpting", "anchor_text": "https://www.researchgate.net/publication/220270207_Iterative_Non-linear_Dimensionality_Reduction_with_Manifold_Sculpting"}, {"url": "https://scikit-learn.org/stable/modules/manifold.html#targetText=Manifold%20learning%20is%20an%20approach,sets%20is%20only%20artificially%20high.", "anchor_text": "https://scikit-learn.org/stable/modules/manifold.html#targetText=Manifold%20learning%20is%20an%20approach,sets%20is%20only%20artificially%20high."}, {"url": "http://www.compthree.com/blog/autoencoder/", "anchor_text": "http://www.compthree.com/blog/autoencoder/"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----d619b56e31be---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----d619b56e31be---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----d619b56e31be---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/programming?source=post_page-----d619b56e31be---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/tag/towards-data-science?source=post_page-----d619b56e31be---------------towards_data_science-----------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fd619b56e31be&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffeature-extraction-techniques-d619b56e31be&user=Pier+Paolo+Ippolito&userId=b8391a6a5f1a&source=-----d619b56e31be---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fd619b56e31be&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffeature-extraction-techniques-d619b56e31be&user=Pier+Paolo+Ippolito&userId=b8391a6a5f1a&source=-----d619b56e31be---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fd619b56e31be&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffeature-extraction-techniques-d619b56e31be&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----d619b56e31be--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fd619b56e31be&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffeature-extraction-techniques-d619b56e31be&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----d619b56e31be---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----d619b56e31be--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----d619b56e31be--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----d619b56e31be--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----d619b56e31be--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----d619b56e31be--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----d619b56e31be--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----d619b56e31be--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----d619b56e31be--------------------------------", "anchor_text": ""}, {"url": "https://pierpaoloippolito28.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://pierpaoloippolito28.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Pier Paolo Ippolito"}, {"url": "https://pierpaoloippolito28.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "5.1K Followers"}, {"url": "https://linktr.ee/pierpaolo28", "anchor_text": "https://linktr.ee/pierpaolo28"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fb8391a6a5f1a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffeature-extraction-techniques-d619b56e31be&user=Pier+Paolo+Ippolito&userId=b8391a6a5f1a&source=post_page-b8391a6a5f1a--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F4e32d8fa9b0e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffeature-extraction-techniques-d619b56e31be&newsletterV3=b8391a6a5f1a&newsletterV3Id=4e32d8fa9b0e&user=Pier+Paolo+Ippolito&userId=b8391a6a5f1a&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}