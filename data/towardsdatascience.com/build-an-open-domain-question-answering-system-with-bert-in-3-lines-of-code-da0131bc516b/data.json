{"url": "https://towardsdatascience.com/build-an-open-domain-question-answering-system-with-bert-in-3-lines-of-code-da0131bc516b", "time": 1683005872.938835, "path": "towardsdatascience.com/build-an-open-domain-question-answering-system-with-bert-in-3-lines-of-code-da0131bc516b/", "webpage": {"metadata": {"title": "Build an Open-Domain Question-Answering System With BERT in 3 Lines of Code | by Arun Maiya | Towards Data Science", "h1": "Build an Open-Domain Question-Answering System With BERT in 3 Lines of Code", "description": "Open-Domain Question-Answering (QA) systems accept natural language questions as input and return exact answers from content buried within large text corpora such as Wikipedia. This is very different\u2026"}, "outgoing_paragraph_urls": [{"url": "https://github.com/amaiya/ktrain", "anchor_text": "available here", "paragraph_index": 1}, {"url": "http://qwone.com/~jason/20Newsgroups/", "anchor_text": "20 Newsgroups dataset", "paragraph_index": 2}, {"url": "https://en.wikipedia.org/wiki/Search_engine_indexing", "anchor_text": "search index", "paragraph_index": 4}, {"url": "https://huggingface.co/transformers/model_doc/bert.html#tfbertforquestionanswering", "anchor_text": "transformers library.", "paragraph_index": 6}, {"url": "https://en.wikipedia.org/wiki/Cassini%E2%80%93Huygens", "anchor_text": "which appears to be correct", "paragraph_index": 12}], "all_paragraphs": ["Open-Domain Question-Answering (QA) systems accept natural language questions as input and return exact answers from content buried within large text corpora such as Wikipedia. This is very different from standard search engines that simply return the documents that match keywords in a search query.", "Building such systems for practical applications has historically been quite challenging and involved. This article attempts to make such systems simpler to implement and exploit. In this tutorial, we will build a fully-functional, end-to-end open-domain QA system in only 3 lines of code. To accomplish this, we will use ktrain, a Python library and TensorFlow wrapper that makes deep learning and AI more accessible and easier to apply. ktrain is free, open-source, and available here.", "The basic idea here will be to treat a document set covering many different topics as a kind of knowledge base to which we can submit questions and receive exact answers. In this article, we will use the 20 Newsgroups dataset as the knowledge base. As a collection of newsgroup postings which contain an abundance of opinions, debates, and arguments, the corpus is far from ideal as a knowledge base. It is generally better to use fact-based documents such as Wikipedia articles or even news articles. However, the 20 Newsgroups dataset will suffice for this example, as it makes for an interesting and easy-to-try case study. It also highlights the fact that Question-Answering (QA) systems can yield insights from any collection of documents.", "Let us begin by loading the dataset into an array called docs using scikit-learn and importing some ktrain modules.", "With a dataset in hand, we will first need to create a search index. The search index will allow us to quickly and easily retrieve documents that contain words present in the question. Such documents are likely to contain the answer and can be analyzed further to extract candidate answers. We will first initialize the search index and then add documents from the Python list to the index. Since the newsgroup postings are small and fit in main memory, we will set commit_every to a large value to speed up the indexing process. This means results will not be written until the end. If you experience issues, you can try lowering this value.", "For document sets that are too large to be loaded into a Python list, you can use SimpleQA.index_from_folder, which will crawl a folder and index all plain text documents found.", "Next, we will create a QA instance, which is largely a wrapper around a pretrained BertForQuestionAnswering model from the excellent transformers library.", "That\u2019s it! In roughly 3 lines of code, we have built an end-to-end Question-Answering system that is ready to receive questions.", "We will invoke the qa.ask method to issue questions to the text corpus we indexed and retrieve answers. The ask method performs the following steps:", "We will also use the qa.display method to nicely format and display the top 5 results in our Jupyter notebook. Since the model is combing through paragraphs and sentences to find answers, it may take a few moments to return results.", "Note also that the 20 Newsgroups dataset covers events in the early to mid 1990s, so references to recent events will not exist. The dataset does, however, cover many different domain categories. For instance, there is sci.space category that covers topics about space. Let\u2019s begin with a space question!", "When did the Cassini probe launch?", "As you can see, the top candidate answer indicates that the Cassini space probe was launched in October of 1997, which appears to be correct. The specific answer within its context is highlighted in red under the column Context. Note that the correct answer will not always be the top answer, but it is in this case.", "Since we used index_from_list to index documents, the last column (populated from the reference field in the answers dictionaries) shows the list index associated with the newsgroup posting containing the answer. This reference field can be used to peruse the entire document containing the answer with print(docs[59]). If using index_from_folder to index documents, then the reference field will be populated with the relative file path of the document instead.", "The 20 Newsgroups dataset also contains lots of posts discussing and debating Christianity, as well. Let\u2019s ask a question on this subject.", "Here, we see different views on Jesus Christ, as debated and discussed in this document set.", "Finally, the 20 Newsgroups dataset also contains several newsgroup categories about computing subjects like computer graphics and PC hardware and software. Let\u2019s ask a technical support question.", "What causes computer images to be too dark?", "From the candidate answers, a lack of gamma correction seems to be at least one of the causes of the reported problem.", "To deploy this system, the only state that needs to be persisted is the search index we initialized and populated in STEP 1. Once a search index is initialized and populated, one can simply start from STEP 2 to use the QA system in a production environment.", "Source code for this article is available in two forms:", "Feel free to try out the ktrain QA module on your own document collections. For more information, visit our GitHub repository here:", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fda0131bc516b&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuild-an-open-domain-question-answering-system-with-bert-in-3-lines-of-code-da0131bc516b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuild-an-open-domain-question-answering-system-with-bert-in-3-lines-of-code-da0131bc516b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuild-an-open-domain-question-answering-system-with-bert-in-3-lines-of-code-da0131bc516b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuild-an-open-domain-question-answering-system-with-bert-in-3-lines-of-code-da0131bc516b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----da0131bc516b--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----da0131bc516b--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@asmaiya?source=post_page-----da0131bc516b--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@asmaiya?source=post_page-----da0131bc516b--------------------------------", "anchor_text": "Arun Maiya"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F4581d07591d5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuild-an-open-domain-question-answering-system-with-bert-in-3-lines-of-code-da0131bc516b&user=Arun+Maiya&userId=4581d07591d5&source=post_page-4581d07591d5----da0131bc516b---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fda0131bc516b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuild-an-open-domain-question-answering-system-with-bert-in-3-lines-of-code-da0131bc516b&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fda0131bc516b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuild-an-open-domain-question-answering-system-with-bert-in-3-lines-of-code-da0131bc516b&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://www.pexels.com/photo/questions-answers-signage-208494/", "anchor_text": "Pexels"}, {"url": "https://github.com/amaiya/ktrain", "anchor_text": "available here"}, {"url": "http://qwone.com/~jason/20Newsgroups/", "anchor_text": "20 Newsgroups dataset"}, {"url": "https://en.wikipedia.org/wiki/Search_engine_indexing", "anchor_text": "search index"}, {"url": "https://huggingface.co/transformers/model_doc/bert.html#tfbertforquestionanswering", "anchor_text": "transformers library."}, {"url": "https://rajpurkar.github.io/SQuAD-explorer/", "anchor_text": "SQuAD dataset"}, {"url": "https://en.wikipedia.org/wiki/Cassini%E2%80%93Huygens", "anchor_text": "which appears to be correct"}, {"url": "https://nbviewer.jupyter.org/github/amaiya/ktrain/blob/master/examples/text/question_answering_with_bert.ipynb", "anchor_text": "available on our GitHub repo"}, {"url": "https://colab.research.google.com/drive/1tcsEQ7igx7lw_R0Pfpmsg9Wf3DEXyOvk", "anchor_text": "available here"}, {"url": "https://github.com/amaiya/ktrain", "anchor_text": "https://github.com/amaiya/ktrain"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----da0131bc516b---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/nlp?source=post_page-----da0131bc516b---------------nlp-----------------", "anchor_text": "NLP"}, {"url": "https://medium.com/tag/question-answering?source=post_page-----da0131bc516b---------------question_answering-----------------", "anchor_text": "Question Answering"}, {"url": "https://medium.com/tag/tensorflow?source=post_page-----da0131bc516b---------------tensorflow-----------------", "anchor_text": "TensorFlow"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----da0131bc516b---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fda0131bc516b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuild-an-open-domain-question-answering-system-with-bert-in-3-lines-of-code-da0131bc516b&user=Arun+Maiya&userId=4581d07591d5&source=-----da0131bc516b---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fda0131bc516b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuild-an-open-domain-question-answering-system-with-bert-in-3-lines-of-code-da0131bc516b&user=Arun+Maiya&userId=4581d07591d5&source=-----da0131bc516b---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fda0131bc516b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuild-an-open-domain-question-answering-system-with-bert-in-3-lines-of-code-da0131bc516b&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----da0131bc516b--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fda0131bc516b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuild-an-open-domain-question-answering-system-with-bert-in-3-lines-of-code-da0131bc516b&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----da0131bc516b---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----da0131bc516b--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----da0131bc516b--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----da0131bc516b--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----da0131bc516b--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----da0131bc516b--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----da0131bc516b--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----da0131bc516b--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----da0131bc516b--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@asmaiya?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@asmaiya?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Arun Maiya"}, {"url": "https://medium.com/@asmaiya/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "218 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F4581d07591d5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuild-an-open-domain-question-answering-system-with-bert-in-3-lines-of-code-da0131bc516b&user=Arun+Maiya&userId=4581d07591d5&source=post_page-4581d07591d5--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F846d100b3abe&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuild-an-open-domain-question-answering-system-with-bert-in-3-lines-of-code-da0131bc516b&newsletterV3=4581d07591d5&newsletterV3Id=846d100b3abe&user=Arun+Maiya&userId=4581d07591d5&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}