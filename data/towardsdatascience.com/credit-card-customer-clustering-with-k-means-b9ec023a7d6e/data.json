{"url": "https://towardsdatascience.com/credit-card-customer-clustering-with-k-means-b9ec023a7d6e", "time": 1683015386.7089448, "path": "towardsdatascience.com/credit-card-customer-clustering-with-k-means-b9ec023a7d6e/", "webpage": {"metadata": {"title": "Credit Card Customer Clustering with K-means | by Luke Sun | Towards Data Science", "h1": "Credit Card Customer Clustering with K-means", "description": "In a previous post, we attempted to detect fraud in credit card transactions using various models. Here we will turn to another popular topic - Customer Clustering. This post aims to help friends in\u2026"}, "outgoing_paragraph_urls": [{"url": "https://towardsdatascience.com/credit-card-fraud-detection-9bc8db79b956", "anchor_text": "post", "paragraph_index": 0}, {"url": "https://towardsdatascience.com/demystify-employee-leaving-with-eda-2ed96525f3a7", "anchor_text": "articles", "paragraph_index": 3}, {"url": "https://en.wikipedia.org/wiki/Principal_component_analysis", "anchor_text": "Wikipedia", "paragraph_index": 20}], "all_paragraphs": ["In a previous post, we attempted to detect fraud in credit card transactions using various models. Here we will turn to another popular topic - Customer Clustering. This post aims to help friends in the marketing department. As usual, it is split into 5 parts.", "Marketing, as well known, is crucial for the growth and sustainability of any business. However, one of the key pain points for any marketing professionals is to know the customers and identify their needs. Tasked by colleagues in the marketing department, your job is to create a model to perform customer grouping.", "The dataset contains 17 features and 8,950 records. As illustrated in Fig.1, it is about customer\u2019s purchase and payment habits, such as how often a customer makes one-off or instalment purchases, or how often they make cash advances, how much payments are made, etc. By inspecting each customer, we can find which type of purchase he/she is keen on, or if he/she prefers cash advance over purchases.", "Generally, to get a deep understanding and preliminary findings on any raw data, we perform exploratory data analysis (EDA). I covered this topic and the general steps in several articles. If you are a newbie on EDA, have a look at my previous articles. Here we will focus on some steps necessary for the following modelling.", "Due to various reasons, missing values commonly appear in raw data. To check how many missing values in each column,", "As shown in Fig.2, the column \u2018CREDIT_LIMIT\u2019 has 1 missing value, and \u2018MINIMUM_PAYMENTS\u2019 has 313 missing values.", "There are many approaches to dealing with missing values, including:", "In this case, we will fill the missing values the mean of the column. Specifically,", "The dataset contains 17 features. Now we need to consider if all of them is necessary to train the model. In our case, \u2018CUST_ID\u2019 is of no help. So we will drop it.", "Some features such as \u2018PURCHASES\u2019 vary in a wide range, while other features such as \u2018PURCHASES_FREQUENCY\u2019 vary between 0 to 1. We need to scale all features on the same range. Here we use StandardScaler() from sklearn to remove mean and scale to unit variance.", "k-means clustering is an unsupervised machine learning algorithm. According to Wikipedia, it aims to partition the observations into k sets so as to minimize the within-cluster sum of squares (WCSS). WCSS represents the sum of distances of all points to the centroid in a cluster. It starts with a group of randomly initialized centroids and then performs iterative calculations to optimize the position of centroids until the centroids stabilize, or the defined number of iterations is reached.", "The first step in k-means is to pick the number of clusters. The elbow method is one of the most popular methods. To implement it, we apply k-means with a different number of clusters and compare their WCSS. Specifically,", "Fig.3 shows the WCSS variation with the number of clusters. To determine the optimal number of clusters, we have to select the value of k at the \u201celbow\u201d i.e. the point after which the distortion/inertia start decreasing in a linear fashion. Thus, we conclude that the optimal number of clusters is 8.", "Having determined the optimal number of clusters, let\u2019s apply k-means and predict each sample\u2019s cluster. Specifically,", "Note we set the number of time that k-means will be run to be 10. This means k-means will run 10 times with different centroid seeds, and the final results will be the best output in terms of WCSS. In addition, we set the maximum number of iterations of k-means for a single run to be 300.", "With the prediction results, the first visualization is to review the feature distribution for each cluster.", "For instance, let\u2019s take cluster 4 for analysis. As seen in Fig.4, compared to other clusters, we find customers in cluster 4 tend to have a high account balance, and update the balance very often, but the amount of their purchase is very skewed towards 0. This indicates the customers are keener on the cash advances, as shown in Fig.5.", "As a credit card user, myself, I regularly make purchases but am not a fan of cash advances. So, I find myself may fit into cluster 0, which represents customers who make a frequent one-off purchase but are not keen on instalment and cash advances. But if you make a lot of instalment purchases and not cash advances, you may fit into cluster 2.", "Personally, I find this is so much fun to analyse how different groups of customers behave on their transactions \u2728\u2728. Maybe have a try and see where you fit into \ud83d\udce3\ud83d\udce3?", "Obviously, the histogram chart is great to analyse the cluster features, but not so great to visualize the overall cluster distribution. Because we have 17 features, we have to compress the dimensions of freedom to visually observe the cluster distribution. To do such, we use principal component analysis (PCA) to compress features into a 2D space.", "For those who are not familiar with PCA, PCA is commonly used for dimensionality reduction by projecting data only onto the first principle components to obtain low-dimension data while preserving or maximizing the variances along the projected direction (Btw, this is from Wikipedia \ud83e\udd2d).", "Finally, with 17 features compressed to 2 features, Fig.6 shows the scatter plot of the k-means prediction results. You may notice the red cluster is somehow scattered among the blue cluster, pink cluster and green cluster. This may indicate the red cluster has feature similarity with the others. Maybe we can recreate a new cluster with a new technique \ud83e\udd14\ud83e\udd14?", "We created a k-means model that managed to segment credit card customers into 8 groups. We found some interesting purchases and payment patterns for cluster 0, 2 and 4, and more remains to be explored. We also noticed some overlaps between clusters, indicating there are spaces to improve.", "Great. Hope you find this journey an interesting one. To continue the topic, I will dig further to see if we can improve the clustering results in the next post. See you there \ud83d\udc95\ud83d\udc95.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "ML Enthusiast, Data Scientist, Python Developer. Love to share articles about technology."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fb9ec023a7d6e&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcredit-card-customer-clustering-with-k-means-b9ec023a7d6e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcredit-card-customer-clustering-with-k-means-b9ec023a7d6e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcredit-card-customer-clustering-with-k-means-b9ec023a7d6e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcredit-card-customer-clustering-with-k-means-b9ec023a7d6e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----b9ec023a7d6e--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----b9ec023a7d6e--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://lukesun.medium.com/?source=post_page-----b9ec023a7d6e--------------------------------", "anchor_text": ""}, {"url": "https://lukesun.medium.com/?source=post_page-----b9ec023a7d6e--------------------------------", "anchor_text": "Luke Sun"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F7b5b79d21508&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcredit-card-customer-clustering-with-k-means-b9ec023a7d6e&user=Luke+Sun&userId=7b5b79d21508&source=post_page-7b5b79d21508----b9ec023a7d6e---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb9ec023a7d6e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcredit-card-customer-clustering-with-k-means-b9ec023a7d6e&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb9ec023a7d6e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcredit-card-customer-clustering-with-k-means-b9ec023a7d6e&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://pixabay.com/illustrations/tent-leaves-camping-icons-5635679/", "anchor_text": "link"}, {"url": "https://towardsdatascience.com/credit-card-fraud-detection-9bc8db79b956", "anchor_text": "post"}, {"url": "https://towardsdatascience.com/demystify-employee-leaving-with-eda-2ed96525f3a7", "anchor_text": "articles"}, {"url": "https://en.wikipedia.org/wiki/Principal_component_analysis", "anchor_text": "Wikipedia"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----b9ec023a7d6e---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/k-means-clustering?source=post_page-----b9ec023a7d6e---------------k_means_clustering-----------------", "anchor_text": "K Means Clustering"}, {"url": "https://medium.com/tag/data-science?source=post_page-----b9ec023a7d6e---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/business-intelligence?source=post_page-----b9ec023a7d6e---------------business_intelligence-----------------", "anchor_text": "Business Intelligence"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fb9ec023a7d6e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcredit-card-customer-clustering-with-k-means-b9ec023a7d6e&user=Luke+Sun&userId=7b5b79d21508&source=-----b9ec023a7d6e---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fb9ec023a7d6e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcredit-card-customer-clustering-with-k-means-b9ec023a7d6e&user=Luke+Sun&userId=7b5b79d21508&source=-----b9ec023a7d6e---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb9ec023a7d6e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcredit-card-customer-clustering-with-k-means-b9ec023a7d6e&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----b9ec023a7d6e--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fb9ec023a7d6e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcredit-card-customer-clustering-with-k-means-b9ec023a7d6e&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----b9ec023a7d6e---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----b9ec023a7d6e--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----b9ec023a7d6e--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----b9ec023a7d6e--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----b9ec023a7d6e--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----b9ec023a7d6e--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----b9ec023a7d6e--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----b9ec023a7d6e--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----b9ec023a7d6e--------------------------------", "anchor_text": ""}, {"url": "https://lukesun.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://lukesun.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Luke Sun"}, {"url": "https://lukesun.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "141 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F7b5b79d21508&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcredit-card-customer-clustering-with-k-means-b9ec023a7d6e&user=Luke+Sun&userId=7b5b79d21508&source=post_page-7b5b79d21508--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F38f46069f6d3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcredit-card-customer-clustering-with-k-means-b9ec023a7d6e&newsletterV3=7b5b79d21508&newsletterV3Id=38f46069f6d3&user=Luke+Sun&userId=7b5b79d21508&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}