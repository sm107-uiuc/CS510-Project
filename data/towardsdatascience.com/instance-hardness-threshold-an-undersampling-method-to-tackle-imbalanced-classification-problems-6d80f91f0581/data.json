{"url": "https://towardsdatascience.com/instance-hardness-threshold-an-undersampling-method-to-tackle-imbalanced-classification-problems-6d80f91f0581", "time": 1683005653.0847511, "path": "towardsdatascience.com/instance-hardness-threshold-an-undersampling-method-to-tackle-imbalanced-classification-problems-6d80f91f0581/", "webpage": {"metadata": {"title": "Instance Hardness Threshold: An Undersampling Method to Tackle Imbalanced Classification Problems | by Li Sisters | Towards Data Science", "h1": "Instance Hardness Threshold: An Undersampling Method to Tackle Imbalanced Classification Problems", "description": "If you have diligently watched Andrew Ng\u2019s deep learning courses on Coursera, you probably have known what Error Analysis entails. Andrew is an advocate of building the first working system quickly\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.coursera.org/specializations/deep-learning", "anchor_text": "Andrew Ng\u2019s deep learning courses on Coursera", "paragraph_index": 0}, {"url": "https://link.springer.com/article/10.1007/s10994-013-5422-z", "anchor_text": "An instance level analysis of data complexity", "paragraph_index": 1}, {"url": "https://medium.com/swlh/tree-based-machine-learning-models-for-handling-imbalanced-datasets-26560b5865f6", "anchor_text": "my previous post", "paragraph_index": 9}, {"url": "https://www.kaggle.com/mlg-ulb/creditcardfraud", "anchor_text": "kaggle", "paragraph_index": 9}], "all_paragraphs": ["If you have diligently watched Andrew Ng\u2019s deep learning courses on Coursera, you probably have known what Error Analysis entails. Andrew is an advocate of building the first working system quickly, before identifying areas of improvements and modifying the system accordingly. One way of finding out areas of improvements for classification systems is through a study of misclassified samples. For the cat image classifier that Andrew used as the example, images of great cats can be frequently misclassified. In this regard, great cat samples are hard.", "For machine learning practitioners, \u2018hard\u2019 is too vague a term to describe individual samples (i.e. instances). This issue has certainly gotten to Michael Smith, Tony Martinez and Christophe Giraud-Carrier, who wrote a research article titled An instance level analysis of data complexity. In this article, they proposed an empirical definition of instance hardness based on the classification behavior of a selected set of learning algorithms.", "Why a set of learning algorithms? The authors explained that the misclassification of a sample is dependent on the learning algorithm used and the relationship between the sample and its counterparts. The idea of instance hardness is a relative one; aggregating the results of applying a set of diverse and practical learning algorithms on the same instance has the generalization effect.", "Smith, Martinez and Giraud-Carrier provided a rigorous formulation of IH in their article. Those who do not shy away from mathematical symbols are highly encouraged to take a look at it.", "Loosely speaking, the authors chose a selected set of n learning algorithms beforehand and applied them one by one on the training set. In this way, n classifiers were produced. For a single instance (i.e. sample), one can estimate the probability P_i (i ranges from 1 to n) of the classifier i assigning the correct label to it using the indicator function and classifier scores. Taking the average of P_i for n estimators, we obtained the likelihood of classifying this instance correctly. IH, the likelihood of misclassifying the instance, will therefore be 1 minus this average.", "In the paper, the authors also went on to study why hard instances are difficult to classify. Their experiment results on 190,000 samples showed that class overlap has the strongest influence on IH.", "The image below exemplifies what class overlap means:", "Class overlap occurs when a region in the sample space contains samples from another class. The overlapping samples have high instance hardness. When both class imbalance and class overlap occur in the dataset, the classification problem becomes even more difficult.", "Instance Hardness Threshold (IHT) is an undersampling method for alleviating class imbalance by removing hard samples. There is an implementation of IHT in imbalanced-learn library based on the article above-mentioned. Samples that are classified with a low probability will be removed from the dataset. Afterwards, the model will be built on the undersampled data.", "Similar to my previous post on dealing with imbalanced datasets, I will use the credit card transactions dataset from kaggle to demonstrate the code for using IHT. The dataset is extremely imbalanced; out of 284,807 transactions, there are only 492 frauds. 80% of transactions will be learned from a decision tree classifier (max_depth=5), and 20% of transactions will form the test set.", "Next, we use the classifier dt as the estimator to estimate the IH of samples. For use IHT method to undersample until the ratio of majority class to minority class is 0.0019, and count the shape of training set before and after this transformation:", "As shown in the output above, 2328 samples from the majority class are removed. The minority class samples remain intact.", "Next, fit a decision tree with max_depth being 5 to the resampled dataset:", "The new decision tree classifier has similar capability as the old on in classifying the minority class samples. However, more normal transactions are classified as fraud, which leads to the drop of precision. The samples removed by IHT probably carry information that help classifiers to identify normal transactions betters.", "Though IHT is not very effective for this particular problem, but hopefully with the code snippets, those who are unfamiliar with this undersampling method can get the hang of it easily.", "Instance Hardness Threshold (IHT) is a rather special undersampling method, with an approach of removing majority class samples that overlap the minority class sample space. This post introduces the basics of IHT, and shows how one can implement it for imbalanced class problems.", "Thank you for reading the story!", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Account shared between two of us | Android Developer + Data Enthusiast :D"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F6d80f91f0581&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finstance-hardness-threshold-an-undersampling-method-to-tackle-imbalanced-classification-problems-6d80f91f0581&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finstance-hardness-threshold-an-undersampling-method-to-tackle-imbalanced-classification-problems-6d80f91f0581&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finstance-hardness-threshold-an-undersampling-method-to-tackle-imbalanced-classification-problems-6d80f91f0581&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finstance-hardness-threshold-an-undersampling-method-to-tackle-imbalanced-classification-problems-6d80f91f0581&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----6d80f91f0581--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----6d80f91f0581--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@li.shuang.0425?source=post_page-----6d80f91f0581--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@li.shuang.0425?source=post_page-----6d80f91f0581--------------------------------", "anchor_text": "Li Sisters"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F376f08c6cd7b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finstance-hardness-threshold-an-undersampling-method-to-tackle-imbalanced-classification-problems-6d80f91f0581&user=Li+Sisters&userId=376f08c6cd7b&source=post_page-376f08c6cd7b----6d80f91f0581---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F6d80f91f0581&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finstance-hardness-threshold-an-undersampling-method-to-tackle-imbalanced-classification-problems-6d80f91f0581&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F6d80f91f0581&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finstance-hardness-threshold-an-undersampling-method-to-tackle-imbalanced-classification-problems-6d80f91f0581&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@dimage_carlos?utm_source=medium&utm_medium=referral", "anchor_text": "Carlos Esteves"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://www.coursera.org/specializations/deep-learning", "anchor_text": "Andrew Ng\u2019s deep learning courses on Coursera"}, {"url": "https://link.springer.com/article/10.1007/s10994-013-5422-z", "anchor_text": "An instance level analysis of data complexity"}, {"url": "https://medium.com/swlh/tree-based-machine-learning-models-for-handling-imbalanced-datasets-26560b5865f6", "anchor_text": "my previous post"}, {"url": "https://www.kaggle.com/mlg-ulb/creditcardfraud", "anchor_text": "kaggle"}, {"url": "https://doi.org/10.1007/s10994-013-5422-z", "anchor_text": "https://doi.org/10.1007/s10994-013-5422-z"}, {"url": "https://imbalanced-learn.readthedocs.io/en/stable/generated/imblearn.under_sampling.InstanceHardnessThreshold.html#r2bfe4eaac981-1", "anchor_text": "https://imbalanced-learn.readthedocs.io/en/stable/generated/imblearn.under_sampling.InstanceHardnessThreshold.html#r2bfe4eaac981-1"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----6d80f91f0581---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/classification?source=post_page-----6d80f91f0581---------------classification-----------------", "anchor_text": "Classification"}, {"url": "https://medium.com/tag/imbalanced-data?source=post_page-----6d80f91f0581---------------imbalanced_data-----------------", "anchor_text": "Imbalanced Data"}, {"url": "https://medium.com/tag/undersampling-method?source=post_page-----6d80f91f0581---------------undersampling_method-----------------", "anchor_text": "Undersampling Method"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F6d80f91f0581&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finstance-hardness-threshold-an-undersampling-method-to-tackle-imbalanced-classification-problems-6d80f91f0581&user=Li+Sisters&userId=376f08c6cd7b&source=-----6d80f91f0581---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F6d80f91f0581&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finstance-hardness-threshold-an-undersampling-method-to-tackle-imbalanced-classification-problems-6d80f91f0581&user=Li+Sisters&userId=376f08c6cd7b&source=-----6d80f91f0581---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F6d80f91f0581&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finstance-hardness-threshold-an-undersampling-method-to-tackle-imbalanced-classification-problems-6d80f91f0581&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----6d80f91f0581--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F6d80f91f0581&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finstance-hardness-threshold-an-undersampling-method-to-tackle-imbalanced-classification-problems-6d80f91f0581&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----6d80f91f0581---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----6d80f91f0581--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----6d80f91f0581--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----6d80f91f0581--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----6d80f91f0581--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----6d80f91f0581--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----6d80f91f0581--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----6d80f91f0581--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----6d80f91f0581--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@li.shuang.0425?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@li.shuang.0425?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Li Sisters"}, {"url": "https://medium.com/@li.shuang.0425/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "44 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F376f08c6cd7b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finstance-hardness-threshold-an-undersampling-method-to-tackle-imbalanced-classification-problems-6d80f91f0581&user=Li+Sisters&userId=376f08c6cd7b&source=post_page-376f08c6cd7b--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F4437f581d00f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finstance-hardness-threshold-an-undersampling-method-to-tackle-imbalanced-classification-problems-6d80f91f0581&newsletterV3=376f08c6cd7b&newsletterV3Id=4437f581d00f&user=Li+Sisters&userId=376f08c6cd7b&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}