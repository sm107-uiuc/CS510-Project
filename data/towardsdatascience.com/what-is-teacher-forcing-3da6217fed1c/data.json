{"url": "https://towardsdatascience.com/what-is-teacher-forcing-3da6217fed1c", "time": 1683000899.3854542, "path": "towardsdatascience.com/what-is-teacher-forcing-3da6217fed1c/", "webpage": {"metadata": {"title": "What is Teacher Forcing?. A common technique in training\u2026 | by Wanshun Wong | Towards Data Science", "h1": "What is Teacher Forcing?", "description": "A lot of Recurrent Neural Networks in Natural Language Processing (e.g. in image captioning, machine translation) use Teacher Forcing in the training process. Despite the prevalence of Teacher\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.tensorflow.org/tutorials/text/nmt_with_attention#training", "anchor_text": "Neural machine translation with attention", "paragraph_index": 0}], "all_paragraphs": ["A lot of Recurrent Neural Networks in Natural Language Processing (e.g. in image captioning, machine translation) use Teacher Forcing in the training process. Despite the prevalence of Teacher Forcing, most articles only briefly describe how it works. For example, the TensorFlow tutorial on Neural machine translation with attention only says \u201cTeacher forcing is the technique where the target word is passed as the next input to the decoder.\u201d In this article, we will go over the details of Teacher Forcing and answer some of the common questions.", "Have you ever had math exam questions that consist of multiple parts, where the answer for part (a) is needed for the calculation in part (b), answer for part (b) is needed for part (c), and so on? I always pay extra attention to these questions because if we get part (a) wrong, then all the subsequent parts will most likely be wrong as well, even though the formulas and the calculations are correct. Teacher Forcing remedies this as follows: After we obtain an answer for part (a), a teacher will compare our answer with the correct one, record the score for part (a), and tell us the correct answer so that we can use it for part (b).", "The situation for Recurrent Neural Networks that output sequences is very similar. Let us assume we want to train an image captioning model, and the ground truth caption for the above image is \u201cTwo people reading a book\u201d. Our model makes a mistake in predicting the 2nd word and we have \u201cTwo\u201d and \u201cbirds\u201d for the 1st and 2nd prediction respectively.", "Training with Teacher Forcing converges faster. At the early stages of training, the predictions of the model are very bad. If we do not use Teacher Forcing, the hidden states of the model will be updated by a sequence of wrong predictions, errors will accumulate, and it is difficult for the model to learn from that.", "During inference, since there is usually no ground truth available, the RNN model will need to feed its own previous prediction back to itself for the next prediction. Therefore there is a discrepancy between training and inference, and this might lead to poor model performance and instability. This is known as Exposure Bias in literature.", "Q: Since we pass the whole ground truth sequence through the RNN model, is it possible for the model to \u201ccheat\u201d by simply memorizing the ground truth?", "A: No. At timestep t, the input of the model is the ground truth at timestep t - 1, and the hidden states of the model have been updated by ground truths from timestep 1 to t - 2. The model can never peek into the future.", "Q: Is it necessary to update the loss at each timestep?", "A: No. An alternative approach is to store the predictions at all timesteps in, say, a Python list, and then compute all the losses in one go.", "Q: Is Teacher Forcing used outside Natural Language Processing?", "A: Yes. It can be used in any model that output sequences, e.g. in time series forecasting.", "Q: Is Teacher Forcing used outside Recurrent Neural Networks?", "A: Yes. It is used in other autoregressive models such as Transformer.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F3da6217fed1c&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhat-is-teacher-forcing-3da6217fed1c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhat-is-teacher-forcing-3da6217fed1c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhat-is-teacher-forcing-3da6217fed1c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhat-is-teacher-forcing-3da6217fed1c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----3da6217fed1c--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----3da6217fed1c--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@wanshunwong?source=post_page-----3da6217fed1c--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@wanshunwong?source=post_page-----3da6217fed1c--------------------------------", "anchor_text": "Wanshun Wong"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fb145fb04b8bd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhat-is-teacher-forcing-3da6217fed1c&user=Wanshun+Wong&userId=b145fb04b8bd&source=post_page-b145fb04b8bd----3da6217fed1c---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F3da6217fed1c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhat-is-teacher-forcing-3da6217fed1c&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F3da6217fed1c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhat-is-teacher-forcing-3da6217fed1c&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@jerry_318?utm_source=medium&utm_medium=referral", "anchor_text": "Jerry Wang"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://www.tensorflow.org/tutorials/text/nmt_with_attention#training", "anchor_text": "Neural machine translation with attention"}, {"url": "https://www.tensorflow.org/tutorials/text/nmt_with_attention#training", "anchor_text": "Neural machine translation with attention"}, {"url": "https://pytorch.org/tutorials/intermediate/seq2seq_translation_tutorial.html#training-the-model", "anchor_text": "NLP From Scratch: Translation with a Sequence to Sequence Network and Attention"}, {"url": "http://papers.nips.cc/paper/5956-scheduled-sampling-for-sequence-prediction-with-recurrent-neural-networks", "anchor_text": "Scheduled sampling for sequence prediction with recurrent neural networks"}, {"url": "http://proceedings.mlr.press/v97/collobert19a/collobert19a.pdf", "anchor_text": "A Fully Differentiable Beam Search Decoder"}, {"url": "https://arxiv.org/abs/1906.04331", "anchor_text": "Parallel Scheduled Sampling"}, {"url": "https://arxiv.org/abs/1905.10617", "anchor_text": "Quantifying Exposure Bias for Neural Language Generation"}, {"url": "https://papers.nips.cc/paper/6099-professor-forcing-a-new-algorithm-for-training-recurrent-networks", "anchor_text": "Professor Forcing: A New Algorithm for Training Recurrent Networks"}, {"url": "https://www.aclweb.org/anthology/D16-1137/", "anchor_text": "Sequence-to-Sequence Learning as Beam-Search Optimization"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----3da6217fed1c---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/recurrent-neural-network?source=post_page-----3da6217fed1c---------------recurrent_neural_network-----------------", "anchor_text": "Recurrent Neural Network"}, {"url": "https://medium.com/tag/teacher-forcing?source=post_page-----3da6217fed1c---------------teacher_forcing-----------------", "anchor_text": "Teacher Forcing"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----3da6217fed1c---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F3da6217fed1c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhat-is-teacher-forcing-3da6217fed1c&user=Wanshun+Wong&userId=b145fb04b8bd&source=-----3da6217fed1c---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F3da6217fed1c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhat-is-teacher-forcing-3da6217fed1c&user=Wanshun+Wong&userId=b145fb04b8bd&source=-----3da6217fed1c---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F3da6217fed1c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhat-is-teacher-forcing-3da6217fed1c&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----3da6217fed1c--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F3da6217fed1c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhat-is-teacher-forcing-3da6217fed1c&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----3da6217fed1c---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----3da6217fed1c--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----3da6217fed1c--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----3da6217fed1c--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----3da6217fed1c--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----3da6217fed1c--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----3da6217fed1c--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----3da6217fed1c--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----3da6217fed1c--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@wanshunwong?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@wanshunwong?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Wanshun Wong"}, {"url": "https://medium.com/@wanshunwong/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "263 Followers"}, {"url": "https://www.linkedin.com/in/wanshunwong/", "anchor_text": "https://www.linkedin.com/in/wanshunwong/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fb145fb04b8bd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhat-is-teacher-forcing-3da6217fed1c&user=Wanshun+Wong&userId=b145fb04b8bd&source=post_page-b145fb04b8bd--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fa149bfd5dd79&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhat-is-teacher-forcing-3da6217fed1c&newsletterV3=b145fb04b8bd&newsletterV3Id=a149bfd5dd79&user=Wanshun+Wong&userId=b145fb04b8bd&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}