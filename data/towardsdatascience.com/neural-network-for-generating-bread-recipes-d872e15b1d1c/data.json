{"url": "https://towardsdatascience.com/neural-network-for-generating-bread-recipes-d872e15b1d1c", "time": 1683011446.853483, "path": "towardsdatascience.com/neural-network-for-generating-bread-recipes-d872e15b1d1c/", "webpage": {"metadata": {"title": "Neural network for generating bread recipes | by Pratima Satish | Towards Data Science", "h1": "Neural network for generating bread recipes", "description": "In 2017, a friend gave me some sourdough starter to make bread with, and ever since then, my life has changed. It sounds cheesy, but I discovered a hobby that has led me to buy almost 200 pounds of\u2026"}, "outgoing_paragraph_urls": [{"url": "http://thefreshloaf.com/", "anchor_text": "The Fresh Loaf", "paragraph_index": 1}, {"url": "https://pratima.io.", "anchor_text": "https://pratima.io.", "paragraph_index": 2}, {"url": "https://github.com/pratima-personal/bread-recipe-generator", "anchor_text": "this repo", "paragraph_index": 2}, {"url": "https://github.com/pratima-personal/bread-recipe-generator/blob/master/scrape_web.py", "anchor_text": "query the website for webpages", "paragraph_index": 5}, {"url": "https://github.com/pratima-personal/bread-recipe-generator/blob/master/recipe-builder.ipynb", "anchor_text": "Jupyter notebook", "paragraph_index": 8}, {"url": "https://www.nltk.org/", "anchor_text": "NLTK corpus", "paragraph_index": 8}, {"url": "https://github.com/amueller/word_cloud", "anchor_text": "word cloud", "paragraph_index": 10}, {"url": "https://pratima.io/neural-network-bread-recipe-generation-ii/", "anchor_text": "parts II", "paragraph_index": 12}, {"url": "https://pratima.io/neural-network-bread-recipe-generation-iii/", "anchor_text": "III", "paragraph_index": 12}, {"url": "https://pratima.io/neural-network-bread-recipe-generation-i/", "anchor_text": "Originally published on author\u2019s blog on July 22, 2020", "paragraph_index": 13}, {"url": "http://pratima.io", "anchor_text": "pratima.io", "paragraph_index": 15}], "all_paragraphs": ["In 2017, a friend gave me some sourdough starter to make bread with, and ever since then, my life has changed. It sounds cheesy, but I discovered a hobby that has led me to buy almost 200 pounds of flour at a time (seriously), develop a biweekly pizza baking habit, and dream of what bread I\u2019m going to make in the coming days!", "Because I spend a lot of time baking sourdough and experimenting with new formulas, I wanted to see if I could create an artificial intelligence-powered recipe generator that would predict something for me to make! One of my go-to websites for technique, tips and tricks has been the helpful bread baking forum, The Fresh Loaf, where people ask questions and post recipes. My idea was to scrape this website and get data to train a neural network to generate new bread recipes \u2014 and that\u2019s what I did. At the end of this project, I was able to achieve my goal: to bake a machine learning-inspired loaf of bread, with ingredients predicted with a neural network.", "Since there are multiple components to this project, I am breaking them down in a few posts. The first part is here on Medium, and the rest is on my blog, https://pratima.io. All the code I used for the project is in this repo.", "I followed the following steps during this project to obtain a recipe-generating model:", "In this post, I\u2019ll be describing the data collection and data exploration parts of the project.", "I used the urllib library in python to query the website for webpages and Beautiful Soup to parse the HTML code. Inspecting the source code for blog posts on The Fresh Loaf, I realized that the ones containing recipes had the class node-type-blog, while other posts had other classes like node-type-forum; so I made sure to only grab pages with the former class. Then I had to identify where the body of the blog containing the text was. The tags had a lot of nesting, and to me, were a little bit of a mess, since I don't look at HTML code very often. The <div> elements of this class contained both the blog text as well as the comments and ads, but I only wanted to isolate the recipe. So I decided to use the prettify() function in Beautiful Soup and examine the resulting string to see where the body of the text was.", "The tags in this string made it quite easy to find the recipe body (contained in the content section) and after isolating that string, I used a quick preprocessing function to get rid of any HTML remnants that ended up in the recipe\u2019s text.", "I scraped ~10000 posts to end up with 1257 recipes that I collected into a text document, each separated by a new line. I could keep scraping for more but the website stopped responding after querying it for a few hours, so I decided to stop and understand the data from here.", "To begin, I loaded the text file into a Jupyter notebook and calculated the length and unique words in each recipe. Upon inspecting the data, I found that a lot of authors referred to other url\u2019s where they obtained inspiration for their recipe and I removed these \u201cwords\u201d from the text. I also tokenized the recipe by removing stop words using the NLTK corpus. However, a lot of authors describe their own thoughts and procedures so removing the stop words \u201ci\u201d and \u201cme\u201d would lead to grammatical issues while training a language model; I retained these stop words in the text.", "The recipes have an average length of 294 words with a standard deviation of 618. That\u2019s quite a variation in recipe lengths! They also contain 166 unique words on average, again with a high standard deviation of 174 words. This high standard deviation indicates a large tail, and indeed, upon examining the data, I found a few recipes with over 1200 words that are skewing these statistics. One post even has >20000 words!", "To get a visual representation of what the texts of these recipes contain, I created a word cloud based on the words in the recipes. This package creates an image of the top terms after removing stop words. As suspected, the most common words are \u2018bread\u2019, \u2018dough\u2019, \u2018loaf\u2019, \u2018time\u2019 and \u2018water\u2019. Some of the other words that pop out to me are \u2018stretch\u2019, \u2018fold\u2019 and \u2018starter\u2019. From my experience baking bread, time is an important ingredient, and it checks out that it\u2019s quite a frequent word. I\u2019m also happy to see stretch and fold there, as this is a common technique to develop strength in the dough and lots of people seem to use it! It\u2019s surprising that starter shows up but the word \u2018yeast\u2019 does not, as bread can be leavened using both a wild-yeast starter as well as standard commercial baking yeast. It seems as though the users of The Fresh Loaf, like me, prefer using sourdough starters to make their bread rise and coax out fun flavor profiles due to its wild nature.", "More quantitatively, I made a long list of all the words and counted the number of times each one occurred to plot the 20 most common words occurring in the recipes. As with the word cloud above, we see \u2018dough\u2019, \u2018flour\u2019, \u2018water\u2019 and units of time in this list of frequently used terms.", "Phew \u2014 that\u2019s a lot of stuff! Head on to my website for parts II and III to learn more about the dataset and how I trained a neural network that told me how to make bread :-)", "Originally published on author\u2019s blog on July 22, 2020", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data scientist by day, sourdough bread baker by night. Currently working at Square and expanding my AI/ML knowledge on the side. Blog: pratima.io"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fd872e15b1d1c&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fneural-network-for-generating-bread-recipes-d872e15b1d1c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fneural-network-for-generating-bread-recipes-d872e15b1d1c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fneural-network-for-generating-bread-recipes-d872e15b1d1c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fneural-network-for-generating-bread-recipes-d872e15b1d1c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----d872e15b1d1c--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----d872e15b1d1c--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@pratimasatish92?source=post_page-----d872e15b1d1c--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@pratimasatish92?source=post_page-----d872e15b1d1c--------------------------------", "anchor_text": "Pratima Satish"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fc1e7bd14f114&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fneural-network-for-generating-bread-recipes-d872e15b1d1c&user=Pratima+Satish&userId=c1e7bd14f114&source=post_page-c1e7bd14f114----d872e15b1d1c---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fd872e15b1d1c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fneural-network-for-generating-bread-recipes-d872e15b1d1c&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fd872e15b1d1c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fneural-network-for-generating-bread-recipes-d872e15b1d1c&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "http://thefreshloaf.com/", "anchor_text": "The Fresh Loaf"}, {"url": "https://pratima.io.", "anchor_text": "https://pratima.io."}, {"url": "https://github.com/pratima-personal/bread-recipe-generator", "anchor_text": "this repo"}, {"url": "https://pratima.io/neural-network-bread-recipe-generation-ii/", "anchor_text": "Part II"}, {"url": "https://pratima.io/neural-network-bread-recipe-generation-iii/", "anchor_text": "Part III"}, {"url": "https://github.com/pratima-personal/bread-recipe-generator/blob/master/scrape_web.py", "anchor_text": "query the website for webpages"}, {"url": "http://www.thefreshloaf.com/node/{page_idx}'", "anchor_text": "http://www.thefreshloaf.com/node/{page_idx}'"}, {"url": "http://www.thefreshloaf.com/node/{page_idx", "anchor_text": "http://www.thefreshloaf.com/node/{page_idx"}, {"url": "https://github.com/pratima-personal/bread-recipe-generator/blob/master/recipe-builder.ipynb", "anchor_text": "Jupyter notebook"}, {"url": "https://www.nltk.org/", "anchor_text": "NLTK corpus"}, {"url": "https://github.com/amueller/word_cloud", "anchor_text": "word cloud"}, {"url": "https://pratima.io/neural-network-bread-recipe-generation-ii/", "anchor_text": "parts II"}, {"url": "https://pratima.io/neural-network-bread-recipe-generation-iii/", "anchor_text": "III"}, {"url": "https://pratima.io/neural-network-bread-recipe-generation-i/", "anchor_text": "Originally published on author\u2019s blog on July 22, 2020"}, {"url": "https://medium.com/tag/data-science?source=post_page-----d872e15b1d1c---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----d872e15b1d1c---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/data-visualization?source=post_page-----d872e15b1d1c---------------data_visualization-----------------", "anchor_text": "Data Visualization"}, {"url": "https://medium.com/tag/neural-networks?source=post_page-----d872e15b1d1c---------------neural_networks-----------------", "anchor_text": "Neural Networks"}, {"url": "https://medium.com/tag/editors-pick?source=post_page-----d872e15b1d1c---------------editors_pick-----------------", "anchor_text": "Editors Pick"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fd872e15b1d1c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fneural-network-for-generating-bread-recipes-d872e15b1d1c&user=Pratima+Satish&userId=c1e7bd14f114&source=-----d872e15b1d1c---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fd872e15b1d1c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fneural-network-for-generating-bread-recipes-d872e15b1d1c&user=Pratima+Satish&userId=c1e7bd14f114&source=-----d872e15b1d1c---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fd872e15b1d1c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fneural-network-for-generating-bread-recipes-d872e15b1d1c&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----d872e15b1d1c--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fd872e15b1d1c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fneural-network-for-generating-bread-recipes-d872e15b1d1c&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----d872e15b1d1c---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----d872e15b1d1c--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----d872e15b1d1c--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----d872e15b1d1c--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----d872e15b1d1c--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----d872e15b1d1c--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----d872e15b1d1c--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----d872e15b1d1c--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----d872e15b1d1c--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@pratimasatish92?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@pratimasatish92?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Pratima Satish"}, {"url": "https://medium.com/@pratimasatish92/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "9 Followers"}, {"url": "http://pratima.io", "anchor_text": "pratima.io"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fc1e7bd14f114&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fneural-network-for-generating-bread-recipes-d872e15b1d1c&user=Pratima+Satish&userId=c1e7bd14f114&source=post_page-c1e7bd14f114--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fusers%2Fc1e7bd14f114%2Flazily-enable-writer-subscription&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fneural-network-for-generating-bread-recipes-d872e15b1d1c&user=Pratima+Satish&userId=c1e7bd14f114&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}