{"url": "https://towardsdatascience.com/airbnb-price-prediction-multilayer-perceptrons-with-tensorflows-keras-api-9096e7d0c340", "time": 1683014191.4978611, "path": "towardsdatascience.com/airbnb-price-prediction-multilayer-perceptrons-with-tensorflows-keras-api-9096e7d0c340/", "webpage": {"metadata": {"title": "Airbnb Price Prediction: Multilayer Perceptrons with TensorFlow\u2019s Keras API | by Andrew Nguyen | Towards Data Science", "h1": "Airbnb Price Prediction: Multilayer Perceptrons with TensorFlow\u2019s Keras API", "description": "Deep Learning was an indigestible field when I first encountered it during my journey to, hopefully, becoming a Data Scientist. The reason why I initially and biasedly assumed its puzzling complexity\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.kaggle.com/stevezhenghp/airbnb-price-prediction", "anchor_text": "here", "paragraph_index": 2}, {"url": "https://www.youtube.com/watch?v=aircAruvnKk&list=PLZHQObOWTQDNU6R1_67000Dx_ZCJB-3pi", "anchor_text": "here", "paragraph_index": 17}], "all_paragraphs": ["Deep Learning was an indigestible field when I first encountered it during my journey to, hopefully, becoming a Data Scientist. The reason why I initially and biasedly assumed its puzzling complexity was due to the underlying logic and mechanism of such field. However, after taking some time to absorb the great applicability of Deep Learning in general and Neural Networks in particular, I started to grow interest in leveraging it into solving Data Science problems.", "Before jumping into the project, I would like to draw attention to the heated comparison between Machine Learning and Deep Learning that might have flashed through our mind, at least once. In essence, while Machine Learning uses algorithm to decode medium-to-large-scale data to make decisions, Deep Learning creates multi-layer neural networks that take longer time to train to produce higher-accuracy models.", "If you\u2019re keen to give the first shot with Deep Learning, feel free to check out the dataset publicly shared by Kaggle here and follow the following content.", "As a data analyst/data scientist, 70% of our time is and should be well spent on data cleaning and preparation before making it usable for modelling.", "NOTE: As this article focuses on developing a neural network model, I will only go through the important actions in EDA but you can check out the full-fledged EDA in my Github repository at the end of the content.", "What instantly struck me after loading the dataset is the \u201camenities\u201d variable, which embeds unstructured values per each row. If it was structured as a JSON field, it would be easier for us to flatten it and parse each sub-variables into different columns. However, from my observation, the variable includes different items of amenities for each listing, so to make it more usable, I decided to format the values and consolidate the unique ones to calculate the percentage of amenities of each listing to the total:", "Then, I proceeded to check whether there is null values to either remove or fill with actual values:", "Also, as we all might know well, outliers are relatively sensitive to the modelling process, so we should handle outliers (either remove or convert) carefully so that the model can learn the data more efficiently.", "Since price variable follows a Gaussian Distribution, we will create a function that removes the outliers that fall out of our fixed range:", "Similar to machine learning\u2019s modelling, feature engineering helps pre-process and convert the raw dataset to a more digestible one to train the model.", "Except those numeric variables, we need to transform the categorical ones that the model can understand and learn from. In short, we will apply different techniques for binary and multi-class variables: Label Encoder and OneHotEncoder respectively. However, it is imperative that we always split the dataset into train and test set before conducting any pre-processing steps, to avoid data leakage during the modelling.", "Then, we import Label Encoder and OneHotEncoder for the transformation: fitting on the train set and transforming on both.", "Besides, as each variable has a different range of data, we need to apply scaling to independent variables so that the model can learn the data faster and more efficiently. In this case, I chose MinMaxScaler to compress the data to the range of (0,1), which will be useful to the algorithms we will be using in the following section:", "What is Neural Networks and why do we need to combine modelling and optimization concurrently?", "Before jumping into what Neural Networks is, I would like to highlight the convention that we just don\u2019t stop at modelling phase; rather, it\u2019s a continuous procedure of building the model and testing different parameters that produce the model with the highest accuracy.", "Back to the concept of Neural Networks, in short:", "A neural network is a series of algorithms that endeavours to recognize underlying relationships in a set of data through a process that mimics the way the human brain operates. \u2014 Investopedia.", "If you want a more deep-dive into the concept, please check out the series of videos by 3Blue1Brown here which provides a full-fledged explanation on the underlying items of a neural network.", "In Deep learning, particularly Neural Networks, there are 3 common standard models that we use to make predictions: Multilayer Perceptrons (MLP), Convolutional Neural Networks (CNN) and Recurrent Neural Networks (RNN). For this project, I\u2019ve started off with MLP to acquire the underlying concepts in deep learning, but please look out for my upcoming projects that tackles data science problems with a more advanced model.", "So, what exactly is MLP and what does it do to make predictions?", "A Multilayer Perceptron model, or MLP for short, is a standard fully connected neural network model. It is comprised of layers of nodes where each node is connected to all outputs from the previous layer and the output of each node is connected to all inputs for nodes in the next layer. \u2014 Machinelearningmastery.com", "TensorFlow and Keras is an open-source library that is able to perform various tasks in deep learning, namely regression and classification. Because of its complexity, several steps need to be followed:", "To explain in more details, let\u2019s have a look at the full-step implementation of an MLP model as below:", "Alrighty, that\u2019s all the core parameters that we should be familiar in neural networks. Now let\u2019s print out the result and the learning curve of the 1st-trial model above.", "As seen, we achieved the MAE of 0.3356 with the setting of the above model. Let\u2019s set this number as the benchmark and see if we can get a smaller MAE as we optimize the model.", "A quick summary of all the optimization methods I will be using below for your reference:", "For (1) method, I wanted to see if reducing the number of independent variables (features) or selecting the more important ones helps improve the model or not. Two options I relied on are Correlation Heatmap (manual selection) and PCA (machine-learned selection):", "As you can see, not all features are highly correlated with the target variable (price) based on the colour scale. Therefore, I\u2019ve selected only the variables that has better correlation with the target (highly positive/negative) but it seems that the model did not improve any better: MAE > the benchmark.", "With PCA, the model did not improve much either, but MAE of this model is better than that we manually selected the features:", "For (2) method, I wanted to see if increasing model complexity by adding several additional layers would help decrease the MAE value or not.", "If the 1st model has only 2 hidden layers with 16 and 8 nodes respectively, I added 2 additional layers on top of the existing and also increased the number of nodes. As below, the model has slightly improved compared to the above methods, but still not significant enough compared to the benchmark.", "For (3) method, I wanted to test a different optimizer other than the usual \u201cadam\u201d that is commonly recommended: \u201crmsprop\u201d. No improvement was seen but it is remarkable that the model fluctuates often during the training (as you can see from the orange line \u2014 evaluation on the test set):", "For (4) method, the number of epochs might influence on the result of the model. If you\u2019re familiar with machine learning, you will have the same concern as mine \u2014 \u201cHow many epochs are enough to train the model?\u201d Frankly speaking, we can\u2019t tell the exact number rather than test and learn. However, Keras comes up EarlyStopping which helps stop the model from further looping/training that might lead to overfitting.", "For implementation, we just need to define the variable of EarlyStopping and set the \u201cpatience\u201d as the threshold that the model will stop learning if passing:", "If you see above, I set monitor = \u2018val_loss\u2019 and patience = 5, meaning if the val_loss value (test set) is higher than loss value (train set) after 5 consecutive epochs, the model will stop learning. As below, the model stops at the 20+ epochs. This method not only prevents the model from overfitting but also improves the runtime of the model significantly.", "For (5) method, regularization is a technique that makes modifications to the model as it learns in order to generalize better. This is achieved by minimizing the out-of-sample test error as the model learns, which also helps reduce overfitting. You might have heard of \u201cL1/L2 regularizer\u201d in machine learning, which shrinks the features, but we also have another common regularizer in neural network \u2014 DropOut. Let\u2019s see which performs better with our current dataset:", "Voila! Finally, the model has improved, even slightly significantly as compared to the 1st model thanks to L1 Regularizer!", "For (6) method, testing different combinations of activations and initializers is a good and easy way to see if the model improves. Below are the common combinations used in practice:", "However, with this dataset, no improvement is seen, so we can pass this method.", "Moving to the last one, it is recommended to test smaller batch size as we optimize the model, since smaller batch size offers better regularizing effect/lower generalization error as well as improve the runtime.", "Voila! That\u2019s the end of this project \u2014 Airbnb Price Prediction with TensorFlow\u2019s Keras API. I hope you find this article useful and easy to follow.", "Do look out for my upcoming projects in Data Science and Machine Learning in the near future! In the meantime feel free to check out my Github here for the complete repository:", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "A data analyst, without a higher degree, aspires to master data science skillsets by on-the-side projects."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F9096e7d0c340&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fairbnb-price-prediction-multilayer-perceptrons-with-tensorflows-keras-api-9096e7d0c340&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fairbnb-price-prediction-multilayer-perceptrons-with-tensorflows-keras-api-9096e7d0c340&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fairbnb-price-prediction-multilayer-perceptrons-with-tensorflows-keras-api-9096e7d0c340&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fairbnb-price-prediction-multilayer-perceptrons-with-tensorflows-keras-api-9096e7d0c340&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----9096e7d0c340--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----9096e7d0c340--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@andrewnguyen07?source=post_page-----9096e7d0c340--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@andrewnguyen07?source=post_page-----9096e7d0c340--------------------------------", "anchor_text": "Andrew Nguyen"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fb7da2b6ca9c2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fairbnb-price-prediction-multilayer-perceptrons-with-tensorflows-keras-api-9096e7d0c340&user=Andrew+Nguyen&userId=b7da2b6ca9c2&source=post_page-b7da2b6ca9c2----9096e7d0c340---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F9096e7d0c340&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fairbnb-price-prediction-multilayer-perceptrons-with-tensorflows-keras-api-9096e7d0c340&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F9096e7d0c340&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fairbnb-price-prediction-multilayer-perceptrons-with-tensorflows-keras-api-9096e7d0c340&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@tvick?utm_source=medium&utm_medium=referral", "anchor_text": "Taylor Vick"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://www.kaggle.com/stevezhenghp/airbnb-price-prediction", "anchor_text": "here"}, {"url": "https://www.youtube.com/watch?v=aircAruvnKk&list=PLZHQObOWTQDNU6R1_67000Dx_ZCJB-3pi", "anchor_text": "here"}, {"url": "https://github.com/andrewnguyen07", "anchor_text": "https://github.com/andrewnguyen07"}, {"url": "http://www.linkedin.com/in/andrewnguyen07", "anchor_text": "www.linkedin.com/in/andrewnguyen07"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----9096e7d0c340---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----9096e7d0c340---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----9096e7d0c340---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/tensorflow?source=post_page-----9096e7d0c340---------------tensorflow-----------------", "anchor_text": "TensorFlow"}, {"url": "https://medium.com/tag/neural-networks?source=post_page-----9096e7d0c340---------------neural_networks-----------------", "anchor_text": "Neural Networks"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F9096e7d0c340&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fairbnb-price-prediction-multilayer-perceptrons-with-tensorflows-keras-api-9096e7d0c340&user=Andrew+Nguyen&userId=b7da2b6ca9c2&source=-----9096e7d0c340---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F9096e7d0c340&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fairbnb-price-prediction-multilayer-perceptrons-with-tensorflows-keras-api-9096e7d0c340&user=Andrew+Nguyen&userId=b7da2b6ca9c2&source=-----9096e7d0c340---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F9096e7d0c340&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fairbnb-price-prediction-multilayer-perceptrons-with-tensorflows-keras-api-9096e7d0c340&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----9096e7d0c340--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F9096e7d0c340&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fairbnb-price-prediction-multilayer-perceptrons-with-tensorflows-keras-api-9096e7d0c340&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----9096e7d0c340---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----9096e7d0c340--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----9096e7d0c340--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----9096e7d0c340--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----9096e7d0c340--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----9096e7d0c340--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----9096e7d0c340--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----9096e7d0c340--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----9096e7d0c340--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@andrewnguyen07?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@andrewnguyen07?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Andrew Nguyen"}, {"url": "https://medium.com/@andrewnguyen07/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "112 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fb7da2b6ca9c2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fairbnb-price-prediction-multilayer-perceptrons-with-tensorflows-keras-api-9096e7d0c340&user=Andrew+Nguyen&userId=b7da2b6ca9c2&source=post_page-b7da2b6ca9c2--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F8c293f8ae6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fairbnb-price-prediction-multilayer-perceptrons-with-tensorflows-keras-api-9096e7d0c340&newsletterV3=b7da2b6ca9c2&newsletterV3Id=8c293f8ae6&user=Andrew+Nguyen&userId=b7da2b6ca9c2&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}