{"url": "https://towardsdatascience.com/pandas-and-sql-together-a-premier-league-and-player-scouting-example-b41713a5dd3e", "time": 1682996203.489161, "path": "towardsdatascience.com/pandas-and-sql-together-a-premier-league-and-player-scouting-example-b41713a5dd3e/", "webpage": {"metadata": {"title": "Pandas and SQL together, a Premier League and Player Scouting Example | by Stephen Fordham | Towards Data Science", "h1": "Pandas and SQL together, a Premier League and Player Scouting Example", "description": "The Python Pandas library makes transferring tabular data from one platform to another simple. This tutorial aims to show you how to move data between a Pandas DataFrame, an SQL database and a Excel\u2026"}, "outgoing_paragraph_urls": [{"url": "https://docs.sqlalchemy.org/en/13/core/engines.html", "anchor_text": "https://docs.sqlalchemy.org/en/13/core/engines.html", "paragraph_index": 8}, {"url": "https://www.kaggle.com/karangadiya/fifa19", "anchor_text": "The data-set below was sourced from Kaggle", "paragraph_index": 16}, {"url": "https://github.com/StephenFordham", "anchor_text": "https://github.com/StephenFordham", "paragraph_index": 30}], "all_paragraphs": ["The Python Pandas library makes transferring tabular data from one platform to another simple. This tutorial aims to show you how to move data between a Pandas DataFrame, an SQL database and a Excel spreadsheet, all through the use of Pandas. So wherever your data initially resides, you can transfer it into a format you feel comfortable analyzing and manipulating.", "It is often necessary to shuttle data from one platform to another. It may be useful to transform an SQL Table/Query into a Pandas DataFrame. In order to begin, as a prerequisite, 3 modules must be installed. These include; pandas, sqlalchemy, and PyMySQL.", "Here, the Premier League Table is in the \u2018football\u2019 Table within MySQL. The goal is to transform this Table into a Pandas DataFrame.", "To start, import the Pandas module as the alias pd, following convention, and import the sqlalchemy module. Following this, it is necessary to make a connection between Python and the MySQL database. Fortunately, the sqlalchemy module provides a function called .create_engine() that enables this connection to be established.", "The string inside the .create_engine() function is called the connection string.", "The create_engine() function produces an Engine object based on a URL. These URLs are usually formatted with a username, password, hostname, and a database name. The typical format of a database URL is:", "For clarity: \u2018mysql+pymysql\u2019 indicates that I am using mysql as my database management system, and functions within the module pymysql to interface with this database management system (DBMS).", "username = root, password =****, hostname = localhost, and database name = football_db.", "To match the Engine Configuration using your particular DBMS, you should consult https://docs.sqlalchemy.org/en/13/core/engines.html for the connection string formatting specifics. Now, when I run the code in my Jupyter Notebook, the DataFrame appears. To confirm, I can simply use the type function which indicates I have a Pandas DataFrame.", "A useful question here would be; why would we want to transform the SQL football Table into a Pandas DataFrame?", "To illustrate, one of many possible reasons, it is now possible to style the DataFrame and thereby enhance its readability for intended audiences. Here, two useful functions are defined; one which colours the goal difference column using conditional formatting, green if the goal difference is positive and red if it is negative. We can even go one step further, and define a function which magnifies the cells as the user scrolls over them. This would not be possible in MySQL.", "To read a query from SQL into a Pandas DataFrame, we first write the query in its native language, here, SQL. I have assigned this query the variable name query_1, and as it extends over multiple lines I have included the query within triple quotes. This query can then be read by adding its variable name and the engine as parameters to the pd.read_sql_query() method. As shown below, the query is now a Pandas DataFrame.", "Exporting the newly created DataFrame is possible using the pd.to_excel() method. Specify the filename of your choosing, here I chose \u2018goals_game_stats.xlsx\u2019, as this seems appropriate. Include the filename extension .xls if you have the xlwt module installed or the .xlsx extension if you have the openpyxl module installed.", "Its seems unnecessary to include the index specified with the Pandas DataFrame, so I simply set the optional parameter index to False, and the index is then subsequently omitted from the corresponding Excel file. The Pandas Parsers really do make data transfer that bit easier!", "\u2026 and a bit of scouting for Barcelona F.C", "To go full circle, I thought I would finish this tutorial, by demonstrating how Pandas can be used to export an Excel File to MySQL for querying. As all the examples have been based on the Premier League, I think it would be good to use a new data-set. To this end, lets investigate the best football players in the world. Here is a brief look at the players and some of the columns in the Excel Spreadsheet.", "The data-set below was sourced from Kaggle.", "I save this data-set as a comma separated values (CSV) file, and use the pd.read_csv() method, with the encoding set to \u2018latin-1\u2019 to parse the Excel file. To confirm parsing has worked, I use the head method on the players_data DataFrame. The DataFrame displayed below skips the middle columns. If we want to check all 55 columns are present, a nice method to use is the pd.set_options() where I set the \u2018display.max_columns\u2019 to 60 to be inclusive of all my columns. The video now shows all the columns are included, and have been correctly parsed.", "I can now connect to my \u2018football_db\u2019 through my Python Script. I then write a query to create a Table. The Table name player_name seems appropriate. Following this, I specify the columns and their corresponding datatypes, before executing this query using my cursor.", "I use the DataFrame.to_sql () method, in my case, players_data.to_sql() method, and write this DataFrame to the newly created Table, \u2018player_data\u2019, connect with the engine mentioned earlier, omit the index, and set the \u2018if_exists\u2019 argument to \u2018append\u2019 to add the data to the Table.", "The Table that was originally from Excel has now been imported into the MySQL database. It is perfectly set up for querying now.", "Let\u2019s see who the 5 best players in the World are based on their \u2018Overall\u2019 and \u2018Potential\u2019 metrics.", "Or maybe we want to know who are the most impressive defenders. Ideally, the ideal defender should have good heading accuracy, reactions and marking attributes!", "With Barcelona\u2019s shock exit from the Champions League at the hands of Liverpool, summer recruitment will be a key objective at the Catalan Club. As I have given myself temporary head-scout status at Barcelona, it would be ideal to recruit a player with core Barcelona-esque attributes. I therefore need to query for a player that has a high work rate, is attacking minded, and has Finishing and Acceleration beyond 80. To run this query, I omit Messi, since he is already at Barcelona, and exclude Ronaldo on the basis he is destined to stay at Juventus F.C.", "Barcelona, if you need a chief-scout please get in touch!", "The query results turn up 5 players.", "With Barcelona rekindling their interest in Antoine Griezmann this summer to boost their Champions League ambitions next year, he could prove to be a costly recruit at a cool \u20ac78 M Euros according to our data-set.", "This tutorial has focused on how tabular data can be moved between an SQL database, a Pandas DataFrame and Excel. The Python Pandas library makes it simple to move data, in particular I like using Pandas when I need to import data from a DataFrame/SQL database to Excel. Hopefully, this tutorial has demonstrated how data transfer can be achieved.", "Let me know if you like the examples presented here, or whether I should switch to more financial/healthcare based examples in forthcoming tutorials.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Articles on Data Science and Programming https://github.com/StephenFordham"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fb41713a5dd3e&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpandas-and-sql-together-a-premier-league-and-player-scouting-example-b41713a5dd3e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpandas-and-sql-together-a-premier-league-and-player-scouting-example-b41713a5dd3e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpandas-and-sql-together-a-premier-league-and-player-scouting-example-b41713a5dd3e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpandas-and-sql-together-a-premier-league-and-player-scouting-example-b41713a5dd3e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----b41713a5dd3e--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----b41713a5dd3e--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@stephenfordham?source=post_page-----b41713a5dd3e--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@stephenfordham?source=post_page-----b41713a5dd3e--------------------------------", "anchor_text": "Stephen Fordham"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F5d3f46276e7e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpandas-and-sql-together-a-premier-league-and-player-scouting-example-b41713a5dd3e&user=Stephen+Fordham&userId=5d3f46276e7e&source=post_page-5d3f46276e7e----b41713a5dd3e---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb41713a5dd3e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpandas-and-sql-together-a-premier-league-and-player-scouting-example-b41713a5dd3e&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb41713a5dd3e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpandas-and-sql-together-a-premier-league-and-player-scouting-example-b41713a5dd3e&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/photos/lQpFRPrepQ8", "anchor_text": "Unsplash"}, {"url": "https://docs.sqlalchemy.org/en/13/core/engines.html", "anchor_text": "https://docs.sqlalchemy.org/en/13/core/engines.html"}, {"url": "https://www.kaggle.com/karangadiya/fifa19", "anchor_text": "The data-set below was sourced from Kaggle"}, {"url": "https://medium.com/tag/python?source=post_page-----b41713a5dd3e---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/data-science?source=post_page-----b41713a5dd3e---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/programming?source=post_page-----b41713a5dd3e---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/tag/sports?source=post_page-----b41713a5dd3e---------------sports-----------------", "anchor_text": "Sports"}, {"url": "https://medium.com/tag/data?source=post_page-----b41713a5dd3e---------------data-----------------", "anchor_text": "Data"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fb41713a5dd3e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpandas-and-sql-together-a-premier-league-and-player-scouting-example-b41713a5dd3e&user=Stephen+Fordham&userId=5d3f46276e7e&source=-----b41713a5dd3e---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fb41713a5dd3e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpandas-and-sql-together-a-premier-league-and-player-scouting-example-b41713a5dd3e&user=Stephen+Fordham&userId=5d3f46276e7e&source=-----b41713a5dd3e---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb41713a5dd3e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpandas-and-sql-together-a-premier-league-and-player-scouting-example-b41713a5dd3e&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----b41713a5dd3e--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fb41713a5dd3e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpandas-and-sql-together-a-premier-league-and-player-scouting-example-b41713a5dd3e&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----b41713a5dd3e---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----b41713a5dd3e--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----b41713a5dd3e--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----b41713a5dd3e--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----b41713a5dd3e--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----b41713a5dd3e--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----b41713a5dd3e--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----b41713a5dd3e--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----b41713a5dd3e--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@stephenfordham?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@stephenfordham?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Stephen Fordham"}, {"url": "https://medium.com/@stephenfordham/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "977 Followers"}, {"url": "https://github.com/StephenFordham", "anchor_text": "https://github.com/StephenFordham"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F5d3f46276e7e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpandas-and-sql-together-a-premier-league-and-player-scouting-example-b41713a5dd3e&user=Stephen+Fordham&userId=5d3f46276e7e&source=post_page-5d3f46276e7e--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fbd4ed43cae00&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpandas-and-sql-together-a-premier-league-and-player-scouting-example-b41713a5dd3e&newsletterV3=5d3f46276e7e&newsletterV3Id=bd4ed43cae00&user=Stephen+Fordham&userId=5d3f46276e7e&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}