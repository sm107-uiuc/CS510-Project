{"url": "https://towardsdatascience.com/minimal-pandas-subset-for-data-scientists-6355059629ae", "time": 1682997239.333966, "path": "towardsdatascience.com/minimal-pandas-subset-for-data-scientists-6355059629ae/", "webpage": {"metadata": {"title": "Minimal Pandas Subset for Data Scientists | by Rahul Agarwal | Towards Data Science", "h1": "Minimal Pandas Subset for Data Scientists", "description": "Data manipulation is a breeze with pandas, and it has become such a standard for it that a lot of parallelization libraries like Rapids and Dask are being created in line with Pandas syntax. There\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.kaggle.com/mlwhiz/minimal-pandas-subset", "anchor_text": "Kaggle Kernel", "paragraph_index": 8}, {"url": "https://towardsdatascience.com/three-great-additions-for-your-jupyter-notebooks-cd7373b00e96", "anchor_text": "this addition", "paragraph_index": 10}, {"url": "https://amzn.to/2Sru60d", "anchor_text": "Pandas", "paragraph_index": 92}, {"url": "https://www.kaggle.com/mlwhiz/minimal-pandas-subset", "anchor_text": "Kaggle Kernel", "paragraph_index": 97}, {"url": "https://coursera.pxf.io/0JMOOY", "anchor_text": "Intermediate level Python", "paragraph_index": 98}, {"url": "https://medium.com/@rahul_agarwal", "anchor_text": "Medium", "paragraph_index": 99}, {"url": "http://eepurl.com/dbQnuX", "anchor_text": "blog", "paragraph_index": 99}, {"url": "https://twitter.com/MLWhiz", "anchor_text": "@mlwhiz", "paragraph_index": 99}, {"url": "http://ko-fi.com/rahulagarwal", "anchor_text": "ko-fi.com/rahulagarwal", "paragraph_index": 101}], "all_paragraphs": ["Data manipulation is a breeze with pandas, and it has become such a standard for it that a lot of parallelization libraries like Rapids and Dask are being created in line with Pandas syntax.", "Still, I generally have some issues with it.", "There are multiple ways to doing the same thing in Pandas, and that might make it troublesome for the beginner user.", "This has inspired me to come up with a minimal subset of pandas functions I use while coding.", "I have tried it all, and currently, I stick to a particular way. It is like a mind map.", "Sometimes because it is fast and sometimes because it\u2019s more readable and sometimes because I can do it with my current knowledge. And sometimes because I know that a particular way will be a headache in the long run(think multi-index)", "This post is about handling most of the data manipulation cases in Python using a straightforward, simple, and matter of fact way.", "With a sprinkling of some recommendations throughout.", "I will be using a data set of 1,000 popular movies on IMDB in the last ten years. You can also follow along in the Kaggle Kernel.", "As good as the Jupyter notebooks are, some things still need to be specified when working with Pandas.", "Sometimes your notebook won\u2019t show you all the columns. Sometimes it will display all the rows if you print the dataframe. You can control this behavior by setting some defaults of your own while importing Pandas. You can automate it using this addition to your notebook.", "For instance, this is the setting I use.", "The first thing we do is reading the data source and so here is the code for that.", "Recommendation: I could also have used pd.read_table to read the file. The thing is that pd.read_csv has default separator as , and thus it saves me some code. I also genuinely don\u2019t understand the use of pd.read_table", "If your data is in some SQL Datasource, you could have used the following code. You get the results in the dataframe format.", "Always useful to see some of the data.", "You can use simple head and tail commands with an option to specify the number of rows.", "You can also see simple dataframe statistics with the following commands.", "Recommendation: Generally working with Jupyter notebook, I make it a point of having the first few cells in my notebook containing these snapshots of the data. This helps me see the structure of the data whenever I want to. If I don\u2019t follow this practice, I notice that I end up repeating the .head() command a lot of times in my code.", "For some reason Pandas lets you choose columns in two ways. Using the dot operator like df.Title and using square brackets like df['Title']", "I prefer the second version, mostly. Why?", "There are a couple of reasons you would be better off with the square bracket version in the longer run.", "Trust me. Saving a few characters is not worth it.", "Recommendation: Stop using the dot operator. It is a construct that originated from a different language(R) and respectfully should be left there.", "You might need a list of columns for some later processing.", "Sometimes you want to change the column names as per your taste. I don\u2019t like spaces in my column names, so I change them as such.", "I could have used another way.", "This is the one case where both of the versions are important. When I have to change a lot of column names, I go with the way above. When I have to change the name of just one or two columns I use:", "Sometimes you only need to work with particular columns in a dataframe. e.g., to separate numerical and categorical columns, or remove unnecessary columns. Let\u2019s say in our example; we don\u2019t need the description, director, and actor column.", "Very useful while debugging. If your code throws an error that you cannot add a str and int, you will like to run this command.", "apply and lambda are some of the best things I have learned to use with pandas.", "I use apply and lambda anytime I get stuck while building a complex logic for a new column or filter.", "You can create a new column in many ways.", "If you want a column that is a sum or difference of columns, you can pretty much use simple basic arithmetic. Here I get the average rating based on IMDB and Normalized Metascore.", "But sometimes we may need to build complex logic around the creation of new columns.", "To give you a convoluted example, let\u2019s say that we want to build a custom movie score based on a variety of factors.", "Say, If the movie is of the thriller genre, I want to add 1 to the IMDB rating subject to the condition that IMDB rating remains less than or equal to 10. And If a movie is a comedy I want to subtract one from the rating.", "Whenever I get a hold of such complex problems, I use apply/lambda. Let me first show you how I will do this.", "You should be able to create pretty much any logic using apply/lambda since you just have to worry about the custom function.", "Pandas make filtering and subsetting dataframes pretty easy. You can filter and subset dataframes using normal operators and &,|,~ operators.", "But sometimes we may need to do complex filtering operations.", "And sometimes we need to do some operations which we won\u2019t be able to do using just the above format.", "For instance: Let us say we want to filter those rows where the number of words in the movie title is greater than or equal to than 4.", "Trying the below will give you an error. Apparently, you cannot do anything as simple as split with a series.", "One way is first to create a column which contains no of words in the title using apply and then filter on that column.", "And that is a perfectly fine way as long as you don\u2019t have to create a lot of columns. But I prefer this:", "What I did here is that my apply function returns a boolean which can be used to filter.", "Now once you understand that you just have to create a column of booleans to filter, you can use any function/logic in your apply statement to get however complex a logic you want to build.", "Let us see another example. I will try to do something a little complex to show the structure.", "We want to find movies for which the revenue is less than the average revenue for that particular year?", "We have a function here which we can use to write any logic. That provides a lot of power for advanced filtering as long as we can play with simple variables.", "I even use apply to change the column types since I don\u2019t want to remember the syntax for changing column type and also since it lets me do much more complicated things.", "The usual syntax to change column type is astype in Pandas. So if I had a column named price in my data in an str format. I could do this:", "But sometimes it won\u2019t work as expected.", "You might get the error: ValueError: invalid literal for long() with base 10: \u201813,000\u2019. That is you cannot cast a string with \u201c,\u201d to an int. To do that we first have to get rid of the comma.", "After facing this problem time and again, I have stopped using astype altogether now and just use apply to change column types.", "progress_apply is a single function that comes with tqdm package.", "And this has saved me a lot of time.", "Sometimes when you have got a lot of rows in your data, or you end up writing a pretty complex apply function, you will see that apply might take a lot of time.", "I have seen apply taking hours when working with Spacy. In such cases, you might like to see the progress bar with apply.", "You can use tqdm for that.", "After the initial imports at the top of your notebook, just replace apply withprogress_apply and everything remains the same.", "Recommendation: Whenever you see that you have to create a column with custom complex logic, think of apply and lambda. Try using progress_apply too.", "groupby will come up a lot of times whenever you want to aggregate your data. Pandas lets you do this efficiently with the groupby function.", "There are a lot of ways that you can use groupby. I have seen a lot of versions, but I prefer a particular style since I feel the version I use is easy, intuitive, and scalable for different use cases.", "Now you see it is pretty simple. You just have to worry about supplying two primary pieces of information.", "reset_index() is a function that resets the index of a dataframe. I apply this function ALWAYS whenever I do a groupby, and you might think of it as a default syntax for groupby operations.", "Let us check out an example.", "You might also want to group by more than one column. It is fairly straightforward.", "Recommendation: Stick to one syntax for groupby. Pick your own if you don\u2019t like mine but stick to one.", "Sometimes we get data from different sources. Or someone comes to you with multiple files with each file having data for a particular year.", "How do we create a single dataframe from a single dataframe?", "Here we will create our use case artificially since we just have a single file. We are creating two dataframes first using the basic filter operations we already know.", "Here we start with two dataframes: movies_2006 containing info for movies released in 2006 and movies_2007 containing info for movies released in 2007. We want to create a single dataframe that includes movies from both 2006 and 2007", "Most of the data that you will encounter will never come in a single file. One of the files might contain ratings for a particular movie, and another might provide the number of votes for a movie.", "In such a case we have two dataframes which need to be merged so that we can have all the information in a single view.", "Here we will create our use case artificially since we just have a single file. We are creating two dataframes first using the basic column subset operations we already know.", "We need to have all this information in a single dataframe. How do we do this?", "We provide this merge function with four attributes- 1st DF, 2nd DF, join on which column and the joining criteria:['left','right','inner','outer']", "Recommendation: I usually always end up using left join. You will rarely need to join using outer or right. Actually whenever you need to do a right join you actually just really need a left join with the order of dataframes reversed in the merge function.", "Most of the time, we don\u2019t get data in the exact form we want.", "For example, sometimes we might have data in columns which we might need in rows.", "Let us create an artificial example again. You can look at the code below that I use to create the example, but really it doesn\u2019t matter.", "So we start from a working_df like this:", "Now, this is not particularly a great structure to have data in. We might like it better if we had a dataframe with only one column Genre and we can have multiple rows repeated for the same movie. So the movie \u2018Prometheus\u2019 might be having three rows since it has three genres. How do we make that work?", "So in this melt function, we provided five attributes:", "There is still one thing remaining. For Prometheus, we see that it is a thriller and the flag is 0. The flag 0 is unnecessary data we can filter out, and we will have our results. We keep only the genres with flag 1", "What if we want to go back?", "We need the values in a column to become multiple columns. How? We use pivot_table", "We provided four attributes to the pivot_table function.", "We can then fill the missing values by 0 using fillna", "Recommendation: Multiple columns to one column: melt and One column to multiple columns: pivot_table . There are other ways to do melt \u2014 stack and different ways to do pivot_table: pivot,unstack. Stay away from them and just use melt and pivot_table. There are some valid reasons for this like unstack and stack will create multi-index and we don\u2019t want to deal with that, and pivot cannot take multiple columns as the index.", "With Pandas, less choice is more", "Here I have tried to profile some of the most useful functions in pandas I end up using most often.", "Pandas is a vast library with a lot of functionality and custom options. That makes it essential that you should have a mindmap where you stick to a particular syntax for a specific thing.", "Here I have shared mine, and you can proceed with it and make it better as your understanding of the library grows.", "I hope you found this post useful and worth your time. I tried to make this as simple as possible, but you may always ask me or see the documentation for doubts.", "Whole code and data are posted in the Kaggle Kernel.", "Also, if you want to learn more about Python 3, I would like to call out an excellent course on Learn Intermediate level Python from the University of Michigan. Do check it out.", "I am going to be writing more of such posts in the future too. Let me know what you think about them. Follow me up at Medium or Subscribe to my blog to be informed about them. As always, I welcome feedback and constructive criticism and can be reached on Twitter @mlwhiz.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "4M Views. Bridging the gap between Data Science and Intuition. MLE@FB, Ex-WalmartLabs, Citi. Connect on Twitter @mlwhiz \u2615\ufe0f ko-fi.com/rahulagarwal"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F6355059629ae&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fminimal-pandas-subset-for-data-scientists-6355059629ae&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fminimal-pandas-subset-for-data-scientists-6355059629ae&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fminimal-pandas-subset-for-data-scientists-6355059629ae&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fminimal-pandas-subset-for-data-scientists-6355059629ae&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----6355059629ae--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----6355059629ae--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://mlwhiz.medium.com/?source=post_page-----6355059629ae--------------------------------", "anchor_text": ""}, {"url": "https://mlwhiz.medium.com/?source=post_page-----6355059629ae--------------------------------", "anchor_text": "Rahul Agarwal"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fe8cce06956c9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fminimal-pandas-subset-for-data-scientists-6355059629ae&user=Rahul+Agarwal&userId=e8cce06956c9&source=post_page-e8cce06956c9----6355059629ae---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F6355059629ae&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fminimal-pandas-subset-for-data-scientists-6355059629ae&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F6355059629ae&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fminimal-pandas-subset-for-data-scientists-6355059629ae&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://amzn.to/2Sru60d", "anchor_text": "Pandas"}, {"url": "https://www.kaggle.com/mlwhiz/minimal-pandas-subset", "anchor_text": "Kaggle Kernel"}, {"url": "https://towardsdatascience.com/three-great-additions-for-your-jupyter-notebooks-cd7373b00e96", "anchor_text": "this addition"}, {"url": "https://amzn.to/2Sru60d", "anchor_text": "Pandas"}, {"url": "https://www.kaggle.com/mlwhiz/minimal-pandas-subset", "anchor_text": "Kaggle Kernel"}, {"url": "https://coursera.pxf.io/0JMOOY", "anchor_text": "Intermediate level Python"}, {"url": "https://medium.com/@rahul_agarwal", "anchor_text": "Medium"}, {"url": "http://eepurl.com/dbQnuX", "anchor_text": "blog"}, {"url": "https://twitter.com/MLWhiz", "anchor_text": "@mlwhiz"}, {"url": "https://medium.com/tag/data-science?source=post_page-----6355059629ae---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/programming?source=post_page-----6355059629ae---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/tag/productivity?source=post_page-----6355059629ae---------------productivity-----------------", "anchor_text": "Productivity"}, {"url": "https://medium.com/tag/towards-data-science?source=post_page-----6355059629ae---------------towards_data_science-----------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----6355059629ae---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F6355059629ae&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fminimal-pandas-subset-for-data-scientists-6355059629ae&user=Rahul+Agarwal&userId=e8cce06956c9&source=-----6355059629ae---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F6355059629ae&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fminimal-pandas-subset-for-data-scientists-6355059629ae&user=Rahul+Agarwal&userId=e8cce06956c9&source=-----6355059629ae---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F6355059629ae&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fminimal-pandas-subset-for-data-scientists-6355059629ae&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----6355059629ae--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F6355059629ae&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fminimal-pandas-subset-for-data-scientists-6355059629ae&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----6355059629ae---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----6355059629ae--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----6355059629ae--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----6355059629ae--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----6355059629ae--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----6355059629ae--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----6355059629ae--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----6355059629ae--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----6355059629ae--------------------------------", "anchor_text": ""}, {"url": "https://mlwhiz.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://mlwhiz.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Rahul Agarwal"}, {"url": "https://mlwhiz.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "13.9K Followers"}, {"url": "http://ko-fi.com/rahulagarwal", "anchor_text": "ko-fi.com/rahulagarwal"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fe8cce06956c9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fminimal-pandas-subset-for-data-scientists-6355059629ae&user=Rahul+Agarwal&userId=e8cce06956c9&source=post_page-e8cce06956c9--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Ff41165c9f72f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fminimal-pandas-subset-for-data-scientists-6355059629ae&newsletterV3=e8cce06956c9&newsletterV3Id=f41165c9f72f&user=Rahul+Agarwal&userId=e8cce06956c9&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}