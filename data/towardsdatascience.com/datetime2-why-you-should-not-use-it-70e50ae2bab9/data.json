{"url": "https://towardsdatascience.com/datetime2-why-you-should-not-use-it-70e50ae2bab9", "time": 1683008469.4522529, "path": "towardsdatascience.com/datetime2-why-you-should-not-use-it-70e50ae2bab9/", "webpage": {"metadata": {"title": "Datetime2 \u2014 Why You Should (Not) Use It? | by Nikola Ilic | Towards Data Science", "h1": "Datetime2 \u2014 Why You Should (Not) Use It?", "description": "A few weeks ago, I was working on a business request to prepare a data integration scenario for customer surveys. After the initial conceptual phase and logical data modelling, during the physical\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.sqlservercentral.com/forums/topic/why-do-some-dbas-avoid-datetime2", "anchor_text": "this discussion", "paragraph_index": 16}, {"url": "https://sqlperformance.com/2016/04/sql-performance/surprises-dateadd", "anchor_text": "this great article", "paragraph_index": 23}, {"url": "http://data-mozart.com", "anchor_text": "data-mozart.com", "paragraph_index": 27}], "all_paragraphs": ["A few weeks ago, I was working on a business request to prepare a data integration scenario for customer surveys. After the initial conceptual phase and logical data modelling, during the physical data modelling phase, I was thinking about certain data types that will satisfy both business needs and ensure the best usage of SQL Server resources.", "My suggestion was to go with Datetime2 datatype for all DateTime columns, while my boss insisted on sticking with good old Datetime. He is an old-school guy, I thought, accustomed to using traditional data types, so I will prove him wrong and convince to switch to newer (and Microsoft recommended, by the way) data type.", "Before proceeding further, I need to briefly emphasize on main characteristics and differences between Datetime and Datetime2 data types.", "The following table gives a quick overview of those two:", "Datetime is a \u201ctraditional\u201d data type for storing data about date and time. It takes strictly 8 bytes of memory, 4 bytes for date part, and 4 bytes for the time part.", "So, let\u2019s check what is going on behind the scenes here:", "So, if we take the first 8 characters (0000ABC9) and convert that to the decimal system, we are getting 43977 integer value. This value shows a number of days since 1900\u201301\u201301, which can be tested as follows:", "Let us check the time part, by taking out the last 8 characters (00C5C100). Converting this to decimal, gave me 12960000. This number represents the number of clock ticks from midnight. And, since the accuracy is 1/300 seconds, we can do the following calculations in order to get more human-readable results:", "Datetime2 was introduced with SQL Server 2008, so it is here long enough to draw some comparisons with its \u201colder brother\u201d. The main difference is the way of data storage: while in Datetime type, the date comes first and then time, in Datetime2, 3 bytes, in the end, represents date part!", "Let\u2019s check with the same data as previously:", "So, we are taking the last 6 characters for a date (3 bytes), but the rightmost byte is the most important within Datatime2, so it goes first: 0B4124. Converting this to decimal and we get 737572. When we add this to a \u20180001\u201301\u201301\u2019 starting point of Datetime2 data type, we are getting our date (2020\u201305\u201328) back:", "For the time part, things become more complicated, because it depends on defined precision. In our case, it\u2019s 3 digit precision, but it can go up to 7 digits (which is the default, in case we haven\u2019t defined any specific value). Depending on precision, Datetime2 takes between 6 and 8 bytes of storage.", "Again, we got results as expected.", "Ok, this was a brief overview of both data types. When creating tables, in many cases one can\u2019t foresee the amount of data that will be stored in a specific table. Sometimes, you create a table believing that it won\u2019t go above a certain threshold, but after a while, you realize that your assumptions were not correct.", "However, we were definitely sure that this table will be BIG! When I say big, I\u2019m talking about probably close to 100 million rows after year or two. And, back to our original request to create optimal tables, I was thinking that storing data as Datetime2 with 2 digits precision (which takes 6 bytes), multiplying with at least 5 DateTime columns, can save us a lot of space on the distant run.", "Less storage needed, bigger precision, larger date range, SQL standard compliant\u2026", "But, I started to dig deeper. And tried to search the web to find experts\u2019 opinions on this topic. I thought, there has to be something with Datetime2 (I mean, my boss usually knows what he talks about, hehe). So, I\u2019ve found this discussion with quite well-documented shortcomings of Datetime2.", "The main issue is the lack of (simple) possibility to do basic math operations with dates, such as calculating the difference between two dates in days, hours, minutes, etc.", "Here is one basic example with Datetime type:", "If you try to do the same thing with Datetime2, you will get an error:", "Another really significant drawback is if you try to calculate the 1st day of the current month, which is a quite common scenario:", "But, you wouldn\u2019t expect that data type of this is: DATETIME, not DATETIME2!", "This means that every time you are doing comparisons using these calculations, you will finish with implicit data conversion!", "Another really important consideration comes from the fact that SQL Server can\u2019t use statistics properly for Datetime2 columns, due to a way data is stored (remember the reverse sequence of bytes previously explained). More on those issues in this great article written by Aaron Bertrand.", "Wrong estimations lead to non-optimal query plans, which decrease the performance and this is one more significant drawback.", "So, wrong estimations and bad query plans as a consequence, implicit data conversion in common use scenarios, impossibility to use basic math operations for date calculations\u2026", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Mozart \u2014 Make Music from your Data!| data-mozart.com | @DataMozart | Microsoft Data Platform MVP | Power BI Addict | Blogger, speaker, learner\u2026"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F70e50ae2bab9&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdatetime2-why-you-should-not-use-it-70e50ae2bab9&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdatetime2-why-you-should-not-use-it-70e50ae2bab9&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdatetime2-why-you-should-not-use-it-70e50ae2bab9&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdatetime2-why-you-should-not-use-it-70e50ae2bab9&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----70e50ae2bab9--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----70e50ae2bab9--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://datamozart.medium.com/?source=post_page-----70e50ae2bab9--------------------------------", "anchor_text": ""}, {"url": "https://datamozart.medium.com/?source=post_page-----70e50ae2bab9--------------------------------", "anchor_text": "Nikola Ilic"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F64005b7daa38&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdatetime2-why-you-should-not-use-it-70e50ae2bab9&user=Nikola+Ilic&userId=64005b7daa38&source=post_page-64005b7daa38----70e50ae2bab9---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F70e50ae2bab9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdatetime2-why-you-should-not-use-it-70e50ae2bab9&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F70e50ae2bab9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdatetime2-why-you-should-not-use-it-70e50ae2bab9&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@jontyson?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Jon Tyson"}, {"url": "https://unsplash.com/s/photos/time?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://www.sqlservercentral.com/forums/topic/why-do-some-dbas-avoid-datetime2", "anchor_text": "this discussion"}, {"url": "https://sqlperformance.com/2016/04/sql-performance/surprises-dateadd", "anchor_text": "this great article"}, {"url": "https://medium.com/tag/sql-server?source=post_page-----70e50ae2bab9---------------sql_server-----------------", "anchor_text": "Sql Server"}, {"url": "https://medium.com/tag/sql?source=post_page-----70e50ae2bab9---------------sql-----------------", "anchor_text": "Sql"}, {"url": "https://medium.com/tag/data-science?source=post_page-----70e50ae2bab9---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/data?source=post_page-----70e50ae2bab9---------------data-----------------", "anchor_text": "Data"}, {"url": "https://medium.com/tag/towards-data-science?source=post_page-----70e50ae2bab9---------------towards_data_science-----------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F70e50ae2bab9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdatetime2-why-you-should-not-use-it-70e50ae2bab9&user=Nikola+Ilic&userId=64005b7daa38&source=-----70e50ae2bab9---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F70e50ae2bab9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdatetime2-why-you-should-not-use-it-70e50ae2bab9&user=Nikola+Ilic&userId=64005b7daa38&source=-----70e50ae2bab9---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F70e50ae2bab9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdatetime2-why-you-should-not-use-it-70e50ae2bab9&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----70e50ae2bab9--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F70e50ae2bab9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdatetime2-why-you-should-not-use-it-70e50ae2bab9&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----70e50ae2bab9---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----70e50ae2bab9--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----70e50ae2bab9--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----70e50ae2bab9--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----70e50ae2bab9--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----70e50ae2bab9--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----70e50ae2bab9--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----70e50ae2bab9--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----70e50ae2bab9--------------------------------", "anchor_text": ""}, {"url": "https://datamozart.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://datamozart.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Nikola Ilic"}, {"url": "https://datamozart.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "2.1K Followers"}, {"url": "http://data-mozart.com", "anchor_text": "data-mozart.com"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F64005b7daa38&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdatetime2-why-you-should-not-use-it-70e50ae2bab9&user=Nikola+Ilic&userId=64005b7daa38&source=post_page-64005b7daa38--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F9fc5611a2826&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdatetime2-why-you-should-not-use-it-70e50ae2bab9&newsletterV3=64005b7daa38&newsletterV3Id=9fc5611a2826&user=Nikola+Ilic&userId=64005b7daa38&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}