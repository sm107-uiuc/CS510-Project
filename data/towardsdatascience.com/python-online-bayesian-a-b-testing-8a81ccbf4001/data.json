{"url": "https://towardsdatascience.com/python-online-bayesian-a-b-testing-8a81ccbf4001", "time": 1683010560.481814, "path": "towardsdatascience.com/python-online-bayesian-a-b-testing-8a81ccbf4001/", "webpage": {"metadata": {"title": "Python: Online Bayesian A/B Testing! | by Jake | Towards Data Science", "h1": "Python: Online Bayesian A/B Testing!", "description": "If you\u2019re anything like me, long before you were interested in data science, machine learning, etc, you gained your initial exposure to statistics through the social sciences. In domains such as\u2026"}, "outgoing_paragraph_urls": [{"url": "https://keisan.casio.com/exec/system/1180573226", "anchor_text": "graphing tool", "paragraph_index": 13}], "all_paragraphs": ["If you\u2019re anything like me, long before you were interested in data science, machine learning, etc, you gained your initial exposure to statistics through the social sciences. In domains such as psychology, sociology, etc, a study is often conducted over a period of time (that might be days, months, or even years.) In the case of novel experiments, the results are collected, maximum likelihood estimates are produced for the mean and variance, and confidence intervals are constructed.", "Alternatively, if we hypothesize that things don\u2019t function as described by the incumbent model (aka null hypothesis), we reference the existing data, examine the mean, variance, and confidence interval, collect data via a study (sample from the population) and compare our sample mean to the confidence interval. If the sample mean is extreme, we reject the null hypothesis and conclude, \u201cthe incumbent model\u2019s mean and variance are inaccurate, more study is required.\u201d Or we simply fail to reject the incumbent model\u2019s findings. What does extreme mean? It\u2019s a bit subjective \u2014 it means that the finding was highly improbable according to the incumbent model\u2019s distribution and an arbitrary threshold. (ie given the distribution, our sample would have only been observed to be so large (or larger) or so small (or smaller) 1% of the time and we arbitrarily decided that we would reject the incumbent model if such a finding had a 5% chance of occurrence (or an even lesser probability.)", "This is the frequentist paradigm. It\u2019s well-suited for situations where we have the luxury of waiting a long period of time to collect enough data to be pretty sure about the shape and central tendencies of our population of interest before acting on our understanding. Unfortunately, this approach is ill-suited for situations where we are short on resources (time and data) and need to make the best decision given what we presently know.", "Before we jump into Bayesian statistics, let\u2019s recap some key elements of the frequentist paradigm. the parameters that govern a distribution are fixed, we simply need to collect a big enough sample for our estimates (sample statistics) to converge on the true population parameters. Given that our parameters are inherently scalar values (fixed numbers), we articulate our confidence in these values through confidence intervals (in other words, in terms of how probable an observation would be under the current parameters\u2019 MLE estimates.)", "The Bayesian model rejects the idea that parameters are fixed and views them as distributions, themselves. This makes the math much, much less pleasant. However, it allows us to start with a belief about the parameter (prior), relate this belief to the data observed (likelihood), itself, consider all other possibilities (evidence), and returns new updated beliefs (posterior.) In other words, it\u2019s optimized for online learning and one such widely applicable example of online learning is A/B testing.", "Before we can jump into coding, let\u2019s talk strategy \u2014 if you\u2019ve googled Bayesian Statistics before, you\u2019ve likely heard of terms like Markov Chain Monte Carlo (MCMC methods). These methods were invented to sample from distributions that are extremely difficult (if not impossible) to integrate analytically and they\u2019re largely oriented about the evidence. See section 4 below on Bayes Rule.", "Bayes Rule summed up is (A) pick a prior distribution; it\u2019s your pre-inference beliefs about the parameter of interest. Then (B) choose a likelihood to model how surprising (or unsurprising) the data is, conditioned on the prior belief. And finally, (C) compare the numerator to the evidence. This is literally, the probability of observing the data under any value that the parameter could take on. The evidence evaluates to a constant value, which scales the numerator, such that it\u2019s a valid probability distribution (integrates to 1.)", "In reality, the more complex your model, the more painful computing the evidence will become. Enter conjugate priors. There are certain combinations of priors and likelihoods, which are \u201cconjugate to one another\u201d if the posterior (your updated beliefs about the parameter) takes the same shape as the prior (and is generally, easy to compute!)", "In this article, we will exploit a conjugate prior in order to reduce computational complexity! One such perfect example is the Beta prior, Binomial likelihood pairing \u2014 where the posterior distribution is also described by the Beta distribution.", "First things first, the Euler Beta Function is not the same as the Beta distribution; you will save yourself substantial confusion by committing this to memory now. See section 1 below. In fact, the Euler Beta Function is the denominator of the Beta Distribution (see section 3.) Its purpose is to scale the numerator such that the Beta distribution integrates to 1 (common theme\u2026)", "The Binomial Distribution describes a summation of Bernoulli trials. Theta is raised to the x power (how many successes) and multiplied by one minus theta raised to the n minus x power (failures in n trials.) The first term, read \u201cn choose x\u201d is the number of combinations (regardless of order) in which x total successes could occur in n trials. For our A/B test, we could be talking about any binary success/failure (slot machines conversions vs total website hits, etc) it\u2019s a reasonable likelihood choice.", "I warned you the evidence was very, very nasty didn\u2019t I? See section 4.3 below. Of note, our strategy relies on factoring constants out of the integral, namely, n-Choose-x divided by the the Euler Beta Function. After this, we can combine like terms easily, arriving at what looks very similar to another Euler Beta Function (the exponent values have changed, but this will prove to be beneficial.)", "Lastly, we combine it altogether. Yes, this is mildly terrifying. Notice that in equation 12 we factor n-Choose-x and Euler Beta Function out of the numerator. And in step 13, these values cancel out. In equation 14, we see that the denominator (again) has the same form as the Euler Beta Function, and so we replace it accordingly. Now, we see that the numerator and denominator follow a friendly pattern \u2014 the Beta distribution. This is excellent! We see that to compute our posterior distribution, we simply need four elements \u2014 A, B, X, and N, where A and B are our prior beliefs, X is the number of successes and N is the total number of trials. Neat!", "Let\u2019s explore how versatile and useful the Beta distribution is. I encourage you to experiment with this graphing tool. It helps understand why the Beta distribution is so helpful for modeling a parameter that influences binary outcomes.", "Let\u2019s start coding with a simple, one-arm-bandit example! We\u2019ll start with a uniform prior and gradually converge on the true parameter (25% chance of success, unrealistically high for a casino.) For those of you unaware, a one-arm-bandit is a slot machine. You insert a coin (or specified cost to play) pull the arm and a game will play where various icons spinning icons will either align (payout!) or not (bummer.)", "Okay, so what\u2019s this code doing? First, we do some regular imports. Next, we define a class called beta, which receives a and b as parameters. We initialize these to 1, each (aka the uniform prior.) Then we create a list where each element is either 1 or 0 based on an array of random values in the range (0,1) \u2014 if the value is below .25, we return 1, else 0. This mean of this list should be near 0.25, however, it might vary a bit due to only generating 100 samples. Next, we define a function, experiment, which divides this list into equally sized batches; for each batch, we find the wins and losses and update our Beta class instance\u2019s a and b parameters, accordingly. Since we covered all that math above, this part is easy!", "Consider the graph below. The order is as follows: Blue, Orange, Green, and Red. Blue is our uniform prior, we have no bias towards any specific value for theta to receive. In orange, we\u2019ve fed 25% of all data to our model; accordingly, we\u2019re less confident in our uniform prior in light of the likelihood (it\u2019s quite unlikely that the slot machine is completely random; in fact, it seems that it doesn\u2019t pay out all too often.) The posterior distribution plotted in orange becomes the prior belief of green. And this prior belief is likewise updated, converging on the true value of the parameter. recursively, the posterior of the previous batch becomes the prior of the new batch. Notice that the variance shrinks in each iteration (this is evident as the peak becomes more pronounced \u2014 it\u2019s both higher and tighter.)", "We\u2019ve worked through the math and seen how bayesian statistics could help us iteratively \u201czero-in\u201d on the true parameter, but this isn\u2019t exactly A/B testing. What\u2019s next?", "To move forward, let\u2019s consider why this is so advantageous to A/B testing. Note that in each iteration, we updated our beliefs, shrinking the variance about the mean. In a situation where we have multiple bandits (aptly named the multi-armed-bandit or MAB), it\u2019s a poor strategy to spend half of your funds on the first of two machines, and only then explore the second machine. We\u2019ve got to think as both a scientist and as a businessman. This is a great segue into the \u201cexploit-explore delima.\u201d If we only play one machine, we\u2019ll shrink the variance (of this one machine) quite a bit \u2014 but this doesn\u2019t answer the fundamental question, is it the best machine? Likewise, if we equally play all machines, we\u2019ll get a decent idea of what their means and variances are \u2014 but we haven\u2019t used this information to our advantage.", "There are several algorithms out there (which try) to answer this question; examples include epsilon greedy, UCB1, etc. These topics are a great introduction to reinforcement learning but we risk losing focus. As such, we\u2019ll keep it simple; we\u2019ll rotate through each machine in fixed-order and update each Beta class object\u2019s attributes using much the same methodology as in the previous iteration. Note, I\u2019ve made some simple code alterations such that (A) each distribution has a unique color and (B) the alpha (inverse of transparency) starts near 0 and increases towards 1 with each iteration. My goal is that you can (literally) see how our estimate of each machine\u2019s parameters zeroes in on their actual values.", "As you can see from above, the red estimate increased every round towards its true value (0.25), whereas the blue and green values both briefly estimated their means above the true parameter values. This shows that more data will always help fine tune our understanding of the data and it really is important to exploit and explore. I\u2019ll likely write on epsilon-greedy, UCB1, etc in the future! I hope these code blocks, the (tedious) proofs, and my attempts at intuitive explanations have helped you feel more comfortable with the Bayesian approach to A/B testing.", "Please comment if there are any specific topics you\u2019d like me to write about in the future!", "Thank you for reading \u2014 If you think my content is alright, please subscribe! :)", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Amazon Scientist, author/blogger, and continual learner"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F8a81ccbf4001&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpython-online-bayesian-a-b-testing-8a81ccbf4001&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpython-online-bayesian-a-b-testing-8a81ccbf4001&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpython-online-bayesian-a-b-testing-8a81ccbf4001&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpython-online-bayesian-a-b-testing-8a81ccbf4001&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----8a81ccbf4001--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----8a81ccbf4001--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@jacob.d.moore1?source=post_page-----8a81ccbf4001--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@jacob.d.moore1?source=post_page-----8a81ccbf4001--------------------------------", "anchor_text": "Jake"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F58a07ece941f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpython-online-bayesian-a-b-testing-8a81ccbf4001&user=Jake&userId=58a07ece941f&source=post_page-58a07ece941f----8a81ccbf4001---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F8a81ccbf4001&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpython-online-bayesian-a-b-testing-8a81ccbf4001&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F8a81ccbf4001&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpython-online-bayesian-a-b-testing-8a81ccbf4001&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://keisan.casio.com/exec/system/1180573226", "anchor_text": "graphing tool"}, {"url": "https://medium.com/tag/towards-data-science?source=post_page-----8a81ccbf4001---------------towards_data_science-----------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/tag/python?source=post_page-----8a81ccbf4001---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/statistics?source=post_page-----8a81ccbf4001---------------statistics-----------------", "anchor_text": "Statistics"}, {"url": "https://medium.com/tag/data-science?source=post_page-----8a81ccbf4001---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----8a81ccbf4001---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F8a81ccbf4001&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpython-online-bayesian-a-b-testing-8a81ccbf4001&user=Jake&userId=58a07ece941f&source=-----8a81ccbf4001---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F8a81ccbf4001&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpython-online-bayesian-a-b-testing-8a81ccbf4001&user=Jake&userId=58a07ece941f&source=-----8a81ccbf4001---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F8a81ccbf4001&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpython-online-bayesian-a-b-testing-8a81ccbf4001&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----8a81ccbf4001--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F8a81ccbf4001&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpython-online-bayesian-a-b-testing-8a81ccbf4001&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----8a81ccbf4001---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----8a81ccbf4001--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----8a81ccbf4001--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----8a81ccbf4001--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----8a81ccbf4001--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----8a81ccbf4001--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----8a81ccbf4001--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----8a81ccbf4001--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----8a81ccbf4001--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@jacob.d.moore1?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@jacob.d.moore1?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Jake"}, {"url": "https://medium.com/@jacob.d.moore1/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "1.7K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F58a07ece941f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpython-online-bayesian-a-b-testing-8a81ccbf4001&user=Jake&userId=58a07ece941f&source=post_page-58a07ece941f--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F22fa69989e9a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpython-online-bayesian-a-b-testing-8a81ccbf4001&newsletterV3=58a07ece941f&newsletterV3Id=22fa69989e9a&user=Jake&userId=58a07ece941f&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}