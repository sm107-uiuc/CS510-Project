{"url": "https://towardsdatascience.com/easy-outlier-detection-in-data-streams-3089bfefe528", "time": 1683003800.887857, "path": "towardsdatascience.com/easy-outlier-detection-in-data-streams-3089bfefe528/", "webpage": {"metadata": {"title": "Easy Outlier Detection in Data Streams | by Dr. Robert K\u00fcbler | Towards Data Science", "h1": "Easy Outlier Detection in Data Streams", "description": "Machines might output a lot of signals. It is often important to spot anomalies in real-time. Here, you can learn how to do it yourself!"}, "outgoing_paragraph_urls": [{"url": "https://towardsdatascience.com/introduction-to-streaming-algorithms-b71808de6d29", "anchor_text": "Streaming Algorithms", "paragraph_index": 0}, {"url": "https://towardsdatascience.com/introduction-to-streaming-algorithms-b71808de6d29", "anchor_text": "Streaming Algorithms", "paragraph_index": 10}, {"url": "https://dr-robert-kuebler.medium.com/membership", "anchor_text": "via this link", "paragraph_index": 32}, {"url": "https://www.linkedin.com/in/dr-robert-k%C3%BCbler-983859150/", "anchor_text": "LinkedIn", "paragraph_index": 35}], "all_paragraphs": ["In my last article, I have explained the concept of Streaming Algorithms and gave numerous examples of how to apply them. One of them was to calculate the rolling mean of a data stream without saving the elements from the stream. Now, I want to extend this example and present to you another use-case of streaming algorithms in the context of Outlier Detection.", "A problem like this can arise when we monitor the power consumption of a machine to detect any unusual behavior. If we see an increase of outliers (unusual observation), it might be an indicator of a default of this machine and might be worth inspecting.", "Outliers can be defined in various ways. In this article, we will use the following definition:", "An element in a data stream of numbers is considered an outlier if it is not within 3 standard deviations from the mean of the elements seen so far.", "This calls for a small example. Let us assume that we get the data 3, 2, 4, 3, 5, 3, 2, 10, 2, 3, 1, in this order. Let us further assume that we start with a mean and variance (and hence standard deviation) of zero, i.e. the first element will always be treated as an outlier if unequal zero.", "So, 3 is considered an outlier, because 3 > 0+3*0. Now we update the mean and the variance according to the elements seen so far, which is only the number 3. So the new mean is 3 and the variance is 0.", "The following numbers 3, 5, 3, and 2 are considered normal. Intuitively, we would consider the following number 10 an outlier again. Let us see what the algorithm does. The mean at this point is about 3.1 and the standard deviation is about 1. Since 10 > 3.1+3*1, 10 is considered an outlier, as we hoped for.", "If you continue with the last 3 elements, you will see that they are all normal.", "The Problem: To calculate the mean and standard deviation, we have to memorize all elements seen so far. If we have a system that outputs thousands or millions of elements per day, this is not an option.", "One way to solve this problem is to use a Streaming Algorithm that updates its internal state after each scanned element from the data stream. The internal state consists of the mean and the variance of all elements seen so far at any point, starting with a mean and variance of zero before seeing any element. To be precise, let m\u2099 be the mean and v\u2099 be the variance after seeing the n-th element of the data stream, with the additional definition m\u2080=v\u2080=0.", "In my article about Streaming Algorithms, we have seen how to update the mean only using the old mean, the latest element being scanned, and the number of elements seen so far. This means that we only have to store two numbers with this approach at any time, not n as with the naive approach. Let me show it again, denoting the i-th incoming elements of the data stream as a\u1d62:", "This formula was not difficult to develop, right? With it, we have a baseline of the size of the elements we expect. Now we just need the standard deviation that we can put around the mean to classify out incoming examples into outliers and normal data points. We do this by computing the variance and then just taking the square root of it to get to the standard deviation.", "We can find a recursive formula without much effort in this case, too. First, the variance after seeing n elements is given as", "Let us try to write this in terms of the n, v\u2099, and the latest element again. Since the variance depends on the mean, we also want to include m\u2099. Before we start, let us rearrange this formula to make things easier:", "Now, the goal is to get v\u2099 in there. One way to proceed is to start with the following easy rearrangement to isolate the sum of squares up until index n, which also appears as a term in v\u2099:", "Now, that we have the formulas, let us see how it works in Python!", "We can implement the above explanations in the following way:", "A note on this: The first line of the update method computes the variance, but without subtracting the current mean squared. In the second line, the current mean is calculated. In the third line, it is then subtracted from the variance since this was still missing in the first line.", "This will scan the data stream, which consists of 10000 normally distributed numbers in this example (we denote this as N(0, 1)), and prints outliers whenever they occur.", "If you plot the intervals of normal points together with the mean (in yellow), you get the following picture:", "The algorithm does what we expect! However, we did not see how it handles a shift in distribution so far, but only standard normally distributed numbers at all times.", "Let us test how the algorithm behaves when we do the following:", "This looks promising! Everything adapts automatically to the new data. When the mean of the data shifts from 0 to 2, we can see a lot of outliers, which makes sense. The more observations have of the new mean of 2, the fewer outliers are detected since being around 2 is the new normal.", "When changing the mean from 2 to -2, we can see even more outliers, since the change is much more severe. So far, so good.", "If you look at the right half of the plot, you can see that the adaption to the new data is quite slow. The mean and the standard deviation will go to the correct level again after some time, as you can see since the yellow line (mean) drops and also the green region gets narrower again. But until it levels out, no outliers are detected.", "To tackle this problem, we could only use the last k samples to compute the mean and standard deviation, since this breaks the influence of the first measurements. If we set k to infinity, we get our algorithm from before.", "The lower we set k, the faster the algorithm will adapt to new data. However, setting k too small might result in discarding outliers, since the algorithm thinks that the new data is just like this. In the extreme case of setting k=1, no element is considered an outlier, since only the latest element is considered.", "Depending on the use case, maybe several hundred or thousand should be fine.", "In this article, we have seen how to build a very simple outlier detection mechanism for data streams. Our algorithm does not need to store all the measurements, making it applicable very easily, also on extremely restricted hardware and with only constant storage. The algorithm even adapts to changes in the data, so manual updates are not necessary.", "The only thing to tweak is the adaption rate, which we did not cover in this article, but is an easy thing to do.", "I hope that you learned something new, interesting, and useful today. Thanks for reading!", "As the last point, if you", "why not do it via this link? This would help me a lot! \ud83d\ude0a", "To be transparent, the price for you does not change, but about half of the subscription fees go directly to me.", "Thanks a lot, if you consider supporting me!", "If you have any questions, write me on LinkedIn!", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Studied Mathematics, graduated in Cryptanalysis, working as a Senior Data Scientist. Interested in algorithms, probability theory, and machine learning."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F3089bfefe528&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Feasy-outlier-detection-in-data-streams-3089bfefe528&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Feasy-outlier-detection-in-data-streams-3089bfefe528&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Feasy-outlier-detection-in-data-streams-3089bfefe528&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Feasy-outlier-detection-in-data-streams-3089bfefe528&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://me.dm/@robertkuebler", "anchor_text": "Mastodon"}, {"url": "https://towardsdatascience.com/?source=post_page-----3089bfefe528--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----3089bfefe528--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://kuebler.ai/?source=post_page-----3089bfefe528--------------------------------", "anchor_text": ""}, {"url": "https://kuebler.ai/?source=post_page-----3089bfefe528--------------------------------", "anchor_text": "Dr. Robert K\u00fcbler"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F6d6b5fb431bf&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Feasy-outlier-detection-in-data-streams-3089bfefe528&user=Dr.+Robert+K%C3%BCbler&userId=6d6b5fb431bf&source=post_page-6d6b5fb431bf----3089bfefe528---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F3089bfefe528&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Feasy-outlier-detection-in-data-streams-3089bfefe528&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F3089bfefe528&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Feasy-outlier-detection-in-data-streams-3089bfefe528&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://towardsdatascience.com/introduction-to-streaming-algorithms-b71808de6d29", "anchor_text": "Streaming Algorithms"}, {"url": "https://towardsdatascience.com/introduction-to-streaming-algorithms-b71808de6d29", "anchor_text": "Streaming Algorithms"}, {"url": "https://dr-robert-kuebler.medium.com/membership", "anchor_text": "via this link"}, {"url": "https://www.linkedin.com/in/dr-robert-k%C3%BCbler-983859150/", "anchor_text": "LinkedIn"}, {"url": "https://medium.com/tag/streaming?source=post_page-----3089bfefe528---------------streaming-----------------", "anchor_text": "Streaming"}, {"url": "https://medium.com/tag/outlier-detection?source=post_page-----3089bfefe528---------------outlier_detection-----------------", "anchor_text": "Outlier Detection"}, {"url": "https://medium.com/tag/time-series-analysis?source=post_page-----3089bfefe528---------------time_series_analysis-----------------", "anchor_text": "Time Series Analysis"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----3089bfefe528---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----3089bfefe528---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F3089bfefe528&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Feasy-outlier-detection-in-data-streams-3089bfefe528&user=Dr.+Robert+K%C3%BCbler&userId=6d6b5fb431bf&source=-----3089bfefe528---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F3089bfefe528&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Feasy-outlier-detection-in-data-streams-3089bfefe528&user=Dr.+Robert+K%C3%BCbler&userId=6d6b5fb431bf&source=-----3089bfefe528---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F3089bfefe528&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Feasy-outlier-detection-in-data-streams-3089bfefe528&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----3089bfefe528--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F3089bfefe528&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Feasy-outlier-detection-in-data-streams-3089bfefe528&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----3089bfefe528---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----3089bfefe528--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----3089bfefe528--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----3089bfefe528--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----3089bfefe528--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----3089bfefe528--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----3089bfefe528--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----3089bfefe528--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----3089bfefe528--------------------------------", "anchor_text": ""}, {"url": "https://kuebler.ai/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://kuebler.ai/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Dr. Robert K\u00fcbler"}, {"url": "https://kuebler.ai/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "3K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F6d6b5fb431bf&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Feasy-outlier-detection-in-data-streams-3089bfefe528&user=Dr.+Robert+K%C3%BCbler&userId=6d6b5fb431bf&source=post_page-6d6b5fb431bf--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F11fae4bef4b2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Feasy-outlier-detection-in-data-streams-3089bfefe528&newsletterV3=6d6b5fb431bf&newsletterV3Id=11fae4bef4b2&user=Dr.+Robert+K%C3%BCbler&userId=6d6b5fb431bf&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}