{"url": "https://towardsdatascience.com/google-maps-feature-extraction-with-selenium-faa2b97b29af", "time": 1683006785.368413, "path": "towardsdatascience.com/google-maps-feature-extraction-with-selenium-faa2b97b29af/", "webpage": {"metadata": {"title": "Google Maps Feature Extraction with Selenium | by Kyle Pastor | Towards Data Science", "h1": "Google Maps Feature Extraction with Selenium", "description": "I plan this to be the first in a multi-part series of articles about the extraction of Google Maps data and doing some interesting path and time-based studies. A few examples are looking at traffic\u2026"}, "outgoing_paragraph_urls": [{"url": "http://kapastor.github.io/", "anchor_text": "http://kapastor.github.io/", "paragraph_index": 38}], "all_paragraphs": ["I plan this to be the first in a multi-part series of articles about the extraction of Google Maps data and doing some interesting path and time-based studies. A few examples are looking at traffic volumes over time and calculating a \u201cBeauty Score\u201d for a given route. The first step in this journey is to load image data from Google Maps automatically and extract features from those images. Let\u2019s get started.", "As for my toolkit, we are using Python for everything and leveraging the packages for Selenium (web browser emulator used for automation), Pillow (image handling library) and Matplotlib (plotting data values).", "My working environment is with Kaggle which is an online data and notebook website which is super useful. To start I must first install the required software to allow us to emulate a browser in order to extract the image data from Google Maps (in addition to some other data).", "The first step is to download and unpack a distribution of Firefox which will be our automated browser. This is the one I used:", "Once extracted note the location of your directory. To make it clean I created a new working directory for this project:", "Now copy the extracted files into this new directory and set the permissions to allow execution by all.", "Next, I needed to install a driver to allow for communication between python and firefox. While at it I also loaded the Selenium package.", "Finally, I got to my python code. In the Kaggle notebook, I ran the following to actually install the driver.", "Last but not least install some of the extra packages needed for running the code", "Remember that I am going to run a web browser in the background and use it to load Google Maps and extract some data. To do this in Python first load the packages from Selenium and instance a Firefox session.", "Next, I set up the browser options. I do not want an actual window of Firefox to get generated so instead I start it in \u201cheadless\u201d mode.", "Finally, I add the capabilities and instance the browser.", "At last, I can start to grab some Google Maps data.", "The next stage was to figure out the Google Maps URL I needed to use so I could navigate to it in Selenium. The format is as follows:", "Now I decided to select somewhere near the Toronto waterfront so I could get some park data for the area.", "I use this to generate a URL and navigate with my browser:", "At this point, the browser was holding all of the information for the website as if I had done it manually (Inspect in the browser). I wanted to take a look at the site so I just used the save_screenshot method in Selenium.", "One cool thing about Selenium is that you can:", "A) Parse the HTML to extract any page data", "B) Execute javascript on the page", "One extra thing I wanted to do was get the proper scaling of the image. For example, I want to know the actual area of parkland in a given map. What\u2019s nice is that Google Maps includes a scale bar in its render. This means I can select those elements to get the number of feet (what's shown on the actual page) as well as the width of the scale bar in pixels. Therefore I have the number of feet per pixel in the image!", "Since I am a Canadian I just converted this to meters:", "Next I had to clean up the image. As you can see there are some of the overlayed elements on the image (Search bar etc). If I want to extract features from the raw map then I had to get rid of them.", "Now that I have my image I want to extract some information on it. For this specific example, I want to know what the area of the green parkland covers in both a percentage and absolute terms (which is why I needed the scaling above). On top of this I want to make a nice animation of how the image is getting scanned and extracting the green.", "Since I am making animations I want to store the images in separate folders to keep things clean. I do this for the scanning and line chart plotting:", "Now I do the meat of the coding. I define a function that is able to scan over the pixels of the image and determine if they fall within a certain RGB range (with some slack). I also pass in an image object to allow for snapshots to be taken during the extraction. I basically overwrite all pixels to be white, and only if the pixel falls within the range I keep the original colours:", "Now that the function is defined I can actually use it. Start with importing our image and animation libraries", "Open the image, convert to RGBA and load the pixels into an array", "One thing that I had to do manually was determine the colour parkland is given in Google Maps. I just used a tool to select the pixel on the screen to extract this. Now I set it up and give it a slack. The slack is used as a buffer in case some pixels have small colour variability. I pass this into the function we defined above", "At this point, I actually have everything I need! Great work! Time to get to animations. Remember how num_park contains the number of pixels that match at each column? This means I can plot this and create yet another animation. Using the image size I create a matplotlib figure and set all the background, axis and elements to white to get a blank slate.", "For image processing I want the images to be of the same scale so I went ahead and set the scaling in the figure", "Finally, loop over every 10th elements and create a line plot. Once created simply save it!", "I have all the images and data I need to make the final results.", "First I get the total_area from the extraction. Using the MetersPerPixel and the image size I can get the total area in km\u00b2", "Next, use PIL to create an animated GIF. In the bottom example, I am looping over every 10th frame to capture load the pre-generated images from above and adding them into a list of frames. This frame list will get passed to the animation function to produce the final file.", "As a final measure, I also overlay the animated matplotlib plot. The only difference is that we will use the .paste method of PIL to overlay the images.", "And there you have it! Now we can do some really interesting stuff like longitudinal traffic scanning or even look at a running route to see how cool the area around is!", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Analytics | Full Stack | Data Science | MS Physics + MS Quant Finance \u2192 http://kapastor.github.io/"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Ffaa2b97b29af&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgoogle-maps-feature-extraction-with-selenium-faa2b97b29af&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgoogle-maps-feature-extraction-with-selenium-faa2b97b29af&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgoogle-maps-feature-extraction-with-selenium-faa2b97b29af&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgoogle-maps-feature-extraction-with-selenium-faa2b97b29af&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----faa2b97b29af--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----faa2b97b29af--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://kapastor.medium.com/?source=post_page-----faa2b97b29af--------------------------------", "anchor_text": ""}, {"url": "https://kapastor.medium.com/?source=post_page-----faa2b97b29af--------------------------------", "anchor_text": "Kyle Pastor"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Ff30c680c570b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgoogle-maps-feature-extraction-with-selenium-faa2b97b29af&user=Kyle+Pastor&userId=f30c680c570b&source=post_page-f30c680c570b----faa2b97b29af---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ffaa2b97b29af&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgoogle-maps-feature-extraction-with-selenium-faa2b97b29af&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ffaa2b97b29af&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgoogle-maps-feature-extraction-with-selenium-faa2b97b29af&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "http://ftp.mozilla.org/pub/firefox/releases/63.0.3/linux-x86_64/en-US/firefox-63.0.3.tar.bz2", "anchor_text": "http://ftp.mozilla.org/pub/firefox/releases/63.0.3/linux-x86_64/en-US/firefox-63.0.3.tar.bz2"}, {"url": "https://www.google.com/maps/@'", "anchor_text": "https://www.google.com/maps/@"}, {"url": "https://www.google.com/maps/@'", "anchor_text": "https://www.google.com/maps/@'"}, {"url": "https://www.kaggle.com/kapastor/google-maps-feature-extraction-selenium-pil", "anchor_text": "Google Maps Feature Extraction - Selenium+PilExplore and run machine learning code with Kaggle Notebooks | Using data from multiple data sourceswww.kaggle.com"}, {"url": "https://medium.com/tag/python?source=post_page-----faa2b97b29af---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/programming?source=post_page-----faa2b97b29af---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/tag/google-maps?source=post_page-----faa2b97b29af---------------google_maps-----------------", "anchor_text": "Google Maps"}, {"url": "https://medium.com/tag/image-processing?source=post_page-----faa2b97b29af---------------image_processing-----------------", "anchor_text": "Image Processing"}, {"url": "https://medium.com/tag/data-science?source=post_page-----faa2b97b29af---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Ffaa2b97b29af&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgoogle-maps-feature-extraction-with-selenium-faa2b97b29af&user=Kyle+Pastor&userId=f30c680c570b&source=-----faa2b97b29af---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Ffaa2b97b29af&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgoogle-maps-feature-extraction-with-selenium-faa2b97b29af&user=Kyle+Pastor&userId=f30c680c570b&source=-----faa2b97b29af---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ffaa2b97b29af&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgoogle-maps-feature-extraction-with-selenium-faa2b97b29af&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----faa2b97b29af--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Ffaa2b97b29af&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgoogle-maps-feature-extraction-with-selenium-faa2b97b29af&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----faa2b97b29af---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----faa2b97b29af--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----faa2b97b29af--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----faa2b97b29af--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----faa2b97b29af--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----faa2b97b29af--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----faa2b97b29af--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----faa2b97b29af--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----faa2b97b29af--------------------------------", "anchor_text": ""}, {"url": "https://kapastor.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://kapastor.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Kyle Pastor"}, {"url": "https://kapastor.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "245 Followers"}, {"url": "http://kapastor.github.io/", "anchor_text": "http://kapastor.github.io/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Ff30c680c570b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgoogle-maps-feature-extraction-with-selenium-faa2b97b29af&user=Kyle+Pastor&userId=f30c680c570b&source=post_page-f30c680c570b--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fb174339fe204&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgoogle-maps-feature-extraction-with-selenium-faa2b97b29af&newsletterV3=f30c680c570b&newsletterV3Id=b174339fe204&user=Kyle+Pastor&userId=f30c680c570b&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}