{"url": "https://towardsdatascience.com/methods-for-dealing-with-imbalanced-data-5b761be45a18", "time": 1682994831.251822, "path": "towardsdatascience.com/methods-for-dealing-with-imbalanced-data-5b761be45a18/", "webpage": {"metadata": {"title": "Dealing with Imbalanced Data. Imbalanced classes are a common problem\u2026 | by Tara Boyle | Towards Data Science", "h1": "Dealing with Imbalanced Data", "description": "A guide to effectively handling imbalanced datasets in Python. Imbalanced classes are a common problem in machine learning where there are a disproportionate ratio of observations in each class."}, "outgoing_paragraph_urls": [{"url": "https://www.kaggle.com/mlg-ulb/creditcardfraud/home", "anchor_text": "Credit Card Fraud Detection Dataset", "paragraph_index": 3}, {"url": "https://www.kaggle.com/tboyle10/methods-for-dealing-with-imbalanced-data", "anchor_text": "here.", "paragraph_index": 3}, {"url": "https://imbalanced-learn.readthedocs.io/en/stable/index.html", "anchor_text": "imblearn\u2019s", "paragraph_index": 25}], "all_paragraphs": ["Imbalanced classes are a common problem in machine learning classification where there are a disproportionate ratio of observations in each class. Class imbalance can be found in many different areas including medical diagnosis, spam filtering, and fraud detection.", "In this guide, we\u2019ll look at five possible ways to handle an imbalanced class problem.", "Important Note: This guide will focus solely on addressing imbalanced classes and will not addressing other important machine learning steps including, but not limited to, feature selection or hyperparameter tuning.", "We will use the Credit Card Fraud Detection Dataset available on Kaggle. The dataset is high imbalanced, with only 0.17% of transactions being classified as fraudulent. The full notebook can be found here.", "Our objective will be to correctly classify the minority class of fraudulent transactions.", "Most machine learning algorithms work best when the number of samples in each class are about equal. This is because most algorithms are designed to maximize accuracy and reduce error.", "Here we can use the DummyClassifier to always predict \u201cnot fraud\u201d just to show how misleading accuracy can be.", "We got an accuracy score of 99.8% \u2014 And without even training a model! Let\u2019s compare this to logistic regression, an actual trained classifier.", "Maybe not surprisingly, our accuracy score decreased as compared to the dummy classifier above. This tells us that either we did something wrong in our logistic regression model, or that accuracy might not be our best option for measuring performance.", "Let\u2019s take a look at some popular methods for dealing with class imbalance.", "As we saw above, accuracy is not the best metric to use when evaluating imbalanced datasets as it can be very misleading. Metrics that can provide better insight include:", "Let\u2019s see what happens when we apply these F1 and recall scores to our logistic regression from above.", "These scores don\u2019t look quite so impressive. Let\u2019s see what other methods we might try to improve our new metrics.", "While in every machine learning problem, it\u2019s a good rule of thumb to try a variety of algorithms, it can be especially beneficial with imbalanced datasets. Decision trees frequently perform well on imbalanced data. They work by learning a hierarchy of if/else questions and this can force both classes to be addressed.", "While our accuracy score is slightly lower, both F1 and recall have increased as compared to logistic regression! It appears that for this specific problem, random forest may be a better choice of model.", "Our next method begins our resampling techniques.", "Oversampling can be defined as adding more copies of the minority class. Oversampling can be a good choice when you don\u2019t have a ton of data to work with.", "We will use the resampling module from Scikit-Learn to randomly replicate samples from the minority class.", "Always split into test and train sets BEFORE trying oversampling techniques! Oversampling before splitting the data can allow the exact same observations to be present in both the test and train sets. This can allow our model to simply memorize specific data points and cause overfitting and poor generalization to the test data.", "After resampling we have an equal ratio of data points for each class! Let\u2019s try our logistic regression again with the balanced training data.", "Our recall score increased, but F1 is much lower than with either our baseline logistic regression or random forest from above. Let\u2019s see if undersampling might perform better here.", "Undersampling can be defined as removing some observations of the majority class. Undersampling can be a good choice when you have a ton of data -think millions of rows. But a drawback is that we are removing information that may be valuable. This could lead to underfitting and poor generalization to the test set.", "We will again use the resampling module from Scikit-Learn to randomly remove samples from the majority class.", "Again, we have an equal ratio of fraud to not fraud data points, but in this case a much smaller quantity of data to train the model on. Let\u2019s again apply our logistic regression.", "Undersampling underperformed oversampling in this case. Let\u2019s try one more method for handling imbalanced data.", "A technique similar to upsampling is to create synthetic samples. Here we will use imblearn\u2019s SMOTE or Synthetic Minority Oversampling Technique. SMOTE uses a nearest neighbors algorithm to generate new and synthetic data we can use for training our model.", "Again, it\u2019s important to generate the new samples only in the training set to ensure our model generalizes well to unseen data.", "After generating our synthetic data points, let\u2019s see how our logistic regression performs.", "Our F1 score is increased and recall is similar to the upsampled model above and for our data here outperforms undersampling.", "We explored 5 different methods for dealing with imbalanced datasets:", "It appears for this particular dataset random forest and SMOTE are among the best of the options we tried here.", "These are just some of the many possible methods to try when dealing with imbalanced datasets, and not an exhaustive list. Some others methods to consider are collecting more data or choosing different resampling ratios \u2014 you don\u2019t have to have exactly a 1:1 ratio!", "You should always try several approaches and then decide which is best for your problem.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "I\u2019m passionate about all things data! I\u2019m interested in leveraging data to create business solutions."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F5b761be45a18&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmethods-for-dealing-with-imbalanced-data-5b761be45a18&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmethods-for-dealing-with-imbalanced-data-5b761be45a18&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmethods-for-dealing-with-imbalanced-data-5b761be45a18&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmethods-for-dealing-with-imbalanced-data-5b761be45a18&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----5b761be45a18--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----5b761be45a18--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@terrah27?source=post_page-----5b761be45a18--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@terrah27?source=post_page-----5b761be45a18--------------------------------", "anchor_text": "Tara Boyle"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F2a7b274f3032&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmethods-for-dealing-with-imbalanced-data-5b761be45a18&user=Tara+Boyle&userId=2a7b274f3032&source=post_page-2a7b274f3032----5b761be45a18---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F5b761be45a18&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmethods-for-dealing-with-imbalanced-data-5b761be45a18&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F5b761be45a18&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmethods-for-dealing-with-imbalanced-data-5b761be45a18&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/photos/ex_p4AaBxbs?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Ales Nesetril"}, {"url": "https://unsplash.com/search/photos/credit-card?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://www.kaggle.com/mlg-ulb/creditcardfraud/home", "anchor_text": "Credit Card Fraud Detection Dataset"}, {"url": "https://www.kaggle.com/tboyle10/methods-for-dealing-with-imbalanced-data", "anchor_text": "here."}, {"url": "https://imbalanced-learn.readthedocs.io/en/stable/index.html", "anchor_text": "imblearn\u2019s"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----5b761be45a18---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/python?source=post_page-----5b761be45a18---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/data-science?source=post_page-----5b761be45a18---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/towards-data-science?source=post_page-----5b761be45a18---------------towards_data_science-----------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/tag/class-imbalance?source=post_page-----5b761be45a18---------------class_imbalance-----------------", "anchor_text": "Class Imbalance"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F5b761be45a18&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmethods-for-dealing-with-imbalanced-data-5b761be45a18&user=Tara+Boyle&userId=2a7b274f3032&source=-----5b761be45a18---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F5b761be45a18&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmethods-for-dealing-with-imbalanced-data-5b761be45a18&user=Tara+Boyle&userId=2a7b274f3032&source=-----5b761be45a18---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F5b761be45a18&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmethods-for-dealing-with-imbalanced-data-5b761be45a18&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----5b761be45a18--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F5b761be45a18&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmethods-for-dealing-with-imbalanced-data-5b761be45a18&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----5b761be45a18---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----5b761be45a18--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----5b761be45a18--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----5b761be45a18--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----5b761be45a18--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----5b761be45a18--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----5b761be45a18--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----5b761be45a18--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----5b761be45a18--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@terrah27?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@terrah27?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Tara Boyle"}, {"url": "https://medium.com/@terrah27/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "1.2K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F2a7b274f3032&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmethods-for-dealing-with-imbalanced-data-5b761be45a18&user=Tara+Boyle&userId=2a7b274f3032&source=post_page-2a7b274f3032--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Feca374d3ba4a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmethods-for-dealing-with-imbalanced-data-5b761be45a18&newsletterV3=2a7b274f3032&newsletterV3Id=eca374d3ba4a&user=Tara+Boyle&userId=2a7b274f3032&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}