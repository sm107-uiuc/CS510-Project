{"url": "https://towardsdatascience.com/linear-regression-with-tensorflow-js-e7b39713572", "time": 1682997095.974489, "path": "towardsdatascience.com/linear-regression-with-tensorflow-js-e7b39713572/", "webpage": {"metadata": {"title": "House price prediction using Linear Regression with TensorFlow.js | by Venelin Valkov | Towards Data Science", "h1": "House price prediction using Linear Regression with TensorFlow.js", "description": "Build a Linear Regression model in TensorFlow.js to predict house prices. Learn how to handle categorical data and do feature scaling."}, "outgoing_paragraph_urls": [{"url": "https://www.kaggle.com/c/house-prices-advanced-regression-techniques/data", "anchor_text": "House Prices: Advanced Regression Techniques", "paragraph_index": 7}, {"url": "https://www.papaparse.com/", "anchor_text": "Papa Parse", "paragraph_index": 10}, {"url": "https://en.wikipedia.org/wiki/Root-mean-square_deviation", "anchor_text": "Root Mean Squared Error", "paragraph_index": 29}, {"url": "https://js.tensorflow.org/api/latest/#Tensors", "anchor_text": "Tensors", "paragraph_index": 31}, {"url": "https://en.wikipedia.org/wiki/One-hot", "anchor_text": "one-hot encoding", "paragraph_index": 35}, {"url": "https://js.tensorflow.org/api/latest/#oneHot", "anchor_text": "tf.oneHot()", "paragraph_index": 36}, {"url": "https://en.wikipedia.org/wiki/Feature_scaling", "anchor_text": "Feature scaling", "paragraph_index": 38}, {"url": "https://arxiv.org/abs/1502.03167", "anchor_text": "Feature scaling will help our model(s) learn faster", "paragraph_index": 38}, {"url": "https://en.wikipedia.org/wiki/Gradient_descent", "anchor_text": "Gradient Descent", "paragraph_index": 38}, {"url": "https://www.pluralsight.com/guides/handling-categorical-data-in-machine-learning-models", "anchor_text": "Handling Categorical Data in Machine Learning Models", "paragraph_index": 60}], "all_paragraphs": ["TL;DR Build a Linear Regression model in TensorFlow.js to predict house prices. Learn how to handle categorical data and do feature scaling.", "Raining again. It has been 3 weeks since the last time you saw the sun. You\u2019re getting tired of all this cold and unpleasant feeling of loneliness and melancholy.", "The voice in your head is getting louder and louder.", "Alright, you\u2019re ready to do it. Where to? You remember that you\u2019re nearly broke.", "A friend of yours told you about this place Ames, Iowa and it stuck in your head. After a quick search, you found that the weather is pleasant during the year and there is some rain, but not much. Excitement!", "Fortunately, you know of this dataset on Kaggle that might help you find out how much your dream house might cost. Let\u2019s get to it!", "Run the complete source code for this tutorial right in your browser:", "Our data comes from Kaggle\u2019s House Prices: Advanced Regression Techniqueschallenge.", "With 79 explanatory variables describing (almost) every aspect of residential homes in Ames, Iowa, this competition challenges you to predict the final price of each home.", "Here\u2019s a subset of the data we\u2019re going to use for our model:", "Let\u2019s use Papa Parse to load the training data:", "Let\u2019s build a better understanding of our data. First \u2014 the quality score of each house:", "Most houses are of average quality, but there are more \u201cgood\u201d than \u201cbad\u201d ones.", "Let\u2019s see how large are they (that\u2019s what she said):", "Most of the houses are within the 1,000\u20132,000 range, and we have some that are bigger.", "Let\u2019s have a look at the year they are built:", "Even though there are a lot of houses that were built recently, we have a much more widespread distribution.", "How related is the year with the price?", "Seems like newer houses are pricier, no love for the old and well made then?", "Oh ok, but higher quality should equal higher price, right?", "Generally yes, but look at quality 10. Some of those are relatively cheap. Any ideas why that might be?", "Is a larger house equal higher price?", "Seems like it, we might start our price prediction model using the living area!", "Linear Regression models assume that there is a linear relationship (can be modeled using a straight line) between a dependent continuous variable Y and one or more explanatory (independent) variables X.", "In our case, we\u2019re going to use features like living area (X) to predict the sale price (Y) of a house.", "Simple Linear Regression is a model that has a single independent variable X. It is given by:", "Where a and b are parameters, learned during the training of our model. X is the data we\u2019re going to use to train our model, b controls the slope and a the interception point with the y axis.", "A natural extension of the Simple Linear Regression model is the multivariate one. It is given by:", "where x1, x2, \u2026, xn\u200b are features from our dataset and w1, w2, \u2026, wn\u200b are learned parameters.", "We\u2019re going to use Root Mean Squared Error to measure how far our predictions are from the real house prices. It is given by:", "where the hypothesis/prediction hw\u200b is given by:", "Currently, our data sits into an array of JS objects. We need to turn it into Tensorsand use it for training our model(s). Here is the code for that:", "We store our features in X and the labels in y. Then we convert the data into Tensors and split it into training and testing datasets.", "Some of the features in our dataset are categorical/enumerable. For example, GarageCars can be in the 0-5 range.", "Leaving categories represented as integers in our dataset might introduce implicit ordering dependence. Something that does not exist with categorical variables.", "We\u2019ll use one-hot encoding from TensorFlow to create an integer vector for each value to break the ordering. First, let\u2019s specify how many different values each category has:", "We\u2019ll use tf.oneHot() to convert individual value to a one-hot representation:", "Note that the createDataSets() function accepts a parameter called categoricalFeatures which should be a set. We\u2019ll use this to check whether or not we should process this feature as categorical.", "Feature scaling is used to transform the feature values into a (similar) range. Feature scaling will help our model(s) learn faster since we\u2019re using Gradient Descent for training it.", "Let\u2019s use one of the simplest method for feature scaling \u2014 min-max normalization:", "this method rescales the range of values in the range of [0, 1].", "Now that we know about the Linear Regression model(s), we can try to predict house prices based on the data we have. Let\u2019s start simple:", "We\u2019ll wrap the training process in a function that we can reuse for our future model(s):", "trainLinearModel accepts the features and labels for our model. Let\u2019s define a Linear Regression model using TensorFlow:", "Since TensorFlow.js doesn\u2019t offer RMSE loss function, we\u2019ll use MSE and take the square root of that later. We\u2019ll also track Mean Absolute Error (MAE) between the predictions and real prices:", "We train for 100 epochs, shuffle the data beforehand, and use 10% of it for validation. The RMSE and MAE are visualized after each epoch.", "Our Simple Linear Regression model is using the GrLivArea feature:", "We don\u2019t have categorical features, so we leave that set is empty. Let\u2019s have a look at the performance:", "We have a lot more data we haven\u2019t used yet. Let\u2019s see if that will help improve the predictions:", "We use all features in our dataset and pass a set of the categorical ones. Did we do better?", "Overall, both models are performing at about the same level. This time, increasing the model complexity didn\u2019t give us better accuracy.", "Another way to evaluate our models is to check their predictions against the test data. Let\u2019s start with the Simple Linear Regression:", "How did adding more data improved the predictions?", "Well, it didn\u2019t. Again, having a more complex model trained with more data didn\u2019t provide better performance.", "You did it! You built two Linear Regression models that predict house price based on a set of features. You also did:", "- Feature scaling for faster model training", "- Convert categorical variables into one-hot representations", "- Implement RMSE (based on MSE) for accuracy evaluation", "Run the complete source code for this tutorial right in your browser:", "Is it time to learn about Neural Networks?", "Handling Categorical Data in Machine Learning Models", "Build Machine Learning models (especially Deep Neural Networks) that you can easily integrate with existing or new web apps. Think of your ReactJs, Vue, or Angular app enhanced with the power of Machine Learning models:", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fe7b39713572&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flinear-regression-with-tensorflow-js-e7b39713572&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flinear-regression-with-tensorflow-js-e7b39713572&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flinear-regression-with-tensorflow-js-e7b39713572&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flinear-regression-with-tensorflow-js-e7b39713572&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----e7b39713572--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----e7b39713572--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://venelinvalkov.medium.com/?source=post_page-----e7b39713572--------------------------------", "anchor_text": ""}, {"url": "https://venelinvalkov.medium.com/?source=post_page-----e7b39713572--------------------------------", "anchor_text": "Venelin Valkov"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F102e34a0beb1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flinear-regression-with-tensorflow-js-e7b39713572&user=Venelin+Valkov&userId=102e34a0beb1&source=post_page-102e34a0beb1----e7b39713572---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe7b39713572&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flinear-regression-with-tensorflow-js-e7b39713572&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe7b39713572&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flinear-regression-with-tensorflow-js-e7b39713572&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://www.kaggle.com/c/house-prices-advanced-regression-techniques/data", "anchor_text": "House Prices: Advanced Regression Techniques"}, {"url": "https://www.papaparse.com/", "anchor_text": "Papa Parse"}, {"url": "https://en.wikipedia.org/wiki/Root-mean-square_deviation", "anchor_text": "Root Mean Squared Error"}, {"url": "https://js.tensorflow.org/api/latest/#Tensors", "anchor_text": "Tensors"}, {"url": "https://en.wikipedia.org/wiki/One-hot", "anchor_text": "one-hot encoding"}, {"url": "https://js.tensorflow.org/api/latest/#oneHot", "anchor_text": "tf.oneHot()"}, {"url": "https://en.wikipedia.org/wiki/Feature_scaling", "anchor_text": "Feature scaling"}, {"url": "https://arxiv.org/abs/1502.03167", "anchor_text": "Feature scaling will help our model(s) learn faster"}, {"url": "https://en.wikipedia.org/wiki/Gradient_descent", "anchor_text": "Gradient Descent"}, {"url": "https://www.pluralsight.com/guides/handling-categorical-data-in-machine-learning-models", "anchor_text": "Handling Categorical Data in Machine Learning Models"}, {"url": "https://sebastianraschka.com/Articles/2014_about_feature_scaling.html", "anchor_text": "About Feature Scaling and Normalization"}, {"url": "https://www.statisticshowto.datasciencecentral.com/rmse/", "anchor_text": "RMSE: Root Mean Square Error"}, {"url": "https://www.curiousily.com/posts/predicting-house-prices-using-linear-regression-with-tensorflow-js/", "anchor_text": "https://www.curiousily.com"}, {"url": "https://leanpub.com/deep-learning-for-javascript-hackers", "anchor_text": "Deep Learning for JavaScript HackersBuild Machine Learning models (especially Deep Neural Networks) that you can easily integrate with existing or new web\u2026leanpub.com"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----e7b39713572---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/javascript?source=post_page-----e7b39713572---------------javascript-----------------", "anchor_text": "JavaScript"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----e7b39713572---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/tensorflow?source=post_page-----e7b39713572---------------tensorflow-----------------", "anchor_text": "TensorFlow"}, {"url": "https://medium.com/tag/data-science?source=post_page-----e7b39713572---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fe7b39713572&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flinear-regression-with-tensorflow-js-e7b39713572&user=Venelin+Valkov&userId=102e34a0beb1&source=-----e7b39713572---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fe7b39713572&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flinear-regression-with-tensorflow-js-e7b39713572&user=Venelin+Valkov&userId=102e34a0beb1&source=-----e7b39713572---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe7b39713572&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flinear-regression-with-tensorflow-js-e7b39713572&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----e7b39713572--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fe7b39713572&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flinear-regression-with-tensorflow-js-e7b39713572&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----e7b39713572---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----e7b39713572--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----e7b39713572--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----e7b39713572--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----e7b39713572--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----e7b39713572--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----e7b39713572--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----e7b39713572--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----e7b39713572--------------------------------", "anchor_text": ""}, {"url": "https://venelinvalkov.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://venelinvalkov.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Venelin Valkov"}, {"url": "https://venelinvalkov.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "2.5K Followers"}, {"url": "https://mlexpert.io", "anchor_text": "https://mlexpert.io"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F102e34a0beb1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flinear-regression-with-tensorflow-js-e7b39713572&user=Venelin+Valkov&userId=102e34a0beb1&source=post_page-102e34a0beb1--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F5323954064aa&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flinear-regression-with-tensorflow-js-e7b39713572&newsletterV3=102e34a0beb1&newsletterV3Id=5323954064aa&user=Venelin+Valkov&userId=102e34a0beb1&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}