{"url": "https://towardsdatascience.com/getting-familiar-with-keras-dd17a110652d", "time": 1683003879.839496, "path": "towardsdatascience.com/getting-familiar-with-keras-dd17a110652d/", "webpage": {"metadata": {"title": "Getting Familiar with Keras. Two Neural Network Regression Problems | by Sadrach Pierre, Ph.D. | Towards Data Science", "h1": "Getting Familiar with Keras", "description": "Neural networks are computing systems loosely inspired by brain connectivity. In short, neural networks make a series of transformations to input, the results of which are used as features during\u2026"}, "outgoing_paragraph_urls": [{"url": "https://github.com/MGCodesandStats/datasets/blob/master/cars.csv", "anchor_text": "here", "paragraph_index": 2}, {"url": "http://archive.ics.uci.edu/ml/machine-learning-databases/auto-mpg/", "anchor_text": "here", "paragraph_index": 18}, {"url": "https://www.kaggle.com/tracy2533/us-wildfire", "anchor_text": "US wildfire data", "paragraph_index": 24}, {"url": "https://github.com/spierre91/medium_code/blob/master/two_nn_regression_problems.py", "anchor_text": "GitHub", "paragraph_index": 25}], "all_paragraphs": ["Neural networks are computing systems loosely inspired by brain connectivity. In short, neural networks make a series of transformations to input, the results of which are used as features during learning. Keras is an open-source library in python that enables easy experimentation with neural networks. Keras provides many of the building blocks of neural networks including objective functions, optimizers, activation functions, various types of layers, and a host of additional tools.", "In this post, we will build three regression neural network models using the Keras library.", "In the first example, we will be predicting the potential value of a car sale based on customer attributes. These attributes include information like age, income, and gender. The data can be found here.", "To start, let\u2019s import pandas and read the data into a data frame:", "Let\u2019s print the first five rows:", "Next, we will define our input and output variables. We will use \u2018age\u2019, \u2018gender\u2019, \u2018miles\u2019, \u2018debt\u2019, and \u2018income\u2019 to predict \u2018sales:", "We now need to split our data for training and testing. We will import the \u2018train_test_split\u2019 method from \u2018sklearn\u2019:", "We then define our test set as a random sample (20% of our data):", "Next, we need to reshape our array of labels:", "Now we can define our model. First, we will need to import a few packages:", "Next, we define a sequential model object:", "Let\u2019s build a simple neural network with an input layer, a hidden layer, and an output layer. We will also be using the \u2018ReLu\u2019 activation function in the input and hidden layers. For the output layer, we will use a linear activation function. The input and hidden layers will have 32 neurons:", "Next, we compile the model. We will use the \u2018adam\u2019 optimizer and mean squared error loss function:", "Finally, we fit our model. Let\u2019s fit with 100 epochs and a batch size of 10:", "We see that both mean squared error and mean absolute error are both pretty low compared to the sale magnitudes which is good.", "Now, let\u2019s make predictions on the test set:", "Next, we can visualize our results. Let\u2019s import matplotlib and seaborn and display a scatter plot of true values vs. predictions:", "This is a decent performance for a first pass. We can do even better with further hyper-parameter tuning. To further improve performance, I encourage you to play around with the number of layers, neurons, epochs and the batch size. You can also try some other optimizers, instead of \u2018adam\u2019, like \u2018rmsprop\u2019, or \u2018sgd\u2019. You can also try transforming the data using normalization, standardization or min/max scaling.", "Now, let\u2019s move on to another problem. In this example, we will be predicting fuel efficiency measured in miles per gallon. We will be using information like horsepower, weight, and the number of cylinders as inputs into our predictive model. The data can be found here.", "Let\u2019s import the data and print the first five rows:", "Next we will define our input and output. We will use \u2018Cylinders\u2019, \u2018Displacement\u2019, \u2018Horsepower\u2019, \u2018Weight\u2019, \u2018Acceleration\u2019, \u2018Model Year\u2019, and \u2018Origin\u2019 to predict miles per gallon (MPG):", "We now need to split our data for training and testing. We will define our test set as a random sample of our data:", "Next, we need to reshape our array of labels:", "Now let\u2019s define our model. Let\u2019s start with a neural network with input and hidden layers with 64 neurons. The input dimension is 7, the optimizer is \u2018adam\u2019 and the loss function is \u2018mse\u2019. We will also use 1000 epochs and a batch size of 10 :", "We can see performance is pretty good. I encourage you to try to improve performance or to try to build neural network models for other prediction problems. For example, you may be interested in using neural networks to predict wildfire size using US wildfire data.", "To summarize, in this post we walked through the model building process for two regression problems: predicting the value of a car and predicting fuel efficiency. We discussed how to initialize sequential model objects, add layers, add neurons, specify optimizers, specify epochs and specify batch sizes. We also went over model validation using true vs. predicted scatterplots. I hope you found this post useful. The code from this post is available on GitHub. Thank you for reading and happy machine learning!", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Writer for Built In & Towards Data Science. Cornell University Ph. D. in Chemical Physics."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fdd17a110652d&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgetting-familiar-with-keras-dd17a110652d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgetting-familiar-with-keras-dd17a110652d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgetting-familiar-with-keras-dd17a110652d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgetting-familiar-with-keras-dd17a110652d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----dd17a110652d--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----dd17a110652d--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://spierre91.medium.com/?source=post_page-----dd17a110652d--------------------------------", "anchor_text": ""}, {"url": "https://spierre91.medium.com/?source=post_page-----dd17a110652d--------------------------------", "anchor_text": "Sadrach Pierre, Ph.D."}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F120b86134681&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgetting-familiar-with-keras-dd17a110652d&user=Sadrach+Pierre%2C+Ph.D.&userId=120b86134681&source=post_page-120b86134681----dd17a110652d---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fdd17a110652d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgetting-familiar-with-keras-dd17a110652d&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fdd17a110652d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgetting-familiar-with-keras-dd17a110652d&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://www.pexels.com/@ketut-subiyanto", "anchor_text": "Ketut Subiyanto"}, {"url": "https://www.pexels.com/photo/black-female-barista-together-with-colleague-using-laptop-at-work-4350039/", "anchor_text": "Pexels"}, {"url": "https://github.com/MGCodesandStats/datasets/blob/master/cars.csv", "anchor_text": "here"}, {"url": "http://archive.ics.uci.edu/ml/machine-learning-databases/auto-mpg/", "anchor_text": "here"}, {"url": "https://www.kaggle.com/tracy2533/us-wildfire", "anchor_text": "US wildfire data"}, {"url": "https://github.com/spierre91/medium_code/blob/master/two_nn_regression_problems.py", "anchor_text": "GitHub"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----dd17a110652d---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----dd17a110652d---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/data-science?source=post_page-----dd17a110652d---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/python?source=post_page-----dd17a110652d---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/programming?source=post_page-----dd17a110652d---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fdd17a110652d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgetting-familiar-with-keras-dd17a110652d&user=Sadrach+Pierre%2C+Ph.D.&userId=120b86134681&source=-----dd17a110652d---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fdd17a110652d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgetting-familiar-with-keras-dd17a110652d&user=Sadrach+Pierre%2C+Ph.D.&userId=120b86134681&source=-----dd17a110652d---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fdd17a110652d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgetting-familiar-with-keras-dd17a110652d&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----dd17a110652d--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fdd17a110652d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgetting-familiar-with-keras-dd17a110652d&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----dd17a110652d---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----dd17a110652d--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----dd17a110652d--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----dd17a110652d--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----dd17a110652d--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----dd17a110652d--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----dd17a110652d--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----dd17a110652d--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----dd17a110652d--------------------------------", "anchor_text": ""}, {"url": "https://spierre91.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://spierre91.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Sadrach Pierre, Ph.D."}, {"url": "https://spierre91.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "3.7K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F120b86134681&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgetting-familiar-with-keras-dd17a110652d&user=Sadrach+Pierre%2C+Ph.D.&userId=120b86134681&source=post_page-120b86134681--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F4efebd4f21b7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgetting-familiar-with-keras-dd17a110652d&newsletterV3=120b86134681&newsletterV3Id=4efebd4f21b7&user=Sadrach+Pierre%2C+Ph.D.&userId=120b86134681&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}