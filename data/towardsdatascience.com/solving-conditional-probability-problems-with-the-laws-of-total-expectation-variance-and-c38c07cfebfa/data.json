{"url": "https://towardsdatascience.com/solving-conditional-probability-problems-with-the-laws-of-total-expectation-variance-and-c38c07cfebfa", "time": 1683004299.496319, "path": "towardsdatascience.com/solving-conditional-probability-problems-with-the-laws-of-total-expectation-variance-and-c38c07cfebfa/", "webpage": {"metadata": {"title": "Solving Conditional Probability Problems with the Laws of Total Expectation, Variance, and Covariance | by Saurabh Maheshwari | Towards Data Science", "h1": "Solving Conditional Probability Problems with the Laws of Total Expectation, Variance, and Covariance", "description": "In this article, we\u2019ll see how to use the Laws of Total Expectation, Variance, and Covariance, to solve conditional probability problems, such as those you might encounter in a job interview or while\u2026"}, "outgoing_paragraph_urls": [{"url": "https://en.wikipedia.org/wiki/Binomial_distribution", "anchor_text": "binomial distribution", "paragraph_index": 9}, {"url": "https://math.stackexchange.com/questions/1742578/law-of-total-variance-intuition", "anchor_text": "This", "paragraph_index": 27}, {"url": "https://stats.stackexchange.com/questions/179129/interpretation-of-total-law-of-covariance", "anchor_text": "This", "paragraph_index": 34}, {"url": "https://en.wikipedia.org/wiki/Law_of_large_numbers", "anchor_text": "Law of Large Numbers", "paragraph_index": 41}], "all_paragraphs": ["In this article, we\u2019ll see how to use the Laws of Total Expectation, Variance, and Covariance, to solve conditional probability problems, such as those you might encounter in a job interview or while modeling business problems where random variables are conditional on other random variables.", "I am going to start by asking a couple of real-world probability questions:", "In these scenarios, you can observe that the variables we are interested in depend on other random variables. For example, in the first question, the number of passengers on the bus at ith stop is most likely dependent on the number of passengers on the bus at (i-1)th stop. These conditional probability questions can seem mysterious at first, but with a solid grip on the Laws of Total Expectation, Variance, and Covariance we can solve them easily and efficiently.", "We\u2019ll first see how one can apply these Laws to a problem (related to the bus question above) and later will verify the results by simulating the problem in R.", "From here on I assume that you have a basic understanding of random variables, their expectation and variance, and conditional probability. Here is a good resource, in case you want a refresher:", "And if you want a deeper and more thorough understanding of basic concepts of probability, this is the ultimate book:", "Let\u2019s get started. Here again, is a version of the bus problem [1]:", "An autonomous bus (yes, we are in 2050) arrives at the 1st station (i = 1) with zero passengers on board. At every station, 0, 1, or 2 passengers could get on the bus with probability 0.3, 0.5, 0.2, respectively. At every station, a passenger could alight the bus with a probability of 0.1. Find the expected value and variance of the number of passengers on the bus1) after it leaves the 1st station2) that alight the bus at 2nd station3) after it leaves the 2nd station", "Assume that the number of passengers on boarding the bus at a station is independent of the other stations and the vehicle has an infinite capacity.", "If you think about it, the number of passengers getting off the bus at a station is a binomial distribution with parameters (n = number of passengers on the bus when it arrives at that station, p = 0.1). For example, A2 ~ Binom(L1, 0.1)", "Alright, given all this information, how can we go about solving this? To begin, here are a few observations we can draw from the question that motivates the need for using conditional relationships between variables:", "So, we will first calculate estimates for variables on which other variables are dependent, and then use these estimates to estimate our dependent variables. For example, we will calculate the estimates for L1, then we will use these to calculate estimates for A2 and L2.", "First, we are going to calculate the expectations for variables in our problem.", "Just following the definition of expected value, the expectation of the number of passengers on the bus when it leaves station 1, E(L1), can be calculated as follows:", "Now, let\u2019s calculate E(A2), i.e., the expectation of the number of passengers that get off the bus when it leaves station 2. As mentioned above A2 depends on L1, thus the E(A2) can be calculated by conditioning on L1, which brings us to the Law of Total Expectation.", "The idea here is to calculate the expected value of A2 for a given value of L1, then aggregate those expectations of A2 across the values of L1. To understand this better, here is the Law:", "Given random variables X and Y, the expected value of X is equal to the expected value of the conditional distribution of X on Y.", "When Y is a discrete random variable, the Law becomes:", "The intuition behind this formula is that in order to calculate E(X), one can break the space of X with respect to Y, then take a weighted average of E(X|Y=y) with the probability of (Y = y) as the weights.", "Given this information, E(A2) can be calculated as follows:", "Similarily, expectation of the number of passengers that are on the bus when it leaves station 2, E(L2), can be calculated as follows:", "[*] One must understand that the expected value and variance of B2 are equal to that for L1. The reason being, the number of people boarding the bus at any station has a similar probability distribution as people boarding the bus at the 1st station (L1).", "This concludes the expectation part of the question. Keeping the business problem in mind, we should also consider the uncertainty in these estimates, which is measured by variance. So let\u2019s solve for variance now.", "Let\u2019s start by calculating the variance of L1, denoted by Var(L1). Since L1 is not dependent on any other variable, we can solve for Var(L1) directly by using the basic formula.", "Now let\u2019s look into the variance for A2. Again, since A2 is dependent on L1, taking the conditional variance makes the calculation easier. This brings us to the Law of Total Variance.", "The idea is similar to the Law of Total Expectation. We are going to divide the values of A2 into groups w.r.t L1, take the variance in groups, and then aggregate over those groups to get the desired variance.", "Since we are calculating the variance, there are 2 sources of variability: (expected within the group variability in A2) + (variability in the expected value of A2 across the groups). To understand this better, have a look at this formula:", "This explains the intuition behind the Law of Total Variance very clearly, which is summarised here:", "Similar to the Law of Total Expectation, we are breaking up the sample space of X with respect to Y. Note that both Var(X|Y) and E(X|Y) are random variables. The first component calculates the expected variance of X as we average over all the Y values. But, Var(X|Y) is based upon E(X|Y) which is also random. Thus, we include the second term to account for the variance in that expected value.", "Here, we have also used the basic properties of expectations and variances that", "Alright, so far so good. Time to get the variance of L2.", "[*] Since B2 is independent of L1 and A2, B2 does not share a covariance with L1 and A2. But, L1 and A2 are dependent, thus expanding the variance introduces a covariance between them.", "So, to calculate Var(L2), we need to calculate cov(L1, A2). Again, since A2 is dependent on L1, we will be using their conditional relationship to calculate covariance, which brings us to the Law of Total Covariance.", "The idea is similar to the Law of Total Variance, so I will jump straight to the Law: Given 3 random variables, X, Y, and Z, the Law of Total Covariance states that", "This does a great job explaining the intuition behind the Law of Total Covariance which I have summarized below.", "cov(X,Y|Z), E(X|Z) and E(Y|Z) are random variables. Similar to the Law of Total Variance, the first term accounts for the average covariance between X and Y, over different Z values. Note that cov(X,Y|Z) is based on E(X|Z) and E(Y|Z) which are random. That is, for a value of Z, there will be a value realised for E(X|Z) and E(Y|Z) simultaneously. Thus, the second term incorporates the covariance between the X and Y coordinates realised for various values of Z.", "Another way to understand this is to break the Law into: (expected covariance between X and Y within the groups) + (covariance in the expected values of X and Y across the groups)", "Now, we have all the pieces for calculating Var(L2).", "And, that\u2019s it. We neatly used all the 3 Laws to exploit the relationship between dependent variables and derive the expected values and variances of the number of passengers on the bus1) after it leaves the 1st station (L1)2) that alight the bus at 2nd station (A2)3) after it leaves the 2nd station (L2)", "Next, let\u2019s simulate this in R and verify our answers.", "Below, I have created a function that simulates the bus trips in R. This function takes in the number of bus trips to aggregate over as input and returns the desired estimates.", "Next, I am going to use this function to generate 10,000 estimates, with each estimate calculated using a sample of 100,000 bus trips. Finally, we take an average of our 10,000 estimates to get the final value. Doing this provides the best estimate of the true population parameters as per the Law of Large Numbers (LLN). As per LLN, the more the estimates you use, the closer the average of these estimates gets to the true parameter value.", "I hope this blog helped you understand the Laws of Total Expectation, Variance, and Covariance and that they make a valuable addition to your probability theory knowledge and problem-solving strategies.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Statistics Graduate Student @ UC Davis. Looking for Data Science opportunities."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fc38c07cfebfa&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsolving-conditional-probability-problems-with-the-laws-of-total-expectation-variance-and-c38c07cfebfa&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsolving-conditional-probability-problems-with-the-laws-of-total-expectation-variance-and-c38c07cfebfa&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsolving-conditional-probability-problems-with-the-laws-of-total-expectation-variance-and-c38c07cfebfa&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsolving-conditional-probability-problems-with-the-laws-of-total-expectation-variance-and-c38c07cfebfa&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----c38c07cfebfa--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----c38c07cfebfa--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@sbhmaheshwari?source=post_page-----c38c07cfebfa--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@sbhmaheshwari?source=post_page-----c38c07cfebfa--------------------------------", "anchor_text": "Saurabh Maheshwari"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fa3828087c8b8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsolving-conditional-probability-problems-with-the-laws-of-total-expectation-variance-and-c38c07cfebfa&user=Saurabh+Maheshwari&userId=a3828087c8b8&source=post_page-a3828087c8b8----c38c07cfebfa---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc38c07cfebfa&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsolving-conditional-probability-problems-with-the-laws-of-total-expectation-variance-and-c38c07cfebfa&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc38c07cfebfa&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsolving-conditional-probability-problems-with-the-laws-of-total-expectation-variance-and-c38c07cfebfa&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@rozetsky?utm_source=medium&utm_medium=referral", "anchor_text": "Ant Rozetsky"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://towardsdatascience.com/basic-probability-theory-and-statistics-3105ab637213", "anchor_text": "Basic Probability Theory and StatisticsI want to discuss some very fundamental terms/concepts related to probability and statistics that often come across any\u2026towardsdatascience.com"}, {"url": "https://readyforai.com/download/a-first-course-in-probability-9th-edition-pdf/", "anchor_text": "A First Course in Probability 9th Edition PDF \u2014 Ready For AIA First Course in Probability (PDF) 9th Edition features clear and intuitive explanations of the mathematics of\u2026readyforai.com"}, {"url": "https://en.wikipedia.org/wiki/Binomial_distribution", "anchor_text": "binomial distribution"}, {"url": "https://math.stackexchange.com/questions/1742578/law-of-total-variance-intuition", "anchor_text": "This"}, {"url": "https://stats.stackexchange.com/questions/179129/interpretation-of-total-law-of-covariance", "anchor_text": "This"}, {"url": "https://en.wikipedia.org/wiki/Law_of_large_numbers", "anchor_text": "Law of Large Numbers"}, {"url": "https://medium.com/tag/statistics?source=post_page-----c38c07cfebfa---------------statistics-----------------", "anchor_text": "Statistics"}, {"url": "https://medium.com/tag/probability?source=post_page-----c38c07cfebfa---------------probability-----------------", "anchor_text": "Probability"}, {"url": "https://medium.com/tag/data-science?source=post_page-----c38c07cfebfa---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/mathematics?source=post_page-----c38c07cfebfa---------------mathematics-----------------", "anchor_text": "Mathematics"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fc38c07cfebfa&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsolving-conditional-probability-problems-with-the-laws-of-total-expectation-variance-and-c38c07cfebfa&user=Saurabh+Maheshwari&userId=a3828087c8b8&source=-----c38c07cfebfa---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fc38c07cfebfa&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsolving-conditional-probability-problems-with-the-laws-of-total-expectation-variance-and-c38c07cfebfa&user=Saurabh+Maheshwari&userId=a3828087c8b8&source=-----c38c07cfebfa---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc38c07cfebfa&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsolving-conditional-probability-problems-with-the-laws-of-total-expectation-variance-and-c38c07cfebfa&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----c38c07cfebfa--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fc38c07cfebfa&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsolving-conditional-probability-problems-with-the-laws-of-total-expectation-variance-and-c38c07cfebfa&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----c38c07cfebfa---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----c38c07cfebfa--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----c38c07cfebfa--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----c38c07cfebfa--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----c38c07cfebfa--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----c38c07cfebfa--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----c38c07cfebfa--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----c38c07cfebfa--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----c38c07cfebfa--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@sbhmaheshwari?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@sbhmaheshwari?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Saurabh Maheshwari"}, {"url": "https://medium.com/@sbhmaheshwari/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "17 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fa3828087c8b8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsolving-conditional-probability-problems-with-the-laws-of-total-expectation-variance-and-c38c07cfebfa&user=Saurabh+Maheshwari&userId=a3828087c8b8&source=post_page-a3828087c8b8--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fusers%2Fa3828087c8b8%2Flazily-enable-writer-subscription&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsolving-conditional-probability-problems-with-the-laws-of-total-expectation-variance-and-c38c07cfebfa&user=Saurabh+Maheshwari&userId=a3828087c8b8&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}