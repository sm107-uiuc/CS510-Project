{"url": "https://towardsdatascience.com/object-detection-using-yolov3-and-opencv-19ee0792a420", "time": 1682992922.18642, "path": "towardsdatascience.com/object-detection-using-yolov3-and-opencv-19ee0792a420/", "webpage": {"metadata": {"title": "Object Detection using YoloV3 and OpenCV | by Nandini Bansal | Towards Data Science", "h1": "Object Detection using YoloV3 and OpenCV", "description": "Computer Vision has always been a topic of fascination for me. In layman's terms, computer vision is all about replicating the complexity of the human vision and his understanding of his\u2026"}, "outgoing_paragraph_urls": [{"url": "https://neptune.ai/blog/object-detection-with-yolo-hands-on-tutorial", "anchor_text": "Object Detection with YOLO: Hands-on Tutorial", "paragraph_index": 5}, {"url": "https://pjreddie.com/darknet/yolo/", "anchor_text": "https://pjreddie.com/darknet/yolo", "paragraph_index": 9}, {"url": "https://github.com/Yuliang-Liu/Curve-Text-Detector/issues/11", "anchor_text": "THIS", "paragraph_index": 30}, {"url": "http://www.linkedin.com/in/nandini-b-b4baaa178", "anchor_text": "LinkedIn", "paragraph_index": 31}], "all_paragraphs": ["Computer Vision has always been a topic of fascination for me. In layman's terms, computer vision is all about replicating the complexity of the human vision and his understanding of his surroundings. It is emerging to be one of the most powerful fields of application of AI. Thanks to the amount of data that is being generated on an everyday basis.", "When we look at images or videos, we can easily locate and identify the objects of our interest within moments. Passing on of this intelligence to computers is nothing but object detection \u2014 locating the object and identifying it. Object Detection has found its application in a wide variety of domains such as video surveillance, image retrieval systems, autonomous driving vehicles and many more. Various algorithms can be used for object detection but we will be focusing on YoloV3 algorithm.", "You Only Look Once or more popularly known as YOLO is one of the fastest real-time object detection algorithm (45 frames per second) as compared to the R-CNN family (R-CNN, Fast R-CNN, Faster R-CNN, etc.)", "The R-CNN family of algorithms uses regions to localise the objects in images which means the model is applied to multiple regions and high scoring regions of the image are considered as object detected. But YOLO follows a completely different approach. Instead of selecting some regions, it applies a neural network to the entire image to predict bounding boxes and their probabilities.", "We have two options to get started with object detection:", "In this article, we will be looking at creating an object detector using the pre-trained model for images, videos and real-time webcam. In case you wish to train a custom YOLO object detector, I would suggest you head to Object Detection with YOLO: Hands-on Tutorial. The author has covered all the steps starting from data annotations for custom object detectors to processing it and finally, training the model.", "Let us dive into the code.", "Let us start with importing the modules that are needed for this program.", "You will also need to download a couple of heavy files which includes the pre-trained weights of YoloV3, the configuration file and the names file.", "Weights and cfg (or configuration) files can be downloaded from https://pjreddie.com/darknet/yolo. You will see a couple of different options available. The model has been trained for different sizes of images: 320 x 320 (high speed, less accuracy), 416 x 416 (moderate speed, moderate accuracy) and 608 x 608 (less speed, high accuracy). We will download the weights and cfg files for YOLOv3\u2013320 for now.", "Now that we have all these files downloaded and ready with us, we can start writing the python script. Like I mentioned before as well, our input can be in three forms:", "To start with, we will create a function called load_yolo().", "In the above function, as you can see, I am loading the YoloV3 weights and configuration file with the help of the dnn module of OpenCV. The coco.names file contains the names of the different objects that our model has been trained to identify. We store them in a list called classes. Now to run a forward pass using the cv2.dnn module, we need to pass in the names of layers for which the output is to be computed. net.getUnconnectedOutLayers() returns the indices of the output layers of the network.", "For accepting image files, we will need another function called load_image() which will accept an image path as a parameter, read the image, resize it and return it.", "To correctly predict the objects with deep neural networks, we need to preprocess our data and the cv2.dnn module provides us with two functions for this purpose: blobFromImage and blobFromImages. These functions perform scaling, mean subtraction and channel swap which is optional. We will use blobFromImage in a function called detect_objects() that accepts image/frame from video or webcam stream, model and output layers as parameters.", "As you can see in the code snippet above, we have used the scalefactor of 0.00392 which can also be written as 1/255. Hence, we are scaling the image pixels to the range of 0 to 1. There is no need for mean subtraction and that\u2019s why we set it to [0, 0, 0] value.", "The forward() function of the cv2.dnn module returns a nested list containing information about all the detected objects which includes the x and y coordinates of the centre of the object detected, height and width of the bounding box, confidence and scores for all the classes of objects listed in coco.names. The class with the highest score is considered to be the predicted class.", "In the get_box_dimensions() function, a list called scores is created which stores the confidence corresponding to each object. We then identify the index of class with the highest confidence/score using np.argmax(). We can get the name of the class corresponding to the index from the classes list we created in load_yolo().", "I have selected all the predicted bounding boxes with a confidence of more than 30 %. You may play around with this value.", "Now that we have the vertices of the predicted bounding box and class_id (index of predicted object class), we need to draw the bounding box and add an object label to it. We will do that with the help of the draw_labels() function.", "Now, you must be wondering, what is cv2.dnn.NMSBoxes() is for? We were just supposed to add draw the bounding box and add a label to it, right?", "Although we removed the low confidence bounding boxes, there is a possibility that we will still have duplicate detections around an object. For example, look at the image shown below.", "You may observe that some objects have been detected multiple times and we have more than one bounding box for it. To fix this situation we\u2019ll need to apply Non-Maximum Suppression (NMS), also called Non-Maxima Suppression. We pass in confidence threshold value and NMS threshold value as parameters to select one bounding box. From the range of 0 to 1, we should select an intermediate value like 0.4 or 0.5 to make sure that we detect the overlapping objects but do not end up getting multiple bounding boxes for the same object.", "So the final output looks like this:", "All the functions that we looked at can be pipelined together in another function called image_detect() for detecting objects in an image file.", "Similarly, for video files and webcam input, we can create two different functions called start_video() and webcam_detect() respectively.", "It is a possibility that the code might break for loading YOLO-V3 weights and you may get an error like shown below.", "If that happens, you can use this snippet of code for load_yolo() instead:", "Upon fixing this, I ran into another issue:", "This is like a warning. It does not disrupt the code functionality but this warning keeps floating on the command line while the code is running. I tried searching for a solution for it and found out that it happens due to some dependency issue between OpenCV and PyQt libraries. You might have to upgrade/downgrade either of these libraries to make them compatible again.", "A useful Issue Thread for understanding more about the warning and fixing it would be THIS. Also, if any one of you is able to find a permanent workaround for this warning, please do share it with us as well.", "This is all for this article. I hope you find it useful. If yes, please give it a clap. For any questions and suggestions, feel free to connect with me on LinkedIn.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Always eager to learn new things.."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F19ee0792a420&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fobject-detection-using-yolov3-and-opencv-19ee0792a420&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fobject-detection-using-yolov3-and-opencv-19ee0792a420&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fobject-detection-using-yolov3-and-opencv-19ee0792a420&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fobject-detection-using-yolov3-and-opencv-19ee0792a420&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----19ee0792a420--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----19ee0792a420--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://nandinibansal1811.medium.com/?source=post_page-----19ee0792a420--------------------------------", "anchor_text": ""}, {"url": "https://nandinibansal1811.medium.com/?source=post_page-----19ee0792a420--------------------------------", "anchor_text": "Nandini Bansal"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fc41c26af0465&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fobject-detection-using-yolov3-and-opencv-19ee0792a420&user=Nandini+Bansal&userId=c41c26af0465&source=post_page-c41c26af0465----19ee0792a420---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F19ee0792a420&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fobject-detection-using-yolov3-and-opencv-19ee0792a420&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F19ee0792a420&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fobject-detection-using-yolov3-and-opencv-19ee0792a420&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://neptune.ai/blog/object-detection-with-yolo-hands-on-tutorial", "anchor_text": "Object Detection with YOLO: Hands-on Tutorial"}, {"url": "https://pjreddie.com/darknet/yolo/", "anchor_text": "https://pjreddie.com/darknet/yolo"}, {"url": "https://github.com/pjreddie/darknet/blob/master/data/coco.names", "anchor_text": "https://github.com/pjreddie/darknet/blob/master/data/coco.names"}, {"url": "https://github.com/nandinib1999/object-detection-yolo-opencv", "anchor_text": "https://github.com/nandinib1999/object-detection-yolo-opencv"}, {"url": "https://github.com/Yuliang-Liu/Curve-Text-Detector/issues/11", "anchor_text": "THIS"}, {"url": "http://www.linkedin.com/in/nandini-b-b4baaa178", "anchor_text": "LinkedIn"}, {"url": "https://medium.com/tag/object-detection?source=post_page-----19ee0792a420---------------object_detection-----------------", "anchor_text": "Object Detection"}, {"url": "https://medium.com/tag/opencv?source=post_page-----19ee0792a420---------------opencv-----------------", "anchor_text": "Opencv"}, {"url": "https://medium.com/tag/python?source=post_page-----19ee0792a420---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/yolov3?source=post_page-----19ee0792a420---------------yolov3-----------------", "anchor_text": "Yolov3"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F19ee0792a420&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fobject-detection-using-yolov3-and-opencv-19ee0792a420&user=Nandini+Bansal&userId=c41c26af0465&source=-----19ee0792a420---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F19ee0792a420&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fobject-detection-using-yolov3-and-opencv-19ee0792a420&user=Nandini+Bansal&userId=c41c26af0465&source=-----19ee0792a420---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F19ee0792a420&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fobject-detection-using-yolov3-and-opencv-19ee0792a420&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----19ee0792a420--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F19ee0792a420&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fobject-detection-using-yolov3-and-opencv-19ee0792a420&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----19ee0792a420---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----19ee0792a420--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----19ee0792a420--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----19ee0792a420--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----19ee0792a420--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----19ee0792a420--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----19ee0792a420--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----19ee0792a420--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----19ee0792a420--------------------------------", "anchor_text": ""}, {"url": "https://nandinibansal1811.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://nandinibansal1811.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Nandini Bansal"}, {"url": "https://nandinibansal1811.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "162 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fc41c26af0465&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fobject-detection-using-yolov3-and-opencv-19ee0792a420&user=Nandini+Bansal&userId=c41c26af0465&source=post_page-c41c26af0465--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F158604c40f89&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fobject-detection-using-yolov3-and-opencv-19ee0792a420&newsletterV3=c41c26af0465&newsletterV3Id=158604c40f89&user=Nandini+Bansal&userId=c41c26af0465&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}