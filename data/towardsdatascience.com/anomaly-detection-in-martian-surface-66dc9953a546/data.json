{"url": "https://towardsdatascience.com/anomaly-detection-in-martian-surface-66dc9953a546", "time": 1682997637.011088, "path": "towardsdatascience.com/anomaly-detection-in-martian-surface-66dc9953a546/", "webpage": {"metadata": {"title": "Anomaly detection in Martian Surface | by Murli Sivashanmugam | Towards Data Science", "h1": "Anomaly detection in Martian Surface", "description": "I got this wonderful opportunity to work on the project \u201cAnomaly detection in Martian Surface\u201d though Omdena community. The objective of this project is to detect the Anomalies on the MARS surface\u2026"}, "outgoing_paragraph_urls": [{"url": "https://omdena.com/mars/", "anchor_text": "Omdena community", "paragraph_index": 0}, {"url": "https://www.uahirise.org/ESP_028401_1755", "anchor_text": "https://www.uahirise.org/ESP_028401_1755", "paragraph_index": 6}, {"url": "https://arxiv.org/abs/1811.06861", "anchor_text": "https://arxiv.org/abs/1811.06861", "paragraph_index": 10}], "all_paragraphs": ["I got this wonderful opportunity to work on the project \u201cAnomaly detection in Martian Surface\u201d though Omdena community. The objective of this project is to detect the Anomalies on the MARS surface caused by non-terrestrial artifacts like the debris of MARS lander missions, rovers, etc.", "Recently the search for so-called \u201cTechno-Signatures\u201d \u2014 measurable properties or effect that provide scientific evidence of past or present extraterrestrial technology, has gained new interests. NASA hosted a \u201cTechno-Signature\u201d Workshop at the Lunar and Planetary Institute in Houston, Texas, on September 2018 to learn more about the current field and state of the art of searches for \u201cTechno-Signatures\u201d, and what role NASA might play in these searches in the future. One area in this field of research is the search for non-terrestrial artifacts in the Solar System. This AI challenge is aimed at developing \u2018AI Toolbox\u2019 for the Planetary Scientists to help in identifying non-terrestrial artifacts.", "This AI challenge had multiple challenges starting from the data set.", "Detecting anomalies on the martian surfaces had few unique challenges. Apart from the challenges of data collections and no predefined dataset, the initial challenge is that the martian surface by itself is very diverse. The different part of the martian surface looks entirely different from the rest. The same surface in different seasons looks very different. Few samples of diverse martian surface:", "So, the algorithm should be generic enough to detect anomalies in all these diverse surfaces. The second challenge is about the data imbalance, the Martian surface is about 145 million square kilometers and on this surface, we have few 100s of anomalies each measuring not more than a few 10s of feet. One could consider using data augmentation to overcome the imbalance but still, the anomalies that get created in different terrain would be different and we don\u2019t have labeled data across different terrains.", "Next challenge is that the data population is already polluted with anomalies. Usual anomaly detection algorithms work by training AI model on normal/usual population samples and the model is used to predict how much the target data deviates from the normal/usual population sample. One can not apply this approach here.", "The data set I used for this exercise is the MSL Hardware images 12 Days after Landing, https://www.uahirise.org/ESP_028401_1755. In this image folks from \u201cThe University of Arizona\u201d have annotated the surface images where the hardware created anomalies on the MARStian surface. This seems to be a perfect data set for initial evaluation.", "The complete HiRISE image itself is about 550MB in size and resolution of 25516x45788 pixels. On the left is the compressed browse image of the full HiRISE image. The anomalies are hardly visible in this image. Even in the full resolution image, it is very difficult to spot the anomalies unless one knows exactly where to look.", "To create a data set out of this image I have split this image of 25516x45788 pixels into small images chunks of 256x256 pixels with 256 pixels stride. As you can see this image has black borders around and the black borders are not good for the AI models. To reduce effort on preprocessing this image I have eliminated images chunks on the borders and used the images chunks from the center of the images. This results in a data set with about 10K images. In these 10K images, there are 6 anomalies spread across 50 images.", "Following are the sample images of 6 anomalies present in the data set:", "The primary motivation is to take advantage of the challenges in the data set and apply \u201cAnomaly Detection using Deep Learning based Image Completion\u201d approach as mentioned publication https://arxiv.org/abs/1811.06861", "The idea is to use a deep convolutional neural network for patch-wise completion of surface images with the aim to detect anomalies on the surface. The approach used in the paper is to train the model exclusively on normal data, mask/cut-out the center 32x32 pixels, and the model is trained to reconstruct the masked out region. To detect anomalies the query image\u2019s center 32x32 pixels are masked and the model is used to reconstruct fault free clones of the masked region. By subtracting the corresponding query region with the generated region, a pixel-wise anomaly score is obtained, which is then used to detect anomalies.", "In our dataset since the anomalies are expected to be very less compared to the normal images, we will use the entire data set as is to train the model. The trained model is then used to compute the anomaly score on the same data set. Since the model will generalize on normal images it is expected to give out high anomaly scores for anomalies.", "Let\u2019s check if this approach can find these 6 needles in a haystack of 10K images.", "Image completion tasks typically have the aim to complete missing regions of an image in the most natural-looking way. Besides being semantically meaningful, the inpaint must also look as authentic as possible. For this reason, feed-forward inpainting DCNNs are often trained jointly with an adversarial network. The adversarial network has the objective to discriminate between fake and real images. In contrast, the generative model must increase the error rate of the adversarial network by generating realistic images. Although this additional adversarial loss indeed causes inpaints to look more realistic, it has no positive effect on pixel-wise matching the missing part of the image. Training with the joint loss function even increases the pixelwise reconstruction error, which is undesirable behavior for anomaly detection. For this reason, the paper uses the feedforward generative DCNN is trained with reconstruction loss only.", "The DCNN network consists of 17 layers as shown in the figure above. After the third layer, the resolution of the feature maps is halved by stridden convolution. In order to increase the receptive fields of the output neurons, a series of dilated convolutions is used (layers 7\u201310). Upscaling back to the input size at layer 13 is performed by bilinear rescaling followed by a convolution. Mirror padding is used for all convolutional layers. Further, Exponential Linear Unit (ELU) activation functions are used.", "The network is trained with L1 reconstruction loss. The 32x32 center region, defined by the binary mask M, is weighted differently from the remaining region. With X being the image patch to be inspected, the network is trained with the following loss function:", "The image chunks of 256x256 are resized to 128x128 and the image completion network is fed with image patches of size 128x128. The patches are corrupted by masking out the central area of size 32 x32. This large ratio between known and unknown image content provides the network with more semantic information to complete the center region. After the reconstruction of the corrupted image by the network, the pixel-wise absolute difference between the reconstructed image and the query image is computed as loss value by the above-mentioned loss function. The model is trained for 200 epoch.", "For anomaly detection, only the 24x24 center region of this absolute difference image is used. Image patches in which defects appear close to the border of the cut out 32 x32 center region, the neural network seems to generate local continuations of the bordering defects. By considering only the 24x24 center region, these unwanted continuations are mostly excluded.", "After training the model for 200 epochs the mode is used to predict the anomaly score on the same data set again. The resulting anomaly scores distribution looks like:", "Listing images that are 3 standard deviations away from the sample mean gives us 99 image files. 99 out of 10K images are not bad. By cross-referencing these file names with the anomaly image chunks, of 99 images, only two anomalies categories, \u2018Parachute\u2019 and \u2018Descent-Stage-Crash-Site\u2019, were detected by this model. It missed out \u2018Heat-Sheild\u2019, \u20182-new-spots-spot1\u2019, \u20182-new-spots-spot2\u2019, \u2018Curiosity-Rover\u2019. Out of 99 images, only 7 images were of anomalies. Not a good result though!", "On closely analyzing the anomaly images that were not detected, it is found that missed out anomaly images have the anomalies to the side of the image, i.e., not at the 32x32 center of the image. Since the DCNN model is trained to reconstruct the center 32x32 pixels, splitting the images chunks with the stride of 16 will ensure that anomaly will occupy the center 32x32 part of some image chunks.", "So, recreated the initial data set with image chunks chopped with stride 16. Instead of retraining the model again on this new data set, the previously trained model is used to predict the anomaly score on this stride 16 data set. The resulting anomaly score distribution looks like:", "We can clearly see a spike in the number of images on the far right of the distributions. Listing out the images that are 3 standard deviations away from the sample mean gives us 705 image files. By cross-referencing these file names with the anomaly image chunks, it is found that all 705 files belong to four types of anomalies \u2018Heat-Sheild\u2019, \u2018Parachute\u2019, \u2018Descent-Stage-Crash-Site\u2019, \u2018Curiosity-Rover\u2019. And zero false positives. Voila, 4 out of six needles are found!", "This approach missed out \u20182-new-spots-spot2\u2019, \u20182-new-spots-spot1\u2019 anomalies still. If we observe these anomalies, these anomalies are very small and as the images are rescaled from 256x256 to 128x128, the anomaly scores generated by these images will be less.", "The approach of \u201cAnomaly Detection using Deep Learning based Image Completion\u201d seems to be a viable option for detecting techno signatures on the Martian surface. The model performance can be further enhanced by:", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "A software architect and a technology evangelist."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F66dc9953a546&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fanomaly-detection-in-martian-surface-66dc9953a546&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fanomaly-detection-in-martian-surface-66dc9953a546&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fanomaly-detection-in-martian-surface-66dc9953a546&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fanomaly-detection-in-martian-surface-66dc9953a546&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----66dc9953a546--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----66dc9953a546--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://blog.mur.li/?source=post_page-----66dc9953a546--------------------------------", "anchor_text": ""}, {"url": "https://blog.mur.li/?source=post_page-----66dc9953a546--------------------------------", "anchor_text": "Murli Sivashanmugam"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F12905d227e01&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fanomaly-detection-in-martian-surface-66dc9953a546&user=Murli+Sivashanmugam&userId=12905d227e01&source=post_page-12905d227e01----66dc9953a546---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F66dc9953a546&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fanomaly-detection-in-martian-surface-66dc9953a546&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F66dc9953a546&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fanomaly-detection-in-martian-surface-66dc9953a546&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://static.uahirise.org/images/2012/details/cut/ESP_028401_1755.jpg", "anchor_text": "Image Source"}, {"url": "https://omdena.com/mars/", "anchor_text": "Omdena community"}, {"url": "https://www.nasa.gov/sites/default/files/thumbnails/image/pia22587.jpg", "anchor_text": "Image Source"}, {"url": "https://www.sciencealert.com/nasa-have-just-released-2-540-gorgeous-new-photos-of-mars", "anchor_text": "Image Source"}, {"url": "https://agenciasinc.es/var/ezwebin_site/storage/images/multimedia/fotografias/fotografian-las-capas-del-polo-norte-marciano/1095961-3-esl-MX/Fotografian-las-capas-del-Polo-Norte-marciano_image800_.jpg", "anchor_text": "Image Source"}, {"url": "https://www.jpl.nasa.gov/spaceimages/images/largesize/PIA22052_hires.jpg", "anchor_text": "Image Source"}, {"url": "https://www.jpl.nasa.gov/spaceimages/images/largesize/PIA12249_hires.jpg", "anchor_text": "Image Source"}, {"url": "https://www.uahirise.org/ESP_028401_1755", "anchor_text": "https://www.uahirise.org/ESP_028401_1755"}, {"url": "https://static.uahirise.org/images/2012/details/cut/ESP_028401_1755.jpg", "anchor_text": "Image Source"}, {"url": "https://hirise-pds.lpl.arizona.edu/PDS/EXTRAS/RDR/ESP/ORB_028400_028499/ESP_028401_1755/ESP_028401_1755_RED.browse.jpg", "anchor_text": "Image Source"}, {"url": "http://Black and white", "anchor_text": "Image Source"}, {"url": "https://arxiv.org/abs/1811.06861", "anchor_text": "https://arxiv.org/abs/1811.06861"}, {"url": "https://betergevondenworden.nl/wp-content/uploads/2017/07/naald-in-hooiberg.jpg", "anchor_text": "Image Source"}, {"url": "https://arxiv.org/abs/1811.06861", "anchor_text": "Image Source"}, {"url": "https://arxiv.org/abs/1811.06861", "anchor_text": "Image Source"}, {"url": "https://medium.com/tag/mars?source=post_page-----66dc9953a546---------------mars-----------------", "anchor_text": "Mars"}, {"url": "https://medium.com/tag/anomaly-detection?source=post_page-----66dc9953a546---------------anomaly_detection-----------------", "anchor_text": "Anomaly Detection"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----66dc9953a546---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/ai?source=post_page-----66dc9953a546---------------ai-----------------", "anchor_text": "AI"}, {"url": "https://medium.com/tag/cnn?source=post_page-----66dc9953a546---------------cnn-----------------", "anchor_text": "Cnn"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F66dc9953a546&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fanomaly-detection-in-martian-surface-66dc9953a546&user=Murli+Sivashanmugam&userId=12905d227e01&source=-----66dc9953a546---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F66dc9953a546&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fanomaly-detection-in-martian-surface-66dc9953a546&user=Murli+Sivashanmugam&userId=12905d227e01&source=-----66dc9953a546---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F66dc9953a546&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fanomaly-detection-in-martian-surface-66dc9953a546&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----66dc9953a546--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F66dc9953a546&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fanomaly-detection-in-martian-surface-66dc9953a546&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----66dc9953a546---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----66dc9953a546--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----66dc9953a546--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----66dc9953a546--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----66dc9953a546--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----66dc9953a546--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----66dc9953a546--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----66dc9953a546--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----66dc9953a546--------------------------------", "anchor_text": ""}, {"url": "https://blog.mur.li/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://blog.mur.li/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Murli Sivashanmugam"}, {"url": "https://blog.mur.li/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "96 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F12905d227e01&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fanomaly-detection-in-martian-surface-66dc9953a546&user=Murli+Sivashanmugam&userId=12905d227e01&source=post_page-12905d227e01--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F8a38d8eeac3d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fanomaly-detection-in-martian-surface-66dc9953a546&newsletterV3=12905d227e01&newsletterV3Id=8a38d8eeac3d&user=Murli+Sivashanmugam&userId=12905d227e01&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}