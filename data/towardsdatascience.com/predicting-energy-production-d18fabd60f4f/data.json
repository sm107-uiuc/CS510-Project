{"url": "https://towardsdatascience.com/predicting-energy-production-d18fabd60f4f", "time": 1683011695.325189, "path": "towardsdatascience.com/predicting-energy-production-d18fabd60f4f/", "webpage": {"metadata": {"title": "Predicting Energy Production. Using deep learning neural network\u2026 | by Dehan Chia | Towards Data Science", "h1": "Predicting Energy Production", "description": "As created for AI4IMPACT\u2019s Deep Learning Datathon 2020, TEAM DEFAULT has created a neural-network-based deep learning model used for predicting energy production demand in France. The model was\u2026"}, "outgoing_paragraph_urls": [{"url": "https://ai4impact.org/dld.html?utm_source=Organization&utm_campaign=115423c0af-EMAIL_CAMPAIGN_2020_07_25_12_17_COPY_01&utm_medium=email&utm_term=0_74e63668fd-115423c0af-412311189", "anchor_text": "AI4IMPACT\u2019s Deep Learning Datathon 2020", "paragraph_index": 0}, {"url": "https://www.rte-france.com/", "anchor_text": "R\u00e9seau de transport d\u2019\u00e9lectricit\u00e9", "paragraph_index": 12}], "all_paragraphs": ["As created for AI4IMPACT\u2019s Deep Learning Datathon 2020, TEAM DEFAULT has created a neural-network-based deep learning model used for predicting energy production demand in France. The model was created using Smojo, on AI4IMPACT\u2019s innovative cloud-based learning and model deployment system.", "Our model was able to achieve a 0.131 test loss which beat persistence loss of 0.485 by a quite a fair margin.", "As the energy market becomes increasingly liberalized across the world, the free and open market has seen an uptick and importance for optimized energy demand. New and existing entrants turn to data and various methods to forecast energy consumption in hopes of turning over a profit.", "This is especially important in countries looking to convert and adopt clean / renewable energy generation to reduce carbon footprint, meet regulatory standards or to simply refrain from investing capital in carbon capture technology. Because the Sun does not shine all day and the wind does not blow, the forecasting of energy demand has become more relevant than ever to prevent shortages and blackouts.", "With the advent of Artificial Intelligence (AI) along with Machine Learning, retailers and traders have utilized the potential of Artificial Neural Networks to optimize energy demand and hence output.", "The objective of our project is to maximise profits for our client using a neural network deep learning model, which predicts the energy demand 18 hours into the future.", "The model will run in real time from 21 July \u2014 29 July, where the profits and leader board standings are tracked as they happen. The model will be built on Autocaffe, an AI development tool developed by AI4IMPACT.", "Our goal is to get a T+18 hour energy forecast, every hour. The objective is to maximize profits for your client using your energy production forecast and the given trading algorithm.", "The following parameters are in play:", "For the first 18 hours (called the \u201cwarmup\u201d), no trades are performed. After warmup every hour you are expected to produce a T+18 hour forecast for energy production. This is called the \u201ctrading period\u201d. Trades continue over weekends and public holidays, 24x7. Trading ends at the end of the evaluation period.", "You are given a cash-at-hand of 10,000,000 euro cents at the start. You need to return this amount at the end of the evaluation period. The remainder is your client\u2019s profits, which is your job to maximize.", "2 datasets were used: wind energy production and wind speeds", "The source of wind energy production comes from R\u00e9seau de transport d\u2019\u00e9lectricit\u00e9, (RTE) the French energy transmission authority.", "Near-real-time wind energy actuals are derived from RTE\u2019s online database, which we average and standardize to a time base of 1 hour.", "Looking at the whole date range at a daily resolution, we can fit a simple increasing polynomial order 2 line, and observe a gradual increase in energy demand over time.", "Examining the data at a quarterly resolution, we see that the different quarters have differing energy demands. The trend seems to be that it hits a maximum in quarter 1 (January, February & March) and consistently falls over the rest of the months until increasing from the 3rd quarter onwards to the 1st quarter the following year.", "Examining the data at a weekly resolution, we have observed differences in energy demand throughout the weeks. By calculating the average energy production by day, we noticed that energy production tends to be highest on Monday, and lowest on Tuesday.", "It seems like the trend is that energy demand starts at a low on Tuesday, increases on Wednesday, decreases til Saturday, then increases on Sunday and Monday.", "As seen from the dataset below, the values have a seasonal trend with more energy generated in the November to March periods annually. In addition, according to the wind farm information, new wind farms were added in August 2017 and July 2019. To ensure we are able to obtain a large enough dataset with minimal drift, we decided to take the dataset from 01 January 2019 to the present.", "We only consider the data up to 3 decimal places from 01 January 2019 for the energy production values as our first column of data and obtaining the wind speed values of the different locations and calculating the average values for wind speed as our second column of data.", "This chart below shows the chart of the energy & wind speed from 01 January 2019. There is a clear close correlation between the 2 variables. Further inferences that can be made will be that after the addition of new producers generally the energy production rates are higher. Wind direction also does not contribute greatly to the energy production hence, it is omitted.", "Using autocaffe, we calculated the statistics of the 2 variables in consideration. The data below are the values to be used for normalization of the 2 variables. We have also found the persistence values of 0.485 which we will have to beat when developing our trading model.", "A 70:30 Train/Test split of the dataset was used to ensure sufficient training. A ratio tending towards balance in the ratio could result in under-fitting of the test and further novel data.", "To find out the maximum profits obtainable, we took the sum of energy produced from 01 Jan 2019 to present, x10 cents, x 0.3 to account for the train/test split. The reason for bench-marking will allow us to test for profits. The maximum profits that we are able to obtain during the whole period will be 9.972E+08 cents.", "Below is a summary of the iterative process the team has gone through to come up with the final model. The individual iterations are detailed below", "At first, we started out with a naive network to test run our first round of results with the data. This energy window includes features from T-24 to T-0 hours mean and standard deviation values. The wind speed window only includes data from T-0 to T+18 hours. We have a 3 varied size for our neural network size which are 32, 64 and 128 nodes. Solver type we chose is Adam with 3 hidden layers in the neural network. This first run will include no hyper-parameter tuning.", "The results we obtained below from this first test run showed us that our best test loss is 0.388224. Our profits for this run totaled 3.354E8 euro cents which is only 33.6% of the maximum obtainable profits. Our actual vs test predictions graph is also very scattered which is bad as it shows that our model is not reliable and accurate. The lag peak is also at 18 which is bad.", "We concluded that more features can be added to our model to ensure better results and accuracy hence, we added more detailed features which includes T-24 to T-0 hours mean and standard deviation, minimum and maximum values, skewness, diff values and more past data from energy such as T-168 to T-0 hours and T-336 to T-0 hours mean, standard deviation and skewness values.", "As for the wind speed data, we included future values from T+15 to T+18 hours. There are no other changes to the network as of yet at this point. Keeping in mind that previously with the best test loss of 0.38824 and a profit of 3.354E8 euro cents. Running the newer model, we obtained a better test loss of 0.137427 and a new high for our profits at 6.514E8 cents which is at 65.3% of our maximum possible profits. As for our actual vs test predictions graph, we are able to see a better correlation between the 2 values and our lag peak is at 0 which is a good sign that our model is improving.", "Building on the knowledge from the previous lab, more hidden layers were added to the model. Specifically, dropout rates of 0.01, 0.001, 0.0001 were added to reduce over-fitting on the training dataset. Similarly, weight decay values of 0.01, 0.001 and 0.0001 were added to reduce over-fitting .L2 regularization was included to reduce the magnitudes of neural network weights during training.", "The best test loss obtained was 0.135409, with profits of 6.467E8 which was worse than previously. We noticed that the actuas and test predictions became more correlated, with slightly higher lagged correlation peaks. The best performing setup was NN-size = 256, dropout = 0.0001, decay = 0.001.", "Next, we repeated the same neural network configurations but only with data from July 2019 with results shown in the graphs below. Running the model gave us an even better test loss obtained at 0.100719 which beat the test loss from our datasets starting from January 2019. However, our profits obtained from this newer and more recent model is only at 2.439E8 euro cents which is only 30.4% of the expected 8.016E8 cents profits that we should be achieving.", "Lastly, we tested the addition of the concepts of momentum, force loss and auto-encoders on the model. Under the addition of momentum and force loss, the best test loss attained was 0.158881 and a profit of 6.157E8. We observed increased noise in the predictions, resulting in less accurate predictions.", "Under the auto-encoder, the best test loss of 0.129414 was obtained with profits of 6.647E8. This made models noticeably longer to train, and resulted in test results which were more varied.", "Our final model was a simple model, which used setup #3 with a repeat of 20 and took the best setup.", "The features used included the mean, standard deviation, skewness and diff for 3 respective time frames: T-24, T-168 and T-336. Additionally, we used the past data to forecast the next 18 hours from T-0 hours (T-0 to T-18 hours), and used a value pair for 18 differences from T-(-24) to T-0. This resulted in a total of 14 separate features in the model.", "The model had the following features:", "The final model managed a final test loss of 0.132 and profits of 6.501E8 euro cents. For comparison, persistence loss = 0.485 and profit benchmark = 9.972E+08. The model\u2019s train & test losses, actual & test predictions, and lagged correlation graphs are shown below.", "While we sought to keep our inputs precise and within our intuition, the potential of having wind direction as an additional input could prove to be useful.\u200b", "Further improvements were tested and biased from the preceding config; when a general trend was observed, the team pursued it without consideration for another vastly different set-up.\u200b", "Similar to the idea of \u201crandom initialization\u201d of neuron weights, the team could \u201cinitialize\u201d a new starting point which could provide insights not seen before.\u200b", "The initially neglected data before 2019 could be utilized if subjected to further cleaning and normalization to fit within the same normalized range for data 2019 and beyond. With more data, the model would learn better.\u200b", "The team believed that a complex model would not necessarily equate to better results as it may be prone at being stuck at sub-optimal solutions. Hence, our methodology started at an intuitive simple model and building upon it by analyzing trends and by trial & error. After all, a model that we could understand could be improved on objectively and not blindly.", "With our good results so far, we head into the live testing period with confidence.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fd18fabd60f4f&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-energy-production-d18fabd60f4f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-energy-production-d18fabd60f4f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-energy-production-d18fabd60f4f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-energy-production-d18fabd60f4f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----d18fabd60f4f--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----d18fabd60f4f--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@thedehan?source=post_page-----d18fabd60f4f--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@thedehan?source=post_page-----d18fabd60f4f--------------------------------", "anchor_text": "Dehan Chia"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fb7b718ab5bb6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-energy-production-d18fabd60f4f&user=Dehan+Chia&userId=b7b718ab5bb6&source=post_page-b7b718ab5bb6----d18fabd60f4f---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fd18fabd60f4f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-energy-production-d18fabd60f4f&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fd18fabd60f4f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-energy-production-d18fabd60f4f&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://ai4impact.org/dld.html?utm_source=Organization&utm_campaign=115423c0af-EMAIL_CAMPAIGN_2020_07_25_12_17_COPY_01&utm_medium=email&utm_term=0_74e63668fd-115423c0af-412311189", "anchor_text": "AI4IMPACT\u2019s Deep Learning Datathon 2020"}, {"url": "https://unsplash.com/@mahkeo?utm_source=medium&utm_medium=referral", "anchor_text": "Khamk\u00e9o Vilaysing"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://www.rte-france.com/", "anchor_text": "R\u00e9seau de transport d\u2019\u00e9lectricit\u00e9"}, {"url": "https://www.linkedin.com/in/koh-wei-wen-927044120/", "anchor_text": "Koh Wei Wen - Corporate Liaison Director - Nanyang Technological University Students&#39;\u200b Union\u2026A current student at Nanyang Technological University (NTU) pursuing a BEng Mechanical Engineering & a Minor in\u2026www.linkedin.com"}, {"url": "https://www.linkedin.com/in/anders-choo/", "anchor_text": "Anders Choo - Nanyang Technological University - Singapore | LinkedInView Anders Choo's profile on LinkedIn, the world's largest professional community. Anders' education is listed on\u2026www.linkedin.com"}, {"url": "http://linkedin.com/in/gabriel-tan-223a631a0", "anchor_text": "Gabriel Tan - NUS Student Ambassador - National University of Singapore | LinkedInView Gabriel Tan's profile on LinkedIn, the world's largest professional community. Gabriel has 4 jobs listed on their\u2026linkedin.com"}, {"url": "https://www.linkedin.com/in/dehan-c-948045177/", "anchor_text": "Dehan C. - Big Data Intern - Razer Inc. | LinkedInView Dehan C.'s profile on LinkedIn, the world's largest professional community. Dehan has 1 job listed on their\u2026www.linkedin.com"}, {"url": "https://towardsdatascience.com/create-a-sms-spam-classifier-in-python-b4b015f7404b", "anchor_text": "Create a SMS spam classifier in pythonNatural Language Processing basics using scikit-learntowardsdatascience.com"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----d18fabd60f4f---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----d18fabd60f4f---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/python?source=post_page-----d18fabd60f4f---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/data-science?source=post_page-----d18fabd60f4f---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/data-analytics?source=post_page-----d18fabd60f4f---------------data_analytics-----------------", "anchor_text": "Data Analytics"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fd18fabd60f4f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-energy-production-d18fabd60f4f&user=Dehan+Chia&userId=b7b718ab5bb6&source=-----d18fabd60f4f---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fd18fabd60f4f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-energy-production-d18fabd60f4f&user=Dehan+Chia&userId=b7b718ab5bb6&source=-----d18fabd60f4f---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fd18fabd60f4f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-energy-production-d18fabd60f4f&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----d18fabd60f4f--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fd18fabd60f4f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-energy-production-d18fabd60f4f&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----d18fabd60f4f---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----d18fabd60f4f--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----d18fabd60f4f--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----d18fabd60f4f--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----d18fabd60f4f--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----d18fabd60f4f--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----d18fabd60f4f--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----d18fabd60f4f--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----d18fabd60f4f--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@thedehan?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@thedehan?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Dehan Chia"}, {"url": "https://medium.com/@thedehan/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "89 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fb7b718ab5bb6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-energy-production-d18fabd60f4f&user=Dehan+Chia&userId=b7b718ab5bb6&source=post_page-b7b718ab5bb6--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F6c6f2456b14&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-energy-production-d18fabd60f4f&newsletterV3=b7b718ab5bb6&newsletterV3Id=6c6f2456b14&user=Dehan+Chia&userId=b7b718ab5bb6&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}