{"url": "https://towardsdatascience.com/imbalanced-data-oversampling-using-genetic-crossover-operators-bb581150a9a8", "time": 1683018330.609292, "path": "towardsdatascience.com/imbalanced-data-oversampling-using-genetic-crossover-operators-bb581150a9a8/", "webpage": {"metadata": {"title": "Imbalanced Data \u2014 Oversampling Using Genetic Crossover Operators | by Bassel Karami | Towards Data Science", "h1": "Imbalanced Data \u2014 Oversampling Using Genetic Crossover Operators", "description": "TL;DR \u2014 There are many ways to oversample imbalanced data, other than random oversampling, SMOTE, and its variants. In a classification dataset generated using scikit-learn\u2019s make_classification\u2026"}, "outgoing_paragraph_urls": [], "all_paragraphs": ["TL;DR \u2014 There are many ways to oversample imbalanced data, other than random oversampling, SMOTE, and its variants. In a classification dataset generated using scikit-learn\u2019s make_classification default settings, samples generated using crossover operations outperform SMOTE and random oversampling on the most relevant metrics.", "Many of us have been in the situation of working on a predictive model with an imbalanced dataset.", "The most popular approaches to handling the imbalance include:", "This article will address oversampling techniques, and we will specifically look into how SMOTE variants (borderline SMOTE, ADASYN etc.) that rely on interpolating across the feature space may be generating less novel synthetic data.", "There are too many alternative ways to oversample. We look into oversampling synthetic data using simple single-point, two-point, and uniform crossover operations and we\u2019ll compare the evaluation results to SMOTE and random oversampling. Often a combination of over- and under- sampling works better, but we will stick to oversampling for this demonstration.", "We use scikit-learn\u2019s make_classification function to create an imbalanced dataset with 5000 data points across two classes (binary classification). There is a 95% chance the target is 0 and a 5% chance the target is 1.", "By default 20 features are created, below is what a sample entry in our X array looks like.", "The rest of the settings in make_classification are kept to default and we split the data into training and testing datasets.", "Now let\u2019s prepare functions to generate datasets where our minority class (target = 1) can be oversampled using random oversampling and SMOTE.", "Note that we use plain SMOTE rather than borderline SMOTE, ADASYN, SVM-SMOTE etc. to allow for an apples-to-apples comparison. When generating samples using crossover operations in the next section, we are not considering whether we are generating samples near the borderline or samples that are considered noisy etc.", "If you are unfamiliar with random oversampling and SMOTE, there are plenty of resources online, but here is a quick recap:", "The crossover operation is widely used in genetic algorithms and it is motivated by the crossover of genetic material that happens in sexual reproduction.", "The operation is relatively straightforward, where information in a \u201cchromosome\u201d is contributed by two \u201cparents\u201d to generate a \u201cchild\u201d. In our use case, information in a chromosome is simply feature values.", "It is common to represent information in a bit array for better performance.", "Example: In our dataset, We have 20 features and 5000 samples. In a single-point crossover operation, we could choose two \u201cparents\u201d, for example sample #20 and sample #1500, and we choose a random crossover point, for example, the 10th feature. We then generate a new \u201cchild\u201d, i.e. new data point, where this new data point takes features 1\u20139 from its first parent (sample #20) and features 10\u201320 from its second parent (sample #1500).", "We will consider 3 kinds of crossover operations:", "The single-point crossover operation is the example illustrated above where features before a crossover point are contributed by one parent and features after the crossover point are contributed by the other.", "In a two-point crossover operation, parent 1 contributes to the child data point\u2019s feature values before the first crossover point, then parent 2 contributes its feature values until the second crossover point, then contribution goes back to parent 1 after the second crossover point.", "In a uniform crossover operation, either of the 2 parents can contribute to the child data point\u2019s feature values for any of the 20 features.", "Below is the function we use to generate crossover samples. There is an additional argument, knn, which filters out any generated samples whose nearest neighbor has a target of 0 instead of 1. By default this option is set to False.", "Finally, note that the choice of parents is completely random and not based on their \u201cfitness\u201d, which is common in genetic algorithms.", "Finally, we iterate through 30 random states and compare the performance of a random forest classifier on the original dateset as well as 11 oversampling methods that ensure we have 2000 data points with a target=1:", "We also look into 7 classification metrics:", "Below are the code and results\u2026", "All variants of crossover oversampling as well as SMOTE with all values for the # of nearest neighbors parameter, k, outperform the original dataset and random oversampling.", "Top performers are SMOTE with k=5 and k=10 and single-point crossover (with and without KNN).", "The above result is driven by higher recall and is an indication of novelty in the oversampled data as the random forest classifier can identify new areas in the feature space which potentially correspond to a target of 1.", "The ROC AUC metric is not the best one to use in an imbalanced dataset though. The precision-recall curve we look at next is arguably more appropriate.", "Above it become clearer that all variants of crossover oversampling are outperforming SMOTE across the different k parameters.", "The single and two point crossover operations without the KNN are filter are the top performers.", "Another metric I lookout for is the maximum achievable F1 score after an optimal probability threshold is chosen. That is the Max F1 plot below.", "Again, the insights are identical to those obtained from PR AUC chart. Crossover variants outperform, especially single and two point crossover without KNN.", "Balanced accuracy is equivalent to the unweighted mean of recall on 1s and recall on 0s. It gives equal weight to both.", "The drawback of balanced accuracy and the rest of the metrics we will look at is that they consider a model\u2019s predictive performance assuming a probability threshold of 0.5 would be used. Often, models might have significantly better performance using different thresholds.", "Nevertheless, balanced accuracy shows crossover oversampling as the clear winner with a slight edge to uniform crossover and no KNN.", "A comparison of recall also re-confirms our previous insights on crossover oversampling\u2019s outperformance. In this case, SMOTE with a parameter of 10 is also a top performer, but in the precision comparison below we can see that even though using SMOTE with a larger number of neighbors could add some novel data that increases recall, the reduction in precision is more severe compared to using crossover mechanisms.", "This explains the better performance crossover oversampling achieves on more balanced metrics such as PR AUC, balanced accuracy, and Max F1.", "The higher recall achieved by crossover and smote oversampling comes with a price, precision. As we start to label synthetic oversampled data with a target of 1, even though we are not 100% certain about the label that should be assigned, precision is expected to decrease.", "Typically, in most datasets, precision goes down with such oversampling techniques.", "A key insight is, as mentioned earlier, the precision of data obtained from crossover oversampling is better than SMOTE with high k.", "Again, the F1 score reiterates that crossover oversampling, with an edge to single and two point crossovers, is the best technique in terms of achieving a good combination of recall and precision. I prefer to use the Max F1 score which considers different probability thresholds.", "There are many oversampling techniques that one can devise. The aim of this article is to show how very simple techniques can achieve good performance via allowing for non-linear combinations in the feature space.", "This holds in the dataset above, but I have seen datasets where the loss in precision associated with such techniques causes performance metrics to be low, so every dataset is different and should be handled differently.", "A final note is that I have found oversampling data using an ensemble of techniques works well when combining crossover oversampling with SMOTE, so trying to generate synthetic data using different techniques can also be helpful for creating better ensembles.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data & Analytics Leader @ Majid Al Futtaim"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fbb581150a9a8&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimbalanced-data-oversampling-using-genetic-crossover-operators-bb581150a9a8&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimbalanced-data-oversampling-using-genetic-crossover-operators-bb581150a9a8&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimbalanced-data-oversampling-using-genetic-crossover-operators-bb581150a9a8&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimbalanced-data-oversampling-using-genetic-crossover-operators-bb581150a9a8&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----bb581150a9a8--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----bb581150a9a8--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://bassel-karami.medium.com/?source=post_page-----bb581150a9a8--------------------------------", "anchor_text": ""}, {"url": "https://bassel-karami.medium.com/?source=post_page-----bb581150a9a8--------------------------------", "anchor_text": "Bassel Karami"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F68fc7cb80932&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimbalanced-data-oversampling-using-genetic-crossover-operators-bb581150a9a8&user=Bassel+Karami&userId=68fc7cb80932&source=post_page-68fc7cb80932----bb581150a9a8---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fbb581150a9a8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimbalanced-data-oversampling-using-genetic-crossover-operators-bb581150a9a8&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fbb581150a9a8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimbalanced-data-oversampling-using-genetic-crossover-operators-bb581150a9a8&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://pixabay.com/users/liyuanalison-17881756/", "anchor_text": "liyuanalison"}, {"url": "https://pixabay.com/illustrations/dna-genetics-molecule-biology-5695421/", "anchor_text": "Pixabay"}, {"url": "https://medium.com/tag/data-science?source=post_page-----bb581150a9a8---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----bb581150a9a8---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/imbalanced-data?source=post_page-----bb581150a9a8---------------imbalanced_data-----------------", "anchor_text": "Imbalanced Data"}, {"url": "https://medium.com/tag/genetic-algorithm?source=post_page-----bb581150a9a8---------------genetic_algorithm-----------------", "anchor_text": "Genetic Algorithm"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----bb581150a9a8---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fbb581150a9a8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimbalanced-data-oversampling-using-genetic-crossover-operators-bb581150a9a8&user=Bassel+Karami&userId=68fc7cb80932&source=-----bb581150a9a8---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fbb581150a9a8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimbalanced-data-oversampling-using-genetic-crossover-operators-bb581150a9a8&user=Bassel+Karami&userId=68fc7cb80932&source=-----bb581150a9a8---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fbb581150a9a8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimbalanced-data-oversampling-using-genetic-crossover-operators-bb581150a9a8&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----bb581150a9a8--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fbb581150a9a8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimbalanced-data-oversampling-using-genetic-crossover-operators-bb581150a9a8&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----bb581150a9a8---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----bb581150a9a8--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----bb581150a9a8--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----bb581150a9a8--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----bb581150a9a8--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----bb581150a9a8--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----bb581150a9a8--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----bb581150a9a8--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----bb581150a9a8--------------------------------", "anchor_text": ""}, {"url": "https://bassel-karami.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://bassel-karami.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Bassel Karami"}, {"url": "https://bassel-karami.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "142 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F68fc7cb80932&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimbalanced-data-oversampling-using-genetic-crossover-operators-bb581150a9a8&user=Bassel+Karami&userId=68fc7cb80932&source=post_page-68fc7cb80932--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F342c739ecf14&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimbalanced-data-oversampling-using-genetic-crossover-operators-bb581150a9a8&newsletterV3=68fc7cb80932&newsletterV3Id=342c739ecf14&user=Bassel+Karami&userId=68fc7cb80932&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}