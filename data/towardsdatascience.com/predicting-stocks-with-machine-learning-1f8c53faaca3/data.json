{"url": "https://towardsdatascience.com/predicting-stocks-with-machine-learning-1f8c53faaca3", "time": 1682997377.640141, "path": "towardsdatascience.com/predicting-stocks-with-machine-learning-1f8c53faaca3/", "webpage": {"metadata": {"title": "Predicting Stocks With Machine Learning | by Mikhail Mew | Towards Data Science", "h1": "Predicting Stocks With Machine Learning", "description": "The proliferation of machine learning has been unprecedented. There exists very few domains where data-based decision making is required that hasn\u2019t seen its widespread application. The field of\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.google.com/search?q=machine+learning+stocks&rlz=1C1SQJL_enAU774AU774&oq=machine+learning+stocks&aqs=chrome..69i57j0l5.5101j0j8&sourceid=chrome&ie=UTF-8", "anchor_text": "\u201cML\u201d and \u201cstock prediction\u201d", "paragraph_index": 0}, {"url": "https://towardsdatascience.com/questions-96667b06af5", "anchor_text": "rules and guidelines", "paragraph_index": 4}, {"url": "https://towardsdatascience.com/readers-terms-b5d780a700a4", "anchor_text": "Reader Terms", "paragraph_index": 4}, {"url": "https://www.investopedia.com/terms/s/serial-correlation.asp?source=post_page---------------------------", "anchor_text": "serial correlation", "paragraph_index": 5}, {"url": "https://en.wikipedia.org/wiki/Equity_(finance)?source=post_page---------------------------", "anchor_text": "assets minus liabilities equals equity", "paragraph_index": 6}, {"url": "https://en.wikipedia.org/wiki/Autoregressive_integrated_moving_average?source=post_page---------------------------", "anchor_text": "ARIMA", "paragraph_index": 11}, {"url": "https://en.wikipedia.org/wiki/Root-mean-square_deviation?source=post_page---------------------------", "anchor_text": "Root Mean Square Error (RMSE)", "paragraph_index": 14}, {"url": "https://en.wikipedia.org/wiki/Cross_entropy?source=post_page---------------------------", "anchor_text": "Cross Entropy", "paragraph_index": 14}, {"url": "http://image-net.org/challenges/LSVRC/?source=post_page---------------------------", "anchor_text": "ILSVRC", "paragraph_index": 14}, {"url": "https://www.investopedia.com/terms/b/blackswan.asp?source=post_page---------------------------", "anchor_text": "Black Swan", "paragraph_index": 15}, {"url": "https://en.wikipedia.org/wiki/Nassim_Nicholas_Taleb?source=post_page---------------------------", "anchor_text": "Nassim Taleb", "paragraph_index": 15}, {"url": "https://en.wikipedia.org/wiki/Walk_forward_optimization?source=post_page---------------------------", "anchor_text": "walk forward testing", "paragraph_index": 17}, {"url": "https://money.cnn.com/data/markets/sandp/?source=post_page---------------------------", "anchor_text": "18.74% of the S&P 500 calendar year to date", "paragraph_index": 18}], "all_paragraphs": ["The proliferation of machine learning has been unprecedented. There exists very few domains where data-based decision making is required that hasn\u2019t seen its widespread application. The field of investing is no exception. One simply has to search Google jointly for \u201cML\u201d and \u201cstock prediction\u201d to be presented with a plethora of time series forecasting and Recurrent Neural Network related content. Although stock price data may appear to be the perfect candidates for these types of algorithms, we should exercise prudence and approach this task with caution (especially if your hard earned cash is involved).", "Those initiated into the arcane prediction arts of machine learning will recall one of their first lessons in the topic being some iteration of the below Venn diagram:", "The point here is clear. Machine learning (or data science) straddles the confluence of technical skills (such as programming and maths) with subject matter knowledge in the form of domain expertise. Without all three forms present, we simply regress back to one of the more pure forms of the respective field.", "This depiction holds especially true for financial machine learning. Time series financial data is incredibly nuanced, applying an off the shelf algorithm to unprocessed price data is the perfect recipe for false discovery or worse, loss of capital. Therefore using this data requires some special considerations and most importantly, the application of domain knowledge. As such, this article aims to impart some intuition that is often overlooked by those new to the field. We will focus primarily on the discussion aspects of the problem, as resources on the associated math and coding are already available in abundance.", "Note from Towards Data Science\u2019s editors: While we allow independent authors to publish articles in accordance with our rules and guidelines, we do not endorse each author\u2019s contribution. You should not rely on an author\u2019s works without seeking professional advice. See our Reader Terms for details.", "This may come as no surprise as data is the key ingredient for any ML model, stock prediction being no exception. To understand what informs our caution, we need to first understand the data generation process. Commonly analyzed domain data sets for stock prediction such as macroeconomic, fundamental and price data are examples of time series data. This category of data suffers from a phenomena called serial correlation. Simply put, the value of each observation is anchored to the value observed in the previous time interval.", "To illustrate this in practice lets us take an example in prices. If we observe any stock and track its price movements at daily intervals we see that the closing price for each stock is tightly anchored to the previous day \u2018s closing price save for some \u201cminor\u201d deviations, but why? In it\u2019s simplest form, a stock is a share of ownership in the underlying company whose value is determined by the timeless accounting equation, assets minus liabilities equals equity. The equity is the fundamental value of the company which makes up the bulk of the stock price, with investor sentiment, trading behavior and noise driving the daily deviations. The value of the company\u2019s assets namely machines, land, buildings and inventory do not change materially overnight and nor does its liabilities (not always true )so except in the case of a major accounting scandal, the fundamental value of the company should be relatively stable on a day to day basis.", "What does this mean for machine learning? it means that a model can appear to perform reasonably well by \u201cgaming\u201d its loss function and choosing the previous day\u2019s price as the prediction for the current day\u2019s price. This is clearly observed when the plotted prediction output of many \u201cwell performing prediction models\u201d closely resemble a lagged moving average of the actual stock price. Any such model will be constantly chasing the real price.", "Of a similar vein, is the issue of stationarity. The basis for many ML models and pre-processing techniques make the prerequisite assumption that the parameters of the distributions from which the data is generated is constant. Alternatively, this can be interpreted as the features\u2019 mean and standard deviation do not change with time and there is no trend in the data. One look at the commonly used US quarterly GDP data through time will quickly dispel this notion. There is clearly a trend in this data, and so there should be, if an economy were to grow you\u2019d expect its output (and the prices of those outputs) to grow over time.", "Source: BEA, US Nominal GDP over time", "The mean and standard deviation in this data is time variant and causes some inconveniences in blindly applying algorithms such as regression and common pre-processing techniques such as standardization and principal component analysis.", "One commonly used technique in both (investment) literature and practice to combat these abnormalities in time series data is to take the price return for stocks (or rate of change for other data), between two periods instead of the absolute value. The intuition behind this is similar to that of detrending or differencing in ARIMA time series forecasting which aims to make the data stationary. If we apply this to our US GDP Data we get something that starts to resemble a normal iid variable.", "This approach is not perfect and introduces various other problems but it is the widely accepted methodology.", "Although there are many other aspects of financial data that users need to cognizant of , for the sake of brevity, I will discuss these more comprehensively in a future post.", "Most supervised machine learning methods are fitted by estimating or optimizing for a set of weights that minimize some objective function. In regression problems this function is often Root Mean Square Error (RMSE) and in classification, Cross Entropy. For many classic benchmark data sets like that of the ImageNet Large Scale Visual Recognition Challenge (ILSVRC), it has become a \u201crace to the bottom\u201d with highly qualified teams successively (and successfully) reducing the error rate in leaps and bounds year after year. While this might be appropriate for the purposes of advancing research, the focus in ML on forcing down some arbitrary error term has encouraged the abstraction of the real world problem at hand.", "In investments, finding a model that classifies when to buy or sell a stock with a 95% accuracy rate may seem like a great outcome but often times this model will not mimic true portfolio behavior and most importantly won\u2019t take into account the cost of being wrong. Markets are fickle, whilst seemingly favorable investing environments may persist over a number of years, the correction or \u201cBlack Swan\u201d event (as coined by Nassim Taleb), can unfold in the space of minutes.", "If one of the instances that characterizes your 5% error rate were to co-occur with one of these rare but disastrous events it is almost certain that your portfolio will suffer, possibly to the extent where the accrued rewards from of being right 95% of the time (assuming no generalization error)is completely wiped out. This problem is even more profound for professional investment managers as a draw down of 10% is enough to trigger a mass exodus of investors from their funds. The consequences arising from the asymmetry of gain and pain are well ingrained in the psyches of seasoned practitioners. This is why the industry is as focused on managing risk as it is on generating return.", "The lesson here for the machine learner/data scientist is to understand the implications of their model, move away from being informed solely by the error rate and loss function, perform walk forward testing as if you held your predicted trades through time and introduce cost sensitive measures that penalize your model for being wrong.", "Simply having a good ML model that earns a positive return is not enough, to understand why we need to introduce the concept of opportunity cost. This key economic principle illustrates the cost of the next best opportunity forgone. If we weren\u2019t investing our money using a proposed ML model, the next best opportunity and one that would require little skill is to buy the market, presumably by purchasing an ETF. These products give you the return of an index like the S&P 500 at relatively low cost. So the question must be asked, if the performance of your model, when adjusted for transaction costs, does not materially exceed say, the 18.74% of the S&P 500 calendar year to date, are you really putting your money to good use? Professional investment managers are almost always bound to some benchmark where their skills are measured by their ability to exceed it, contrast this to the machine learner/data scientist where they will often assess their financial predictions in isolation.", "Although this list is neither complete nor comprehensive, I hope I\u2019ve imparted on you some intuition on key things to consider when building your ML model for stock prediction. As with any other data related task, ML may give you a set of tools to utilize, but finding the solution still requires an intimate understanding of the problem.", "Disclaimers: this post is purely an expression of personal views and opinions. It does not represent advice in anyway and does not reflect the views of my employer.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Researcher | Investor | Data Scientist | Curious Observer. Thoughts and insights from the confluence of investing and machine learning."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F1f8c53faaca3&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-stocks-with-machine-learning-1f8c53faaca3&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-stocks-with-machine-learning-1f8c53faaca3&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-stocks-with-machine-learning-1f8c53faaca3&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-stocks-with-machine-learning-1f8c53faaca3&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----1f8c53faaca3--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----1f8c53faaca3--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://aiinvestor.medium.com/?source=post_page-----1f8c53faaca3--------------------------------", "anchor_text": ""}, {"url": "https://aiinvestor.medium.com/?source=post_page-----1f8c53faaca3--------------------------------", "anchor_text": "Mikhail Mew"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F4fdbc7cc65ca&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-stocks-with-machine-learning-1f8c53faaca3&user=Mikhail+Mew&userId=4fdbc7cc65ca&source=post_page-4fdbc7cc65ca----1f8c53faaca3---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F1f8c53faaca3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-stocks-with-machine-learning-1f8c53faaca3&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F1f8c53faaca3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-stocks-with-machine-learning-1f8c53faaca3&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@aronvisuals?utm_source=medium&utm_medium=referral", "anchor_text": "Aron Visuals"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://www.google.com/search?q=machine+learning+stocks&rlz=1C1SQJL_enAU774AU774&oq=machine+learning+stocks&aqs=chrome..69i57j0l5.5101j0j8&sourceid=chrome&ie=UTF-8", "anchor_text": "\u201cML\u201d and \u201cstock prediction\u201d"}, {"url": "https://towardsdatascience.com/questions-96667b06af5", "anchor_text": "rules and guidelines"}, {"url": "https://towardsdatascience.com/readers-terms-b5d780a700a4", "anchor_text": "Reader Terms"}, {"url": "https://unsplash.com/@markusspiske?utm_source=medium&utm_medium=referral", "anchor_text": "Markus Spiske"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://www.investopedia.com/terms/s/serial-correlation.asp?source=post_page---------------------------", "anchor_text": "serial correlation"}, {"url": "https://en.wikipedia.org/wiki/Equity_(finance)?source=post_page---------------------------", "anchor_text": "assets minus liabilities equals equity"}, {"url": "https://en.wikipedia.org/wiki/Autoregressive_integrated_moving_average?source=post_page---------------------------", "anchor_text": "ARIMA"}, {"url": "https://unsplash.com/@emilymorter?utm_source=medium&utm_medium=referral", "anchor_text": "Emily Morter"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://en.wikipedia.org/wiki/Root-mean-square_deviation?source=post_page---------------------------", "anchor_text": "Root Mean Square Error (RMSE)"}, {"url": "https://en.wikipedia.org/wiki/Cross_entropy?source=post_page---------------------------", "anchor_text": "Cross Entropy"}, {"url": "http://image-net.org/challenges/LSVRC/?source=post_page---------------------------", "anchor_text": "ILSVRC"}, {"url": "https://www.investopedia.com/terms/b/blackswan.asp?source=post_page---------------------------", "anchor_text": "Black Swan"}, {"url": "https://en.wikipedia.org/wiki/Nassim_Nicholas_Taleb?source=post_page---------------------------", "anchor_text": "Nassim Taleb"}, {"url": "https://en.wikipedia.org/wiki/Walk_forward_optimization?source=post_page---------------------------", "anchor_text": "walk forward testing"}, {"url": "https://unsplash.com/@o1234567890?utm_source=medium&utm_medium=referral", "anchor_text": "Inactive."}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://money.cnn.com/data/markets/sandp/?source=post_page---------------------------", "anchor_text": "18.74% of the S&P 500 calendar year to date"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----1f8c53faaca3---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----1f8c53faaca3---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/investing?source=post_page-----1f8c53faaca3---------------investing-----------------", "anchor_text": "Investing"}, {"url": "https://medium.com/tag/data-science?source=post_page-----1f8c53faaca3---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/analytics?source=post_page-----1f8c53faaca3---------------analytics-----------------", "anchor_text": "Analytics"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F1f8c53faaca3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-stocks-with-machine-learning-1f8c53faaca3&user=Mikhail+Mew&userId=4fdbc7cc65ca&source=-----1f8c53faaca3---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F1f8c53faaca3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-stocks-with-machine-learning-1f8c53faaca3&user=Mikhail+Mew&userId=4fdbc7cc65ca&source=-----1f8c53faaca3---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F1f8c53faaca3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-stocks-with-machine-learning-1f8c53faaca3&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----1f8c53faaca3--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F1f8c53faaca3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-stocks-with-machine-learning-1f8c53faaca3&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----1f8c53faaca3---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----1f8c53faaca3--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----1f8c53faaca3--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----1f8c53faaca3--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----1f8c53faaca3--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----1f8c53faaca3--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----1f8c53faaca3--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----1f8c53faaca3--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----1f8c53faaca3--------------------------------", "anchor_text": ""}, {"url": "https://aiinvestor.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://aiinvestor.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Mikhail Mew"}, {"url": "https://aiinvestor.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "1K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F4fdbc7cc65ca&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-stocks-with-machine-learning-1f8c53faaca3&user=Mikhail+Mew&userId=4fdbc7cc65ca&source=post_page-4fdbc7cc65ca--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F80b0f0613a28&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-stocks-with-machine-learning-1f8c53faaca3&newsletterV3=4fdbc7cc65ca&newsletterV3Id=80b0f0613a28&user=Mikhail+Mew&userId=4fdbc7cc65ca&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}