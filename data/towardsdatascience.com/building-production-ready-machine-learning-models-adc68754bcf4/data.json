{"url": "https://towardsdatascience.com/building-production-ready-machine-learning-models-adc68754bcf4", "time": 1682993029.366266, "path": "towardsdatascience.com/building-production-ready-machine-learning-models-adc68754bcf4/", "webpage": {"metadata": {"title": "Building Production-Ready Machine Learning Models | by Monte Zweben | Towards Data Science", "h1": "Building Production-Ready Machine Learning Models", "description": "With the quality of machine learning packages being developed today, testing and creating models couldn\u2019t be easier. Data scientists can simply import their favorite library and have immediate access\u2026"}, "outgoing_paragraph_urls": [{"url": "https://github.com/Ibotta/sk-dist#sk-dist-distributed-scikit-learn-meta-estimators-in-pyspark", "anchor_text": "skdist", "paragraph_index": 15}, {"url": "https://info.splicemachine.com/ml-manager-2-0-demo.html?utm_source=medium&utm_medium=post&utm_campaign=ml_manager", "anchor_text": "watch a demo video", "paragraph_index": 32}], "all_paragraphs": ["by Monte Zweben & Ben Epstein", "With the quality of machine learning packages being developed today, testing and creating models couldn\u2019t be easier. Data scientists can simply import their favorite library and have immediate access to dozens of cutting edge algorithms. But creating machine learning models that are production ready requires more than just effective algorithms. It takes experimentation, data exploration and solid organization.", "Data scientists need an environment to freely explore the data and plot different trends and correlations without being handicapped by the size of their dataset. With Splice Machine\u2019s MLManager 2.0 platform, it couldn\u2019t be easier to build, test, experiment and deploy machine learning models seamlessly into production.", "Here is a summary of data science functionality that is available in the latest release of ML Manager.", "As part of ML Manager 2.0, we have built Jupyter notebooks directly into Splice Machine platform with BeakerX support. Jupyter Notebooks are the most popular tool for data scientists to work and share data along with code. They are easy to work with and allow the workflow to be modularized by separating parts of the data science process into different cells.", "In ML Manager 2.0, we went beyond providing access to the generic Jupyter Notebooks. With ML Manager 2.0, data scientists have custom notebooks with added functionality from BeakerX. We\u2019ve worked with the open source BeakerX project and custom built it for Splice Machine. One of the most important features of this customization is polyglot programming. This programming paradigm allows data scientists to write code in a number of different languages all within the same notebook. Each cell can be defined using a \u201cmagic\u201d that tells Jupyter how to interpret the code.", "Data scientists have the flexibility to define the language for an entire cell using %% or just a single line using %. This allows you to write SQL code in the same notebook as your Python, Scala, Java or R code.", "On top of separated polyglot programming, we also allow for cross kernel variable sharing. What this means is you can define a variable in one language, and share it with another language using the underlying BeakerX variable. This gives data scientists unprecedented access to their SQL data. For example:", "There are a number of other great features from BeakerX that are built directly into Splice Machine.", "Jupyter notebooks also come with great built-in visualization tools such as matplotlib and plotly for 2D and 3D plots:", "Data scientists also have access to interactive Pandas tables where you can both filter and sort results as well as add visualizations directly into the tables:", "A serious problem in data science in overfitting. Overfitting can result from a number of different factors. These include creating models that are too finely tuned to training data, making biased splits in your dataset, and even picking the wrong algorithm for the problem. All of these issues can be overcome however.", "Another problem that has been challenging data science teams is the issue of data size. The hardest form of bias to overcome is that of a skewed dataset. Many data science teams run into issues building their model on a subset of data and then training it on the entire dataset. This has the potential to introduce massive bias into the models.", "It is therefore crucial to train the model on the entirety of the available data, and with Splice Machine this is no longer an issue. Because our Jupyter Notebooks are deployed co-resident with our database, data scientists have direct access to the scale-out capabilities to access the entirety of their datasets instantly. More importantly, data engineers and data scientists use a different programming pattern than application developers. They manipulate Spark and Pandas DataFrames. Now Splice offers this pattern as well with a full CRUD API. Using our Native Spark Data Source, you can query your entire table, no matter the size, and immediately work with it as a Spark Dataframe. In milliseconds and with one single api call, you can move all of the data from a table into a Spark Dataframe and display it to the screen. Even more powerful is the ability to insert or even upsert a DataFrame into Splice with full ACID transactionality. This level of data access and manipulation makes model building and data exploration easier than ever before.", "Imagine being able to update real-time feature stores transactionally for multiple models to use in real-time. For example, these feature stores can have tens of thousands of columns tracking customer behavioral patterns that could be instantly turned into a feature vector in a dataframe for a model pipeline to test. Imagine being able to update this feature store in real-time. Models then test features in the moment. What was the transaction that occurred seconds before a call center call? What was the last line item added to an order before an abandonment? What was the last click on a website? With a real-time feature store and a Native Spark DataSource, ML becomes more valuable.", "Modeling on the Splice Machine platform is just as easy. With Spark, Scikit-learn, TensorFlow, H2O, and PyTorch, you can work in your favorite library. For Scikit-learn, we can utilize skdist to train many scikit-learn models simultaneously on Spark (think cross validation models). Future work will include TensorflowOnSpark.", "All of these great features bring with them lots of complexity. Now that you have total access to your data and modeling efforts, how do you build a team around this? How do you organize your work? How do you maintain governance? How do you deploy your models? These questions and many others have brought the term MLOps into view. MLOps is the process of operationalizing the data science workflow for production ready teams. Data Science is different from other engineering efforts in that it\u2019s an experimental process, and requires a different approach to its structure and organization.", "If you\u2019ve ever seen a spreadsheet like this, you know the horror of its creation. This is a typical data science run book spreadsheet. Different experiments, runs, parameters, datasets, metrics, and everything else that may be necessary for a data science experiment all stored in a single excel spreadsheet.", "This is unusable for any serious data science team. It takes a long time to create, it requires redesigns for every new project and it\u2019s prone to user error as different versions are flying around people\u2019s inboxes as attachments. The data scientist in you may be looking at this sheet and asking \u201cwhat if I want to tune another parameter, or try a Random Forest, how would that fit into this spreadsheet?\u201d You are correct in your fears, and the answer to those questions are \u201cyou can\u2019t\u201d and \u201cit doesn\u2019t.\u201d This is where MLManager comes in", "Splice Machine\u2019s MLManager took the popular open source project, MLFlow, and added functionality that we think \u201ccompletes the ML Lifecycle.\u201d With MLFlow, you can easily and dynamically track everything and anything that pertains to your model attempts: Parameters, metrics, training time, run names, model types, artifacts like images (think AUC charts), even serialized models. With Splice Machine\u2019s MLManager, all of those metrics, parameters, and artifacts are stored directly into the database with no need for any external storage mechanism.", "You can easily build a multitude of models, track everything you need, and compare them numerically or visually in the MLFlow UI. For example, above we can see the metrics of a number of different runs created within an experiment, and below we dig into three of those runs and see how the number of trees in our Random Forest relates to our F1:", "Data scientists can even post the notebooks that they have used to build their models to the Github gists in order to share code, notes, and snippets for peer review and transparency. Given an MLFlow run_id, you can trace a model back to its origins. For a production ready data science team, this is crucial to maintaining control over which models get deployed and when.", "Our straightforward API makes this incredibly easy and reusable, where just a few function calls can give you full traceability, no matter what modeling process you are taking. Three key functions we offer are:", "Once models are compared and tested and your team is ready for deployment, the next major hurdle is introduced. Model deployment is a largely discussed topic in the data science world because it is complicated, non generalizable, and difficult to oversee. Popular deployment mechanisms like AzureML and Sagemaker are difficult to build into your pipeline and are hard to maintain governance.", "Who deployed the model? Who is allowed to call the model? Who has made calls to the model in the last 24 hours? How is the model performing? How do you integrate new models into an application? What if we don\u2019t want to deploy to the cloud for security concerns?", "These questions are important ones, and ones without straightforward answers. With Splice Machine\u2019s MLManager, we remove the complexity with the use of in DB model deployment. Our platform allows you to deploy models directly into the database, so every time a new row is inserted into a table, your model is automatically and immediately run, prediction stored, and tracked back to the model in use. On top of all of that, it\u2019s blazing fast, both to deploy and to utilize. Deployment takes less than 10 seconds (compared to the near 30 minutes for Sagemaker/Azure ML deployment). And all model triggers are fully ACID compliant.", "In DB Model deployment, security and governance is also easy for your DBA\u2019s to learn, because your model predictions are just in a table like any other table in the database. Want to revoke access to the model? Revoke access to the table. Want to gather statistics on the model? Just a few SQL queries. Want to substitute one model for another in an application? Change the table name in the query. There is no learning curve because there is no new technology in use. Plus since this is just persistent data you can architect microservices around the model as well", "How is this done? Our MLManager determines the type and structure of your model\u2019s pipeline, and creates tables and triggers specific to your dataset and model, and deploys them to the table of your choosing. The Trigger is generated on the fly and runs immediately when new records are inserted in the chosen table. The Trigger calls a generated Stored Procedure that deserializes the model and applies it to the new records, and writes the predictions to a prediction table. Data scientists and data engineers don\u2019t have to learn RDBMS triggers and stored procedures because they are generated automatically. For example, here is the generated trigger and function for a model deployment:", "If however, your team still wants to deploy to Sagemaker or AzureML, MLManager supports that too, both with a Deployment UI and API calls.", "AI is becoming ever more prudent in business success today. Without it, your company will be left behind by more agile and market ready competitors. Injecting AI has been the biggest roadblock to success because of serious risks and implications of poor model development environments and time-to-deploy. You cannot risk putting a bad model into production that is making mission critical decisions. With Splice Machine, however, governance is fully integrated, experimentation easier than ever, and behind the scenes plumbing a thing of the past.", "For example, consider an insurance company. How does Splice Machine ML Manager helps you comply when a regulator starts questioning the model you use in underwriting? You time-travel back to a \u201cvirtual snapshot\u201d of the database that existed when you trained the model and you show the features that went into the model and the statistical distributions of the data on those features AT THAT TIME. Splice enables the data scientist to log the Snapshot Isolation timestamp of our MVCC transaction engine as meta-data in MLFlow at the time of training. With time-travel, you can prove your compliance in minutes.", "Build models you can trust with our pin-point governance architecture and access to full, unbiased data, deploy models with ease and in seconds, and utilize them in your mission critical applications without latency and with the same ACID compliance of all of your other tables. Integrate your models seamlessly without needing to learn any new architectures or platforms, your model is just a (superpowered) table. Monitor your model the same techniques you monitor any other table, and when a new model is ready to replace it, redeploy in no time. Stop re-creating the wheel for every application you want to modernize.", "For a hands-on look at Splice Machine and ML Manager 2.0, watch a demo video that highlights its powerful functionality and how it enables you to build production-ready ML models.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "CEO and co-founder of Splice Machine. Carnegie Mellon CS Advisory Board, NASA AI Deputy Chief, CEO Blue Martini Software, Red Pepper Software, Rocket Fuel"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fadc68754bcf4&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-production-ready-machine-learning-models-adc68754bcf4&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-production-ready-machine-learning-models-adc68754bcf4&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-production-ready-machine-learning-models-adc68754bcf4&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-production-ready-machine-learning-models-adc68754bcf4&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----adc68754bcf4--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----adc68754bcf4--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://mzweben.medium.com/?source=post_page-----adc68754bcf4--------------------------------", "anchor_text": ""}, {"url": "https://mzweben.medium.com/?source=post_page-----adc68754bcf4--------------------------------", "anchor_text": "Monte Zweben"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F5d691d0967c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-production-ready-machine-learning-models-adc68754bcf4&user=Monte+Zweben&userId=5d691d0967c&source=post_page-5d691d0967c----adc68754bcf4---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fadc68754bcf4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-production-ready-machine-learning-models-adc68754bcf4&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fadc68754bcf4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-production-ready-machine-learning-models-adc68754bcf4&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://github.com/Ibotta/sk-dist#sk-dist-distributed-scikit-learn-meta-estimators-in-pyspark", "anchor_text": "skdist"}, {"url": "https://towardsdatascience.com/feature-factories-pt-2-an-introduction-to-mlflow-873be3c66b66", "anchor_text": "Splice Machine"}, {"url": "https://info.splicemachine.com/ml-manager-2-0-demo.html?utm_source=medium&utm_medium=post&utm_campaign=ml_manager", "anchor_text": "watch a demo video"}, {"url": "https://medium.com/tag/data-science?source=post_page-----adc68754bcf4---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----adc68754bcf4---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/software-engineering?source=post_page-----adc68754bcf4---------------software_engineering-----------------", "anchor_text": "Software Engineering"}, {"url": "https://medium.com/tag/python?source=post_page-----adc68754bcf4---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/spark?source=post_page-----adc68754bcf4---------------spark-----------------", "anchor_text": "Spark"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fadc68754bcf4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-production-ready-machine-learning-models-adc68754bcf4&user=Monte+Zweben&userId=5d691d0967c&source=-----adc68754bcf4---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fadc68754bcf4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-production-ready-machine-learning-models-adc68754bcf4&user=Monte+Zweben&userId=5d691d0967c&source=-----adc68754bcf4---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fadc68754bcf4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-production-ready-machine-learning-models-adc68754bcf4&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----adc68754bcf4--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fadc68754bcf4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-production-ready-machine-learning-models-adc68754bcf4&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----adc68754bcf4---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----adc68754bcf4--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----adc68754bcf4--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----adc68754bcf4--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----adc68754bcf4--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----adc68754bcf4--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----adc68754bcf4--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----adc68754bcf4--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----adc68754bcf4--------------------------------", "anchor_text": ""}, {"url": "https://mzweben.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://mzweben.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Monte Zweben"}, {"url": "https://mzweben.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "377 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F5d691d0967c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-production-ready-machine-learning-models-adc68754bcf4&user=Monte+Zweben&userId=5d691d0967c&source=post_page-5d691d0967c--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F6891b097b0ba&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-production-ready-machine-learning-models-adc68754bcf4&newsletterV3=5d691d0967c&newsletterV3Id=6891b097b0ba&user=Monte+Zweben&userId=5d691d0967c&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}