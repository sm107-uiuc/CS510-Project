{"url": "https://towardsdatascience.com/explicit-auc-maximization-70beef6db14e", "time": 1683001321.833232, "path": "towardsdatascience.com/explicit-auc-maximization-70beef6db14e/", "webpage": {"metadata": {"title": "Explicit AUC maximization. How to explicitly optimize for maximum\u2026 | by Michael Larionov, PhD | Towards Data Science", "h1": "Explicit AUC maximization", "description": "The fact that the results are evaluated based on AUC makes sense for fraud detection tasks for several reasons: Usually, AUC is optimized only during hyperparameters tuning, whereas during training\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.kaggle.com/c/ieee-fraud-detection/overview/evaluation", "anchor_text": "\u201cIEEE-CIS Fraud Detection\u201d Kaggle competition", "paragraph_index": 0}, {"url": "http://web4.cs.ucl.ac.uk/staff/D.Barber/pmwiki/pmwiki.php?n=Brml.HomePage", "anchor_text": "this book", "paragraph_index": 10}, {"url": "https://github.com/mlarionov/machine_learning_POC/blob/master/auc/pairwise.ipynb", "anchor_text": "my github repository", "paragraph_index": 18}], "all_paragraphs": ["I was getting started on \u201cIEEE-CIS Fraud Detection\u201d Kaggle competition, and something caught my eye:", "The fact that the results are evaluated based on AUC makes sense for fraud detection tasks for several reasons:", "Usually, AUC is optimized only during hyperparameters tuning, whereas during training they use cross-entropy loss. Why not optimize AUC in the first place instead of cross-entropy?", "The same question was raised in this paper:", "The problem is summarized well in the paper\u2019s intro:", "What if we did use the AUC as the optimization function instead of cross-entropy? The AUC curve can be computed using Wilcoxon-Mann-Whitney statistic:", "If x and y are probabilities, the metric penalizes any occurrence where the probability of the actual positive case is less than the probability of the negative case. This is not a conventional optimization function, because it lacks additive property of MSE or cross-entropy cost functions. As it was noted in the paper,", "The AUC in the equation above is not a smooth function of probabilities, because it is constructed using step functions. We can try to smooth it out, to make sure the function is always differentiable, so that we can use the conventional optimization algorithms. One of the ways to get around of this, as demonstrated in the paper, is the RankBoost loss function:", "Here x and y are probabilities for the positive and negative class respectively. For example, in the logistic regression model both x and y can be expressed as sigmoid functions:", "Here \u03be is a predictor variable(s).", "I have to admit that these models are nothing new. They are called pairwise comparison models and pioneered by Thurstone in the 1920s. For more information see this book. The foundation of this analysis is Bradley-Terry-Luce model, but the most well-known variation is Elo algorithm. The model itself is very simple and is derived by maximizing the likelihood function:", "In our context, M_ij is 1 if i is from the positive class and j is from the negative class. In all other cases, it is 0. The ability values \u03b1 here are logits, not the probabilities. This makes the model simpler than RankBoost, and also allows us to use it as the final layer of a neural network (in which case the values \u03b1 will be just the activations of the previous layer). The loss function is:", "Where i and j are positive and negative examples respectively.", "We will demonstrate this approach using a simple classification problem. We will use TensorFlow to take advantage of automatic differentiation.", "As you see, this is a binary classification problem using synthetic data. Instead of trying to correctly classify the results, we will try to maximize AUC.", "The plot below is based on the threshold 0.945. If I were to choose the conventional threshold 0.5 we would get all observations in one class. Why is that? The reason is that AUC is not sensitive to the bias value. Indeed, since in this model we subtracting pairwise activations, the bias value cancels out. We can add additional term to the cost function to bring the bias closer to 0.5. Or choose to do what we have done above, by hand-picking the threshold that works for us. I want to remind you, that we are optimizing for AUC, so if all observations are predicted to fall into a single class, it is cool with us as long as the AUC has the optimal value.", "One can wonder if there is any usefulness in this approach for any real machine learning projects, other than data science competitions that use AUC as the evaluation criterion. But I would argue that it can be useful in case of unbalanced data set as the first step in machine learning. The second step would be to learn the bias parameter and generally fine-tuning the model by using a business-based optimization metric.", "One disadvantage of the AUC cost function is that it is using pairwise comparison between observation, so the complexity of the function grows as a square of the number of observations, which could become a performance bottleneck as the number of observations grows. Also one has to come up with a good batching strategy that correctly estimates AUC based on a number of smaller samples (batches).", "All code is available in my github repository. Also find more information about RankBoost below.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F70beef6db14e&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fexplicit-auc-maximization-70beef6db14e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fexplicit-auc-maximization-70beef6db14e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fexplicit-auc-maximization-70beef6db14e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fexplicit-auc-maximization-70beef6db14e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://me.dm/@michaellarionov", "anchor_text": "Mastodon"}, {"url": "https://towardsdatascience.com/?source=post_page-----70beef6db14e--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----70beef6db14e--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://michaellarionov.medium.com/?source=post_page-----70beef6db14e--------------------------------", "anchor_text": ""}, {"url": "https://michaellarionov.medium.com/?source=post_page-----70beef6db14e--------------------------------", "anchor_text": "Michael Larionov, PhD"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Ff9158ca11a43&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fexplicit-auc-maximization-70beef6db14e&user=Michael+Larionov%2C+PhD&userId=f9158ca11a43&source=post_page-f9158ca11a43----70beef6db14e---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F70beef6db14e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fexplicit-auc-maximization-70beef6db14e&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F70beef6db14e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fexplicit-auc-maximization-70beef6db14e&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@andresanano?utm_source=medium&utm_medium=referral", "anchor_text": "Andr\u00e9 Sanano"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://www.kaggle.com/c/ieee-fraud-detection/overview/evaluation", "anchor_text": "\u201cIEEE-CIS Fraud Detection\u201d Kaggle competition"}, {"url": "http://web4.cs.ucl.ac.uk/staff/D.Barber/pmwiki/pmwiki.php?n=Brml.HomePage", "anchor_text": "this book"}, {"url": "https://github.com/mlarionov/machine_learning_POC/blob/master/auc/pairwise.ipynb", "anchor_text": "my github repository"}, {"url": "https://mitpress.mit.edu/sites/default/files/titles/content/boosting_foundations_algorithms/chapter011.html", "anchor_text": "BoostingWe consider next how to learn to rank a set of objects, a problem that arises naturally in a variety of domains. For\u2026mitpress.mit.edu"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----70beef6db14e---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----70beef6db14e---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/optimization?source=post_page-----70beef6db14e---------------optimization-----------------", "anchor_text": "Optimization"}, {"url": "https://medium.com/tag/tensorflow?source=post_page-----70beef6db14e---------------tensorflow-----------------", "anchor_text": "TensorFlow"}, {"url": "https://medium.com/tag/kaggle?source=post_page-----70beef6db14e---------------kaggle-----------------", "anchor_text": "Kaggle"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F70beef6db14e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fexplicit-auc-maximization-70beef6db14e&user=Michael+Larionov%2C+PhD&userId=f9158ca11a43&source=-----70beef6db14e---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F70beef6db14e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fexplicit-auc-maximization-70beef6db14e&user=Michael+Larionov%2C+PhD&userId=f9158ca11a43&source=-----70beef6db14e---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F70beef6db14e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fexplicit-auc-maximization-70beef6db14e&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----70beef6db14e--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F70beef6db14e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fexplicit-auc-maximization-70beef6db14e&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----70beef6db14e---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----70beef6db14e--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----70beef6db14e--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----70beef6db14e--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----70beef6db14e--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----70beef6db14e--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----70beef6db14e--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----70beef6db14e--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----70beef6db14e--------------------------------", "anchor_text": ""}, {"url": "https://michaellarionov.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://michaellarionov.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Michael Larionov, PhD"}, {"url": "https://michaellarionov.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "611 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Ff9158ca11a43&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fexplicit-auc-maximization-70beef6db14e&user=Michael+Larionov%2C+PhD&userId=f9158ca11a43&source=post_page-f9158ca11a43--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fcf000f0c5fdd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fexplicit-auc-maximization-70beef6db14e&newsletterV3=f9158ca11a43&newsletterV3Id=cf000f0c5fdd&user=Michael+Larionov%2C+PhD&userId=f9158ca11a43&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}