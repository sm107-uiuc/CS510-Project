{"url": "https://towardsdatascience.com/building-a-recommendation-system-for-anime-566f864acea8", "time": 1683008244.345591, "path": "towardsdatascience.com/building-a-recommendation-system-for-anime-566f864acea8/", "webpage": {"metadata": {"title": "Building A Recommendation System for Anime | by Anila Qureshi | Towards Data Science", "h1": "Building A Recommendation System for Anime", "description": "Anime is a hand-drawn computer animation originating from Japan which has drawn a cult following around the world. The animation industry consists of more than 430 companies. Pokemon and Yugi-Oh are\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.kaggle.com/CooperUnion/anime-recommendations-database", "anchor_text": "https://www.kaggle.com/CooperUnion/anime-recommendations-database", "paragraph_index": 2}, {"url": "https://github.com/anilaq/capstone/blob/master/latest.ipynb", "anchor_text": "Github repo", "paragraph_index": 40}, {"url": "https://towardsdatascience.com/building-and-testing-recommender-systems-with-surprise-step-by-step-d4ba702ef80b", "anchor_text": "Building and Testing Recommender Systems With Surprise, Step-By-Step", "paragraph_index": 58}, {"url": "https://towardsdatascience.com/how-to-build-a-simple-recommender-system-in-python-375093c3fb7d", "anchor_text": "How to build a Simple Recommender System in Python", "paragraph_index": 59}, {"url": "https://sifted.eu/articles/streaming-startups-coronavirus/", "anchor_text": "Coronavirus: European Streaming Services are Booming Too", "paragraph_index": 60}], "all_paragraphs": ["Anime is a hand-drawn computer animation originating from Japan which has drawn a cult following around the world. The animation industry consists of more than 430 companies. Pokemon and Yugi-Oh are some of the most popular anime shows that have come to Western television. Spirited Away, a film created by Hayao Miyazaki and animated by Studio Ghibli, is the highest-grossing film within the anime genre. The reason it became so popular in the west is that a good friend of Miyazaki\u2019s convinced him to sell distribution rights to Walt Disney. Like Spirited Away, there are thousands of really good anime films and shows produced by the same animation house. Many others can take this example and use it as a way to bring such works of art into Disney+ or any streaming site in the West. This brings me to what I\u2019ve been working on recently: a recommendation system that can help anyone or any company to view/add the highest-rated anime. The Japan External Trade Organization has valued the industry\u2019s overseas sales to 18 \ud835\udc4f\ud835\udc56\ud835\udc59\ud835\udc59\ud835\udc56\ud835\udc5c\ud835\udc5b ( 5.2 billion for the US alone) in 2004. This has definitely grown and has the potential to grow even further, especially during this time in the world. Like some countries, Japan is facing one of the first long term recessions.", "Below, you can see my step-by-step guide to a recommendation system for anime. This will help with the problem above and can create more in demand anime. It can also help anyone who is not familiar with the niche genre to quickly find top-rated items. (Helping to grow the market).", "I have downloaded anime and user ratings from https://www.kaggle.com/CooperUnion/anime-recommendations-database . I will conduct exploratory data analysis to familiarise the reader and myself with the data presented. From there I have created a baseline model using Singular Value Decomposition(SVD). I will then do memory-based models that will look at user-based v item based. I will use KNNBase, KNNBaseline, and KNNWithMeans. Then I will take the top-performing model and evaluate its root mean squared error (rmse) and its mean absolute error (mae).", "For most of this project, I decided to stick with the above and it\u2019s worked nicely. I have tried additional models below in google colab, I will add the necessary code for the import library there.", "What does the shape look like? This is important because it helps with seeing any null values", "Again we\u2019ll check shape after the above command", "This has, in fact, reduced our anime data frame!", "It\u2019s important to show what each column represents when cleaning so that we have an idea of what can be scrubbed, transformed, or if we need to conduct some feature engineering.", "anime_id: id number for each anime titlename: title of the motion picturegenre: categorytype: describes the anime into tv, movies, OVA, and 3 other categoriesepisodes: total number of episodes rating: -1\u201310, lowest to highestmembers: number of community members that are in this anime group", "Next, do they match with the above?", "Let\u2019s look at the second csv file that was included on kaggle for this recommendation project.", "user_id: non-identifiable randomly generated user-idanime_id: the anime that the user has rated rating: rating out of 10 this user has assigned (-1 if the user watched it but didn\u2019t assign a rating)", "They both have anime_id. Let\u2019s join the two to make things a lot easier.", "I learned the hard way that Singular Value Decomposition (SVD) is more sensitive to datasets this large. I am going to look at the minimum rating.", "I have decided to take out the columns with no ratings, that are represented as -1. When doing recommendation systems, it can depend on the person, assignment, and company to keep this in. I will likely go back in my spare time and add this back in and see about unfinished ratings and the effect on it has on recommendations. (It does play a huge role). I decided to take it out for pure amusement.", "Now I go in to check the shape again to see how much this has reduced my data for SVD.", "This still isn\u2019t small enough to work efficiently for free google colab.", "I have run a lot of tests on my SVD (this took a day and a half and I have finally had to settle for the sample size below).", "Can check dtypes here. From the beginning, I have always found that checking up on my code is extremely important. It helps a lot with eliminating problems when there are debugging issues.", "It seems that the rating dataframe is based on each user and their individual rating for each anime id, whereas the anime dataframe is an average overall rating from all of its viewers.", "Another thing that is super important for SVD is to make your variables discreet, otherwise, it\u2019ll take up more of your time.", "Great, I think I\u2019m done with scrubbing for now. Let\u2019s move on to the fun part!", "I haven\u2019t added the output to the cleaning, visuals are super important so I\u2019ll add them in.", "Average Number of Reviews per User: 88.69", "The sample size of 5000, gives us a total of 3,381 users who have done reviews. The above is on the entire set.", "It seems that from our sample set, a lot of the scores given are 1s\u2019 and 2\u20134s\u2019.", "From this, we can see there are 6 types. What are they?", "OVA stands for original video animation", "ONA stands for original net animation", "Music is themed around anime, and usually has an animation to go with it, but its typically a very short video.", "First thing\u2019s first! Do a base model. I started with transforming my data.", "Make sure your data is in the right format", "Now to look at predictions and accuracy. This is important for comparing your learner models.", "Well, it\u2019s definitely not between 0 and 1. These scores really depend on the domain. It\u2019s definitely not perfect. My initial reaction was to freak out, but it turns out an RMSE over 1 is okay.", "I would ideally like to see if I can reduce this.", "It\u2019s increased. I will now try other models particularly memory-based models followed by a content-based model.", "Will save you from the rest, here\u2019s a short clip of the output", "You can do the same for the mean squared distance(msd).", "Again it\u2019s increasing when we want it to decrease.", "The SVD Baseline seems to have had the lowest RMSE. I will put this into a grid search again", "I have done some collaborative models which are listed on my Github repo. My collaborative models take in cosine similarity and user-based v item based.", "Next let\u2019s extract the required fields.", "Let\u2019s see what it looks like", "The goal is to separate the words for each line.", "Make sure to specify that the stopwords are in English", "The aim is to reduce the amount of noise that takes place.", "Let\u2019s process the article. This will split the test into a list of strings that are separated based on spaces or apostrophes", "Now let\u2019s obtain the total vocabulary from genre.", "How many times does each word occur?", "Let\u2019s obtain the top 20 words, this will give a look into the most viewed genres", "Our recommendation system will likely recommend the comedy, action, romance, etc.", "Now, convert it to a vectorizer", "Next, let\u2019s see how it measures up. Because NLTK is a completely different library, its best to look at its explained variance ratio.", "Here we get the final result by:", "After trying a bunch of models, I feel that a content-based model is best.", "In my notebook, I also look at calculating the similarities between anime with TF-IDF.", "Based on the modeling done, it would be best to conduct more statistical analysis on top rated and viewed anime that comes from the same animation studios, writers, directors, and media houses. From here we can tweak the recommendation system to include their newest releases.", "Another suggestion is to look at a time component analysis. TV shows are the most viewed type of anime, but during which time of the year? From here the recommendation system can help to fill in the gaps within the fiscal year for anime studios. They can either spread out the dates or work on a new pipeline for creating more specials.", "[2] Susan Li, Building and Testing Recommender Systems With Surprise, Step-By-Step (2018)", "[3] Derrick Mwiti, How to build a Simple Recommender System in Python (2018)", "[8] Marie Mawad, Coronavirus: European Streaming Services are Booming Too (2020)", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F566f864acea8&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-a-recommendation-system-for-anime-566f864acea8&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-a-recommendation-system-for-anime-566f864acea8&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-a-recommendation-system-for-anime-566f864acea8&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-a-recommendation-system-for-anime-566f864acea8&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----566f864acea8--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----566f864acea8--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://anila-m-qureshi.medium.com/?source=post_page-----566f864acea8--------------------------------", "anchor_text": ""}, {"url": "https://anila-m-qureshi.medium.com/?source=post_page-----566f864acea8--------------------------------", "anchor_text": "Anila Qureshi"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F3f89a169370f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-a-recommendation-system-for-anime-566f864acea8&user=Anila+Qureshi&userId=3f89a169370f&source=post_page-3f89a169370f----566f864acea8---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F566f864acea8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-a-recommendation-system-for-anime-566f864acea8&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F566f864acea8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-a-recommendation-system-for-anime-566f864acea8&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://www.kaggle.com/CooperUnion/anime-recommendations-database", "anchor_text": "https://www.kaggle.com/CooperUnion/anime-recommendations-database"}, {"url": "https://github.com/anilaq/capstone/blob/master/latest.ipynb", "anchor_text": "Github repo"}, {"url": "https://github.com/anilaq/capstone", "anchor_text": "Capston"}, {"url": "https://towardsdatascience.com/building-and-testing-recommender-systems-with-surprise-step-by-step-d4ba702ef80b", "anchor_text": "Building and Testing Recommender Systems With Surprise, Step-By-Step"}, {"url": "https://towardsdatascience.com/how-to-build-a-simple-recommender-system-in-python-375093c3fb7d", "anchor_text": "How to build a Simple Recommender System in Python"}, {"url": "https://github.com/robi56/Deep-Learning-for-Recommendation-Systems", "anchor_text": "Deep-Learning-For-Recommendation-Systems"}, {"url": "https://medium.com/human-in-a-machine-world/mae-and-rmse-which-metric-is-better-e60ac3bde13d", "anchor_text": "Which Metric is Better?"}, {"url": "https://en.wikipedia.org/w/index.php?title=Anime&action=history", "anchor_text": "Anime"}, {"url": "https://en.wikipedia.org/wiki/Spirited_Away", "anchor_text": "Spirited Away"}, {"url": "https://sifted.eu/articles/streaming-startups-coronavirus/", "anchor_text": "Coronavirus: European Streaming Services are Booming Too"}, {"url": "https://medium.com/tag/recommendation-system?source=post_page-----566f864acea8---------------recommendation_system-----------------", "anchor_text": "Recommendation System"}, {"url": "https://medium.com/tag/content-based?source=post_page-----566f864acea8---------------content_based-----------------", "anchor_text": "Content Based"}, {"url": "https://medium.com/tag/surprise?source=post_page-----566f864acea8---------------surprise-----------------", "anchor_text": "Surprise"}, {"url": "https://medium.com/tag/nltk?source=post_page-----566f864acea8---------------nltk-----------------", "anchor_text": "Nltk"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F566f864acea8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-a-recommendation-system-for-anime-566f864acea8&user=Anila+Qureshi&userId=3f89a169370f&source=-----566f864acea8---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F566f864acea8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-a-recommendation-system-for-anime-566f864acea8&user=Anila+Qureshi&userId=3f89a169370f&source=-----566f864acea8---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F566f864acea8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-a-recommendation-system-for-anime-566f864acea8&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----566f864acea8--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F566f864acea8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-a-recommendation-system-for-anime-566f864acea8&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----566f864acea8---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----566f864acea8--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----566f864acea8--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----566f864acea8--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----566f864acea8--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----566f864acea8--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----566f864acea8--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----566f864acea8--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----566f864acea8--------------------------------", "anchor_text": ""}, {"url": "https://anila-m-qureshi.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://anila-m-qureshi.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Anila Qureshi"}, {"url": "https://anila-m-qureshi.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "28 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F3f89a169370f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-a-recommendation-system-for-anime-566f864acea8&user=Anila+Qureshi&userId=3f89a169370f&source=post_page-3f89a169370f--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fe0c494db90fc&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-a-recommendation-system-for-anime-566f864acea8&newsletterV3=3f89a169370f&newsletterV3Id=e0c494db90fc&user=Anila+Qureshi&userId=3f89a169370f&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}