{"url": "https://towardsdatascience.com/machine-learning-in-bioinformatics-genome-geography-d1b1dbbfb4c2", "time": 1683016613.364546, "path": "towardsdatascience.com/machine-learning-in-bioinformatics-genome-geography-d1b1dbbfb4c2/", "webpage": {"metadata": {"title": "Machine Learning in Bioinformatics: Genome Geography | by Nico Alavi | Towards Data Science", "h1": "Machine Learning in Bioinformatics: Genome Geography", "description": "In recent years companies like 23andme have gained traction by feeding our desire to understand the roots of our ancestry. They promise to give insights into the geographical origins of our genetic\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.23andme.com/en-int/", "anchor_text": "23andme", "paragraph_index": 0}, {"url": "https://docs.conda.io/en/latest/miniconda.html", "anchor_text": "miniconda3", "paragraph_index": 7}, {"url": "https://www.internationalgenome.org/", "anchor_text": "1000 Genomes Project", "paragraph_index": 8}, {"url": "https://www.bioinformatics.babraham.ac.uk/projects/fastqc/", "anchor_text": "FastQC", "paragraph_index": 12}, {"url": "http://bio-bwa.sourceforge.net/bwa.shtml", "anchor_text": "Burrows-Wheeler-Aligner", "paragraph_index": 13}, {"url": "http://www.htslib.org/doc/1.2/samtools.html", "anchor_text": "samtools", "paragraph_index": 15}, {"url": "https://github.com/ekg/freebayes", "anchor_text": "freebayes", "paragraph_index": 16}, {"url": "https://github.com/burgshrimps/geogenome", "anchor_text": "https://github.com/burgshrimps/geogenome", "paragraph_index": 34}], "all_paragraphs": ["In recent years companies like 23andme have gained traction by feeding our desire to understand the roots of our ancestry. They promise to give insights into the geographical origins of our genetic makeup \u2014 using just a droplet of saliva.", "In this article, we are going to have a (rather simplistic) look at the bioinformatics aspect of such an analysis. We will walk through all the necessary preprocessing steps to get from raw sequencing reads to a machine learning model which aims to cluster human samples according to their geographical origin.", "But before we get to the coding, let\u2019s quickly clarify why this works.", "Our genomes have a lot to say about who we are. They tell us what colour our eyes are, give information about our sex, how susceptible we are to certain diseases but they also have something to say about where we have been born.", "That makes it even more surprising that all human beings are 99.9% identical in their DNA sequence. This 0.1% is what we call human genomic variation. Genomic variation can come in many different flavours depending on the size and type of variation. For the sake of simplicity, we are only going to consider one type of variation, Single Nucleotide Polymorphisms (SNPs). SNPs are substitutions of single bases, e.g. changing an Adenine to a Cytosine.", "Essentially, the reason why geographical clustering based on genomic variation works boils down to two basic principles. First, SNPs which occur in the germline of an individual have the chance of being passed down to their offspring. And second, the genome of the offspring is usually a combination of their parent\u2019s genomes. Under the assumption that individuals with a smaller geographical distance between them have a higher chance of producing offspring, emerging clusters of similar genetic variation should show some resemblance of a geographical map.", "In 2008 Novembre et al. demonstrated the feasibility of inferring an individuals country of birth from their genomic sequence [1]. The group genotyped over 3,000 European individuals at half a million genomic loci. The resulting plot of the first two principal components has an astonishing resemblance with a geographical map of Europe.", "For the subsequent analysis, we are going to need a number of command-line tools and Python packages. I recommend installing miniconda3 and setting up a separate environment using the env.yml file in the Github repository linked at the end of this article.", "The 1000 Genomes Project is an incredible resource for publicly available next-generation-sequencing (NGS) data. We are going to use their phase 3 variant call set, incorporating SNPs of around 2500 human samples. In order to reduce the computational cost of our analysis, we are only going to consider SNPs on chromosome 1. The corresponding VCF file can be downloaded with:", "At this point, I should mention that with this data alone we are able to build our model. So if you\u2019re solely interested in that you can jump straight to step (VI). However, for the sake of a more comprehensive picture we are going to go through the basic preprocessing steps of NGS data for one sample, namely HG01571. The corresponding paired-end FASTQ files can be obtained with:", "The last puzzle piece we need is a reference genome to which we can map our reads. Let\u2019s go for GRChg38:", "A crucial step in every NGS-preprocessing pipeline is making sure that your reads have good quality. This includes, among other things, checking per base sequence quality, adapter content and the length distribution of your reads.", "After investigating the quality report generated by the tool FastQC we can start to map our reads to the reference genome.", "The Burrows-Wheeler-Aligner (bwa) works on specific data structures, namely the Burrows-Wheeler transform and the suffix array to efficiently map reads to a reference. So we first need to create those data structures for our reference FASTA file.", "Mapping can be quite computationally expensive which is why I recommend allowing bwa to use multiple threads.", "Subsequently, we are using samtools to convert our SAM file to BAM format, filter out alignments with mapping quality below 20 as well as sort and index the BAM file.", "Now that our reads are mapped to the reference we can identify SNPs in our sample. We are using the variant caller freebayes which uses Bayesian inference to identify possible small genomic variants.", "To filter possible false-positive variant calls, we are only keeping variants which are covered by at least 10 reads and have a quality score of at least 20.", "Technically, we could now integrate the variant calls for HG01571 into our 1000 Genomes Variant Call Format (VCF) file but since our sample was already part of the cohort we are just going to use the already existing variant calls.", "Before building our machine learning model let\u2019s have a look at how our data looks like. A VCF file can be simplified into the following columns: chromosome, position, reference allele and alternative allele followed by genotype information for all samples.", "The reference allele describes the most common nucleotide in the population at a specific genomic position and as the name suggests the alternative allele represents a variation in regards to the reference. The information about which variants occur in a specific sample is encoded in the genotype. Here, a 0 stands for the reference allele and a 1 for the alternative. Humans are diploid organisms, meaning we have two copies of each non-sex chromosome. This is why for every position in the genome each sample carries the information about both homologous chromosomes. If we have a look at the example shown above we can see that at position chr1:10456 the first sample carries the alternative allele, T, on both copies of chromosome 1.", "Currently, our dataset consists of roughly 6 million variants and 2,500 samples. We could train a model with the whole dataset but in an effort to keep computational costs low we are only going to work on a subset of 100 samples.", "With that many features, our model is prone to overfitting. So additionally, we are going to further reduce the complexity of our model through some feature engineering. If we look back on our initial hypothesis that samples with similar ethnicities should cluster together, then what comes to mind is defining the genomic similarity between two individuals using some kind of distance metric. Here, we are using the normalized Hamming Distance which is defined as", ", where a mismatch is defined as two genotypes not being the same. It should be noted that in our context we don\u2019t care on which copy of chromosome 1 a variant is located such that the genotypes 0|1 and 1|0 are considered a match. Going back to our example, the Hamming distance between the first two samples is equal to 2/4 = 0.5.", "After calculating the Hamming distance between all possible sample pairs, each individual can be described through their genomic similarity to all other samples.", "According to our initial hypothesis, individuals with a similar ethnical background should present a similar SNP profile. Thus, between these samples smaller Hamming distances should be observed compared to the rest of the cohort. A heatmap of the Hamming distances between all samples hints towards some underlying structure in the data. However, just by looking at the raw distances, it is quite hard to pinpoint exact clusters.", "In order to make possible clusters more visible, we are applying a dimensionality reduction algorithm. Unlike the authors of the paper, mentioned at the beginning [1], who performed a Principal Component Analysis (PCA) we are using t-distributed stochastic neighbour embedding (t-SNE). I will not go into too much detail here but the key idea of t-SNE is to try to preserve any kind of clustering which existed in high dimensional space. This is achieved by projecting points from a high dimensional space to a lower-dimensional space in a way such that those points which were in close proximity in the high dimensional space are also in close proximity in low dimensional space.", "The resulting scatterplot of the first two components shows distinct clustering of samples by their ancestry. Each colour represents a so-called superpopulation.", "What I found particularly interesting is the close proximity of the European cluster to the American one. A reason for the mixture between these two gene pools might be the European colonization of the American continent starting in the late 1400s.", "The only thing that\u2019s left to do now is deciding what kind of model we want to train. Since there exist 5 superpopulations in our dataset the model needs to be able to perform a multinomial classification. I decided to evaluate the performance of a Random Forest (RF) model, a multinomial Naives Bayes (NB) model, a K-Nearest-Neighbours (KNN) model as well as a multinomial Logistic Regression (LGR) model.", "In general, when evaluating a machine learning model one needs to find the right balance between having a large training set and maintaining an appropriately sized test set to test against overfitting. With just 100 samples our dataset is fairly small which makes the problem even harder. Therefore we are applying a method called cross-validation. The idea here is, to divide your data into k equal parts. Subsequently, you train a model using k-1 parts and test it using the remaining one. In that fashion, you iterate over all k parts such that every part acted as test set once.", "For example here, we used k=5, so for each classifier, we trained 5 models and obtained 5 accuracy measurements. The resulting performances of all four classifiers can be seen in the figure below. All four classifiers perform reasonably well with Random Forest being the highest and the Logistic Regression model being the lowest-performing one.", "Even though we used rather basic methods we were able to accurately predict an individuals superpopulation based on their SNP profile. However, a number of limitations prevent this analysis from being used in a professional setting.", "First, it is quite costly to add new samples to an existing database since every time we add a sample we need to compute the normalized Hamming distance to all other samples. Furthermore, this pipeline does not take individual haplotypes into account but rather the mere genotype at a certain site. A recent paper by Freyman et al. demonstrates an efficient and haplotype-aware method for identity-by-descent inference using the Burrows-Wheeler transform [2]. The four simple multinomial classifiers used in this analysis are only capable of assigning one superpopulation to each sample. A more sophisticated method would be able to assign certain proportions of a genome to a population. In that way, the information about heterogeneous ethnicity backgrounds, which exist in most humans, would not be lost.", "All scripts, as well as supplementary data, are available at https://github.com/burgshrimps/geogenome.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Bioinformatics Master's Student at FU Berlin"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fd1b1dbbfb4c2&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-in-bioinformatics-genome-geography-d1b1dbbfb4c2&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-in-bioinformatics-genome-geography-d1b1dbbfb4c2&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-in-bioinformatics-genome-geography-d1b1dbbfb4c2&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-in-bioinformatics-genome-geography-d1b1dbbfb4c2&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----d1b1dbbfb4c2--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----d1b1dbbfb4c2--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://burgshrimps.medium.com/?source=post_page-----d1b1dbbfb4c2--------------------------------", "anchor_text": ""}, {"url": "https://burgshrimps.medium.com/?source=post_page-----d1b1dbbfb4c2--------------------------------", "anchor_text": "Nico Alavi"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F3521a471e1c2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-in-bioinformatics-genome-geography-d1b1dbbfb4c2&user=Nico+Alavi&userId=3521a471e1c2&source=post_page-3521a471e1c2----d1b1dbbfb4c2---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fd1b1dbbfb4c2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-in-bioinformatics-genome-geography-d1b1dbbfb4c2&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fd1b1dbbfb4c2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-in-bioinformatics-genome-geography-d1b1dbbfb4c2&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@claybanks", "anchor_text": "Clay Banks"}, {"url": "https://www.23andme.com/en-int/", "anchor_text": "23andme"}, {"url": "https://docs.conda.io/en/latest/miniconda.html", "anchor_text": "miniconda3"}, {"url": "https://www.internationalgenome.org/", "anchor_text": "1000 Genomes Project"}, {"url": "https://www.bioinformatics.babraham.ac.uk/projects/fastqc/", "anchor_text": "FastQC"}, {"url": "http://bio-bwa.sourceforge.net/bwa.shtml", "anchor_text": "Burrows-Wheeler-Aligner"}, {"url": "http://www.htslib.org/doc/1.2/samtools.html", "anchor_text": "samtools"}, {"url": "https://github.com/ekg/freebayes", "anchor_text": "freebayes"}, {"url": "https://github.com/burgshrimps/geogenome", "anchor_text": "https://github.com/burgshrimps/geogenome"}, {"url": "https://doi.org/10.1038/nature07331", "anchor_text": "https://doi.org/10.1038/nature07331"}, {"url": "https://doi.org/10.1101/2020.09.14.296939", "anchor_text": "https://doi.org/10.1101/2020.09.14.296939"}, {"url": "https://medium.com/tag/bioinformatics?source=post_page-----d1b1dbbfb4c2---------------bioinformatics-----------------", "anchor_text": "Bioinformatics"}, {"url": "https://medium.com/tag/genomics?source=post_page-----d1b1dbbfb4c2---------------genomics-----------------", "anchor_text": "Genomics"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----d1b1dbbfb4c2---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/python?source=post_page-----d1b1dbbfb4c2---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/population?source=post_page-----d1b1dbbfb4c2---------------population-----------------", "anchor_text": "Population"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fd1b1dbbfb4c2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-in-bioinformatics-genome-geography-d1b1dbbfb4c2&user=Nico+Alavi&userId=3521a471e1c2&source=-----d1b1dbbfb4c2---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fd1b1dbbfb4c2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-in-bioinformatics-genome-geography-d1b1dbbfb4c2&user=Nico+Alavi&userId=3521a471e1c2&source=-----d1b1dbbfb4c2---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fd1b1dbbfb4c2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-in-bioinformatics-genome-geography-d1b1dbbfb4c2&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----d1b1dbbfb4c2--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fd1b1dbbfb4c2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-in-bioinformatics-genome-geography-d1b1dbbfb4c2&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----d1b1dbbfb4c2---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----d1b1dbbfb4c2--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----d1b1dbbfb4c2--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----d1b1dbbfb4c2--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----d1b1dbbfb4c2--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----d1b1dbbfb4c2--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----d1b1dbbfb4c2--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----d1b1dbbfb4c2--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----d1b1dbbfb4c2--------------------------------", "anchor_text": ""}, {"url": "https://burgshrimps.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://burgshrimps.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Nico Alavi"}, {"url": "https://burgshrimps.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "17 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F3521a471e1c2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-in-bioinformatics-genome-geography-d1b1dbbfb4c2&user=Nico+Alavi&userId=3521a471e1c2&source=post_page-3521a471e1c2--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F84aa17397c2c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-in-bioinformatics-genome-geography-d1b1dbbfb4c2&newsletterV3=3521a471e1c2&newsletterV3Id=84aa17397c2c&user=Nico+Alavi&userId=3521a471e1c2&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}