{"url": "https://towardsdatascience.com/the-great-british-baking-show-random-forests-edition-406e8ed0ad7a", "time": 1683017131.6695838, "path": "towardsdatascience.com/the-great-british-baking-show-random-forests-edition-406e8ed0ad7a/", "webpage": {"metadata": {"title": "The Great British Baking Show: Random Forests Edition | by Pamela Wu | Towards Data Science", "h1": "The Great British Baking Show: Random Forests Edition", "description": "Introducing random forests using a step-by-step approach so you can see every ingredient as it's combined"}, "outgoing_paragraph_urls": [], "all_paragraphs": ["If only machine learning could be as delicious as it is oftentimes perplexing. While learning data science concepts, I\u2019ve found that it\u2019s a good idea to approach it the same way as learning baking: start simple, grab the basic ingredients, and combine them together yourself one by one until you get a feel for it. APIs are a wonderful resource, but if all you know how to do is use them, it\u2019s a bit like buying muffins and a can of frosting to make cupcakes and calling yourself a baker.", "You\u2019re probably thinking: I\u2019ve had cake before. I\u2019ve eaten loads of bread. I don\u2019t need some hoity-toity algorithm to tell me the difference.", "Banana bread. Babka. New England cornbread. Little brioches in cupcake wrappers with a light dusting of icing sugar and a chocolate straw. Daunted yet? You should be. The wide and diverse world of baking is the kind of stuff machine learning was made for.", "Let\u2019s start by gathering some training data. As with any good classifier, you need to make sure you have both samples that are obvious exemplars of their class and samples that are somewhat on the edge. I\u2019ve color-coded it so that yellow is bread and blue is cake.", "That\u2019s a quote from the ever-chill Selasi justifying his matte chocolate finish, but it applies so well to random forests as well. The power of a random forest comes from the fact that each tree is never allowed to be perfect \u2014 this is due to bagging (bootstrapping + aggregating), which means that both the samples and the features for each tree in the forest is only a subset of the full set of samples and features. In the case of samples, they\u2019re bootstrapped, which means the samples for each tree is drawn with replacement, so duplicate samples can be used for each trained tree.", "Since no single tree sees the whole set of samples or features, but the final answer is aggregated from the majority vote of all trees, random forests guards against overfitting while taking advantage of the \u201cwisdom of the crowd\u201d effect.", "We are going to show what happens during the training of one random forest, which will end up having just three trees made from four training samples and three features.", "For our first round of bagging, we bootstrap the samples. Note how one of the bread samples, corn bread, ended up getting duplicated because we chose 4 samples (the size N of the total sample set) randomly with replacement.", "We also select a proportion of the features, highlighted in purple.", "Now flour ratio and frosting have to compete to be the top node in the first tree by being the best separator of B and C. The values of the leftmost feature, flour ratio, spans from 0.24 to 0.4. We take the smallest value of it and first try a split at FR > 0.24.", "Amazingly, we get a pure split on our first try! FR > 0.24 for flour ratio perfectly separates breads from cakes, which makes for a Gini score of 0.0 at each split (see below for an explanation of what this is). Let\u2019s see what happens with the next split, FR > 0.38.", "This split generates impure splits because the top split has 2 B\u2019s and one C, even though the bottom split has just the one C. The top split would end up having a Gini score 0.444, which is very impure, indeed.", "If we look at the only available split for the next feature, F==N, you see that it\u2019s just as impure.", "Thus, we go back to our first lucky split, FR > 0.24, and make our first tree:", "Since it produces two pure nodes, we\u2019ve hit a stopping criteria. After all, if your node contains[\"C\", \"C\"], how do you split that any further? We ship the tree off to the forest and move on to the next one.", "A Gini score is not a classification score like precision or recall because it doesn\u2019t care if you got anything right or not, it only measures impurity, or how balanced a group of different classes are in a set. When classes in an array are pure, it doesn\u2019t matter which classes they are, it will give the same answer:", "However, when it gets to be impure:", "We won\u2019t go into it now, but the Gini score assumes class balance here, and to some extent, imbalance can be mitigated by using a weighted Gini score.", "The next tree begins the same way as the last: with bagging. If you look carefully, you\u2019ll see that the set of samples this round is slightly different because every round of bootstrapping is random. Instead of two corn bread samples, we have two devil\u2019s food samples.", "As with last time, we randomly select two features and have them compete for best splitting power of the bootstrapped samples.", "As with last time, let\u2019s try the first split of the leftmost feature, SR > 0.23.", "This is unfortunately also impure, with Gini scores of 0.5 and 0.0. You can see that this is also the case if you try to split by frosting.", "It seems that, despite being imperfect, SR > 0.23 wins by a narrow margin. However, it doesn\u2019t just stop there. We can use the splits of the first split to make more splits, creating the branching tree structures popularly associated with this algorithm.", "The top split didn\u2019t need more splits: it only had one sample. The second split could now be split by the other feature, frosting, by F==N. It turns out that when you do this kind of branching split, you now have pure splits at the leaf nodes. The resulting tree looks like this:", "We\u2019ve manually trained two trees together, but let\u2019s add in another tree for good measure and take a look at the forest we\u2019ve created.", "We want to use this forest to see what we want to predict for a sample that has no label on it yet. This sample is very closely based on one of our original samples:", "What does the classifier think, cake or bread?", "Let\u2019s take the first tree. It needs to look at whether FR > 0.24. At 0.61, it is quite a bit larger, so we classify it as cake, since the tree terminates there.", "The next tree (this is actually a tree trained off-camera) also just looks at one feature, frosting. Our sample has no frosting, so this tree says it\u2019s bread.", "Our last tree starts by looking at sugar ratio, and we can see that it falls to the left side of the split on the tree, since 0.26 > 0.23.", "That node is split by frosting, and F==N on the unlabeled sample makes it go to the left split, finally classifying this sample as bread.", "Huzzah! We have our answer. Since this sample was based off of brioche, it makes intuitive sense, despite the absolutely appalling number of samples and features. Also, as a special bonus, note that if you had one of those cupcake brioches with the frosting sugar, it would in fact have turned the predicted label over to cake ;)", "I hope this recipe for a random forest has inspired some of you to try it yourself at home. See you next time in the tent!", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data scientist at Enigma Technologies, Inc. Practitioner of statistics, software, games, baking, and absurdity."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F406e8ed0ad7a&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-great-british-baking-show-random-forests-edition-406e8ed0ad7a&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-great-british-baking-show-random-forests-edition-406e8ed0ad7a&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-great-british-baking-show-random-forests-edition-406e8ed0ad7a&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-great-british-baking-show-random-forests-edition-406e8ed0ad7a&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----406e8ed0ad7a--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----406e8ed0ad7a--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://protagonistwu.medium.com/?source=post_page-----406e8ed0ad7a--------------------------------", "anchor_text": ""}, {"url": "https://protagonistwu.medium.com/?source=post_page-----406e8ed0ad7a--------------------------------", "anchor_text": "Pamela Wu"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F2c52e2613ac7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-great-british-baking-show-random-forests-edition-406e8ed0ad7a&user=Pamela+Wu&userId=2c52e2613ac7&source=post_page-2c52e2613ac7----406e8ed0ad7a---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F406e8ed0ad7a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-great-british-baking-show-random-forests-edition-406e8ed0ad7a&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F406e8ed0ad7a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-great-british-baking-show-random-forests-edition-406e8ed0ad7a&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@rodlong?utm_source=medium&utm_medium=referral", "anchor_text": "Rod Long"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----406e8ed0ad7a---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/random-forest?source=post_page-----406e8ed0ad7a---------------random_forest-----------------", "anchor_text": "Random Forest"}, {"url": "https://medium.com/tag/decision-tree?source=post_page-----406e8ed0ad7a---------------decision_tree-----------------", "anchor_text": "Decision Tree"}, {"url": "https://medium.com/tag/baking?source=post_page-----406e8ed0ad7a---------------baking-----------------", "anchor_text": "Baking"}, {"url": "https://medium.com/tag/editors-pick?source=post_page-----406e8ed0ad7a---------------editors_pick-----------------", "anchor_text": "Editors Pick"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F406e8ed0ad7a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-great-british-baking-show-random-forests-edition-406e8ed0ad7a&user=Pamela+Wu&userId=2c52e2613ac7&source=-----406e8ed0ad7a---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F406e8ed0ad7a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-great-british-baking-show-random-forests-edition-406e8ed0ad7a&user=Pamela+Wu&userId=2c52e2613ac7&source=-----406e8ed0ad7a---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F406e8ed0ad7a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-great-british-baking-show-random-forests-edition-406e8ed0ad7a&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----406e8ed0ad7a--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F406e8ed0ad7a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-great-british-baking-show-random-forests-edition-406e8ed0ad7a&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----406e8ed0ad7a---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----406e8ed0ad7a--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----406e8ed0ad7a--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----406e8ed0ad7a--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----406e8ed0ad7a--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----406e8ed0ad7a--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----406e8ed0ad7a--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----406e8ed0ad7a--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----406e8ed0ad7a--------------------------------", "anchor_text": ""}, {"url": "https://protagonistwu.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://protagonistwu.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Pamela Wu"}, {"url": "https://protagonistwu.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "20 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F2c52e2613ac7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-great-british-baking-show-random-forests-edition-406e8ed0ad7a&user=Pamela+Wu&userId=2c52e2613ac7&source=post_page-2c52e2613ac7--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fusers%2F2c52e2613ac7%2Flazily-enable-writer-subscription&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-great-british-baking-show-random-forests-edition-406e8ed0ad7a&user=Pamela+Wu&userId=2c52e2613ac7&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}