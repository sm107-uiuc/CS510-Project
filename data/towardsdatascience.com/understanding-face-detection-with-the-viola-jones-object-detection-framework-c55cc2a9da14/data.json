{"url": "https://towardsdatascience.com/understanding-face-detection-with-the-viola-jones-object-detection-framework-c55cc2a9da14", "time": 1683007844.944, "path": "towardsdatascience.com/understanding-face-detection-with-the-viola-jones-object-detection-framework-c55cc2a9da14/", "webpage": {"metadata": {"title": "Understanding Face Detection with the Viola-Jones Object Detection Framework | by Socret Lee | Towards Data Science", "h1": "Understanding Face Detection with the Viola-Jones Object Detection Framework", "description": "From Instagram filters to self-driving cars, Computer Vision technologies are now deeply integrated into the lifestyle of many people. One important Computer Vision application is the ability to have\u2026"}, "outgoing_paragraph_urls": [{"url": "https://github.com/aparande/FaceDetection", "anchor_text": "Python implementation", "paragraph_index": 1}, {"url": "https://youtu.be/WfdYYNamHZ8", "anchor_text": "video", "paragraph_index": 1}, {"url": "https://en.wikipedia.org/wiki/Histogram_of_oriented_gradients", "anchor_text": "Histogram of Oriented Gradients", "paragraph_index": 4}, {"url": "https://en.wikipedia.org/wiki/Local_binary_patterns", "anchor_text": "Local Binary Patterns", "paragraph_index": 4}, {"url": "https://www.youtube.com/watch?v=LsK-xG1cLYA", "anchor_text": "video", "paragraph_index": 7}, {"url": "https://youtu.be/WfdYYNamHZ8", "anchor_text": "https://youtu.be/WfdYYNamHZ8", "paragraph_index": 20}], "all_paragraphs": ["From Instagram filters to self-driving cars, Computer Vision technologies are now deeply integrated into the lifestyle of many people. One important Computer Vision application is the ability to have a computer detects objects in images. Among those objects, the human face receives the most attention since it has many useful applications in security and entertainments. Hence, this article focuses on a popular face detection framework called the Viola-Jones Object Detection Framework.", "The aim here is to provide you with the understanding of the framework so that you can confidently use an open source implementation like the one provided by OpenCV. I want to help you understand what is going on under the hood and hopefully make you appreciate libraries like OpenCV more for handling all the complexities for you. If you want a \u201cfrom-scratch\u201d implementation, you can refer to this Python implementation by Anmol Parande. I also recommend you to check out this video by Ramsri on this topic.", "Developed by Paul Viola and Michael Jones back in 2001, the Viola-Jones Object Detection Framework can quickly and accurately detect objects in images and works particularly well with the human face (Viola & Jones, 2001). Despite its age, the framework is still a leading player in face detection along side many of its CNNs counter parts. The Viola-Jones Object Detection Framework combines the concepts of Haar-like Features, Integral Images, the AdaBoost Algorithm, and the Cascade Classifier to create a system for object detection that is fast and accurate. Thus to understand the framework, we first need to understand each of these concepts individually and then figure out how they connect together to form the framework.", "You can jump to section III if you already know about the concepts below and just want to know how these concepts work together.", "Often in Computer Vision, features are extracted from input images rather than using their intensities (RGB values, etc) directly. Haar-like features are one example. Other examples include Histogram of Oriented Gradients (HOG), Local Binary Patterns (LBP), etc. A Haar-like feature consists of dark regions and light regions. It produces a single value by taking the sum of the intensities of the light regions and subtract that by the sum of the intensities of dark regions. There are many different types of Haar-like features but the Viola-Jones Object Detection Framework only uses the ones in Figure 1. The different types of Haar-like features let us extract useful information from an image such as edges, straight lines, and diagonal lines that we can use to identify an object (i.e. the human face).", "An Integral Image is an intermediate representation of an image where the value for location (x, y) on the integral image equals the sum of the pixels above and to the left (inclusive) of the (x, y) location on the original image (Viola & Jones, 2001). This intermediate representation is essential because it allows for fast calculation of rectangular region. To illustrate, Figure 3 shows that the sum of the red region D can be calculated in constant time instead of having to loop through all the pixels in that region. Since the process of extracting Haar-like features involves calculating the sum of dark/light rectangular regions, the introduction of Integral Images greatly cuts down the time needed to complete this task.", "The AdaBoost (Adaptive Boosting) Algorithm is a machine learning algorithm for selecting the best subset of features among all available features. The output of the algorithm is a classifier (a.k.a Prediction Function, Hypothesis Function) called a \u201cStrong Classifier\u201d. A Strong Classifier is made up of a linear combinations of \u201cWeak Classifiers\u201d (best features). From a high level, in order to find these weak classifiers the algorithm runs for T iterations where T is the number of weak classifiers to find and it is set by you. In each iteration, the algorithm finds the error rate for all features and then choose the feature with the lowest error rate for that iteration.", "You can refer to this entertaining video by StatQuest to get a more detailed understanding of the AdaBoost Algorithm", "A Cascade Classifier is a multi-stage classifier that can perform detection quickly and accurately. Each stage consists of a strong classifier produced by the AdaBoost Algorithm. From one stage to another, the number of weak classifiers in a strong classifier increases. An input is evaluated on a sequential (stage by stage) basis. If a classifier for a specific stage outputs a negative result, the input is discarded immediately. In case the output is positive, the input is forwarded onto the next stage. According to Viola & Jones (2001), this multi-stage approach allows for the construction of simpler classifiers which can then be used to reject most negative (non face) input quickly while spending more time on positive (face) input.", "After learning about the major concepts used in the Viola-Jones Object Detection Framework, you are now ready to learn about how those concepts work together. The framework consists of two phases: Training and Testing/Application. Let\u2019s look at each of them one by one.", "The goal of this phase is to produce a Cascade Classifier for a face that is able to accurately classify a face and discard non-faces quickly. To achieve that, you must first prepare your training data and then construct a Cascade Classifier by using a modified AdaBoost Algorithm on that training data.", "Concepts: Integral Image + Haar-like Features", "Assuming that you already have a training set consisting of positive samples (faces) and negative samples (non-faces), the first step is to extract features from those sample images. Viola & Jones (2001) recommends the images to be 24 x 24. Since each type of Haar-like features can have different sizes and positions in a 24 x 24 window, over 160,000 Haar-like features can be extracted. Nonetheless, in this stage all 160,000+ Haar-like features need to be calculated. Fortunately, the introduction of Integral Images helps speed up this process. Figure 5 illustrates the entire process of data preparation.", "2. Constructing a Cascade Classifier with a modified AdaBoost Algorithm", "Concepts: the AdaBoost Algorithm + the Cascade Classifier.", "As you can imagine, using all 160,000+ features directly is computationally inefficient. Viola & Jones (2001) proposed two solutions that can solve this. First, reduce the number of features to only a handful of useful features with the AdaBoost algorithm. Second, split the remaining features into stages and evaluate each input in a stage by stage (cascading) fashion. Viola & Jones (2001) devised a modified version of the AdaBoost algorithm to be able to train a Cascade Classifier. Figure 6 shows a simplified version of the algorithm provided by Ramsri in his video (Ramsri, 2012).", "In their paper, Viola & Jones (2001) mentioned that their Cascade Classifier has 38 stages (38 strong classifiers) that are made up of over 6000 features.", "Imagine that we need to detect faces in the above image. Viola & Jones (2001) use a sliding window approach where window of various scales are slid across the entire image. The scale factor and the shifting step size are parameters for you to decide upon. So for the above image, there are m sub-windows to evaluate. For a sub-window i, the framework resize the image of that sub-window to a base size of 24 x 24 (to match training data), convert it into an integral image and feed it through a Cascade Classifier produced during the training phase. A face is detected if a sub-window passes through all the stages in the Cascade Classifier.", "To conclude, you have learnt about the Viola-Jones Object Detection Framework and its application for face detection. Many technologies today benefited from Paul Viola and Michael Jones\u2019s work. By understanding how the framework works, you can confidently implement your own version of their work or used an open source implementation like the one provided by OpenCV. I hope that my explanation moves you forward in that direction and compels you to create amazing technologies that uses this awesome framework.", "Liked the article and want to show your support? Follow me or buy me coffee", "Ramsri. (2012, September 16). Viola Jones face detection and tracking explained. Retrieved from https://youtu.be/WfdYYNamHZ8", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Just a guy learning and writing about what he has learnt"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fc55cc2a9da14&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-face-detection-with-the-viola-jones-object-detection-framework-c55cc2a9da14&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-face-detection-with-the-viola-jones-object-detection-framework-c55cc2a9da14&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-face-detection-with-the-viola-jones-object-detection-framework-c55cc2a9da14&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-face-detection-with-the-viola-jones-object-detection-framework-c55cc2a9da14&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----c55cc2a9da14--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----c55cc2a9da14--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@socret.lee?source=post_page-----c55cc2a9da14--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@socret.lee?source=post_page-----c55cc2a9da14--------------------------------", "anchor_text": "Socret Lee"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fcd91bc367150&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-face-detection-with-the-viola-jones-object-detection-framework-c55cc2a9da14&user=Socret+Lee&userId=cd91bc367150&source=post_page-cd91bc367150----c55cc2a9da14---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc55cc2a9da14&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-face-detection-with-the-viola-jones-object-detection-framework-c55cc2a9da14&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc55cc2a9da14&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-face-detection-with-the-viola-jones-object-detection-framework-c55cc2a9da14&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://github.com/aparande/FaceDetection", "anchor_text": "Python implementation"}, {"url": "https://youtu.be/WfdYYNamHZ8", "anchor_text": "video"}, {"url": "https://en.wikipedia.org/wiki/Histogram_of_oriented_gradients", "anchor_text": "Histogram of Oriented Gradients"}, {"url": "https://en.wikipedia.org/wiki/Local_binary_patterns", "anchor_text": "Local Binary Patterns"}, {"url": "https://www.youtube.com/watch?v=LsK-xG1cLYA", "anchor_text": "video"}, {"url": "http://buymeacoffee.com/socretlee", "anchor_text": ""}, {"url": "https://web.stanford.edu/class/cs231a/prev_projects_2016/cs231a_final_report.pdf", "anchor_text": "https://web.stanford.edu/class/cs231a/prev_projects_2016/cs231a_final_report.pdf"}, {"url": "https://pdfs.semanticscholar.org/40b1/0e330a5511a6a45f42c8b86da222504c717f.pdf", "anchor_text": "https://pdfs.semanticscholar.org/40b1/0e330a5511a6a45f42c8b86da222504c717f.pdf"}, {"url": "https://opencv-python-tutroals.readthedocs.io/en/latest/py_tutorials/py_objdetect/py_face_detection/py_face_detection.html", "anchor_text": "https://opencv-python-tutroals.readthedocs.io/en/latest/py_tutorials/py_objdetect/py_face_detection/py_face_detection.html"}, {"url": "https://youtu.be/WfdYYNamHZ8", "anchor_text": "https://youtu.be/WfdYYNamHZ8"}, {"url": "https://medium.com/tag/computer-vision?source=post_page-----c55cc2a9da14---------------computer_vision-----------------", "anchor_text": "Computer Vision"}, {"url": "https://medium.com/tag/face-detection?source=post_page-----c55cc2a9da14---------------face_detection-----------------", "anchor_text": "Face Detection"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----c55cc2a9da14---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/viola-jones?source=post_page-----c55cc2a9da14---------------viola_jones-----------------", "anchor_text": "Viola Jones"}, {"url": "https://medium.com/tag/opencv?source=post_page-----c55cc2a9da14---------------opencv-----------------", "anchor_text": "Opencv"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fc55cc2a9da14&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-face-detection-with-the-viola-jones-object-detection-framework-c55cc2a9da14&user=Socret+Lee&userId=cd91bc367150&source=-----c55cc2a9da14---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fc55cc2a9da14&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-face-detection-with-the-viola-jones-object-detection-framework-c55cc2a9da14&user=Socret+Lee&userId=cd91bc367150&source=-----c55cc2a9da14---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc55cc2a9da14&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-face-detection-with-the-viola-jones-object-detection-framework-c55cc2a9da14&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----c55cc2a9da14--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fc55cc2a9da14&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-face-detection-with-the-viola-jones-object-detection-framework-c55cc2a9da14&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----c55cc2a9da14---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----c55cc2a9da14--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----c55cc2a9da14--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----c55cc2a9da14--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----c55cc2a9da14--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----c55cc2a9da14--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----c55cc2a9da14--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----c55cc2a9da14--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----c55cc2a9da14--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@socret.lee?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@socret.lee?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Socret Lee"}, {"url": "https://medium.com/@socret.lee/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "213 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fcd91bc367150&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-face-detection-with-the-viola-jones-object-detection-framework-c55cc2a9da14&user=Socret+Lee&userId=cd91bc367150&source=post_page-cd91bc367150--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fe03be810a396&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-face-detection-with-the-viola-jones-object-detection-framework-c55cc2a9da14&newsletterV3=cd91bc367150&newsletterV3Id=e03be810a396&user=Socret+Lee&userId=cd91bc367150&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}