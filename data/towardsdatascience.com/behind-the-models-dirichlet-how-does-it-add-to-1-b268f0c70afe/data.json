{"url": "https://towardsdatascience.com/behind-the-models-dirichlet-how-does-it-add-to-1-b268f0c70afe", "time": 1682996723.622163, "path": "towardsdatascience.com/behind-the-models-dirichlet-how-does-it-add-to-1-b268f0c70afe/", "webpage": {"metadata": {"title": "Behind The Models: Dirichlet \u2014 How Does It Add To 1? | by Guido Vivaldi | Towards Data Science", "h1": "Behind The Models: Dirichlet \u2014 How Does It Add To 1?", "description": "In a previous article I presented the Dirichlet distribution as a combination of many Beta-distributed variables which add to 1.0 \u2014 this can be useful for applications where you need a \u201crandom\u201d\u2026"}, "outgoing_paragraph_urls": [{"url": "https://towardsdatascience.com/behind-the-models-beta-dirichlet-and-gem-distributions-526b11a24359", "anchor_text": "previous article", "paragraph_index": 0}, {"url": "https://medium.com/u/92bb2136ae3c?source=post_page-----b268f0c70afe--------------------------------", "anchor_text": "Sebastian Bruijns", "paragraph_index": 0}, {"url": "https://towardsdatascience.com/behind-the-models-beta-dirichlet-and-gem-distributions-526b11a24359", "anchor_text": "previous article", "paragraph_index": 2}, {"url": "https://medium.com/python-pandemonium/never-write-for-loops-again-91a5a4c84baf", "anchor_text": "this article", "paragraph_index": 8}], "all_paragraphs": ["In a previous article I presented the Dirichlet distribution as a combination of many Beta-distributed variables which add to 1.0 \u2014 this can be useful for applications where you need a \u201crandom\u201d classifier, which is the subject of an article still in the works. Sebastian Bruijns asked the obvious question I skirted around in the original article:", "Very nice and understandable article. I just don\u2019t understand the connection between Dirichlet and Beta, you wrote that the variates of the Dirichlet follow a Beta dist., but how does that work, how is it guaranteed to add up to one?", "This section is mostly review of the previous article \u2014 skip over it if you\u2019re familiar with those details.", "The Dirichlet distribution is a multivariate generalization of the Beta. The input is a vector of 2 or more parameters, and the output is a distribution in which the sum of the variables always equals 1.0 and each individual variable is Beta-distributed. The \u201cStick Breaking\u201d in the image below will unite these two ideas.", "The intuitive way of generating the Dirichlet after reading the above is to generate random Betas and sum them up, but that clearly won\u2019t work. In the simulation below we show that the sum of 5 Beta(3, 7)\u2019s is something normal-looking (it\u2019s not exactly normal, in part because the Beta is bound at [0, 1], so the sum is bound at [0, 5]).", "The PDF for the Dirichlet distribution is below. Here \u03b8 is the multinomial category, and \u03b1 is the vector or \u03b2 parameters. The Betas are always Beta(\u03b1, 1) \u2014 there is no second parameter. Note that the resulting Beta-distributed variates will not follow a Beta(\u03b1, 1) \u2014 the \u03b2 paramater is a function of the \u03b1 vector. That may start to give some intuition about why the Dirichlet adds to 1 \u2014 as the alphas grow bigger. The resulting Beta-distributed variates follow Beta(\u03b1, (K-1)*\u03b1) where K is the number of values in the \u03b1 vector. Have a go at it yourself:", "The form of the PDF for the Dirichlet gives a first glimpse at how it ensures that the Betas add up to 1.0. Here \u03b8 is the multinomial category, and \u03b1 is the vector we\u2019ve been working with.", "A practical implementation uses the Gamma distribution (recall that relationship between the Beta/Gamma: B(\u03b1,\u03b2)=\u0393(\u03b1)\u0393(\u03b2) / \u0393(\u03b1+\u03b2)) and is easy to intuit. First draw an independent Gamma(\u03b1, 1) for each Dirichlet variate, then average them out to 1.0 to produce Dirichlet-distributed variables.", "As an aside, this also affords a great opportunity to use some robust list-comprehension: I\u2019ve been salivating over this article for about a month.", "In the previous article we arrived at a Dirichlet process, which is slightly different than Dirichlet distribution. A Dirichlet distribution can be expanded to have an infinite number of variates via a Dirichlet process.This is another fact that I waved my hands about that might have offended your intuitions.", "The way to think about a Dirichlet process is that each pull from it is itself Dirichlet-distributed (not Beta distributed, though of course draws from a Dirichlet distribution are Beta distributed). So unlike the Dirichlet distribution above where each variate", "The process is possible because we can iteratively generate a new variate, so we don\u2019t actually generate infinite variates, but we create a framework where we could always create more variates if needed. In this case we can\u2019t use the Gamma trick from above because we can\u2019t divide by the total sum, but we can be assured that if we went onto infinity we\u2019d never end up with variates adding up to more than 1.The formula is reproduced below \u2014 p(i) is the Dirichlet variate \u2014 V(i) is an intermediary variable.", "Below we generate the first 3 variates in a Dirichlet process:", "The first Beta draw is in blue in the left graph: Beta(1,1). In the second draw in orange, we use Beta(1,1), but then multiply it by (1-V(1)), so the final variable is Beta-looking. The green line is the third draw \u2014 Beta continues to increase as we shift more mass into the left hand tail. This makes intuitive sense \u2014 using \u03b1 = 1 we\u2019re allowing relatively high values to come out early in the draws, so the remaining draws get forced into lower numbers. The right graph tells us that with only three draws we\u2019re already hugging pretty close to 1.0, so remaining draws are going to have very small margins to fit into.", "If we use \u03b1 = 0.5 above we force the early draws to stick to lower values, and so have more freedom for later", "Like the past article, this article was theory heavy. Hopefully it helped fill in some gaps that I glossed over in the previous article. In future articles I will use these models in application heavy examples.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Healthcare actuary and data scientist fascinated by applications of predictive analytics and machine learning to healthcare."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fb268f0c70afe&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbehind-the-models-dirichlet-how-does-it-add-to-1-b268f0c70afe&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbehind-the-models-dirichlet-how-does-it-add-to-1-b268f0c70afe&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbehind-the-models-dirichlet-how-does-it-add-to-1-b268f0c70afe&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbehind-the-models-dirichlet-how-does-it-add-to-1-b268f0c70afe&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----b268f0c70afe--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----b268f0c70afe--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://guido-vivaldi.medium.com/?source=post_page-----b268f0c70afe--------------------------------", "anchor_text": ""}, {"url": "https://guido-vivaldi.medium.com/?source=post_page-----b268f0c70afe--------------------------------", "anchor_text": "Guido Vivaldi"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F65baa09227eb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbehind-the-models-dirichlet-how-does-it-add-to-1-b268f0c70afe&user=Guido+Vivaldi&userId=65baa09227eb&source=post_page-65baa09227eb----b268f0c70afe---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb268f0c70afe&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbehind-the-models-dirichlet-how-does-it-add-to-1-b268f0c70afe&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb268f0c70afe&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbehind-the-models-dirichlet-how-does-it-add-to-1-b268f0c70afe&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://towardsdatascience.com/behind-the-models-beta-dirichlet-and-gem-distributions-526b11a24359", "anchor_text": "previous article"}, {"url": "https://medium.com/u/92bb2136ae3c?source=post_page-----b268f0c70afe--------------------------------", "anchor_text": "Sebastian Bruijns"}, {"url": "https://towardsdatascience.com/behind-the-models-beta-dirichlet-and-gem-distributions-526b11a24359", "anchor_text": "previous article"}, {"url": "https://medium.com/python-pandemonium/never-write-for-loops-again-91a5a4c84baf", "anchor_text": "this article"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----b268f0c70afe---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/dirichlet?source=post_page-----b268f0c70afe---------------dirichlet-----------------", "anchor_text": "Dirichlet"}, {"url": "https://medium.com/tag/bayesian-statistics?source=post_page-----b268f0c70afe---------------bayesian_statistics-----------------", "anchor_text": "Bayesian Statistics"}, {"url": "https://medium.com/tag/data-science?source=post_page-----b268f0c70afe---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/mathematics?source=post_page-----b268f0c70afe---------------mathematics-----------------", "anchor_text": "Mathematics"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fb268f0c70afe&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbehind-the-models-dirichlet-how-does-it-add-to-1-b268f0c70afe&user=Guido+Vivaldi&userId=65baa09227eb&source=-----b268f0c70afe---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fb268f0c70afe&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbehind-the-models-dirichlet-how-does-it-add-to-1-b268f0c70afe&user=Guido+Vivaldi&userId=65baa09227eb&source=-----b268f0c70afe---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb268f0c70afe&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbehind-the-models-dirichlet-how-does-it-add-to-1-b268f0c70afe&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----b268f0c70afe--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fb268f0c70afe&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbehind-the-models-dirichlet-how-does-it-add-to-1-b268f0c70afe&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----b268f0c70afe---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----b268f0c70afe--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----b268f0c70afe--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----b268f0c70afe--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----b268f0c70afe--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----b268f0c70afe--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----b268f0c70afe--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----b268f0c70afe--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----b268f0c70afe--------------------------------", "anchor_text": ""}, {"url": "https://guido-vivaldi.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://guido-vivaldi.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Guido Vivaldi"}, {"url": "https://guido-vivaldi.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "282 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F65baa09227eb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbehind-the-models-dirichlet-how-does-it-add-to-1-b268f0c70afe&user=Guido+Vivaldi&userId=65baa09227eb&source=post_page-65baa09227eb--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F782228465747&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbehind-the-models-dirichlet-how-does-it-add-to-1-b268f0c70afe&newsletterV3=65baa09227eb&newsletterV3Id=782228465747&user=Guido+Vivaldi&userId=65baa09227eb&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}