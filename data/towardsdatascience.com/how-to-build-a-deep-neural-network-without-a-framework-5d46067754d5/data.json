{"url": "https://towardsdatascience.com/how-to-build-a-deep-neural-network-without-a-framework-5d46067754d5", "time": 1682995267.4122949, "path": "towardsdatascience.com/how-to-build-a-deep-neural-network-without-a-framework-5d46067754d5/", "webpage": {"metadata": {"title": "How to Build a Deep Neural Network Without a Framework | by Marco Peixeiro | Towards Data Science", "h1": "How to Build a Deep Neural Network Without a Framework", "description": "Previously, we built a very simple neural network from scratch for image classification. Nonetheless, we obtained an accuracy score of 70%. Now, we will build a deeper neural network without using a\u2026"}, "outgoing_paragraph_urls": [{"url": "https://towardsdatascience.com/step-by-step-guide-to-building-your-own-neural-network-from-scratch-df64b1c5ab6e", "anchor_text": "Previously", "paragraph_index": 0}, {"url": "https://towardsdatascience.com/step-by-step-guide-to-building-your-own-neural-network-from-scratch-df64b1c5ab6e", "anchor_text": "activation", "paragraph_index": 1}, {"url": "https://towardsdatascience.com/step-by-step-guide-to-building-your-own-neural-network-from-scratch-df64b1c5ab6e", "anchor_text": "cost functions", "paragraph_index": 1}, {"url": "https://github.com/marcopeix/Deep_Learning_AI/blob/master/1.Neural%20Networks%20and%20Deep%20Learning/4.Deep%20Neural%20Networks/Building%20a%20Deep%20Neural%20Network.ipynb", "anchor_text": "first one", "paragraph_index": 2}, {"url": "https://github.com/marcopeix/Deep_Learning_AI/blob/master/1.Neural%20Networks%20and%20Deep%20Learning/4.Deep%20Neural%20Networks/Deep%20Neural%20Network%20-%20Application.ipynb", "anchor_text": "second notebook", "paragraph_index": 2}, {"url": "https://github.com/marcopeix/Deep_Learning_AI/blob/master/1.Neural%20Networks%20and%20Deep%20Learning/4.Deep%20Neural%20Networks/Deep%20Neural%20Network%20-%20Application.ipynb", "anchor_text": "previous post,", "paragraph_index": 3}, {"url": "https://www.youtube.com/channel/UC-0lpiwlftqwC7znCcF83qg?view_as=subscriber", "anchor_text": "YouTube channel", "paragraph_index": 4}, {"url": "https://towardsdatascience.com/step-by-step-guide-to-building-your-own-neural-network-from-scratch-df64b1c5ab6e", "anchor_text": "previous model", "paragraph_index": 28}, {"url": "https://github.com/marcopeix/Deep_Learning_AI/blob/master/1.Neural%20Networks%20and%20Deep%20Learning/4.Deep%20Neural%20Networks/Deep%20Neural%20Network%20-%20Application.ipynb", "anchor_text": "notebook", "paragraph_index": 29}], "all_paragraphs": ["Previously, we built a very simple neural network from scratch for image classification. Nonetheless, we obtained an accuracy score of 70%.", "Now, we will build a deeper neural network without using a framework. The following pieces of code will be extensible to any neural network architecture. This means that you can use a different number of layers and different activation and cost functions, with minimal changes to the code!", "You can grab the two notebooks summarizing the code on Github. The first one builds the necessary functions, and the second notebook applies them for image classification.", "As a prerequisite, I highly recommend that you read my previous post, as it contains detailed explanations on the different steps of building a neural network.", "For hands-on video tutorials on machine learning, deep learning, and artificial intelligence, checkout my YouTube channel.", "As you usual, the first step in building a neural network is to initialize the weight matrix and the bias matrix.", "Remember that the weights must be random non-zero values, while the biases can be initialized to 0.", "For this step, the function is very simple: loop over the number of layers in the neural network, and initialize each weight and bias for your inputs. In code, this should look like:", "Now, we will build the forward propagation module. In forward propagation, we need to feed the weighted sum to an activation function.", "This module will be built in three steps:", "ReLu stands for Rectified Linear Unit and it is expressed as:", "As you can see, the derivative is 1 for positive values and it is 0 for negative values. Note that the function is not differentiable at 0.", "In practice, the activation function will mostly be positive, meaning that the derivatives will be greater than 0. Therefore, the parameters will update faster and the network ultimately learns faster with ReLU.", "Usually, if you are unsure of what activation function to use, ReLU is a good default function that will work well in most scenarios.", "So, for the weighted sum, the function is simply:", "Simple enough! Now, we build a function to feed the result to an activation function (either ReLU or sigmoid):", "Now, we want to use the sigmoid function on the last layer, and ReLU on all previous layers. This is specific to this application, because we will be performing binary image classification, so it makes sense to use the sigmoid function on the last layer.", "Of course, we now need to define a cost function. This function will then be minimized and it will drive the updates to the weight and bias matrices.", "For this, we use the cross-entropy loss expressed as:", "Now, we implement a vectorized version in code:", "That\u2019s it for the cost function!", "Similarly to forward propagation, we will build the backpropagation module in three steps:", "First of all, we write a function for the derivatives for the weight and bias:", "Then, we find the derivatives for the activation functions:", "Finally, we write a function to perform backpropagation on the entire network:", "Now that this is done, we need to update our parameters!", "Now, we simply define gradient descent to update our parameters in order to minimize the cross-entropy cost function:", "Perfect! We are now ready to use all of the above function in a neural network for image classification!", "With all helper functions built, we can now use them in a deep neural network to recognize if it is a cat picture or not, and see if we can improve on our previous model.", "Consult the notebook to import the appropriate libraries and preprocess the data.", "In this case, we will train a 5-layer network. We define the dimensions of each dimensions and train the model as so:", "Training this model will take a few minutes. If everything was done right, you should see that we achieve a test accuracy of 80%! This is much better than our previous model!", "Of course, feel free to play around with the parameters of the model and its structure. The advantage of the code above is that it is completely flexible. You can add as many layers as you want, change the number of iterations, increase the learning rate, etc.", "Congratulations on building a deep neural network without any framework! You now have solid foundations in deep learning and you can even reuse the code above to any neural network structure.", "In the following posts, I will teach different methods to improve your neural network and achieve even better results.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Senior data scientist | Author | Instructor. I write hands-on articles with a focus on practical skills."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F5d46067754d5&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-build-a-deep-neural-network-without-a-framework-5d46067754d5&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-build-a-deep-neural-network-without-a-framework-5d46067754d5&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-build-a-deep-neural-network-without-a-framework-5d46067754d5&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-build-a-deep-neural-network-without-a-framework-5d46067754d5&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----5d46067754d5--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----5d46067754d5--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@marcopeixeiro?source=post_page-----5d46067754d5--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@marcopeixeiro?source=post_page-----5d46067754d5--------------------------------", "anchor_text": "Marco Peixeiro"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F741c1c8fcfbd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-build-a-deep-neural-network-without-a-framework-5d46067754d5&user=Marco+Peixeiro&userId=741c1c8fcfbd&source=post_page-741c1c8fcfbd----5d46067754d5---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F5d46067754d5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-build-a-deep-neural-network-without-a-framework-5d46067754d5&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F5d46067754d5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-build-a-deep-neural-network-without-a-framework-5d46067754d5&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@sneakyelbow?utm_source=medium&utm_medium=referral", "anchor_text": "Sneaky Elbow"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://towardsdatascience.com/step-by-step-guide-to-building-your-own-neural-network-from-scratch-df64b1c5ab6e", "anchor_text": "Previously"}, {"url": "https://towardsdatascience.com/step-by-step-guide-to-building-your-own-neural-network-from-scratch-df64b1c5ab6e", "anchor_text": "activation"}, {"url": "https://towardsdatascience.com/step-by-step-guide-to-building-your-own-neural-network-from-scratch-df64b1c5ab6e", "anchor_text": "cost functions"}, {"url": "https://github.com/marcopeix/Deep_Learning_AI/blob/master/1.Neural%20Networks%20and%20Deep%20Learning/4.Deep%20Neural%20Networks/Building%20a%20Deep%20Neural%20Network.ipynb", "anchor_text": "first one"}, {"url": "https://github.com/marcopeix/Deep_Learning_AI/blob/master/1.Neural%20Networks%20and%20Deep%20Learning/4.Deep%20Neural%20Networks/Deep%20Neural%20Network%20-%20Application.ipynb", "anchor_text": "second notebook"}, {"url": "https://github.com/marcopeix/Deep_Learning_AI/blob/master/1.Neural%20Networks%20and%20Deep%20Learning/4.Deep%20Neural%20Networks/Deep%20Neural%20Network%20-%20Application.ipynb", "anchor_text": "previous post,"}, {"url": "https://www.youtube.com/channel/UC-0lpiwlftqwC7znCcF83qg?view_as=subscriber", "anchor_text": "YouTube channel"}, {"url": "https://towardsdatascience.com/step-by-step-guide-to-building-your-own-neural-network-from-scratch-df64b1c5ab6e", "anchor_text": "previous model"}, {"url": "https://github.com/marcopeix/Deep_Learning_AI/blob/master/1.Neural%20Networks%20and%20Deep%20Learning/4.Deep%20Neural%20Networks/Deep%20Neural%20Network%20-%20Application.ipynb", "anchor_text": "notebook"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----5d46067754d5---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----5d46067754d5---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----5d46067754d5---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/programming?source=post_page-----5d46067754d5---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/tag/python?source=post_page-----5d46067754d5---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F5d46067754d5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-build-a-deep-neural-network-without-a-framework-5d46067754d5&user=Marco+Peixeiro&userId=741c1c8fcfbd&source=-----5d46067754d5---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F5d46067754d5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-build-a-deep-neural-network-without-a-framework-5d46067754d5&user=Marco+Peixeiro&userId=741c1c8fcfbd&source=-----5d46067754d5---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F5d46067754d5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-build-a-deep-neural-network-without-a-framework-5d46067754d5&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----5d46067754d5--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F5d46067754d5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-build-a-deep-neural-network-without-a-framework-5d46067754d5&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----5d46067754d5---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----5d46067754d5--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----5d46067754d5--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----5d46067754d5--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----5d46067754d5--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----5d46067754d5--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----5d46067754d5--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----5d46067754d5--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----5d46067754d5--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@marcopeixeiro?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@marcopeixeiro?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Marco Peixeiro"}, {"url": "https://medium.com/@marcopeixeiro/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "3.6K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F741c1c8fcfbd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-build-a-deep-neural-network-without-a-framework-5d46067754d5&user=Marco+Peixeiro&userId=741c1c8fcfbd&source=post_page-741c1c8fcfbd--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F9835bccb3d51&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-build-a-deep-neural-network-without-a-framework-5d46067754d5&newsletterV3=741c1c8fcfbd&newsletterV3Id=9835bccb3d51&user=Marco+Peixeiro&userId=741c1c8fcfbd&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://www.manning.com/books/time-series-forecasting-in-python-book", "anchor_text": "Time Series Forecasting in Python2022"}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}