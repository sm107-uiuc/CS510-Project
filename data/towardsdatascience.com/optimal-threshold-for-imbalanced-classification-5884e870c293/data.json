{"url": "https://towardsdatascience.com/optimal-threshold-for-imbalanced-classification-5884e870c293", "time": 1683018354.091427, "path": "towardsdatascience.com/optimal-threshold-for-imbalanced-classification-5884e870c293/", "webpage": {"metadata": {"title": "Optimal Threshold for Imbalanced Classification | by Audhi Aprilliant | Towards Data Science", "h1": "Optimal Threshold for Imbalanced Classification", "description": "Classification of data with imbalanced class distribution has encountered a significant drawback of the performance attainable by most standard classifier"}, "outgoing_paragraph_urls": [{"url": "https://en.wikipedia.org/wiki/Type_I_and_type_II_errors#:~:text=In%20statistical%20hypothesis%20testing%2C%20a,false%20negative%22%20finding%20or%20conclusion", "anchor_text": "HERE", "paragraph_index": 4}, {"url": "https://machinelearningmastery.com/", "anchor_text": "Jason Brownlee", "paragraph_index": 25}, {"url": "https://machinelearningmastery.com/threshold-moving-for-imbalanced-classification/", "anchor_text": "A Gentle Introduction to Threshold-Moving for Imbalanced Classification", "paragraph_index": 27}, {"url": "https://machinelearningmastery.com/", "anchor_text": "https://machinelearningmastery.com/", "paragraph_index": 27}, {"url": "http://audhiaprilliant.github.io/", "anchor_text": "http://audhiaprilliant.github.io/", "paragraph_index": 29}], "all_paragraphs": ["Classification is one of the supervised learning techniques to conduct predictive analytics with the categorical outcome, it might be a binary class or multiclass. Nowadays, there is a lot of research and cases about classification using several algorithms, from basic to advanced like logistic regression, discriminant analysis, Na\u00efve Bayes, decision tree, random forest, support vector machine, neural network, etc. They have been well developed and successfully applied to many application domains. However, the imbalanced class distribution of a data set has a problem because the majority of supervised learning techniques developed are for balanced class distribution.", "The imbalanced class distribution usually happens when we are studying a rare phenomenon such as medical diagnosis, risk management, hoax detection, and many more.", "Before talking intensively about imbalanced classification and how to handle this case, it will be good if we have a good foundation with a confusion matrix. A confusion matrix (also well-known as an error matrix) contains information about actual and predicted classifications done by a classification algorithm. The performance of such algorithms is commonly evaluated using the data in the matrix. The following table shows the confusion matrix for a two-class classifier.", "The classification with the two-class classifier will have four possible outcomes as follows.", "Read more about Type I Error and Type II Error HERE", "Furthermore, in order to evaluate our machine learning model or algorithm in classification case, there are a few evaluation metrics to explore but it\u2019s tricky if we meet the imbalanced class.", "For imbalanced classification, we must choose the correct evaluation metrics to use with the condition they are valid and unbiased. It means that the value of these evaluation metrics will have to represent the actual condition of the data. For instance, accuracy will be actually biased in imbalanced classification because of the different distribution of classes. Take a look at the following study case to understand the statement above.", "Balanced classificationSuppose we are a Data Scientist in a tech company and asked for developing a machine learning model to predict whether our customer will be a churn or not. We have 165 customers where the 105 customers are categorized as not churn and the rest as churn customer. The model produces a given outcome as follows.", "As a balanced classification, accuracy may be the unbiased metric for evaluation. It represents the model performance correctly over the balanced class distribution. The accuracy, in this case, has a high correlation to the recall, specificity, precision, etc. According to the confusion matrix, that\u2019s easier to conclude that our research has been produced as an optimal algorithm or model.", "Imbalanced classificationSimilar to the previous case but we modified the number of customers for constructing the imbalanced classification. Now, there are 450 customers in total where 15 customers are categorized as churn and the rest, 435 customers as not churn. The model produces a given outcome as follows.", "Looking at the accuracy in the confusion matrix above, the conclusion may be misleading because of the imbalanced class distribution. What does happen to the algorithm when it produces an accuracy of 0.98? The accuracy will be biased in this case. It doesn't represent the model performance as well. The accuracy is high enough but the recall is very bad. Furthermore, the specificity and precision equal to 1.0 because the model or algorithm doesn\u2019t produce the False Positive. That is one of the consequences of imbalanced classification. However, F1-score will be the real representation of model performance cause it considers the recall and precision in its calculation.", "Note: to classify the data into positive and negative, there is still no a rigid policy", "In addition to some of the evaluation metrics that have been mentioned above, there are two important metrics to understand as follows.", "To compare the uses of evaluation metrics and determine the probability threshold for imbalanced classification, the real data simulation is proposed. The simulation generates the 10,000 samples with two variables, dependent and independent, with the ratio between major and minor classes is about 99:1. It belongs to the imbalanced classification, no doubt.", "To deal with the imbalanced class, threshold moving is proposed as the alternative to handling the imbalanced. Generating the synthetic observation or resample a certain data, theoretically, has its own risk, like create a new observation actually doesn\u2019t appear in the data, decrease the valuable information of the data itself or create a flood of information.", "The X-axis or independent variable is the false positive rate for the predictive test. The Y-axis or dependent variable is the true positive rate for the predictive test. A perfect result would be the point (0, 1) indicating 0% false positives and 100% true positives.", "The geometric mean or known as G-mean is the geometric mean of sensitivity (known as recall) and specificity. So, it will be one of the unbiased evaluation metrics for imbalanced classification.", "Using the G-mean as the unbiased evaluation metrics and the main focus of threshold moving, it produces the optimal threshold for the binary classification in the 0.0131. Theoretically, the observation will be categorized as a minor class when its probability is lower than 0.0131, vice versa.", "One of the metrics to be discussed is Youden\u2019s J statistics. Optimizing Youden\u2019s J statistics will determine the best threshold for the classification.", "Youden\u2019s J index gives a equals result of the threshold as using G-mean. It produces the optimal threshold for the binary classification in 0.0131.", "A precision-recall curve is a graph that represents the relationship between precision and recall.", "There are several evaluation metrics that are ready to use as the main focus for calculation. They are G-mean, F1-score, etc. As long as they are unbiased metrics for imbalanced classification, they can be applied in the calculation.", "Using the Precision-Recall curve and F1-score, it produces a threshold of 0.3503 for determining whether a given observation belongs to the major or minor class. It differs too much from the previous technique using the ROC curve because of the approaches.", "Threshold tuning is a common technique to determine an optimal threshold for imbalanced classification. The sequence of the threshold is generated by the researcher need while the previous techniques using the ROC and Precision & Recall to create a sequence of those thresholds. The advantages are the customization of the threshold sequence as the need but it will have a higher cost of computation.", "The syntax np.arrange(0.0, 1.0, 0.0001) means that there are 10,000 candidates of a threshold. Using a looping mechanism, it tries to find out the optimal threshold with the subject to maximize the F1-score as an unbiased metric. Finally, the looping mechanism was stopped and printed out the optimal threshold of 0.3227.", "Big thanks to Jason Brownlee who has been giving me the motivation to learn and work harder related to Statistics and machine learning implementation especially in threshold moving technique with a clear and proper article. Thanks!", "The machine learning algorithm mainly works well on the balanced classification because of their algorithm assumption using the balanced distribution of the target variable. Further, accuracy is no longer relevant to the imbalanced case, it\u2019s biased. So, the main focus must be switched to those unbiased like G-mean, F1-score, etc. Threshold moving using ROC curve, Precision-Recall curve, threshold tuning curve can be the alternative solution to handling the imbalanced distribution since the resampling technique seems like it doesn\u2019t make sense to the business logic. However, the options are open and the implementation must keep consideration of the business needs.", "[1] J. Brownlee. A Gentle Introduction to Threshold-Moving for Imbalanced Classification (2020). https://machinelearningmastery.com/.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Scientist. Tech Writer. Statistics, Data Analytics, and Computer Science Enthusiast. Portfolio & social media links at http://audhiaprilliant.github.io/"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F5884e870c293&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Foptimal-threshold-for-imbalanced-classification-5884e870c293&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Foptimal-threshold-for-imbalanced-classification-5884e870c293&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Foptimal-threshold-for-imbalanced-classification-5884e870c293&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Foptimal-threshold-for-imbalanced-classification-5884e870c293&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----5884e870c293--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----5884e870c293--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://audhiaprilliant.medium.com/?source=post_page-----5884e870c293--------------------------------", "anchor_text": ""}, {"url": "https://audhiaprilliant.medium.com/?source=post_page-----5884e870c293--------------------------------", "anchor_text": "Audhi Aprilliant"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F140ffe7d74ee&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Foptimal-threshold-for-imbalanced-classification-5884e870c293&user=Audhi+Aprilliant&userId=140ffe7d74ee&source=post_page-140ffe7d74ee----5884e870c293---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F5884e870c293&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Foptimal-threshold-for-imbalanced-classification-5884e870c293&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F5884e870c293&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Foptimal-threshold-for-imbalanced-classification-5884e870c293&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@aaronburden?utm_source=medium&utm_medium=referral", "anchor_text": "Aaron Burden"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://towardsdatascience.com/tagged/hands-on-tutorials", "anchor_text": "Hands-on Tutorial"}, {"url": "https://en.wikipedia.org/wiki/Type_I_and_type_II_errors#:~:text=In%20statistical%20hypothesis%20testing%2C%20a,false%20negative%22%20finding%20or%20conclusion", "anchor_text": "HERE"}, {"url": "https://machinelearningmastery.com/", "anchor_text": "Jason Brownlee"}, {"url": "https://machinelearningmastery.com/threshold-moving-for-imbalanced-classification/", "anchor_text": "A Gentle Introduction to Threshold-Moving for Imbalanced Classification"}, {"url": "https://machinelearningmastery.com/", "anchor_text": "https://machinelearningmastery.com/"}, {"url": "https://medium.com/tag/data-science?source=post_page-----5884e870c293---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----5884e870c293---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/data-analytics?source=post_page-----5884e870c293---------------data_analytics-----------------", "anchor_text": "Data Analytics"}, {"url": "https://medium.com/tag/technology?source=post_page-----5884e870c293---------------technology-----------------", "anchor_text": "Technology"}, {"url": "https://medium.com/tag/python?source=post_page-----5884e870c293---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F5884e870c293&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Foptimal-threshold-for-imbalanced-classification-5884e870c293&user=Audhi+Aprilliant&userId=140ffe7d74ee&source=-----5884e870c293---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F5884e870c293&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Foptimal-threshold-for-imbalanced-classification-5884e870c293&user=Audhi+Aprilliant&userId=140ffe7d74ee&source=-----5884e870c293---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F5884e870c293&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Foptimal-threshold-for-imbalanced-classification-5884e870c293&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----5884e870c293--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F5884e870c293&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Foptimal-threshold-for-imbalanced-classification-5884e870c293&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----5884e870c293---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----5884e870c293--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----5884e870c293--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----5884e870c293--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----5884e870c293--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----5884e870c293--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----5884e870c293--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----5884e870c293--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----5884e870c293--------------------------------", "anchor_text": ""}, {"url": "https://audhiaprilliant.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://audhiaprilliant.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Audhi Aprilliant"}, {"url": "https://audhiaprilliant.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "1.8K Followers"}, {"url": "http://audhiaprilliant.github.io/", "anchor_text": "http://audhiaprilliant.github.io/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F140ffe7d74ee&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Foptimal-threshold-for-imbalanced-classification-5884e870c293&user=Audhi+Aprilliant&userId=140ffe7d74ee&source=post_page-140ffe7d74ee--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fc138b3004897&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Foptimal-threshold-for-imbalanced-classification-5884e870c293&newsletterV3=140ffe7d74ee&newsletterV3Id=c138b3004897&user=Audhi+Aprilliant&userId=140ffe7d74ee&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}