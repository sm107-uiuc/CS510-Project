{"url": "https://towardsdatascience.com/imdb-reviews-or-8143fe57c825", "time": 1683005048.834572, "path": "towardsdatascience.com/imdb-reviews-or-8143fe57c825/", "webpage": {"metadata": {"title": "Performing Sentiment Analysis on Movie Reviews | by Bryan Tan | Towards Data Science", "h1": "Performing Sentiment Analysis on Movie Reviews", "description": "In this article, I will be using the IMDB movie reviews dataset for this study. The dataset contains 50,000 reviews \u2014 25,000 positive and 25,000 negative reviews. An example of a review can be seen\u2026"}, "outgoing_paragraph_urls": [{"url": "https://ai.stanford.edu/~amaas/papers/wvSent_acl2011.pdf", "anchor_text": "Learning Word Vectors for Sentiment Analysis.", "paragraph_index": 26}], "all_paragraphs": ["In this article, I will be using the IMDB movie reviews dataset for this study. The dataset contains 50,000 reviews \u2014 25,000 positive and 25,000 negative reviews. An example of a review can be seen in Fig 1, where a user gave a 10/10 rating and a written review for the Oscar-winning movie Parasite (2020).", "The number of stars would be a good proxy for sentiment classification. For example, we could pre-assign the following:", "Luckily for us, the researchers at Stanford University have done the \u2018heavy-lifting\u2019 of sentimentally classifying the datasets of reviews (refer to Citations & References for further details). Here\u2019s a snipper of how the dataset looks like:", "For training, our feature matrix is greatly sparse, meaning there is a lot of zeros in this matrix as there are 25,000 rows and approximately 75,000 columns. So, what we\u2019re gonna do is find the weight of each feature and multiply them with their corresponding TD-IDF values; sum all the values, pass it through a sigmoid activation function, and that\u2019s how we end up with the Logistic Regression model. The advantages of applying a Logistic function in this case: the model handles sparse matrices really well, and the weights can be interpreted as a probability for the sentiments.", "Below, we will call the fit_transform method on CountVectorizer. This will construct the vocabulary of the bag-of-words model and transform the sample sentence below into a sparse feature vector.", "Notice how the vocabularies are now stored in a Python dictionary with each unique word mapped to unique integer indices. The array displays the term frequency for each unique word.", "TD-IDF can be used to down-weight the frequently occurring words in the feature vectors, for example, the word \u2018is\u2019 in the above sample sentence. The TD-IDF can be calculated by the product of the term frequency with the inverse document frequency. Formula to calculate TD-IDF:", "We will now transform the raw frequency input from the previous section to obtain our TD-IDF values by instantiating the TdidfTransformer method.", "Evidently from the sample sentence, the word \u2018is\u2019 had the highest term frequency in the third sentence in the document. What you\u2019ll notice after the value gets transformed into a TD-IDF value, is that instead of an inflated value of 3, it is now 0.45. This is because the word \u2018is\u2019 is also contained in sentences 1 and 2 in the document; and thus is unlikely to contain any useful or discriminatory information for our model to exploit.", "So, this is the core idea of TD-IDF values \u2014 they convert text data into numeric values and also weigh the words appropriately according to the frequency of the word in our corpus of text data.", "In this section, we will define a helper function to preprocess the text data as our text of reviews can contain special characters \u2014 html tags, emojis \u2014 that we would want to account for when training our model.", "As seen above, after applying the defined preprocessor function, the sample sentence was stripped of special characters; the emojis were also moved to the end of the sentence. This is so that our model can make use of the sequence of the text and also ascertain the sentiment of the emojis at the end of the sentences.", "In this section, we will represent our data as a collection of words or tokens; we will also be performing word-level preprocessing tasks such as stemming. To achieve this, we will utilize the natural language toolkit, or nltk.", "Stemming is a technic that reduces the inflectional forms, and sometimes derivationally related forms, of a common word to a base form. For example, the words \u2018organizer\u2019 and \u2018organizing\u2019 stems from the base word \u2018organize\u2019. So, stemming is conventionally referred to as a crude heuristic process that \u2018chops\u2019 off the ends of words, in the hope of achieving the goal correctly most of the time \u2014 this often includes the removal of derivational affixes.", "We have already done this TD-IDF transformation on our previous sample documents, but now we fill fit_transform our movie review dataset into TD-IDF values. However, instead of breaking the process down into several steps\u2014 breaking the documents down into term frequencies, then transforming them into TD-IDF values \u2014 we will implement the TfidfVectorizer method that carries out all the above steps in one single step.", "With X and y as our feature matrices of TD-IDF values and target vector of sentiment values respectively, we are ready to split our dataset into training and test sets. Then, we will fit our training set into a Logistic Regression model.", "Note that instead of manually hyperparamter tuning our model, we\u2019re using LogisticRegressionCV to specify the number of cross-validation folds we want to do to tune the hyperparameter \u2014 that is 5-fold cross-validation.", "Finally, we will be passing our test data \u2014 data our model has not seen before \u2014 for inference towards how well our model did.", "89.6% \u2014 that\u2019s pretty good considering we\u2019re using a relatively simple model for our study!", "Another way of looking at the accuracy of our classifier is through a confusion matrix.", "Observe the first row. The first row is for reviews which their actual sentiment values in the test set are 1. As you can calculate, out of 25,000 reviews, the sentiment value of 12,473 of them is 1; and out of these 12,473, the classifier correctly predicted 11,209 of them as 1.", "It means, for 11,209 reviews, the actual sentiment values were 1 in the test set, and the classifier also correctly predicted those as 1. However, while the actual labels of 1,264 reviews were 1, the classifier predicted those as 0, which is pretty good.", "What about the reviews with the sentiment value of 0? Let\u2019s look at the second row. It looks like there were a total 12,527 reviews which their actual sentiment values were 0.", "The classifier correctly predicted 11,193 of them as 0, and 1,334 of them wrongly as 1. So, it has done a good job in predicting the reviews with sentiment values of 0.", "A good thing about confusion matrix is that it shows the model\u2019s ability to correctly predict or separate the classes. In specific cases of a binary classifier, such as this example, we can interpret these numbers as the count of true positives, false positives, true negatives, and false negatives.", "In this study, we covered topics on:", "[1] Andrew L. Maas, Raymond E. Daly, Peter T. Pham, Dan Huang, Andrew Y. Ng, and Christopher Potts. (2011). Learning Word Vectors for Sentiment Analysis. The 49th Annual Meeting of the Association for Computational Linguistics (ACL 2011).", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "19, Data Science Intern. I write maths & ai."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F8143fe57c825&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimdb-reviews-or-8143fe57c825&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimdb-reviews-or-8143fe57c825&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimdb-reviews-or-8143fe57c825&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimdb-reviews-or-8143fe57c825&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----8143fe57c825--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----8143fe57c825--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@bryantanjw?source=post_page-----8143fe57c825--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@bryantanjw?source=post_page-----8143fe57c825--------------------------------", "anchor_text": "Bryan Tan"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F7cdfc2e9a731&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimdb-reviews-or-8143fe57c825&user=Bryan+Tan&userId=7cdfc2e9a731&source=post_page-7cdfc2e9a731----8143fe57c825---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F8143fe57c825&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimdb-reviews-or-8143fe57c825&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F8143fe57c825&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimdb-reviews-or-8143fe57c825&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@jakehills?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Jake Hills"}, {"url": "https://unsplash.com/s/photos/movie-review?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://www.imdb.com/title/tt6751668/reviews?ref_=tt_ql_3", "anchor_text": "IMDB user review"}, {"url": "https://towardsdatascience.com/derivative-of-the-sigmoid-function-536880cf918e", "anchor_text": "Sigmoid function"}, {"url": "https://hackernoon.com/what-is-tf-idf-and-how-can-it-be-used-to-optimize-seo-content-4h1dh32f2", "anchor_text": "hackernoon"}, {"url": "https://ai.stanford.edu/~amaas/papers/wvSent_acl2011.pdf", "anchor_text": "Learning Word Vectors for Sentiment Analysis."}, {"url": "https://github.com/TheClub4/IMDB_Sentiment_Analysis", "anchor_text": "https://github.com/TheClub4/IMDB_Sentiment_Analysis"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----8143fe57c825---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/logistic-regression?source=post_page-----8143fe57c825---------------logistic_regression-----------------", "anchor_text": "Logistic Regression"}, {"url": "https://medium.com/tag/sentiment-analysis?source=post_page-----8143fe57c825---------------sentiment_analysis-----------------", "anchor_text": "Sentiment Analysis"}, {"url": "https://medium.com/tag/nlp?source=post_page-----8143fe57c825---------------nlp-----------------", "anchor_text": "NLP"}, {"url": "https://medium.com/tag/data-science?source=post_page-----8143fe57c825---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F8143fe57c825&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimdb-reviews-or-8143fe57c825&user=Bryan+Tan&userId=7cdfc2e9a731&source=-----8143fe57c825---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F8143fe57c825&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimdb-reviews-or-8143fe57c825&user=Bryan+Tan&userId=7cdfc2e9a731&source=-----8143fe57c825---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F8143fe57c825&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimdb-reviews-or-8143fe57c825&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----8143fe57c825--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F8143fe57c825&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimdb-reviews-or-8143fe57c825&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----8143fe57c825---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----8143fe57c825--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----8143fe57c825--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----8143fe57c825--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----8143fe57c825--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----8143fe57c825--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----8143fe57c825--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----8143fe57c825--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----8143fe57c825--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@bryantanjw?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@bryantanjw?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Bryan Tan"}, {"url": "https://medium.com/@bryantanjw/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "306 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F7cdfc2e9a731&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimdb-reviews-or-8143fe57c825&user=Bryan+Tan&userId=7cdfc2e9a731&source=post_page-7cdfc2e9a731--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F32dd6de2739d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimdb-reviews-or-8143fe57c825&newsletterV3=7cdfc2e9a731&newsletterV3Id=32dd6de2739d&user=Bryan+Tan&userId=7cdfc2e9a731&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}