{"url": "https://towardsdatascience.com/cryptocurrency-price-prediction-using-lstms-tensorflow-for-hackers-part-iii-264fcdbccd3f", "time": 1682995955.765217, "path": "towardsdatascience.com/cryptocurrency-price-prediction-using-lstms-tensorflow-for-hackers-part-iii-264fcdbccd3f/", "webpage": {"metadata": {"title": "Cryptocurrency price prediction using LSTMs | TensorFlow for Hackers (Part III) | by Venelin Valkov | Towards Data Science", "h1": "Cryptocurrency price prediction using LSTMs | TensorFlow for Hackers (Part III)", "description": "Build and train an Bidirectional LSTM Deep Neural Network for Time Series prediction in TensorFlow 2. Use the model to predict the future Bitcoin price."}, "outgoing_paragraph_urls": [{"url": "https://colab.research.google.com/drive/1wWvtA5RC6-is6J8W86wzK52Knr3N1Xbm", "anchor_text": "Complete source code in Google Colaboratory Notebook", "paragraph_index": 1}, {"url": "https://finance.yahoo.com/quote/BTC-USD/history?period1=1279314000&period2=1556053200&interval=1d&filter=history&frequency=1d", "anchor_text": "Yahoo! Finance", "paragraph_index": 7}, {"url": "https://www.reddit.com/r/Bitcoin/comments/7j653t/what_does_it_feel_to_be_rich_beacuse_of_bitcoin/", "anchor_text": "Bitcoin made some people really rich", "paragraph_index": 10}, {"url": "https://en.wikipedia.org/wiki/Time_series", "anchor_text": "Time Series", "paragraph_index": 11}, {"url": "https://en.wikipedia.org/wiki/Recurrent_neural_network", "anchor_text": "Recurrent Neural Networks (RNNs)", "paragraph_index": 19}, {"url": "https://colah.github.io/posts/2015-08-Understanding-LSTMs/", "anchor_text": "inability of capturing long-term dependencies", "paragraph_index": 20}, {"url": "https://en.wikipedia.org/wiki/Long_short-term_memory", "anchor_text": "LSTM", "paragraph_index": 21}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.MinMaxScaler.html", "anchor_text": "MinMaxScaler", "paragraph_index": 23}, {"url": "https://scikit-learn.org/stable/index.html", "anchor_text": "scikit learn", "paragraph_index": 23}, {"url": "https://docs.scipy.org/doc/numpy/reference/generated/numpy.reshape.html", "anchor_text": "reshape", "paragraph_index": 24}, {"url": "https://docs.scipy.org/doc/numpy/reference/generated/numpy.isnan.html", "anchor_text": "isnan", "paragraph_index": 26}, {"url": "https://www.tensorflow.org/versions/r2.0/api_docs/python/tf/keras/layers/LSTM", "anchor_text": "LSTM", "paragraph_index": 32}, {"url": "https://www.tensorflow.org/versions/r2.0/api_docs/python/tf/keras/layers/Dropout", "anchor_text": "Dropout", "paragraph_index": 32}, {"url": "https://www.tensorflow.org/versions/r2.0/api_docs/python/tf/keras/layers/Bidirectional", "anchor_text": "Bidirectional", "paragraph_index": 33}, {"url": "https://maxwell.ict.griffith.edu.au/spl/publications/papers/ieeesp97_schuster.pdf", "anchor_text": "Bidirectional RNNs", "paragraph_index": 34}, {"url": "https://www.tensorflow.org/api_docs/python/tf/keras/layers/CuDNNLSTM", "anchor_text": "CuDNNLSTM", "paragraph_index": 35}, {"url": "https://ml-cheatsheet.readthedocs.io/en/latest/activation_functions.html#linear", "anchor_text": "Linear activation function", "paragraph_index": 36}, {"url": "https://en.wikipedia.org/wiki/Mean_squared_error", "anchor_text": "Mean Squared Error", "paragraph_index": 37}, {"url": "https://www.tensorflow.org/versions/r2.0/api_docs/python/tf/optimizers/Adam", "anchor_text": "Adam", "paragraph_index": 37}, {"url": "https://colab.research.google.com/drive/1wWvtA5RC6-is6J8W86wzK52Knr3N1Xbm", "anchor_text": "Complete source code in Google Colaboratory Notebook", "paragraph_index": 44}], "all_paragraphs": ["TL;DR Build and train an Bidirectional LSTM Deep Neural Network for Time Series prediction in TensorFlow 2. Use the model to predict the future Bitcoin price.", "Complete source code in Google Colaboratory Notebook", "This time you\u2019ll build a basic Deep Neural Network model to predict Bitcoin price based on historical data. You can use the model however you want, but you carry the risk for your actions.", "You might be asking yourself something along the lines:", "Can I still get rich with cryptocurrency?", "Of course, the answer is fairly nuanced. Here, we\u2019ll have a look at how you might build a model to help you along the crazy journey.", "Or you might be having money problems? Here is one possible solution:", "Our dataset comes from Yahoo! Finance and covers all available (at the time of this writing) data on Bitcoin-USD price. Let\u2019s load it into a Pandas dataframe:", "Note that we sort the data by Date just in case. Here is a sample of the data we\u2019re interested in:", "We have a total of 3201 data points representing Bitcoin-USD price for 3201 days (~9 years). We\u2019re interested in predicting the closing price for future dates.", "Of course, Bitcoin made some people really rich and for some went really poor. The question remains though, will it happen again? Let\u2019s have a look at what one possible model thinks about that. Shall we?", "Our dataset is somewhat different from our previous examples. The data is sorted by time and recorded at equal intervals (1 day). Such a sequence of data is called Time Series.", "Temporal datasets are quite common in practice. Your energy consumption and expenditure (calories in, calories out), weather changes, stock market, analytics gathered from the users for your product/app and even your (possibly in love) heart produce Time Series.", "You might be interested in a plethora of properties regarding your Time Series \u2014 stationarity, seasonality and autocorrelation are some of the most well known.", "Autocorrelation is the correlation of data points separated by some interval (known as lag).", "Seasonality refers to the presence of some cyclical pattern at some interval (no, it doesn\u2019t have to be every spring).", "A time series is said to be stationarity if it has constant mean and variance. Also, the covariance is independent of the time.", "One obvious question you might ask yourself while watching at Time Series data is: \u201cDoes the value of the current time step affects the next one?\u201d a.k.a. Time Series forecasting.", "There are many approaches that you can use for this purpose. But we\u2019ll build a Deep Neural Network that does some forecasting for us and use it to predict future Bitcoin price.", "All models we\u2019ve built so far do not allow for operating on sequence data. Fortunately, we can use a special class of Neural Network models known as Recurrent Neural Networks (RNNs) just for this purpose. RNNs allow using the output from the model as a new input for the same model. The process can be repeated indefinitely.", "One serious limitation of RNNs is the inability of capturing long-term dependencies in a sequence (e.g. Is there a dependency between today`s price and that 2 weeks ago?). One way to handle the situation is by using an Long short-term memory (LSTM) variant of RNN.", "The default LSTM behavior is remembering information for prolonged periods of time. Let\u2019s see how you can use LSTM in Keras.", "First, we\u2019re going to squish our price data in the range [0, 1]. Recall that this will help our optimization algorithm converge faster:", "We\u2019re going to use the MinMaxScaler from scikit learn:", "The scaler expects the data to be shaped as (x, y), so we add a dummy dimension using reshape before applying it.", "Let\u2019s also remove NaNs since our model won\u2019t be able to handle them well:", "We use isnan as a mask to filter out NaN values. Again we reshape the data after removing the NaNs.", "LSTMs expect the data to be in 3 dimensions. We need to split the data into sequences of some preset length. The shape we want to obtain is:", "We also want to save some data for testing. Let\u2019s build some sequences:", "The process of building sequences works by creating a sequence of a specified length at position 0. Then we shift one position to the right (e.g. 1) and create another sequence. The process is repeated until all possible positions are used.", "We save 5% of the data for testing. The datasets look like this:", "Our model will use 2945 sequences representing 99 days of Bitcoin price changes each for training. We\u2019re going to predict the price for 156 days in the future (from our model POV).", "We\u2019re creating a 3 layer LSTM Recurrent Neural Network. We use Dropout with a rate of 20% to combat overfitting during training:", "You might be wondering about what the deal with Bidirectional and CuDNNLSTM is?", "Bidirectional RNNs allows you to train on the sequence data in forward and backward (reversed) direction. In practice, this approach works well with LSTMs.", "CuDNNLSTM is a \u201cFast LSTM implementation backed by cuDNN\u201d. Personally, I think it is a good example of leaky abstraction, but it is crazy fast!", "Our output layer has a single neuron (predicted Bitcoin price). We use Linear activation function which activation is proportional to the input.", "We\u2019ll use Mean Squared Error as a loss function and Adam optimizer.", "Note that we do not want to shuffle the training data since we\u2019re using Time Series.", "After a lightning-fast training (thanks Google for the free T4 GPUs), we have the following training loss:", "Let\u2019s make our model predict Bitcoin prices!", "We can use our scaler to invert the transformation we did so the prices are no longer scaled in the [0, 1] range.", "Our rather succinct model seems to do well on the test data. Care to try it on other currencies?", "Congratulations, you just built a Bidirectional LSTM Recurrent Neural Network in TensorFlow 2. Our model (and preprocessing \u201cpipeline\u201d) is pretty generic and can be used for other datasets.", "Complete source code in Google Colaboratory Notebook", "One interesting direction of future investigation might be analyzing the correlation between different cryptocurrencies and how would that affect the performance of our model.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F264fcdbccd3f&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcryptocurrency-price-prediction-using-lstms-tensorflow-for-hackers-part-iii-264fcdbccd3f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcryptocurrency-price-prediction-using-lstms-tensorflow-for-hackers-part-iii-264fcdbccd3f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcryptocurrency-price-prediction-using-lstms-tensorflow-for-hackers-part-iii-264fcdbccd3f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcryptocurrency-price-prediction-using-lstms-tensorflow-for-hackers-part-iii-264fcdbccd3f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----264fcdbccd3f--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----264fcdbccd3f--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://venelinvalkov.medium.com/?source=post_page-----264fcdbccd3f--------------------------------", "anchor_text": ""}, {"url": "https://venelinvalkov.medium.com/?source=post_page-----264fcdbccd3f--------------------------------", "anchor_text": "Venelin Valkov"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F102e34a0beb1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcryptocurrency-price-prediction-using-lstms-tensorflow-for-hackers-part-iii-264fcdbccd3f&user=Venelin+Valkov&userId=102e34a0beb1&source=post_page-102e34a0beb1----264fcdbccd3f---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F264fcdbccd3f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcryptocurrency-price-prediction-using-lstms-tensorflow-for-hackers-part-iii-264fcdbccd3f&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F264fcdbccd3f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcryptocurrency-price-prediction-using-lstms-tensorflow-for-hackers-part-iii-264fcdbccd3f&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "http://davidmcbee.com/", "anchor_text": "David McBee"}, {"url": "https://colab.research.google.com/drive/1wWvtA5RC6-is6J8W86wzK52Knr3N1Xbm", "anchor_text": "Complete source code in Google Colaboratory Notebook"}, {"url": "https://finance.yahoo.com/quote/BTC-USD/history?period1=1279314000&period2=1556053200&interval=1d&filter=history&frequency=1d", "anchor_text": "Yahoo! Finance"}, {"url": "https://www.reddit.com/r/Bitcoin/comments/7j653t/what_does_it_feel_to_be_rich_beacuse_of_bitcoin/", "anchor_text": "Bitcoin made some people really rich"}, {"url": "https://en.wikipedia.org/wiki/Time_series", "anchor_text": "Time Series"}, {"url": "https://en.wikipedia.org/wiki/Recurrent_neural_network", "anchor_text": "Recurrent Neural Networks (RNNs)"}, {"url": "https://colah.github.io/posts/2015-08-Understanding-LSTMs/", "anchor_text": "inability of capturing long-term dependencies"}, {"url": "https://en.wikipedia.org/wiki/Long_short-term_memory", "anchor_text": "LSTM"}, {"url": "https://www.andrewng.org/", "anchor_text": "Andrew Ng"}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.MinMaxScaler.html", "anchor_text": "MinMaxScaler"}, {"url": "https://scikit-learn.org/stable/index.html", "anchor_text": "scikit learn"}, {"url": "https://docs.scipy.org/doc/numpy/reference/generated/numpy.reshape.html", "anchor_text": "reshape"}, {"url": "https://docs.scipy.org/doc/numpy/reference/generated/numpy.isnan.html", "anchor_text": "isnan"}, {"url": "https://www.tensorflow.org/versions/r2.0/api_docs/python/tf/keras/layers/LSTM", "anchor_text": "LSTM"}, {"url": "https://www.tensorflow.org/versions/r2.0/api_docs/python/tf/keras/layers/Dropout", "anchor_text": "Dropout"}, {"url": "https://www.tensorflow.org/versions/r2.0/api_docs/python/tf/keras/layers/Bidirectional", "anchor_text": "Bidirectional"}, {"url": "https://maxwell.ict.griffith.edu.au/spl/publications/papers/ieeesp97_schuster.pdf", "anchor_text": "Bidirectional RNNs"}, {"url": "https://www.tensorflow.org/api_docs/python/tf/keras/layers/CuDNNLSTM", "anchor_text": "CuDNNLSTM"}, {"url": "https://ml-cheatsheet.readthedocs.io/en/latest/activation_functions.html#linear", "anchor_text": "Linear activation function"}, {"url": "https://en.wikipedia.org/wiki/Mean_squared_error", "anchor_text": "Mean Squared Error"}, {"url": "https://www.tensorflow.org/versions/r2.0/api_docs/python/tf/optimizers/Adam", "anchor_text": "Adam"}, {"url": "https://colab.research.google.com/drive/1wWvtA5RC6-is6J8W86wzK52Knr3N1Xbm", "anchor_text": "Complete source code in Google Colaboratory Notebook"}, {"url": "https://www.curiousily.com/posts/cryptocurrency-price-prediction-in-tensorflow-2/", "anchor_text": "https://www.curiousily.com"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----264fcdbccd3f---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----264fcdbccd3f---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----264fcdbccd3f---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/tensorflow?source=post_page-----264fcdbccd3f---------------tensorflow-----------------", "anchor_text": "TensorFlow"}, {"url": "https://medium.com/tag/cryptocurrency?source=post_page-----264fcdbccd3f---------------cryptocurrency-----------------", "anchor_text": "Cryptocurrency"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F264fcdbccd3f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcryptocurrency-price-prediction-using-lstms-tensorflow-for-hackers-part-iii-264fcdbccd3f&user=Venelin+Valkov&userId=102e34a0beb1&source=-----264fcdbccd3f---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F264fcdbccd3f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcryptocurrency-price-prediction-using-lstms-tensorflow-for-hackers-part-iii-264fcdbccd3f&user=Venelin+Valkov&userId=102e34a0beb1&source=-----264fcdbccd3f---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F264fcdbccd3f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcryptocurrency-price-prediction-using-lstms-tensorflow-for-hackers-part-iii-264fcdbccd3f&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----264fcdbccd3f--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F264fcdbccd3f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcryptocurrency-price-prediction-using-lstms-tensorflow-for-hackers-part-iii-264fcdbccd3f&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----264fcdbccd3f---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----264fcdbccd3f--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----264fcdbccd3f--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----264fcdbccd3f--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----264fcdbccd3f--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----264fcdbccd3f--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----264fcdbccd3f--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----264fcdbccd3f--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----264fcdbccd3f--------------------------------", "anchor_text": ""}, {"url": "https://venelinvalkov.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://venelinvalkov.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Venelin Valkov"}, {"url": "https://venelinvalkov.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "2.5K Followers"}, {"url": "https://mlexpert.io", "anchor_text": "https://mlexpert.io"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F102e34a0beb1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcryptocurrency-price-prediction-using-lstms-tensorflow-for-hackers-part-iii-264fcdbccd3f&user=Venelin+Valkov&userId=102e34a0beb1&source=post_page-102e34a0beb1--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F5323954064aa&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcryptocurrency-price-prediction-using-lstms-tensorflow-for-hackers-part-iii-264fcdbccd3f&newsletterV3=102e34a0beb1&newsletterV3Id=5323954064aa&user=Venelin+Valkov&userId=102e34a0beb1&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}