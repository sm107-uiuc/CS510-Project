{"url": "https://towardsdatascience.com/feature-engineering-3a380ad1aa36", "time": 1683004961.2942631, "path": "towardsdatascience.com/feature-engineering-3a380ad1aa36/", "webpage": {"metadata": {"title": "Feature Engineering. Understanding themost important step in\u2026 | by Arthur Mello | Towards Data Science", "h1": "Feature Engineering", "description": "Feature engineering is a set of techniques applied in data science aiming to make sure the data can be used properly by models. It is a mix between science and art, and is arguably the most important\u2026"}, "outgoing_paragraph_urls": [{"url": "https://medium.com/@aptrishu/understanding-principle-component-analysis-e32be0253ef0", "anchor_text": "this article", "paragraph_index": 22}], "all_paragraphs": ["Feature engineering is a set of techniques applied in data science aiming to make sure the data can be used properly by models. It is a mix between science and art, and is arguably the most important step of a data science workflow, in the sense that it is one of the steps that brings the most value.", "Mastering it requires a lot of study and practice: not only you should understand the mathematical principles underlying feature transformations in order to manipulate them, but you also need to know which types of transformations apply in each situation. We will now go through the main transformations that can be applied to different types of data, how to do them and their consequences.", "It means turning a numeric variable into a binary one: for example, imagine we are using weather data to predict sales, and we have information on rain levels (in millimetres). Instead of using this information as a continuous variable, it might be more useful to take a binary variable instead, where 0 = no rain, 1 = any level of rain. This way, you lose information, since you don\u2019t know the amount of rain anymore, but in some cases this information can be irrelevant.", "In our previous example, instead of using a binary variable, we could also have transformed the original variable into a categorical one, where 0 = no rain, 1 = light rain, 2 = heavy rain, 3 = storm. The number of bins and their size may vary, and it might take you a few tries to get them \u201cright\u201d. It helps to take a look at the variable distribution (a histogram) to find reasonable cutoff points (such as the quartiles).", "Imagine a variable with a histogram that looks like the picture below (the actual numbers are not relevant).", "As we can see, this variable is highly concentrated in one tail (a heavy-tailed distribution), and this might add some bias and error to some models. To fix this, we could apply a log transformation, meaning that, instead of using our variable X in our model, we could use a new variable: log(X). Our new variable, log_X, has a much more \u201cwell-behaved\u201d distribution:", "This distribution usually yields better results for most models (think of a linear regression \u2014 it is easier to fit a straight line when our observations are not all concentrated around 0).", "Power transformation is essentially taking your feature X and applying a power function to it, such as squaring or taking the square root. This can help your model account for non-linear interactions between your feature and your target variable.", "Scaling is specially useful when you use models that attribute different coefficients for your variables and you want to interpret these coefficients later. If your variables are not in the same scale, it will be very hard to compare coefficients between them.", "The most popular scaling method is called standardisation. Feature standardisation creates a new variable which has an average of 0 (it moves a variable\u2019s distribution to be around 0) and a variance of 1 (it scales the variable\u2019s variance). The way of doing it is using the formula below, where std_dev(x) represents the standard deviation of x:", "Your variable will then assume negative and positive values, distributed around 0.", "If you don\u2019t want to have negative values for your variable, you can use a min-max scaling, another popular scaling method, for which the formula is:", "This time, your new variable will be bounded between 0 and 1, making it easier to interpret its new values and any coefficients generated by your models.", "Text data contains a lot of noise, which should be dealt with before we try more advanced transformations. You should deal with uppercase/lowercase letters, usually by turning all letters into lowercase, but be careful when dealing with cases that might differ in meaning (\u201cpenguins\u201d and \u201cPenguins\u201d mean exactly the same thing, whereas \u201cHouse\u201d might mean the TV show and not an actual house).", "Another cleaning step for text data is getting rid of stop words, which are words that don\u2019t carry much meaning in themselves such as \u201cis\u201d, \u201care\u201d, \u201cin\u201d, \u201cfor\u201d, etc. There are public lists of stop words for many different languages, accessible directly from libraries in Python and R.", "Finally, there\u2019s also cleaning extra spaces, fixing mistyped words, etc.", "Generally speaking, stemming means transforming a word into its root. For example, the words \u201cruns\u201d, \u201crunner\u201d, \u201cran\u201d, \u201crun\u201d would all become \u201crun\u201d. Sometimes it is a useful feature, but sometimes it can also change the meaning of words (\u201cnew\u201d and \u201cnews\u201d do not mean the same thing), so consider your specific case before applying this transformation.", "It is a lot harder to deal with text data than it is to deal with numbers, so most of the methods used to deal with text are based on turning it into numbers. One of the most basic methods is considering a text as a \u201cbag of words\u201d, meaning that we count the number of times each word appears in a text, turn those counts into a vector and use these vectors to compare different texts. The problem with this approach is obvious: words can have different meanings, depending on the order they appear in, or on which words precede them. For instance, consider the two following sentences: \u201ca man ate a hamburger\u201d and \u201ca hamburger ate a man\u201d. Both have exactly the same word counts, and would be represented in the same way, while they clearly mean different things. To address this issue, a common solution is to create bags of n-grams, meaning that, instead of counting words we count sets of words that appear together (usually 2 or 3 words maximum). So in our example, we would count the number of occurrences for \u201ca man\u201d, \u201ca ate\u201d, \u201ca hamburger\u201d, \u201cman ate\u201d, etc.", "TF-IDF stands for Term Frequency \u2014 Inverse Document Frequency, which is a way of taking into account words occurence in a text compared to other texts. Let\u2019s say we are analysing Trump\u2019s tweets, and we want to know what are the words he uses the most. If we just look at simple word counts, we would get quite boring results: words such as \u201cand\u201d and \u201cI\u201d would come up because they are common. The problem is: they are common everywhere, not because Trump writes them particularly often, and that\u2019s where TF-IDF can help us. It can be calculated in different ways, but a simple one is:", "This way, we give more weight to words that are not very common, helping us to see words that Trump uses a lot more when compared to other people. This time, we would probably get words such as \u201cAmerica\u201d, \u201cCongress\u201d and \u201cgreat\u201d.", "Again, our goal is to turn a non-numerical variable into a numerical one. One-Hot Encoding creates n new variables, where n is the number of unique categories in our original variable. For example, if we have a Sex variable, we would have only 2 categories: \u201cMan\u201d and \u201cWoman\u201d. We would then replace the Sex variable by 2 new variables: Man and Woman for which the value is 1 if the observation belongs to the respective sex :", "Have you noticed that one of the variables above is redundant? we could keep only one of them without losing any information. If you drop the Woman column, you can still know the person\u2019s sex (if it\u2019s not a woman, than it\u2019s a man). Dummy Coding does exactly that :", "PCA is a subject on its own. If you want to understand the details a bit better, check out this article.", "In general terms, PCA is a method that reduces dimensions while keeping as much information as possible. It takes the original features (which can also be called dimensions), and creates new features, based on projections from the original dimensions. You start with 30 dimensions and can end up with 2, 3, 4 or 18, which are called principal components. You will have a trade-off between reducing dimensions and keeping information and variance. Keeping at least 80% of the original variance is a common benchmark, but it really depends on your application.", "Feature engineering is a set of techniques to prepare your data before modelling. There are many trade-offs between keeping relevant information, keeping your data in a treatable size to keep calculation times reasonable, and interpretability. Make sure you understand the mathematics behind the techniques you use to know if they apply to your specific case, and leave enough time for this step, since it is one of the most important when doing data science. Finally, make sure you iterate between steps: after you do your first model, come back to this step to see if there are things you can improve before running another model.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data scientist and educator. I write about data analysis and machine learning applied to marketing."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F3a380ad1aa36&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffeature-engineering-3a380ad1aa36&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffeature-engineering-3a380ad1aa36&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffeature-engineering-3a380ad1aa36&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffeature-engineering-3a380ad1aa36&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----3a380ad1aa36--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----3a380ad1aa36--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@arthurmello_?source=post_page-----3a380ad1aa36--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@arthurmello_?source=post_page-----3a380ad1aa36--------------------------------", "anchor_text": "Arthur Mello"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F9d32d5e0ac40&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffeature-engineering-3a380ad1aa36&user=Arthur+Mello&userId=9d32d5e0ac40&source=post_page-9d32d5e0ac40----3a380ad1aa36---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F3a380ad1aa36&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffeature-engineering-3a380ad1aa36&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F3a380ad1aa36&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffeature-engineering-3a380ad1aa36&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@alexanderkondratiev?utm_source=medium&utm_medium=referral", "anchor_text": "Alex Kondratiev"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://medium.com/@aptrishu/understanding-principle-component-analysis-e32be0253ef0", "anchor_text": "this article"}, {"url": "https://medium.com/tag/feature-engineering?source=post_page-----3a380ad1aa36---------------feature_engineering-----------------", "anchor_text": "Feature Engineering"}, {"url": "https://medium.com/tag/data-science?source=post_page-----3a380ad1aa36---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/data?source=post_page-----3a380ad1aa36---------------data-----------------", "anchor_text": "Data"}, {"url": "https://medium.com/tag/statistics?source=post_page-----3a380ad1aa36---------------statistics-----------------", "anchor_text": "Statistics"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----3a380ad1aa36---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F3a380ad1aa36&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffeature-engineering-3a380ad1aa36&user=Arthur+Mello&userId=9d32d5e0ac40&source=-----3a380ad1aa36---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F3a380ad1aa36&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffeature-engineering-3a380ad1aa36&user=Arthur+Mello&userId=9d32d5e0ac40&source=-----3a380ad1aa36---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F3a380ad1aa36&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffeature-engineering-3a380ad1aa36&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----3a380ad1aa36--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F3a380ad1aa36&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffeature-engineering-3a380ad1aa36&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----3a380ad1aa36---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----3a380ad1aa36--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----3a380ad1aa36--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----3a380ad1aa36--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----3a380ad1aa36--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----3a380ad1aa36--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----3a380ad1aa36--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----3a380ad1aa36--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----3a380ad1aa36--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@arthurmello_?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@arthurmello_?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Arthur Mello"}, {"url": "https://medium.com/@arthurmello_/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "1.8K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F9d32d5e0ac40&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffeature-engineering-3a380ad1aa36&user=Arthur+Mello&userId=9d32d5e0ac40&source=post_page-9d32d5e0ac40--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F1fb0cddb25fe&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffeature-engineering-3a380ad1aa36&newsletterV3=9d32d5e0ac40&newsletterV3Id=1fb0cddb25fe&user=Arthur+Mello&userId=9d32d5e0ac40&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}