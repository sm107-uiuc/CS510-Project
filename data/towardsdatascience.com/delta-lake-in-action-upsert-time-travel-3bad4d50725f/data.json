{"url": "https://towardsdatascience.com/delta-lake-in-action-upsert-time-travel-3bad4d50725f", "time": 1683013426.865351, "path": "towardsdatascience.com/delta-lake-in-action-upsert-time-travel-3bad4d50725f/", "webpage": {"metadata": {"title": "Delta Lake in Action: Upsert & Time Travel | by Jyoti Dhiman | Towards Data Science", "h1": "Delta Lake in Action: Upsert & Time Travel", "description": "This is a follow up of my introduction to the Delta Lake with Apache Spark article, please read on to find out how to use Delta lake with Apache Spark to perform operations like Update existing data\u2026"}, "outgoing_paragraph_urls": [{"url": "https://towardsdatascience.com/delta-lake-with-spark-what-and-why-6d08bef7b963", "anchor_text": "article", "paragraph_index": 0}], "all_paragraphs": ["This is a follow up of my introduction to the Delta Lake with Apache Spark article, please read on to find out how to use Delta lake with Apache Spark to perform operations like Update existing data, check out previous versions of data, convert data to delta table, etc.", "Before diving into code, let us try to understand when to use Delta Lake with Spark because it\u2019s not like I just woke up one day and included Delta Lake in the architecture :P", "Surely, there are many use cases to work with Delta Lake, but these are the two scenarios, which really helped me.", "Enough talk, let\u2019s dive into code!", "First things first, to get started with Delta Lake, it needs to be added as a dependency with the Spark application, which can be done like:", "Delta lake works with data stored as Delta Tables, so data needs to be written as Delta Table.", "Reading DeltaTable as Spark Dataframe allows all Dataframe operations on the DeltaTable.", "Reading data as DeltaTable only supports DeltaTable specific functions. Also, DeltaTable can be converted to DataFrame like:", "UPSERT operation on DeltaTable allows for data updates, which means if DeltaTable can be merged with some new dataset, and on the basis on some join key , data can be inserted on modified in the delta table. This is how Upsert can be done on the DeltaTable:", "Seems simple right? That\u2019s it! So what will happen is, rows in todayData with updated information on cities will be modified in deltaTable if the city already exists in deltaTable and if the city doesn\u2019t exist, rows will be inserted in deltaTable , our basic Upsert!", "Delta Lake enables the capability to go back to previous versions of data, the same can be achieved via specifying which version of data to read as:", "Versioning starts from 0, and there will be as many versions of data as there are log commits in the delta_log directory.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F3bad4d50725f&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdelta-lake-in-action-upsert-time-travel-3bad4d50725f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdelta-lake-in-action-upsert-time-travel-3bad4d50725f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdelta-lake-in-action-upsert-time-travel-3bad4d50725f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdelta-lake-in-action-upsert-time-travel-3bad4d50725f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----3bad4d50725f--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----3bad4d50725f--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://mycupoftea00.medium.com/?source=post_page-----3bad4d50725f--------------------------------", "anchor_text": ""}, {"url": "https://mycupoftea00.medium.com/?source=post_page-----3bad4d50725f--------------------------------", "anchor_text": "Jyoti Dhiman"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F8c38262e7804&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdelta-lake-in-action-upsert-time-travel-3bad4d50725f&user=Jyoti+Dhiman&userId=8c38262e7804&source=post_page-8c38262e7804----3bad4d50725f---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F3bad4d50725f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdelta-lake-in-action-upsert-time-travel-3bad4d50725f&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F3bad4d50725f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdelta-lake-in-action-upsert-time-travel-3bad4d50725f&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@goumbik?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Lukas Blazek"}, {"url": "https://unsplash.com/s/photos/time?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://towardsdatascience.com/delta-lake-with-spark-what-and-why-6d08bef7b963", "anchor_text": "article"}, {"url": "https://docs.delta.io/latest/index.html", "anchor_text": "Welcome to the Delta Lake documentationLearn how to use Delta Lake.docs.delta.io"}, {"url": "https://medium.com/tag/data-science?source=post_page-----3bad4d50725f---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/apache-spark?source=post_page-----3bad4d50725f---------------apache_spark-----------------", "anchor_text": "Apache Spark"}, {"url": "https://medium.com/tag/delta-lake?source=post_page-----3bad4d50725f---------------delta_lake-----------------", "anchor_text": "Delta Lake"}, {"url": "https://medium.com/tag/big-data?source=post_page-----3bad4d50725f---------------big_data-----------------", "anchor_text": "Big Data"}, {"url": "https://medium.com/tag/data?source=post_page-----3bad4d50725f---------------data-----------------", "anchor_text": "Data"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F3bad4d50725f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdelta-lake-in-action-upsert-time-travel-3bad4d50725f&user=Jyoti+Dhiman&userId=8c38262e7804&source=-----3bad4d50725f---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F3bad4d50725f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdelta-lake-in-action-upsert-time-travel-3bad4d50725f&user=Jyoti+Dhiman&userId=8c38262e7804&source=-----3bad4d50725f---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F3bad4d50725f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdelta-lake-in-action-upsert-time-travel-3bad4d50725f&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----3bad4d50725f--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F3bad4d50725f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdelta-lake-in-action-upsert-time-travel-3bad4d50725f&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----3bad4d50725f---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----3bad4d50725f--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----3bad4d50725f--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----3bad4d50725f--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----3bad4d50725f--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----3bad4d50725f--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----3bad4d50725f--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----3bad4d50725f--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----3bad4d50725f--------------------------------", "anchor_text": ""}, {"url": "https://mycupoftea00.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://mycupoftea00.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Jyoti Dhiman"}, {"url": "https://mycupoftea00.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "546 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F8c38262e7804&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdelta-lake-in-action-upsert-time-travel-3bad4d50725f&user=Jyoti+Dhiman&userId=8c38262e7804&source=post_page-8c38262e7804--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F1157276dcbca&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdelta-lake-in-action-upsert-time-travel-3bad4d50725f&newsletterV3=8c38262e7804&newsletterV3Id=1157276dcbca&user=Jyoti+Dhiman&userId=8c38262e7804&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}