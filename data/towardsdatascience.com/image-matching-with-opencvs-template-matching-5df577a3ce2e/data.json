{"url": "https://towardsdatascience.com/image-matching-with-opencvs-template-matching-5df577a3ce2e", "time": 1683012284.489524, "path": "towardsdatascience.com/image-matching-with-opencvs-template-matching-5df577a3ce2e/", "webpage": {"metadata": {"title": "Image Matching with OpenCV\u2019s Template Matching | by Aviad Atlas | Towards Data Science", "h1": "Image Matching with OpenCV\u2019s Template Matching", "description": "As a data scientist at VATBox, I\u2019ve mainly worked on projects which at their core involve building Machine Learning models. What\u2019s nice about this project is that it purely includes building an\u2026"}, "outgoing_paragraph_urls": [{"url": "https://docs.opencv.org/master/dc/dc3/tutorial_py_matcher.html", "anchor_text": "features extracted from images", "paragraph_index": 4}, {"url": "https://opencv-python-tutroals.readthedocs.io/en/latest/py_tutorials/py_imgproc/py_template_matching/py_template_matching.html", "anchor_text": "Template Matching", "paragraph_index": 6}, {"url": "https://docs.opencv.org/2.4/doc/tutorials/imgproc/histograms/template_matching/template_matching.html", "anchor_text": "different methods of calculating correlations", "paragraph_index": 8}], "all_paragraphs": ["As a data scientist at VATBox, I\u2019ve mainly worked on projects which at their core involve building Machine Learning models. What\u2019s nice about this project is that it purely includes building an algorithm to solve the given task. A real-world problem with a custom-made solution.", "The problem in hand is essentially matching between two images which are close to being identical (changes can be due to image size, for example). The goal here is to do so in real-time, therefore we need the algorithm to be relatively fast.", "At VATBox our world is a world of invoices. Users upload reports, which contain images of invoices, to our platform. A single report contains two groups of images, one is a collection of separate invoices, and the other is all the collection together in one single file. For reasons which we will not go into, there may be images in one group that won\u2019t appear in the other. The goal is to detect the images which don\u2019t appear in the other group (if there are any). If we match between all the images which are essentially the same image, we can also identify the spare ones.", "So to find the spare images, we need to perform a comparison between every two images (or do we..? we\u2019ll get to that..), one image being from the first group and the other from the second group. Once that is done, we can match between images, and then see which images are left without any match. We can build a Comparison Matrix which holds these comparisons.", "During my research, I mostly encountered solutions that are based on features extracted from images to match between images, but that\u2019s computationally expensive for our case, as we\u2019re interested in doing this for every pair of images. Therefore we are in need of a different approach.", "As described, the images that actually match, are close to being identical. So we can expect their pixel values to be relatively similar. So can we perhaps calculate the correlation between the two given signals? But how can this be done efficiently with images?", "OpenCV has a Template Matching module. The purpose of this module is to find a given template within a (larger) image. The module enables us to \u201cswipe\u201d a template (T) across an image (I) and perform calculations efficiently (similarly to how a convolutional kernel is swiped on an image in a CNN).", "This can be great for our needs! We can use this to swipe an image from the first group on an image of the other group efficently, as OpenCV\u2019s implementation is optimal. Of course, since we\u2019re looking for two images that match (and not a template in another image) the swiping is just done a single time.", "The Template Matching module includes different methods of calculating correlations, one of them being a normalized calculation, returning values between 0 (no similarity) to 1 (completely identical images):", "The indexing shows that we\u2019re accessing a matrix. As mentioned, we\u2019re essentially performing a single swipe, therefore we\u2019re just grabbing the single value from a matrix with a single element.", "A word about the calculation. Prior to the actual correlation calculation, the images are normalized, resulting in a matrix (or tensor) with negative values as well as positive values. When performing the correlation calculation, similar regions will get positive values within the correlation calculation, whereas dissimilar regions will get negative values (resulting in lower correlation).", "Since we\u2019re comparing every pair of images, the complexity of the algorithm is O(n*m), n being the number of images in group one, and m being the number of images in group two. Can we make the algorithm more efficient?", "As the above function returns values close to 1 for similar images, we can set a threshold (e.g. 0.9) for which there\u2019s no need to keep on searching for a match if one is found. In addition, if a match is found, we\u2019ll remove the matched images from our search. For example, if in the first iteration we are comparing an image from group one with 4 images from group two, on the second iteration we\u2019ll do a comparison with only 3 images, and so on.", "In this article, we reviewed a somewhat out of the ordinary real-world data science problem which required a tailor-made solution. We dug into OpenCV\u2019s Template Matching and understood how it can be used to fulfill the requirements of the problem at hand. Hope you enjoyed it!", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F5df577a3ce2e&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimage-matching-with-opencvs-template-matching-5df577a3ce2e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimage-matching-with-opencvs-template-matching-5df577a3ce2e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimage-matching-with-opencvs-template-matching-5df577a3ce2e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimage-matching-with-opencvs-template-matching-5df577a3ce2e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----5df577a3ce2e--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----5df577a3ce2e--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@aviad_94796?source=post_page-----5df577a3ce2e--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@aviad_94796?source=post_page-----5df577a3ce2e--------------------------------", "anchor_text": "Aviad Atlas"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fb9274367accc&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimage-matching-with-opencvs-template-matching-5df577a3ce2e&user=Aviad+Atlas&userId=b9274367accc&source=post_page-b9274367accc----5df577a3ce2e---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F5df577a3ce2e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimage-matching-with-opencvs-template-matching-5df577a3ce2e&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F5df577a3ce2e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimage-matching-with-opencvs-template-matching-5df577a3ce2e&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://icons8.com/", "anchor_text": "icons8.com"}, {"url": "https://docs.opencv.org/master/dc/dc3/tutorial_py_matcher.html", "anchor_text": "features extracted from images"}, {"url": "https://opencv-python-tutroals.readthedocs.io/en/latest/py_tutorials/py_imgproc/py_template_matching/py_template_matching.html", "anchor_text": "Template Matching"}, {"url": "https://www.pexels.com/", "anchor_text": "pexels.com"}, {"url": "https://docs.opencv.org/2.4/doc/tutorials/imgproc/histograms/template_matching/template_matching.html", "anchor_text": "different methods of calculating correlations"}, {"url": "https://medium.com/tag/data-science?source=post_page-----5df577a3ce2e---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/opencv?source=post_page-----5df577a3ce2e---------------opencv-----------------", "anchor_text": "Opencv"}, {"url": "https://medium.com/tag/image-processing?source=post_page-----5df577a3ce2e---------------image_processing-----------------", "anchor_text": "Image Processing"}, {"url": "https://medium.com/tag/algorithms?source=post_page-----5df577a3ce2e---------------algorithms-----------------", "anchor_text": "Algorithms"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F5df577a3ce2e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimage-matching-with-opencvs-template-matching-5df577a3ce2e&user=Aviad+Atlas&userId=b9274367accc&source=-----5df577a3ce2e---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F5df577a3ce2e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimage-matching-with-opencvs-template-matching-5df577a3ce2e&user=Aviad+Atlas&userId=b9274367accc&source=-----5df577a3ce2e---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F5df577a3ce2e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimage-matching-with-opencvs-template-matching-5df577a3ce2e&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----5df577a3ce2e--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F5df577a3ce2e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimage-matching-with-opencvs-template-matching-5df577a3ce2e&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----5df577a3ce2e---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----5df577a3ce2e--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----5df577a3ce2e--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----5df577a3ce2e--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----5df577a3ce2e--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----5df577a3ce2e--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----5df577a3ce2e--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----5df577a3ce2e--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----5df577a3ce2e--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@aviad_94796?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@aviad_94796?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Aviad Atlas"}, {"url": "https://medium.com/@aviad_94796/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "94 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fb9274367accc&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimage-matching-with-opencvs-template-matching-5df577a3ce2e&user=Aviad+Atlas&userId=b9274367accc&source=post_page-b9274367accc--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F5213876fd37a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimage-matching-with-opencvs-template-matching-5df577a3ce2e&newsletterV3=b9274367accc&newsletterV3Id=5213876fd37a&user=Aviad+Atlas&userId=b9274367accc&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}