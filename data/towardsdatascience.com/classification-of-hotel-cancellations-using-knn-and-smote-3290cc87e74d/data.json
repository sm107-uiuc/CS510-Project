{"url": "https://towardsdatascience.com/classification-of-hotel-cancellations-using-knn-and-smote-3290cc87e74d", "time": 1683004848.085856, "path": "towardsdatascience.com/classification-of-hotel-cancellations-using-knn-and-smote-3290cc87e74d/", "webpage": {"metadata": {"title": "Classification of Hotel Cancellations Using KNN and SMOTE | by Michael Grogan | Towards Data Science", "h1": "Classification of Hotel Cancellations Using KNN and SMOTE", "description": "In this particular example, the KNN algorithm is used to classify hotel bookings in terms of cancellation risk (1 = model predicts that the customer will cancel their booking, 0 = customer is not\u2026"}, "outgoing_paragraph_urls": [{"url": "https://github.com/MGCodesandStats/hotel-modelling", "anchor_text": "here", "paragraph_index": 28}, {"url": "http://michael-grogan.com", "anchor_text": "michael-grogan.com", "paragraph_index": 31}], "all_paragraphs": ["In this particular example, the KNN algorithm is used to classify hotel bookings in terms of cancellation risk (1 = model predicts that the customer will cancel their booking, 0 = customer is not predicted to cancel their booking).", "Given that this dataset is unbalanced, i.e. there are more 0s (non-cancellations) than 1s (cancellations), the Synthetic Minority Oversampling Technique (SMOTE) is used to balance the classes in order to apply the KNN algorithm.", "Given the uneven nature of the dataset, it is necessary to oversample the minor class (1 = cancellations) in order to ensure that the KNN results are not skewed towards the major class.", "This can be done by using the SMOTE oversampling technique.", "After having imported and scaled the data using MinMaxScaler, SMOTE can be imported from the imblearn library. Counter is imported for the purposes of summarizing the class distributions.", "Firstly, a train-test split is invoked to separate the data into training and validation data.", "However, after applying the SMOTE oversampling technique, we now see that the number of observations in each class are equal.", "The model is configured as follows:", "The training and test set scores are generated:", "Here is a visual of the training classes versus test predictions as illustrated by the KNN model:", "Here is a breakdown of model performance according to a confusion matrix:", "While overall accuracy is quite low at 46%, recall according to the f1-score is reasonably good at 84%.", "When working with classification data, one must also pay attention to the precision versus recall readings, as opposed to simply overall accuracy.", "The two readings are often at odds with each other, i.e. it is often not possible to increase precision without reducing recall, and vice versa.", "An assessment as to the ideal metric to use depends in large part on the specific data under analysis. For example, cancer detection screenings that have false negatives (i.e. indicating patients do not have cancer when in fact they do), is a big no-no. Under this scenario, recall is the ideal metric.", "However, for emails \u2014 one might prefer to avoid false positives, i.e. sending an important email to the spam folder when in fact it is legitimate.", "The f1-score takes both precision and recall into account when devising a more general score.", "Which would be more important for predicting hotel cancellations?", "Well, from the point of view of a hotel \u2014 they would likely wish to identify customers who are ultimately going to cancel their booking with greater accuracy \u2014 this allows the hotel to better allocate rooms and resources. Identifying customers who are not going to cancel their bookings may not necessarily add value to the hotel\u2019s analysis, as the hotel knows that a significant proportion of customers will ultimately follow through with their bookings in any case.", "Let us see how the results look when the model makes predictions on H2 (the test set).", "Here, we see that the f1-score accuracy has increased slightly to 52%.", "However, the recall for the cancellation class (1) stands at 86%. As mentioned, precision and recall are often at odds with each other simply due to the fact that false positives tend to increase recall, while false negatives tend to increase precision.", "Assuming that the hotel would like to maximise recall (i.e. tolerate a certain number of false positives while at the same time identifying all customers who will cancel their booking), then this model meets that criteria.", "Of all customers who cancel their booking, this model correctly identifies 86% of those customers.", "While a higher recall is assumed to be a better way to judge this model, this cannot necessarily come at the expense of lower accuracy.", "If recall is penalising false negatives, then it is also favouring false positives \u2014 having too many false positives defeats the purpose of the model \u2014 as this is essentially assuming that all customers will cancel, which is not the case.", "In this regard, accuracy and recall would ideally be maximised. For instance, an XGBoost model demonstrated a recall of 94% with an f1-score accuracy of 55% \u2014 both of which were slightly higher than in this example.", "In this example, we have examined how to use KNN as a classification algorithm, as well as the importance of precision versus recall in judging model performance.", "Many thanks for your time, and the associated GitHub repository for this example can be found here.", "Disclaimer: This article is written on an \u201cas is\u201d basis and without warranty. It was written with the intention of providing an overview of data science concepts, and should not be interpreted as professional advice in any way.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Science Consultant with expertise in economics, time series analysis, and Bayesian methods | michael-grogan.com"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F3290cc87e74d&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fclassification-of-hotel-cancellations-using-knn-and-smote-3290cc87e74d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fclassification-of-hotel-cancellations-using-knn-and-smote-3290cc87e74d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fclassification-of-hotel-cancellations-using-knn-and-smote-3290cc87e74d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fclassification-of-hotel-cancellations-using-knn-and-smote-3290cc87e74d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----3290cc87e74d--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----3290cc87e74d--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://mgcodesandstats.medium.com/?source=post_page-----3290cc87e74d--------------------------------", "anchor_text": ""}, {"url": "https://mgcodesandstats.medium.com/?source=post_page-----3290cc87e74d--------------------------------", "anchor_text": "Michael Grogan"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Feec017a8b178&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fclassification-of-hotel-cancellations-using-knn-and-smote-3290cc87e74d&user=Michael+Grogan&userId=eec017a8b178&source=post_page-eec017a8b178----3290cc87e74d---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F3290cc87e74d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fclassification-of-hotel-cancellations-using-knn-and-smote-3290cc87e74d&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F3290cc87e74d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fclassification-of-hotel-cancellations-using-knn-and-smote-3290cc87e74d&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://github.com/MGCodesandStats/hotel-modelling", "anchor_text": "here"}, {"url": "https://www.sciencedirect.com/science/article/pii/S2352340918315191", "anchor_text": "Antonio, Almedia and Nunes (2019). Hotel Booking Demand Datasets"}, {"url": "https://github.com/Msanjayds/Scikit-learn/blob/master/CrossValidation.ipynb", "anchor_text": "GitHub repository (Msanjayds): Cross-Validation calculation"}, {"url": "https://machinelearningmastery.com/smote-oversampling-for-imbalanced-classification/", "anchor_text": "Machine Learning Mastery: SMOTE Oversampling for Imbalanced Classification with Python"}, {"url": "https://medium.com/tag/data-science?source=post_page-----3290cc87e74d---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----3290cc87e74d---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/knn?source=post_page-----3290cc87e74d---------------knn-----------------", "anchor_text": "Knn"}, {"url": "https://medium.com/tag/classification?source=post_page-----3290cc87e74d---------------classification-----------------", "anchor_text": "Classification"}, {"url": "https://medium.com/tag/hotel-booking?source=post_page-----3290cc87e74d---------------hotel_booking-----------------", "anchor_text": "Hotel Booking"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F3290cc87e74d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fclassification-of-hotel-cancellations-using-knn-and-smote-3290cc87e74d&user=Michael+Grogan&userId=eec017a8b178&source=-----3290cc87e74d---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F3290cc87e74d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fclassification-of-hotel-cancellations-using-knn-and-smote-3290cc87e74d&user=Michael+Grogan&userId=eec017a8b178&source=-----3290cc87e74d---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F3290cc87e74d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fclassification-of-hotel-cancellations-using-knn-and-smote-3290cc87e74d&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----3290cc87e74d--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F3290cc87e74d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fclassification-of-hotel-cancellations-using-knn-and-smote-3290cc87e74d&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----3290cc87e74d---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----3290cc87e74d--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----3290cc87e74d--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----3290cc87e74d--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----3290cc87e74d--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----3290cc87e74d--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----3290cc87e74d--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----3290cc87e74d--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----3290cc87e74d--------------------------------", "anchor_text": ""}, {"url": "https://mgcodesandstats.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://mgcodesandstats.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Michael Grogan"}, {"url": "https://mgcodesandstats.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "1.5K Followers"}, {"url": "http://michael-grogan.com", "anchor_text": "michael-grogan.com"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Feec017a8b178&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fclassification-of-hotel-cancellations-using-knn-and-smote-3290cc87e74d&user=Michael+Grogan&userId=eec017a8b178&source=post_page-eec017a8b178--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F3c6e2607915&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fclassification-of-hotel-cancellations-using-knn-and-smote-3290cc87e74d&newsletterV3=eec017a8b178&newsletterV3Id=3c6e2607915&user=Michael+Grogan&userId=eec017a8b178&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}