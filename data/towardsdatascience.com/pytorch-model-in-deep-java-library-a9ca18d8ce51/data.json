{"url": "https://towardsdatascience.com/pytorch-model-in-deep-java-library-a9ca18d8ce51", "time": 1683016199.9763079, "path": "towardsdatascience.com/pytorch-model-in-deep-java-library-a9ca18d8ce51/", "webpage": {"metadata": {"title": "Pytorch model in Deep Java Library | by Shantanu Bhattacharyya | Towards Data Science", "h1": "Pytorch model in Deep Java Library", "description": "PyTorch is a fast growing and very popular open source Machine Learning framework. Its imperative design combined with \u201cnumpy\u201d like workflow makes it a compelling first choice for beginners and\u2026"}, "outgoing_paragraph_urls": [{"url": "https://ai.facebook.com/tools/pytorch/", "anchor_text": "PyTorch", "paragraph_index": 0}, {"url": "https://docs.djl.ai/docs/quick_start.html", "anchor_text": "Deep Java Library", "paragraph_index": 1}, {"url": "https://github.com/bhattacharyya/DJL_Pytorch_Demo", "anchor_text": "here", "paragraph_index": 1}, {"url": "https://pytorch.org/tutorials/beginner/Intro_to_TorchScript_tutorial.html", "anchor_text": "TorchScript", "paragraph_index": 5}, {"url": "https://github.com/SpencerPark/IJava", "anchor_text": "Java kernel", "paragraph_index": 5}, {"url": "https://towardsdatascience.com/ndarray-a-java-based-n-dim-array-toolkit-60b4035b10b8", "anchor_text": "ndarray", "paragraph_index": 9}, {"url": "https://javadoc.io/doc/ai.djl/api/0.4.1/ai/djl/translate/PreProcessor.html", "anchor_text": "PreProcessor", "paragraph_index": 16}, {"url": "https://javadoc.io/doc/ai.djl/api/0.4.1/ai/djl/translate/PostProcessor.html", "anchor_text": "post processing", "paragraph_index": 18}], "all_paragraphs": ["PyTorch is a fast growing and very popular open source Machine Learning framework. Its imperative design combined with \u201cnumpy\u201d like workflow makes it a compelling first choice for beginners and professionals alike. However, serving these model in production is not straightforward and things are particularly difficult if the goal is to serve them natively in Java.", "Amazon\u2019s Deep Java Library (DJL) aims to solve this particular pain point by providing high level APIs that can run inference on PyTorch models with very little code. My recent test drive with DJL tells me that it could be a very powerful tool but the existing example set and community guidance (aka stackoverflow help :) ) could be a little intimidating for new folks, specially those who come from python background and are unfamiliar with the java style. This simple demo, hopefully, makes things easier for them. All the scripts are also available at my git repo here.", "Let\u2019s start by creating a simple linear regression model with PyTorch.", "The model (model1) learns to take an input n and predict 2 * n.", "There are 2 lines in the script above that are usually not present in PyTorch scripts.", "These two lines are required to create a TorchScript model (serialized pytorch model) that can be used in a language agnostic fashion in high performance environments. We will now use this model to make inference using DJL. I have used a Jupyter notebook running Java kernel for this demo.", "1 : Get all the required maven dependencies. DJL supports pytorch models out of the box. SLF4J is for logging purposes.", "If you get errors that say \u201cunknown resolver null\u201d, you can ignore them for now.", "2 : Import the required modules", "It is worth highlighting the ndarray import here. N-Dimensional array is a popular data structure in many languages and numpy (ndarray library in python) is pretty much ubiquitous in the field of deep learning or pretty much any application involving numerical computation.", "Java doesn\u2019t have a similar ndarray implementation. DJL provides the ndarray functionality through the above import. This is one of the key factors that allows DJL to work with PyTorch models.", "3. Declare path to model and model name. This assumes you are using a locally generated model. DJL provides some standard models too that can be used directly.", "Current DJL documentation says models can be .zip , .tar, .tar.gz, .tgz or .tar.z", "If the model is correctly loaded, you should see an output like ai.djl.pytorch.engine.PtModel@4cefa68f", "4. Translator to handle the pre-processing and post-processing steps.", "This is the step that confuses most people. The translator defines the signature for the input and output data types <Input type, Output type>. For our example they both happen to be a float. Make sure to use Float, not float, as a reference is explicitly expected. This translation step is not optional.", "Further, if you look at the DJL doc for PreProcessor , you will find that NDList is the expected type for the preprocessing output that gets fed to the model.", "So, even if your input was hypothetically already an NDList type, you still need to do this step.", "The case for post processing is similar. It consumes the NDList and outputs the type described by your Translator.", "All the three overides above are mandatory as well. There are of\u2019course pre-implemented translators provided by DJL and I recommend you to explore them, particularly the image processing ones.", "Congratulations, you have done the hard work and are just a couple of lines of code away from making the inference. Here they are", "So we saw how we can create a PyTorch model and use that model for inference in a Java environment. This was a very simplistic use case though. For more advanced use cases, making the translator do the preprocessing and postprocessing correctly could require a few iterations. Further, the number of inbuilt modules (like the image processing ones) are currently few in number.", "I am confident though, that DJL will evolve rapidly and could be the perfect library to utilise PyTorch models in Java (or C++) environment giving the perfect combination of development speed and high performance.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data scientist | Erstwhile Structural Biologist | Foodie | Bookworm"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fa9ca18d8ce51&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpytorch-model-in-deep-java-library-a9ca18d8ce51&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpytorch-model-in-deep-java-library-a9ca18d8ce51&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpytorch-model-in-deep-java-library-a9ca18d8ce51&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpytorch-model-in-deep-java-library-a9ca18d8ce51&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----a9ca18d8ce51--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----a9ca18d8ce51--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@stringconstant0?source=post_page-----a9ca18d8ce51--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@stringconstant0?source=post_page-----a9ca18d8ce51--------------------------------", "anchor_text": "Shantanu Bhattacharyya"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F189f7f265a97&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpytorch-model-in-deep-java-library-a9ca18d8ce51&user=Shantanu+Bhattacharyya&userId=189f7f265a97&source=post_page-189f7f265a97----a9ca18d8ce51---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa9ca18d8ce51&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpytorch-model-in-deep-java-library-a9ca18d8ce51&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa9ca18d8ce51&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpytorch-model-in-deep-java-library-a9ca18d8ce51&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@max_duz?utm_source=medium&utm_medium=referral", "anchor_text": "Max Duzij"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://ai.facebook.com/tools/pytorch/", "anchor_text": "PyTorch"}, {"url": "https://docs.djl.ai/docs/quick_start.html", "anchor_text": "Deep Java Library"}, {"url": "https://github.com/bhattacharyya/DJL_Pytorch_Demo", "anchor_text": "here"}, {"url": "https://pytorch.org/tutorials/beginner/Intro_to_TorchScript_tutorial.html", "anchor_text": "TorchScript"}, {"url": "https://github.com/SpencerPark/IJava", "anchor_text": "Java kernel"}, {"url": "https://towardsdatascience.com/ndarray-a-java-based-n-dim-array-toolkit-60b4035b10b8", "anchor_text": "ndarray"}, {"url": "http://twitter.com/Override", "anchor_text": "@"}, {"url": "https://javadoc.io/doc/ai.djl/api/0.4.1/ai/djl/translate/PreProcessor.html", "anchor_text": "PreProcessor"}, {"url": "https://javadoc.io/doc/ai.djl/api/0.4.1/ai/djl/translate/PostProcessor.html", "anchor_text": "post processing"}, {"url": "https://medium.com/tag/pytorch?source=post_page-----a9ca18d8ce51---------------pytorch-----------------", "anchor_text": "Pytorch"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----a9ca18d8ce51---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/aws?source=post_page-----a9ca18d8ce51---------------aws-----------------", "anchor_text": "AWS"}, {"url": "https://medium.com/tag/java?source=post_page-----a9ca18d8ce51---------------java-----------------", "anchor_text": "Java"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----a9ca18d8ce51---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fa9ca18d8ce51&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpytorch-model-in-deep-java-library-a9ca18d8ce51&user=Shantanu+Bhattacharyya&userId=189f7f265a97&source=-----a9ca18d8ce51---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fa9ca18d8ce51&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpytorch-model-in-deep-java-library-a9ca18d8ce51&user=Shantanu+Bhattacharyya&userId=189f7f265a97&source=-----a9ca18d8ce51---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa9ca18d8ce51&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpytorch-model-in-deep-java-library-a9ca18d8ce51&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----a9ca18d8ce51--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fa9ca18d8ce51&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpytorch-model-in-deep-java-library-a9ca18d8ce51&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----a9ca18d8ce51---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----a9ca18d8ce51--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----a9ca18d8ce51--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----a9ca18d8ce51--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----a9ca18d8ce51--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----a9ca18d8ce51--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----a9ca18d8ce51--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----a9ca18d8ce51--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----a9ca18d8ce51--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@stringconstant0?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@stringconstant0?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Shantanu Bhattacharyya"}, {"url": "https://medium.com/@stringconstant0/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "23 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F189f7f265a97&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpytorch-model-in-deep-java-library-a9ca18d8ce51&user=Shantanu+Bhattacharyya&userId=189f7f265a97&source=post_page-189f7f265a97--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fusers%2F189f7f265a97%2Flazily-enable-writer-subscription&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpytorch-model-in-deep-java-library-a9ca18d8ce51&user=Shantanu+Bhattacharyya&userId=189f7f265a97&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}