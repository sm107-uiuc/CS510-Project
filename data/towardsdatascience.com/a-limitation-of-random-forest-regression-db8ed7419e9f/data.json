{"url": "https://towardsdatascience.com/a-limitation-of-random-forest-regression-db8ed7419e9f", "time": 1683002142.6661918, "path": "towardsdatascience.com/a-limitation-of-random-forest-regression-db8ed7419e9f/", "webpage": {"metadata": {"title": "A limitation of Random Forest Regression | by Ben Thompson | Towards Data Science", "h1": "A limitation of Random Forest Regression", "description": "Random Forest is a powerful model, but in a regression problem the predictions it can make are bounded by the highest and lowest labels in the training data."}, "outgoing_paragraph_urls": [{"url": "https://en.wikipedia.org/wiki/Random_forest", "anchor_text": "Random Forest", "paragraph_index": 0}, {"url": "https://en.wikipedia.org/wiki/K-nearest_neighbors_algorithm", "anchor_text": "KNN", "paragraph_index": 0}, {"url": "https://www.analyticsvidhya.com/blog/2017/07/covariate-shift-the-hidden-problem-of-real-world-data-science/", "anchor_text": "covariate shift", "paragraph_index": 0}, {"url": "https://cran.r-project.org/web/packages/Cubist/vignettes/cubist.html", "anchor_text": "Cubist", "paragraph_index": 5}], "all_paragraphs": ["Random Forest is a popular machine learning model that is commonly used for classification tasks as can be seen in many academic papers, Kaggle competitions, and blog posts. In addition to classification, Random Forests can also be used for regression tasks. A Random Forest\u2019s nonlinear nature can give it a leg up over linear algorithms, making it a great option. However, it is important to know your data and keep in mind that a Random Forest can\u2019t extrapolate. It can only make a prediction that is an average of previously observed labels. In this sense it is very similar to KNN. In other words, in a regression problem, the range of predictions a Random Forest can make is bound by the highest and lowest labels in the training data. This behavior becomes problematic in situations where the training and prediction inputs differ in their range and/or distributions. This is called covariate shift and it is difficult for most models to handle but especially for Random Forest, because it can\u2019t extrapolate.", "For example, let\u2019s say that you\u2019re working with data that has an underlying trend over time such as stock prices, home values or sales. If you\u2019re training data is missing any time periods, your Random Forest model will under or over predict, depending on the trend, examples outside of the time frames in your training data. This will be very noticeable if you plot your model\u2019s predictions against their true values. Let\u2019s take a look at this by creating some data.", "Let\u2019s see how well a Random Forest can predict the test data.", "That\u2019s not very good. Let\u2019s plot our predictions against their known values to see what is going on.", "This plot makes it clear that the highest value the model can predict is around 961, while the underlying trend in the data pushes more recent values as high as 966. Unfortunately, the Random Forest can\u2019t extrapolate the linear trend and accurately predict new examples that have a time value higher than that seen in the training data (2000\u20132010). Even adjusting the number of trees doesn\u2019t fix the problem. In this situation, since we forced a perfectly linear relationship on the data, a model like Linear Regression would be a better choice and will have no problem detecting the trend in the data and making accurate predictions for data outside of the time ranges in the training data.", "While Random Forest is often an excellent choice of model, it is still important to know how it works, and if it might have any limitations given your data. In this case, because it is a neighborhood based model it prevented us from making accurate predictions for time frames outside of our training data. If you find yourself in such a situation it would be best to test other models, such Linear Regression or Cubist, and/or consider using the Random Forest in an ensemble of models. Happy predicting!", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fdb8ed7419e9f&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-limitation-of-random-forest-regression-db8ed7419e9f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-limitation-of-random-forest-regression-db8ed7419e9f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-limitation-of-random-forest-regression-db8ed7419e9f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-limitation-of-random-forest-regression-db8ed7419e9f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----db8ed7419e9f--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----db8ed7419e9f--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@ben.thompson.j?source=post_page-----db8ed7419e9f--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@ben.thompson.j?source=post_page-----db8ed7419e9f--------------------------------", "anchor_text": "Ben Thompson"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F242e4dc3e8b3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-limitation-of-random-forest-regression-db8ed7419e9f&user=Ben+Thompson&userId=242e4dc3e8b3&source=post_page-242e4dc3e8b3----db8ed7419e9f---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fdb8ed7419e9f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-limitation-of-random-forest-regression-db8ed7419e9f&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fdb8ed7419e9f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-limitation-of-random-forest-regression-db8ed7419e9f&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://en.wikipedia.org/wiki/Random_forest", "anchor_text": "Random Forest"}, {"url": "https://en.wikipedia.org/wiki/K-nearest_neighbors_algorithm", "anchor_text": "KNN"}, {"url": "https://www.analyticsvidhya.com/blog/2017/07/covariate-shift-the-hidden-problem-of-real-world-data-science/", "anchor_text": "covariate shift"}, {"url": "https://cran.r-project.org/web/packages/Cubist/vignettes/cubist.html", "anchor_text": "Cubist"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----db8ed7419e9f---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/random-forest?source=post_page-----db8ed7419e9f---------------random_forest-----------------", "anchor_text": "Random Forest"}, {"url": "https://medium.com/tag/cubist?source=post_page-----db8ed7419e9f---------------cubist-----------------", "anchor_text": "Cubist"}, {"url": "https://medium.com/tag/linear-regression?source=post_page-----db8ed7419e9f---------------linear_regression-----------------", "anchor_text": "Linear Regression"}, {"url": "https://medium.com/tag/covariate-shift?source=post_page-----db8ed7419e9f---------------covariate_shift-----------------", "anchor_text": "Covariate Shift"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fdb8ed7419e9f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-limitation-of-random-forest-regression-db8ed7419e9f&user=Ben+Thompson&userId=242e4dc3e8b3&source=-----db8ed7419e9f---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fdb8ed7419e9f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-limitation-of-random-forest-regression-db8ed7419e9f&user=Ben+Thompson&userId=242e4dc3e8b3&source=-----db8ed7419e9f---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fdb8ed7419e9f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-limitation-of-random-forest-regression-db8ed7419e9f&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----db8ed7419e9f--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fdb8ed7419e9f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-limitation-of-random-forest-regression-db8ed7419e9f&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----db8ed7419e9f---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----db8ed7419e9f--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----db8ed7419e9f--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----db8ed7419e9f--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----db8ed7419e9f--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----db8ed7419e9f--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----db8ed7419e9f--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----db8ed7419e9f--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----db8ed7419e9f--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@ben.thompson.j?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@ben.thompson.j?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Ben Thompson"}, {"url": "https://medium.com/@ben.thompson.j/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "22 Followers"}, {"url": "https://www.linkedin.com/in/benthompsonj/", "anchor_text": "https://www.linkedin.com/in/benthompsonj/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F242e4dc3e8b3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-limitation-of-random-forest-regression-db8ed7419e9f&user=Ben+Thompson&userId=242e4dc3e8b3&source=post_page-242e4dc3e8b3--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fusers%2F242e4dc3e8b3%2Flazily-enable-writer-subscription&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-limitation-of-random-forest-regression-db8ed7419e9f&user=Ben+Thompson&userId=242e4dc3e8b3&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}