{"url": "https://towardsdatascience.com/whats-in-the-black-box-8f36b262362e", "time": 1682996520.7767942, "path": "towardsdatascience.com/whats-in-the-black-box-8f36b262362e/", "webpage": {"metadata": {"title": "What\u2019s in the Black Box?. A distillation of \u201dCausal\u2026 | by Werlindo Mangrobang | Towards Data Science", "h1": "What\u2019s in the Black Box?", "description": "You may be familiar with the authors of \u201cCausal Interpretations of Black-Box Models\u201d \u2014 Qingyuan Zhao and Trevor Hastie \u2014 particular Trevor Hastie. Perhaps this rings a bell?: It certainly did for me\u2026"}, "outgoing_paragraph_urls": [{"url": "http://www-bcf.usc.edu/~gareth/ISL/", "anchor_text": "this", "paragraph_index": 0}, {"url": "http://ww.web.stanford.edu/~hastie/Papers/Glmnet_Vignette.pdf", "anchor_text": "docs", "paragraph_index": 1}, {"url": "https://www.cnbc.com/2017/10/04/students-who-work-actually-get-better-grades-but-theres-a-catch.html", "anchor_text": "financial support", "paragraph_index": 13}, {"url": "https://christophm.github.io/interpretable-ml-book/pdp.html", "anchor_text": "partial dependence plot", "paragraph_index": 14}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.datasets.load_boston.html", "anchor_text": "Boston housing dataset", "paragraph_index": 16}, {"url": "https://www.kaggle.com/c/boston-housing", "anchor_text": "rest of the available features", "paragraph_index": 16}, {"url": "https://christophm.github.io/interpretable-ml-book/ice.html", "anchor_text": "Individual Conditional Expectation", "paragraph_index": 18}, {"url": "https://archive.ics.uci.edu/ml/datasets/auto+mpg", "anchor_text": "auto mpg", "paragraph_index": 24}, {"url": "https://www.linkedin.com/in/werlindo/", "anchor_text": "LinkedIn", "paragraph_index": 33}, {"url": "https://github.com/MangrobanGit", "anchor_text": "GitHub", "paragraph_index": 33}], "all_paragraphs": ["You may be familiar with the authors of \u201cCausal Interpretations of Black-Box Models\u201d \u2014 Qingyuan Zhao and Trevor Hastie \u2014 particular Trevor Hastie. Perhaps this rings a bell?:", "It certainly did for me, as this text was one of my first entry points to learning data science. You may also remember Hastie\u2019s name from reading the docs of the glmnet package as you tried to figure out what the heck went wrong with your R code. Or that might have just been me.", "It was because of this that I was curious to read Zhao and Hastie\u2019s paper. The following is what I learned!", "Machine learning (ML) models, while having surpassed parametric models in predictive performance, have the downside of being considered to be black boxes by non-technical users; their relative opacity makes them hard to interpret. Consider the figure below:", "The \u2018nature\u2019 of the model is \u2018boxed\u2019 up, out of view of its users and customers. That\u2019s important because a core question is: What features are important to the output(s) of the model? Figuring that out is hard when you can\u2019t easily \u2018see\u2019 what\u2019s happening in your model.", "Zhao and Hastie talk about three ideas related to feature importance :", "If we are able to make an intervention on Xj (change the value of Xj from a to b with the other variables fixed), how much will the value of Y change?", "The stated goal of their paper then is to:", "\u2026explain when and how we can make causal interpretations after fitting black-box models.", "Zhao and Hastie use the example of grades and study hours to demonstrate the concept of causality. Let\u2019s consider a formula where:", "This makes intuitive sense to us: generally, the more hours you study, the better grades you get. In other words, one might argue that studying more hours causes higher grades.", "What about the other way around? What if all we had were the grades students received? With some manipulation of the above, we could arrive at something like:", "Does this mean that if a teacher gives a student an \u2018A\u2019 instead of a \u2018B\u2019 the student will study more hours? Of course not!", "For instance, in the grades formula above, perhaps we added another feature, hours worked (at a job outside of school). If we broadly assume that the working hours are necessary for financial support, then the working hours would likely have a causal effect on study hours, and not vice versa. Therefore, hours studied would be a causal descendent of hours worked.", "One tool that is useful for causal interpretation is the partial dependence plot (PDP). They are used to glean a feature\u2019s marginal impact on the model\u2019s predicted outcomes. To massively simplify, we can think of it as just plotting the average predicted outcome (vertical axis) for each potential value of a feature (horizontal axis). And for a PDP to be useful for causal inference, the variable in question can\u2019t have any other variables between it and the target variable be a causal descendent. Otherwise, interactions with any descendants can cloud interpretation.", "For example, the following PDP shows that average predicted bike rentals generally go up with higher temperatures.", "Let\u2019s dive into another example using that old chestnut, the Boston housing dataset. The dataset presents a target of median home value in Boston (MEDV) and several features, such as per capita crime rate by town (CRIM) and nitric oxides concentration (NOX, in parts per 10 million (pp10m)). It doesn\u2019t take much domain expertise to inspect these and the rest of the available features to conclude that none could reasonably be a causal descendant of NOX. It\u2019s more likely that NOX is affected by one or more of the other features \u2014 \u201cthe proportion of non-retail business acres per town\u201d (INDUS), for one \u2014 than for NOX to affect INDUS. This assumption allows us to use a PDP for causal inference:", "Note that this plot centers on the vertical axis to mean=0. What we may infer from the above is that median home prices seem to be insensitive to NOX levels until around 0.67 pp10m, at which median home levels drop by about $2,000.", "But what if we are unsure of the causal direction of our features? One tool that can help is an Individual Conditional Expectation (ICE) plot. Instead of plotting the average prediction based on the value of a feature, it plots a line for each observation across possible values of the feature. Let\u2019s dig into ICE plots by revisiting our NOX example.", "This ICE plot seems to support what we saw with the PDP: the individual curves all appear to be similar in shape and direction, and like before, drop down in \u2018level\u2019 around NOX = 0.67.", "But we already theorized earlier that NOX is a causal descendent of one or more of the other features in the dataset, so the ICE plot only serves to confirm what the PDP showed.", "What if we explored a different feature, \u201cweighted distances to five Boston employment centers\u201d (DIS)? One may argue that a feature such as CRIM, could be a causal descendant of DIS. If we look at an ICE plot for DIS:", "We find a mix of patterns! At higher levels of MEDV, there is a downward trend as DIS increases. However! At lower levels of MEDV, we observe some curves showing DIS having a brief positive effect on MEDV, up to around DIS=2 or so, and then becoming a negative effect.", "The takeaway is that the ICE plot helps us identify that this feature is likely indirectly affecting the target, due to interactions with one or more other features.", "For another application of ICE plots, let us consider an example using the ubiquitous \u201cauto mpg\u201d dataset. The following plot shows that acceleration has some causal effect on MPG, but likely through interactions with other features.", "Notice the difference in the behavior of the lines at the top (somewhat increasing in MPG), middle (decreasing), and lower third (increasing again) of the plot!", "If we look at the other features in the dataset, we find one for origin, which is the geographical origin of the auto. This feature is arguably a causal ancestor of all features \u2014 you need to have a place to build the car before you can build it! (A gross oversimplification, I know, but still). Being as such, it will likely have many interactions involved with its causal relationship with MPG.", "Can ICE plots still be useful here, even though the feature is \u2018far upstream\u2019? You bet! Let\u2019s start with looking at a trusty boxplot:", "This plot shows a very noticeable difference in MPG between autos from these three regions. But does this tell the whole story?", "Consider the following two ICE plots. The first shows [US (1) or Europe(0)] versus MPG:", "\u2026 and the second shows [Japan (1) or Europe(0)] versus MPG", "While at first, via the boxplot, it seemed that there is a significant difference in MPG attributable to origin, the ICE plots show that the pure impact might be a little smaller when considering interactions with other features: the slope for the majority of these lines are flatter than the boxplot would have us imagine.", "When dealing with so-called black-box algorithms, we need to use smart methods to interpret the results. One point of view to do that is through inferring causality. Some tools can help with that:", "Please feel free to reach out! | LinkedIn | GitHub", "James, Gareth, et al. An Introduction to Statistical Learning: with Applications in R. Springer, 2017.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F8f36b262362e&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhats-in-the-black-box-8f36b262362e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhats-in-the-black-box-8f36b262362e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhats-in-the-black-box-8f36b262362e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhats-in-the-black-box-8f36b262362e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----8f36b262362e--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----8f36b262362e--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@werlindo?source=post_page-----8f36b262362e--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@werlindo?source=post_page-----8f36b262362e--------------------------------", "anchor_text": "Werlindo Mangrobang"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fb4007413e9e6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhats-in-the-black-box-8f36b262362e&user=Werlindo+Mangrobang&userId=b4007413e9e6&source=post_page-b4007413e9e6----8f36b262362e---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F8f36b262362e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhats-in-the-black-box-8f36b262362e&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F8f36b262362e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhats-in-the-black-box-8f36b262362e&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "http://web.stanford.edu/~hastie/Papers/pdp_zhao_final.pdf", "anchor_text": "\u201dCausal Interpretations of Black-Box Models\u201d by Zhao and Hastie"}, {"url": "https://unsplash.com/@christianfregnan?utm_source=medium&utm_medium=referral", "anchor_text": "Christian Fregnan"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "http://www-bcf.usc.edu/~gareth/ISL/", "anchor_text": "this"}, {"url": "http://ww.web.stanford.edu/~hastie/Papers/Glmnet_Vignette.pdf", "anchor_text": "docs"}, {"url": "http://web.stanford.edu/~hastie/Papers/pdp_zhao_final.pdf", "anchor_text": "http://web.stanford.edu/~hastie/Papers/pdp_zhao_final.pdf"}, {"url": "https://www.theanalysisfactor.com/interpreting-regression-coefficients/", "anchor_text": "beta coefficients"}, {"url": "https://christophm.github.io/interpretable-ml-book/feature-importance.html", "anchor_text": "measure the \u2018importance\u2019"}, {"url": "https://www.cnbc.com/2017/10/04/students-who-work-actually-get-better-grades-but-theres-a-catch.html", "anchor_text": "financial support"}, {"url": "https://christophm.github.io/interpretable-ml-book/pdp.html", "anchor_text": "partial dependence plot"}, {"url": "https://christophm.github.io/interpretable-ml-book/pdp.html", "anchor_text": "https://christophm.github.io/interpretable-ml-book/pdp.html"}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.datasets.load_boston.html", "anchor_text": "Boston housing dataset"}, {"url": "https://www.kaggle.com/c/boston-housing", "anchor_text": "rest of the available features"}, {"url": "https://en.wikipedia.org/wiki/Nitric_oxide", "anchor_text": "NO"}, {"url": "https://christophm.github.io/interpretable-ml-book/ice.html", "anchor_text": "Individual Conditional Expectation"}, {"url": "https://archive.ics.uci.edu/ml/datasets/auto+mpg", "anchor_text": "auto mpg"}, {"url": "https://github.com/MangrobanGit/blog_black_box", "anchor_text": "here"}, {"url": "https://www.linkedin.com/in/werlindo/", "anchor_text": "LinkedIn"}, {"url": "https://github.com/MangrobanGit", "anchor_text": "GitHub"}, {"url": "https://christophm.github.io/interpretable-ml-book/", "anchor_text": "https://christophm.github.io/interpretable-ml-book"}, {"url": "http://web.stanford.edu/~hastie/Papers/pdp_zhao_final.pdf", "anchor_text": "http://web.stanford.edu/~hastie/Papers/pdp_zhao_final.pdf"}, {"url": "https://medium.com/tag/data-science?source=post_page-----8f36b262362e---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/partial-dependence-plots?source=post_page-----8f36b262362e---------------partial_dependence_plots-----------------", "anchor_text": "Partial Dependence Plots"}, {"url": "https://medium.com/tag/ice-plots?source=post_page-----8f36b262362e---------------ice_plots-----------------", "anchor_text": "Ice Plots"}, {"url": "https://medium.com/tag/python?source=post_page-----8f36b262362e---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/towards-data-science?source=post_page-----8f36b262362e---------------towards_data_science-----------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F8f36b262362e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhats-in-the-black-box-8f36b262362e&user=Werlindo+Mangrobang&userId=b4007413e9e6&source=-----8f36b262362e---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F8f36b262362e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhats-in-the-black-box-8f36b262362e&user=Werlindo+Mangrobang&userId=b4007413e9e6&source=-----8f36b262362e---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F8f36b262362e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhats-in-the-black-box-8f36b262362e&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----8f36b262362e--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F8f36b262362e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhats-in-the-black-box-8f36b262362e&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----8f36b262362e---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----8f36b262362e--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----8f36b262362e--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----8f36b262362e--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----8f36b262362e--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----8f36b262362e--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----8f36b262362e--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----8f36b262362e--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----8f36b262362e--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@werlindo?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@werlindo?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Werlindo Mangrobang"}, {"url": "https://medium.com/@werlindo/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "68 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fb4007413e9e6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhats-in-the-black-box-8f36b262362e&user=Werlindo+Mangrobang&userId=b4007413e9e6&source=post_page-b4007413e9e6--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F76ab9b43e740&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhats-in-the-black-box-8f36b262362e&newsletterV3=b4007413e9e6&newsletterV3Id=76ab9b43e740&user=Werlindo+Mangrobang&userId=b4007413e9e6&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}