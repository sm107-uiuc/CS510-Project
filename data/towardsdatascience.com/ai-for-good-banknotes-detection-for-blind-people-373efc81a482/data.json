{"url": "https://towardsdatascience.com/ai-for-good-banknotes-detection-for-blind-people-373efc81a482", "time": 1683000135.432406, "path": "towardsdatascience.com/ai-for-good-banknotes-detection-for-blind-people-373efc81a482/", "webpage": {"metadata": {"title": "AI for good: Banknotes detection for blind people | by Bruno S\u00e1nchez-A Nu\u00f1o | Towards Data Science", "h1": "AI for good: Banknotes detection for blind people", "description": "This service recognizes what currency a banknote is (euro or usd dollar) and what denomination (5,10,20, \u2026). The social impact purpose is to help blind people, so I took care to make \u201creal-life\u201d\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.fast.ai/", "anchor_text": "fast.ai", "paragraph_index": 1}, {"url": "https://forums.fast.ai/t/share-your-work-here", "anchor_text": "On their online forum", "paragraph_index": 1}, {"url": "http://iris.brunosan.eu", "anchor_text": "iris.brunosan.eu", "paragraph_index": 2}, {"url": "https://www.sciencedirect.com/science/article/pii/S1319157816300416", "anchor_text": "Computer Vision", "paragraph_index": 4}, {"url": "https://twitter.com/KshitizRimal", "anchor_text": "Kshitiz Rimal", "paragraph_index": 4}, {"url": "https://github.com/fastai/course-v3/blob/master/nbs/dl1/lesson3-planet.ipynb", "anchor_text": "multi-classfor satellite detection", "paragraph_index": 6}, {"url": "https://drive.google.com/open?id=198YWuDW8FKmo68zzsjkPabKOBxaE1uJt", "anchor_text": "here", "paragraph_index": 8}, {"url": "https://www.quora.com/What-is-the-deep-neural-network-known-as-%E2%80%9CResNet-50%E2%80%9D", "anchor_text": "resnet50", "paragraph_index": 12}, {"url": "https://en.wikipedia.org/wiki/F1_score", "anchor_text": "fbeta", "paragraph_index": 12}, {"url": "https://en.wikipedia.org/wiki/F1_score", "anchor_text": "fbeta", "paragraph_index": 12}, {"url": "https://iris.brunosan.eu/notebooks/Iris.html#Convert-to-PyTorch-model-in-TorchScript-format", "anchor_text": "just a few lines of code", "paragraph_index": 13}, {"url": "https://course.fast.ai/deployment_google_app_engine.html", "anchor_text": "here", "paragraph_index": 18}, {"url": "https://github.com/brunosan/iris-ai/tree/master/iris-GCE", "anchor_text": "here", "paragraph_index": 18}, {"url": "https://github.com/brunosan/iris-ai/blob/a503d55a1413c4f8837100cc5732df749d942406/iris-GCE/app/server.py#L87", "anchor_text": "upload", "paragraph_index": 18}, {"url": "https://course.fast.ai/deployment_aws_lambda.html", "anchor_text": "here", "paragraph_index": 20}, {"url": "https://github.com/brunosan/iris-ai/tree/master/iris-aws-lambda", "anchor_text": "here", "paragraph_index": 20}, {"url": "https://forums.fast.ai/t/share-your-work-here/27676/1394", "anchor_text": "shared", "paragraph_index": 20}, {"url": "https://www.ondacero.es/programas/jelo-en-verano/programas-completos/jelo-en-verano-21082019_201908215d5d8b9a0cf2370b319a086f.html", "anchor_text": "Julia en la Onda, Onda Cero", "paragraph_index": 23}, {"url": "http://Impactscience.dev", "anchor_text": "Impactscience.dev", "paragraph_index": 27}], "all_paragraphs": ["This service recognizes what currency a banknote is (euro or usd dollar) and what denomination (5,10,20, \u2026). The social impact purpose is to help blind people, so I took care to make \u201creal-life\u201d training images holding the banknotes in my hand, sometimes folded, sometimes covering part of it.", "This post hopefully helps encourage others to learn Deep Learning. I\u2019m using the amazing fast.ai online free course, which I very much recommend. As a testament to their pragmatic, top-down approach, this side-project is based on lesson 3. On their online forum you can find many more amazing applications by fellow students.", "My project is deployed on iris.brunosan.eu", "Amazingly, the fast, fun and easier part is the deep learning part (congrats fastai!), and the production server took roughly 10x time (I also had to learn some details about docker and serverless applications).", "I found just a few efforts on identifying banknotes to help blind people. Some attempts use Computer Vision and \u201cscale-invariant features\u201d (with ~70% accuracy) and some use Machine Learning (with much higher accuracy). On the machine learning side, worth mentioning one by Microsoft research last year and one this year by a Nepali programmer, Kshitiz Rimal, with support from Intel:", "My goal was to replicate a similar solution, but I will only make a functioning website, not the app, nor on-device detection (I\u2019m leaving that for now). However, I am going to use a different architecture. Since I want to do several currencies at once, I wanted to try multi-class classification. All the solutions I\u2019ve seen use single-class detection, e.g. \u201c`1 usd`\u201d, and I wanted to break it into two classes, \u201c`1`\u201d and \u201c`usd`\u201d. The reason being that I think there are features to learn across currencies (all USD look similar) and also across denominations (e.g. the 5usd and 5eur have the number 5 in common). The commonalities should help the net reinforce those features for each class (e.g. a big digit \u201c5\u201d).", "I basically followed the fast.ai course lesson on multi-classfor satellite detection, without really many modifications:", "It is surprisingly hard to get images on single banknotes in real-life situations. After finishing this project I found the academic paper with Jordan currency I mentioned above, and the Nepali project which both link to their dataset.", "I decided to lean on Google Image searches and images from the European Central Bank and the US Mint, which I knew was going to give me unrealistically good images of banknotes. I also took some pictures myself with money I had home, for the low denominations (sadly I don\u2019t have 100$ or 500eur lying around at home). In total I had between 14 and 30 images per banknote denomination. Not much at all. My image dataset is here.", "Since I didn\u2019t have many images, I used data augmentation with widened parameters. (I wrongly added flips, it\u2019s probably not a good idea):", "In the end, the dataset it looked like this during training/validation:", "It\u2019s amazing one can get such good results with that few images.", "I used 20% split for validation, and 256 pixel size for the images, and `resnet50` as the pre-trained model. With the resnet frozen, I did 15 epochs (2 minutes each) training the added top layers, and got an fbeta of `.087`, pretty good already. Then unfroze and did more training with sliced learning rates (bigger rates on the last layers) on 20 epochs, to get `fbeta=.098`. I was able to squeeze some more accuracy by freezing again the pre-trained model and doing some more epochs. The best was `fbeta=0.983`. No signs of over-fitting, and I used the default parameters of dropout.", "Exporting the model to PyTorch Torch script for deployment is just a few lines of code.", "I did spend some time testing the exported model, and looking at the outputs (both the raw activations and the softmax. I then realized that I could use it to infer confidence:", "e.g. let\u2019s see this problematic image of a folded 5usd covering most of the 5", "Only the activations for class \u201c`usd`\u201d positive (last on the array), but the softmax also correctly brings the class \u201c`5`\u201d up, together with some doubt about the class `20`.", "Basically you need 2 parts. The front-end and the back-end.", "I first used Google Cloud Engine (GCE), as instructed here . My deployment code is here, and it includes code to upload and save a copy of the user images with the inferred class, so I can check false classifications use them for further training. Quite neat.", "Overall it was very easy to deploy. It basically creates a docker that deploys whatever code you need, and spins instances as needed. My problem was that the server is always running, actually 2 instances at least. GCE is meant for very high scalability and response, which is great, but it also meant I was paying all the time, even if no one is using it. I think it would have been 5\u201310$/month. If possible I wanted to deploy something that can remain online for long without paying much.", "I decided to switch to AWS Lambda (course instructions here). The process looks more complicated, but it\u2019s actually not that hard, and the huge benefit is that you only pay for use. Moreover, for the usage level, we will be well within the free tier (except the cost of keeping the model on S3, which is minimal). My code to deploy is here. Since you are deploying a Torchscript model, you just need PyTorch dependencies, and AWS has a nice docker file with all that you need. I had to add some python libraries for formatting the output and logging and they were all there. That means your actual python code is minimal and you don\u2019t need to bring fastai (On the course thread another student shared her deployment tricks IF you need to also bring fastai to the deployment).", "Inference of the classification takes 0.2 seconds roughly, which is really fast, but the overall time for the user from selecting the image to getting the result can be up to 30s, or even fail. The extra time is partly uploading the image from the client to the server, and downscaling it before uploading if needed.", "In real-life tests, the response time was a median of 1s, which is acceptable\u2026 except for the first times, it sometimes took up to 30s to respond for the first time. I think this is called \u201ccold start\u201d, and corresponds to the time of AWS pulling the Lambda from storage. To minimize this impact I added some code that triggers a ping to the server as soon as you load the client page. That ping just returns \u201cpong\u201d so it doesn\u2019t consume much billing time, but it makes the trick of triggering AWS to get the lambda function ready for the real inference call.", "This summer I have a small weekly section to talk about Impact Science on a spanish national radio, and I dedicated to talk in one episode about Artificial Intelligence and the impact on employment and Society. I presented this tool as an example. You can listen to it (in Spanish, timestamp 2h31m): Julia en la Onda, Onda Cero.", "I\u2019d love to get your feedback and ideas. Or if you try to replicate it have problems, let me know.", "These are some points already on my mind for the next sprint:", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Impactscience.dev CEO. Former rocket scientist and World Banker. Working on the science of getting to radical breakthroughs."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F373efc81a482&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fai-for-good-banknotes-detection-for-blind-people-373efc81a482&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fai-for-good-banknotes-detection-for-blind-people-373efc81a482&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fai-for-good-banknotes-detection-for-blind-people-373efc81a482&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fai-for-good-banknotes-detection-for-blind-people-373efc81a482&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----373efc81a482--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----373efc81a482--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@brunosan?source=post_page-----373efc81a482--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@brunosan?source=post_page-----373efc81a482--------------------------------", "anchor_text": "Bruno S\u00e1nchez-A Nu\u00f1o"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fde52c3801bb8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fai-for-good-banknotes-detection-for-blind-people-373efc81a482&user=Bruno+S%C3%A1nchez-A+Nu%C3%B1o&userId=de52c3801bb8&source=post_page-de52c3801bb8----373efc81a482---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F373efc81a482&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fai-for-good-banknotes-detection-for-blind-people-373efc81a482&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F373efc81a482&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fai-for-good-banknotes-detection-for-blind-people-373efc81a482&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://www.fast.ai/", "anchor_text": "fast.ai"}, {"url": "https://forums.fast.ai/t/share-your-work-here", "anchor_text": "On their online forum"}, {"url": "http://iris.brunosan.eu", "anchor_text": "iris.brunosan.eu"}, {"url": "https://www.sciencedirect.com/science/article/pii/S1319157816300416", "anchor_text": "Computer Vision"}, {"url": "https://twitter.com/KshitizRimal", "anchor_text": "Kshitiz Rimal"}, {"url": "https://news.microsoft.com/en-gb/2017/12/13/seeing-ai-can-now-tell-people-with-blindness-which-banknote-they-are-holding/", "anchor_text": "announced their version"}, {"url": "https://github.com/xiaoyongzhu/SeeingAI-Currency-Detection", "anchor_text": "available here"}, {"url": "https://software.intel.com/en-us/articles/cash-recognition-for-the-visually-impaired-part-3", "anchor_text": "nepali version from Kshitiz"}, {"url": "https://github.com/kshitizrimal/Cash-Recog-Project/blob/master/Training_Evaluation_Notebook.ipynb", "anchor_text": "on github"}, {"url": "https://github.com/fastai/course-v3/blob/master/nbs/dl1/lesson3-planet.ipynb", "anchor_text": "multi-classfor satellite detection"}, {"url": "https://drive.google.com/open?id=198YWuDW8FKmo68zzsjkPabKOBxaE1uJt", "anchor_text": "here"}, {"url": "https://www.quora.com/What-is-the-deep-neural-network-known-as-%E2%80%9CResNet-50%E2%80%9D", "anchor_text": "resnet50"}, {"url": "https://en.wikipedia.org/wiki/F1_score", "anchor_text": "fbeta"}, {"url": "https://en.wikipedia.org/wiki/F1_score", "anchor_text": "fbeta"}, {"url": "https://iris.brunosan.eu/notebooks/Iris.html#Convert-to-PyTorch-model-in-TorchScript-format", "anchor_text": "just a few lines of code"}, {"url": "https://github.com/brunosan/iris-ai/blob/master/docs/client.js#L112-L123", "anchor_text": "downsample"}, {"url": "https://github.com/brunosan/iris-ai/blob/master/docs/", "anchor_text": "on the same repository"}, {"url": "https://en.wikipedia.org/wiki/Data_URI_scheme", "anchor_text": "DataURI"}, {"url": "https://course.fast.ai/deployment_google_app_engine.html", "anchor_text": "here"}, {"url": "https://github.com/brunosan/iris-ai/tree/master/iris-GCE", "anchor_text": "here"}, {"url": "https://github.com/brunosan/iris-ai/blob/a503d55a1413c4f8837100cc5732df749d942406/iris-GCE/app/server.py#L87", "anchor_text": "upload"}, {"url": "https://course.fast.ai/deployment_aws_lambda.html", "anchor_text": "here"}, {"url": "https://github.com/brunosan/iris-ai/tree/master/iris-aws-lambda", "anchor_text": "here"}, {"url": "https://forums.fast.ai/t/share-your-work-here/27676/1394", "anchor_text": "shared"}, {"url": "https://www.ondacero.es/programas/jelo-en-verano/programas-completos/jelo-en-verano-21082019_201908215d5d8b9a0cf2370b319a086f.html", "anchor_text": "Julia en la Onda, Onda Cero"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----373efc81a482---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----373efc81a482---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----373efc81a482---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "http://creativecommons.org/licenses/by/4.0/", "anchor_text": "Some rights reserved"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F373efc81a482&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fai-for-good-banknotes-detection-for-blind-people-373efc81a482&user=Bruno+S%C3%A1nchez-A+Nu%C3%B1o&userId=de52c3801bb8&source=-----373efc81a482---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F373efc81a482&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fai-for-good-banknotes-detection-for-blind-people-373efc81a482&user=Bruno+S%C3%A1nchez-A+Nu%C3%B1o&userId=de52c3801bb8&source=-----373efc81a482---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F373efc81a482&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fai-for-good-banknotes-detection-for-blind-people-373efc81a482&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----373efc81a482--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F373efc81a482&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fai-for-good-banknotes-detection-for-blind-people-373efc81a482&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----373efc81a482---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----373efc81a482--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----373efc81a482--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----373efc81a482--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----373efc81a482--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----373efc81a482--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----373efc81a482--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----373efc81a482--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----373efc81a482--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@brunosan?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@brunosan?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Bruno S\u00e1nchez-A Nu\u00f1o"}, {"url": "https://medium.com/@brunosan/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "702 Followers"}, {"url": "http://Impactscience.dev", "anchor_text": "Impactscience.dev"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fde52c3801bb8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fai-for-good-banknotes-detection-for-blind-people-373efc81a482&user=Bruno+S%C3%A1nchez-A+Nu%C3%B1o&userId=de52c3801bb8&source=post_page-de52c3801bb8--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fusers%2Fde52c3801bb8%2Flazily-enable-writer-subscription&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fai-for-good-banknotes-detection-for-blind-people-373efc81a482&user=Bruno+S%C3%A1nchez-A+Nu%C3%B1o&userId=de52c3801bb8&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}