{"url": "https://towardsdatascience.com/time-series-forecasting-with-sql-its-easier-than-you-think-1f5b362d0c81", "time": 1683014223.218163, "path": "towardsdatascience.com/time-series-forecasting-with-sql-its-easier-than-you-think-1f5b362d0c81/", "webpage": {"metadata": {"title": "Time Series Forecasting With SQL \u2014 It\u2019s Easier Than You Think | by Dario Rade\u010di\u0107 | Towards Data Science", "h1": "Time Series Forecasting With SQL \u2014 It\u2019s Easier Than You Think", "description": "Time series forecasting is a task I usually do with Python. You might be accustomed to other languages, such as R or Julia, but I bet never crossed your mind for this type of task. If that\u2019s the case\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.oracle.com/index.html", "anchor_text": "Oracle Cloud", "paragraph_index": 4}, {"url": "https://raw.githubusercontent.com/jbrownlee/Datasets/master/airline-passengers.csv", "anchor_text": "Airline passengers", "paragraph_index": 7}, {"url": "https://mailchi.mp/46a3d2989d9b/bdssubscribe", "anchor_text": "Join my private email list for more helpful insights.", "paragraph_index": 26}, {"url": "https://medium.com/@radecicdario/membership", "anchor_text": "Medium member", "paragraph_index": 27}, {"url": "https://betterdatascience.com/time-series-forecasting-with-sql/", "anchor_text": "https://betterdatascience.com", "paragraph_index": 28}, {"url": "http://betterdatascience.com", "anchor_text": "betterdatascience.com", "paragraph_index": 30}], "all_paragraphs": ["Time series forecasting is a task I usually do with Python. You might be accustomed to other languages, such as R or Julia, but I bet never crossed your mind for this type of task. If that\u2019s the case \u2014 keep reading \u2014 you\u2019ll be surprised by how much can be accomplished with SQL only.", "I\u2019ve previously written about performing classification tasks with SQL, so make sure to take a look it if that\u2019s something you find interesting:", "Time series are different than your average machine learning task. You can\u2019t train the model once, and use it for months in production. Time series models must be trained with the entirety of history data, and new data points might come every hour, day, week, or month \u2014 varying from project to project.", "That\u2019s why doing the training process in-database can be beneficial, if hardware resources are limited. Python will almost always consume more resources than the database.", "We\u2019ll use Oracle Cloud once again. It\u2019s free, so please register and create an instance of the OLTP database (Version 19c, has 0.2TB of storage). Once done, download the cloud wallet and establish a connection through SQL Developer \u2014 or any other tool.", "This will take you 10 minutes at least but is a fairly straightforward thing to do, so I won\u2019t waste time on it.", "Awesome! Let\u2019s continue with the data loading.", "We need some data before any type of forecasting can be done. A de facto standard dataset for any time series tutorial is the Airline passengers dataset. Download it, and keep it somewhere safe for a minute.", "We need to create a table that will hold the dataset, so let\u2019s do that next. Here\u2019s the SQL statement:", "We can now load in the dataset via the Import Data functionality:", "When a modal window pops-up simply provide a path to the downloaded CSV and click Next a couple of times. Choose columns using your best judgment, and select date format as YYYY-MM.", "Once done, our dataset is ready to use:", "Awesome! We can now continue with the model training and forecasting.", "Our dataset has 144 rows. We won\u2019t perform the model training on the entirety of it. We\u2019ll keep the last 12 rows for the evaluation.", "To start with the training, we need to create a VIEW that points to the training data. Here's how:", "The src_passengers view now holds the first 132 rows - just what we want.", "Next, we\u2019ll declare a short PL/SQL snippet that handles the model training:", "Let\u2019s break the snippet down to make it easier to understand:", "Once that is declared, we can create a time series model with the help of a DBMS_DATA_MINING.CREATE_MODEL2 procedure (great naming convention by the way). Here are the explanations:", "And that\u2019s it! If you can understand this, you know how to train time series models with SQL.", "You can now run the PL/SQL snippet. It will take a couple of seconds to finish. Once done you can proceed to the next section.", "Let\u2019s see how good our model performed. I\u2019ve prepared the following statement for that:", "It compares actual data with the predictions made by the Holt-Winters algorithm and also compares the error in absolute and percentage terms. Here\u2019s the output of the above SQL statement:", "Awesome! Our model isn\u2019t that bad for the work we\u2019ve put in. Let\u2019s wrap things up in the next section.", "This was a lot of work \u2014 no arguing there. Still, there are ways we could improve. One idea pops into mind immediately \u2014 make a function that will return the best algorithm.", "You could do so by storing all possible algorithms in an array, and then train a model while iterating through the array, keeping track of the performance for every model. But that\u2019s a topic for another time.", "Join my private email list for more helpful insights.", "Loved the article? Become a Medium member to continue learning without limits. I\u2019ll receive a portion of your membership fee if you use the following link, with no extra cost to you.", "Originally published at https://betterdatascience.com on September 22, 2020.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Scientist & Tech Writer | betterdatascience.com"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F1f5b362d0c81&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftime-series-forecasting-with-sql-its-easier-than-you-think-1f5b362d0c81&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftime-series-forecasting-with-sql-its-easier-than-you-think-1f5b362d0c81&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftime-series-forecasting-with-sql-its-easier-than-you-think-1f5b362d0c81&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftime-series-forecasting-with-sql-its-easier-than-you-think-1f5b362d0c81&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----1f5b362d0c81--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----1f5b362d0c81--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@radecicdario?source=post_page-----1f5b362d0c81--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@radecicdario?source=post_page-----1f5b362d0c81--------------------------------", "anchor_text": "Dario Rade\u010di\u0107"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F689ba04bb8be&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftime-series-forecasting-with-sql-its-easier-than-you-think-1f5b362d0c81&user=Dario+Rade%C4%8Di%C4%87&userId=689ba04bb8be&source=post_page-689ba04bb8be----1f5b362d0c81---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F1f5b362d0c81&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftime-series-forecasting-with-sql-its-easier-than-you-think-1f5b362d0c81&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F1f5b362d0c81&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftime-series-forecasting-with-sql-its-easier-than-you-think-1f5b362d0c81&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@morningbrew?utm_source=medium&utm_medium=referral", "anchor_text": "Morning Brew"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://towardsdatascience.com/machine-learning-with-sql-its-easier-than-you-think-c6aae9064d5a", "anchor_text": "Machine Learning With SQL \u2014 It\u2019s Easier Than You ThinkWhat to do when Python is not an option. Code included.towardsdatascience.com"}, {"url": "https://www.oracle.com/index.html", "anchor_text": "Oracle Cloud"}, {"url": "https://raw.githubusercontent.com/jbrownlee/Datasets/master/airline-passengers.csv", "anchor_text": "Airline passengers"}, {"url": "https://docs.oracle.com/en/database/oracle/oracle-database/20/arpls/DBMS_DATA_MINING.html#GUID-A95A0A38-8A5A-4470-B49F-80D81C588BFC", "anchor_text": "Here's the complete list of available algorithms."}, {"url": "https://mailchi.mp/46a3d2989d9b/bdssubscribe", "anchor_text": "Join my private email list for more helpful insights."}, {"url": "https://medium.com/@radecicdario/membership", "anchor_text": "Medium member"}, {"url": "https://medium.com/@radecicdario/membership", "anchor_text": "Join Medium with my referral link - Dario Rade\u010di\u0107As a Medium member, a portion of your membership fee goes to writers you read, and you get full access to every story\u2026medium.com"}, {"url": "https://betterdatascience.com/time-series-forecasting-with-sql/", "anchor_text": "https://betterdatascience.com"}, {"url": "https://medium.com/tag/towards-data-science?source=post_page-----1f5b362d0c81---------------towards_data_science-----------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/tag/data-science?source=post_page-----1f5b362d0c81---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----1f5b362d0c81---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/sql?source=post_page-----1f5b362d0c81---------------sql-----------------", "anchor_text": "Sql"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----1f5b362d0c81---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F1f5b362d0c81&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftime-series-forecasting-with-sql-its-easier-than-you-think-1f5b362d0c81&user=Dario+Rade%C4%8Di%C4%87&userId=689ba04bb8be&source=-----1f5b362d0c81---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F1f5b362d0c81&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftime-series-forecasting-with-sql-its-easier-than-you-think-1f5b362d0c81&user=Dario+Rade%C4%8Di%C4%87&userId=689ba04bb8be&source=-----1f5b362d0c81---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F1f5b362d0c81&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftime-series-forecasting-with-sql-its-easier-than-you-think-1f5b362d0c81&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----1f5b362d0c81--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F1f5b362d0c81&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftime-series-forecasting-with-sql-its-easier-than-you-think-1f5b362d0c81&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----1f5b362d0c81---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----1f5b362d0c81--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----1f5b362d0c81--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----1f5b362d0c81--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----1f5b362d0c81--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----1f5b362d0c81--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----1f5b362d0c81--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----1f5b362d0c81--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----1f5b362d0c81--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@radecicdario?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@radecicdario?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Dario Rade\u010di\u0107"}, {"url": "https://medium.com/@radecicdario/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "39K Followers"}, {"url": "http://betterdatascience.com", "anchor_text": "betterdatascience.com"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F689ba04bb8be&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftime-series-forecasting-with-sql-its-easier-than-you-think-1f5b362d0c81&user=Dario+Rade%C4%8Di%C4%87&userId=689ba04bb8be&source=post_page-689ba04bb8be--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F33e2fb82c727&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftime-series-forecasting-with-sql-its-easier-than-you-think-1f5b362d0c81&newsletterV3=689ba04bb8be&newsletterV3Id=33e2fb82c727&user=Dario+Rade%C4%8Di%C4%87&userId=689ba04bb8be&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://amzn.to/400ZUtX", "anchor_text": "Machine Learning Automation with TPOT: Build, validate, and deploy fully automated machine learning models with Python2021"}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}