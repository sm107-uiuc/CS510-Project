{"url": "https://towardsdatascience.com/polynomial-regression-with-scikit-learn-what-you-should-know-bed9d3296f2", "time": 1683009954.30847, "path": "towardsdatascience.com/polynomial-regression-with-scikit-learn-what-you-should-know-bed9d3296f2/", "webpage": {"metadata": {"title": "Polynomial Regression with Scikit learn: What You Should Know | by Angela Shi | Towards Data Science", "h1": "Polynomial Regression with Scikit learn: What You Should Know", "description": "Polynomial regression is a well-known machine learning model. It is a special case of linear regression, by the fact that we create some polynomial features before creating a linear regression. Or it\u2026"}, "outgoing_paragraph_urls": [{"url": "https://towardsdatascience.com/overview-of-supervised-machine-learning-algorithms-a5107d036296", "anchor_text": "feature space mapping", "paragraph_index": 0}, {"url": "https://towardsdatascience.com/the-hidden-linearity-in-polynomial-regression-333f1bed7aa5", "anchor_text": "The Hidden Linearity in Polynomial Regression", "paragraph_index": 0}, {"url": "https://towardsdatascience.com/overview-of-supervised-machine-learning-algorithms-a5107d036296", "anchor_text": "Overview of Supervised Machine Learning Algorithms", "paragraph_index": 35}, {"url": "https://medium.com/@angela.shi/membership", "anchor_text": "https://medium.com/@angela.shi/membership", "paragraph_index": 36}], "all_paragraphs": ["Polynomial regression is a well-known machine learning model. It is a special case of linear regression, by the fact that we create some polynomial features before creating a linear regression. Or it can be considered as a linear regression with a feature space mapping (aka a polynomial kernel). With this kernel trick, it is, sort of, possible to create a polynomial regression with a degree that is infinite! To learn more about the definition and you can read this article The Hidden Linearity in Polynomial Regression.", "In this article, we will deal with classic polynomial regression. To fit a polynomial regression with python, there are two functions available. The package numpy provides polyfit, and the package scikit-learn uses PolynomialFeatures combined with LinearRegression. We will compare them and in practice, we will notice one major difference.", "Let\u2019s begin with scikit learn, it is possible to create one in a pipeline combining these two steps (Polynomialfeatures and LinearRegression). I will show the code below. And let\u2019s see an example, with some simple toy data, of only 10 points. Let\u2019s also consider the degree to be 9. You can see the final result below.", "Well, in theory, this is wrong! For 10 points, a 9th-degree polynomial should fit them perfectly!", "Or maybe, I am sure that some of you are thinking: why are you saying that this is wrong? This may be the right model. You think that the model should fit perfectly, but no, you are confused with polynomial interpolation!", "First, you can try it for yourself using the following code to create the model.", "Before talking about the difference between polynomial regression and polynomial interpolation. Let\u2019s first talk about an answer that I got from the scikit learn team: you should not be doing this, expansion to a 9th-degree polynomial is nonsense. And scikit learn is built for practical use cases, and it works with finite-precision representations, not theoretical representations.", "Yes, they are totally right! Just look at the numbers, how big they become: 1e24!", "But if they cannot handle big numbers, shouldn\u2019t they throw an error or a warning? Without any message, one will just consider that the model is correct, whereas, well, it is actually not.", "OK OK, I know, some of you are not convinced that the result is wrong, or maybe it is impossible to handle big numbers, let's see with another package, numpy!", "For the same example, polyfit from numpy has no problem finding the model. You can see the plot and the code below.", "Now I know some of you are thinking: polyfit is a very different thing, it is an interpolation and not regression.", "Because when asking around, I got some answers like this (but they are not accurate, or wrong):", "polyfit is doing an altogether different thing. It is performing a univariate polynomial fit for some vector x to a vector y. Here we are performing a polynomial expansion of some feature space X in order to represent high-order interaction terms (equivalent to learning with a polynomial kernel) for a multivariate fit.", "Well, for this kind of question, Wikipedia is a good source.", "In numerical analysis, polynomial interpolation is the interpolation of a given data set by the polynomial of lowest possible degree that passes through the points of the dataset.", "Going back to our example: there are 10 points, and we try to find a 9th-degree polynomial. So technically, we are doing polynomial interpolation. And polyfit found this unique polynomial! This is not the case for scikit learn\u2019s polynomial regression pipeline!", "And this is precisely why some of you are thinking: polyfit is different from scikit learn\u2019s polynomial regression pipeline!", "In polyfit, there is an argument, called degree. So you can modify the degree, let\u2019s try with 5.", "Yes, with polyfit, it is possible to choose the degree of the polynomial and we are doing polynomial regression with it. And degree 9, chosen by the user, is the special case of polynomial interpolation.", "And it is reassuring because the linear regression tries to minimize the squared error. And we know that if there are 10 points, and we try to find a polynomial of degree 9, then the error can be 0 (can\u2019t be lower!) because of the theorem of polynomial interpolation.", "For those who are still doubting, there is the official document for polyfit: Least squares polynomial fit. Fit a polynomial p(x) = p[0] * x**deg + ... + p[deg] of degree deg to points (x, y). Returns a vector of coefficients p that minimizes the squared error in the order deg, deg-1, \u2026 0.", "OK, time to go back to our scikit learn\u2019s polynomial regression pipeline. So now, why the difference? Are there really two different polynomial regression (or fit), using both Least Squares, but using them differently?", "I found this answer, but I am not getting it yet.", "Both models uses Least Squares, but the equation on which these Least Squares are used is completely different. polyfit applies it on the vandemonde matrix while the linear regression does not.", "While digging around, another important transformation of features should be mentioned: feature scaling.", "In several books on machine learning, when performing polynomial regressions, the features are scaled. Maybe from the beginning, some of you were saying that it should be done.", "And yes, scikit learn\u2019s polynomial regression pipeline with the feature scaling, seems to be equivalent to polyfit! according to the plot (I didn\u2019t really check, but visually they are the same).", "You can use the code below:", "Now, we didn\u2019t answer our previous questions, and we have more questions: does feature scaling have an effect on linear regression?", "To discuss this, there can be another article written and for our discussion about the effect of polynomial regression, we can just do another transformation.", "That\u2019s right, you just divide the predictors by 1000. Now, you know that the effect on the linear regression model is only proportional, but in practice, the difference is huge.", "So that is why we can conclude that the initial numbers are too big for scikit learn.", "In the end, we can say that scikit learn\u2019s polynomial regression pipeline (with or without scaling), should be equivalent to numpy\u2019s polyfit, but the difference in terms of big number handling can create different results.", "And personally, I think that scikit learn should throw an error or at least a warning in this case.", "If you like to know more about how polynomial regression is related to other supervised learning algorithms, you can read this article: Overview of Supervised Machine Learning Algorithms. You will see that the polynomial regression is a special kind of feature space mapping.", "I write about machine learning and data science and I try to simplify complex concepts in a clear way. Please follow me with the link below and get full access to my articles: https://medium.com/@angela.shi/membership", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "a data science and machine learning enthusiast, dedicated to simplifying complex concepts in a clear way."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fbed9d3296f2&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpolynomial-regression-with-scikit-learn-what-you-should-know-bed9d3296f2&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpolynomial-regression-with-scikit-learn-what-you-should-know-bed9d3296f2&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpolynomial-regression-with-scikit-learn-what-you-should-know-bed9d3296f2&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpolynomial-regression-with-scikit-learn-what-you-should-know-bed9d3296f2&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----bed9d3296f2--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----bed9d3296f2--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@angela.shi?source=post_page-----bed9d3296f2--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@angela.shi?source=post_page-----bed9d3296f2--------------------------------", "anchor_text": "Angela Shi"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F2bf03e38122e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpolynomial-regression-with-scikit-learn-what-you-should-know-bed9d3296f2&user=Angela+Shi&userId=2bf03e38122e&source=post_page-2bf03e38122e----bed9d3296f2---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fbed9d3296f2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpolynomial-regression-with-scikit-learn-what-you-should-know-bed9d3296f2&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fbed9d3296f2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpolynomial-regression-with-scikit-learn-what-you-should-know-bed9d3296f2&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://towardsdatascience.com/overview-of-supervised-machine-learning-algorithms-a5107d036296", "anchor_text": "feature space mapping"}, {"url": "https://towardsdatascience.com/the-hidden-linearity-in-polynomial-regression-333f1bed7aa5", "anchor_text": "The Hidden Linearity in Polynomial Regression"}, {"url": "https://towardsdatascience.com/overview-of-supervised-machine-learning-algorithms-a5107d036296", "anchor_text": "Overview of Supervised Machine Learning Algorithms"}, {"url": "https://medium.com/@angela.shi/membership", "anchor_text": "https://medium.com/@angela.shi/membership"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----bed9d3296f2---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----bed9d3296f2---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/regression?source=post_page-----bed9d3296f2---------------regression-----------------", "anchor_text": "Regression"}, {"url": "https://medium.com/tag/polynomial-regression?source=post_page-----bed9d3296f2---------------polynomial_regression-----------------", "anchor_text": "Polynomial Regression"}, {"url": "https://medium.com/tag/mathematics?source=post_page-----bed9d3296f2---------------mathematics-----------------", "anchor_text": "Mathematics"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fbed9d3296f2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpolynomial-regression-with-scikit-learn-what-you-should-know-bed9d3296f2&user=Angela+Shi&userId=2bf03e38122e&source=-----bed9d3296f2---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fbed9d3296f2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpolynomial-regression-with-scikit-learn-what-you-should-know-bed9d3296f2&user=Angela+Shi&userId=2bf03e38122e&source=-----bed9d3296f2---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fbed9d3296f2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpolynomial-regression-with-scikit-learn-what-you-should-know-bed9d3296f2&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----bed9d3296f2--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fbed9d3296f2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpolynomial-regression-with-scikit-learn-what-you-should-know-bed9d3296f2&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----bed9d3296f2---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----bed9d3296f2--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----bed9d3296f2--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----bed9d3296f2--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----bed9d3296f2--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----bed9d3296f2--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----bed9d3296f2--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----bed9d3296f2--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----bed9d3296f2--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@angela.shi?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@angela.shi?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Angela Shi"}, {"url": "https://medium.com/@angela.shi/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "1.6K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F2bf03e38122e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpolynomial-regression-with-scikit-learn-what-you-should-know-bed9d3296f2&user=Angela+Shi&userId=2bf03e38122e&source=post_page-2bf03e38122e--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F2aafe7bac5e3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpolynomial-regression-with-scikit-learn-what-you-should-know-bed9d3296f2&newsletterV3=2bf03e38122e&newsletterV3Id=2aafe7bac5e3&user=Angela+Shi&userId=2bf03e38122e&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}