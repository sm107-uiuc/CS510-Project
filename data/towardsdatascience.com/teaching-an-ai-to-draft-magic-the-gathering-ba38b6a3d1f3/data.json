{"url": "https://towardsdatascience.com/teaching-an-ai-to-draft-magic-the-gathering-ba38b6a3d1f3", "time": 1682995339.6383328, "path": "towardsdatascience.com/teaching-an-ai-to-draft-magic-the-gathering-ba38b6a3d1f3/", "webpage": {"metadata": {"title": "Teaching an AI to Draft Magic: the Gathering | by Zachary Witten | Towards Data Science", "h1": "Teaching an AI to Draft Magic: the Gathering", "description": "In a Magic: the Gathering Draft, players iteratively select cards from packs to make the best deck they can. Using data from drafts carried out by humans, I trained a neural network to predict what\u2026"}, "outgoing_paragraph_urls": [{"url": "https://github.com/zswitten/trophy-leader/blob/master/DraftbotKeras-Flooey.ipynb", "anchor_text": "here", "paragraph_index": 0}, {"url": "https://magic.flooey.org", "anchor_text": "Magic Flooey", "paragraph_index": 2}, {"url": "https://draftsim.com/", "anchor_text": "Draftsim", "paragraph_index": 3}, {"url": "https://github.com/zswitten/trophy-leader/blob/master/DraftbotKeras-Flooey.ipynb", "anchor_text": "the notebook", "paragraph_index": 11}, {"url": "http://www.mtgeloproject.net/index.php?lastname=Witten&firstname=zack&search=Search", "anchor_text": "decent player", "paragraph_index": 13}, {"url": "http://wisdomofcrowds.blogspot.com/2009/12/chapter-one-part-i.html", "anchor_text": "http://wisdomofcrowds.blogspot.com/2009/12/chapter-one-part-i.html", "paragraph_index": 14}, {"url": "https://en.wikipedia.org/wiki/AlphaZero", "anchor_text": "AlphaZero", "paragraph_index": 16}, {"url": "https://mtgjson.com/", "anchor_text": "MTGJSON", "paragraph_index": 17}], "all_paragraphs": ["In a Magic: the Gathering Draft, players iteratively select cards from packs to make the best deck they can. Using data from drafts carried out by humans, I trained a neural network to predict what card the humans would take out of each pack. It reached 60% accuracy at this task. And in the 40% when the human and the model differ, the model\u2019s predicted choice is often *better* than what the human picked. A notebook with the model training code and sample results can be found here.", "To master Draft, you have to balance the raw power level of each card, the synergy of the cards with each other, and the signals that you\u2019re receiving from the cards that are left in the pack at any given time.", "The proprietor of Magic Flooey was kind enough to send me a .json file with 2130 drafts of the second-most-recent MTG set, Guilds of Ravnica.", "I also scraped the archives of Draftsim, a site where humans can practice drafting against bots with predetermined pick orders. Models trained on this data achieved similar levels of accuracy to models trained on the Flooey data, but I noticed that the model was making worse picks because the Draftsim users were making worse picks than the Flooey users, likely because they weren\u2019t playing for stakes. This is despite Draftsim having orders of magnitude more drafts.", "To represent the set of cards available to choose from in a pack, we can use a vector of length N, where N is the number of different cards in Guilds of Ravnica (250). Each card gets an index. The first pack you see has 15 cards in it, so its vector will have 15 ones (the indices of the cards in the pack), and 235 zeros. The second pack will have 14 ones and 236 zeros, etc.", "To represent the cards we\u2019ve already selected, we can use another vector of length N, where the value at each index is the number of that card that we\u2019ve already drafted. For the first pick in every draft, it\u2019ll be all zeros. For the second pick, there will be 1 one and 249 zeros. For the third pick, it\u2019ll probably be 2 ones and 248 zeros\u2026 unless we took the same card out of both of the first two packs, in which case it\u2019d be a 2 and 249 zeros.", "In summary, the input to our model is a vector of length 2N.", "The output is a one-hot encoded vector of length N set to be 1 at the index of the card taken by the human, and 0 elsewhere.", "This representation ignores one important feature of Draft: memory of what cards you saw in a previous pack and *didn\u2019t* take. Professional players use this information to make guesses about what cards they\u2019re likely to see in future packs. We could represent this by adding an additional 45 vectors of length N to each input. The first of these vectors would represent the cards we saw for our first pick, unless this *is* our first pick, in which case it\u2019s all zeros. In general, the Kth of these vectors represents the cards we saw at our Kth pick, if indeed we have had K picks already, otherwise it\u2019s all zeroes.", "Including this info in the model multiplies the size of the input representation by a factor of 24, which isn\u2019t ideal with only 2000x45 data points. With more data I think it could be a valuable feature to add.", "I experimented with a linear SGD classifier that reached 50% accuracy. I then tried a neural network with a couple of 512-neuron dense layers spaced with dropout layers into a N-length softmax layer, and got to 59% accuracy.", "I went through some of the drafts in the test set and had the model say at each stage what card it would have picked, given the cards already picked, alongside the cards the human picked. You can see them in the notebook accompanying this post.", "The model definitely understands the concept of color. In MTG there are 5 colors, and any given draft deck will likely only play cards from 2 or 3 of those colors. So if you\u2019ve already taken a blue card, you should be more likely to take blue cards in future picks. We didn\u2019t tell the model about this, and we also didn\u2019t tell it which cards were which color. But it learned anyway, by observing which cards were often drafted in combination with each other.", "Since MTG hasn\u2019t been solved the way Chess and Go sort of have, it\u2019s impossible to say with certainty exactly how good the model\u2019s picks are. I\u2019m a decent player and when I look at the cards it takes, I don\u2019t see anything obviously wrong. In fact, when it and the human drafter disagreed, I found I tended to prefer the model\u2019s picks. But I\u2019m biased, so please look at the picks yourself and tell me what you think, or have your most MTG-knowledgable friend check it out and report back.", "Ask a thousand humans to guess how many jelly beans are in a big jar of jelly beans. Average the absolute error of each guess. Then average the guesses, and take the absolute error of *that*. The latter will be less wrong. http://wisdomofcrowds.blogspot.com/2009/12/chapter-one-part-i.html", "I think something like that is happening here. Everyone overrates some cards, and underrates others. Average all those errors together and you end up in a better place.", "If we had match results for each deck in the training set (i.e. how many games the decks ended up winning), we could have the model optimize not just for similarity to human picks, but for the quality of the expected deck it\u2019d get after making a given pick. For each card in the pack, the model would dream through thousands of ways the draft might go on from that point, and evaluate the resulting decks. Then it takes the card that gave it the best dreams. I.e. we could go full AlphaZero.", "Another exciting possibility would be to add data from MTGJSON into the model. Right now, each card is just a random integer between 1 and 250. With the info from MTG JSON, we\u2019d be adding explicit info about what cards are similar. This would allow the model to draft a new set without seeing humans draft it first.", "Until next time, may you be unable to distinguish sufficiently advanced Magic from technology.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "ML at Atrium. @zswitten on twitter"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fba38b6a3d1f3&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fteaching-an-ai-to-draft-magic-the-gathering-ba38b6a3d1f3&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fteaching-an-ai-to-draft-magic-the-gathering-ba38b6a3d1f3&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fteaching-an-ai-to-draft-magic-the-gathering-ba38b6a3d1f3&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fteaching-an-ai-to-draft-magic-the-gathering-ba38b6a3d1f3&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----ba38b6a3d1f3--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----ba38b6a3d1f3--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@zswitten?source=post_page-----ba38b6a3d1f3--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@zswitten?source=post_page-----ba38b6a3d1f3--------------------------------", "anchor_text": "Zachary Witten"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Ff36a1fb89016&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fteaching-an-ai-to-draft-magic-the-gathering-ba38b6a3d1f3&user=Zachary+Witten&userId=f36a1fb89016&source=post_page-f36a1fb89016----ba38b6a3d1f3---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fba38b6a3d1f3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fteaching-an-ai-to-draft-magic-the-gathering-ba38b6a3d1f3&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fba38b6a3d1f3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fteaching-an-ai-to-draft-magic-the-gathering-ba38b6a3d1f3&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://github.com/zswitten/trophy-leader/blob/master/DraftbotKeras-Flooey.ipynb", "anchor_text": "here"}, {"url": "https://magic.flooey.org", "anchor_text": "Magic Flooey"}, {"url": "https://draftsim.com/", "anchor_text": "Draftsim"}, {"url": "https://github.com/zswitten/trophy-leader/blob/master/DraftbotKeras-Flooey.ipynb", "anchor_text": "the notebook"}, {"url": "http://www.mtgeloproject.net/index.php?lastname=Witten&firstname=zack&search=Search", "anchor_text": "decent player"}, {"url": "http://wisdomofcrowds.blogspot.com/2009/12/chapter-one-part-i.html", "anchor_text": "http://wisdomofcrowds.blogspot.com/2009/12/chapter-one-part-i.html"}, {"url": "https://en.wikipedia.org/wiki/AlphaZero", "anchor_text": "AlphaZero"}, {"url": "https://mtgjson.com/", "anchor_text": "MTGJSON"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----ba38b6a3d1f3---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/magic-the-gathering?source=post_page-----ba38b6a3d1f3---------------magic_the_gathering-----------------", "anchor_text": "Magic The Gathering"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----ba38b6a3d1f3---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----ba38b6a3d1f3---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/games?source=post_page-----ba38b6a3d1f3---------------games-----------------", "anchor_text": "Games"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fba38b6a3d1f3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fteaching-an-ai-to-draft-magic-the-gathering-ba38b6a3d1f3&user=Zachary+Witten&userId=f36a1fb89016&source=-----ba38b6a3d1f3---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fba38b6a3d1f3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fteaching-an-ai-to-draft-magic-the-gathering-ba38b6a3d1f3&user=Zachary+Witten&userId=f36a1fb89016&source=-----ba38b6a3d1f3---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fba38b6a3d1f3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fteaching-an-ai-to-draft-magic-the-gathering-ba38b6a3d1f3&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----ba38b6a3d1f3--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fba38b6a3d1f3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fteaching-an-ai-to-draft-magic-the-gathering-ba38b6a3d1f3&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----ba38b6a3d1f3---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----ba38b6a3d1f3--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----ba38b6a3d1f3--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----ba38b6a3d1f3--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----ba38b6a3d1f3--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----ba38b6a3d1f3--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----ba38b6a3d1f3--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----ba38b6a3d1f3--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----ba38b6a3d1f3--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@zswitten?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@zswitten?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Zachary Witten"}, {"url": "https://medium.com/@zswitten/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "18 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Ff36a1fb89016&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fteaching-an-ai-to-draft-magic-the-gathering-ba38b6a3d1f3&user=Zachary+Witten&userId=f36a1fb89016&source=post_page-f36a1fb89016--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fb29a46374dbd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fteaching-an-ai-to-draft-magic-the-gathering-ba38b6a3d1f3&newsletterV3=f36a1fb89016&newsletterV3Id=b29a46374dbd&user=Zachary+Witten&userId=f36a1fb89016&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}