{"url": "https://towardsdatascience.com/interpretable-machine-learning-for-image-classification-with-lime-ea947e82ca13", "time": 1683001000.726739, "path": "towardsdatascience.com/interpretable-machine-learning-for-image-classification-with-lime-ea947e82ca13/", "webpage": {"metadata": {"title": "Interpretable Machine Learning for Image Classification with LIME | by Cristian Arteaga | Towards Data Science", "h1": "Interpretable Machine Learning for Image Classification with LIME", "description": "Local Interpretable Model-agnostic Explanations (LIME) provides explanations for the predictions of any ML algorithm. For images, it finds superpixels strongly associated with a class label."}, "outgoing_paragraph_urls": [{"url": "https://nbviewer.jupyter.org/urls/arteagac.github.io/blog/lime.ipynb", "anchor_text": "this short tutorial", "paragraph_index": 4}, {"url": "https://nbviewer.jupyter.org/url/arteagac.github.io/blog/lime_image.ipynb", "anchor_text": "here", "paragraph_index": 14}, {"url": "https://colab.research.google.com/github/arteagac/arteagac.github.io/blob/master/blog/lime_image.ipynb", "anchor_text": "opening this notebook in Google Colab", "paragraph_index": 14}, {"url": "https://dl.acm.org/citation.cfm?Id=2939778", "anchor_text": "\u201cWhy should I trust you? : Explaining the predictions of any classifier.\u201d", "paragraph_index": 15}], "all_paragraphs": ["The increasing trend in the use of machine learning for critical applications such as self-driving vehicles and medical diagnosis suggests an imperative need for methodologies that can help to understand and evaluate the predictions of machine-learning models. Local Interpretable Model-agnostic Explanations (LIME)[1] is a technique that explains how the input features of a machine learning model affect its predictions. For instance, for image classification tasks, LIME finds the region of an image (set of super-pixels) with the strongest association with a prediction label. This post is a step by step guide with Python code on how LIME for image classification internally works.", "Let\u2019s start by reading an image and using the pre-trained InceptionV3 model available in Keras to predict the class of such image.", "This script loads the input image in the variable Xi and prints the top 5 classes (and probabilities) for the image as shown below:", "With this information, the input image and the pre-trained InceptionV3 model, we can proceed to generate explanations with LIME. In this example we will generate explanations for the class Labrador Retriever.", "LIME creates explanations by generating a new dataset of random perturbations (with their respective predictions) around the instance being explained and then fitting a weighted local surrogate model. This local model is usually a simpler model with intrinsic interpretability such as a linear regression model. For more details about the basics behind LIME, I recommend you to check this short tutorial. For the case of image classification, LIME generates explanations with the following steps:", "For the case of images, LIME generates perturbations by turning on and off some of the super-pixels in the image. The following script uses the quick-shift segmentation algorithm to compute the super-pixels in the image. In addition, it generates an array of 150 perturbations where each perturbation is a vector with zeros and ones that represent whether the super-pixel is on or off.", "After computing the super-pixels in the image we get this:", "The following are examples of perturbation vectors and perturbed images:", "The following script uses the inceptionV3_model to predict the class of each of the perturbed images. The shape of the predictions is (150,1000) which means that for each of the 150 images, we get the probability of belonging to the 1,000 classes in InceptionV3. From these 1,000 classes we will use only the Labrador class in further steps since it is the prediction we want to explain. In this example, 150 perturbations were used. However, for real applications, a larger number of perturbations will produce more reliable explanations.", "Now we have everything to fit a linear model using the perturbations as input featuresX and the predictions for Labrador predictions[labrador] as output y . However, before we fit a linear model, LIME needs to give more weight (importance) to images that are closer to the image being explained.", "We use a distance metric to evaluate how far is each perturbation from the original image. The original image is just a perturbation with all the super-pixels active (all elements in one). Given that the perturbations are multidimensional vectors, the cosine distance is a metric that can be used for this purpose. After the cosine distance has been computed, a kernel function is used to translate such distance to a value between zero and one (a weight). At the end of this process we have a weight (importance) for each perturbation in the dataset.", "We fit a weighted linear model using the information obtained in the previous steps. We get a coefficient for each super-pixel in the image that represents how strong is the effect of the super-pixel in the prediction of Labrador.", "We just need to sort these coefficients to determine what are the most important super-pixels (top_features)for the prediction of Labrador. Even though here we used the magnitude of the coefficients to determine the most important features, other alternatives such as forward or backward elimination can be used for feature importance selection. After computing the top super-pixels we get:", "This is what LIME returns as explanation. The area of the image (super-pixels) that have a stronger association with the prediction of \u201cLabrador Retriever\u201d. This explanation suggests that the pre-trained InceptionV3 model is doing a good job predicting the labrador class for the given image. This example shows how LIME can help to increase confidence in a machine-learning model by understanding why it is returning certain predictions.", "A Jupyter Notebook with all the Python code used in this post can be found here. You can easily test explanations on your own images by opening this notebook in Google Colab.", "[1] Ribeiro, Marco Tulio, Sameer Singh, and Carlos Guestrin. \u201cWhy should I trust you? : Explaining the predictions of any classifier.\u201d (2016) Proceedings of the 22nd ACM SIGKDD. ACM.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fea947e82ca13&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finterpretable-machine-learning-for-image-classification-with-lime-ea947e82ca13&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finterpretable-machine-learning-for-image-classification-with-lime-ea947e82ca13&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finterpretable-machine-learning-for-image-classification-with-lime-ea947e82ca13&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finterpretable-machine-learning-for-image-classification-with-lime-ea947e82ca13&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----ea947e82ca13--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----ea947e82ca13--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@arteagac?source=post_page-----ea947e82ca13--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@arteagac?source=post_page-----ea947e82ca13--------------------------------", "anchor_text": "Cristian Arteaga"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F1de68ed82e5a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finterpretable-machine-learning-for-image-classification-with-lime-ea947e82ca13&user=Cristian+Arteaga&userId=1de68ed82e5a&source=post_page-1de68ed82e5a----ea947e82ca13---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fea947e82ca13&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finterpretable-machine-learning-for-image-classification-with-lime-ea947e82ca13&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fea947e82ca13&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finterpretable-machine-learning-for-image-classification-with-lime-ea947e82ca13&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://nbviewer.jupyter.org/urls/arteagac.github.io/blog/lime.ipynb", "anchor_text": "this short tutorial"}, {"url": "https://nbviewer.jupyter.org/url/arteagac.github.io/blog/lime_image.ipynb", "anchor_text": "here"}, {"url": "https://colab.research.google.com/github/arteagac/arteagac.github.io/blob/master/blog/lime_image.ipynb", "anchor_text": "opening this notebook in Google Colab"}, {"url": "https://dl.acm.org/citation.cfm?Id=2939778", "anchor_text": "\u201cWhy should I trust you? : Explaining the predictions of any classifier.\u201d"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----ea947e82ca13---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/interpretable-ai?source=post_page-----ea947e82ca13---------------interpretable_ai-----------------", "anchor_text": "Interpretable Ai"}, {"url": "https://medium.com/tag/image-processing?source=post_page-----ea947e82ca13---------------image_processing-----------------", "anchor_text": "Image Processing"}, {"url": "https://medium.com/tag/explainable-ai?source=post_page-----ea947e82ca13---------------explainable_ai-----------------", "anchor_text": "Explainable Ai"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----ea947e82ca13---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fea947e82ca13&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finterpretable-machine-learning-for-image-classification-with-lime-ea947e82ca13&user=Cristian+Arteaga&userId=1de68ed82e5a&source=-----ea947e82ca13---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fea947e82ca13&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finterpretable-machine-learning-for-image-classification-with-lime-ea947e82ca13&user=Cristian+Arteaga&userId=1de68ed82e5a&source=-----ea947e82ca13---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fea947e82ca13&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finterpretable-machine-learning-for-image-classification-with-lime-ea947e82ca13&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----ea947e82ca13--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fea947e82ca13&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finterpretable-machine-learning-for-image-classification-with-lime-ea947e82ca13&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----ea947e82ca13---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----ea947e82ca13--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----ea947e82ca13--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----ea947e82ca13--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----ea947e82ca13--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----ea947e82ca13--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----ea947e82ca13--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----ea947e82ca13--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----ea947e82ca13--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@arteagac?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@arteagac?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Cristian Arteaga"}, {"url": "https://medium.com/@arteagac/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "210 Followers"}, {"url": "http://arteagac.github.io", "anchor_text": "arteagac.github.io"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F1de68ed82e5a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finterpretable-machine-learning-for-image-classification-with-lime-ea947e82ca13&user=Cristian+Arteaga&userId=1de68ed82e5a&source=post_page-1de68ed82e5a--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F7b45958beb70&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finterpretable-machine-learning-for-image-classification-with-lime-ea947e82ca13&newsletterV3=1de68ed82e5a&newsletterV3Id=7b45958beb70&user=Cristian+Arteaga&userId=1de68ed82e5a&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}