{"url": "https://towardsdatascience.com/chance-is-not-enough-evaluating-model-significance-with-permutations-e3b17de6ba04", "time": 1682994092.1189601, "path": "towardsdatascience.com/chance-is-not-enough-evaluating-model-significance-with-permutations-e3b17de6ba04/", "webpage": {"metadata": {"title": "Permutation testing model significance | Towards Data Science", "h1": "Chance is not enough: Evaluating model significance with permutations", "description": "Comparing model performance against chance is not enough. A Python tutorial on how to test model accuracy significance with permutations."}, "outgoing_paragraph_urls": [{"url": "https://scikit-learn.org/stable/modules/generated/sklearn.linear_model.LogisticRegressionCV.html#sklearn.linear_model.LogisticRegressionCV", "anchor_text": "here for details", "paragraph_index": 3}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.permutation_test_score.html#sklearn.model_selection.permutation_test_score", "anchor_text": "permutation_test_score", "paragraph_index": 9}, {"url": "http://www.jmlr.org/papers/volume11/ojala10a/ojala10a.pdf", "anchor_text": "Ojala and Garriga. Permutation Tests for Studying Classifier Performance. The Journal of Machine Learning Research (2010) vol. 11", "paragraph_index": 13}, {"url": "http://jinhyuncheong.com/tag/machine-learning", "anchor_text": "machine-learning", "paragraph_index": 14}, {"url": "http://jinhyuncheong.com/tag/chance", "anchor_text": "chance", "paragraph_index": 14}, {"url": "http://jinhyuncheong.com/tag/significance", "anchor_text": "significance", "paragraph_index": 14}, {"url": "http://jinhyuncheong.com/tag/permutations", "anchor_text": "permutations", "paragraph_index": 14}, {"url": "http://jinhyuncheong.com/tag/analysis", "anchor_text": "analysis", "paragraph_index": 14}, {"url": "http://jinhyuncheong.com/tag/data", "anchor_text": "data", "paragraph_index": 14}, {"url": "http://jinhyuncheong.com/jekyll/update/2018/12/05/Chance_is_not_enough.html", "anchor_text": "jinhyuncheong.com", "paragraph_index": 15}, {"url": "https://jincheong.medium.com/membership", "anchor_text": "https://jincheong.medium.com/membership", "paragraph_index": 17}], "all_paragraphs": ["When training a machine learning model for classification, researchers and data scientists often compare their model performance against chance. However, this is often not enough. The true test of significance can be achieved by comparing the model to a collection of models trained on junk labels. If a large number of models trained on junk data can be used just as well to predict above chance, this suggests your model is not significantly better than the junk models. Thus in some situations, it would be wise to compare model accuracy to not just chance but the performance of junk models. In this tutorial, we compare how classification performance that is better than chance may not actually be significantly better than a random model.", "Let\u2019s consider a hypothetical study in which we are trying to classify what image participants saw from their brain activity. Participants saw either an image with a happy face (labeled 1) or an angry face (labeled 0) for 10 times each resulting in 20 trials per participant. In this setup, the chance of predicting one condition over the other would be 50%. We generate data for 40 participants (groups) with 60 voxels (features) for 800 trials meaning each participant had 20 (=800/40) trials each. Of those 20 trials, half of them are happy faces and the other half angry faces. All features are randomly sampled from a uniform distribution between 0 and 1 with .5 mean. To give the model useful features for classification, we add a set of random values with the same distribution to every 8th value in the data so that trials 0, 8, 16, and so forth will have higher values that could be leveraged to classify the happy faces.", "Now let\u2019s visualize a subset of data for two subjects (40 trials). Note the horizontal bright lights between columns which are the features that our model should be able to leverage for predicting the happy faces (dark bars from Y).", "Now we train our predictive model using a logistic regression with leave-one-subject-out cross validation. For every left out subject, we train a new model with built in cross validation to choose the optimal regularization strength (see here for details).", "Here is the result, with the red dotted line representing chance at 50%.", "Woo-hoo! Our model from cross validation shows a cross validated accuracy of 57.5% which is significantly better than chance from both a t-test and bootstrapped confidence intervals (95% CI shown in bar plot). Not the best model in the world but still does better than chance so we should be good to publish right?", "It is quite possible that the model is not doing any better compared to any junk model that may arise from the data. A more stringent test would be to compare the model accuracy to a distribution of accuracies from junk models trained on randomized labels. This way you would be able to approximate how much better your model really is compared to trash models.", "To build this distribution of accuracies, we train 50 additional models in each cross validation fold ultimately creating a distribution of 2000 accuracies. In each fold, the labels of the training set is shuffled to predict the true labels of the left out subject. The significance score is determined by the number of permutations whose score is better than the true model score.", "After this procedure we find that our model performance of 57.5% is actually not significantly better than the accuracies from junk models. The percentile p-value of p = .256 suggests that approximately 26% of the models trained on mixed up labels actually performed better than our model.", "In scikit-learn, this method is also implemented as permutation_test_score which shuffles both the training and test labels. In some cases, this might generate a tighter distribution than shuffling only the training labels.", "In our simulated data, we don\u2019t see much difference between shuffling both training and testing labels and shuffling just the training labels.", "Here we simulated data to show that comparing model accuracy to chance can sometimes be misleading. A model with slightly better accuracy than chance may not be significantly better than other junk models trained on shuffled labels. However, we should also consider that the number of samples per subject may limit how truly \u201crandom\u201d your permuted models can be. For example if you only have 2 samples per subject, then shuffling those will not give you a big distribution of accuracies like you would think.", "Here are some papers regarding this matter:", "Ojala and Garriga. Permutation Tests for Studying Classifier Performance. The Journal of Machine Learning Research (2010) vol. 11", "Tags: machine-learning chance significance permutations analysis data", "Originally published at jinhyuncheong.com on December 5, 2018.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Human behavior & machine learning enthusiast || Cognitive Neuroscience PhD turned data nerd || https://jincheong.medium.com/membership"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fe3b17de6ba04&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fchance-is-not-enough-evaluating-model-significance-with-permutations-e3b17de6ba04&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fchance-is-not-enough-evaluating-model-significance-with-permutations-e3b17de6ba04&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fchance-is-not-enough-evaluating-model-significance-with-permutations-e3b17de6ba04&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fchance-is-not-enough-evaluating-model-significance-with-permutations-e3b17de6ba04&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----e3b17de6ba04--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----e3b17de6ba04--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://jincheong.medium.com/?source=post_page-----e3b17de6ba04--------------------------------", "anchor_text": ""}, {"url": "https://jincheong.medium.com/?source=post_page-----e3b17de6ba04--------------------------------", "anchor_text": "Jin Cheong, PhD"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fed25f2e73793&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fchance-is-not-enough-evaluating-model-significance-with-permutations-e3b17de6ba04&user=Jin+Cheong%2C+PhD&userId=ed25f2e73793&source=post_page-ed25f2e73793----e3b17de6ba04---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe3b17de6ba04&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fchance-is-not-enough-evaluating-model-significance-with-permutations-e3b17de6ba04&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe3b17de6ba04&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fchance-is-not-enough-evaluating-model-significance-with-permutations-e3b17de6ba04&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.linear_model.LogisticRegressionCV.html#sklearn.linear_model.LogisticRegressionCV", "anchor_text": "here for details"}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.permutation_test_score.html#sklearn.model_selection.permutation_test_score", "anchor_text": "permutation_test_score"}, {"url": "http://www.jmlr.org/papers/volume11/ojala10a/ojala10a.pdf", "anchor_text": "Ojala and Garriga. Permutation Tests for Studying Classifier Performance. The Journal of Machine Learning Research (2010) vol. 11"}, {"url": "http://jinhyuncheong.com/tag/machine-learning", "anchor_text": "machine-learning"}, {"url": "http://jinhyuncheong.com/tag/chance", "anchor_text": "chance"}, {"url": "http://jinhyuncheong.com/tag/significance", "anchor_text": "significance"}, {"url": "http://jinhyuncheong.com/tag/permutations", "anchor_text": "permutations"}, {"url": "http://jinhyuncheong.com/tag/analysis", "anchor_text": "analysis"}, {"url": "http://jinhyuncheong.com/tag/data", "anchor_text": "data"}, {"url": "http://jinhyuncheong.com/jekyll/update/2018/12/05/Chance_is_not_enough.html", "anchor_text": "jinhyuncheong.com"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----e3b17de6ba04---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/statistics?source=post_page-----e3b17de6ba04---------------statistics-----------------", "anchor_text": "Statistics"}, {"url": "https://medium.com/tag/data-science?source=post_page-----e3b17de6ba04---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/python?source=post_page-----e3b17de6ba04---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/tutorial?source=post_page-----e3b17de6ba04---------------tutorial-----------------", "anchor_text": "Tutorial"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fe3b17de6ba04&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fchance-is-not-enough-evaluating-model-significance-with-permutations-e3b17de6ba04&user=Jin+Cheong%2C+PhD&userId=ed25f2e73793&source=-----e3b17de6ba04---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fe3b17de6ba04&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fchance-is-not-enough-evaluating-model-significance-with-permutations-e3b17de6ba04&user=Jin+Cheong%2C+PhD&userId=ed25f2e73793&source=-----e3b17de6ba04---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe3b17de6ba04&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fchance-is-not-enough-evaluating-model-significance-with-permutations-e3b17de6ba04&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----e3b17de6ba04--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fe3b17de6ba04&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fchance-is-not-enough-evaluating-model-significance-with-permutations-e3b17de6ba04&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----e3b17de6ba04---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----e3b17de6ba04--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----e3b17de6ba04--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----e3b17de6ba04--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----e3b17de6ba04--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----e3b17de6ba04--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----e3b17de6ba04--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----e3b17de6ba04--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----e3b17de6ba04--------------------------------", "anchor_text": ""}, {"url": "https://jincheong.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://jincheong.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Jin Cheong, PhD"}, {"url": "https://jincheong.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "714 Followers"}, {"url": "https://jincheong.medium.com/membership", "anchor_text": "https://jincheong.medium.com/membership"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fed25f2e73793&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fchance-is-not-enough-evaluating-model-significance-with-permutations-e3b17de6ba04&user=Jin+Cheong%2C+PhD&userId=ed25f2e73793&source=post_page-ed25f2e73793--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fffeafbcaaa7f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fchance-is-not-enough-evaluating-model-significance-with-permutations-e3b17de6ba04&newsletterV3=ed25f2e73793&newsletterV3Id=ffeafbcaaa7f&user=Jin+Cheong%2C+PhD&userId=ed25f2e73793&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}