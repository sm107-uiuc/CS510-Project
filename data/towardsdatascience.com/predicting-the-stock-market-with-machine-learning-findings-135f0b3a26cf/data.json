{"url": "https://towardsdatascience.com/predicting-the-stock-market-with-machine-learning-findings-135f0b3a26cf", "time": 1683005989.558749, "path": "towardsdatascience.com/predicting-the-stock-market-with-machine-learning-findings-135f0b3a26cf/", "webpage": {"metadata": {"title": "Predicting the Stock Market with Machine Learning. Findings. | by Vitalii Dodonov | Towards Data Science", "h1": "Predicting the Stock Market with Machine Learning. Findings.", "description": "In this article, I present my key findings from predicting the next year\u2019s income of the S&P500 companies between 2014 and 2019. While it is not required, I encourage the reader to see my path\u2026"}, "outgoing_paragraph_urls": [{"url": "https://towardsdatascience.com/predicting-the-stock-market-with-machine-learning-drivers-295d85d406e7?source=friends_link&sk=ceb5326ca92e917eceecb02beea7efbd", "anchor_text": "previous article", "paragraph_index": 2}, {"url": "https://towardsdatascience.com/explain-your-model-with-the-shap-values-bc36aac4de3d", "anchor_text": "here", "paragraph_index": 4}], "all_paragraphs": ["In this article, I present my key findings from predicting the next year\u2019s income of the S&P500 companies between 2014 and 2019. While it is not required, I encourage the reader to see my path towards the observations I share here:", "The key to designing an excellent machine learning model is to know exactly what it is doing. Reaching this understanding may be easy when working with something like Regression and incredibly difficult when working with Deep Learning Neural Networks. Nevertheless, the one in charge should always aim to understand how the model is thinking. Without it, model\u2019s predictions aren\u2019t worth anything.", "In the previous article, I\u2019ve reduced the number of features used in the original model from 100 to 9 without sacrificing model performance. The remaining features were:", "I\u2019ve used Random Forest feature importance to determine what features should stay and what features should be discarded. While feature importances helped me to understand how much weight each variable had in predicting the score, it did not tell me how exactly each feature affected that score. Should the Operating Margin be high or low? Do we look for high Dividends to Earnings or low? How much cash should there be?", "One method that contributes direction to feature importances in tree-based algorithms takes advantage of SHAP values. Take a look here if you are not familiar with this technique.", "SHAP values for my model are presented below. Please note that I\u2019ve removed Non Operating Expense from the features described above as it didn\u2019t add tangible value to the model performance.", "The X axis on this plot measures the impact each feature has on the prediction score. The Y axis shows all features used to generate a prediction score. The color bar shows whether the value of that feature is high or low. For example, high dividends to earnings encourage the model to make a positive prediction (red color, positive SHAP value). High return on tangible assets, however, encourages the model to make a negative prediction (red color, negative SHAP).", "This plot reveals relationships that might not be intuitive to an intelligent investor. It says that companies that double their income in the following year should have low return on capital, low return on tangible assets and low operating margin \u2014 all of which are indicators of poor business performance.", "SHAP value analysis allows me to look at how each feature impacts predictions at an individual sample level. Let\u2019s take a look at the top 2 correct predictions my model has made.", "The model predicted Starbucks (SBUX) to double its income in 2013. Let\u2019s look at it in detail. All 8 predictors are in the red, positively contributing to the prediction score, pushing it all the way up to 0.96.", "As expected from the \u201cFinding Direction\u201d section, we have suspiciously low Return on Capital (0.001), yet suspiciously high Free Cash Flow to Earnings (520) and a Dividends to Earnings ratio (76).", "These ratios are not within the normal range and encourage further investigation. The company had enough cash to pay the usual dividends yet didn\u2019t have much income. Let\u2019s see how this fits with the global picture by looking at Vhinny\u2019s Historical Ratios & Data.", "Indeed, net income reported in 2013 was $8.3M, which is a large drop compared to $1.4B and $2.1B in 2012 and 2014 respectively. Going one step further, one would find a $2.8B litigation charge Starbucks wrote down that year. While $2.8B was a heavy hit, Starbucks\u2019 earning potential wasn\u2019t hurt. High Free Cash Flow to Earnings showed that the business made money nevertheless and carried on with normal operation. Sure enough, net income returned back to normal the following year, proving my model\u2019s prediction to be correct.", "Having seen how the model makes confident positive predictions, let\u2019s take a look at how it makes confident negative predictions. Below are the SHAP values for the top 2 negative predictions.", "For these two examples, all 8 predictors are in the blue, negatively affecting the predicted score. In fact, the predicted score for both these examples is 0.00 \u2014 as low as it can be.", "Looking at Home Depot (HD), one can see a good Return on Tangible Assets (0.20) and a good Return on Capital (0.26) as well as Free Cash Flow to Earnings around 1.41 which is in the normal range. Similar observations can be made for Helen of Troy (HELE).", "These three metrics define HD and HELE as profitable companies generating high returns. Investors generally like this type of companies due to their strong business performance. Why does my model believe that a good business would not double its income in the following year?", "While it is not impossible for good companies to double their annual income, the data suggests that, in general, companies that have strong business characteristics grow gradually and confidently. Practically speaking, it would take twice as many people building houses around the world for Home Depot to double its earnings. With $80B in annual sales, it is just not likely to happen under normal circumstances. For the model to predict the possibility of drastic increase in earnings, there needs to be something in the outlier zone in the data, which is what we saw with confident positive examples.", "In this article, I\u2019ve described how the model I\u2019ve built to predict next year\u2019s income makes its decisions. The results suggest that good businesses under normal operating conditions are not likely to double their earnings in the following year. At the same time, businesses that lost their income due to a \u201cone time\u201d event are likely to get back on their feet and continue their operations as normal. The model was able to identify such companies by analyzing how much cash the company made in a given year in context of tis income.", "I encourage the reader to take my results as ideas and conduct their own study if the reader, just like myself, is looking to find signal in the data and concur the stock market. If the reader is interested in this particular study, a good place to advance my findings would be to look at how company size affects the probability of a business getting back to normal after it took a hit.", "This article concludes this series of predicting the next year\u2019s income using fundamental financial data. I hope the reader finds the insights I\u2019ve shared here valuable and and take advantage of them in their own stock selection process.", "I\u2019m moving on to studying the stock market crush of 2020. See you in the next one!", "I\u2019m happy to connect with people who share my path, which is the pursuit of financial independence. If you also search for financial independence or if you\u2019d like to collaborate, bounce ideas or exchange thoughts, feel free to reach out! Here are some resources I manage:", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Co-founder, Head of Engineering at Stan - enabling creators to become entrepreneurs."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F135f0b3a26cf&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-the-stock-market-with-machine-learning-findings-135f0b3a26cf&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-the-stock-market-with-machine-learning-findings-135f0b3a26cf&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-the-stock-market-with-machine-learning-findings-135f0b3a26cf&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-the-stock-market-with-machine-learning-findings-135f0b3a26cf&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----135f0b3a26cf--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----135f0b3a26cf--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@vitddnv?source=post_page-----135f0b3a26cf--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@vitddnv?source=post_page-----135f0b3a26cf--------------------------------", "anchor_text": "Vitalii Dodonov"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F650c747f45df&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-the-stock-market-with-machine-learning-findings-135f0b3a26cf&user=Vitalii+Dodonov&userId=650c747f45df&source=post_page-650c747f45df----135f0b3a26cf---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F135f0b3a26cf&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-the-stock-market-with-machine-learning-findings-135f0b3a26cf&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F135f0b3a26cf&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-the-stock-market-with-machine-learning-findings-135f0b3a26cf&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://stock.adobe.com/ca/search?filters%5Bcontent_type%3Aphoto%5D=1&filters%5Bcontent_type%3Aillustration%5D=1&filters%5Bcontent_type%3Azip_vector%5D=1&filters%5Bcontent_type%3Avideo%5D=1&filters%5Bcontent_type%3Atemplate%5D=1&filters%5Bcontent_type%3A3d%5D=1&filters%5Bcontent_type%3Aimage%5D=1&k=performance&order=relevance&safe_search=1&search_page=1&search_type=usertyped&acp=&aco=performance&limit=100&get_facets=0&asset_id=305061159&continue_checkout=1", "anchor_text": "Image"}, {"url": "https://stock.adobe.com/ca/contributor/207328848/teerapon?load_type=author&prev_url=detail", "anchor_text": "teerapon"}, {"url": "https://medium.com/vhinny-investing/predicting-the-stock-market-with-machine-learning-introduction-310cd6069ffa?source=friends_link&sk=d4479bf5481f19b2b0b7ac9fe87366af", "anchor_text": "Predicting the Stock Market with Machine Learning. Introduction."}, {"url": "https://medium.com/vhinny-investing/predicting-the-stock-market-with-machine-learning-benchmarking-44181286389?source=friends_link&sk=a5e00eb9c7a7ae1b59e0903b2a942532", "anchor_text": "Predicting the Stock Market with Machine Learning. Benchmarking."}, {"url": "https://towardsdatascience.com/predicting-the-stock-market-with-machine-learning-drivers-295d85d406e7?source=friends_link&sk=ceb5326ca92e917eceecb02beea7efbd", "anchor_text": "Predicting the Stock Market with Machine Learning. Drivers."}, {"url": "https://towardsdatascience.com/predicting-the-stock-market-with-machine-learning-drivers-295d85d406e7?source=friends_link&sk=ceb5326ca92e917eceecb02beea7efbd", "anchor_text": "previous article"}, {"url": "https://towardsdatascience.com/explain-your-model-with-the-shap-values-bc36aac4de3d", "anchor_text": "here"}, {"url": "https://www.vhinny.com/display/SBUX", "anchor_text": "https://www.vhinny.com/display/SBUX"}, {"url": "http://www.vhinny.com/", "anchor_text": "www.vhinny.com"}, {"url": "https://www.linkedin.com/company/vhinny", "anchor_text": "https://www.linkedin.com/company/vhinny"}, {"url": "https://medium.com/tag/vhinny?source=post_page-----135f0b3a26cf---------------vhinny-----------------", "anchor_text": "Vhinny"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----135f0b3a26cf---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/investing?source=post_page-----135f0b3a26cf---------------investing-----------------", "anchor_text": "Investing"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----135f0b3a26cf---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/business-intelligence?source=post_page-----135f0b3a26cf---------------business_intelligence-----------------", "anchor_text": "Business Intelligence"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F135f0b3a26cf&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-the-stock-market-with-machine-learning-findings-135f0b3a26cf&user=Vitalii+Dodonov&userId=650c747f45df&source=-----135f0b3a26cf---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F135f0b3a26cf&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-the-stock-market-with-machine-learning-findings-135f0b3a26cf&user=Vitalii+Dodonov&userId=650c747f45df&source=-----135f0b3a26cf---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F135f0b3a26cf&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-the-stock-market-with-machine-learning-findings-135f0b3a26cf&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----135f0b3a26cf--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F135f0b3a26cf&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-the-stock-market-with-machine-learning-findings-135f0b3a26cf&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----135f0b3a26cf---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----135f0b3a26cf--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----135f0b3a26cf--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----135f0b3a26cf--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----135f0b3a26cf--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----135f0b3a26cf--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----135f0b3a26cf--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----135f0b3a26cf--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----135f0b3a26cf--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@vitddnv?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@vitddnv?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Vitalii Dodonov"}, {"url": "https://medium.com/@vitddnv/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "233 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F650c747f45df&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-the-stock-market-with-machine-learning-findings-135f0b3a26cf&user=Vitalii+Dodonov&userId=650c747f45df&source=post_page-650c747f45df--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F6950772ae056&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-the-stock-market-with-machine-learning-findings-135f0b3a26cf&newsletterV3=650c747f45df&newsletterV3Id=6950772ae056&user=Vitalii+Dodonov&userId=650c747f45df&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}