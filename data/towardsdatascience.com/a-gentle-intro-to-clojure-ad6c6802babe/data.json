{"url": "https://towardsdatascience.com/a-gentle-intro-to-clojure-ad6c6802babe", "time": 1683014366.225425, "path": "towardsdatascience.com/a-gentle-intro-to-clojure-ad6c6802babe/", "webpage": {"metadata": {"title": "A gentle intro to Clojure. A small, real-world example; exploring\u2026 | by Duane Bester | Towards Data Science", "h1": "A gentle intro to Clojure", "description": "We will be using HttpKit to access the GitHub API and pull down information about an organization\u2019s repositories. We will then leverage Clojure\u2019s built in features to manipulate and explore the\u2026"}, "outgoing_paragraph_urls": [{"url": "http://http-kit.github.io/", "anchor_text": "HttpKit", "paragraph_index": 0}, {"url": "https://docs.github.com/en/free-pro-team@latest/github/authenticating-to-github/creating-a-personal-access-token", "anchor_text": "easiest to generate a Personal Access Token", "paragraph_index": 5}], "all_paragraphs": ["We will be using HttpKit to access the GitHub API and pull down information about an organization\u2019s repositories. We will then leverage Clojure\u2019s built in features to manipulate and explore the collection. For now, we won\u2019t attempt anything asynchronous or complicated \u2014 we can leave that for a future post :)", "In some new directory, I created a deps.edn file with the following dependencies:", "Then we can fire up a clj REPL in the same directory as the deps.edn file:", "And require (paste in) our dependencies in the REPL:", "Keys in maps are also functions, which allows us to access key-values from a map very succinctly. Say we define a map called test-map with :error and :status properties. We could access the property :status like so:", "\ud83d\udc4b It\u2019s easiest to generate a Personal Access Token to use the API.", "At this point, it\u2019s best to try and access the GitHub API to make sure our Authentication and URLs are correct. Adjust the def's below to your own info/settings and paste them into the REPL:", "The HttpKit (http/get) function returns a promise. This promise will resolve to a map once completed. We can block until this promise is complete by using the @ symbol: @(http/get .. ..) Once completed, we can access the various key-values, like :status, which should be 200:", "GitHub has a nice pagination model, which we will leverage to tell us if we need to make more requests. If we look at the response headers, there is a property called link which contains a comma-delimited array of links and their relative position to the current page. We can access this from the response map with the get-in function. We can then tell if we have a next page to fetch if the link string contains rel=\"next\":", "We can now create a get-repos function to put all of the above together. It takes two parameters; page and per_page \u2014 the current page number and the amount of repositories to return per page, respectively:", "\u26a0\ufe0f As of now, the max per_page for the GitHub API is 100.", "Note that our get-repos function returns a map containing the response :body as a parsed json array, and :has_next as a boolean.", "We have all the small logic to make requests and retrieve GitHub repositories. Next we need to loop through all the pages of data and add the repos to an ever-growing list.", "Loops in Clojure are either awesome / or a disaster depending on your background. So let\u2019s start with a simple loop. Here we bind i to 0 and call recur only if i < 5. When we call recur we bind i to the value of i + 1thus incrementing i and printing it\u2019s value:", "The value of the above expression is then the last returned value of the loop function. In this case, 5. If we set this expression to a def we\u2019d set the value of that def to 5:", "We can quickly gut-check ourselves to make sure we have more pages after requesting just one repository.", "\ud83d\udc4b Please make sure your organization has more than one repository! \ud83d\ude05", "Notice how we have multiple let bindings below. First, resp gets set to the result of the expression (get-repos 1 1) and then has_next will have access to the newly set resp variable, all on the same line of code:", "We can combine the above with some looping logic to fetch all repositories. I place all repositories in a global list called repos:", "I know I have 200+ repositories in my organization, so I set the per_page variable to the max of 100.", "Run a quick check to make sure the count of repositories matches what you\u2019d expect:", "Great! We have all of our repositories inside a global atomic list. We can now slice and dice that data as we see fit.", "Let\u2019s try and see how many of the repos are active, I.E. not archived. We can achieve this using Clojure\u2019s filter along with an anonymous function. The anonymous function accepts a repository map as an input and checks to see whether the :archived property is false:", "And there we have it! The active-repos contains repositories that will have a property :archived equal to false.", "I hope this was a useful way to get into some Clojure! We leverage a library to make http requests and then core language features to do some basic looping, filtering, multi-lets, and state management.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Multifaceted engineer with hardware, firmware, and software experience"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fad6c6802babe&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-gentle-intro-to-clojure-ad6c6802babe&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-gentle-intro-to-clojure-ad6c6802babe&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-gentle-intro-to-clojure-ad6c6802babe&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-gentle-intro-to-clojure-ad6c6802babe&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----ad6c6802babe--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----ad6c6802babe--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@duanebester?source=post_page-----ad6c6802babe--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@duanebester?source=post_page-----ad6c6802babe--------------------------------", "anchor_text": "Duane Bester"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F6ac42aa43508&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-gentle-intro-to-clojure-ad6c6802babe&user=Duane+Bester&userId=6ac42aa43508&source=post_page-6ac42aa43508----ad6c6802babe---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fad6c6802babe&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-gentle-intro-to-clojure-ad6c6802babe&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fad6c6802babe&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-gentle-intro-to-clojure-ad6c6802babe&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@arianismmm?utm_source=medium&utm_medium=referral", "anchor_text": "Arian Darvishi"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "http://http-kit.github.io/", "anchor_text": "HttpKit"}, {"url": "https://docs.github.com/en/free-pro-team@latest/github/authenticating-to-github/creating-a-personal-access-token", "anchor_text": "easiest to generate a Personal Access Token"}, {"url": "https://medium.com/tag/clojure?source=post_page-----ad6c6802babe---------------clojure-----------------", "anchor_text": "Clojure"}, {"url": "https://medium.com/tag/functional-programming?source=post_page-----ad6c6802babe---------------functional_programming-----------------", "anchor_text": "Functional Programming"}, {"url": "https://medium.com/tag/api?source=post_page-----ad6c6802babe---------------api-----------------", "anchor_text": "API"}, {"url": "https://medium.com/tag/programming?source=post_page-----ad6c6802babe---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fad6c6802babe&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-gentle-intro-to-clojure-ad6c6802babe&user=Duane+Bester&userId=6ac42aa43508&source=-----ad6c6802babe---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fad6c6802babe&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-gentle-intro-to-clojure-ad6c6802babe&user=Duane+Bester&userId=6ac42aa43508&source=-----ad6c6802babe---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fad6c6802babe&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-gentle-intro-to-clojure-ad6c6802babe&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----ad6c6802babe--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fad6c6802babe&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-gentle-intro-to-clojure-ad6c6802babe&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----ad6c6802babe---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----ad6c6802babe--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----ad6c6802babe--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----ad6c6802babe--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----ad6c6802babe--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----ad6c6802babe--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----ad6c6802babe--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----ad6c6802babe--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----ad6c6802babe--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@duanebester?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@duanebester?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Duane Bester"}, {"url": "https://medium.com/@duanebester/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "138 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F6ac42aa43508&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-gentle-intro-to-clojure-ad6c6802babe&user=Duane+Bester&userId=6ac42aa43508&source=post_page-6ac42aa43508--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F42fd6d6bf29d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-gentle-intro-to-clojure-ad6c6802babe&newsletterV3=6ac42aa43508&newsletterV3Id=42fd6d6bf29d&user=Duane+Bester&userId=6ac42aa43508&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}