{"url": "https://towardsdatascience.com/google-sheet-data-warehouse-c22bb2cce4b0", "time": 1682996121.79441, "path": "towardsdatascience.com/google-sheet-data-warehouse-c22bb2cce4b0/", "webpage": {"metadata": {"title": "The ultimate guide to Google Sheets as a reliable data source | by Josh Temple | Towards Data Science", "h1": "The ultimate guide to Google Sheets as a reliable data source", "description": "I occasionally need to grant a non-technical colleague the ability to input information into our data warehouse on an ad-hoc basis. For example, our customer service team at Milk Bar maintains a list\u2026"}, "outgoing_paragraph_urls": [{"url": "https://milkbarstore.com/", "anchor_text": "Milk Bar", "paragraph_index": 0}, {"url": "https://milkbarstore.com/pages/weddings", "anchor_text": "wedding cake", "paragraph_index": 0}, {"url": "https://developers.google.com/apps-script/reference/spreadsheet/data-validation-builder", "anchor_text": "DataValidationBuilder", "paragraph_index": 14}, {"url": "https://support.google.com/docs/answer/78413", "anchor_text": "here", "paragraph_index": 19}, {"url": "https://support.google.com/docs/answer/3093340?hl=en", "anchor_text": "formula", "paragraph_index": 20}, {"url": "https://cloud.google.com/bigquery/external-data-drive", "anchor_text": "describes how to do this", "paragraph_index": 25}, {"url": "https://medium.com/@josh.temple/automated-testing-in-the-modern-data-warehouse-d5a251a866af", "anchor_text": "here", "paragraph_index": 28}, {"url": "https://www.getdbt.com/", "anchor_text": "data build tool (dbt)", "paragraph_index": 28}, {"url": "https://milkbarstore.com/", "anchor_text": "Milk Bar", "paragraph_index": 28}, {"url": "https://gsuite.google.com/campaigns/index__sheets-connectedsheet.html?_ga=2.200438701.-241340023.1532979384", "anchor_text": "here", "paragraph_index": 31}], "all_paragraphs": ["I occasionally need to grant a non-technical colleague the ability to input information into our data warehouse on an ad-hoc basis. For example, our customer service team at Milk Bar maintains a list of special wedding cake orders in Google Sheets that we need to collect data from for downstream calculations.", "This is a tricky problem for a data engineer \u2014 my colleagues don\u2019t have the technical skill to interact directly with our data stack, and I don\u2019t want to have to support my own web form or similarly involved infrastructure to collect this information. What if we could sync their Google Sheet directly to a table in our data warehouse?", "At first glance, this sounds like a terrible idea. Free data entry into a data warehouse table with no schema control is a data engineer\u2019s nightmare. What\u2019s to stop someone from accidentally deleting a column or entering data of the wrong type? How do I know that my colleagues are entering data according to my expectations? I can already feel your heart starting to race thinking about how many best practices this approach violates!", "Stay with me. I\u2019m here to convince you that Google Sheets, with the proper guardrails in place, is an excellent way for colleagues outside of an analytics team to input tabular data for downstream use, even in automated transformations!", "We\u2019re going to explore setting up a restricted, data-validated Google Sheet and discuss options for syncing that data to your data warehouse, testing it, and even sending transformed results back to Sheets for your colleagues to view or analyze.", "We\u2019ll start with the most obvious protection you should enforce on your Google Sheet data source: share permissions. Plainly and simply, the only people allowed to edit your sheet should be people you trust to edit it appropriately and have been trained to do so. Keep link sharing off unless you need it to be on, in which case, link permissions should be set to can view.", "The next important step is often overlooked because the setting is hidden away in Google\u2019s Advanced section of the share menu. Make sure you restrict editors from adding new people or changing access. You want to be sure that your colleagues won\u2019t inadvertently add unapproved editors.", "In addition to workbook-level permissions like we set above, we can also set permissions for individual sheets and even specific cell ranges.", "To set these permissions, navigate to the Data menu and select Protected sheets and ranges. You can restrict sheets and ranges so they can only be edited by certain people, or allow people to edit them only after acknowledging a warning about the consequences of their actions.", "You might have some sheets that contain necessary information for formulas or calculations that don\u2019t need to be edited by any of your users. If that\u2019s the case, protect these sheets so only you can modify them.", "Thorough data validation is what makes Google Sheets a reliable option for direct sync to your data warehouse. With data validation, you can impose virtually any constraint you can think of on the desired range in your sheet.", "You can get to Data Validation from the Data menu in Google Sheets. Data validation asks you for a cell range, a constraint, and an action to take if that constraint is not met.", "I would recommend \u201cReject input\u201d for the action your sheet should take when invalid data is entered. Google\u2019s \u201cShow warning\u201d option displays a tiny orange triangle in the top right corner of the problematic cell, and it\u2019s very easy for the user to miss. Rejecting everything that doesn\u2019t validate ensures you\u2019re only passing clean data downstream to any automated processes that depend on a consistent schema.", "I\u2019ll go through each constraint option provided by Google and discuss how we might use each one to qualify clean data and reject messy data.", "If that doesn\u2019t give you enough to test, you can write a custom Google Apps Script with the DataValidationBuilder class to implement your own rule.", "Modifying data validation you\u2019ve already put in place is a bit annoying. There\u2019s no consolidated list of all the validation rules you\u2019ve applied within a sheet. Instead, you have to select the cell or range of interest and return to the Data Validation menu to remove or modify criteria.", "Once you\u2019ve thoroughly validated the data in your Google Sheet, your sheet will be just as good as a custom web form, if not better. You can be very confident in the quality of your data.", "Sometimes rejecting a user\u2019s input with data validation is too strict and makes for a bad user experience. You can use Google\u2019s option to \u201cShow warning,\u201d but the orange warning triangle that gets added is too easy for a user to miss. I prefer to use conditional formatting to turn the whole cell in question an alarming shade of red or an approving shade of green.", "Let\u2019s say you want to warn users if they enter a value that is more than two standard deviations greater or less than the average. You could set up a formula with conditional formatting to turn the cell yellow as warning to the user that the value is an outlier and may have been entered incorrectly.", "Sure, you could use a custom data validation formula to reject the value, but conditional formatting gives you shades of gray (literally!) to signal to your users beyond accepted or rejected. Occasionally that flexibility is nice to have. I\u2019m not going to go into the specifics of setting up conditional formatting, but Google\u2019s documentation on the feature is here if you\u2019re not familiar with the concept.", "Instead of syncing directly from the user-accessed sheet to the data warehouse, I like to set up an intermediate import sheet that only I can edit. This intermediate sheet provides me with a bit more control. I configure this sheet to copy all the data from the user-accessed sheet using the IMPORTRANGE formula. This sheet is where I can make any necessary adjustments before I pass it to my data warehouse.", "If users don\u2019t need to edit data after they enter it, you can set up an append-only system using a Google Form. Google Forms has a native integration with Google Sheets, which makes this setup dead simple for append-only needs. Google Forms will append a row for each response to your form in a timestamped Google Sheet. If you add questions, the sheet will expand to match your form.", "Ensure clean data by choosing the appropriate question types for your form. To configure the Google Sheets integration, you\u2019ll need to click the Google Sheets logo in the responses tab, which will generate the sheet.", "Since you don\u2019t have the ability to reject data outside of the form\u2019s own validation, I would recommend setting up an intermediate importer sheet as discussed above. Perform any required filtering there to get your data in a clean state for load.", "Loading a Google Sheet into a data warehouse is a common problem, so there are a lot of potential solutions.", "If you\u2019re a Google BigQuery user, the easiest approach, by far, is to set up the Google Sheet as an external table. BigQuery\u2019s documentation describes how to do this in more detail, but all you need to do is define a schema for the table and you can query the first tab of your sheet directly from BigQuery.", "If you\u2019re using Snowflake, Redshift, or another data warehouse, you can take your pick from these other options.", "Once the data is syncing to your warehouse, you\u2019re more or less done! If you still have concerns about data quality or aren\u2019t entirely satisfied with the data validation you set up, you can test your synced data warehouse table as a staging table. Once your data passes your SQL tests, copy it to production.", "Testing data in the data warehouse is a larger topic, (a topic I\u2019ve written about extensively here), but we use data build tool (dbt) at Milk Bar to achieve this. dbt manages our data warehouse and runs our SQL tests in our CI pipeline to check for any data issues that escaped validation.", "If you\u2019re a BigQuery user and your company uses GSuite, there\u2019s one more capability that I have to mention. You can query BigQuery data into Google Sheets.", "In the Data menu in Google Sheets, there\u2019s an option for Data Connectors. Here you can connect to your BigQuery data warehouse and query tables with SQL to return live data into your Google Sheet. Perform any necessary downstream calculations or transformations in your warehouse, then return valuable information to your users at a cadence appropriate for your data stack.", "This approach only supports up to 10,000 rows, but Google is testing an extension of this feature called Connected Sheets, which will allow you to return the entire table to Google Sheets, no matter how large it is. This feature is currently in beta, which you can apply for here.", "I hope this guide has equipped you to set up your own Google Sheet data sources confidently and correctly. If you have concerns about or creative ideas for using Google Sheets as a data source, let me know in the comments.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Co-founder of @SpectaclesCI, previously @Spotify, @Milk Bar"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fc22bb2cce4b0&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgoogle-sheet-data-warehouse-c22bb2cce4b0&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgoogle-sheet-data-warehouse-c22bb2cce4b0&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgoogle-sheet-data-warehouse-c22bb2cce4b0&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgoogle-sheet-data-warehouse-c22bb2cce4b0&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----c22bb2cce4b0--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----c22bb2cce4b0--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@josh.temple?source=post_page-----c22bb2cce4b0--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@josh.temple?source=post_page-----c22bb2cce4b0--------------------------------", "anchor_text": "Josh Temple"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F483b10a7a53e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgoogle-sheet-data-warehouse-c22bb2cce4b0&user=Josh+Temple&userId=483b10a7a53e&source=post_page-483b10a7a53e----c22bb2cce4b0---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc22bb2cce4b0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgoogle-sheet-data-warehouse-c22bb2cce4b0&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc22bb2cce4b0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgoogle-sheet-data-warehouse-c22bb2cce4b0&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://milkbarstore.com/", "anchor_text": "Milk Bar"}, {"url": "https://milkbarstore.com/pages/weddings", "anchor_text": "wedding cake"}, {"url": "https://developers.google.com/apps-script/reference/spreadsheet/data-validation-builder", "anchor_text": "DataValidationBuilder"}, {"url": "https://support.google.com/docs/answer/78413", "anchor_text": "here"}, {"url": "https://support.google.com/docs/answer/3093340?hl=en", "anchor_text": "formula"}, {"url": "https://stackoverflow.com/q/31657470/3524951", "anchor_text": "vertical array"}, {"url": "https://support.google.com/docs/answer/3093343?hl=en", "anchor_text": "formula"}, {"url": "https://cloud.google.com/bigquery/external-data-drive", "anchor_text": "describes how to do this"}, {"url": "https://fivetran.com/docs/files/google-sheets", "anchor_text": "Fivetran\u2019s documentation"}, {"url": "https://www.alooma.com/docs/connect-your-data/google-drive-and-sheets/google-sheets-integration", "anchor_text": "Alooma\u2019s"}, {"url": "https://www.stitchdata.com/blog/how-to-replicate-google-sheets-to-your-data-warehouse/", "anchor_text": "Stitch\u2019s Google Sheets integration."}, {"url": "https://gitlab.com/gitlab-data/analytics/tree/master/extract/sheetload", "anchor_text": "sheetload."}, {"url": "https://gitlab.com/", "anchor_text": "GitLab"}, {"url": "https://github.com/Ro-Data/Ro-Create-Table-From-Sheet", "anchor_text": "Ro\u2019s Google Sheet integration."}, {"url": "https://ro.co", "anchor_text": "Ro"}, {"url": "https://zapier.com/", "anchor_text": "Zapier"}, {"url": "https://medium.com/@josh.temple/automated-testing-in-the-modern-data-warehouse-d5a251a866af", "anchor_text": "here"}, {"url": "https://www.getdbt.com/", "anchor_text": "data build tool (dbt)"}, {"url": "https://milkbarstore.com/", "anchor_text": "Milk Bar"}, {"url": "https://gsuite.google.com/campaigns/index__sheets-connectedsheet.html?_ga=2.200438701.-241340023.1532979384", "anchor_text": "here"}, {"url": "https://matthewlincoln.net/", "anchor_text": "Matthew Lincoln\u2019s"}, {"url": "https://matthewlincoln.net/2018/03/26/best-practices-for-using-google-sheets-in-your-data-project.html", "anchor_text": "Best Practices for Using Google Sheets in Your Data Project"}, {"url": "https://medium.com/tag/data-science?source=post_page-----c22bb2cce4b0---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/analytics?source=post_page-----c22bb2cce4b0---------------analytics-----------------", "anchor_text": "Analytics"}, {"url": "https://medium.com/tag/data-engineering?source=post_page-----c22bb2cce4b0---------------data_engineering-----------------", "anchor_text": "Data Engineering"}, {"url": "https://medium.com/tag/google?source=post_page-----c22bb2cce4b0---------------google-----------------", "anchor_text": "Google"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fc22bb2cce4b0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgoogle-sheet-data-warehouse-c22bb2cce4b0&user=Josh+Temple&userId=483b10a7a53e&source=-----c22bb2cce4b0---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fc22bb2cce4b0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgoogle-sheet-data-warehouse-c22bb2cce4b0&user=Josh+Temple&userId=483b10a7a53e&source=-----c22bb2cce4b0---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc22bb2cce4b0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgoogle-sheet-data-warehouse-c22bb2cce4b0&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----c22bb2cce4b0--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fc22bb2cce4b0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgoogle-sheet-data-warehouse-c22bb2cce4b0&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----c22bb2cce4b0---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----c22bb2cce4b0--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----c22bb2cce4b0--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----c22bb2cce4b0--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----c22bb2cce4b0--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----c22bb2cce4b0--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----c22bb2cce4b0--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----c22bb2cce4b0--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----c22bb2cce4b0--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@josh.temple?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@josh.temple?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Josh Temple"}, {"url": "https://medium.com/@josh.temple/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "1.1K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F483b10a7a53e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgoogle-sheet-data-warehouse-c22bb2cce4b0&user=Josh+Temple&userId=483b10a7a53e&source=post_page-483b10a7a53e--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F82088900a2b2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgoogle-sheet-data-warehouse-c22bb2cce4b0&newsletterV3=483b10a7a53e&newsletterV3Id=82088900a2b2&user=Josh+Temple&userId=483b10a7a53e&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}