{"url": "https://towardsdatascience.com/fall-detection-using-pose-estimation-a8f7fd77081d", "time": 1683013962.920188, "path": "towardsdatascience.com/fall-detection-using-pose-estimation-a8f7fd77081d/", "webpage": {"metadata": {"title": "Fall Detection using Pose Estimation | by Wei Loon Cheng | Towards Data Science", "h1": "Fall Detection using Pose Estimation", "description": "Fall detection has become an important stepping stone in the research of action recognition \u2014 which is to train an AI to classify general actions such as walking and sitting down. What humans\u2026"}, "outgoing_paragraph_urls": [{"url": "https://nanonets.com/blog/human-pose-estimation-2d-guide/", "anchor_text": "do check out this article by Sudharshan Chandra Babu", "paragraph_index": 2}, {"url": "https://pypi.org/project/openpifpaf/", "anchor_text": "OpenPifPaf by VITA lab at EPFL", "paragraph_index": 4}, {"url": "http://openaccess.thecvf.com/content_CVPR_2019/html/Kreiss_PifPaf_Composite_Fields_for_Human_Pose_Estimation_CVPR_2019_paper.html", "anchor_text": "do check out their CVPR 2019 paper", "paragraph_index": 4}, {"url": "https://github.com/vita-epfl/openpifpaf", "anchor_text": "read their source code", "paragraph_index": 4}, {"url": "https://docs.python.org/2/library/multiprocessing.html", "anchor_text": "multiprocessing library in Python", "paragraph_index": 5}, {"url": "https://www.pyimagesearch.com/2018/07/23/simple-object-tracking-with-opencv/", "anchor_text": "check out this post by Adrian Rosebrock", "paragraph_index": 8}, {"url": "http://fenix.univ.rzeszow.pl/~mkepski/ds/uf.html", "anchor_text": "UR Fall Detection Dataset", "paragraph_index": 12}, {"url": "https://cocodataset.org/#download", "anchor_text": "clean images with a full-frontal view of the subject", "paragraph_index": 17}, {"url": "https://www.technologyreview.com/2020/07/20/1005454/openai-machine-learning-language-generator-gpt-3-nlp/", "anchor_text": "OpenAI\u2019s GPT-3", "paragraph_index": 23}, {"url": "https://www.linkedin.com/in/weilooncheng/", "anchor_text": "drop me a connect on LinkedIn", "paragraph_index": 24}, {"url": "https://github.com/cwlroda/falldetection_openpifpaf", "anchor_text": "do check out my GitHub repository for the source codes", "paragraph_index": 25}], "all_paragraphs": ["Fall detection has become an important stepping stone in the research of action recognition \u2014 which is to train an AI to classify general actions such as walking and sitting down. What humans interpret as an obvious action of a person falling face flat is but a sequence of jumbled up pixels for an AI. To enable the AI to make sense of the input it receives, we need to teach it to detect certain patterns and shapes, and formulate its own rules.", "To build an AI to detect falls, I decided not to go through the torture of amassing a large dataset and training a model specifically for this purpose. Instead, I used pose estimation as the building block.", "Pose estimation is the localisation of human joints \u2014 commonly known as keypoints \u2014 in images and video frames. Typically, each person will be made up of a number of keypoints. Lines will be drawn between keypoint pairs, effectively mapping a rough shape of the person. There is a variety of pose estimation methods based on input and detection approach. For a more in-depth guide to pose estimation, do check out this article by Sudharshan Chandra Babu.", "To make this model easily accessible to everyone, I chose the input as RGB images and processed by OpenCV. This means it is compatible with typical webcams, video files, and even HTTP/RTSP streams.", "The pose estimation model that I utilised was OpenPifPaf by VITA lab at EPFL. The detection approach is bottom-up, which means that the AI first analyses the entire image and figures out all the keypoints it sees. Then, it groups keypoints together to determine the people in the image. This differs from a top-down approach, where the AI uses a basic person detector to identify regions of interest, before zooming in to identify individual keypoints. To learn more about how OpenPifPaf was developed, do check out their CVPR 2019 paper, or read their source code.", "Most open-source models can only process a single input at any one time. To make this more versatile and scalable in the future, I made use of the multiprocessing library in Python to process multiple streams concurrently using subprocesses. This allows us to fully leverage multiple processors on machines with this capability.", "In video frames with multiple people, it can be difficult to figure out a person who falls. This is because the algorithm needs to correlate the same person between consecutive frames. But how does it know whether it is looking at the same person if he/she is moving constantly?", "The solution is to implement a multiple person tracker. It doesn\u2019t have to be fancy; just a simple general object tracker will suffice. How tracking is done is pretty straightforward and can be outlined in the following steps:", "If you want a step-by-step tutorial on object tracking with actual code, check out this post by Adrian Rosebrock.", "The initial fall detection algorithm that was conceptualised was relatively simplistic. I first chose the neck as the stable reference point (compare that with swinging arms and legs). Next, I calculated the perceived height of the person based on bounding boxes that defined the entire person. Then, I computed the vertical distance between neck points at intervals of frames. If the vertical distance exceeded half the perceived height of the person, the algorithm would signal a fall.", "However, after coming across multiple YouTube videos of people falling, I realised there were different ways and orientations of falling. Some falls were not detected when the field of view was at an angle, as the victims did not appear to have a drastic change in motion. My model was also not robust enough and kept throwing false positives when people bent down to tie their shoelaces, or ran straight down the video frame.", "I decided to implement more features to refine my algorithm:", "As of this writing, extensive fall detection datasets are scarce. I chose the UR Fall Detection Dataset to test my model as it contained different fall scenarios. Out of a total of 30 videos, the model correctly identified 25 falls and missed the other 5 as the subject fell out of the frame. This gave me a precision of 83.33% and an F1 score of 90.91%.", "These results can be considered a good start but are far from conclusive due to the small sample size. The lack of other fall-like actions such as tying shoelaces also meant that I could not stress test my model for false positives.", "The test was executed on two NVIDIA Quadro GV100s and achieved an average of 6 FPS, which is barely sufficient for real-time processing. The computation as a result of the numerous layers is extremely intensive. Models that claim to run at speeds above 15 FPS are typically inaccurate, or are backed by monstrous GPUs.", "Fall detection can be applied in many scenarios to provide assistance. A non-exhaustive list includes:", "For the more serious cases, swift response to a fall can mean the difference between life and death.", "The accuracy of fall detection is heavily dependent on the pose estimation accuracy. Typical pose estimation models are trained on clean images with a full-frontal view of the subject. However, falls cause the subject to be contorted in weird poses, and most pose estimation models are not able to accurately define the skeleton in such scenarios. Furthermore, the models are not robust enough to overcome occlusions or image noise.", "To attain a human-level detection accuracy, current pose estimation models will need to be retrained on a larger variety of poses, and include lower-resolution images with occlusions.", "Current hardware limitations also impede the ability of pose estimation models to run smoothly on videos with high frame rates. It will be some time before these models will be able to run easily on any laptop with a basic GPU, or even only with a CPU.", "Apart from pose estimation, a deep learning model trained specifically on falls would likely perform as well or even better. The model must be trained carefully to distinguish falls from other fall-like actions. This, of course, must be coupled with extensive, publicly available fall datasets to train the model on. Of course, such a model is limited in scope as it only can identify one particular action, and not a variety of actions.", "Another possible approach would also be knowledge-based systems, which is developing a model such that it is able to learn the way humans do. This can be achieved via a rule-based system where it makes decisions based on certain rules, or a case-based system where it applies similarities in past cases it has seen to make an informed judgement about a new case.", "To solve the more difficult problem of general action recognition \u2014 which comprises a plethora of actions \u2014 we must first understand and master the intricacies of detecting a single action. If we are able to develop a model that can easily identify a fall just like you or I would, we will be able to extract certain patterns that can allow the model to just as easily detect other types of actions.", "The path to action recognition is still undoubtedly a challenging one; but just like other cutting-edge models such as OpenAI\u2019s GPT-3, we will be able to discover new techniques previously unheard of.", "If you would like to share any ideas or opinions, do leave a comment below, or drop me a connect on LinkedIn.", "If you would like to see how I developed the full model, do check out my GitHub repository for the source codes.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Hey there! I\u2019m a final year student from Singapore, currently on exchange in ETH Z\u00fcrich studying Computer Engineering. I love to code to solve problems!"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fa8f7fd77081d&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffall-detection-using-pose-estimation-a8f7fd77081d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffall-detection-using-pose-estimation-a8f7fd77081d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffall-detection-using-pose-estimation-a8f7fd77081d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffall-detection-using-pose-estimation-a8f7fd77081d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----a8f7fd77081d--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----a8f7fd77081d--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@cwlroda?source=post_page-----a8f7fd77081d--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@cwlroda?source=post_page-----a8f7fd77081d--------------------------------", "anchor_text": "Wei Loon Cheng"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F8bec697fcefe&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffall-detection-using-pose-estimation-a8f7fd77081d&user=Wei+Loon+Cheng&userId=8bec697fcefe&source=post_page-8bec697fcefe----a8f7fd77081d---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa8f7fd77081d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffall-detection-using-pose-estimation-a8f7fd77081d&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa8f7fd77081d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffall-detection-using-pose-estimation-a8f7fd77081d&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://www.youtube.com/watch?v=UVfsgWb0_YU", "anchor_text": "\u5927\u962a \u9053\u9813\u5800 \u30e9\u30a4\u30d6\u30ab\u30e1\u30e9 osaka Dotonbori LiveCamera by \u30e9\u30b8\u30ab\u30eb\u30d3\u30c7\u30aa\u30b8\u30e7\u30c3\u30ad\u30fc RVJJP"}, {"url": "https://nanonets.com/blog/human-pose-estimation-2d-guide/", "anchor_text": "do check out this article by Sudharshan Chandra Babu"}, {"url": "https://pypi.org/project/openpifpaf/", "anchor_text": "OpenPifPaf by VITA lab at EPFL"}, {"url": "http://openaccess.thecvf.com/content_CVPR_2019/html/Kreiss_PifPaf_Composite_Fields_for_Human_Pose_Estimation_CVPR_2019_paper.html", "anchor_text": "do check out their CVPR 2019 paper"}, {"url": "https://github.com/vita-epfl/openpifpaf", "anchor_text": "read their source code"}, {"url": "https://docs.python.org/2/library/multiprocessing.html", "anchor_text": "multiprocessing library in Python"}, {"url": "https://www.youtube.com/watch?v=v0rY4x87xfs", "anchor_text": "CHINA I Beijing I Street Scenes by gracetheglobe"}, {"url": "https://www.youtube.com/watch?v=v0rY4x87xfs", "anchor_text": "CHINA I Beijing I Street Scenes by gracetheglobe"}, {"url": "https://www.pyimagesearch.com/2018/07/23/simple-object-tracking-with-opencv/", "anchor_text": "check out this post by Adrian Rosebrock"}, {"url": "https://www.youtube.com/watch?v=8Rhimam6FgQ", "anchor_text": "50 Ways to Fall by Kevin Parry"}, {"url": "http://fenix.univ.rzeszow.pl/~mkepski/ds/uf.html", "anchor_text": "UR Fall Detection Dataset"}, {"url": "https://github.com/PINTO0309/MobileNetV2-PoseEstimation", "anchor_text": "Modified OpenPose model"}, {"url": "https://www.youtube.com/watch?v=UVfsgWb0_YU", "anchor_text": "\u5927\u962a \u9053\u9813\u5800 \u30e9\u30a4\u30d6\u30ab\u30e1\u30e9 osaka Dotonbori LiveCamera by \u30e9\u30b8\u30ab\u30eb\u30d3\u30c7\u30aa\u30b8\u30e7\u30c3\u30ad\u30fc RVJJP"}, {"url": "https://cocodataset.org/#download", "anchor_text": "clean images with a full-frontal view of the subject"}, {"url": "https://www.technologyreview.com/2020/07/20/1005454/openai-machine-learning-language-generator-gpt-3-nlp/", "anchor_text": "OpenAI\u2019s GPT-3"}, {"url": "https://www.linkedin.com/in/weilooncheng/", "anchor_text": "drop me a connect on LinkedIn"}, {"url": "https://github.com/cwlroda/falldetection_openpifpaf", "anchor_text": "do check out my GitHub repository for the source codes"}, {"url": "https://medium.com/tag/fall-detection?source=post_page-----a8f7fd77081d---------------fall_detection-----------------", "anchor_text": "Fall Detection"}, {"url": "https://medium.com/tag/computer-vision?source=post_page-----a8f7fd77081d---------------computer_vision-----------------", "anchor_text": "Computer Vision"}, {"url": "https://medium.com/tag/action-recognition?source=post_page-----a8f7fd77081d---------------action_recognition-----------------", "anchor_text": "Action Recognition"}, {"url": "https://medium.com/tag/pose-estimation?source=post_page-----a8f7fd77081d---------------pose_estimation-----------------", "anchor_text": "Pose Estimation"}, {"url": "https://medium.com/tag/multiple-object-tracking?source=post_page-----a8f7fd77081d---------------multiple_object_tracking-----------------", "anchor_text": "Multiple Object Tracking"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fa8f7fd77081d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffall-detection-using-pose-estimation-a8f7fd77081d&user=Wei+Loon+Cheng&userId=8bec697fcefe&source=-----a8f7fd77081d---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fa8f7fd77081d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffall-detection-using-pose-estimation-a8f7fd77081d&user=Wei+Loon+Cheng&userId=8bec697fcefe&source=-----a8f7fd77081d---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa8f7fd77081d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffall-detection-using-pose-estimation-a8f7fd77081d&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----a8f7fd77081d--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fa8f7fd77081d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffall-detection-using-pose-estimation-a8f7fd77081d&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----a8f7fd77081d---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----a8f7fd77081d--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----a8f7fd77081d--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----a8f7fd77081d--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----a8f7fd77081d--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----a8f7fd77081d--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----a8f7fd77081d--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----a8f7fd77081d--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----a8f7fd77081d--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@cwlroda?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@cwlroda?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Wei Loon Cheng"}, {"url": "https://medium.com/@cwlroda/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "29 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F8bec697fcefe&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffall-detection-using-pose-estimation-a8f7fd77081d&user=Wei+Loon+Cheng&userId=8bec697fcefe&source=post_page-8bec697fcefe--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fae24ea6af270&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffall-detection-using-pose-estimation-a8f7fd77081d&newsletterV3=8bec697fcefe&newsletterV3Id=ae24ea6af270&user=Wei+Loon+Cheng&userId=8bec697fcefe&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}