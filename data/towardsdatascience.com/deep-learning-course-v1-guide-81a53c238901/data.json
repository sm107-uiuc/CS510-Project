{"url": "https://towardsdatascience.com/deep-learning-course-v1-guide-81a53c238901", "time": 1683010366.576282, "path": "towardsdatascience.com/deep-learning-course-v1-guide-81a53c238901/", "webpage": {"metadata": {"title": "Model with TensorFlow and Serve on Google Cloud Platform | by MA Raza, Ph.D. | Towards Data Science", "h1": "Model with TensorFlow and Serve on Google Cloud Platform", "description": "In this guide, we learn how to develop a TensorFlow model and serve it on the Google Cloud Platform (GCP). We consider a regression problem of predicting the earnings of products using a three-layer\u2026"}, "outgoing_paragraph_urls": [{"url": "https://github.com/amjadraza/blogs-data/tree/master/deep_leraning_tensorflow", "anchor_text": "data_deep_learning", "paragraph_index": 5}, {"url": "https://medium.com/@prajwal.prashanth22/google-colab-drive-as-persistent-storage-for-long-training-runs-cb82bc1d5b71", "anchor_text": "Using Google Colab GPU VM + Drive as persistent storage for long Deep Learning training runs", "paragraph_index": 6}, {"url": "https://machinelearningmastery.com/blog/.", "anchor_text": "https://machinelearningmastery.com/blog/.", "paragraph_index": 10}, {"url": "https://scikit-learn.org/stable/modules/preprocessing.html", "anchor_text": "Scikit-learn", "paragraph_index": 12}, {"url": "https://scikit-learn.org/stable/modules/preprocessing.html", "anchor_text": "the Scikit-learn transformation module", "paragraph_index": 13}, {"url": "https://blog.tensorflow.org/2020/04/how-to-deploy-tensorflow-2-models-on-cloud-ai-platform.html", "anchor_text": "How-to deploy TensorFlow 2 Models on Cloud AI Platform", "paragraph_index": 26}, {"url": "https://blog.tensorflow.org/2020/04/how-to-deploy-tensorflow-2-models-on-cloud-ai-platform.html", "anchor_text": "How-to deploy TensorFlow 2 Models on Cloud AI Platform", "paragraph_index": 32}], "all_paragraphs": ["In this guide, we learn how to develop a TensorFlow model and serve it on the Google Cloud Platform (GCP). We consider a regression problem of predicting the earnings of products using a three-layer neural network implemented with TensorFlow and Keras APIs.", "The key learning outcomes of this guide are", "In this guide, we will use the TensorFlow 2.1.0 and Google colab runtime environment. We will be using the google colab for training the models using TensorFlow and Keras APIS. Starting from TensorFlow 2.0, Keras is now part of the TensorFlow package. Google colab offers the training of machine learning models on free GPU and TPU. Therefore, it is recommended the environment to get hands-on experience of training your deep learning models on GPU and TPU. Moreover, we can set up tensorboard to get a better understanding of the model training. This guide comes with a working copy of Google colab to get you started quickly.", "Import the necessary python libraries along with TensorFlow and Keras functions", "To access the data in Google colab environment, there are various ways to do it. One of my favourite is to upload data to your Google Drive and mount Google Drive in colab.", "You can download the data for training and testing from data_deep_learning. You can try other open-source datasets to try.", "We need to mount the google drive to read the data stored in google drive. Below is the simplest way to mount it. You will be asked to enter the token generated by your access procedure. You can consult the article \u201cUsing Google Colab GPU VM + Drive as persistent storage for long Deep Learning training runs\u201d for more information on using Google drive as data storage for colab.", "I have already uploaded the data to my google drive for easy access. You may follow the same.", "I have uploaded the training and validation data to my google drive. You can try with any other open-source data for the sake of practice. For this tutorial, data is already prepared into training and testing sets however in practical problems, most likely data has to be cleaned and prepared on task by task basis. In my opinion, almost 50% of the work for Machine Learning Scientists is to prepare the data compatible with machine learning models", "Make sure no information leakage is happening across train, valid and test splits.", "Recently, Jason Brownlee has published a series of articles on Data Preparation on his website https://machinelearningmastery.com/blog/.", "Reading the training and test data for our problem. The target is to predict the total_earnings of given products given below listed features.", "Normalizing is recommend the practice for most machine learning models and has proven to be working. Scikit-learn comes with a handful of industry-trusted transformations to be applied for preprocessing the data.", "MinMaxScaler is one of the frequently used transformations implemented in the Scikit-learn transformation module. It scales the data between 0 and 1. It is advisable to normalize the training and test data before feeding into the TensorFlow model training.", "let us have a look on scaled data", "For a supervised machine learning model, we split the features and target into X and y NumPy arrays. TensorFlow models are no different and consume the data in this format.", "To define the deep learning model, we use the Keras API module shipped with TensorFlow 2.1.0 We start with a basic model with two intermediate relu layers. The input dimension is 9 and the output dimension is one.", "Prepare the test features and target similar to training data", "Set up the callbacks for tensorboard", "Train the model with verbose=0 and epochs=50 and testing data as a validation set.", "Let us display the training/validation errors in tensorboard", "Validation of the training is one of the very important steps in any Machine Learning framework. Here, we use validation/Test error interchangeably.", "Let us read the sample input data and test our model to predict and save the model locally for future use.", "Once we are satisfied with the model, we can save this model locally and can be used to make predictions for unseen data. This model can be hosted on the cloud and you can send the input data to get the predictions.", "Once, we have the trained model the next task is to deploy it to serve the clients. There are various deployment options available however in this section we focus on deploying it on Google Cloud AI platform.", "The pre-requisites to deploy the TensorFlow models on google cloud are", "How-to deploy TensorFlow 2 Models on Cloud AI Platform", "Authentication for your google account through colab", "Create a Google cloud project if not done before and bucket for storage of model.", "Set the desired project as a default environment variable to be used in colab environment.", "Create the Bucket using gsutil command-line utility. You can use the python API to create a storage bucket. Let us stick to the command line method for now.", "Save our TensorFlow model into a storage bucket just created. You can confirm the model files are uploaded from the google console graphical user interface.", "There are two ways to set up a model serving on google cloud. The first one is using the GCP graphical console and the other one is using gcloud command-line tool as described in How-to deploy TensorFlow 2 Models on Cloud AI Platform. I have followed the GCP console for this deployment. Some key points", "Once the model is deployed and you can see the green tick, it is time to test the model for predictions. Some important points to consider.", "Load the unseen data to predict", "Conver the data into JSON format to be compatible with predict_json routine written above.", "Follow the below Google colaboratory notebook to reproduce and practice this guide.", "In this guide, we have learned about training the deep learning models with TensorFlow 2.1.0 and deploying the trained model on the google cloud platform. Below are the highlights of the guide.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Engineer | Data Scientist | ML Researcher | Educator"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F81a53c238901&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-course-v1-guide-81a53c238901&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-course-v1-guide-81a53c238901&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-course-v1-guide-81a53c238901&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-course-v1-guide-81a53c238901&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----81a53c238901--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----81a53c238901--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@amjadraza24?source=post_page-----81a53c238901--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@amjadraza24?source=post_page-----81a53c238901--------------------------------", "anchor_text": "MA Raza, Ph.D."}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F43f78dfb3de3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-course-v1-guide-81a53c238901&user=MA+Raza%2C+Ph.D.&userId=43f78dfb3de3&source=post_page-43f78dfb3de3----81a53c238901---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F81a53c238901&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-course-v1-guide-81a53c238901&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F81a53c238901&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-course-v1-guide-81a53c238901&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://github.com/amjadraza/blogs-data/tree/master/deep_leraning_tensorflow", "anchor_text": "data_deep_learning"}, {"url": "https://medium.com/@prajwal.prashanth22/google-colab-drive-as-persistent-storage-for-long-training-runs-cb82bc1d5b71", "anchor_text": "Using Google Colab GPU VM + Drive as persistent storage for long Deep Learning training runs"}, {"url": "https://machinelearningmastery.com/blog/.", "anchor_text": "https://machinelearningmastery.com/blog/."}, {"url": "https://scikit-learn.org/stable/modules/preprocessing.html", "anchor_text": "Scikit-learn"}, {"url": "https://scikit-learn.org/stable/modules/preprocessing.html", "anchor_text": "the Scikit-learn transformation module"}, {"url": "https://blog.tensorflow.org/2020/04/how-to-deploy-tensorflow-2-models-on-cloud-ai-platform.html", "anchor_text": "How-to deploy TensorFlow 2 Models on Cloud AI Platform"}, {"url": "https://blog.tensorflow.org/2020/04/how-to-deploy-tensorflow-2-models-on-cloud-ai-platform.html", "anchor_text": "How-to deploy TensorFlow 2 Models on Cloud AI Platform"}, {"url": "https://blog.tensorflow.org/2020/04/how-to-deploy-tensorflow-2-models-on-cloud-ai-platform.html", "anchor_text": "https://blog.tensorflow.org/2020/04/how-to-deploy-tensorflow-2-models-on-cloud-ai-platform.html"}, {"url": "https://scikit-learn.org/stable/modules/preprocessing.html", "anchor_text": "https://scikit-learn.org/stable/modules/preprocessing.html"}, {"url": "https://www.tensorflow.org/tutorials/keras/regression", "anchor_text": "https://www.tensorflow.org/tutorials/keras/regression"}, {"url": "https://www.tensorflow.org/tutorials/keras/save_and_load", "anchor_text": "https://www.tensorflow.org/tutorials/keras/save_and_load"}, {"url": "https://medium.com/tag/python?source=post_page-----81a53c238901---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/data-science?source=post_page-----81a53c238901---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/tensorflow?source=post_page-----81a53c238901---------------tensorflow-----------------", "anchor_text": "TensorFlow"}, {"url": "https://medium.com/tag/google-cloud-platform?source=post_page-----81a53c238901---------------google_cloud_platform-----------------", "anchor_text": "Google Cloud Platform"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----81a53c238901---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F81a53c238901&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-course-v1-guide-81a53c238901&user=MA+Raza%2C+Ph.D.&userId=43f78dfb3de3&source=-----81a53c238901---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F81a53c238901&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-course-v1-guide-81a53c238901&user=MA+Raza%2C+Ph.D.&userId=43f78dfb3de3&source=-----81a53c238901---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F81a53c238901&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-course-v1-guide-81a53c238901&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----81a53c238901--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F81a53c238901&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-course-v1-guide-81a53c238901&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----81a53c238901---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----81a53c238901--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----81a53c238901--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----81a53c238901--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----81a53c238901--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----81a53c238901--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----81a53c238901--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----81a53c238901--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----81a53c238901--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@amjadraza24?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@amjadraza24?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "MA Raza, Ph.D."}, {"url": "https://medium.com/@amjadraza24/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "176 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F43f78dfb3de3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-course-v1-guide-81a53c238901&user=MA+Raza%2C+Ph.D.&userId=43f78dfb3de3&source=post_page-43f78dfb3de3--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F3cd60c3ab90f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-course-v1-guide-81a53c238901&newsletterV3=43f78dfb3de3&newsletterV3Id=3cd60c3ab90f&user=MA+Raza%2C+Ph.D.&userId=43f78dfb3de3&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}