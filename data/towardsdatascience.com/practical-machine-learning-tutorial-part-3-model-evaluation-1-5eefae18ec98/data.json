{"url": "https://towardsdatascience.com/practical-machine-learning-tutorial-part-3-model-evaluation-1-5eefae18ec98", "time": 1683016011.753537, "path": "towardsdatascience.com/practical-machine-learning-tutorial-part-3-model-evaluation-1-5eefae18ec98/", "webpage": {"metadata": {"title": "Practical Machine Learning Tutorial: Part.3 (Model Evaluation-1) | by Ryan A. Mardani | Towards Data Science", "h1": "Practical Machine Learning Tutorial: Part.3 (Model Evaluation-1)", "description": "In this part, we will elaborate on some model evaluation metrics specifically for multi-class classification problems. Accuracy, precision, recall, and confusion matrix are discussed below for our\u2026"}, "outgoing_paragraph_urls": [{"url": "https://towardsdatascience.com/practical-machine-learning-tutorial-part-1-data-exploratory-analysis-c13d39b8f33b", "anchor_text": "part1", "paragraph_index": 0}, {"url": "https://towardsdatascience.com/practical-machine-learning-tutorial-part-2-build-model-validate-c98c2ddad744", "anchor_text": "part2", "paragraph_index": 0}, {"url": "https://github.com/mardani72/Practical_ML_Tutorial_Facies_examp", "anchor_text": "here", "paragraph_index": 0}, {"url": "https://www.linkedin.com/in/amardani/", "anchor_text": "Ryan A. Mardani", "paragraph_index": 26}], "all_paragraphs": ["In this part, we will elaborate on some model evaluation metrics specifically for multi-class classification problems. Accuracy, precision, recall, and confusion matrix are discussed below for our facies problem. This post is the third part of part1, part2. You can find the jupyter notebook file of this part here.", "When I was fresh in machine learning, I always considered constructing a model as the most important step of the ML tasks, while now, I have another concept; model evaluation skill is the fundamental key to modeling success. We need to make sure that our model is working well with new data. On the other hand, we have to be able to interpret various evaluation metrics to understand our model\u2019s strengths and weaknesses leading us to model improvement hints. As we are dealing with the multi-class problem in this tutorial, we will focus on related evaluation metrics, but before that, we need to get familiar with some definitions.", "When we are working with classification problems, we will have 4 kinds of possibility with model outcomes:", "A) True Positive(TP) is the outcome of the model correctly predicts the positive class. In our dataset, a positive class is a label that we are looking for specifically for that label prediction. For example, if we are analyzing \u2018Dolomite\u2019 class prediction, TP is the number of truly predicted Dolomite samples of test data by the model.", "B) True Negative(TN) is an outcome where the model correctly predicts the negative class. Negative class in our dataset for Dolomite prediction are those facies classes that truly predicted as not Dolomite(predicted as the rest of classes and truly were not Dolomite).", "C) False Positive(FP) is an outcome where the model incorrectly predicts the positive class. In our dataset, all facies classes that incorrectly predicted as Dolomite when we are evaluating Dolomite class prediction.", "D) False Negative(FN) is an outcome where the model incorrectly predicts negative class. Again for Dolomite prediction, FN is the prediction of Dolomite as non-Dolomite classes.", "1.Accuracy: it is simply calculated as a fraction of correct predictions over the total number of predictions.", "2. Precision: this metric answers this question: what proportion of positive predictions is totally correct?", "Precision = TP / (TP+FP)looking at the equation, we can see that if a model has zero False Positive prediction, the precision will be 1. Again, in Dolomite prediction, this index shows what proportion of predicted Dolomite is truly Dolomite (not other facies are classified as Dolomite).", "3. Recall: recall answer this question: what proportion of actual positives is classified correctly?", "Recall= TP / (TP+FN)looking at the equation, we can see that if a model has zero False Negative prediction, the recall will be 1. In our example, recall shows the proportion of Dolomite class that correctly identified by the model.", "Note: to evaluate the model efficiency, we need to consider both precision and recall together. Unfortunately, these two parameters act against each other, improving one leads to decreasing the other. The ideal case is that both of them show near 1 values.", "4. f1_score: The F1 score can be interpreted as a weighted average of the precision and recall, where an F1 score reaches its best value at 1 and the worst score at 0. The relative contribution of precision and recall to the F1 score are equal. The formula for the F1 score is:", "Let\u2019s see one example of Logistic Regression classifier performance:", "To evaluate the Logistic Regression classifier performance, let's look at the first facies class Sandstone(SS). When this model predicts a facies as SS, it is correct in 75% of the time(Precision). On the other hand, this model correctly identifies 89% of all SS facies members(Recall). We can guess that f1_score is somewhere between these two metrics. Support means the individual class members for the test.", "Let's have some block of codes to implement the above-mentioned procedure in order for all models and plot the result as an average. Up to line 15, we defined the model objects with hyper-parameters that we already obtained from the grid-search approach. Then(line 16 to 25) models are appended into a list to be iterable when we want to fit and cross-validate in order. After cross-validation, we stored metrics results in the list for each model. line 37 to 52, we established a for loop to calculate the average value of each of these metrics for each model. The rest of the code is a plotting task.", "This is the plot that shows the average value of each of the evaluation metrics(y-axis) for individual employed models. Here, we wanted to compare all models performances overall. It seems that Extra tree and Random forest did the best prediction while Gaussian Naive Bays was not that much efficient predictor model.", "If we are concerned about an individual facies prediction, we should consider eliminating the rest of the metrics from the \u2018results\u2019 list and run the program again.", "The confusion matrix shows predicted class labels against original true label data. This is a fantastic visualization tool that we can see each class of facies is predicted correctly or wrong into other classes.", "In the line of codes below, we first defined a function to make fancy use of the confusion matrix function developed by sklearn. After function definition, we fit and run the Logistic Regression classifier. Now we have predicted facies labels with true facies labels for test data. Calling the function with the required input parameters will create a plot of the confusion matrix.", "Taking a look at the plot(first row), we recognize that this algorithm could predict 151 SS class correctly while 18 true SS were classified as CSiS incorrectly. From the previous section, we are familiar with the recall concept. From all true class members of SS(169), the classifier could recognize 151 correctly; 151/169 is 89%(we have seen this number in the class report in the picture above). So, we can conclude that if we move our evaluation in the row direction(True labels) we are dealing with recall.You may guess that if we go in the column direction, we will deal with Precision. For SS precision is 75% as 149/201.", "In the picture below, we see how the Naive Bayes classifier poorly performed prediction. This classifier is totally overestimated BS class in prediction.", "Up to now, we have some metrics that helped us to evaluate the model performances but still, we can not guarantee that which one is the best. Because some models can memorize training data and follow data complexity severely and when it faces a new dataset, its performance will be poor. This is called over-fitting (model with high variance). A model with high variance will change a lot with small changes to the training dataset.On the other hand, when a model too generalizes prediction, it will not be able to capture the complexity of a dataset, this is called under-fitting(model with high bias).Our ideal model is something between these two models leaving us for bias-variance trade-off.", "The question is: how we can recognize that our model is over-fit or under-fit?We will cover in the next part of this tutorial.", "Model evaluation is the most important task in ML model production. We mainly start with simple evaluation metrics and then narrow down to specific and more detailed metrics to understand our model's strengths and weaknesses.", "If you have a question, please reach me out through my LinkedIn: Ryan A. Mardani", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F5eefae18ec98&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpractical-machine-learning-tutorial-part-3-model-evaluation-1-5eefae18ec98&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpractical-machine-learning-tutorial-part-3-model-evaluation-1-5eefae18ec98&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpractical-machine-learning-tutorial-part-3-model-evaluation-1-5eefae18ec98&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpractical-machine-learning-tutorial-part-3-model-evaluation-1-5eefae18ec98&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----5eefae18ec98--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----5eefae18ec98--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@mardani.a?source=post_page-----5eefae18ec98--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@mardani.a?source=post_page-----5eefae18ec98--------------------------------", "anchor_text": "Ryan A. Mardani"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fb36223c810e6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpractical-machine-learning-tutorial-part-3-model-evaluation-1-5eefae18ec98&user=Ryan+A.+Mardani&userId=b36223c810e6&source=post_page-b36223c810e6----5eefae18ec98---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F5eefae18ec98&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpractical-machine-learning-tutorial-part-3-model-evaluation-1-5eefae18ec98&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F5eefae18ec98&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpractical-machine-learning-tutorial-part-3-model-evaluation-1-5eefae18ec98&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://towardsdatascience.com/practical-machine-learning-tutorial-part-1-data-exploratory-analysis-c13d39b8f33b", "anchor_text": "part1"}, {"url": "https://towardsdatascience.com/practical-machine-learning-tutorial-part-2-build-model-validate-c98c2ddad744", "anchor_text": "part2"}, {"url": "https://github.com/mardani72/Practical_ML_Tutorial_Facies_examp", "anchor_text": "here"}, {"url": "https://www.linkedin.com/in/amardani/", "anchor_text": "Ryan A. Mardani"}, {"url": "https://jakevdp.github.io/PythonDataScienceHandbook/index.html", "anchor_text": "https://jakevdp.github.io/PythonDataScienceHandbook/index.html"}, {"url": "https://scikit-learn.org/stable/supervised_learning.html#supervised-learning", "anchor_text": "https://scikit-learn.org/stable"}, {"url": "https://machinelearningmastery.com/", "anchor_text": "https://machinelearningmastery.com"}, {"url": "https://github.com/brendonhall/facies_classification/blob/master/Facies%20Classification%20-%20SVM.ipynb", "anchor_text": "Brendon Hall"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----5eefae18ec98---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/multiclass-classification?source=post_page-----5eefae18ec98---------------multiclass_classification-----------------", "anchor_text": "Multiclass Classification"}, {"url": "https://medium.com/tag/model-evaluation?source=post_page-----5eefae18ec98---------------model_evaluation-----------------", "anchor_text": "Model Evaluation"}, {"url": "https://medium.com/tag/geoscience?source=post_page-----5eefae18ec98---------------geoscience-----------------", "anchor_text": "Geoscience"}, {"url": "https://medium.com/tag/python?source=post_page-----5eefae18ec98---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F5eefae18ec98&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpractical-machine-learning-tutorial-part-3-model-evaluation-1-5eefae18ec98&user=Ryan+A.+Mardani&userId=b36223c810e6&source=-----5eefae18ec98---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F5eefae18ec98&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpractical-machine-learning-tutorial-part-3-model-evaluation-1-5eefae18ec98&user=Ryan+A.+Mardani&userId=b36223c810e6&source=-----5eefae18ec98---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F5eefae18ec98&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpractical-machine-learning-tutorial-part-3-model-evaluation-1-5eefae18ec98&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----5eefae18ec98--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F5eefae18ec98&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpractical-machine-learning-tutorial-part-3-model-evaluation-1-5eefae18ec98&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----5eefae18ec98---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----5eefae18ec98--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----5eefae18ec98--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----5eefae18ec98--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----5eefae18ec98--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----5eefae18ec98--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----5eefae18ec98--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----5eefae18ec98--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----5eefae18ec98--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@mardani.a?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@mardani.a?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Ryan A. Mardani"}, {"url": "https://medium.com/@mardani.a/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "388 Followers"}, {"url": "http://www.dataenergy.ca", "anchor_text": "www.dataenergy.ca"}, {"url": "http://linkedin.com/in/amardani", "anchor_text": "linkedin.com/in/amardani"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fb36223c810e6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpractical-machine-learning-tutorial-part-3-model-evaluation-1-5eefae18ec98&user=Ryan+A.+Mardani&userId=b36223c810e6&source=post_page-b36223c810e6--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F7a39952b3ca1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpractical-machine-learning-tutorial-part-3-model-evaluation-1-5eefae18ec98&newsletterV3=b36223c810e6&newsletterV3Id=7a39952b3ca1&user=Ryan+A.+Mardani&userId=b36223c810e6&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}