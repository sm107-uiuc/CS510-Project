{"url": "https://towardsdatascience.com/yolov3-pytorch-on-google-colab-c4a79eeecdea", "time": 1683005465.4104, "path": "towardsdatascience.com/yolov3-pytorch-on-google-colab-c4a79eeecdea/", "webpage": {"metadata": {"title": "YOLOv3 Video PyTorch on Google Colab | Towards Data Science", "h1": "YOLOv3 PyTorch on Google Colab", "description": "YOLO (You Only Look Once) for real-time object detection on your browser using Google Colab to process your own video"}, "outgoing_paragraph_urls": [{"url": "https://colab.research.google.com/github/vindruid/yolov3-in-colab/blob/master/yolov3_video.ipynb", "anchor_text": "Google Colab", "paragraph_index": 3}, {"url": "https://github.com/ultralytics/yolov3", "anchor_text": "repo", "paragraph_index": 4}, {"url": "https://stackoverflow.com/questions/33134985/cv2-videowriter-will-not-write-file-using-fourcc-h-264-with-logitech-c920-pyth", "anchor_text": "source", "paragraph_index": 19}, {"url": "https://colab.research.google.com/github/vindruid/yolov3-in-colab/blob/master/yolov3_video.ipynb", "anchor_text": "HERE", "paragraph_index": 20}], "all_paragraphs": ["For computer vision enthusiasts, YOLO (You Only Look Once) is an extremely popular real-time object detection concept since its very fast and has great performance.", "In this article, I will share codes for processing a video to get bounding boxes of each object every frame inside Google Colab", "We will not discuss the YOLO concept or architecture since a lot of good articles in Medium already elaborate that. Here we only discuss functional codes", "You can try yourself on this Google Colab.", "We start from a well-written and my favorite git hub repo from Ultralytics. Despite the repo already contains how to process video using YOLOv3 just running python detect.py --source file.mp4 I would like to break down and try to simplify the codes just by removing several unnecessary lines for this case and I add how to show processed video on Google Colab / Jupyter notebook", "First clone Ultralytics YoloV3 Repository then import common packages and repo\u2019s function", "Set Argument Parser, initialize devices (CPU / CUDA), initialize the YOLO model then load weight.", "We are using YOLOv3-spp-ultralytics weights which the repo said it far better than other YOLOv3 in Mean Average Precision", "The functiontorch_utils.select_device() will automatically find available GPU unless the input'cpu'", "Object Darknet is initialize YOLOv3 architecture on PyTorch and the weight needs to be loaded using pre-trained weight (we don't want to train the model at this time)", "Next, we will read the video file and rewrite the video with objects bounding boxes. Following 3 GitHub Gist is part of a function predict_one_video that will be used at the end.", "We are writing the new video using MP4 format, it explicitly stated on vid_writer. Whilefps, width and height are used according to the original video", "Start looping each frame on the video to get predictions.", "The image size for this model is 416. A function name letterbox is resizing the image and give padding to image hence one of width or height becomes 416 and the other less than equal 416 but still divisible by 32", "The second part is we turn the image into RGB format and put channels in the first dimension (C,H,W). Put the image data into the device (GPU or CPU) and scale the pixel from 0-255 to 0-1 . Before we put the image into the model, we use the function img.unsqeeze(0) because we have to reformat image into 4 dimensions (N,C,H,W) which N is the number of images which is 1 in this case.", "After preprocessing the image, we put it into the model to get prediction boxes. But the predictions have a lot of boxes so we need non-maximum suppression to filter and merge the boxes.", "We loop all the prediction (pred) after NMS to draw the box, but the image is already resized into 416 pixels, we need to scale it back into original size using the function scale_coords then we draw the box using the function plot_one_box", "The video is written as Mp4 Format on function predict_one_video after saved as Mp4 we compress into h264so the video can be played on Google Colab / Jupyter directly.", "We show video using IPython.display.HTML with 400 width pixels. The video is read using binary", "The output of OpenCV video writer is an Mp4 video with size 3 times larger than the original video, and it cannot be displayed on Google Colab using the same way, one of the solutions is we do the compression (source)", "Go to the Google Colab file on GitHub HERE", "Thank you for reading, hope it helpful", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fc4a79eeecdea&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fyolov3-pytorch-on-google-colab-c4a79eeecdea&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fyolov3-pytorch-on-google-colab-c4a79eeecdea&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fyolov3-pytorch-on-google-colab-c4a79eeecdea&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fyolov3-pytorch-on-google-colab-c4a79eeecdea&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----c4a79eeecdea--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----c4a79eeecdea--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@hervindphilipe?source=post_page-----c4a79eeecdea--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@hervindphilipe?source=post_page-----c4a79eeecdea--------------------------------", "anchor_text": "Hervind Philipe"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F9a9a507d6370&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fyolov3-pytorch-on-google-colab-c4a79eeecdea&user=Hervind+Philipe&userId=9a9a507d6370&source=post_page-9a9a507d6370----c4a79eeecdea---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc4a79eeecdea&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fyolov3-pytorch-on-google-colab-c4a79eeecdea&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc4a79eeecdea&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fyolov3-pytorch-on-google-colab-c4a79eeecdea&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@wahidkhene?utm_source=medium&utm_medium=referral", "anchor_text": "Wahid Khene"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://colab.research.google.com/github/vindruid/yolov3-in-colab/blob/master/yolov3_video.ipynb", "anchor_text": "Google Colab"}, {"url": "https://github.com/ultralytics/yolov3", "anchor_text": "repo"}, {"url": "https://mc.ai/detection-free-human-instance-segmentation-using-pose2seg-and-pytorch/", "anchor_text": "Image source"}, {"url": "https://stackoverflow.com/questions/33134985/cv2-videowriter-will-not-write-file-using-fourcc-h-264-with-logitech-c920-pyth", "anchor_text": "source"}, {"url": "https://colab.research.google.com/github/vindruid/yolov3-in-colab/blob/master/yolov3_video.ipynb", "anchor_text": "HERE"}, {"url": "https://github.com/ultralytics/yolov3", "anchor_text": "YoloV3 Torch repository"}, {"url": "https://colab.research.google.com/notebooks/snippets/advanced_outputs.ipynb#scrollTo=SucxddsPhOmj", "anchor_text": "Google Colab advanced output"}, {"url": "https://stackoverflow.com/questions/57377185/how-play-mp4-video-in-google-colab", "anchor_text": "Show Video on Google Colab"}, {"url": "https://stackoverflow.com/questions/33134985/cv2-videowriter-will-not-write-file-using-fourcc-h-264-with-logitech-c920-pyth", "anchor_text": "Video Compression"}, {"url": "https://medium.com/tag/computer-vision?source=post_page-----c4a79eeecdea---------------computer_vision-----------------", "anchor_text": "Computer Vision"}, {"url": "https://medium.com/tag/google-colab?source=post_page-----c4a79eeecdea---------------google_colab-----------------", "anchor_text": "Google Colab"}, {"url": "https://medium.com/tag/yolo?source=post_page-----c4a79eeecdea---------------yolo-----------------", "anchor_text": "Yolo"}, {"url": "https://medium.com/tag/video-processing?source=post_page-----c4a79eeecdea---------------video_processing-----------------", "anchor_text": "Video Processing"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----c4a79eeecdea---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fc4a79eeecdea&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fyolov3-pytorch-on-google-colab-c4a79eeecdea&user=Hervind+Philipe&userId=9a9a507d6370&source=-----c4a79eeecdea---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fc4a79eeecdea&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fyolov3-pytorch-on-google-colab-c4a79eeecdea&user=Hervind+Philipe&userId=9a9a507d6370&source=-----c4a79eeecdea---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc4a79eeecdea&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fyolov3-pytorch-on-google-colab-c4a79eeecdea&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----c4a79eeecdea--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fc4a79eeecdea&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fyolov3-pytorch-on-google-colab-c4a79eeecdea&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----c4a79eeecdea---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----c4a79eeecdea--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----c4a79eeecdea--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----c4a79eeecdea--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----c4a79eeecdea--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----c4a79eeecdea--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----c4a79eeecdea--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----c4a79eeecdea--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----c4a79eeecdea--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@hervindphilipe?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@hervindphilipe?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Hervind Philipe"}, {"url": "https://medium.com/@hervindphilipe/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "102 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F9a9a507d6370&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fyolov3-pytorch-on-google-colab-c4a79eeecdea&user=Hervind+Philipe&userId=9a9a507d6370&source=post_page-9a9a507d6370--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F8ea7ca449ad3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fyolov3-pytorch-on-google-colab-c4a79eeecdea&newsletterV3=9a9a507d6370&newsletterV3Id=8ea7ca449ad3&user=Hervind+Philipe&userId=9a9a507d6370&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}