{"url": "https://towardsdatascience.com/deploy-tensorflow-object-detection-api-on-kubernetes-with-python-flask-and-docker-7a9513dd19e4", "time": 1683006227.262389, "path": "towardsdatascience.com/deploy-tensorflow-object-detection-api-on-kubernetes-with-python-flask-and-docker-7a9513dd19e4/", "webpage": {"metadata": {"title": "Deploy Tensorflow Object Detection API on Kubernetes with Python, Flask and Docker | by Neeraj Krishna | Towards Data Science", "h1": "Deploy Tensorflow Object Detection API on Kubernetes with Python, Flask and Docker", "description": "Deploy Tensorflow Object Detection API on Kubernetes with Python, Flask and Docker. In this article we\u2019ll serve the Tensorflow Object Detection API with Flask, Dockerize the Application and deploy it on Kubernetes.."}, "outgoing_paragraph_urls": [{"url": "https://github.com/tensorflow/models/tree/master/research/object_detection", "anchor_text": "repo", "paragraph_index": 3}, {"url": "https://gilberttanner.com/blog/installing-the-tensorflow-object-detection-api", "anchor_text": "article", "paragraph_index": 3}, {"url": "https://github.com/wingedrasengan927/Tensorflow-2-Object-Detection-API-Flask-Application", "anchor_text": "repository", "paragraph_index": 4}, {"url": "https://docs.docker.com/get-docker/", "anchor_text": "Docker", "paragraph_index": 5}, {"url": "https://www.postman.com/", "anchor_text": "Postman", "paragraph_index": 15}, {"url": "https://console.cloud.google.com/", "anchor_text": "Google Cloud Platform", "paragraph_index": 16}, {"url": "https://cloud.google.com/sdk", "anchor_text": "SDK", "paragraph_index": 16}, {"url": "https://cloud.google.com/resource-manager/docs/creating-managing-projects", "anchor_text": "project", "paragraph_index": 16}, {"url": "https://cloud.google.com/container-registry/docs/pushing-and-pulling?hl=en_US", "anchor_text": "Google Container Registry", "paragraph_index": 17}, {"url": "https://cloud.google.com/kubernetes-engine", "anchor_text": "Google Kubernetes Engine", "paragraph_index": 24}, {"url": "https://cloud.google.com/compute", "anchor_text": "oogle Compute Engine", "paragraph_index": 28}, {"url": "https://kubernetes.io/docs/concepts/workloads/controllers/deployment/", "anchor_text": "Kubernetes Deployment", "paragraph_index": 29}], "all_paragraphs": ["The TensorFlow Object Detection API is an open source framework built on top of TensorFlow that makes it easy to construct, train and deploy object detection models.This article demonstrates how you can serve the Tensorflow Object Detection API with Flask, Dockerize the application and deploy it on Kubernetes using the Google Kubernetes Engine.", "Once deployed, you can incorporate the API into your custom application, be it a mobile application or a web application to suit your needs.", "These are the steps we will be doing:", "Note: We will not be covering the Tensorflow Object Detection API in-depth since that is not the main emphasis of this article. You can visit the official repo if you are interested. It\u2019ll be really helpful if you\u2019re acquainted with it. We also will not go through the entire process of setting up the environment since we can cut it down using Docker. However, you can refer to this amazing article if you are interested.", "Clone my repository into the workspace. We will be working with this code throughout the article.", "Install Docker in your system if you haven\u2019t already. A Docker container basically packages up code and all its dependencies so the application runs quickly and reliably in any environment. It includes everything needed to run an application and isolates the dependencies from the main environment.", "Inside the repo you have cloned, you will find a Dockerfile. Dockerfiles describe the different processes that are assembled to build an Image and can also contain some metadata describing how to run a container based on this image. Our Dockerfile looks like this:", "To build an image from the Dockerfile run the following from inside the repo:", "-t indicates the tag you give to the Docker image. The building takes a lot of time. If you see something like this:", "It means the image was successfully built. Now let\u2019s run a container from the image. Run the following command:", "This ensures that we detach from the running container and the container is exposed on the port 5000.", "Now let\u2019s test our application. This can be done by running the script client.py which is inside the repo, with the necessary arguments (you need to have opencv and numpy installed in your workspace to run the script):", "If you see something like this as the output, then our application is working as expected:", "When we build the image from the Dockerfile, we set the environment necessary to run the Tensorflow Object Detection API, this includes cloning the repository, compiling the protocol buffers, setting the environment variables, downloading the model and when we are ready, we clone the repository which contains the code for serving the application with Flask, and we launch the application on port 5000 and we make sure to expose that port when we run the container.", "You can change the parameters, pre-trained model in this file. Make sure you the changes are reflected in the Dockerfile, you can use COPY in Dockerfile to copy the changed repo from your local environment into the Dockerfile instead of cloning it.", "On the client side, the request we send to the endpoint contains the image data. We can use API testing tools like Postman or the curl command to send data. The response we get back contains the detections in the image, the image size and image data with the bounding box overlay. We write this image to output_dir", "Before proceeding, you need to make sure that you have a working account on Google Cloud Platform, have the cloud SDK installed, and have created a project.", "Right now we have the Image in our local environment, to deploy we need to host it on the cloud. In this section we will push our Docker Image to Google Container Registry .", "First we need to configure Docker to use gcloud as a credential helper. To do so, run the command:", "To push any local image to the Container Registry, we need to first tag it with the registry name and then push the image. To tag, run the following command:", "gcr.io is the Hostname which specifies the location or repository where you will store the image.", "To push the tagged image, run:", "To check if the image has been pushed, list out the images. To do so, run:", "You should see the image name in the output if it was successfully pushed.", "You definitely may have heard of Kubernetes, It has become the standard for deploying and managing containerized applications. In this section we will deploy our application on Kubernetes using the Google Kubernetes Engine.", "Kubernetes is a container orchestration system. It helps deploy and manage containerized applications on a cluster. A Kubernetes cluster consists of a Master, which is responsible for managing the cluster and Nodes which are worker machines that run applications.", "First, let\u2019s install kubectl. kubectl is used to communicate with Kubernetes. To install kubectl, run:", "Let\u2019s create a two-node cluster named object-detection. As mentioned, a Node is a worker machine in Kubernetes which may be a virtual machine or a physical machine, depending on the cluster. To create the cluster run the following command:", "After the Cluster is created, It spins up two VM instances on Google Compute Engine which are Cluster\u2019s Node Workers. To see them, run the following command:", "Now that we have a cluster up and running, let\u2019s deploy our containerized application. To do so, we have to create a Kubernetes Deployment. The Deployment instructs Kubernetes how to create and update instances of our application. When we create a Deployment, we have to specify the container image for our application and the name of the deployment. Run the following command to create a deployment:", "When we create a deployment, Kubernetes creates Pods to host the application instance. A Pod represents a group of one or more application containers. A Pod runs on a Node.To see the Pods created by Deployment, run:", "We have to allow traffic from the internet to the application so that we can access it. To do so, run:", "The port flag specifies the port number configured on the Load Balancer, and the target-port flag specifies the port number that the tf-od-api container is listening on.", "To get the external IP, run the following command:", "Now let\u2019s check if our application is accessible. To do so we\u2019ll run the same client.py but we have to give the external IP as the address argument:", "If you see an output which is similar to when we ran it before, Congratulations! You\u2019ve successfully deployed a containerized Tensorflow Object Detection API application on Kubernetes.", "Do not forget to remove the cluster once you are done as it may incur charges. To do so, run the following command to delete the service:", "And to delete the Cluster and it\u2019s resources, run:", "In this article, we have learned how to serve the Tensorflow Object Detection API using Flask, containerize the application using Docker and deploy the application on Kubernetes. Hope it has been of help.", "If you have any feedback or want to get in touch in general, please drop me a note on ms.neerajkrishna@gmail.com", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "I write about effective learning, technology, and deep learning | 2x top writer | senior data scientist @MakeMyTrip"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F7a9513dd19e4&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeploy-tensorflow-object-detection-api-on-kubernetes-with-python-flask-and-docker-7a9513dd19e4&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeploy-tensorflow-object-detection-api-on-kubernetes-with-python-flask-and-docker-7a9513dd19e4&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeploy-tensorflow-object-detection-api-on-kubernetes-with-python-flask-and-docker-7a9513dd19e4&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeploy-tensorflow-object-detection-api-on-kubernetes-with-python-flask-and-docker-7a9513dd19e4&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----7a9513dd19e4--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----7a9513dd19e4--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://ms-neerajkrishna.medium.com/?source=post_page-----7a9513dd19e4--------------------------------", "anchor_text": ""}, {"url": "https://ms-neerajkrishna.medium.com/?source=post_page-----7a9513dd19e4--------------------------------", "anchor_text": "Neeraj Krishna"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F8d6b9cde0656&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeploy-tensorflow-object-detection-api-on-kubernetes-with-python-flask-and-docker-7a9513dd19e4&user=Neeraj+Krishna&userId=8d6b9cde0656&source=post_page-8d6b9cde0656----7a9513dd19e4---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F7a9513dd19e4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeploy-tensorflow-object-detection-api-on-kubernetes-with-python-flask-and-docker-7a9513dd19e4&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F7a9513dd19e4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeploy-tensorflow-object-detection-api-on-kubernetes-with-python-flask-and-docker-7a9513dd19e4&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://pixabay.com/users/Skitterphoto-324082/?utm_source=link-attribution&utm_medium=referral&utm_campaign=image&utm_content=1863906", "anchor_text": "Rudy and Peter Skitterians"}, {"url": "https://pixabay.com/?utm_source=link-attribution&utm_medium=referral&utm_campaign=image&utm_content=1863906", "anchor_text": "Pixabay"}, {"url": "https://github.com/tensorflow/models/tree/master/research/object_detection", "anchor_text": "repo"}, {"url": "https://gilberttanner.com/blog/installing-the-tensorflow-object-detection-api", "anchor_text": "article"}, {"url": "https://github.com/wingedrasengan927/Tensorflow-2-Object-Detection-API-Flask-Application", "anchor_text": "repository"}, {"url": "https://github.com/wingedrasengan927/Tensorflow-2-Object-Detection-API-Flask-Application.git", "anchor_text": "https://github.com/wingedrasengan927/Tensorflow-2-Object-Detection-API-Flask-Application.git"}, {"url": "https://docs.docker.com/get-docker/", "anchor_text": "Docker"}, {"url": "http://127.0.0.1:5000", "anchor_text": "http://127.0.0.1:5000"}, {"url": "https://www.postman.com/", "anchor_text": "Postman"}, {"url": "https://console.cloud.google.com/", "anchor_text": "Google Cloud Platform"}, {"url": "https://cloud.google.com/sdk", "anchor_text": "SDK"}, {"url": "https://cloud.google.com/resource-manager/docs/creating-managing-projects", "anchor_text": "project"}, {"url": "https://cloud.google.com/container-registry/docs/pushing-and-pulling?hl=en_US", "anchor_text": "Google Container Registry"}, {"url": "https://cloud.google.com/kubernetes-engine", "anchor_text": "Google Kubernetes Engine"}, {"url": "https://cloud.google.com/compute", "anchor_text": "oogle Compute Engine"}, {"url": "https://kubernetes.io/docs/concepts/workloads/controllers/deployment/", "anchor_text": "Kubernetes Deployment"}, {"url": "https://container.googleapis.com/v1/projects/temp-kubernetes/zones/us-central1-a/clusters/object-detection", "anchor_text": "https://container.googleapis.com/v1/projects/temp-kubernetes/zones/us-central1-a/clusters/object-detection"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----7a9513dd19e4---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/technology?source=post_page-----7a9513dd19e4---------------technology-----------------", "anchor_text": "Technology"}, {"url": "https://medium.com/tag/deployment?source=post_page-----7a9513dd19e4---------------deployment-----------------", "anchor_text": "Deployment"}, {"url": "https://medium.com/tag/docker?source=post_page-----7a9513dd19e4---------------docker-----------------", "anchor_text": "Docker"}, {"url": "https://medium.com/tag/object-detection?source=post_page-----7a9513dd19e4---------------object_detection-----------------", "anchor_text": "Object Detection"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F7a9513dd19e4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeploy-tensorflow-object-detection-api-on-kubernetes-with-python-flask-and-docker-7a9513dd19e4&user=Neeraj+Krishna&userId=8d6b9cde0656&source=-----7a9513dd19e4---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F7a9513dd19e4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeploy-tensorflow-object-detection-api-on-kubernetes-with-python-flask-and-docker-7a9513dd19e4&user=Neeraj+Krishna&userId=8d6b9cde0656&source=-----7a9513dd19e4---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F7a9513dd19e4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeploy-tensorflow-object-detection-api-on-kubernetes-with-python-flask-and-docker-7a9513dd19e4&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----7a9513dd19e4--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F7a9513dd19e4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeploy-tensorflow-object-detection-api-on-kubernetes-with-python-flask-and-docker-7a9513dd19e4&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----7a9513dd19e4---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----7a9513dd19e4--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----7a9513dd19e4--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----7a9513dd19e4--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----7a9513dd19e4--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----7a9513dd19e4--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----7a9513dd19e4--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----7a9513dd19e4--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----7a9513dd19e4--------------------------------", "anchor_text": ""}, {"url": "https://ms-neerajkrishna.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://ms-neerajkrishna.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Neeraj Krishna"}, {"url": "https://ms-neerajkrishna.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "663 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F8d6b9cde0656&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeploy-tensorflow-object-detection-api-on-kubernetes-with-python-flask-and-docker-7a9513dd19e4&user=Neeraj+Krishna&userId=8d6b9cde0656&source=post_page-8d6b9cde0656--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F73b918378b68&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeploy-tensorflow-object-detection-api-on-kubernetes-with-python-flask-and-docker-7a9513dd19e4&newsletterV3=8d6b9cde0656&newsletterV3Id=73b918378b68&user=Neeraj+Krishna&userId=8d6b9cde0656&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}