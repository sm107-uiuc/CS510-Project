{"url": "https://towardsdatascience.com/pyspark-mysql-tutorial-fa3f7c26dc7", "time": 1683017675.0818439, "path": "towardsdatascience.com/pyspark-mysql-tutorial-fa3f7c26dc7/", "webpage": {"metadata": {"title": "PySpark + MySQL Tutorial. A quick tutorial on installing and\u2026 | by Gregory Janesch | Towards Data Science", "h1": "PySpark + MySQL Tutorial", "description": "This post is meant as a short tutorial on how to set up PySpark to access a MySQL database and run a quick machine learning algorithm with it. Both PySpark and MySQL are locally installed onto a\u2026"}, "outgoing_paragraph_urls": [{"url": "https://dev.mysql.com/downloads/connector/j/", "anchor_text": "the MySQL website", "paragraph_index": 3}, {"url": "https://archive.ics.uci.edu/ml/datasets/Wine+Quality", "anchor_text": "wine quality dataset", "paragraph_index": 4}, {"url": "https://spark.apache.org/docs/latest/api/python/pyspark.ml.html#pyspark.ml.feature.RFormula", "anchor_text": "an R-like formula to specify the model", "paragraph_index": 10}], "all_paragraphs": ["This post is meant as a short tutorial on how to set up PySpark to access a MySQL database and run a quick machine learning algorithm with it. Both PySpark and MySQL are locally installed onto a computer running Kubuntu 20.04 in this example, so this can be done without any external resources.", "Installing MySQL onto a Linux machine is fairly quick thanks to the apt package manager with sudo apt install mysql-server. Once it\u2019s installed, you can run sudo mysql in a terminal to access MySQL from the command line:", "For PySpark, just running pip install pyspark will install Spark as well as the Python interface. For this example, I\u2019m also using mysql-connector-python and pandas to transfer the data from CSV files into the MySQL database. Spark can load CSV files directly, but that won\u2019t be used for the sake of this example.", "Finally, we need the Java drivers that will let Spark connect to MySQL. I didn\u2019t see a good way to install them through apt, so I downloaded the driver from the MySQL website and installed it manually. You may need the location of the driver file later on, depending on where it was installed, so finding it may be necessary. On Kubuntu, the driver file was installed to \u201c/usr/share/java/\u201d.", "The data that I\u2019m using is the wine quality dataset from the UCI machine learning repository. It\u2019s not especially large, with only around 6500 examples total, but it\u2019s clean and easy to use for this example. There are a few possible ways to use it for machine learning or other predictive purposes, but I\u2019m going to focus on predicting whether the wine in question is red or white.", "The first step is to read in the data. The only things worth noting here are that the files are semicolon-delimited, and we need to create the column for whether a wine is white or red ourselves:", "MySQL is similarly straightforward as you just set up the new database and an appropriate table. You will need to ensure that your user has privileges to edit the table, though; if you need to change privileges, that will have to be done from the MySQL prompt.", "And then load the data. MySQL can load multiple rows into a table at once if the contents of each row are contained within parentheses and comma-delimited, which a simple str.join()can do. Then upload into the database, using FLUSH TABLES to actually update the table with the rows (otherwise the changes are merely staged and would eventually be discarded once the connection is closed).", "Starting a Spark session from Python is fairly straightforward. Again, I had to specify the location of the MySQL Java driver, which is the only subtlety that I found. Loading the table afterward is similarly simple, despite the number of options that need to be specified, though you\u2019ll need the port number that MySQL is on when loading the data from the database (the default port is 3306).", "If you\u2019re loading data into Spark from a file, you\u2019ll probably want to specify a schema to avoid making Spark infer it. For a MySQL database, however, that\u2019s not necessary since it has its own schema and Spark can translate it.", "Finally, training the model. As always, split the train and test data first, then define the target and predictor variables. Specifying the model can be done a few ways, including the ability to use an R-like formula to specify the model. Here I\u2019ll use the VectorAssembler, which basically just concatenates all the features into a single list:", "Then a logistic regression model can be trained on the data, and we can get the predictions that the model makes for the test data.", "PySpark also has a Pipeline class, which can intelligently connect up all of the separate steps into a single operation, if you prefer:", "Regardless, evaluating the model is necessary. Spark seems a little limited in the native options for evaluating models \u2014 the BinaryClassificationEvaluator below only seems to support area under the curve for ROC (default) or the precision-recall curve.", "Note that the logistic regression model will actually return three columns of prediction data:", "You can use the toPandas() method to return the prediction data as a pandas dataframe, so other metrics are possible to calculate with either pandas or numpy.", "Finally, if you want to look at an overview of Spark\u2019s activity during the session, you can open a browser tab to localhost:4040 and see an overview of it:", "So that is a quick, not-too-into-the-weeds overview connecting MySQL to PySpark and fitting a logistic regression model. Obviously, there is much more power in both tools, but this will hopefully provide a window into your own work.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Early-career data scientist/statistician, recently finished a Master\u2019s in Statistics."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Ffa3f7c26dc7&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpyspark-mysql-tutorial-fa3f7c26dc7&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpyspark-mysql-tutorial-fa3f7c26dc7&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpyspark-mysql-tutorial-fa3f7c26dc7&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpyspark-mysql-tutorial-fa3f7c26dc7&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----fa3f7c26dc7--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----fa3f7c26dc7--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://gjanesch.medium.com/?source=post_page-----fa3f7c26dc7--------------------------------", "anchor_text": ""}, {"url": "https://gjanesch.medium.com/?source=post_page-----fa3f7c26dc7--------------------------------", "anchor_text": "Gregory Janesch"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F25bfadf6a6f7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpyspark-mysql-tutorial-fa3f7c26dc7&user=Gregory+Janesch&userId=25bfadf6a6f7&source=post_page-25bfadf6a6f7----fa3f7c26dc7---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ffa3f7c26dc7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpyspark-mysql-tutorial-fa3f7c26dc7&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ffa3f7c26dc7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpyspark-mysql-tutorial-fa3f7c26dc7&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://dev.mysql.com/downloads/connector/j/", "anchor_text": "the MySQL website"}, {"url": "https://archive.ics.uci.edu/ml/datasets/Wine+Quality", "anchor_text": "wine quality dataset"}, {"url": "https://spark.apache.org/docs/latest/api/python/pyspark.ml.html#pyspark.ml.feature.RFormula", "anchor_text": "an R-like formula to specify the model"}, {"url": "https://medium.com/tag/pyspark?source=post_page-----fa3f7c26dc7---------------pyspark-----------------", "anchor_text": "Pyspark"}, {"url": "https://medium.com/tag/mysql?source=post_page-----fa3f7c26dc7---------------mysql-----------------", "anchor_text": "MySQL"}, {"url": "https://medium.com/tag/python?source=post_page-----fa3f7c26dc7---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/data-science?source=post_page-----fa3f7c26dc7---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/linux?source=post_page-----fa3f7c26dc7---------------linux-----------------", "anchor_text": "Linux"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Ffa3f7c26dc7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpyspark-mysql-tutorial-fa3f7c26dc7&user=Gregory+Janesch&userId=25bfadf6a6f7&source=-----fa3f7c26dc7---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Ffa3f7c26dc7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpyspark-mysql-tutorial-fa3f7c26dc7&user=Gregory+Janesch&userId=25bfadf6a6f7&source=-----fa3f7c26dc7---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ffa3f7c26dc7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpyspark-mysql-tutorial-fa3f7c26dc7&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----fa3f7c26dc7--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Ffa3f7c26dc7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpyspark-mysql-tutorial-fa3f7c26dc7&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----fa3f7c26dc7---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----fa3f7c26dc7--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----fa3f7c26dc7--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----fa3f7c26dc7--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----fa3f7c26dc7--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----fa3f7c26dc7--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----fa3f7c26dc7--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----fa3f7c26dc7--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----fa3f7c26dc7--------------------------------", "anchor_text": ""}, {"url": "https://gjanesch.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://gjanesch.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Gregory Janesch"}, {"url": "https://gjanesch.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "24 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F25bfadf6a6f7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpyspark-mysql-tutorial-fa3f7c26dc7&user=Gregory+Janesch&userId=25bfadf6a6f7&source=post_page-25bfadf6a6f7--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F4a56a38a3f4d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpyspark-mysql-tutorial-fa3f7c26dc7&newsletterV3=25bfadf6a6f7&newsletterV3Id=4a56a38a3f4d&user=Gregory+Janesch&userId=25bfadf6a6f7&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}