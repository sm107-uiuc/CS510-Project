{"url": "https://towardsdatascience.com/anonymizing-data-sets-part-2-84b813a4ff7e", "time": 1683013358.539084, "path": "towardsdatascience.com/anonymizing-data-sets-part-2-84b813a4ff7e/", "webpage": {"metadata": {"title": "Anonymizing Data Sets Part 2. Removing Emails, Sensitive Numbers\u2026 | by MC | Towards Data Science", "h1": "Anonymizing Data Sets Part 2", "description": "A while back a colleague asked for my help anonymizing some data. The data set he provided piqued my interest and led to some of what we are going to discuss today. When we talk of anonymizing data\u2026"}, "outgoing_paragraph_urls": [{"url": "https://regex101.com", "anchor_text": "https://regex101.com", "paragraph_index": 19}, {"url": "https://stackoverflow.com/questions/34773317/python-pandas-removing-substring-using-another-column", "anchor_text": "https://stackoverflow.com/questions/34773317/python-pandas-removing-substring-using-another-column", "paragraph_index": 19}], "all_paragraphs": ["A while back a colleague asked for my help anonymizing some data. The data set he provided piqued my interest and led to some of what we are going to discuss today.", "When we talk of anonymizing data, we mean to remove personal information or any information that could be used to identify or track an individual. In some cases, this is referred to as personally identifiable information (pii). This information could include but is not limited to: names, emails, addresses, phone numbers, geolocation, social security numbers (ssn), vin numbers, account numbers, identification numbers, credit card information etc", "This document would walk you through how to build python queries that extract these items from your data set. In terms of scope, this document adopts a regex approach to identify and replace emails, sensitive numbers, vins and addresses from a data set or string.", "Emails are extremely common and are used in almost every application. In fact, when most people give out their emails they do not realize they are giving out a wealth of information. While emails may be useful to data scientists, for monetization or other purposes that require the data to be de-identified, we might need to get rid of email data while leaving the rest of the data in tact. Using a simple regex function can help with the problem.", "To replace all the occurrences of email addresses in a string dn by \u2018xxx\u2019 we can do as below:", "This section shows how to remove sensitive numbers from a data frame. The regex function used here would exclude phone numbers, ssn, latitude and longitude coordinates, some zipcodes etc.", "To find all sensitive numbers above use the function below:", "To find and replace all sensitive numbers in the data frame by xxx we can create a function such as below:", "To create a new column in the data set that replaces all of the sensitive numbers we can do something like:", "The output of this query is as below:", "A few things to note about the function above: It removes all phone number formats in the dataframe \u2014 domestic and international, and removes the latlong coordinates as well as the ssn on row 14 (Mima\u2019s row) and the zipcode on row 15 (Alfred\u2019s row). It does not, however, remove numbers less than 6 digits but would remove all numbers greater than 5 digits.", "The vin number is sensitive because once you purchase a vehicle, that vin number becomes tied to your person. When tied to the appropriate data, it could be used to track not only your pattern of movement but also your home address, registration and phone number etc. The vin number is becoming increasingly relevant as more and more people (and organizations) in developed countries such as the US are obtaining vehicles to facilitate movement and as a precaution in covid times. We can remove vin numbers from data as shown below.", "Removing or replacing addresses from a dataframe is pretty tricky and a problem for many enterprises. Here, by combining regex with list comprehension and a few mapping functions, we are able to identify and remove several different address formats from a data set.", "The created data set looks like:", "To identify addresses we can use the two functions below; addy and addy2. The first function, addy identifies the address but also adds extra text. The second function addy2 cleans up addy and limits the additional data that is identified as part of the address.", "Apply both functions to the data set as below:", "To replace the addresses from the data set, use the query below (notice the use of list comprehension and mapping functions to eliminate the need to explicitly create loops and to increase speed):", "Notice that the queries correctly replace all of the addresses in the dataframe column including the two addresses in the first row. There is some minor data loss as a few extra words were also replaced as part of the address. In row 1, \u2018they loved\u2019 and in row 6, \u2018a\u2019 are captured and later replaced as part of the address. However, in the grand scheme of these, these are minor especially given the alternative of leaving the address in place and potentially getting a lawsuit or violating a person\u2019s privacy.", "After looking at each of these types of pii separately, you can put the functions developed into a transformation and apply it to a dataset all at once. Keep in mind that, if including the part to take off sensitive numbers in a data set that has numerical columns, the numerical columns should be excluded before applying the function or transformation. Also here, we created several new columns. When implementing the queries above do not forget to drop the initial columns in the final dataset so that it is truly free of personally identifiable data. Lastly, when dealing with huge datasets it may be easier to use pyspark (or scala) directly or to convert the dataframe to a pyspark dataframe and perform the transformation (you may have to create most of the functions as udfs).", "This work was created with the help of https://regex101.com, excel and jupyter notebooks for python. It was also informed by several stackoverflow articles including https://stackoverflow.com/questions/34773317/python-pandas-removing-substring-using-another-column", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data professional with extensive experience leading data science and data engineer product teams. Experienced in several technologies including big data."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F84b813a4ff7e&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fanonymizing-data-sets-part-2-84b813a4ff7e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fanonymizing-data-sets-part-2-84b813a4ff7e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fanonymizing-data-sets-part-2-84b813a4ff7e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fanonymizing-data-sets-part-2-84b813a4ff7e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----84b813a4ff7e--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----84b813a4ff7e--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://nemo382003.medium.com/?source=post_page-----84b813a4ff7e--------------------------------", "anchor_text": ""}, {"url": "https://nemo382003.medium.com/?source=post_page-----84b813a4ff7e--------------------------------", "anchor_text": "MC"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fd0a57b904968&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fanonymizing-data-sets-part-2-84b813a4ff7e&user=MC&userId=d0a57b904968&source=post_page-d0a57b904968----84b813a4ff7e---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F84b813a4ff7e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fanonymizing-data-sets-part-2-84b813a4ff7e&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F84b813a4ff7e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fanonymizing-data-sets-part-2-84b813a4ff7e&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://regex101.com", "anchor_text": "https://regex101.com"}, {"url": "https://stackoverflow.com/questions/34773317/python-pandas-removing-substring-using-another-column", "anchor_text": "https://stackoverflow.com/questions/34773317/python-pandas-removing-substring-using-another-column"}, {"url": "https://medium.com/tag/gdpr-compliance?source=post_page-----84b813a4ff7e---------------gdpr_compliance-----------------", "anchor_text": "Gdpr Compliance"}, {"url": "https://medium.com/tag/data?source=post_page-----84b813a4ff7e---------------data-----------------", "anchor_text": "Data"}, {"url": "https://medium.com/tag/privacy?source=post_page-----84b813a4ff7e---------------privacy-----------------", "anchor_text": "Privacy"}, {"url": "https://medium.com/tag/analytics?source=post_page-----84b813a4ff7e---------------analytics-----------------", "anchor_text": "Analytics"}, {"url": "https://medium.com/tag/data-science?source=post_page-----84b813a4ff7e---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F84b813a4ff7e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fanonymizing-data-sets-part-2-84b813a4ff7e&user=MC&userId=d0a57b904968&source=-----84b813a4ff7e---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F84b813a4ff7e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fanonymizing-data-sets-part-2-84b813a4ff7e&user=MC&userId=d0a57b904968&source=-----84b813a4ff7e---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F84b813a4ff7e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fanonymizing-data-sets-part-2-84b813a4ff7e&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----84b813a4ff7e--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F84b813a4ff7e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fanonymizing-data-sets-part-2-84b813a4ff7e&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----84b813a4ff7e---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----84b813a4ff7e--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----84b813a4ff7e--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----84b813a4ff7e--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----84b813a4ff7e--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----84b813a4ff7e--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----84b813a4ff7e--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----84b813a4ff7e--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----84b813a4ff7e--------------------------------", "anchor_text": ""}, {"url": "https://nemo382003.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://nemo382003.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "MC"}, {"url": "https://nemo382003.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "22 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fd0a57b904968&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fanonymizing-data-sets-part-2-84b813a4ff7e&user=MC&userId=d0a57b904968&source=post_page-d0a57b904968--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F4af6c832661e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fanonymizing-data-sets-part-2-84b813a4ff7e&newsletterV3=d0a57b904968&newsletterV3Id=4af6c832661e&user=MC&userId=d0a57b904968&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}