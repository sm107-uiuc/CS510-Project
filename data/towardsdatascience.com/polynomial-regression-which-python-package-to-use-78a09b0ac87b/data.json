{"url": "https://towardsdatascience.com/polynomial-regression-which-python-package-to-use-78a09b0ac87b", "time": 1683011131.6479628, "path": "towardsdatascience.com/polynomial-regression-which-python-package-to-use-78a09b0ac87b/", "webpage": {"metadata": {"title": "Polynomial regression - the correspondence between math and python implementation in numpy, scipy, sklearn and tensorflow. | Towards Data Science", "h1": "Polynomial Regression \u2014 which python package to use?", "description": "Polynomial regression is one of the most fundamental concepts used in data analysis and prediction. Not only can any (infinitely differentiable) function be expressed as a polynomial through Taylor\u2026"}, "outgoing_paragraph_urls": [{"url": "https://en.wikipedia.org/wiki/Taylor_series", "anchor_text": "Taylor series", "paragraph_index": 0}, {"url": "https://gist.github.com/OlegZero13/8295d18d5339a96a8dee596d1189d0d6", "anchor_text": "gist", "paragraph_index": 21}, {"url": "https://levelup.gitconnected.com/using-dunder-methods-to-refine-data-model-c58ee41102e9", "anchor_text": "quaternion example", "paragraph_index": 21}, {"url": "https://numpy.org/doc/stable/reference/generated/numpy.polyfit.html", "anchor_text": "numpy", "paragraph_index": 30}, {"url": "https://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.curve_fit.html", "anchor_text": "scipy", "paragraph_index": 32}, {"url": "https://scikit-learn.org/stable/index.html", "anchor_text": "Scikit-learn", "paragraph_index": 34}, {"url": "https://towardsdatascience.com/polynomial-regression-with-scikit-learn-what-you-should-know-bed9d3296f2", "anchor_text": "post", "paragraph_index": 37}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.PolynomialFeatures.html", "anchor_text": "PolynomialFeatures", "paragraph_index": 38}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.pipeline.make_pipeline.html", "anchor_text": "pipeline", "paragraph_index": 38}, {"url": "https://www.tensorflow.org/", "anchor_text": "Tensorflow 2.0", "paragraph_index": 40}, {"url": "https://www.codeproject.com/Tips/5263107/Updating-Linear-Regression-Model-To-TensorFlow-2-0", "anchor_text": "post", "paragraph_index": 40}, {"url": "https://landing.mailerlite.com/webforms/landing/j5y2q1", "anchor_text": "newsletter", "paragraph_index": 47}, {"url": "https://forms.gle/bNpf9aqZJGLgaU589", "anchor_text": "form", "paragraph_index": 47}, {"url": "https://zerowithdot.com", "anchor_text": "https://zerowithdot.com", "paragraph_index": 49}], "all_paragraphs": ["Polynomial regression is one of the most fundamental concepts used in data analysis and prediction. Not only can any (infinitely differentiable) function be expressed as a polynomial through Taylor series at least within a certain interval, it is also one of the first problems that a beginner in machine-learning is confronted with. It is used across various disciplines such as financial analysis, signal processing, medical statistics, and more.", "While polynomial regression is a relatively simple concept, it became a sort of \u201chello world\u201d problem in machine-learning as it touches upon many core concepts. Still, some parts may sound confusing, especially since:", "In this blog post, we are going to construct it from the beginning using both equations and express them through the code. Then, we will compare our implementation against four python libraries that are the most widely used in data science:", "and discuss differences between them, while pointing to similarities at the fundamental level.", "Let\u2019s discuss the mathematical foundations first.", "Mathematically, the problem of regression is an attempt to model a relationship between an independent variable x and a dependent variable y. Assuming y\u2019s dependent on x is expressed in the following form:", "we speak of polynomial regression (with \u03b5 denoting a noise term). Naturally, if the maximum n = 1, the problem becomes linear regression.", "To solve the problem means to determine the values of all a\u2099\u2019s to represent the data well. It boils down to the elements of the following steps:", "When speaking of polynomial regression, the very first thing we need to assume is the degree of the polynomial we will use as the hypothesis function. If we choose to be the degree, the hypothesis will take the following form:", "Next, we choose the metric by which we express the cost function. For regression problems, it makes sense to choose the so-called mean square error (MSE), which measures the average distance between the individual points and our predictions brought to the second power,", "Here m relates to the number of data points and 1/2 factor is introduced for convenience (see later). We also denote all parameters as a vector of parameters \u03b8 = (\u03b8\u2081, \u03b8\u2082, \u2026, \u03b8\u2099).", "The MSE metrics is only a choice, but it is reasonable due to the following reasons:", "Once we have established the cost function and set some random initial \u03b8, we want to minimize J. One of the possible options is the gradient descent optimization algorithm. As the name suggests, it requires us to calculate \u2207J and subsequently update all \u03b8\u2018s accordingly.", "In other words, we need to compute the derivatives of J concerning every \u03b8\u2096, and use them to change the values of \u03b8:", "thus making the hypothesis better and better at representing the data.", "Fortunately, dJ/d\u03b8 is easy to calculate:", "The last term is the derivative of the hypothesis function with respect to \u03b8. Because we assumed to be a polynomial:", "If we organize all x into a vector of examples, we can express the formula above using vector-matrix multiplication:", "or in a more compact form", "Here, X expresses a matrix composed of example vectors raised to the consecutive powers j = 0, 1, \u2026, n.", "We call this implementation naive because it is in no way optimized for performance. Instead, the focus was to emphasize the correspondence between the code and the underlying equations.", "To start, we will use our custom implementation of a symbolic polynomial (see gist). The Polynomial class defines a callable object based on the polynomial expression (the first equation). It implements many algebraic methods similar to our quaternion example), but for now the most important part is the initialization.", "We begin with creating of a Polynomial object with random coefficients \u03b8.", "This method accepts and returns a polynomial with random coefficients. Next, we define our MAE cost function:", "Here len(y) is equivalent to and h, X and y are to be a hypothesis, then x and y - the vectors of arguments and values. Note that capitalizing X is more of a tradition to emphasize its matrix-like character. In our case, however, X is associated with one-dimensional data only.", "Next, we need to express the gradient of J. Thanks to the derivation, we already know the expression:", "In this function, we need to perform a couple of reshaping to ensure we can multiply the matrix by a vector. Lines 4\u20136 are responsible for constructing X, and reversed function is used to comply with the convention that \u03b8\u2099 stands before \u03b8\u2099\u208b\u2081.", "Finally, the optimization routine is done with the following function:", "Here, line 2 is just an initialization of the hypothesis. Then, inside the for loop, we perform \u03b8 \u2190\u03b8 - \u03b1\u2207J, where \u03b1 is the so-called learning rate lr and the repetition cycles are traditionally called \"epochs\".", "The optimization can be verified by executing a small script:", "The first library that implements polynomial regression is numpy. It does so using numpy.polyfit function, which given the data ( X and y) as well as the degree performs the procedure and returns an array of the coefficients \u03b8.", "The function offers additional diagnostics if full is set to True, giving us information related to uncertainties.", "Another \u201crecipe\u201d for solving the polynomial regression problem is curve_fit included in scipy. This function is more generic comparing to polyfit as it does not require our \"model\" to assume a polynomial form. Its interface is also different.", "As opposed to polyfit, this function requires a model-function to passed in as an argument in the first place. It can be any parametrized mathematical formula, however, curve_fit imposes one condition: the model-function itself accepts data x as its first argument. Finally, it returns the optimized coefficients similarly to polyfit, although it also returns the diagnostic information (hence the[0] at the end to suppress it).", "Scikit-learn (or sklearn) is a \u201cgo-to\u201d library when it comes it machine-learning. It focuses heavily on interface consistency, meaning that it tries to unify access to different features and algorithms using the same methods such as.fit, .transform, .fit_transform,and .predict. Solving a linear regression solution is fairly easy, however, the polynomial regression case requires a bit of thinking.", "Let\u2019s start with the linear regression.", "Here, the solution is realized through the LinearRegression object. Following the scikit-learn's logic, we first adjust the object to our data using the.fit method and then use .predict to render the results. Note that X needs to be reshaped to an (m, 1) vector column.", "To address the more generic polynomial regression case, we need to combine LinearRegression with PolynomialFeatures object as there is no direct solution available. Indeed, sklearn was constructed with the intention to handle data-related problems rather than be an equation solver. More on the differences can be found in this post.", "The starting point is the PolynomialFeatures class, which creates \u201cmixed\u201d terms such as , based on generic variables and . Here, we apply this transformation to , this obtaining a feature vector (matrix) (1, x, x\u00b2), as n = 2, and x is one-dimensional. Then, using sklearn\u2019s pipeline, we combine x\u2018s with linear coefficients \u03b8, basically treating each x as a separate variable. Finally, we solve it as if we faced the standard linear regression problem, obtaining \u03b8.", "We can see that the approach taken here is quite different from both numpy and scipy. As sklearn \u201csees\u201d the problem more in terms of consecutive adjustments ( fit), transformations of data (not needed here), and predictions ( predict). Either way, the result is the same.", "The last from the packages that we cover here is Tensorflow 2.0. As there have been substantial changes to the API introduced in version 2.0, we are not going to present the solution offered in 1.x. However, if you are interested, please refer to this excellent post by Tr\u1ea7n Ng\u1ecdc Minh.", "The appearance of the process looks quite similar to our original implementation. Under the hood, it is, in fact, very different. Let\u2019s take a look at the following snippet first:", "The logic related to the hypothesis and the cost function is the same. Also, the training is performed using the same method, only the function names are different. What happens, however, is the fact that tensorflow attempts to solve the problem symbolically, by building the so-called graph. The graph is a representation of all mathematical dependencies just so that derivatives can easily be calculated. For example, the theta.assign_sub(...) translates to updating \u03b8 with the gradient, while tf. prefixed functions are the tensorflow symbolic counterparts of the functions known from numpy.", "In this article, we have revisited the polynomial regression problem in both mathematical and programmatic terms. Furthermore, we have compared its implementation using four python libraries that are frequently used in data projects. We also compared them against a custom, demonstration oriented implementation, discussing both differences and similarities.", "In case you still wonder which one to choose, here is our advice:", "If this post has helped you grasp a bigger picture and deepen your understanding, it is good. It means its primary goal has been achieved. Either way, please feel welcome to comment or share it!", "I am planning to bring the articles to next level and offer short screencast video \u00b5-tutorials.", "If you want to be updated concerning the videos and future articles, subscribe to my newsletter. You can also let me know of your expectations by filling out the form. See you soon!", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Scientist | https://zerowithdot.com | makes data make sense"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F78a09b0ac87b&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpolynomial-regression-which-python-package-to-use-78a09b0ac87b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpolynomial-regression-which-python-package-to-use-78a09b0ac87b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpolynomial-regression-which-python-package-to-use-78a09b0ac87b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpolynomial-regression-which-python-package-to-use-78a09b0ac87b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----78a09b0ac87b--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----78a09b0ac87b--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://oleg-zero13.medium.com/?source=post_page-----78a09b0ac87b--------------------------------", "anchor_text": ""}, {"url": "https://oleg-zero13.medium.com/?source=post_page-----78a09b0ac87b--------------------------------", "anchor_text": "Oleg \u017bero"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fb15e8d374ce1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpolynomial-regression-which-python-package-to-use-78a09b0ac87b&user=Oleg+%C5%BBero&userId=b15e8d374ce1&source=post_page-b15e8d374ce1----78a09b0ac87b---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F78a09b0ac87b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpolynomial-regression-which-python-package-to-use-78a09b0ac87b&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F78a09b0ac87b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpolynomial-regression-which-python-package-to-use-78a09b0ac87b&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://private.zerowithdot.com/travelling/", "anchor_text": "2019"}, {"url": "https://en.wikipedia.org/wiki/Taylor_series", "anchor_text": "Taylor series"}, {"url": "https://gist.github.com/OlegZero13/8295d18d5339a96a8dee596d1189d0d6", "anchor_text": "gist"}, {"url": "https://levelup.gitconnected.com/using-dunder-methods-to-refine-data-model-c58ee41102e9", "anchor_text": "quaternion example"}, {"url": "https://numpy.org/doc/stable/reference/generated/numpy.polyfit.html", "anchor_text": "numpy"}, {"url": "https://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.curve_fit.html", "anchor_text": "scipy"}, {"url": "https://scikit-learn.org/stable/index.html", "anchor_text": "Scikit-learn"}, {"url": "https://towardsdatascience.com/polynomial-regression-with-scikit-learn-what-you-should-know-bed9d3296f2", "anchor_text": "post"}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.PolynomialFeatures.html", "anchor_text": "PolynomialFeatures"}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.pipeline.make_pipeline.html", "anchor_text": "pipeline"}, {"url": "https://www.tensorflow.org/", "anchor_text": "Tensorflow 2.0"}, {"url": "https://www.codeproject.com/Tips/5263107/Updating-Linear-Regression-Model-To-TensorFlow-2-0", "anchor_text": "post"}, {"url": "https://landing.mailerlite.com/webforms/landing/j5y2q1", "anchor_text": "newsletter"}, {"url": "https://forms.gle/bNpf9aqZJGLgaU589", "anchor_text": "form"}, {"url": "https://zerowithdot.com/polynomial-regression-in-python/", "anchor_text": "https://zerowithdot.com"}, {"url": "https://medium.com/tag/python?source=post_page-----78a09b0ac87b---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/data-science?source=post_page-----78a09b0ac87b---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----78a09b0ac87b---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/hello-world?source=post_page-----78a09b0ac87b---------------hello_world-----------------", "anchor_text": "Hello World"}, {"url": "https://medium.com/tag/mathematics?source=post_page-----78a09b0ac87b---------------mathematics-----------------", "anchor_text": "Mathematics"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F78a09b0ac87b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpolynomial-regression-which-python-package-to-use-78a09b0ac87b&user=Oleg+%C5%BBero&userId=b15e8d374ce1&source=-----78a09b0ac87b---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F78a09b0ac87b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpolynomial-regression-which-python-package-to-use-78a09b0ac87b&user=Oleg+%C5%BBero&userId=b15e8d374ce1&source=-----78a09b0ac87b---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F78a09b0ac87b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpolynomial-regression-which-python-package-to-use-78a09b0ac87b&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----78a09b0ac87b--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F78a09b0ac87b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpolynomial-regression-which-python-package-to-use-78a09b0ac87b&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----78a09b0ac87b---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----78a09b0ac87b--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----78a09b0ac87b--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----78a09b0ac87b--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----78a09b0ac87b--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----78a09b0ac87b--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----78a09b0ac87b--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----78a09b0ac87b--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----78a09b0ac87b--------------------------------", "anchor_text": ""}, {"url": "https://oleg-zero13.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://oleg-zero13.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Oleg \u017bero"}, {"url": "https://oleg-zero13.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "387 Followers"}, {"url": "https://zerowithdot.com", "anchor_text": "https://zerowithdot.com"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fb15e8d374ce1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpolynomial-regression-which-python-package-to-use-78a09b0ac87b&user=Oleg+%C5%BBero&userId=b15e8d374ce1&source=post_page-b15e8d374ce1--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F6b4620dc0d74&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpolynomial-regression-which-python-package-to-use-78a09b0ac87b&newsletterV3=b15e8d374ce1&newsletterV3Id=6b4620dc0d74&user=Oleg+%C5%BBero&userId=b15e8d374ce1&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}