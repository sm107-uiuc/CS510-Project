{"url": "https://towardsdatascience.com/using-deep-learning-to-classify-relationship-state-with-deepconnection-227e9124c72", "time": 1682997755.337412, "path": "towardsdatascience.com/using-deep-learning-to-classify-relationship-state-with-deepconnection-227e9124c72/", "webpage": {"metadata": {"title": "Using Deep Learning to Classify Relationship State with DeepConnection | by Daniel Bojar | Towards Data Science", "h1": "Using Deep Learning to Classify Relationship State with DeepConnection", "description": "If there is a root domain to the recent explosion in deep learning, it\u2019s certainly computer vision, the analysis of image and video data. So it doesn\u2019t come as a huge surprise that you try your luck\u2026"}, "outgoing_paragraph_urls": [{"url": "https://eft-coupletherapy.ch/therapist/?uid=13", "anchor_text": "Maximiliane Uhlich", "paragraph_index": 0}, {"url": "https://psyarxiv.com/df25j/", "anchor_text": "preprint", "paragraph_index": 0}, {"url": "https://github.com/hardikvasa/google-images-download", "anchor_text": "this", "paragraph_index": 1}, {"url": "https://github.com/aleju/imgaug", "anchor_text": "ImgAug", "paragraph_index": 1}, {"url": "https://arxiv.org/abs/1406.4729", "anchor_text": "SPP", "paragraph_index": 2}, {"url": "https://www.sciencedirect.com/science/article/pii/S0031320318304503", "anchor_text": "PMT", "paragraph_index": 2}, {"url": "https://arxiv.org/abs/1905.09788", "anchor_text": "multi-sample dropout", "paragraph_index": 3}, {"url": "https://github.com/Bribak/DeepConnection", "anchor_text": "GitHub", "paragraph_index": 4}, {"url": "https://github.com/NVIDIA/apex", "anchor_text": "Apex", "paragraph_index": 4}, {"url": "https://arxiv.org/abs/1610.02391", "anchor_text": "Grad-CAM", "paragraph_index": 5}, {"url": "https://psyarxiv.com/df25j/", "anchor_text": "preprint", "paragraph_index": 11}, {"url": "https://github.com/Bribak/DeepConnection", "anchor_text": "GitHub repo", "paragraph_index": 11}, {"url": "http://dbojar.com", "anchor_text": "dbojar.com", "paragraph_index": 13}], "all_paragraphs": ["If there is a root domain to the recent explosion in deep learning, it\u2019s certainly computer vision, the analysis of image and video data. So it doesn\u2019t come as a huge surprise that you try your luck with some computer vision techniques while studying deep learning. Long story short, my partner (Maximiliane Uhlich) and I decided to apply this form of deep learning to images of romantic couples because Maximiliane is a relationship researcher and couple therapist. Specifically, we wanted to find out whether we can accurately tell if any given couple, depicted on an image or video, is happy in their relationship or not? Turns out, we can! With a classification accuracy of nearly 97 percent, our final model (which we dubbed DeepConnection) was able to clearly differentiate between unhappy and happy couples. You can read the full story in our preprint, what follows here is a rough sketch of what we did.", "For our dataset, we did some webscraping (using this handy Python script) for images of happy & unhappy couples. In the end, that left us with a training set of about 1000 images. Which isn\u2019t terribly much, so we called the powers of data augmentation and transfer learning to our rescue. Data augmentation, small-ish changes in image orientation, color hue and intensity, and a whole lot of other things, prevents your model from learning some irrelevant connections. For instance, if images of happy couples on average are brighter than those of unhappy couples, we wouldn\u2019t want our model to map this association. We made use of the (great) ImgAug library and engaged in quite some heavy data augmentation to make sure our model is robust. Basically, on every image for every batch, at least a part of the augmentation techniques are applied. Below you can see an exemplary data batch just with the same image 48 times with representative data augmentation profiles.", "So far, so good. Since we\u2019re talking images here, we decided to use a ResNet-type model as the base for DeepConnection, pretrained on the huge ImageNet dataset. Pretrained on all kinds of images, this model already learned a lot of useful shapes and forms and has a head start via this transfer learning. All of our models are in PyTorch by the way and we used the free GPU resources on Google Colab for training and inference. That base model in itself was already a good start for classification but we decided to take it further and replace the last adaptive pooling layer of our ResNet-34 base model with a spatial pyramid pooling layer (SPP). Here, the processed image data is split into different numbers of squares and only the maximum values are passed on for further analysis. This allows the model to focus on important features, makes it robust to different images sizes, and immune to image perturbation. After that, we placed a power mean transformation (PMT) layer to transform the data with several mathematical functions to introduce nonlinearities and allow DeepConnection to capture more complex relationships from the data. Both of these additions increased our classification accuracy and we ended up with around 97 percent on our separate validation set. You can check the code for SPP / PMT and subsequent classification layers below.", "If you have keen eyes, you may have noticed the eight variants on the final classification layer. What may seem like wasteful calculation is actually the opposite. This concept has been recently put forward as multi-sample dropout and dramatically accelerates convergence during training. It\u2019s basically a compromise between preventing the model to learn spurious relations (overfitting) and trying not to throw away information from the dropout mask.", "We had a couple of other tweaks in the project, best check out the preprint or the associated code on GitHub for more information. Just to briefly mention a few: we trained the model with mixed precision (using the Apex library) for vastly lower memory usage, used early stopping to prevent overfitting, and learning rate annealing according to a cosine function.", "After reaching a satisfactory classification accuracy (with correspondingly great recall & precision), we wanted to find out if we can learn something from the classification performed by DeepConnection. So we engaged in model interpretation and used a technique known as Gradient-weighted Class Activation Mapping (Grad-CAM). Basically, Grad-CAM takes the incoming gradients of the final convolutional layer to determine salient image regions which can be visualized as an upsampled heatmap on top of the original images. If you want to see how that looks like, just have a look at the figure below, with the Grad-CAM code after that.", "We discuss this further in the paper, and embed it into existing psychological research, but DeepConnection seems to focus mostly on the facial area. From a research perspective, this makes a lot of sense, as communication and emotions are heavily conveyed by facial expressions. We also wanted to see if we could derive actual features via model interpretation in addition to the visual sense gained by Grad-CAM. For this, we created state-of-activation plots to visualize which of the neurons of the final classification layer were activated by any given image.", "In contrast to the other models, DeepConnection also found specifically unhappy features and didn\u2019t just use the absence of happy features for a classification as unhappy. But further research is required to actually map these features to human-interpretable aspects. We also tried DeepConnection on video frames of couples not seen by the model before, which worked quite well.", "Overall, the robustness of the model is one of its big strengths. Accurate classification worked with homosexual couples, couples of color, couples with additional people in the image, couples which faces were not entirely visible, and more. For the case of the presence of additional people in the image, DeepConnection even recognizes if the additional people seem happy or not but still focuses its prediction on the couple itself.", "Next steps, in addition to further model interpretation, would be to use a larger training dataset with the potential to train more sophisticated models. It would also be interesting to use DeepConnection as an assistant for couple therapists, with real-time feedback about the current relationship state of the (filmed) couple during a session or afterwards for analysis. Additionally, I would encourage you to input your own image with your partner and see what DeepConnection has to say about your relationship! I\u2019m happy to report that it at least blessed our relationship, so that\u2019s a good start I guess!", "Let me know if you have any ideas how to move this forward or what you would like to see added / improved!", "Here are the links to the preprint and GitHub repo again, if you\u2019re interested.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Machine Learning, Glycobiology, Synthetic Biology. Strong opinions, weakly held. Fascinated & Inspired by Counterintuitives. @daniel_bojar & dbojar.com"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F227e9124c72&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-deep-learning-to-classify-relationship-state-with-deepconnection-227e9124c72&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-deep-learning-to-classify-relationship-state-with-deepconnection-227e9124c72&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-deep-learning-to-classify-relationship-state-with-deepconnection-227e9124c72&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-deep-learning-to-classify-relationship-state-with-deepconnection-227e9124c72&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----227e9124c72--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----227e9124c72--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@daniel_24692?source=post_page-----227e9124c72--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@daniel_24692?source=post_page-----227e9124c72--------------------------------", "anchor_text": "Daniel Bojar"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F1c2aa6d48d73&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-deep-learning-to-classify-relationship-state-with-deepconnection-227e9124c72&user=Daniel+Bojar&userId=1c2aa6d48d73&source=post_page-1c2aa6d48d73----227e9124c72---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F227e9124c72&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-deep-learning-to-classify-relationship-state-with-deepconnection-227e9124c72&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F227e9124c72&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-deep-learning-to-classify-relationship-state-with-deepconnection-227e9124c72&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://eft-coupletherapy.ch/therapist/?uid=13", "anchor_text": "Maximiliane Uhlich"}, {"url": "https://psyarxiv.com/df25j/", "anchor_text": "preprint"}, {"url": "https://github.com/hardikvasa/google-images-download", "anchor_text": "this"}, {"url": "https://github.com/aleju/imgaug", "anchor_text": "ImgAug"}, {"url": "https://arxiv.org/abs/1406.4729", "anchor_text": "SPP"}, {"url": "https://www.sciencedirect.com/science/article/pii/S0031320318304503", "anchor_text": "PMT"}, {"url": "https://arxiv.org/abs/1905.09788", "anchor_text": "multi-sample dropout"}, {"url": "https://github.com/Bribak/DeepConnection", "anchor_text": "GitHub"}, {"url": "https://github.com/NVIDIA/apex", "anchor_text": "Apex"}, {"url": "https://arxiv.org/abs/1610.02391", "anchor_text": "Grad-CAM"}, {"url": "https://psyarxiv.com/df25j/", "anchor_text": "preprint"}, {"url": "https://github.com/Bribak/DeepConnection", "anchor_text": "GitHub repo"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----227e9124c72---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/relationships?source=post_page-----227e9124c72---------------relationships-----------------", "anchor_text": "Relationships"}, {"url": "https://medium.com/tag/computer-vision?source=post_page-----227e9124c72---------------computer_vision-----------------", "anchor_text": "Computer Vision"}, {"url": "https://medium.com/tag/psychology?source=post_page-----227e9124c72---------------psychology-----------------", "anchor_text": "Psychology"}, {"url": "https://medium.com/tag/couples?source=post_page-----227e9124c72---------------couples-----------------", "anchor_text": "Couples"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F227e9124c72&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-deep-learning-to-classify-relationship-state-with-deepconnection-227e9124c72&user=Daniel+Bojar&userId=1c2aa6d48d73&source=-----227e9124c72---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F227e9124c72&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-deep-learning-to-classify-relationship-state-with-deepconnection-227e9124c72&user=Daniel+Bojar&userId=1c2aa6d48d73&source=-----227e9124c72---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F227e9124c72&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-deep-learning-to-classify-relationship-state-with-deepconnection-227e9124c72&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----227e9124c72--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F227e9124c72&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-deep-learning-to-classify-relationship-state-with-deepconnection-227e9124c72&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----227e9124c72---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----227e9124c72--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----227e9124c72--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----227e9124c72--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----227e9124c72--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----227e9124c72--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----227e9124c72--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----227e9124c72--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----227e9124c72--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@daniel_24692?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@daniel_24692?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Daniel Bojar"}, {"url": "https://medium.com/@daniel_24692/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "126 Followers"}, {"url": "http://dbojar.com", "anchor_text": "dbojar.com"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F1c2aa6d48d73&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-deep-learning-to-classify-relationship-state-with-deepconnection-227e9124c72&user=Daniel+Bojar&userId=1c2aa6d48d73&source=post_page-1c2aa6d48d73--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fd2ae7c7ca71c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-deep-learning-to-classify-relationship-state-with-deepconnection-227e9124c72&newsletterV3=1c2aa6d48d73&newsletterV3Id=d2ae7c7ca71c&user=Daniel+Bojar&userId=1c2aa6d48d73&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}