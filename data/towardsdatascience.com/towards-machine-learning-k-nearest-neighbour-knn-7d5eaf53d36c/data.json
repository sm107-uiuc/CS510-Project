{"url": "https://towardsdatascience.com/towards-machine-learning-k-nearest-neighbour-knn-7d5eaf53d36c", "time": 1683014603.519912, "path": "towardsdatascience.com/towards-machine-learning-k-nearest-neighbour-knn-7d5eaf53d36c/", "webpage": {"metadata": {"title": "Towards machine learning - K Nearest Neighbour (KNN) | Towards Data Science", "h1": "Towards machine learning \u2014 K Nearest Neighbour (KNN)", "description": "K Nearest Neighbour (KNN) classifier for cars according to fuel economy and engine size."}, "outgoing_paragraph_urls": [{"url": "https://www.coursera.org/learn/python-machine-learning/home/welcome", "anchor_text": "Applied Machine Learning in Python", "paragraph_index": 1}, {"url": "https://github.com/udacity/AIPND/tree/master/Matplotlib/data", "anchor_text": "Udacity", "paragraph_index": 2}], "all_paragraphs": ["Machine Learning (ML) is a very popular term nowadays. I think it is impossible to go through a day online, without meeting the term. As many before me, and I bet, many after me, sometime ago I started my journey in this interesting area.", "There are many well written and well thought online resources on this topic. I am not trying to invent the wheel new, I will just try to share my perspective, or thoughts when going through a popular online Course by the University of Michigan, Applied Machine Learning in Python. Also, my goal is to emphasize some of key insights of K Nearest Neighbour method (KNN), what I hope will help a beginner (like me \ud83d\ude0a) when starting with this popular machine learning method.", "To make things a bit more interesting, I used the fuel economy dataset from Udacity.", "KNN algorithm is a type of supervised ML which is often used in classification and regression applications. KNN classifiers are instance (memory) based classifiers, which means they rely on similar features between classes (inputs) in order to predict the class of a new (independent) input or data point. In general, we need a training dataset, where our model is trained to predict, and we evaluate the model performance on an independent dataset, to check the accuracy.", "How exactly does KKN work? Well, let us say we have a dataset (array) of points, which need to be classified. Check the image bellow.", "Then, a new data point is added (brown) at the location (50, 40). We check the K number of nearest points (\u201cneighbours\u201d) to that new point. We assume, K = 5. So wee need to find the 5 nearest point to the new entry (brown point).", "If 5 is chosen, the 5 nearest points in terms of Euclidian distance are found (light purple lines), we can see that out of 5 points, 4 of them are red, therefore our brown point gets classified to the \u201cred\u201d corner.", "The K=5 presents a balance between a noisy model with outliers and possible mislabelled data (low number K=1, or K=2), or a large K, which causes underfitting, so basically, the result is less detailed, or in worst case scenario, everything becomes one class. The right K depends on the dataset. Most often K is an odd number, to avoid random decisions if a point is equally distanced from 2 know classes.", "Enough theory let us get practical! \ud83d\ude0a", "First we will import dependencies, in this case, we need numpy, pandas, matplotlib and scikit-learn.", "Also we need some data. In this example the popular car fuel economy dataset from Udacity has been used. This is a dataset of 3929 cars with some basic information about them, like make, model, year, transmission type, vehicle class, number of cylinders, fuel consumption, CO2 output etc.", "Here, I will give an example how to classify a car of unknown vehicle class by the amount of cylinders, displacement, combined fuel consumption and CO2 output into appropriate class using the KNN algorithm.", "We check the unique values of the VClass column, to get all the vehicle classes present in our dataset. We got 5 classes. Also, we create a new column with class labels for plotting purposes.", "As our model needs to be trained first, we will split the data into train and test data (used later for evaluation). To do so, we use the train_test_split function from scikit-learn library.", "With a large dataset (3929 entries) we don\u2019t need to worry about train and/or test size. Therefore, the test_size argument of the function is left to None (=0.25) which means that the test set contains 25% of the data.", "It\u2019s always good practice to examine the data. for this purpose a feature pairplot is used.", "Some interesting patterns can be observed. I.e. with increase of cylinder count, the displacement and CO2 output increases, while the average miles per gallon range decreases. Also, larger fuel consumption produces more CO2.", "Another great way to observe the data is a 3D plot. Here CO2, cylinder count and displacement are plotted on x, y, and z axis, respectively.", "Again, one can observe that cars with more cylinders and larger displacement tend to produce more CO2. Although, some of smaller cars with 4 or 6 cylinders can also produce significant amounts of CO2 (probably sporty cars with large power output). But in general, the larger the engine, the more CO2 it produces.", "First we need to choose the number of K nearest neighbours. As earlier explained, for this example, KNN=5 is chosen.", "Then the model is trained, and the accuracy is displayed.", "The accuracy of the model is 0.4933. Which doesn\u2019t look especially good on paper. But for the two cars which I\u2019ve tried, the model gave good predictions.", "A Ford Fiesta is a \u201cSubcompact\u201d and a BMW M5 is a \u201cLarge car\u201d.", "Here we will check if changing the number of nearest neighbours K can change the accuracy of our model. To do so we write a simple for loop. Also, the random_state is changed, which leads to different train/test split combinations.", "For this dataset and this train/test split, larger K values lead to smaller accuracy. It is possible, that a different train/test split would yield different results.", "It is interesting to observe that the training set #44 produces larger maximum and minimum accuracy.", "And last but not least, we will check if changing the train test split ration can increase the accuracy of our model. First we generate a list t of possible train/test ratios. Again, the K is set to 5. Then a loop is created where for each possible t ratio, 200 simulations are run and the accuracy for each is calculated. The mean accuracy of 500 runs for each ratio is then calculated and plotted as a scatter plot to observe the behaviour.", "As observed from the plot, the accuracy decreases with a decrease in training size sample . Changing the random_state seems to have no effect here, which makes sense, since we run 500 simulations for each of the train/test ratios and then calculate the mean accuracy.", "Here a short implementation of a KNN classifier on the popular car fuel consumption dataset is presented. First, a brief explanation of the KNN method is given. Then, the dataset is examined to see coherence in our dataset. Then we define a KNN classifier with K set to 5, which means that a new data point is classified according to the 5 nearest neighbours.", "For the two independent test examples, a Ford Fiesta and BMW M5 the classification works fine. Also, the model gets evaluated for different values of K, where for this particular dataset, smaller values of K seem to yield a more precise model. Changing the random_state to a different value, can change this behaviour, but not significantly.", "Also, an increase in the training size to test size ratio, should yield better results. Here, changing the random_state value, due to large number of simulations, has less impact.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "PhD \u2192 Hydrology & Deep Learning (ANN hydrological models). Teaching and Research Assistant at University of Zagreb."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F7d5eaf53d36c&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftowards-machine-learning-k-nearest-neighbour-knn-7d5eaf53d36c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftowards-machine-learning-k-nearest-neighbour-knn-7d5eaf53d36c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftowards-machine-learning-k-nearest-neighbour-knn-7d5eaf53d36c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftowards-machine-learning-k-nearest-neighbour-knn-7d5eaf53d36c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----7d5eaf53d36c--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----7d5eaf53d36c--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@Karlo_Leskovar?source=post_page-----7d5eaf53d36c--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@Karlo_Leskovar?source=post_page-----7d5eaf53d36c--------------------------------", "anchor_text": "Karlo Leskovar"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fc0efc778fe01&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftowards-machine-learning-k-nearest-neighbour-knn-7d5eaf53d36c&user=Karlo+Leskovar&userId=c0efc778fe01&source=post_page-c0efc778fe01----7d5eaf53d36c---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F7d5eaf53d36c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftowards-machine-learning-k-nearest-neighbour-knn-7d5eaf53d36c&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F7d5eaf53d36c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftowards-machine-learning-k-nearest-neighbour-knn-7d5eaf53d36c&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@teixeiranay?utm_source=medium&utm_medium=referral", "anchor_text": "Nayani Teixeira"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://www.coursera.org/learn/python-machine-learning/home/welcome", "anchor_text": "Applied Machine Learning in Python"}, {"url": "https://github.com/udacity/AIPND/tree/master/Matplotlib/data", "anchor_text": "Udacity"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----7d5eaf53d36c---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/knn?source=post_page-----7d5eaf53d36c---------------knn-----------------", "anchor_text": "Knn"}, {"url": "https://medium.com/tag/python?source=post_page-----7d5eaf53d36c---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/model?source=post_page-----7d5eaf53d36c---------------model-----------------", "anchor_text": "Model"}, {"url": "https://medium.com/tag/classifier?source=post_page-----7d5eaf53d36c---------------classifier-----------------", "anchor_text": "Classifier"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F7d5eaf53d36c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftowards-machine-learning-k-nearest-neighbour-knn-7d5eaf53d36c&user=Karlo+Leskovar&userId=c0efc778fe01&source=-----7d5eaf53d36c---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F7d5eaf53d36c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftowards-machine-learning-k-nearest-neighbour-knn-7d5eaf53d36c&user=Karlo+Leskovar&userId=c0efc778fe01&source=-----7d5eaf53d36c---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F7d5eaf53d36c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftowards-machine-learning-k-nearest-neighbour-knn-7d5eaf53d36c&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----7d5eaf53d36c--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F7d5eaf53d36c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftowards-machine-learning-k-nearest-neighbour-knn-7d5eaf53d36c&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----7d5eaf53d36c---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----7d5eaf53d36c--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----7d5eaf53d36c--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----7d5eaf53d36c--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----7d5eaf53d36c--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----7d5eaf53d36c--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----7d5eaf53d36c--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----7d5eaf53d36c--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----7d5eaf53d36c--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@Karlo_Leskovar?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@Karlo_Leskovar?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Karlo Leskovar"}, {"url": "https://medium.com/@Karlo_Leskovar/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "97 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fc0efc778fe01&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftowards-machine-learning-k-nearest-neighbour-knn-7d5eaf53d36c&user=Karlo+Leskovar&userId=c0efc778fe01&source=post_page-c0efc778fe01--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F5902a10f355e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftowards-machine-learning-k-nearest-neighbour-knn-7d5eaf53d36c&newsletterV3=c0efc778fe01&newsletterV3Id=5902a10f355e&user=Karlo+Leskovar&userId=c0efc778fe01&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}