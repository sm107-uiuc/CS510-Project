{"url": "https://towardsdatascience.com/quickly-test-multiple-models-a98477476f0", "time": 1683007406.897301, "path": "towardsdatascience.com/quickly-test-multiple-models-a98477476f0/", "webpage": {"metadata": {"title": "Quickly Compare Multiple Models. How to train and evaluate multiple\u2026 | by Cole | Towards Data Science", "h1": "Quickly Compare Multiple Models", "description": "There are several theoretical considerations one should take into account. For example, if your features show strong linear relationships to your dependent variable (target) then a linear model is\u2026"}, "outgoing_paragraph_urls": [{"url": "https://towardsdatascience.com/do-you-know-how-to-choose-the-right-machine-learning-algorithm-among-7-different-types-295d0b0c7f60", "anchor_text": "practical considerations", "paragraph_index": 2}, {"url": "https://towardsdatascience.com/a-brief-introduction-to-supervised-learning-54a3e3932590", "anchor_text": "supervised", "paragraph_index": 3}, {"url": "https://towardsdatascience.com/unsupervised-learning-and-data-clustering-eeecb78b422a", "anchor_text": "unsupervised", "paragraph_index": 3}, {"url": "https://towardsdatascience.com/machine-learning-classifiers-a5cc4e1b0623", "anchor_text": "classification", "paragraph_index": 3}, {"url": "https://towardsdatascience.com/introduction-to-machine-learning-algorithms-linear-regression-14c4e325882a", "anchor_text": "regression", "paragraph_index": 3}, {"url": "https://scikit-learn.org/stable/", "anchor_text": "sklearn", "paragraph_index": 6}, {"url": "https://conference.scipy.org/proceedings/scipy2010/pdfs/mckinney.pdf", "anchor_text": "Data structures for statistical computing in python", "paragraph_index": 26}], "all_paragraphs": ["A question all data scientists must confront when working on any machine learning project is\u2026", "Which model architecture is going to best fit my data?", "There are several theoretical considerations one should take into account. For example, if your features show strong linear relationships to your dependent variable (target) then a linear model is likely to work best. If the relationships are non-linear, then maybe an SVM or instance-based classifier like K-Nearest Neighbors would be best. If explainability in crucial, a tree based model may be the way to go. Additionally, there are several practical considerations you ought to take into account.", "For the purposes of this article, I am going to assume you already know whether you are dealing with a supervised vs. unsupervised problem and whether you need classification or regression.", "Unfortunately, there is no clear answer to the question of which model is best. When faced with uncertainty, the scientist in me always resorts to humanity\u2019s most rigorous and sure-fire method for knowledge discovery: the experiment!", "In this article, I will show you how to quickly test multiple models on your dataset to find which ones are likely to provide the best performance allowing you to focus your efforts on fine-tuning and optimizing your model.", "Before we can start any experimentation, we need a dataset. I am going to assume our problem is a supervised binary classification task. Let\u2019s load in the breast cancer dataset from sklearn to get started.", "Next, we need to split the data into a training and test set. I\u2019ve chosen a 75/25 split.", "We are now ready to run some experiments!", "We are going to quickly test the fit of 6 different models on this dataset. I have chosen to test:", "To run the initial experiments, I used the default parameters for each model. To get a more accurate representation of the fit for each of these models, the default parameters would need to be adjusted; however, for the purposes of this article, the general idea is made more clear by not tweaking each model.", "There is a lot to unpack in this script. Firstly, we create a variable dfs to hold all of the datasets that will be created from the application of 5-fold cross validation on the training set.", "Next, models in a list of tuples holding the name and class for each classifier to be tested. After this, we loop through this list and run 5-fold cross validation. The results of each run are recorded in a pandas dataframe which we append to the dfs list. One must note that the metrics recorded here are weighted mean metrics across both classes. This will not work well for any imbalanced dataset as performance on the majority class will overshadow the minority class. One may wish to tweak the script below to record only the metrics for the classes of interest!", "To further aid in evaluation, a classification report on the test set is printed to screen. Finally, we concatenate and return all of our results.", "To wrap up our analysis, we are going to analyze the data in the final dataframe returned from the run_exps() script.", "To obtain better estimates of the distribution of metrics from each model, I run empirical bootstrapping at 30 samples. Additionally, I partition the data into two sorts: performance metrics and fit-time metrics. The following block of code achieves this.", "We now have some robust data to plot and analyze. First, let\u2019s plot our performance metrics from the 5-fold cross validation.", "It is immediately clear that SVMs fit our data rather poorly across all metrics and that the ensemble decision tree models (Random Forest and XGBoost) fit the data very well.", "How about the training and scoring times?", "Wow, SVM just can\u2019t catch a break! The worst performing model and slow to train/score!", "It is interesting to note that XGBoost was far and away the slowest to train; however, it was the best performing. We generally see a trade-off in terms of performance and training time. Consider neural networks which require a massive amount of data and time to train, but which generally perform very well.", "RandomForest, while relatively slow compared to KNN, GNB, and LogReg had the second-best performance. If I were to continue refining models, I would likely focus most of my effort on RandomForest because it performed nearly identical to XGBoost (their 95% confidence intervals might overlap!) but trained almost 4 times faster!", "Should you wish to do more analysis on these models (e.g., calculate confidence intervals around each metric) you will need to access the means and stds for each metric. You will find this information here.", "You now have the tools to rapidly test many different models on your data and to see which architectures might offer the best fit.", "I cannot stress enough that such comparisons are not exhaustive!", "The above analysis considered only mean precision, recall, etc. In your actual problems, it is unlikely that you will care much about mean precision across your classes, instead, you may be focussed on precision for one class in particular! Additionally, one must tune the hyperparameters of each model to truly evaluate their fit to the data.", "Data structures for statistical computing in python, McKinney, Proceedings of the 9th Python in Science Conference, Volume 445, 2010.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fa98477476f0&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fquickly-test-multiple-models-a98477476f0&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fquickly-test-multiple-models-a98477476f0&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fquickly-test-multiple-models-a98477476f0&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fquickly-test-multiple-models-a98477476f0&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----a98477476f0--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----a98477476f0--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://1234567891.medium.com/?source=post_page-----a98477476f0--------------------------------", "anchor_text": ""}, {"url": "https://1234567891.medium.com/?source=post_page-----a98477476f0--------------------------------", "anchor_text": "Cole"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F8d51c08849a5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fquickly-test-multiple-models-a98477476f0&user=Cole&userId=8d51c08849a5&source=post_page-8d51c08849a5----a98477476f0---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa98477476f0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fquickly-test-multiple-models-a98477476f0&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa98477476f0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fquickly-test-multiple-models-a98477476f0&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://towardsdatascience.com/do-you-know-how-to-choose-the-right-machine-learning-algorithm-among-7-different-types-295d0b0c7f60", "anchor_text": "practical considerations"}, {"url": "https://towardsdatascience.com/a-brief-introduction-to-supervised-learning-54a3e3932590", "anchor_text": "supervised"}, {"url": "https://towardsdatascience.com/unsupervised-learning-and-data-clustering-eeecb78b422a", "anchor_text": "unsupervised"}, {"url": "https://towardsdatascience.com/machine-learning-classifiers-a5cc4e1b0623", "anchor_text": "classification"}, {"url": "https://towardsdatascience.com/introduction-to-machine-learning-algorithms-linear-regression-14c4e325882a", "anchor_text": "regression"}, {"url": "https://scikit-learn.org/stable/", "anchor_text": "sklearn"}, {"url": "https://conference.scipy.org/proceedings/scipy2010/pdfs/mckinney.pdf", "anchor_text": "Data structures for statistical computing in python"}, {"url": "https://doi.org/10.1038/s41586-020-2649-2", "anchor_text": "10.1038/s41586\u2013020\u20132649\u20132"}, {"url": "http://jmlr.csail.mit.edu/papers/v12/pedregosa11a.html", "anchor_text": "Scikit-learn: Machine Learning in Python"}, {"url": "https://doi.org/10.1109/MCSE.2007.55", "anchor_text": "J. D. Hunter, \u201cMatplotlib: A 2D Graphics Environment\u201d, Computing in Science & Engineering, vol. 9, no. 3, pp. 90\u201395, 2007"}, {"url": "https://doi.org/10.21105/joss.03021", "anchor_text": "https://doi.org/10.21105/joss.03021"}, {"url": "https://doi.org/10.1145/2939672.2939785", "anchor_text": "https://doi.org/10.1145/2939672.2939785"}, {"url": "https://medium.com/tag/data-science?source=post_page-----a98477476f0---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----a98477476f0---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/python?source=post_page-----a98477476f0---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/sklearn?source=post_page-----a98477476f0---------------sklearn-----------------", "anchor_text": "Sklearn"}, {"url": "https://medium.com/tag/towards-data-science?source=post_page-----a98477476f0---------------towards_data_science-----------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fa98477476f0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fquickly-test-multiple-models-a98477476f0&user=Cole&userId=8d51c08849a5&source=-----a98477476f0---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fa98477476f0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fquickly-test-multiple-models-a98477476f0&user=Cole&userId=8d51c08849a5&source=-----a98477476f0---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa98477476f0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fquickly-test-multiple-models-a98477476f0&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----a98477476f0--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fa98477476f0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fquickly-test-multiple-models-a98477476f0&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----a98477476f0---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----a98477476f0--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----a98477476f0--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----a98477476f0--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----a98477476f0--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----a98477476f0--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----a98477476f0--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----a98477476f0--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----a98477476f0--------------------------------", "anchor_text": ""}, {"url": "https://1234567891.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://1234567891.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Cole"}, {"url": "https://1234567891.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "172 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F8d51c08849a5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fquickly-test-multiple-models-a98477476f0&user=Cole&userId=8d51c08849a5&source=post_page-8d51c08849a5--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Ffaca0e106c8a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fquickly-test-multiple-models-a98477476f0&newsletterV3=8d51c08849a5&newsletterV3Id=faca0e106c8a&user=Cole&userId=8d51c08849a5&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}