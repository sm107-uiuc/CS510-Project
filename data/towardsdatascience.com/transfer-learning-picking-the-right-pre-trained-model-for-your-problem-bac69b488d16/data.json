{"url": "https://towardsdatascience.com/transfer-learning-picking-the-right-pre-trained-model-for-your-problem-bac69b488d16", "time": 1682996082.519474, "path": "towardsdatascience.com/transfer-learning-picking-the-right-pre-trained-model-for-your-problem-bac69b488d16/", "webpage": {"metadata": {"title": "Transfer Learning : Why train when you can finetune? | by Judy T Raj | Towards Data Science", "h1": "Transfer Learning : Why train when you can finetune?", "description": "In this post, we\u2019ll take a brief look at what transfer learning is and how best to leverage the huge potential it offers. Lets start with the first questions first. Transfer learning is the art of\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.kaggle.com/mriganksingh/cat-images-dataset", "anchor_text": "this kaggle dataset", "paragraph_index": 16}, {"url": "https://www.kaggle.com/kvinicki/canine-coccidiosis", "anchor_text": "dataset from kaggle", "paragraph_index": 21}, {"url": "https://www.kaggle.com/alxmamaev/flowers-recognition", "anchor_text": "flowers dataset", "paragraph_index": 29}], "all_paragraphs": ["In this post, we\u2019ll take a brief look at what transfer learning is and how best to leverage the huge potential it offers. Lets start with the first questions first.", "Transfer learning is the art of using pre-trained models to solve deep learning problems. A pre-trained model is nothing but a deep learning model someone else built and trained on some data to solve some problem.", "Transfer Learning is a machine learning technique where you use a pre-trained neural network to solve a problem that is similar to the problem the network was originally trained to solve. For example, you could re-purpose a deep learning model built to identify dog breeds to classify dogs and cats, instead of building your own. This could save you the pain of finding an effective neural network architecture, the time you spend on training, the trouble of building a large corpus of training data and guarantee good results. You could spend ages coming up with a fifty layered CNN for perfectly differentiating your cats from your dogs or you could simply re-purpose one of the many pre-trained image classification models available online.Now, Let us look at what exactly this re-purposing involve.", "There are mainly three different ways in which a pre-trained model can be re-purposed. They are,", "Feature extraction : All we need to do here is to change the output layer to give the probabilities of cat and dog(or the number of classes your model is trying to classify stuff into), and not the thousands of classes it was initially trained to classify items into. This is ideally used when the data we are trying to train the model on, is very similar to the data the pre-trained model was originally trained on and the size of our dataset is small. This mechanism is called a fixed feature extraction. We re-train only the new output layer we added and retain the weights of every other layer.", "Copy the architecture of the pre-trained network : Here, we define a model with the same architecture as pre-trained model which has shown excellent results in performing tasks similar to the one we\u2019re trying to achieve and train it from scratch. We discard the weights of every layer from the pre-trained model and re-train the entire model on our data. We follow this approach when we have a large corpus of data to train on but it isn\u2019t very similar to the data the pre-trained model was trained on.", "Freeze some layers and train the others: We can choose to freeze the initial k layers of a pre-trained model and train just the top most n-k layers. We keep the weights on the initial same as and constant as that of the pre-trained model and retrain the higher layers on our data. This approach is adopted when our dataset is small and the data similarity is also low. The lower layers focus on the most basic information that can be extracted from the data and hence this could be used as it is on another problem, as often the basic level information would be the same. For instance, the same curves and edges that make up the picture of a dog can make up a microscopic cancer cell.", "Another common situation is where the data similarity is high and the dataset is also large. In this case, we retain the architecture of the model and the initial weights of the model. We then, retrain the whole model to update the weights of the pre-trained model to better suit our specific problem. This is the ideal situation to use transfer learning.", "Figure below show what approach to follow as the size of the dataset and the data similarity varies.", "PyTorch is simply put, the lovechild of Numpy and Keras. Even if you\u2019re unfamiliar with PyTorch, you shouldn\u2019t have trouble understanding the code below.", "There are eight different pre-trained models available in PyTorch under the torchvision.models module. They are :", "These are all convolutional neural networks built for image classification, trained on the ImageNet dataset. ImageNet is an image database organised according to the WordNet hierarchy with 14,197,122 images belonging to 21841 classes.", "Since all the pre-trained models in PyTorch are trained on the same dataset for the same task, it doesn\u2019t make difference which one we choose. Lets pick the ResNet network and see how to use it in the different scenarios we discussed earlier.", "The ResNet or Deep Residual Learning for Image Recognition has five versions available on pytorch, resnet-18, resnet-34, resnet-50, resnet-101 and resnet-152.", "Here is what the model we just downloaded look like.", "Now, lets see try and see how to train this model for four different problems.", "Consider this kaggle dataset. This contains the images of cats and other images which are non-cat. It has 209 training and 50 testing images of pixel 64*64*3. This is obviously a very small dataset to build a reliable image classification model on but we know ResNet was trained on a large number of animal and cat images, so we can just use the ResNet as a fixed features extractor to solve our cat vs non-cat problem.", "We need to freeze all the network except the final layer. We need to set requires_grad = False to freeze the parameters so that the gradients are not computed in backward(). Parameters of newly constructed modules have requires_grad=True by default.", "Since we only need the final layer to give two probabilities, that of the image being a cat\u2019s or not, lets re-define the number of output features in the last layer.", "Here\u2019s the new architecture of our model.", "All we gotta do now is train the last layer of the model and we\u2019ll be able to use our re-purposed vgg16 to predict if an image is a cat or not, with very less data and training time.", "Consider this dataset from kaggle, Images of Canine Coccidiosis Parasite. This dataset contains images and labels of Isospora canis and Isospora sp. oocysts, a coccidian parasites that infect intestinal tract in dogs. It was created at the Faculty of Veterinary Medicine in Zagreb. It contains a total of 341 images of the two types of parasite.", "This dataset is small and not one of the categories in Imagenet, on which the VGG16 was trained on. This is the kind of situation where we retain the pre-trained model\u2019s architecture, freeze the lower layers and retain their weights and train the lower layers to update their weights to suit our problem.", "The ResNet18 has a total of 10 layers. Lets freeze the first 6 layers.", "Now that we\u2019ve frozen the first 6 layers, let\u2019s redefine the final output layer to give only 2 outputs and not a 1000.", "Training this model will now, update the weights of the last 4 layers to correctly distinguish between the Isospora canis and Isospora sp. oocysts parasites.", "Consider this dataset from kaggle, Skin Cancer MNIST: HAM10000a large collection of multi-source dermatoscopic images of pigmented lesions which has over 10015 dermatoscopic images belonging to 7 different categories, namely Actinic keratoses and intraepithelial carcinoma / Bowen\u2019s disease (akiec), basal cell carcinoma (bcc), benign keratosis-like lesions (bkl), dermatofibroma (df), melanoma (mel), melanocytic nevi (nv) and vascular lesions (vasc). This is not the kind of data we can find in Imagenet.", "This is where we retain just the model architecture and none of the weights from the pre-trained model. Lets redefine the output layer to classify items into 7 categories.", "This model will take hours to train on a machine without a GPU but you\u2019ll still get good results if you run it for enough epochs, without the pain of defining you own model architecture.", "Consider the flowers dataset from kaggle. It contains 4242 images of flowers collected across data flicr, google images, yandex images etc. The pictures are divided into five classes: chamomile, tulip, rose, sunflower, dandelion. For each class there are about 800 photos. Images of flora and fauna are a large part of the ImageNet.", "This is the ideal situation to apply transfer learning. We retain the pre-trained model\u2019s architecture and the weights of each layer and train the model to update the weights to match our specific problem.", "We copy the weights from the pre-trained model and initialise our model. We use our training and test phases to update these weights.", "This model too will take hours to train but will give excellent results, even with just one epoch of training.", "You can perform transfer learning using any other pre-trained network in any other platform, following the same principles. Resnet and pytorch were picked at random for this article. Any other CNN would give similar results. Hope this saves you hours of agony in solving real world problems using computer vision.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Google-certified Tensorflow Developer | Google Cloud Architect | Author | Software Engineer"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fbac69b488d16&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftransfer-learning-picking-the-right-pre-trained-model-for-your-problem-bac69b488d16&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftransfer-learning-picking-the-right-pre-trained-model-for-your-problem-bac69b488d16&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftransfer-learning-picking-the-right-pre-trained-model-for-your-problem-bac69b488d16&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftransfer-learning-picking-the-right-pre-trained-model-for-your-problem-bac69b488d16&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----bac69b488d16--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----bac69b488d16--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@judytraj007?source=post_page-----bac69b488d16--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@judytraj007?source=post_page-----bac69b488d16--------------------------------", "anchor_text": "Judy T Raj"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fd77a7caab485&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftransfer-learning-picking-the-right-pre-trained-model-for-your-problem-bac69b488d16&user=Judy+T+Raj&userId=d77a7caab485&source=post_page-d77a7caab485----bac69b488d16---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fbac69b488d16&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftransfer-learning-picking-the-right-pre-trained-model-for-your-problem-bac69b488d16&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fbac69b488d16&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftransfer-learning-picking-the-right-pre-trained-model-for-your-problem-bac69b488d16&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://www.kaggle.com/mriganksingh/cat-images-dataset", "anchor_text": "this kaggle dataset"}, {"url": "https://www.kaggle.com/kvinicki/canine-coccidiosis", "anchor_text": "dataset from kaggle"}, {"url": "https://www.kaggle.com/alxmamaev/flowers-recognition", "anchor_text": "flowers dataset"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----bac69b488d16---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----bac69b488d16---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/neural-networks?source=post_page-----bac69b488d16---------------neural_networks-----------------", "anchor_text": "Neural Networks"}, {"url": "https://medium.com/tag/transfer-learning?source=post_page-----bac69b488d16---------------transfer_learning-----------------", "anchor_text": "Transfer Learning"}, {"url": "https://medium.com/tag/pytorch?source=post_page-----bac69b488d16---------------pytorch-----------------", "anchor_text": "Pytorch"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fbac69b488d16&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftransfer-learning-picking-the-right-pre-trained-model-for-your-problem-bac69b488d16&user=Judy+T+Raj&userId=d77a7caab485&source=-----bac69b488d16---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fbac69b488d16&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftransfer-learning-picking-the-right-pre-trained-model-for-your-problem-bac69b488d16&user=Judy+T+Raj&userId=d77a7caab485&source=-----bac69b488d16---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fbac69b488d16&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftransfer-learning-picking-the-right-pre-trained-model-for-your-problem-bac69b488d16&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----bac69b488d16--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fbac69b488d16&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftransfer-learning-picking-the-right-pre-trained-model-for-your-problem-bac69b488d16&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----bac69b488d16---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----bac69b488d16--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----bac69b488d16--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----bac69b488d16--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----bac69b488d16--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----bac69b488d16--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----bac69b488d16--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----bac69b488d16--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----bac69b488d16--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@judytraj007?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@judytraj007?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Judy T Raj"}, {"url": "https://medium.com/@judytraj007/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "297 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fd77a7caab485&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftransfer-learning-picking-the-right-pre-trained-model-for-your-problem-bac69b488d16&user=Judy+T+Raj&userId=d77a7caab485&source=post_page-d77a7caab485--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fd4d7b190cd1d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftransfer-learning-picking-the-right-pre-trained-model-for-your-problem-bac69b488d16&newsletterV3=d77a7caab485&newsletterV3Id=d4d7b190cd1d&user=Judy+T+Raj&userId=d77a7caab485&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}