{"url": "https://towardsdatascience.com/how-to-train-your-model-and-not-to-lose-a-sense-of-reality-252351b89824", "time": 1683005267.0375118, "path": "towardsdatascience.com/how-to-train-your-model-and-not-to-lose-a-sense-of-reality-252351b89824/", "webpage": {"metadata": {"title": "How to Train Regression and not to Lose a Sense of Reality | by Andrij Vasylenko | Towards Data Science", "h1": "How to Train Regression and not to Lose a Sense of Reality", "description": "In the era of all-encompassing AI, it is easy to fall for the idea that machine learning (ML) can solve ultimately any problem, given we have enough data. Here, on the example of a large labeled\u2026"}, "outgoing_paragraph_urls": [{"url": "https://icsd.products.fiz-karlsruhe.de/", "anchor_text": "Inorganic crystal structures database", "paragraph_index": 24}, {"url": "https://link.springer.com/chapter/10.1007/978-981-10-7617-6_1", "anchor_text": "Descriptors for Machine Learning of Materials Data", "paragraph_index": 24}, {"url": "https://dataaspirant.com/2017/05/22/random-forest-algorithm-machine-learing/", "anchor_text": "How the random forest works in machine learning", "paragraph_index": 24}, {"url": "http://Gorixi.com", "anchor_text": "Gorixi.com", "paragraph_index": 26}], "all_paragraphs": ["In the era of all-encompassing AI, it is easy to fall for the idea that machine learning (ML) can solve ultimately any problem, given we have enough data. Here, on the example of a large labeled dataset, we discover when a large amount of data is not enough, how straightforward application of ML without domain expertise can be misleading, and what tools we have to avoid delusion.", "Outline- Data Science in Materials Science- Featurisation- Regression with neural network- Categorical classification- Can Random Forest perform better?- Confusion matrix- Data augmentation & analysis", "A problem we want to address lies within combinatorics, probability and materials science. To progress technologically we need to discover new more efficient materials: magnets, piezoelectrics, transparent conducting oxides you have just touched on your screen to scroll down, or a plethora of others. Most of the modern materials are multicomponent, consisting of 3 or more atomic elements. With an increasing number of elements in a set, combinatorial search quickly becomes intractable. To test a researcher\u2019s morale further, not all sets of atoms are going to produce stable compositions, let alone the functional ones.", "Over the decades of research and experimentation, we have collected a database of more than 200'000 materials [1], among which a few thousand are made of different sets of atoms \u2014 and this will constitute our training dataset. Our goal is to predict whether a new set of atoms is likely to be rich in new stable materials.", "To encode as much information about a set of elements as possible one can use elemental descriptors: atomic numbers, masses, numbers of valence electrons, etc to produce a multi-dimensional vector for a candidate set. We can choose 40 different atomic descriptors from e.g. Ref. 2, constituting 160 features for a candidate set of 4 elements.", "Highly correlated features increase complexity, while not providing additional description. A good practice is to ensure descriptors are orthogonal and scaled.", "A target from an experimental database is a number of experimentally validated stable materials that consist of a particular set of elements \u2014 for some sets it is as small as 1, for others \u2014 as large as 162.", "We will try to train a deep neural network (NN) to recognize a functional form for 160 features for a set of elements resulting in a number [of stable compositions for a set]. We start by experimenting with NN architecture \u2014 adding nodes to layers and stacking the layers up. Our metric is a regression loss function. We can experiment with the form of it too, but a stable solution with mean square error (mse) should suffice to see the loss is large, and what is worse, it does not decrease as training progresses.", "One has to be careful, while choosing a validation set. Large NN with multiple epochs and adapting learning rate can reduce the loss during the training \u2014 which might be, in fact, only a sign of overfitting if a validation loss remains large.", "Changing adaptive momenta optimizer (Adam) to a stochastic gradient descent with Nesterov momenta updates as the last resort, persuades us to return back to where we should have started \u2014 analysis of available data for training.", "Our data is heavily imbalanced: more than 50% of atomic sets of 4 have only 1 stable composition. To improve the balance we can split the data into labelled groups by increasing numbers of stable compositions.", "Regression is reliant on data balance. If data pruning or augmentation is not possible, splitting data into categories might enable classification.", "Hence, we change the loss function to a categorical cross-entropy, add \u2018softmax\u2019 activation to the output layer and retrain NN for classification. This decreases validation loss function after a few interactions, but a model is still underfitted: it casts all atomic sets into the first group as most probable.", "We can simplify the task further and split data into halves: one and more than one stable compositions \u2014 now the two groups are balanced, targets are 0 for the first group (one stable composition) and 1 for the second (more than one stable composition). Loss function: Binary cross-entropy. Retraining. Underfitting. Equal probability for all: 55% vs 45%.", "It is a popular question. An honest answer is, it depends. Random forest (RF) classifier with a large ensemble of decision trees is known to prevent overfitting and to be apt for feature engineering, e.g. to handle missing values. Moreover, RF can be applied also for multiple-choice categorization and regression, which makes the model versatile in a variety of applications [3].", "With the default hyperparameters, evaluation of the model in cross validation demonstrates 70% accuracy. Prediction for a hold-out set of 1000 entries of labelled data (which was not exposed to a model during the training) results in the following confusion matrix,", "Quantitative metrics, e.g. accuracy or precision may be misinforming when considered in isolation from other metrics as they are not always the best metrics for your model.", "In our model, precision is high because of zero false negatives. However, we are interested in predicting as many true positives as possible, as these are the sets of atoms yielding multiple stable compositions. But recall of the model is too small.So an answer to the question of a section is", "RF can outperform NN in particular problem settings. With a simple implementation in scikit-learn as a black-box model, RF could be a first choice of classifier to establish a basic line.", "There are many techniques for data augmentation that could beat underfitting by enhancing machine learning and facilitating optimization. Some of the techniques, e.g. image reflection, could also help to evaluate a model as you would expect identical predictions for reflected images.", "Data augmentation can help to overcome underfitting by improving optimization. Some augmentation methods, e.g. image reflection, also help evaluation.", "In our problem, we can augment the data manifold via permutation of the atomic sets, as the order in which you pick atoms to form a new material should not affect the outcome. Looking at the true positives with permutation invariance, we find their number is even smaller, finally discarding the model.", "In conclusion, an ambitious goal of ML predicting rich material phases just by looking at the constituent atomic sets could not be achieved on the assumptions described above. A weak link here is not the amount of data we have, but the fact the data is not full: our labels (the reported cases) can very well be wrong as we don\u2019t really know how many stable compositions for a given atomic set is actually allowed by nature. It is not surprising, after all, that the majority of atomic sets are reported only once as experimenters tend to race for discoveries of new phase fields.", "Among the scientific traditions, there is one literally the most positive, which is not to report failures. This has a biasing effect on data (no negatives) and is detrimental to the pace of progress as inevitably we follow erroneous routes, which might have been discovered multiple times, but kept private. The list of the common pitfalls and the problem setting described above, I hope, will serve to alleviate the effects of the positive tradition in a data-oriented era.", "[1] Inorganic crystal structures database[2] A Seko, A Togo, I Tanaka, Descriptors for Machine Learning of Materials Data , Nanoinformatics. Springer, Singapore.[3] Saimadhu Polamuri, How the random forest works in machine learning.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Researcher at University of Liverpool and CEO @ Gorixi.com"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F252351b89824&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-train-your-model-and-not-to-lose-a-sense-of-reality-252351b89824&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-train-your-model-and-not-to-lose-a-sense-of-reality-252351b89824&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-train-your-model-and-not-to-lose-a-sense-of-reality-252351b89824&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-train-your-model-and-not-to-lose-a-sense-of-reality-252351b89824&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----252351b89824--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----252351b89824--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@a.vasylenko_8790?source=post_page-----252351b89824--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@a.vasylenko_8790?source=post_page-----252351b89824--------------------------------", "anchor_text": "Andrij Vasylenko"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fd2da87cec71e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-train-your-model-and-not-to-lose-a-sense-of-reality-252351b89824&user=Andrij+Vasylenko&userId=d2da87cec71e&source=post_page-d2da87cec71e----252351b89824---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F252351b89824&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-train-your-model-and-not-to-lose-a-sense-of-reality-252351b89824&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F252351b89824&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-train-your-model-and-not-to-lose-a-sense-of-reality-252351b89824&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://pixabay.com/users/jameshose-3868711/", "anchor_text": "JamesHomes"}, {"url": "https://pixabay.com/photos/windmills-don-quixote-windmill-hill-1924129/", "anchor_text": "Pixabay"}, {"url": "https://icsd.products.fiz-karlsruhe.de/", "anchor_text": "Inorganic crystal structures database"}, {"url": "https://link.springer.com/chapter/10.1007/978-981-10-7617-6_1", "anchor_text": "Descriptors for Machine Learning of Materials Data"}, {"url": "https://dataaspirant.com/2017/05/22/random-forest-algorithm-machine-learing/", "anchor_text": "How the random forest works in machine learning"}, {"url": "https://medium.com/tag/regression?source=post_page-----252351b89824---------------regression-----------------", "anchor_text": "Regression"}, {"url": "https://medium.com/tag/classification?source=post_page-----252351b89824---------------classification-----------------", "anchor_text": "Classification"}, {"url": "https://medium.com/tag/random-forest?source=post_page-----252351b89824---------------random_forest-----------------", "anchor_text": "Random Forest"}, {"url": "https://medium.com/tag/feature-selection?source=post_page-----252351b89824---------------feature_selection-----------------", "anchor_text": "Feature Selection"}, {"url": "https://medium.com/tag/data-augmentation?source=post_page-----252351b89824---------------data_augmentation-----------------", "anchor_text": "Data Augmentation"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F252351b89824&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-train-your-model-and-not-to-lose-a-sense-of-reality-252351b89824&user=Andrij+Vasylenko&userId=d2da87cec71e&source=-----252351b89824---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F252351b89824&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-train-your-model-and-not-to-lose-a-sense-of-reality-252351b89824&user=Andrij+Vasylenko&userId=d2da87cec71e&source=-----252351b89824---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F252351b89824&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-train-your-model-and-not-to-lose-a-sense-of-reality-252351b89824&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----252351b89824--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F252351b89824&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-train-your-model-and-not-to-lose-a-sense-of-reality-252351b89824&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----252351b89824---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----252351b89824--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----252351b89824--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----252351b89824--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----252351b89824--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----252351b89824--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----252351b89824--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----252351b89824--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----252351b89824--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@a.vasylenko_8790?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@a.vasylenko_8790?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Andrij Vasylenko"}, {"url": "https://medium.com/@a.vasylenko_8790/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "3 Followers"}, {"url": "http://Gorixi.com", "anchor_text": "Gorixi.com"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fd2da87cec71e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-train-your-model-and-not-to-lose-a-sense-of-reality-252351b89824&user=Andrij+Vasylenko&userId=d2da87cec71e&source=post_page-d2da87cec71e--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fusers%2Fd2da87cec71e%2Flazily-enable-writer-subscription&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-train-your-model-and-not-to-lose-a-sense-of-reality-252351b89824&user=Andrij+Vasylenko&userId=d2da87cec71e&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}