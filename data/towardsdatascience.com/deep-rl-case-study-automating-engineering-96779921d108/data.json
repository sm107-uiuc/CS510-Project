{"url": "https://towardsdatascience.com/deep-rl-case-study-automating-engineering-96779921d108", "time": 1683003365.774581, "path": "towardsdatascience.com/deep-rl-case-study-automating-engineering-96779921d108/", "webpage": {"metadata": {"title": "Deep RL Case Study: Automating Engineering | by Nathan Lambert | Towards Data Science", "h1": "Deep RL Case Study: Automating Engineering", "description": "Can artificial intelligence and computer systems take over other fields of engineering? Why is parameter tuning so hard for human brains?"}, "outgoing_paragraph_urls": [{"url": "https://ray.readthedocs.io/en/latest/tune.html", "anchor_text": "Tune (for Ray)", "paragraph_index": 1}, {"url": "https://en.wikipedia.org/wiki/Genetic_algorithm", "anchor_text": "genetic algorithms", "paragraph_index": 6}, {"url": "https://en.wikipedia.org/wiki/Cross-entropy_method", "anchor_text": "cross entropy method", "paragraph_index": 6}, {"url": "https://www.automl.org/", "anchor_text": "research group from Freiburg", "paragraph_index": 12}, {"url": "https://www.linkedin.com/in/kourosh-hakhamaneshi-4816a58a/", "anchor_text": "Kourosh Hakhamaneshi", "paragraph_index": 15}, {"url": "https://www2.eecs.berkeley.edu/Pubs/TechRpts/2019/EECS-2019-25.pdf", "anchor_text": "BagNet", "paragraph_index": 19}, {"url": "http://papers.nips.cc/paper/6933-process-constrained-batch-bayesian-optimisation.pdf", "anchor_text": "Batch Bayesian Optimization", "paragraph_index": 23}, {"url": "http://robotic.substack.com", "anchor_text": "robotic.substack.com", "paragraph_index": 27}, {"url": "http://natolambert.com", "anchor_text": "natolambert.com", "paragraph_index": 27}], "all_paragraphs": ["Parameter tuning is a constant across different fields of engineering. Computer scientists tweak values of their models, electrical engineers change widths of their transistors, and chemical engineers check the efficiency of their processes. The constant aspect of these different roles: Humans are unreliable at high-dimensional, non convex optimization problems. In all these cases, our brain is the optimization function \u2014 what other optimizers can design engineers use, and why should they? The recently discovered difference among these engineering roles: only computing problems are structured and normalized enough for learning to have dramatically changed them.", "AutoML, or automatic machine learning, is catching on. I was testing a pre-release version for PyTorch when I was at Facebook, and colleagues at Berkeley just released their own open source package Tune (for Ray).", "What does AutoML do? In short, it\u2026", "Now, we can learn what that means.", "Every design problem has a set of variables to tune, and the number of variables determines the type of optimizer to use. Automating design is limited in adoption because of the difficulty of restricting the variables accessible to the optimizer. Engineers work with layers of knowledge to understand how systems work. They use this knowledge to tune many aspects and converge to a solution \u2014 often working in unconstrained environments. Modern machine learning works extremely well in structured problems, so a large part of enabling AutoML in real problems is effectively data science. A designer must distill the most significant aspects of a system into a subset of variables (principal component analysis anyone?) that are normalized and ready for a computer to fit it and iterate.", "These principles can only be applied once the tooling is setup \u2014 ie, the learning algorithm can directly change the variable of interest and run a new simulation. Automating design is only as impactful as its ability to change and test new parameters. The barrier of tooling is why the solutions to these problems become extremely niche \u2014 it takes a PhD level of understanding at parameter optimization and in a design tool to deploy them in hardware.", "Bayesian optimization is the most frequent tool used in AutoML optimizers (one can use any non-gradient dependent optimizer: alternates include genetic algorithms or the cross entropy method).", "The model of the objective is what captures the behavior of the system one is designing. This is the crucial step, which enables computers a much more structured form of choice. Computers can model complex, nonlinear functions with smooth Gaussian Processes, deep neural networks, or combinations of probability distributions.", "These different model options trade off between expressivity, interpretability, and sample efficiency. Gaussian Processes (non-parametric gaussian distributions ultimately) are a great choice because they rule supreme in sample efficiency, while carrying an interpretable notion of uncertainty.", "This is where computers gain the most over humans.", "Humans are great at comparing one design to another (perhaps uncannily strong intuition), but we lack any real ability to propose the optimal, or near-optimal, next set of parameters given a dataset. Using structured-learning-models gives the algorithm an explicit way to decide the next parameter set.", "In Bayesian Optimization, the tool for delivering the next group of parameters is called the acquisition function. The acquisition function is another design option for the humans to choose between. Other approaches (CMA, CEM, etc) can model their predictions as a distribution to sample from, and taking the mean of such a distribution is the current optimal estimate. Different choices of acquisition functions balance between parameter exploration, model exploitation, and prior knowledge. The key is that the optimizer removes the ambiguity of choice that plagues human tuning.", "If you are looking to find an AutoML tool for your project \u2014 check out this research group from Freiburg.", "What do we think is better for optimizing a set of parameters \u2014 humans tuning a dozen variables in a pseudo random search, or humans choosing a few algorithmic pieces? Let\u2019s see what choosing optimizers and models that fit the specific design problem at hand has shown possible in research.", "I outline the two most recent examples of automated engineering I have been impressed with in the last year. (I am trying to take inspiration from these to optimize robot design in my own research, which hopefully leads to version two of this blog post.)", "Here Kourosh Hakhamaneshi et. al apply an evolutionary algorithm (optimized choice) and a deep neural network discriminator (objective function model) to a high-dimensional circuit design problem (design space).", "Circuit design involves many aspects, but at a high level designing one component of an system-on-chip comes down to four steps: 1) changing the schematic (components used, e.g. transistors, resistors), 2) simulating the schematic until it is accurate, 3) laying out the schematic so that it can be created at a circuit foundry (TSMC, Intel), 4) simulating the layout of the circuit. The most time consuming aspect is the last step, where simulations can take multiple days. Schematic \u2014 simulation \u2014 layout \u2014 simulation, is a very wide loop, where iterating naively produces no functional result.", "It is only one small piece of the puzzle if an algorithm learns where to put transistors with resistors if it cannot reduce the time needed to simulate (and validate) how the circuit will be made. There is one core technical aspect that enables this paper to achieve functional results (where other projects have failed in the past): using a deep learning discriminator to judge which new designs should be evaluated in post-layout simulation.", "The complexity of circuit design is why the authors set up the problem in this way. They needed to use an evolutionary algorithm because it can propose many more samples rapidly, and get an initial indication as to if the parameters should work (given the historic population data), and then the discriminator acts as a filter to dramatically reduce computational burden.", "The main strength of this approach is its ability to work within the wide variety of constraints in analog circuit design. The authors of this paper represent the peak of knowledge in offline optimization and circuit design \u2014 the rare combination needed to implement novel optimization on specialized problems, so hopefully BagNet succeeds.", "Here Thomas Liao et. al apply bayesian optimization (optimized choice) and a gaussian process (objective function model) to a microelectromechanical systems optimization (design space).", "In any hardware design problem the evaluation of the design is often delayed by weeks of manufacturing time. This is particularly true in microelectromechanical systems (MEMs), where there are two stages for delay and variation: mask assembly (tool setup) and the nano-fabrication (actual construction). This approach increases throughput of design optimization by enabling parallel search of the parameter space. This paper uses an upgraded version of a Bayesian Optimization loop.", "The great insight is to modify Bayesian Optimization with a new acquisition function that returns a set of parameter vectors to try at the next evaluation. The model then can fit all of these trials at once, and propose another batch. This is coined Hierarchical Process Constrained Batch Bayesian Optimization (HPC-BBO). The model can fit any data from the problem, so evaluating in parallel is a substantial improvement in wall-clock time (at a potential slight dip in sample efficiency with a new acquisition function).", "The two key technical details here that make this work are 1) imagining the reward of the real process with the model (standard Bayesian Optimization requires evaluation the parameters on the real system before getting another sample), first proposed in Batch Bayesian Optimization and 2) contextual optimization of the proposed parameters in a batch with respect to a second constraint \u2014 needing the design to work with a specific controller, which becomes a joint learning problem.", "This learning protocol highlights the ability for AutoML to work in structure problems that used to be exclusively left to human designers. Structure and parallelization lends it to be highly effective when looping in real hardware.", "There are many ways for such approaches to be flat out untenable \u2014 too many design variables, impossible to access data outside proprietary design tools used by a specific institution, lack of education of an older generation of engineers. That said, the effort returned by a few, young experts in their domain could yield dramatic reward.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Trying to think freely and create equitable & impactful automation @ UCBerkeley EECS. Subscribe directly at robotic.substack.com. More at natolambert.com"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F96779921d108&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-rl-case-study-automating-engineering-96779921d108&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-rl-case-study-automating-engineering-96779921d108&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-rl-case-study-automating-engineering-96779921d108&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-rl-case-study-automating-engineering-96779921d108&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----96779921d108--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----96779921d108--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://natolambert.medium.com/?source=post_page-----96779921d108--------------------------------", "anchor_text": ""}, {"url": "https://natolambert.medium.com/?source=post_page-----96779921d108--------------------------------", "anchor_text": "Nathan Lambert"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F890b1765e6d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-rl-case-study-automating-engineering-96779921d108&user=Nathan+Lambert&userId=890b1765e6d&source=post_page-890b1765e6d----96779921d108---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F96779921d108&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-rl-case-study-automating-engineering-96779921d108&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F96779921d108&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-rl-case-study-automating-engineering-96779921d108&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://ray.readthedocs.io/en/latest/tune.html", "anchor_text": "Tune (for Ray)"}, {"url": "https://medium.com/riselab/cutting-edge-hyperparameter-tuning-with-ray-tune-be6c0447afdf", "anchor_text": "Cutting edge hyperparameter tuning with Ray TuneIntroducing Ray Tune, the state-of-the-art hyperparameter tuning library for researchers and developers to use at any\u2026medium.com"}, {"url": "https://en.wikipedia.org/wiki/Genetic_algorithm", "anchor_text": "genetic algorithms"}, {"url": "https://en.wikipedia.org/wiki/Cross-entropy_method", "anchor_text": "cross entropy method"}, {"url": "https://www.cs.ox.ac.uk/people/nando.defreitas/publications/BayesOptLoop.pdf", "anchor_text": "Taking the Human Out of the Loop\u2026"}, {"url": "https://dash.harvard.edu/handle/1/27769882", "anchor_text": "Taking the Human Out of the Loop: A Review of Bayesian OptimizationEdit descriptiondash.harvard.edu"}, {"url": "https://www.automl.org/", "anchor_text": "research group from Freiburg"}, {"url": "https://www.linkedin.com/in/kourosh-hakhamaneshi-4816a58a/", "anchor_text": "Kourosh Hakhamaneshi"}, {"url": "https://bair.berkeley.edu/blog/2019/09/26/circuits/", "anchor_text": "BAIR Blog post on BagNet"}, {"url": "https://www2.eecs.berkeley.edu/Pubs/TechRpts/2019/EECS-2019-25.pdf", "anchor_text": "BagNet"}, {"url": "https://bair.berkeley.edu/blog/2019/09/26/circuits/", "anchor_text": "Sample Efficient Evolutionary Algorithm for Analog Circuit DesignIn this post, we share some recent promising results regarding the applications of Deep Learning in analog IC design\u2026bair.berkeley.edu"}, {"url": "https://arxiv.org/pdf/1905.01334.pdf", "anchor_text": "Morphology Learning in MEMs Paper"}, {"url": "http://papers.nips.cc/paper/6933-process-constrained-batch-bayesian-optimisation.pdf", "anchor_text": "Batch Bayesian Optimization"}, {"url": "https://arxiv.org/abs/1905.01334", "anchor_text": "Data-efficient Learning of Morphology and Controller for a MicrorobotRobot design is often a slow and difficult process requiring the iterative construction and testing of prototypes, with\u2026arxiv.org"}, {"url": "https://ieeexplore.ieee.org/abstract/document/7994197", "anchor_text": "academic"}, {"url": "https://ieeexplore.ieee.org/abstract/document/8373697", "anchor_text": "papers"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----96779921d108---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----96779921d108---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----96779921d108---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/research?source=post_page-----96779921d108---------------research-----------------", "anchor_text": "Research"}, {"url": "https://medium.com/tag/engineering?source=post_page-----96779921d108---------------engineering-----------------", "anchor_text": "Engineering"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F96779921d108&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-rl-case-study-automating-engineering-96779921d108&user=Nathan+Lambert&userId=890b1765e6d&source=-----96779921d108---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F96779921d108&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-rl-case-study-automating-engineering-96779921d108&user=Nathan+Lambert&userId=890b1765e6d&source=-----96779921d108---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F96779921d108&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-rl-case-study-automating-engineering-96779921d108&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----96779921d108--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F96779921d108&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-rl-case-study-automating-engineering-96779921d108&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----96779921d108---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----96779921d108--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----96779921d108--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----96779921d108--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----96779921d108--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----96779921d108--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----96779921d108--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----96779921d108--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----96779921d108--------------------------------", "anchor_text": ""}, {"url": "https://natolambert.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://natolambert.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Nathan Lambert"}, {"url": "https://natolambert.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "653 Followers"}, {"url": "http://robotic.substack.com", "anchor_text": "robotic.substack.com"}, {"url": "http://natolambert.com", "anchor_text": "natolambert.com"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F890b1765e6d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-rl-case-study-automating-engineering-96779921d108&user=Nathan+Lambert&userId=890b1765e6d&source=post_page-890b1765e6d--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F15278b7ad062&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-rl-case-study-automating-engineering-96779921d108&newsletterV3=890b1765e6d&newsletterV3Id=15278b7ad062&user=Nathan+Lambert&userId=890b1765e6d&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}