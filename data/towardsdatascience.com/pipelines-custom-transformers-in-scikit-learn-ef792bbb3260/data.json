{"url": "https://towardsdatascience.com/pipelines-custom-transformers-in-scikit-learn-ef792bbb3260", "time": 1683016114.298937, "path": "towardsdatascience.com/pipelines-custom-transformers-in-scikit-learn-ef792bbb3260/", "webpage": {"metadata": {"title": "Pipelines & Custom Transformers in Scikit-learn | by Santiago Velez Garcia | Towards Data Science", "h1": "Pipelines & Custom Transformers in Scikit-learn", "description": "Machine Learning academic curriculums tend to focus almost exclusively on the models. One may argue that the model is what performs the magic. The statement may hold some truth, but this magic only\u2026"}, "outgoing_paragraph_urls": [{"url": "https://scikit-learn.org/stable/modules/preprocessing.html#standardization-or-mean-removal-and-variance-scaling", "anchor_text": "Standardization, or mean removal and variance scaling", "paragraph_index": 9}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.impute.SimpleImputer.html", "anchor_text": "SimpleImputer", "paragraph_index": 9}, {"url": "https://scikit-learn.org/stable/modules/preprocessing.html#encoding-categorical-features", "anchor_text": "Encoding categorical features", "paragraph_index": 9}, {"url": "https://www.kaggle.com/c/titanic/data", "anchor_text": "Titanic Dataset", "paragraph_index": 13}, {"url": "https://www.kaggle.com/alexisbcook/titanic-tutorial", "anchor_text": "here", "paragraph_index": 13}], "all_paragraphs": ["Machine Learning academic curriculums tend to focus almost exclusively on the models. One may argue that the model is what performs the magic. The statement may hold some truth, but this magic only works if the data is in the right form. Besides, to make things more complicated, the \u2018right form\u2019 depends on the type of model.", "Getting the data in the right form is what the industry calls preprocessing. It takes a large chunk of the machine learning practitioner time. For the engineer, preprocessing and fitting or preprocessing and predicting are two distinct processes, but in a production environment, when we serve the model, no distinction is made. It is only data in, prediction out. Pipelines are here to do that. They integrate the preprocessing steps and the fitting or predicting into a single operation. Apartfrom helping to make the model production-ready, they add a great deal of reproducibility to the experimental phase.", "From the Scikit Learn documentation we have:", "Dataset transformation \u2026Like other estimators, these are represented by classes with a fit method, which learns model parameters (e.g. mean and standard deviation for normalization) from a training set, and a transform method which applies this transformation model to unseen data. fit_transform may be more convenient and efficient for modeling and transforming the training data simultaneously.", "We will focus on two of the transformer types, namely:", "Although Scikit learn comes loaded with a set of standard transformers, we will begin with a custom one to understand what they do and how they work. The first thing to remember is that a custom transformer is an estimator and a transformer, so we will create a class that inherits from both BaseEstimator and TransformerMixin. It is a good practice to initialize it with super().__init__(). By inheriting, we get a standard method such as get_params and set_params for free. In the init, we also want to create the model parameter or parameters we want to learn.", "The fit method is where \u201clearning\u201d takes place. Here we perform the operation based upon the training data that yields the model parameters.", "In the transform method, we apply the parameters learned in fit to unseen data. Bear in mind that the preprocessing is going to make part of the whole model, so during training, fit, and transform are apply to the same dataset. But later, when you use the trained model, you only apply the transform method with the parameter learned with fit based on the training dataset but on unseen data.", "It is key that the learned parameters, and hence the transformer operation, are the same regardless of the data to be applied to.", "Scikit learn comes with a variety of standard transformers out of the box. Given they almost unavoidable use, you should be familiar with Standardization, or mean removal and variance scaling and SimpleImputer for numerical data and with Encoding categorical features for categorical, specially one-of-K, also known as one-hot encoding.", "Remember that the transformers are an estimator but so is your model (logistic regression, random forest, etc.). Think of it as steps vertical stacking. Here order matters. So you want to put the preprocessing before the model. The key is that a step output is the next step input.", "Often you want to apply a different transformation to some of your features. The required transformations for numerical and categorical data are different. It is as if you have two parallel ways, or as if they were horizontally stacked.", "The input to the parallel ways is the same. So the transform method has to begin by choosing the features relevant to the transformation (for example, numerical features or categorical features).", "We will do the preprocessing pipeline for Kaggle\u2019s Titanic Dataset. You can find the Kaggles\u2019s tutorial here.", "For our work, you can follow the steps in the provided gists below (open it in a new tab ad follow along). It contains all the code. We will brake it apart for better understanding.", "Now let us begin. After unzipping the file and loading the data perform a quick exploration.", "Now after dropping the features we will not be using (PassengerId, Name, Ticket, Cabin, Embarked) and separating the labels (Survived), six (6) features remain, namely: Pclass, Sex, Age, SibSp, Parch and Fare.", "Notice that there are both numerical (Pclass\u2019, \u2018Age\u2019, \u2018SibSp\u2019, \u2018Parch\u2019, \u2018Fare\u2019) and categorical (\u2018Sex\u2019) features which preprocessing will differ. Notice as well that not all passenger Age value are available.", "Age is presumably a key feature needed for predicting the surviving chances. Therefore for a model to adequately perform, we need to fill in the missing values. One alternative is to use the dataset age mean value. But there is a correlation between Sex, PClass, and Age. Men are older than women and, passengers in the upper class are as well older than passengers in the lower class. We can use that to come up with a better replacement value than just the general average. We will use the mean of the category given by the sex and Pclass. Notice we used two categorical features (Pclass and Sex) to group the points to fill in missing values for a numerical feature (Age).", "After selecting the appropriate features, we will perform a simple imputer and a StandardScaler. The previously presented CustomScaler performs the same operation as the prebuild Scikit-learn StandardScaler.", "After selecting the appropriate feature (Sex), we will perform hot encoding via the prebuilt tranform OneHotEncoder.", "The categorical and numerical pipelines run in parallel but independently. They have the same input but produce separate outputs that we will rejoin. To rejoin them, we use FeatureUnion.", "Since we need both categorical and numerical features for our Custom imputer (where we fill in the missing Age values) it comes before the parallel pipelines now together as preprocessing pipeline. For this, we use Scikit Learn\u2019s Pipeline.", "We will use Scikit Learn\u2019s DecisionTreeClassifier. Here the focus is not the model it is rather the excuse to see the transforms and pipeline in action. The DecisionTreeClassifier is once another estimator that we stack after our preprocessing pipeline.", "To see everything in action we will call fit on the full_pipeline, that is, preprocessing and model, and later predict.", "This very short recount of transforms and pipelines with Scikit learn should have given you the tools to integrate, in a production-ready and reproducible manner, the preprocessing phase in your machine learning models. Hope you enjoyed. Happy coding!", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fef792bbb3260&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpipelines-custom-transformers-in-scikit-learn-ef792bbb3260&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpipelines-custom-transformers-in-scikit-learn-ef792bbb3260&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpipelines-custom-transformers-in-scikit-learn-ef792bbb3260&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpipelines-custom-transformers-in-scikit-learn-ef792bbb3260&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----ef792bbb3260--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----ef792bbb3260--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://svelezg.medium.com/?source=post_page-----ef792bbb3260--------------------------------", "anchor_text": ""}, {"url": "https://svelezg.medium.com/?source=post_page-----ef792bbb3260--------------------------------", "anchor_text": "Santiago Velez Garcia"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fbc94670ae5ea&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpipelines-custom-transformers-in-scikit-learn-ef792bbb3260&user=Santiago+Velez+Garcia&userId=bc94670ae5ea&source=post_page-bc94670ae5ea----ef792bbb3260---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fef792bbb3260&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpipelines-custom-transformers-in-scikit-learn-ef792bbb3260&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fef792bbb3260&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpipelines-custom-transformers-in-scikit-learn-ef792bbb3260&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://www.freepik.com/free-vector/pipeline-brick-wall-background_3834959.htm", "anchor_text": "https://www.freepik.com/free-vector/pipeline-brick-wall-background_3834959.htm"}, {"url": "https://towardsdatascience.com/pipelines-custom-transformers-in-scikit-learn-the-step-by-step-guide-with-python-code-4a7d9b068156", "anchor_text": "Pipelines & Custom Transformers in Scikit-learn: The step-by-step guide (with Python code)"}, {"url": "https://towardsdatascience.com/custom-transformers-and-ml-data-pipelines-with-python-20ea2a7adb65", "anchor_text": "ML Data Pipelines with Custom Transformers in Python"}, {"url": "https://machinelearningmastery.com/how-to-transform-target-variables-for-regression-with-scikit-learn/", "anchor_text": "How to Transform Target Variables for Regression in Python"}, {"url": "http://zacstewart.com/2014/08/05/pipelines-of-featureunions-of-pipelines.html", "anchor_text": "Using Scikit-learn Pipelines and FeatureUnions"}, {"url": "https://scikit-learn.org/stable/data_transforms.html", "anchor_text": "Scikit Learn. Dataset transformations"}, {"url": "https://scikit-learn.org/stable/modules/preprocessing.html", "anchor_text": "Preprocessing data"}, {"url": "https://scikit-learn.org/stable/modules/impute.html", "anchor_text": "Imputation of missing values"}, {"url": "https://scikit-learn.org/stable/modules/preprocessing.html#standardization-or-mean-removal-and-variance-scaling", "anchor_text": "Standardization, or mean removal and variance scaling"}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.impute.SimpleImputer.html", "anchor_text": "SimpleImputer"}, {"url": "https://scikit-learn.org/stable/modules/preprocessing.html#encoding-categorical-features", "anchor_text": "Encoding categorical features"}, {"url": "https://www.kaggle.com/c/titanic/data", "anchor_text": "Titanic Dataset"}, {"url": "https://www.kaggle.com/alexisbcook/titanic-tutorial", "anchor_text": "here"}, {"url": "https://commons.wikimedia.org/wiki/RMS_Titanic#/media/File:Titanic_in_color.png", "anchor_text": "https://commons.wikimedia.org/wiki/RMS_Titanic#/media/File:Titanic_in_color.png"}, {"url": "https://medium.com/tag/data-preprocessing?source=post_page-----ef792bbb3260---------------data_preprocessing-----------------", "anchor_text": "Data Preprocessing"}, {"url": "https://medium.com/tag/scikit-learn?source=post_page-----ef792bbb3260---------------scikit_learn-----------------", "anchor_text": "Scikit Learn"}, {"url": "https://medium.com/tag/transformers?source=post_page-----ef792bbb3260---------------transformers-----------------", "anchor_text": "Transformers"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----ef792bbb3260---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/pipeline?source=post_page-----ef792bbb3260---------------pipeline-----------------", "anchor_text": "Pipeline"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fef792bbb3260&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpipelines-custom-transformers-in-scikit-learn-ef792bbb3260&user=Santiago+Velez+Garcia&userId=bc94670ae5ea&source=-----ef792bbb3260---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fef792bbb3260&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpipelines-custom-transformers-in-scikit-learn-ef792bbb3260&user=Santiago+Velez+Garcia&userId=bc94670ae5ea&source=-----ef792bbb3260---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fef792bbb3260&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpipelines-custom-transformers-in-scikit-learn-ef792bbb3260&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----ef792bbb3260--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fef792bbb3260&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpipelines-custom-transformers-in-scikit-learn-ef792bbb3260&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----ef792bbb3260---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----ef792bbb3260--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----ef792bbb3260--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----ef792bbb3260--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----ef792bbb3260--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----ef792bbb3260--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----ef792bbb3260--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----ef792bbb3260--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----ef792bbb3260--------------------------------", "anchor_text": ""}, {"url": "https://svelezg.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://svelezg.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Santiago Velez Garcia"}, {"url": "https://svelezg.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "22 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fbc94670ae5ea&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpipelines-custom-transformers-in-scikit-learn-ef792bbb3260&user=Santiago+Velez+Garcia&userId=bc94670ae5ea&source=post_page-bc94670ae5ea--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F936d6548b64a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpipelines-custom-transformers-in-scikit-learn-ef792bbb3260&newsletterV3=bc94670ae5ea&newsletterV3Id=936d6548b64a&user=Santiago+Velez+Garcia&userId=bc94670ae5ea&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}