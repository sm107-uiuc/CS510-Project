{"url": "https://towardsdatascience.com/computational-physics-ed6c6a0bd22a", "time": 1683016263.8708448, "path": "towardsdatascience.com/computational-physics-ed6c6a0bd22a/", "webpage": {"metadata": {"title": "Computational physics. Understanding the physical laws that\u2026 | by Saupin Guillaume | Towards Data Science", "h1": "Computational physics", "description": "A few days after seeing the motion picture Arrival, while working on my previous paper Differentiable Programming, I discovered that the authors of JAX, a library implementing Automatic\u2026"}, "outgoing_paragraph_urls": [{"url": "https://en.wikipedia.org/wiki/Arrival_(film)", "anchor_text": "Arrival", "paragraph_index": 0}, {"url": "https://towardsdatascience.com/differentiable-programming-from-scratch-abba0ebebc1c", "anchor_text": "Differentiable Programming", "paragraph_index": 0}, {"url": "https://jax.readthedocs.io/", "anchor_text": "JAX", "paragraph_index": 0}, {"url": "https://mitpress.mit.edu/sites/default/files/titles/content/sicm_edition_2/toc.html", "anchor_text": "Structure and Interpretation of Classical Mechanics", "paragraph_index": 0}, {"url": "https://web.mit.edu/alexmv/6.037/sicp.pdf", "anchor_text": "Structure and Interpretation of Computer Programs", "paragraph_index": 1}, {"url": "https://en.wikipedia.org/wiki/Arrival_(film)", "anchor_text": "Arrival", "paragraph_index": 4}], "all_paragraphs": ["A few days after seeing the motion picture Arrival, while working on my previous paper Differentiable Programming, I discovered that the authors of JAX, a library implementing Automatic Differentiation, recommended the reading of Structure and Interpretation of Classical Mechanics. I was immediately struck by the clever way they explain the Principle of Stationary Action, that inspired Arrival.", "This book has been published by MIT and reuses the same title to Structure and Interpretation of Computer Programs, that was also published by MIT. Both are available for free online!", "Structure and Interpretation of Computer Programs, also known as the Wizard Book is a famous computer science book. I highly recommend its reading. As I had a really great time reading it, I was intrigued by this new book on Classical Mechanics that seemed to follow the same pattern.", "As a former researcher in the mechanical field, I was not disappointed by this book; as like for SICP, I really enjoyed the reading of SICM. The overall idea of this book is to approach Classical Mechanics using the tools provided by computer science: Numerical analysis, Symbolic computation, Automatic Differentiation, \u2026", "In this article, we will see how to use the mathematical and numerical tools we are familiar with to compute rigid bodies trajectories, using the physics principle that inspired the movie Arrival: the Principle of Stationary Action.", "The physics we are familiar with are essentially based on the vision of Newton. In his vision, based on a differential approach, motion and forces are related by the acceleration: Applying a force on a body changes its speed, i.e. the acceleration of the body is proportional to the force. And the more massive a body is, the lesser the force influences its speed: acceleration is inversely proportional to mass.", "This relation is generally subsumed by his famous second law:", "Using this formula, or slightly more sophisticated versions, it is absolutely possible to simulate the motion of rigid or deformable objects.", "However, in this paper, we will focus on another approach, developed by the french mathematician Maupertuis, refined by the brilliant Britannic mathematician Hamilton, further extended by the Russian mathematician Ostrogravsky and generalized by the french scientist Lagrange: the Principle of Least Action, generalized as the Principle of Stationary Action.", "Also, note that this principle underlies the story of the fascinating book Story of your life by the American author Ted Chiang. This book has inspired the none less famous movie Arrival. But enough with this cultural digression. Let\u2019s go back to math and physics.", "I won\u2019t give you the statement for this principle, that can be found in any good mechanic textbook. Instead, like in SICM, I will emphasize how we can use this principle to select physically acceptable motions amongst candidates trajectories using our preferred programming language: Python.", "Indeed, this principle essentially states that any physically acceptable path minimizes a specific function. Or to be more accurate, any small variation around the acceptable path must leave the function unchanged, i.e. the path is stationary.", "So, to find the right path, all we have to do is perform some minimization of an objective. Nothing easier, this is our daily job.", "To compute these acceptable paths, all we need is :", "Let\u2019s be concrete, and put some code on these concepts.", "There are various options to defines trajectories. We can for instance use splines, Bezier curves and Bernstein polynomials. But as we are dealing with a physical subject, we are going to use Lagrange polynomials.", "These polynomials are pretty convenient: they control curves by forcing them to go through predefined control points. To do so, Lagrange has designed his polynomial so that the coefficient before each point x_i is 0.0 for any time t_k different of t_i, and is equal to 1.0 for t_i.", "Here is an example of such a formula for the coefficient of the first control point x_0, for a curve with 3controls points.", "We can apply this code as follow, to get an example trajectory:", "The resulting trajectory is shown below:", "Note that the curve goes exactly through the control points.", "Now that we have a way to define curves using parameters as easy to handle as control points, we need a tool to extract characteristic features at any point of these curves.", "As the features we need are position, speed or acceleration, i.e. derivatives of various order of the curve with respect to time, we can use Automatic Differentiation.", "We define the following function, local_state, that taking any function of time, computes its characteristic using the AD library JAX:", "We can apply this function on the curve defined above. Looking at the curve tells us that the derivative must be null at t=1.5. Let\u2019s check that with these few lines of code:", "Creating a candidate trajectory is now as straightforward as choosing a set of control points. We also have the tool to compute differential geometrical features automatically.", "All we need now is a way to choose the right trajectory amongst candidates, or even better, to converge to the right one.", "As written a few lines above, and stated by Maupertuis, we know for centuries that a physically acceptable trajectory minimizes what is called the Action.", "L stands here for the Lagrangian, and Gamma is our function local_state, in charge of feature extraction.", "To perform the integration, we are going to use the standard scipy integrate method.", "As a first try, we will compute the trajectory of a body freely falling. In this case, the body is only subject to the acceleration due to gravity. When dropping an object with a null initial speed, its y coordinate at time t is:", "With this physical setup, the Lagrangian is defined as the difference between the kinetic energy and the potential energy due to gravity, i.e.:", "Putting all these together, we get:", "The action for the real trajectory is indeed minimal with respect to a perturbated curve.", "Let\u2019s now check that starting from any candidate trajectory, we can converge to the right one when minimizing the action. For this, we are going to use scipy.optimize.minimize function, using the geometric Nelder-Mead minimization method.", "This lead to the following code:", "As expected, we converge to the right curve, showing y coordinate at time t:", "Let\u2019s try another example, to be convinced. In this case, we will not only consider y, but also x.", "We enforce positions of our body not only at t0 but also at t1. Hence we have two boundaries conditions:", "This time we are interpolating 2D vectors not just float. To handle this, we are just going to use a Lagrangian polynomial for each dimension. Another option could have been to use a single polynomial and use 2D points as control points.", "The equation for the real trajectory is defined in the real_trajectory function. It\u2019s used for displaying some checkpoints, to ensure that we converge to the right motion, as shown below:", "One again, everything works as expected.", "With these basic examples, we have shown that it\u2019s possible to ease the understanding of pretty complex physical theories, using the same tools that we use for Data Science.", "We have been able to illustrate the variational approach of classical mechanics with few lines of code, hence making it easier to understand the concepts behind these theoretical principles.", "Introducing programming languages like python, with all their power and flexibility in teaching physics is a very good way to help to grab complex subjects. With them, it\u2019s straightforward to experiment with physics laws and understand their real meanings. It\u2019s so easy nowadays to test a hypothesis, build a toy model, display curves, ...", "There is no better way than creating your own simulator to understand a complex phenomenon. Programming should be a tool used in any physics classroom.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fed6c6a0bd22a&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcomputational-physics-ed6c6a0bd22a&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcomputational-physics-ed6c6a0bd22a&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcomputational-physics-ed6c6a0bd22a&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcomputational-physics-ed6c6a0bd22a&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----ed6c6a0bd22a--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----ed6c6a0bd22a--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@guillaume.saupin?source=post_page-----ed6c6a0bd22a--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@guillaume.saupin?source=post_page-----ed6c6a0bd22a--------------------------------", "anchor_text": "Saupin Guillaume"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F891e27328f3a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcomputational-physics-ed6c6a0bd22a&user=Saupin+Guillaume&userId=891e27328f3a&source=post_page-891e27328f3a----ed6c6a0bd22a---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fed6c6a0bd22a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcomputational-physics-ed6c6a0bd22a&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fed6c6a0bd22a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcomputational-physics-ed6c6a0bd22a&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://en.wikipedia.org/wiki/Arrival_(film)", "anchor_text": "Arrival"}, {"url": "https://en.wikipedia.org/wiki/Arrival_(film)", "anchor_text": "Arrival"}, {"url": "https://towardsdatascience.com/differentiable-programming-from-scratch-abba0ebebc1c", "anchor_text": "Differentiable Programming"}, {"url": "https://jax.readthedocs.io/", "anchor_text": "JAX"}, {"url": "https://mitpress.mit.edu/sites/default/files/titles/content/sicm_edition_2/toc.html", "anchor_text": "Structure and Interpretation of Classical Mechanics"}, {"url": "https://web.mit.edu/alexmv/6.037/sicp.pdf", "anchor_text": "Structure and Interpretation of Computer Programs"}, {"url": "https://en.wikipedia.org/wiki/Arrival_(film)", "anchor_text": "Arrival"}, {"url": "https://medium.com/tag/data-science?source=post_page-----ed6c6a0bd22a---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/physics?source=post_page-----ed6c6a0bd22a---------------physics-----------------", "anchor_text": "Physics"}, {"url": "https://medium.com/tag/automatic-differentiation?source=post_page-----ed6c6a0bd22a---------------automatic_differentiation-----------------", "anchor_text": "Automatic Differentiation"}, {"url": "https://medium.com/tag/mechanics?source=post_page-----ed6c6a0bd22a---------------mechanics-----------------", "anchor_text": "Mechanics"}, {"url": "https://medium.com/tag/mathematics?source=post_page-----ed6c6a0bd22a---------------mathematics-----------------", "anchor_text": "Mathematics"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fed6c6a0bd22a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcomputational-physics-ed6c6a0bd22a&user=Saupin+Guillaume&userId=891e27328f3a&source=-----ed6c6a0bd22a---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fed6c6a0bd22a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcomputational-physics-ed6c6a0bd22a&user=Saupin+Guillaume&userId=891e27328f3a&source=-----ed6c6a0bd22a---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fed6c6a0bd22a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcomputational-physics-ed6c6a0bd22a&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----ed6c6a0bd22a--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fed6c6a0bd22a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcomputational-physics-ed6c6a0bd22a&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----ed6c6a0bd22a---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----ed6c6a0bd22a--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----ed6c6a0bd22a--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----ed6c6a0bd22a--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----ed6c6a0bd22a--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----ed6c6a0bd22a--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----ed6c6a0bd22a--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----ed6c6a0bd22a--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----ed6c6a0bd22a--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@guillaume.saupin?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@guillaume.saupin?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Saupin Guillaume"}, {"url": "https://medium.com/@guillaume.saupin/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "401 Followers"}, {"url": "http://verteego.com", "anchor_text": "verteego.com"}, {"url": "https://www.amazon.co.uk/dp/B0BJ82S916", "anchor_text": "https://www.amazon.co.uk/dp/B0BJ82S916"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F891e27328f3a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcomputational-physics-ed6c6a0bd22a&user=Saupin+Guillaume&userId=891e27328f3a&source=post_page-891e27328f3a--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fd2cc9a7936cb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcomputational-physics-ed6c6a0bd22a&newsletterV3=891e27328f3a&newsletterV3Id=d2cc9a7936cb&user=Saupin+Guillaume&userId=891e27328f3a&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://www.amazon.com/dp/B0BJ82S916", "anchor_text": "Practical Gradient Boosting: A deep dive into Gradient Boosting in Python2022"}, {"url": "https://www.amazon.com/dp/2100836137", "anchor_text": "70 concepts math\u00e9matiques expliqu\u00e9s avec Python"}, {"url": "https://medium.com/@guillaume.saupin/books?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "See all (3)"}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}