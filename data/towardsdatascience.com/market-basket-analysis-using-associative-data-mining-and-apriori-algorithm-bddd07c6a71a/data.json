{"url": "https://towardsdatascience.com/market-basket-analysis-using-associative-data-mining-and-apriori-algorithm-bddd07c6a71a", "time": 1683009480.188162, "path": "towardsdatascience.com/market-basket-analysis-using-associative-data-mining-and-apriori-algorithm-bddd07c6a71a/", "webpage": {"metadata": {"title": "Market-basket analysis and prediction | by Gokul S Kumar | Towards Data Science", "h1": "Market-basket analysis and prediction", "description": "We all have been shopping more from online e-commerce sites recently, probably due to the lock-down imposed in most parts of the world. You must have noticed an up-sell feature named \u2018frequently\u2026"}, "outgoing_paragraph_urls": [], "all_paragraphs": ["We all have been shopping more from online e-commerce sites recently, probably due to the lock-down imposed in most parts of the world. You must have noticed an up-sell feature named \u2018frequently bought together\u2019 in most of these sites, for instance Amazon where it predicts what all items would go-along with the item that you have just added to the cart. Customers are given the choice of adding all the items shown under this feature to the cart or select the required ones. Amazon does it thorough what they call \u2018item-to-item collaborative filtering\u2019 where it runs recommendation algorithms based on the item-search history of the customer to improve the shopping experience. In the case of offline retailers, it works pretty much the same. Let us consider the basic example of Bread and Jam. If the retailer finds that there is an increase in the sales of bread, he can further up-sell by giving a discount in the price of jam, so that more customers are bound to buy them together.", "This entire process of analyzing the shopping trends of customers is called \u2018Market Basket Analysis\u2019. It is an analyzing technique based on the idea that if we buy an item then we are bound to buy or not-buy a group (or single) items. For example, if a customer is buying bread then the chances of him/her buying jam is more. This is represented by the following equation:", "This equation is called the Association Mining Rule. This can be thought of as an IF-THEN relationship. If item A is bought by a customer then the chances of item B being bought by the same user in the same transaction is found out. Here A is called the Antecedent and B the consequent. Antecedents are primary item that are found in the basket and consequents are the items that are found with an antecedent/group of antecedents. The metrics for measuring association are:", "Support: It tells us about the combination of items bought together frequently. It gives the part of transactions that contain both A and B.", "We can filter out the less frequently occurring items-sets using support.", "Confidence: It tells us how frequently the items A and B are bought together, for the no. of times A is bought.", "Lift: It indicates the strength of a rule over the randomness of A and B being bought together. It basically measures the strength of any association rule(we will talk about association rules below).", "More the lift more is the strength of the rule. If the lift is 3 for A -> B then it means if we buy A, the chances of buying B is 3 times.", "So the process is to make rules for each item-set to figure out the metrics of its association so as to decide whether to include it in the analysis or not. But consider a large data-set having millions of user and transactions, thereby producing a large amount of item-sets. So to make rules for all of these would be a humongous task. This is where Apriori algorithm enters the scene.", "Apriori algorithm uses frequently bought item-sets to generate association rules. It is built on the idea that the subset of a frequently bought items-set is also a frequently bought item-set. Frequently bought item-sets are decided if their support value is above a minimum threshold support value.", "To demonstrate the working of this algorithm consider the following transactions:", "There are 5 items A,B,C,D and E in total which are bought together in different combinations in each transaction. Lets fix the minimum threshold support value of item-sets formed to be 2.", "Iteration-1: Item-sets having 1 item is formed and their support is calculated.", "As seen from the support values of each item-set, D has a support of 1 which is less than the threshold value. So we are going to omit that item-set.", "Iteration-2: Next we make all the possible item-sets having 2 items in them. All the items in the table F1 are used in this.", "Item-sets having support less than 2 are again omitted, {A,B} in this iteration.", "Iteration-3: All the possible item-sets having 3 items in them are listed. Then we are going to divide these item-sets into their sub-sets and omit those having a support value less than the threshold i.e., 2. This process is called Pruning.", "We will omit {A,B,C} and {A,B,E} as they both contain {A,B} which was omitted in Iteration-2. This pruning section is the key part of Apriori algorithm.", "Iteration-4: Using F3 we will create item-sets having 4 items.", "As we can see, the support of the only item-set having 4 items is less than 2. So we stop the iterations here and the final item-set is F3.", "Rules: For filtering out the relevant item-sets we will create certain rules and apply it to the subsets. Assume a minimum confidence value of 60%.", "For every subset S of I we make the rule", "S \u2192(I-S) (which means if S then I minus S) if", "Same steps can be done to {B,C,E}. Lift is not being used as the size of the input data-set is small and there is no need of further filtering. But in the case of larger data set further filtering is done by imposing a minimum lift value for the rules. The values of all three of the association metrics can be tweaked as per requirement.", "Lets consider an actual data-set and see how the analysis is done.", "The link to the data-set being used is given below", "We are going to sue python and pandas. We are also going to use Mlxtend lib as it contains inbuilt functions for Apriori algorithm and Associaction rules.", "Ingest the data into a pandas data-frame and try to know about the features.", "Further description of the features are as follows:", "UserId \u2014 Unique identifier of a user.", "TransactionId \u2014 Unique identifier of a transaction. If the same TransactionId is present in multiple rows, then all those products are bought together in the same transaction.", "TransactionTime \u2014 Time at which the transaction is performed", "ItemCode \u2014 Unique identifier of the product purchased", "ItemDescription \u2014 Simple description of the product purchased", "NumberOfItemsPurchased \u2014 Quantity of the product purchased in the transaction", "CostPerItem \u2014 Price per each unit of the product", "Country \u2014 Country from which the purchase is made.", "EDA and data cleaning is done as follows:", "Lets do some exploratory data analysis now. Lets see the no. of transactions being done in each part of the year.", "Basically we are creating a column named month_year to divide the datapoints into the month in which they occurred. Then we are taking the no. of unique transaction occurring in each month and plotting it using matplotlib.", "As we can see the as the time advances the online retailer is getting more and more purchases which maxed in the month of Jan\u201919.", "Lets explore the no. of items bought in each transaction.", "As we can see the min no. of items is 1 and the max is 540. So we need to plot our histogram as shown below:", "Oops! We can see that most of the transactions include items between 0\u2013100 and some between 100\u2013200. The max items transactions shown above probably is an outlier or is a customer who purchases in a large scale. So we need to re-scale our histogram.", "As we can see most transactions included less than 10 items.", "Lets find out the most-selling item in the market. This can be interpreted in many way such as the item which brings in the maximum revenue, items which were found in maximum no. of transactions etc. We will be considering the items which bring in maximum revenue.", "From the above plot showing the top 10 items, we can see that the item \u2018retrospot lamp\u2019 has maximum sales value.", "The no. of unique TransactionId\u2019s is found to be 18334 and the no. of unique ItemDescription\u2019s is found to be 3871.", "Now that we have our data after all the pre-processing, lets arrange it with the TransactionId\u2019s as the index and the ItemDescriptions as the columns with the total no. of items bought in each transaction of each item as the data-point.", "We need to make sure that any positive values are encoded to one and all the negative values(if any) to zero.", "As the data-frame is ready we can apply Apriori algorithm to get the frequently bought item-sets.", "Here the minimum threshold support value is set as 1.5%. We get the following item-sets.", "We then arrange the itemsets in descending order of their support values which gives us", "We then apply the association rules to these item-sets formed by Apriori algorithm.", "The metric used here is confidence and its minimum threshold value is set to be 0.2.", "All the antecedents with the corresponding consequents are listed with their individual supports, the total support of the item-set and all other metrics.", "The summary of the rules data-frames gives us the following insights:", "Lets take the top rules having the highest confidence", "Plotting the rules in a graph:", "All these plotting and and further analysis can be done more easily in R rather than python as there are more compatible libraries for data-mining and association rules in R.", "Further filtering of the obtained item-sets can be done using lift and confidence values (as they measure association rule strength).", "Here the mean value of lift and confidence are found to be 9.388 and 0.429 respectively.", "The item-sets are filtered such that only those having the lift and confidence values above the mean values are included.", "In this way all the required item-sets can be found. Further fine-tuning of the item-sets to find the more probable ones can be done by increasing the threshold values of support and lift. We can store the found item-sets in a csv file for furtherance.", "We looked at the basic Association Mining Rule and its applications. Then we solved the problem of generating frequently bought item-sets by using Apriori algorithm. The process was applying Association Rules to these generated item-set was looked upon. We also learned how to do this entire process in Python using Pandas and Mlxtend on a comparatively large-scale dataset.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "I teach robots how to learn!"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fbddd07c6a71a&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmarket-basket-analysis-using-associative-data-mining-and-apriori-algorithm-bddd07c6a71a&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmarket-basket-analysis-using-associative-data-mining-and-apriori-algorithm-bddd07c6a71a&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmarket-basket-analysis-using-associative-data-mining-and-apriori-algorithm-bddd07c6a71a&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmarket-basket-analysis-using-associative-data-mining-and-apriori-algorithm-bddd07c6a71a&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----bddd07c6a71a--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----bddd07c6a71a--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@skumar.gokul?source=post_page-----bddd07c6a71a--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@skumar.gokul?source=post_page-----bddd07c6a71a--------------------------------", "anchor_text": "Gokul S Kumar"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Feb75603badb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmarket-basket-analysis-using-associative-data-mining-and-apriori-algorithm-bddd07c6a71a&user=Gokul+S+Kumar&userId=eb75603badb&source=post_page-eb75603badb----bddd07c6a71a---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fbddd07c6a71a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmarket-basket-analysis-using-associative-data-mining-and-apriori-algorithm-bddd07c6a71a&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fbddd07c6a71a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmarket-basket-analysis-using-associative-data-mining-and-apriori-algorithm-bddd07c6a71a&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@brookecagle?utm_source=medium&utm_medium=referral", "anchor_text": "Brooke Cagle"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://drive.google.com/file/d/1vE3xyM-hbZMB5RS8c3H13Ll1PnFXJ7Ui/view?usp=sharing", "anchor_text": "transaction_data.csvEdit descriptiondrive.google.com"}, {"url": "https://www.edureka.co/blog/apriori-algorithm/", "anchor_text": "Apriori Algorithm : Know How to Find Frequent Itemsets | EdurekaHas it ever happened that you're out to buy something, and you end up buying a lot more than you planned? It's a\u2026www.edureka.co"}, {"url": "http://pbpython.com/market-basket-analysis.html", "anchor_text": "Introduction to Market Basket Analysis in PythonThere are many data analysis tools available to the python analyst and it can be challenging to know which ones to use\u2026pbpython.com"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----bddd07c6a71a---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/market-basket-analysis?source=post_page-----bddd07c6a71a---------------market_basket_analysis-----------------", "anchor_text": "Market Basket Analysis"}, {"url": "https://medium.com/tag/data-mining?source=post_page-----bddd07c6a71a---------------data_mining-----------------", "anchor_text": "Data Mining"}, {"url": "https://medium.com/tag/apriori?source=post_page-----bddd07c6a71a---------------apriori-----------------", "anchor_text": "Apriori"}, {"url": "https://medium.com/tag/data-science?source=post_page-----bddd07c6a71a---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fbddd07c6a71a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmarket-basket-analysis-using-associative-data-mining-and-apriori-algorithm-bddd07c6a71a&user=Gokul+S+Kumar&userId=eb75603badb&source=-----bddd07c6a71a---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fbddd07c6a71a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmarket-basket-analysis-using-associative-data-mining-and-apriori-algorithm-bddd07c6a71a&user=Gokul+S+Kumar&userId=eb75603badb&source=-----bddd07c6a71a---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fbddd07c6a71a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmarket-basket-analysis-using-associative-data-mining-and-apriori-algorithm-bddd07c6a71a&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----bddd07c6a71a--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fbddd07c6a71a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmarket-basket-analysis-using-associative-data-mining-and-apriori-algorithm-bddd07c6a71a&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----bddd07c6a71a---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----bddd07c6a71a--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----bddd07c6a71a--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----bddd07c6a71a--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----bddd07c6a71a--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----bddd07c6a71a--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----bddd07c6a71a--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----bddd07c6a71a--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----bddd07c6a71a--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@skumar.gokul?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@skumar.gokul?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Gokul S Kumar"}, {"url": "https://medium.com/@skumar.gokul/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "52 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Feb75603badb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmarket-basket-analysis-using-associative-data-mining-and-apriori-algorithm-bddd07c6a71a&user=Gokul+S+Kumar&userId=eb75603badb&source=post_page-eb75603badb--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F329f05900600&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmarket-basket-analysis-using-associative-data-mining-and-apriori-algorithm-bddd07c6a71a&newsletterV3=eb75603badb&newsletterV3Id=329f05900600&user=Gokul+S+Kumar&userId=eb75603badb&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}