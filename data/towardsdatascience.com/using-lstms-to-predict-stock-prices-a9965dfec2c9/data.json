{"url": "https://towardsdatascience.com/using-lstms-to-predict-stock-prices-a9965dfec2c9", "time": 1683003967.520093, "path": "towardsdatascience.com/using-lstms-to-predict-stock-prices-a9965dfec2c9/", "webpage": {"metadata": {"title": "Using LSTMs to Predict Stock Prices | by Vansh Sethi | Towards Data Science", "h1": "Using LSTMs to Predict Stock Prices", "description": "A blindfolded monkey could manage a portfolio better than any human ever could. No, I\u2019m actually serious. Numerous studies show that monkeys outperform humans in the stock market all the time. A\u2026"}, "outgoing_paragraph_urls": [{"url": "http://vanshs.com", "anchor_text": "vanshs.com", "paragraph_index": 17}], "all_paragraphs": ["A blindfolded monkey could manage a portfolio better than any human ever could. No, I\u2019m actually serious. Numerous studies show that monkeys outperform humans in the stock market all the time. A monkey allegedly generated 8x more profit in a quarter than traders on the New York Stock Exchange. How can a clueless primate beat the so-called \u201cgeniuses\u201d of wall street? The answer, dumb luck.", "Humans try to gauge and predict stock prices all the time, using fancy statistics and trends to figure it out. But the truth is, humans aren\u2019t able to comprehend the different variables that go into a stock price. We aren\u2019t able to synthesize a company\u2019s reputation, the projects they\u2019ve announced and are working on, track record, past stock market data and factoring all that into making informed decisions on the stock market. We can\u2019t consider every single variable and stat that ever existed about a company. But, computers can. More specifically, neural networks are designed to do exactly that.", "A neural network in a mathematical sense is a differentiable function that takes in an input and computes an output. Essentially, it\u2019s your standard f(x) but instead of only one variable \u201cx\u201d, there are 1,000,000\u2019s of x\u2019s or parameters. Our goal is to optimize these parameters, as then we can feed in any input and get the desired output. These are neural networks in a nutshell, but an LSTM has some special properties.", "A Long-Short Term Memory neural network is comprised of LSTM units or cells. These units have special computations to them and pass their output along to the next unit as input. In short, the main goal of an LSTM is to account for data that was passed in before into the output. Things like time-series data or stock market data are dependent on past versions of itself, and using an LSTM, it remembers the past and tries to predict the future. Here\u2019s how it works.", "In stock market data and generally data that relies on past iterations of itself, at different times data was different. At a certain time, a piece of data was X. This is called time steps and data is entered into an LSTM cell broken down into its corresponding time step. For example, the 3rd LSTM unit takes in the 3rd time step of data or X3.", "Quick Notation: t-1 indicates the values of the last LSTM cell and t is the output of the current LSTM cell.", "The notation for C indicates the cell state of the LSTM. The cell state is a vector of values that are passed through each cell in its own path. The current cell can use this cell state in its calculations or change the cell state entirely. Because of this, the cell state vector acts as the long-term memory part of the neural network. This is because it interacts with every LSTM unit and can thus factor in every unit when calculating the output of the next unit. This is where the long-term memory aspect of the LSTM comes from.", "The input gate takes in the output of the hidden state (ht-1) of the last cell and the labelled data input (Xt) and uses this information to see if the cell state \u00a9 should be changed. It first multiplies the data input and hidden state together, creating one new vector of values. It then takes the sigmoid and hyperbolic tangent function of this vector and multiplying those results together. If the product is above some trained parameter, it is then added to the cell state, essentially making the cell state memorize this important info. If it\u2019s not added to the cell state, then it can be regarded as not important to the long term memory of the network. In short, the input gate determines if the information is important for the long term.", "The forget gate takes in the output of the hidden state at the previous time step (ht-1) and the data input of the current time step (Xt). It then multiplies them together and applies the sigmoid activation to it. If the output is above some trained parameter, then the cell state is completely reset to 0, essentially forgetting it\u2019s long term memory. This is why it\u2019s called the forget gate because it has the capability to forget everything that was learned thus far. This helps in time-series predictions as a piece of data will act as a reset to the current trend and the LSTM needs to factor that in. However, an LSTM will rarely pass the forget gate.", "The output gate prepares the next hidden state vector for the next cell (ht). It factors in the last hidden state vector and input data and applies a few functions to it. This is the short-term memory aspect of the neural network, as it is propagating new information into the next cell.", "Notice how all three gates work together to create the cell state \u00a9. At the end of all the units, the cell state is passed through dense layers which makes sense of all the long term memory and important info about the data to create a prediction of the next time step. Everything leads up to creating this cell state and it\u2019s the heart of the LSTM. Training the LSTM network is done to make sure that the long term info makes it out into the end. Now you have a good understanding of LSTMs, let\u2019s see how I applied them to stock market data.", "The data that was used for this project was Apple\u2019s stock price over the last 5 years. It was broken down into time steps of 10 minutes each. A neural network needs examples to train and needs labelled data, so the data was inputted in a specific way. The input was 50 timesteps and the label (which is what the neural network is trying to predict) is the 51st timestep. The neural network tries to predict the price at the next time step, and the data was created accordingly to train the neural network.", "Surprise, surprise! I used a lot of LSTMs for this neural network. Each LSTM had 96 cells in it and returns the cell state into the next LSTM as input. In the end, it had 2 dense layers that took in the output of the LSTM layers and made sense of it. The last dense layer has one node in it, which indicates that it outputs one number, the predicted value of the next time step. It had over 1 million parameters it could optimize. The dropout layers were used to make sure that the neural network wasn\u2019t just memorizing the data and the output. I know, all this work just to find the next value for the next timestep.", "This model was trained using the popular Adam optimizer and MSE loss function. The loss function is how bad the model performed and the optimizer finds the minimum of the function, which are the best parameters for the network. It ran over 100 epochs and reached a loss < 0.00001 (it performs pretty good).", "So these are few examples of stocks it was used to predict. The blue shows the predicted price and the red shows the actual price.", "Overall, the model works decently well\u2026 but that doesn\u2019t mean you should use this on the stock market. The stock market is very volatile and this model only uses past trends of a stock to predict the next.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "15 y/o emerging technologies enthusiast vanshs.com"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fa9965dfec2c9&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-lstms-to-predict-stock-prices-a9965dfec2c9&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-lstms-to-predict-stock-prices-a9965dfec2c9&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-lstms-to-predict-stock-prices-a9965dfec2c9&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-lstms-to-predict-stock-prices-a9965dfec2c9&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----a9965dfec2c9--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----a9965dfec2c9--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://vanshsethi.medium.com/?source=post_page-----a9965dfec2c9--------------------------------", "anchor_text": ""}, {"url": "https://vanshsethi.medium.com/?source=post_page-----a9965dfec2c9--------------------------------", "anchor_text": "Vansh Sethi"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F940f367dd4d8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-lstms-to-predict-stock-prices-a9965dfec2c9&user=Vansh+Sethi&userId=940f367dd4d8&source=post_page-940f367dd4d8----a9965dfec2c9---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa9965dfec2c9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-lstms-to-predict-stock-prices-a9965dfec2c9&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa9965dfec2c9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-lstms-to-predict-stock-prices-a9965dfec2c9&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://colab.research.google.com/drive/1wWCZK1IalVoc0JThyDktRKTDbkNkgJzi", "anchor_text": "*Created using Tensorflow and Keras."}, {"url": "https://colah.github.io/posts/2015-08-Understanding-LSTMs/", "anchor_text": "https://colah.github.io/contact.html"}, {"url": "https://unsplash.com/photos/Z05GiksmqYU", "anchor_text": "https://unsplash.com/photos/Z05GiksmqYU"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----a9965dfec2c9---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----a9965dfec2c9---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/lstm?source=post_page-----a9965dfec2c9---------------lstm-----------------", "anchor_text": "Lstm"}, {"url": "https://medium.com/tag/stock-market?source=post_page-----a9965dfec2c9---------------stock_market-----------------", "anchor_text": "Stock Market"}, {"url": "https://medium.com/tag/stocks?source=post_page-----a9965dfec2c9---------------stocks-----------------", "anchor_text": "Stocks"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fa9965dfec2c9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-lstms-to-predict-stock-prices-a9965dfec2c9&user=Vansh+Sethi&userId=940f367dd4d8&source=-----a9965dfec2c9---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fa9965dfec2c9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-lstms-to-predict-stock-prices-a9965dfec2c9&user=Vansh+Sethi&userId=940f367dd4d8&source=-----a9965dfec2c9---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa9965dfec2c9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-lstms-to-predict-stock-prices-a9965dfec2c9&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----a9965dfec2c9--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fa9965dfec2c9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-lstms-to-predict-stock-prices-a9965dfec2c9&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----a9965dfec2c9---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----a9965dfec2c9--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----a9965dfec2c9--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----a9965dfec2c9--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----a9965dfec2c9--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----a9965dfec2c9--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----a9965dfec2c9--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----a9965dfec2c9--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----a9965dfec2c9--------------------------------", "anchor_text": ""}, {"url": "https://vanshsethi.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://vanshsethi.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Vansh Sethi"}, {"url": "https://vanshsethi.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "134 Followers"}, {"url": "http://vanshs.com", "anchor_text": "vanshs.com"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F940f367dd4d8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-lstms-to-predict-stock-prices-a9965dfec2c9&user=Vansh+Sethi&userId=940f367dd4d8&source=post_page-940f367dd4d8--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Ffcae77d9db76&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-lstms-to-predict-stock-prices-a9965dfec2c9&newsletterV3=940f367dd4d8&newsletterV3Id=fcae77d9db76&user=Vansh+Sethi&userId=940f367dd4d8&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}