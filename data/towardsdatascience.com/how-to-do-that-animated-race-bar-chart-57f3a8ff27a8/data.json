{"url": "https://towardsdatascience.com/how-to-do-that-animated-race-bar-chart-57f3a8ff27a8", "time": 1682995968.4981399, "path": "towardsdatascience.com/how-to-do-that-animated-race-bar-chart-57f3a8ff27a8/", "webpage": {"metadata": {"title": "How to do that animated \u2018race\u2019 bar chart | by Keith McNulty | Towards Data Science", "h1": "How to do that animated \u2018race\u2019 bar chart", "description": "In this article, we are going to analyze the all time performance of English football teams since their leagues began in 1888, and use that data to create an animated bar chart that cycles through\u2026"}, "outgoing_paragraph_urls": [{"url": "https://github.com/keithmcnulty/english_football_league", "anchor_text": "Github", "paragraph_index": 0}, {"url": "https://github.com/jalapic/engsoccerdata/blob/master/data/england.rda", "anchor_text": "here", "paragraph_index": 3}, {"url": "https://stackoverflow.com/questions/53162821/animated-sorted-bar-chart-with-bars-overtaking-each-other/53163549", "anchor_text": "this StackOverflow discussion", "paragraph_index": 12}, {"url": "https://ggplot2.tidyverse.org/", "anchor_text": "tidyverse.org", "paragraph_index": 14}, {"url": "https://www.linkedin.com/in/keith-mcnulty/", "anchor_text": "LinkedIn", "paragraph_index": 20}, {"url": "https://twitter.com/dr_keithmcnulty", "anchor_text": "Twitter", "paragraph_index": 20}, {"url": "http://keithmcnulty.org", "anchor_text": "keithmcnulty.org", "paragraph_index": 22}], "all_paragraphs": ["In this article, we are going to analyze the all time performance of English football teams since their leagues began in 1888, and use that data to create an animated bar chart that cycles through each year and shows the total points accrued of the top ten teams throughout history. We will also use the title bar to provide a narrative about how the sport changed in England over 130 years. Here\u2019s the finished product, and all code is on Github:", "Lets be clear on our aims before we start. Here\u2019s what we want to do:", "I\u2019m not going to focus on styling and prettiness in this article, just the basic functionality that creates an animated graphic.", "Ideally what we need is a data set which tell us about league points obtained through history, but I was unable to find that set. Instead I found something much more detailed and awesome, which is a record of every single game played since 1888 and the result and score. I found it here in the form of an R dataframe object \u2014 so we will be doing this in R folks. Here is a quick snapshot of what the data looks like.", "This dataset is fairly large, with almost 200,000 matches played in every tier since 1888. First we need to convert each match to a points allocation to a given team. Points are shared between the home team and the visitor (away) team as follows:", "So lets load our data in and load up our tidyverse packages for standard data manipulation. We will use the result column to assign home points and away points, by creating two new columns using dplyr::mutate() as follows:", "Now we have our points allocated for each game, we will need to get the total home and away points for each team and each Season, remembering at this point that we are only interested in games played in the top tier:", "Now we can bind these two dataframes together and add up home and away points to get total points for each team by season:", "Now we have a dataframe which shows the points earned by each team in each season. We want to manipulate this so that each season shows us the sum of all points earned up to and including that season. We can achieve this with a quick for loop:", "We have done enough to have the data we need for objective 1. For objective 2, I will edit the Season column to sprinkle in some important historical facts about the English football league. I will keep each fact displayed for around three seasons to allow it to appear long enough in the animation for viewers to read it. Let\u2019s call this new edited column SeasonLabel.", "Lets take a look at our data now:", "Now we have everything we need to code our animation. Let just save our dataset using save(table, 'data/table.RData') so we can open it up in a new file that we will use to create the animation.", "With the help of this StackOverflow discussion, we will use theggplot2 package to design a static bar chart for this data, and then we will use the awesome package gganimate to generate a rolling animation that transitions through each SeasonLabel and updates the bar chart.", "Let\u2019s load the data and some packages we will need. Then, first, we need to rank each team in each season, as the rank will determine the order that the bars appear in the \u2018race\u2019 chart. We also create a relative value for each team compared to the team at the top of the ranking, as this will help with scaling the bars. Finally we create a label to draw the value from the Points column. We then restrict to the top 10 teams by rank.", "Now we have everything we need to plot the static bar chart\u2014 this only needs a string of fairly basic ggplot2 commands. I won\u2019t go through these in detail but if you need to refamiliarize yourself with these then I recommend tidyverse.org as a starting point. The main points here are that we use rank as the x aesthetic, Points as the y aesthetic, we then assign Team and Points and then we flip the chart to make it horizontal rather than vertical.", "Now comes the main part of the animation. We give labels to the static plot for the title and the axes, but one of these labels is the one that we will use to animate the plot \u2014 ie SeasonLabel. This is known as the transition variable. So we tell ggplot2 that we want the title to print the current transition state \u2014 ie SeasonLabel as the title as it rotates through the animation. Finally we use ease_aes() to define the way values change as we move through the transitions \u2014 there are many easing functions which you can experiment with here, just consult the help file for details.", "So our animated plot is now saved in the environment as the object p. All we need to do now is render it as a output file. There are many devices that can be used to render the output in various formats, but the most common are:", "In my case I am going to create a gif as per the image displayed earlier. You can adjust the speed of the gif by using the duration argument, and you can tailor the size and resolution of the image too.", "Depending on how you set the arguments in the animate() function, the file may take longer to render, but you can view progress in your console.", "This was a short practical case study. It only covers a very small amount of the animation possibilities in R. I would encourage you to read up on gganimate more and then potentially try to use it to animate some of your own data. Time series data in particular lends itself well to good animation. The plotly package in R also has increasing animation capabilities which are worth a look.", "Originally I was a Pure Mathematician, then I became a Psychometrician and a Data Scientist. I am passionate about applying the rigor of all those disciplines to complex people questions. I\u2019m also a coding geek and a massive fan of Japanese RPGs. Find me on LinkedIn or on Twitter.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Expert and Author in Applied Mathematics, Data Science, Statistics. Also writes History, Science, Culture. Find me on Twitter or keithmcnulty.org"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F57f3a8ff27a8&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-do-that-animated-race-bar-chart-57f3a8ff27a8&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-do-that-animated-race-bar-chart-57f3a8ff27a8&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-do-that-animated-race-bar-chart-57f3a8ff27a8&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-do-that-animated-race-bar-chart-57f3a8ff27a8&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----57f3a8ff27a8--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----57f3a8ff27a8--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://keith-mcnulty.medium.com/?source=post_page-----57f3a8ff27a8--------------------------------", "anchor_text": ""}, {"url": "https://keith-mcnulty.medium.com/?source=post_page-----57f3a8ff27a8--------------------------------", "anchor_text": "Keith McNulty"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fa859aab532a0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-do-that-animated-race-bar-chart-57f3a8ff27a8&user=Keith+McNulty&userId=a859aab532a0&source=post_page-a859aab532a0----57f3a8ff27a8---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F57f3a8ff27a8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-do-that-animated-race-bar-chart-57f3a8ff27a8&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F57f3a8ff27a8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-do-that-animated-race-bar-chart-57f3a8ff27a8&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://github.com/keithmcnulty/english_football_league", "anchor_text": "Github"}, {"url": "https://github.com/jalapic/engsoccerdata/blob/master/data/england.rda", "anchor_text": "here"}, {"url": "https://stackoverflow.com/questions/53162821/animated-sorted-bar-chart-with-bars-overtaking-each-other/53163549", "anchor_text": "this StackOverflow discussion"}, {"url": "https://ggplot2.tidyverse.org/", "anchor_text": "tidyverse.org"}, {"url": "http://twitter.com/dr_keithmcnulty", "anchor_text": "@dr_keithmcnulty"}, {"url": "https://www.linkedin.com/in/keith-mcnulty/", "anchor_text": "LinkedIn"}, {"url": "https://twitter.com/dr_keithmcnulty", "anchor_text": "Twitter"}, {"url": "https://medium.com/tag/data-science?source=post_page-----57f3a8ff27a8---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/analytics?source=post_page-----57f3a8ff27a8---------------analytics-----------------", "anchor_text": "Analytics"}, {"url": "https://medium.com/tag/sports?source=post_page-----57f3a8ff27a8---------------sports-----------------", "anchor_text": "Sports"}, {"url": "https://medium.com/tag/data-visualization?source=post_page-----57f3a8ff27a8---------------data_visualization-----------------", "anchor_text": "Data Visualization"}, {"url": "https://medium.com/tag/programming?source=post_page-----57f3a8ff27a8---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F57f3a8ff27a8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-do-that-animated-race-bar-chart-57f3a8ff27a8&user=Keith+McNulty&userId=a859aab532a0&source=-----57f3a8ff27a8---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F57f3a8ff27a8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-do-that-animated-race-bar-chart-57f3a8ff27a8&user=Keith+McNulty&userId=a859aab532a0&source=-----57f3a8ff27a8---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F57f3a8ff27a8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-do-that-animated-race-bar-chart-57f3a8ff27a8&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----57f3a8ff27a8--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F57f3a8ff27a8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-do-that-animated-race-bar-chart-57f3a8ff27a8&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----57f3a8ff27a8---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----57f3a8ff27a8--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----57f3a8ff27a8--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----57f3a8ff27a8--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----57f3a8ff27a8--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----57f3a8ff27a8--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----57f3a8ff27a8--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----57f3a8ff27a8--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----57f3a8ff27a8--------------------------------", "anchor_text": ""}, {"url": "https://keith-mcnulty.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://keith-mcnulty.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Keith McNulty"}, {"url": "https://keith-mcnulty.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "11K Followers"}, {"url": "http://keithmcnulty.org", "anchor_text": "keithmcnulty.org"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fa859aab532a0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-do-that-animated-race-bar-chart-57f3a8ff27a8&user=Keith+McNulty&userId=a859aab532a0&source=post_page-a859aab532a0--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F7991b3dbcee9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-do-that-animated-race-bar-chart-57f3a8ff27a8&newsletterV3=a859aab532a0&newsletterV3Id=7991b3dbcee9&user=Keith+McNulty&userId=a859aab532a0&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://peopleanalytics-regression-book.org/", "anchor_text": "Handbook of Regression Modeling in People Analytics2021"}, {"url": "https://ona-book.org", "anchor_text": "Handbook of Graphs and Networks in People Analytics2022"}, {"url": "https://medium.com/@keith-mcnulty/books?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "See all (2)"}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}