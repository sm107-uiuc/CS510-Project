{"url": "https://towardsdatascience.com/autoencoders-in-practice-dimensionality-reduction-and-image-denoising-ed9b9201e7e1", "time": 1683017558.105393, "path": "towardsdatascience.com/autoencoders-in-practice-dimensionality-reduction-and-image-denoising-ed9b9201e7e1/", "webpage": {"metadata": {"title": "Autoencoders in Practice: Dimensionality Reduction and Image Denoising | by Ruben Winastwan | Towards Data Science", "h1": "Autoencoders in Practice: Dimensionality Reduction and Image Denoising", "description": "Let\u2019s imagine ourselves creating a neural network based machine learning model. When we do so, most of the time we\u2019re going to use it to do a classification task. This means that we train our neural\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.kaggle.com/andrewmvd/medical-mnist?select=BreastMRI", "anchor_text": "here", "paragraph_index": 9}, {"url": "https://github.com/marcellusruben/Autoencoder", "anchor_text": "here", "paragraph_index": 51}], "all_paragraphs": ["Let\u2019s imagine ourselves creating a neural network based machine learning model. When we do so, most of the time we\u2019re going to use it to do a classification task. This means that we train our neural network to predict the target y given the input features x.", "However, the ability of a neural network to create a lower-dimensional representation of our data in a non-linear fashion opens up a lot of possibilities. Now we can train our neural network to compress our data and then decompress them back to their original dimension. This is the basic concept of an autoencoder.", "In a nutshell, an autoencoder is a neural network based model to compress the data. Therefore, it has the ability to learn the compressed representation of our input data.", "In the early development of Deep Learning, autoencoder has been viewed as a solution to solve the problem of unsupervised learning. This is because an autoencoder doesn\u2019t really need a labeled ground-truth for it to learn the data.", "However, it is important to note that an autoencoder itself is not a pure unsupervised learning technique. Autoencoder is a self-supervised learning technique, where the target that it needs to learn is generated from our input data. Let\u2019s take a look at the code snippet below:", "Instead of using the model to predict the ground-truth label, as we usually do with supervised models, we use an autoencoder model to reconstruct our original input data to be as similar as possible. Because of that, the point of training an autoencoder is to minimize the so-called reconstruction loss. The lower the reconstruction loss, the more similar the reconstruction of the input data can be generated by the model.", "In practice, you need two different functions to create an autoencoder model: an encoder and a decoder. These two functions are normally implemented with neural networks. It can be LSTM if you\u2019re working on NLP use case, or Convolutional Neural Networks (CNN), if you\u2019re working on Computer Vision use case.", "As you can see above, there are three components of an autoencoder:", "Due to its encoder-decoder architecture, nowadays an autoencoder is mostly used in two of these domains: image denoising and dimensionality reduction for data visualization. In this article, let\u2019s build an autoencoder to tackle these things.", "Before we start building an autoencoder, we need to load the data first. The data that we\u2019re going to use is the Medical MNIST dataset. If you want to follow along, you can download the dataset here.", "There are 58954 medical images belonging to 6 classes: AbdomenCT, BreastMRI, CXR, ChestCT, Hand, HeadCT. After downloading the data, unzip the file and place it in the directory of your choice. You should then have a folder with the following structure:", "The next thing that we should do is to split the file into training and test folder. To do this, we can use a library called split-folders. You can install it by typing the following command:", "With this library, we can split our MedicalMNIST folder into training and test folder. We will allocate 80% of the data for training data and 20% for test data.", "If you run the code above, now you get a new folder called \u2018 MedicalMNIST_splitted\u2018. Inside this folder, you\u2019ll see two folders: \u2018training\u2019 folder and \u2018val\u2019 folder. Your folder now should have the following structure.", "Finally, we can generate our training and test data from these folders with image generator from TensorFlow.", "If you run the code above, you\u2019ll get your training and test data together with their ground-truth labels.", "Now we are ready to build our autoencoder for dimensionality reduction and image denoising.", "When we\u2019re working on our machine learning projects, we commonly run into a problem where we have a lot of input variables. This means two things: first, your machine learning model will be likely to suffer from overfitting problem and second, you need to allocate a whole lot amount of time to train the model.", "Dimensionality reduction is the technique that\u2019ll save you from all of those problems. When dealing with a lot of input variables, it is often necessary to reduce the dimension of the data to capture the most valuable inputs among all of those input variables. Also, you can visualize your data and see how they occupy the latent space by lowering its dimension to two or three dimensions.", "There are two techniques that are commonly used to reduce the dimension of your data: PCA and t-SNE. However, autoencoders can be used as well for dimensionality reduction.", "In some cases, autoencoders perform even better than PCA because PCA can only learn linear transformation of the features. However, since autoencoders are built based on neural networks, they have the ability to learn the non-linear transformation of the features. This turns into a better reconstruction ability.", "Let\u2019s say we have two features, x1 and x2. In the first row, they have a linear relationship and in the second row, they have a non-linear relationship.", "In the first row, since the two features have a linear relationship, then both PCA and autoencoders can accurately reconstruct the relationship between features in the latent space.", "Meanwhile, if the two features have a non-linear relationship, as shown in the second row, then autoencoders would be more suited to use since they have the ability to learn non-linear relationship between features.", "Now it\u2019s time for us to build an autoencoder to reduce the dimension of our Medical MNIST images into two dimensions. After we reduce the dimension, we can visualize how our images occupy the latent space.", "Since our data are images, then we\u2019re going to build an autoencoder consists of convolutional layers. As you already know, we need to create two functions to build an autoencoder: an encoder and a decoder.", "The encoder consists of three stacks of convolution layers before we flatten it and use a fully-connected layer. The final fully-connected layer consists of two nodes since we want to compress and project our image data into their 2D representation.", "Meanwhile, the decoder is basically the total opposite of our encoder since we want to reconstruct the 2D representation of our images back into their initial dimension.", "Next, we can start to compile and train our autoencoder. You can use binary cross-entropy, mean squared error, or mean absolute error as your loss function. In this example, I\u2019m going to use binary cross-entropy as the loss function.", "Now since we have compressed our image data into their 2D representation, we can visualize them. To visualize the data, we can use Matplotlib and Seaborn library.", "And below is the resulting visualization.", "As you can see above, before we trained the autoencoder, our images are scattered in the latent space randomly, with almost no structure at all. However, we can see the self-supervised nature of an autoencoder after we trained it.", "Our images are mapped together based on their respective class. The images that belong to the same class are mapped close to each other, although we didn\u2019t give the model the ground-truth label of our images during the training. This is because our autoencoder is trained to reconstruct our input images from their 2D representation. To reconstruct our images as accurately as possible, the autoencoder needs to map similar images together.", "However, it is important to note that you\u2019re not going to see a strong mapping phenomenon like above in some of image datasets when you compress them into 2D. Your image dataset needs to have a strong underlying characteristic in between each class.", "If you have complex data like images of cats and dogs with different background, breed, or colors, and you try to compress them into 2D, two things will likely to happen: first, your encoder wouldn\u2019t be able to properly create a representation of your images, resulting in random scatter points in the latent space. Second, your decoder wouldn\u2019t be able to recover your image. Therefore, you need to compress your data in a higher dimension.", "Now we can also reconstruct our image back from its 2D representation with our autoencoder model.", "As we can see, our autoencoder is able to reconstruct the test images with a good result.", "You might be wondering, why the quality of the decompressed images looks worse than our original images? This is because of the \u2018lossy\u2019 characteristic of autoencoders, which means that the quality of the decompressed output will always be degraded compared to our input.", "The term denoising that I use here is the same as noise reduction. So, when we talk about noise reduction, we commonly talk about the technique to remove noise from a signal, either from an audio or an image.", "Noise in an image is commonly pretty visible with our naked eye and it can be very distracting. The grains in an image, as shown below, is the common form of noise in an image.", "The addition of digital grains makes it more difficult for our eyes to identify what kind of objects are shown in our image. Probably we need to squint our eyes to see the object clearly. With an autoencoder, we can remove the grains in our image such that we can see clearly the main objects in our image.", "We will use the same images that we\u2019ve been using so far for this image denoising example. However, as our Medical MNIST dataset doesn\u2019t have any noise, we can generate artificial random noise to the image easily with a few lines of Python code.", "Now if we take a look at the data, we can see that the grains are now apparent in our images.", "Now we can start to build our autoencoder model. Same as before, we\u2019re going to build a convolutional autoencoder model. The encoder consists of three stacks of convolutional layers and we don\u2019t need to flatten it this time.", "The decoder will be a total opposite of our encoder architecture. The architecture is very straightforward as below.", "Now we can compile and train our autoencoder model. As you can see below, we\u2019re passing our noisy images to the encoder and let the autoencoder learn how to compress our noisy images and decompress them into a clean image. You can use binary cross-entropy, mean squared error, or mean absolute error as the loss function. In this example, I\u2019m going to use binary cross-entropy.", "Let\u2019s use our trained autoencoder to reconstruct our noisy images from the test set and let\u2019s see if the model can reconstruct them into clean images.", "If you run the code above, you\u2019ll get the following visualization.", "As you can see, now our autoencoder can be used to remove the noise in our Medical MNIST images effectively.", "Hopefully, this article helps you to understand the basic concept of an autoencoder and its common practical applications.", "It is also important to note that an autoencoder is a data-specific model. This means that an autoencoder will only be able to compress the data similar to what they have been trained on. If you train your autoencoder to compress medical images, your model will do a poor job to compress a handwritten digit image, although they have the same input dimensions.", "You can find the complete Notebook of this article here.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Science || Machine Learning || Computer Vision || NLP"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fed9b9201e7e1&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fautoencoders-in-practice-dimensionality-reduction-and-image-denoising-ed9b9201e7e1&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fautoencoders-in-practice-dimensionality-reduction-and-image-denoising-ed9b9201e7e1&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fautoencoders-in-practice-dimensionality-reduction-and-image-denoising-ed9b9201e7e1&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fautoencoders-in-practice-dimensionality-reduction-and-image-denoising-ed9b9201e7e1&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----ed9b9201e7e1--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----ed9b9201e7e1--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@marcellusruben?source=post_page-----ed9b9201e7e1--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@marcellusruben?source=post_page-----ed9b9201e7e1--------------------------------", "anchor_text": "Ruben Winastwan"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F5dae9da73c9b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fautoencoders-in-practice-dimensionality-reduction-and-image-denoising-ed9b9201e7e1&user=Ruben+Winastwan&userId=5dae9da73c9b&source=post_page-5dae9da73c9b----ed9b9201e7e1---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fed9b9201e7e1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fautoencoders-in-practice-dimensionality-reduction-and-image-denoising-ed9b9201e7e1&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fed9b9201e7e1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fautoencoders-in-practice-dimensionality-reduction-and-image-denoising-ed9b9201e7e1&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@jlwilkens?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Justin Wilkens"}, {"url": "https://unsplash.com/s/photos/twin?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://www.kaggle.com/andrewmvd/medical-mnist?select=BreastMRI", "anchor_text": "here"}, {"url": "https://github.com/marcellusruben/Autoencoder", "anchor_text": "here"}, {"url": "https://medium.com/tag/data-science?source=post_page-----ed9b9201e7e1---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----ed9b9201e7e1---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/computer-vision?source=post_page-----ed9b9201e7e1---------------computer_vision-----------------", "anchor_text": "Computer Vision"}, {"url": "https://medium.com/tag/autoencoder?source=post_page-----ed9b9201e7e1---------------autoencoder-----------------", "anchor_text": "Autoencoder"}, {"url": "https://medium.com/tag/dimensionality-reduction?source=post_page-----ed9b9201e7e1---------------dimensionality_reduction-----------------", "anchor_text": "Dimensionality Reduction"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fed9b9201e7e1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fautoencoders-in-practice-dimensionality-reduction-and-image-denoising-ed9b9201e7e1&user=Ruben+Winastwan&userId=5dae9da73c9b&source=-----ed9b9201e7e1---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fed9b9201e7e1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fautoencoders-in-practice-dimensionality-reduction-and-image-denoising-ed9b9201e7e1&user=Ruben+Winastwan&userId=5dae9da73c9b&source=-----ed9b9201e7e1---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fed9b9201e7e1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fautoencoders-in-practice-dimensionality-reduction-and-image-denoising-ed9b9201e7e1&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----ed9b9201e7e1--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fed9b9201e7e1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fautoencoders-in-practice-dimensionality-reduction-and-image-denoising-ed9b9201e7e1&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----ed9b9201e7e1---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----ed9b9201e7e1--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----ed9b9201e7e1--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----ed9b9201e7e1--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----ed9b9201e7e1--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----ed9b9201e7e1--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----ed9b9201e7e1--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----ed9b9201e7e1--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----ed9b9201e7e1--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@marcellusruben?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@marcellusruben?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Ruben Winastwan"}, {"url": "https://medium.com/@marcellusruben/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "925 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F5dae9da73c9b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fautoencoders-in-practice-dimensionality-reduction-and-image-denoising-ed9b9201e7e1&user=Ruben+Winastwan&userId=5dae9da73c9b&source=post_page-5dae9da73c9b--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F46c6747bd93b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fautoencoders-in-practice-dimensionality-reduction-and-image-denoising-ed9b9201e7e1&newsletterV3=5dae9da73c9b&newsletterV3Id=46c6747bd93b&user=Ruben+Winastwan&userId=5dae9da73c9b&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}