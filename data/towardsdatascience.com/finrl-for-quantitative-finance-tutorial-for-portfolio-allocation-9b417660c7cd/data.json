{"url": "https://towardsdatascience.com/finrl-for-quantitative-finance-tutorial-for-portfolio-allocation-9b417660c7cd", "time": 1683017674.019638, "path": "towardsdatascience.com/finrl-for-quantitative-finance-tutorial-for-portfolio-allocation-9b417660c7cd/", "webpage": {"metadata": {"title": "FinRL for Quantitative Finance: Tutorial for Portfolio Allocation | by Bruce Yang ByFinTech | Towards Data Science", "h1": "FinRL for Quantitative Finance: Tutorial for Portfolio Allocation", "description": "Note from Towards Data Science\u2019s editors: While we allow independent authors to publish articles in accordance with our rules and guidelines, we do not endorse each author\u2019s contribution. You should\u2026"}, "outgoing_paragraph_urls": [{"url": "https://towardsdatascience.com/questions-96667b06af5", "anchor_text": "rules and guidelines", "paragraph_index": 0}, {"url": "https://towardsdatascience.com/readers-terms-b5d780a700a4", "anchor_text": "Reader Terms", "paragraph_index": 0}, {"url": "https://github.com/AI4Finance-LLC/FinRL-Library", "anchor_text": "Github", "paragraph_index": 2}, {"url": "https://colab.research.google.com/github/AI4Finance-LLC/FinRL-Library/blob/master/FinRL_multiple_stock_trading.ipynb", "anchor_text": "Google Colab", "paragraph_index": 2}, {"url": "https://towardsdatascience.com/deep-reinforcement-learning-for-automated-stock-trading-f1dad0126a02", "anchor_text": "previous blog", "paragraph_index": 3}, {"url": "https://papers.ssrn.com/sol3/papers.cfm?abstract_id=2131932", "anchor_text": "mean-variance", "paragraph_index": 11}, {"url": "https://github.com/AI4Finance-LLC/FinRL-Library/blob/master/finrl/marketdata/yahoodownloader.py", "anchor_text": "YahooDownloader", "paragraph_index": 20}, {"url": "https://github.com/AI4Finance-LLC/FinRL-Library/blob/master/finrl/preprocessing/preprocessors.py", "anchor_text": "FeatureEngineer", "paragraph_index": 22}, {"url": "https://github.com/AI4Finance-LLC/FinRL-Library/blob/master/finrl/env/environment.py", "anchor_text": "EnvSetup", "paragraph_index": 23}, {"url": "https://github.com/AI4Finance-LLC/FinRL-Library/blob/master/finrl/model/models.py", "anchor_text": "DRLAgent", "paragraph_index": 25}, {"url": "https://arxiv.org/abs/1602.01783", "anchor_text": "A2C", "paragraph_index": 26}, {"url": "https://github.com/AI4Finance-LLC/FinRL-Library/blob/master/finrl/trade/backtest.py", "anchor_text": "set of functions", "paragraph_index": 28}, {"url": "https://github.com/quantopian/pyfolio", "anchor_text": "Quantopian pyfolio", "paragraph_index": 28}, {"url": "https://github.com/AI4Finance-Foundation/FinRL/issues", "anchor_text": "Github", "paragraph_index": 31}, {"url": "https://github.com/BruceYanghy", "anchor_text": "https://github.com/BruceYanghy", "paragraph_index": 33}], "all_paragraphs": ["Note from Towards Data Science\u2019s editors: While we allow independent authors to publish articles in accordance with our rules and guidelines, we do not endorse each author\u2019s contribution. You should not rely on an author\u2019s works without seeking professional advice. See our Reader Terms for details.", "This blog is a tutorial based on our paper: FinRL: A Deep Reinforcement Learning Library for Automated Stock Trading in Quantitative Finance, presented at NeurIPS 2020: Deep RL Workshop.", "The Jupyter notebook codes are available on our Github and Google Colab.", "A more complete application of FinRL for multiple stock trading can be found in our previous blog.", "To begin with, I would like to explain the logic of portfolio allocation using Deep Reinforcement Learning.", "We use Dow 30 constituents as an example throughout this article, because those are the most popular stocks.", "Let\u2019s say that we got a million dollars at the beginning of 2019. We want to invest this $1,000,000 into stock markets, in this case is Dow Jones 30 constituents.", "Assume that no margin, no short sale, no treasury bill (use all the money to trade only these 30 stocks). So that the weight of each individual stock is non-negative, and the weights of all the stocks add up to one.", "We hire a smart portfolio manager- Mr. Deep Reinforcement Learning. Mr. DRL will give us daily advice includes the portfolio weights or the proportions of money to invest in these 30 stocks. So every day we just need to rebalance the portfolio weights of the stocks.", "The basic logic is as follows.", "Portfolio allocation is different from multiple stock trading because we are essentially rebalancing the weights at each time step, and we have to use all available money.", "The traditional and the most popular way of doing portfolio allocation is mean-variance or modern portfolio theory (MPT):", "However, MPT performs not so well in out-of-sample data. MPT is calculated only based on stock returns, if we want to take other relevant factors into account, for example some of the technical indicators like MACD or RSI, MPT may not be able to combine these information together well.", "We introduce a DRL library FinRL that facilitates beginners to expose themselves to quantitative finance. FinRL is a DRL library designed specifically for automated stock trading with an effort for educational and demonstrative purpose.", "This article is focusing on one of the use cases in our paper: Portfolio Allocation. We use one Jupyter notebook to include all the necessary steps.", "This problem is to design an automated trading solution for portfolio allocation. We model the stock trading process as a Markov Decision Process (MDP). We then formulate our trading goal as a maximization problem.", "The components of the reinforcement learning environment are:", "Covariance matrix is a good feature because portfolio managers use it to quantify the risk (standard deviation) associated with a particular portfolio.", "We also assume no transaction cost, because we are trying to make a simple portfolio allocation case as a starting point.", "Install the unstable development version of FinRL:", "FinRL uses a YahooDownloader class to extract data.", "Download and save the data in a pandas DataFrame:", "FinRL uses a FeatureEngineer class to preprocess data.", "FinRL uses a EnvSetup class to setup environment.", "User-defined Environment: a simulation environment class.", "FinRL uses a DRLAgent class to implement the algorithms.", "We use A2C for portfolio allocation, because it is stable, cost-effective, faster and works better with large batch sizes.", "The output actions or the portfolio weights look like this:", "FinRL uses a set of functions to do the backtesting with Quantopian pyfolio.", "The left table is the stats for backtesting performance, the right table is the stats for Index (DJIA) performance.", "I hope you found this article helpful and learned something about using DRL for multiple stock trading!", "Please report any issues to our Github.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Chief Data Scientist, Educator | Quant, Fraud Detection | Guest Lecturer at Columbia University, Author of AI4Finance-Foundation https://github.com/BruceYanghy"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F9b417660c7cd&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffinrl-for-quantitative-finance-tutorial-for-portfolio-allocation-9b417660c7cd&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffinrl-for-quantitative-finance-tutorial-for-portfolio-allocation-9b417660c7cd&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffinrl-for-quantitative-finance-tutorial-for-portfolio-allocation-9b417660c7cd&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffinrl-for-quantitative-finance-tutorial-for-portfolio-allocation-9b417660c7cd&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----9b417660c7cd--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----9b417660c7cd--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://byfintech.medium.com/?source=post_page-----9b417660c7cd--------------------------------", "anchor_text": ""}, {"url": "https://byfintech.medium.com/?source=post_page-----9b417660c7cd--------------------------------", "anchor_text": "Bruce Yang ByFinTech"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fa878fc45fb3f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffinrl-for-quantitative-finance-tutorial-for-portfolio-allocation-9b417660c7cd&user=Bruce+Yang+ByFinTech&userId=a878fc45fb3f&source=post_page-a878fc45fb3f----9b417660c7cd---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F9b417660c7cd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffinrl-for-quantitative-finance-tutorial-for-portfolio-allocation-9b417660c7cd&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F9b417660c7cd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffinrl-for-quantitative-finance-tutorial-for-portfolio-allocation-9b417660c7cd&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://towardsdatascience.com/questions-96667b06af5", "anchor_text": "rules and guidelines"}, {"url": "https://towardsdatascience.com/readers-terms-b5d780a700a4", "anchor_text": "Reader Terms"}, {"url": "https://arxiv.org/abs/2011.09607", "anchor_text": "FinRL: A Deep Reinforcement Learning Library for Automated Stock Trading in Quantitative FinanceAs deep reinforcement learning (DRL) has been recognized as an effective approach in quantitative finance, getting\u2026arxiv.org"}, {"url": "https://github.com/AI4Finance-LLC/FinRL-Library", "anchor_text": "Github"}, {"url": "https://colab.research.google.com/github/AI4Finance-LLC/FinRL-Library/blob/master/FinRL_multiple_stock_trading.ipynb", "anchor_text": "Google Colab"}, {"url": "https://github.com/AI4Finance-Foundation/FinRL", "anchor_text": "GitHub - AI4Finance-Foundation/FinRL: Deep Reinforcement Learning Framework to Automate Trading in\u2026News: we plan to share our codes for both paper trading and live trading. Please share your interests. FinRL is an\u2026github.com"}, {"url": "https://github.com/AI4Finance-Foundation/FinRL/blob/master/FinRL_PortfolioAllocation_NeurIPS_2020.ipynb", "anchor_text": "FinRL/FinRL_PortfolioAllocation_NeurIPS_2020.ipynb at master \u00b7 AI4Finance-Foundation/FinRLFinRL: Financial Reinforcement Learning Framework.\ud83d\udd25 - FinRL/FinRL_PortfolioAllocation_NeurIPS_2020.ipynb at master \u00b7\u2026github.com"}, {"url": "https://towardsdatascience.com/deep-reinforcement-learning-for-automated-stock-trading-f1dad0126a02", "anchor_text": "previous blog"}, {"url": "https://papers.ssrn.com/sol3/papers.cfm?abstract_id=2131932", "anchor_text": "mean-variance"}, {"url": "https://github.com/AI4Finance-LLC/FinRL-Library/blob/master/finrl/marketdata/yahoodownloader.py", "anchor_text": "YahooDownloader"}, {"url": "https://github.com/AI4Finance-LLC/FinRL-Library/blob/master/finrl/preprocessing/preprocessors.py", "anchor_text": "FeatureEngineer"}, {"url": "https://github.com/AI4Finance-LLC/FinRL-Library/blob/master/finrl/env/environment.py", "anchor_text": "EnvSetup"}, {"url": "https://github.com/AI4Finance-LLC/FinRL-Library/blob/master/finrl/env/EnvPortfolio.py", "anchor_text": "portfolio allocation"}, {"url": "https://github.com/AI4Finance-LLC/FinRL-Library/blob/master/finrl/model/models.py", "anchor_text": "DRLAgent"}, {"url": "https://arxiv.org/abs/1602.01783", "anchor_text": "A2C"}, {"url": "https://github.com/AI4Finance-LLC/FinRL-Library/blob/master/finrl/trade/backtest.py", "anchor_text": "set of functions"}, {"url": "https://github.com/quantopian/pyfolio", "anchor_text": "Quantopian pyfolio"}, {"url": "https://github.com/AI4Finance-Foundation/FinRL/issues", "anchor_text": "Github"}, {"url": "https://arxiv.org/abs/1706.10059", "anchor_text": "A Deep Reinforcement Learning Framework for the Financial Portfolio Management ProblemFinancial portfolio management is the process of constant redistribution of a fund into different financial products\u2026arxiv.org"}, {"url": "https://github.com/ZhengyaoJiang/PGPortfolio", "anchor_text": "ZhengyaoJiang/PGPortfolioThis is the original implementation of our paper, A Deep Reinforcement Learning Framework for the Financial Portfolio\u2026github.com"}, {"url": "https://github.com/OLPS/OLPS", "anchor_text": "OLPS/OLPSOLPS is an open-source toolbox for On-Line Portfolio Selection, which includes a collection of classical and\u2026github.com"}, {"url": "https://medium.com/tag/portfolio-allocation?source=post_page-----9b417660c7cd---------------portfolio_allocation-----------------", "anchor_text": "Portfolio Allocation"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----9b417660c7cd---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/deep-reinforcement?source=post_page-----9b417660c7cd---------------deep_reinforcement-----------------", "anchor_text": "Deep Reinforcement"}, {"url": "https://medium.com/tag/stock-trading?source=post_page-----9b417660c7cd---------------stock_trading-----------------", "anchor_text": "Stock Trading"}, {"url": "https://medium.com/tag/markov-decision-process?source=post_page-----9b417660c7cd---------------markov_decision_process-----------------", "anchor_text": "Markov Decision Process"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F9b417660c7cd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffinrl-for-quantitative-finance-tutorial-for-portfolio-allocation-9b417660c7cd&user=Bruce+Yang+ByFinTech&userId=a878fc45fb3f&source=-----9b417660c7cd---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F9b417660c7cd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffinrl-for-quantitative-finance-tutorial-for-portfolio-allocation-9b417660c7cd&user=Bruce+Yang+ByFinTech&userId=a878fc45fb3f&source=-----9b417660c7cd---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F9b417660c7cd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffinrl-for-quantitative-finance-tutorial-for-portfolio-allocation-9b417660c7cd&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----9b417660c7cd--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F9b417660c7cd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffinrl-for-quantitative-finance-tutorial-for-portfolio-allocation-9b417660c7cd&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----9b417660c7cd---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----9b417660c7cd--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----9b417660c7cd--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----9b417660c7cd--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----9b417660c7cd--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----9b417660c7cd--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----9b417660c7cd--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----9b417660c7cd--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----9b417660c7cd--------------------------------", "anchor_text": ""}, {"url": "https://byfintech.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://byfintech.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Bruce Yang ByFinTech"}, {"url": "https://byfintech.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "1.3K Followers"}, {"url": "https://github.com/BruceYanghy", "anchor_text": "https://github.com/BruceYanghy"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fa878fc45fb3f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffinrl-for-quantitative-finance-tutorial-for-portfolio-allocation-9b417660c7cd&user=Bruce+Yang+ByFinTech&userId=a878fc45fb3f&source=post_page-a878fc45fb3f--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F6ca58a53196a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffinrl-for-quantitative-finance-tutorial-for-portfolio-allocation-9b417660c7cd&newsletterV3=a878fc45fb3f&newsletterV3Id=6ca58a53196a&user=Bruce+Yang+ByFinTech&userId=a878fc45fb3f&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}