{"url": "https://towardsdatascience.com/datasciencegeography-29a12667c22c", "time": 1683001418.781715, "path": "towardsdatascience.com/datasciencegeography-29a12667c22c/", "webpage": {"metadata": {"title": "How To Engineer Features with Geography | by Nadim Kawwa | Towards Data Science", "h1": "How To Engineer Features with Geography", "description": "Every business that sells goods or services has a physical address. There is no doubt that location can make or break a business. For data scientists, extracting geodetic features, features relating\u2026"}, "outgoing_paragraph_urls": [{"url": "https://en.wikipedia.org/wiki/Geodesy", "anchor_text": "geodetic", "paragraph_index": 0}, {"url": "https://www.yelp.com/dataset", "anchor_text": "Yelp Dataset", "paragraph_index": 1}, {"url": "https://www.yelp.com/dataset/documentation/main", "anchor_text": "business.json", "paragraph_index": 1}, {"url": "https://www.amazon.com/Handbook-Mathematics-I-N-Bronshtein/dp/3540721215", "anchor_text": "Handbook of Mathematics by Bronshtein, Semendyayev, Musiol, M\u00fchlig", "paragraph_index": 2}, {"url": "http://www.fulviofrisone.com/attachments/article/453/Springer%20-%20Handbook%20Of%20Mathematics,%20Fifth%20Edition%20(2007).pdf", "anchor_text": "link to PDF", "paragraph_index": 2}, {"url": "http://janmatuschek.de/LatitudeLongitudeBoundingCoordinates#RefBronstein", "anchor_text": "summary", "paragraph_index": 2}, {"url": "http://janmatuschek.de/Contact", "anchor_text": "Jan Philip Matuschek", "paragraph_index": 2}, {"url": "https://www.yelp.com/dataset/documentation/main", "anchor_text": "documentation", "paragraph_index": 3}, {"url": "https://en.wikipedia.org/wiki/Earth_radius", "anchor_text": "6357 kilometers", "paragraph_index": 7}, {"url": "https://en.wikipedia.org/wiki/Geographic_coordinate_system", "anchor_text": "geographic coordinate system", "paragraph_index": 7}, {"url": "https://en.wikipedia.org/wiki/Surveying", "anchor_text": "land surveying", "paragraph_index": 7}, {"url": "https://en.wikipedia.org/wiki/Latitude", "anchor_text": "latitude", "paragraph_index": 8}, {"url": "https://en.wikipedia.org/wiki/Longitude", "anchor_text": "longitude", "paragraph_index": 8}, {"url": "https://en.wikipedia.org/wiki/Great-circle_distance", "anchor_text": "orthodromic distance", "paragraph_index": 10}, {"url": "https://en.wikipedia.org/wiki/Angular_diameter", "anchor_text": "angular radius", "paragraph_index": 12}, {"url": "https://en.wikipedia.org/wiki/Sphere", "anchor_text": "sphere", "paragraph_index": 12}, {"url": "https://en.wikipedia.org/wiki/Circle", "anchor_text": "circle", "paragraph_index": 12}, {"url": "https://en.wikipedia.org/wiki/Feature_scaling#Standardization_(Z-score_Normalization)", "anchor_text": "standardize", "paragraph_index": 21}, {"url": "https://en.wikipedia.org/wiki/Normal_distribution", "anchor_text": "Gaussian Distribution", "paragraph_index": 22}, {"url": "https://en.wikipedia.org/wiki/Multimodal_distribution", "anchor_text": "bimodal", "paragraph_index": 23}, {"url": "https://en.wikipedia.org/wiki/Feature_selection", "anchor_text": "important features", "paragraph_index": 27}], "all_paragraphs": ["Every business that sells goods or services has a physical address. There is no doubt that location can make or break a business. For data scientists, extracting geodetic features, features relating to the Earth\u2019s geometric shape, can provide clear insights and a significant increase in performance of machine learning models.", "In this article we are going to use the Yelp Dataset, specifically the business.json file to extract features dependent on location.", "We will also draw from the Handbook of Mathematics by Bronshtein, Semendyayev, Musiol, M\u00fchlig (link to PDF) and the corresponding summary by Jan Philip Matuschek", "The Yelp documentation gives a good overview of the features, below is a brief snippet.", "Certain areas tend to be highly developed and have a lot businesses. In addition, businesses that are similar tend to be clustered close together.", "For example the business above is located in San Francisco\u2019s SoMA neighborhood (and has great guacamole), and has many other restaurants clustered around it.", "We will be using the latitude and longitude to query the dataframe for businesses around it. To do so we need a geography refresher.", "The Earth is an imperfect sphere with an an approximate radius of 6357 kilometers. The geographic coordinate system is a method that allows to locate points on the spheres and is often used in land surveying among other professions.", "We define latitude as an angle which ranges from zero degrees at the equator to 90 degrees at the poles. Conversely, longitude runs from pole to pole and ranges from 0 to 180 degrees. The picture below illustrates these two concepts on a sphere.", "Now that we have our coordinate system defined, we need a method that defines a bounding box around a point of interest and grabs all points in a delimited area around it.", "As a first approach we can calculate the orthodromic distance between two points P(lat1, long1) and Q(lat2, long2) on a sphere with radius R :", "This method is prohibitively slow since it means calculating the distance between a point and all others for all points within the dataset.", "A better approach the angular radius to describe how large a sphere or circle appears from a given point of view. For example if we want to cover a distance d on a sphere of radius R then the angular radius r is:", "We then define the nodes that completely enclose the area captured by the angular radius. Moving along the latitude means we can move along a meridian, keeping the longitude fixed. Therefore the bounding latitude is defined as:", "Moving along a circle of latitude in order to find the bounding longitude does not work in the same way as above. In the image below the points T1 and T2 have the maximum and minimum longitude respectively. They are not on the same circle of latitude as the point of interest M, but are closer to the pole.", "The latitude of T1 and T2 is:", "Therefore the limiting longitudes are calculated as follows:", "We can interpret the methodology above in python code:", "In the example of Garaje, our code will return a dataframe that lists all businesses within a d_query=2km radius from Garaje per the image below:", "Given a dataframe like the one we have, we can write a code that returns a copy (note: not a view) of a geographically bounded dataframe", "What can we extract from this information? It turns out we can learn quite a lot:", "When doing comparisons, it is often a good idea to scale the features. For example when comparing prices we can standardize (z score normalization) the price by using the mean and standard deviation of the queried dataframe.", "As a first feature we can plot the standardized star rating of each entry against its closest neighbors. It appears to be a Gaussian Distribution, such that most businesses in one neighborhood are fairly homogenous in terms of rating.", "The price comparison appears to be bimodal, a more detailed analysis might make the query more stringent to only include businesses of the same type.", "We define density as the count of businesses within the bounded box. There is no need to do any standardization for this feature.", "Note that the plot below will vary a lot depending on the query radius and the amount of development in the area.", "Proper feature engineering can give your machine learning model the edge it needs to perform better. By taking geography into account we can derive features that are dependent on location.", "In the case of the Yelp dataset the AUC for each model improved by at least 5% when plugging in geodetic features. They also appeared at least once in the top 5 most important features across all algorithms!", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F29a12667c22c&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdatasciencegeography-29a12667c22c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdatasciencegeography-29a12667c22c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdatasciencegeography-29a12667c22c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdatasciencegeography-29a12667c22c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----29a12667c22c--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----29a12667c22c--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@nadimkawwa?source=post_page-----29a12667c22c--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@nadimkawwa?source=post_page-----29a12667c22c--------------------------------", "anchor_text": "Nadim Kawwa"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F85e7e8816e35&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdatasciencegeography-29a12667c22c&user=Nadim+Kawwa&userId=85e7e8816e35&source=post_page-85e7e8816e35----29a12667c22c---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F29a12667c22c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdatasciencegeography-29a12667c22c&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F29a12667c22c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdatasciencegeography-29a12667c22c&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@marjan_blan?utm_source=medium&utm_medium=referral", "anchor_text": "\u041c\u0430\u0440\u044c\u044f\u043d \u0411\u043b\u0430\u043d | @marjanblan"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://en.wikipedia.org/wiki/Geodesy", "anchor_text": "geodetic"}, {"url": "https://www.yelp.com/dataset", "anchor_text": "Yelp Dataset"}, {"url": "https://www.yelp.com/dataset/documentation/main", "anchor_text": "business.json"}, {"url": "https://www.amazon.com/Handbook-Mathematics-I-N-Bronshtein/dp/3540721215", "anchor_text": "Handbook of Mathematics by Bronshtein, Semendyayev, Musiol, M\u00fchlig"}, {"url": "http://www.fulviofrisone.com/attachments/article/453/Springer%20-%20Handbook%20Of%20Mathematics,%20Fifth%20Edition%20(2007).pdf", "anchor_text": "link to PDF"}, {"url": "http://janmatuschek.de/LatitudeLongitudeBoundingCoordinates#RefBronstein", "anchor_text": "summary"}, {"url": "http://janmatuschek.de/Contact", "anchor_text": "Jan Philip Matuschek"}, {"url": "https://www.yelp.com/dataset/documentation/main", "anchor_text": "documentation"}, {"url": "https://en.wikipedia.org/wiki/Earth_radius", "anchor_text": "6357 kilometers"}, {"url": "https://en.wikipedia.org/wiki/Geographic_coordinate_system", "anchor_text": "geographic coordinate system"}, {"url": "https://en.wikipedia.org/wiki/Surveying", "anchor_text": "land surveying"}, {"url": "https://en.wikipedia.org/wiki/Latitude", "anchor_text": "latitude"}, {"url": "https://en.wikipedia.org/wiki/Longitude", "anchor_text": "longitude"}, {"url": "https://en.wikipedia.org/wiki/Geographic_coordinate_system", "anchor_text": "https://en.wikipedia.org/wiki/Geographic_coordinate_system"}, {"url": "https://en.wikipedia.org/wiki/Great-circle_distance", "anchor_text": "orthodromic distance"}, {"url": "https://en.wikipedia.org/wiki/Angular_diameter", "anchor_text": "angular radius"}, {"url": "https://en.wikipedia.org/wiki/Sphere", "anchor_text": "sphere"}, {"url": "https://en.wikipedia.org/wiki/Circle", "anchor_text": "circle"}, {"url": "http://janmatuschek.de/Contact", "anchor_text": "Jan Philip Matuschek"}, {"url": "https://www.mapdevelopers.com/draw-circle-tool.php", "anchor_text": "https://www.mapdevelopers.com/draw-circle-tool.php"}, {"url": "https://en.wikipedia.org/wiki/Feature_scaling#Standardization_(Z-score_Normalization)", "anchor_text": "standardize"}, {"url": "https://en.wikipedia.org/wiki/Normal_distribution", "anchor_text": "Gaussian Distribution"}, {"url": "https://en.wikipedia.org/wiki/Multimodal_distribution", "anchor_text": "bimodal"}, {"url": "https://en.wikipedia.org/wiki/Feature_selection", "anchor_text": "important features"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----29a12667c22c---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----29a12667c22c---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/programming?source=post_page-----29a12667c22c---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/tag/education?source=post_page-----29a12667c22c---------------education-----------------", "anchor_text": "Education"}, {"url": "https://medium.com/tag/business?source=post_page-----29a12667c22c---------------business-----------------", "anchor_text": "Business"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F29a12667c22c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdatasciencegeography-29a12667c22c&user=Nadim+Kawwa&userId=85e7e8816e35&source=-----29a12667c22c---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F29a12667c22c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdatasciencegeography-29a12667c22c&user=Nadim+Kawwa&userId=85e7e8816e35&source=-----29a12667c22c---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F29a12667c22c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdatasciencegeography-29a12667c22c&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----29a12667c22c--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F29a12667c22c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdatasciencegeography-29a12667c22c&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----29a12667c22c---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----29a12667c22c--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----29a12667c22c--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----29a12667c22c--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----29a12667c22c--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----29a12667c22c--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----29a12667c22c--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----29a12667c22c--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----29a12667c22c--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@nadimkawwa?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@nadimkawwa?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Nadim Kawwa"}, {"url": "https://medium.com/@nadimkawwa/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "281 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F85e7e8816e35&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdatasciencegeography-29a12667c22c&user=Nadim+Kawwa&userId=85e7e8816e35&source=post_page-85e7e8816e35--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F245ed41488d0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdatasciencegeography-29a12667c22c&newsletterV3=85e7e8816e35&newsletterV3Id=245ed41488d0&user=Nadim+Kawwa&userId=85e7e8816e35&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}