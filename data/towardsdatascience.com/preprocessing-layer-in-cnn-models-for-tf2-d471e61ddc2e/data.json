{"url": "https://towardsdatascience.com/preprocessing-layer-in-cnn-models-for-tf2-d471e61ddc2e", "time": 1683004087.803157, "path": "towardsdatascience.com/preprocessing-layer-in-cnn-models-for-tf2-d471e61ddc2e/", "webpage": {"metadata": {"title": "Preprocessing Layer in CNN models for TensorFlow2 | by Michal Lukac | Towards Data Science", "h1": "Preprocessing Layer in CNN models for TensorFlow2", "description": "Technique to make CNN models less prone to errors and more accessible for TensorFlow developers"}, "outgoing_paragraph_urls": [], "all_paragraphs": ["One of the most common mistakes which are novice machine learning practitioners doing is forget to normalize input images. No wonder! Every model requires different input normalization when you are doing Transfer Learning. VGG, for example, requires to subtract this vector [123.68, 116.779, 103.939] from the RGB image. MobileNetV2 requires inputs from interval <-1,1>. PyTorch models often use different normalization methods. This tip can save you a lot of time and bugs in the future. Instead of doing normalization before inputting images to the model, you can simply add this layer inside your model (computation graph).", "With old TensorFlow 1 (rest in peace) you could simply add preprocessing operation to the graph and freeze this model. However, in TensorFlow 2+ you need to create your own preprocessing layer.", "So first define our preprocess method (this one is for MobileNetV2):", "Then create your custom layer inheriting from tf.keras.layers.Layer and use the function in the call method on the input:", "When creating a model then insert the layer before calling the base model of a pre-trained model (functional API of tf.keras):", "From now, your model always accepts just RGB [0, 255] images and the normalization of input is done inside the model. If you saved such a model in Keras .h5 format then do not forget to specify custom objects during the model loading. I always recommend saving models in the SavedModel or TFLITE format because everything is frozen in the model and ready to deploy!", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Co-Founder & Machine Learning developer at Ximilar. Writting about AI, Computer Vision and Value Stock Investing."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fd471e61ddc2e&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpreprocessing-layer-in-cnn-models-for-tf2-d471e61ddc2e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpreprocessing-layer-in-cnn-models-for-tf2-d471e61ddc2e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpreprocessing-layer-in-cnn-models-for-tf2-d471e61ddc2e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpreprocessing-layer-in-cnn-models-for-tf2-d471e61ddc2e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----d471e61ddc2e--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----d471e61ddc2e--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@michallukac?source=post_page-----d471e61ddc2e--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@michallukac?source=post_page-----d471e61ddc2e--------------------------------", "anchor_text": "Michal Lukac"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F29aac4d477c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpreprocessing-layer-in-cnn-models-for-tf2-d471e61ddc2e&user=Michal+Lukac&userId=29aac4d477c&source=post_page-29aac4d477c----d471e61ddc2e---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fd471e61ddc2e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpreprocessing-layer-in-cnn-models-for-tf2-d471e61ddc2e&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fd471e61ddc2e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpreprocessing-layer-in-cnn-models-for-tf2-d471e61ddc2e&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://www.pexels.com/photo/asphalt-balance-blur-close-up-268018/", "anchor_text": "pexels.com"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----d471e61ddc2e---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----d471e61ddc2e---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/data-science?source=post_page-----d471e61ddc2e---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/programming?source=post_page-----d471e61ddc2e---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/tag/tensorflow?source=post_page-----d471e61ddc2e---------------tensorflow-----------------", "anchor_text": "TensorFlow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fd471e61ddc2e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpreprocessing-layer-in-cnn-models-for-tf2-d471e61ddc2e&user=Michal+Lukac&userId=29aac4d477c&source=-----d471e61ddc2e---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fd471e61ddc2e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpreprocessing-layer-in-cnn-models-for-tf2-d471e61ddc2e&user=Michal+Lukac&userId=29aac4d477c&source=-----d471e61ddc2e---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fd471e61ddc2e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpreprocessing-layer-in-cnn-models-for-tf2-d471e61ddc2e&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----d471e61ddc2e--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fd471e61ddc2e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpreprocessing-layer-in-cnn-models-for-tf2-d471e61ddc2e&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----d471e61ddc2e---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----d471e61ddc2e--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----d471e61ddc2e--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----d471e61ddc2e--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----d471e61ddc2e--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----d471e61ddc2e--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----d471e61ddc2e--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----d471e61ddc2e--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----d471e61ddc2e--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@michallukac?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@michallukac?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Michal Lukac"}, {"url": "https://medium.com/@michallukac/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "140 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F29aac4d477c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpreprocessing-layer-in-cnn-models-for-tf2-d471e61ddc2e&user=Michal+Lukac&userId=29aac4d477c&source=post_page-29aac4d477c--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F1d3e0426cfaa&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpreprocessing-layer-in-cnn-models-for-tf2-d471e61ddc2e&newsletterV3=29aac4d477c&newsletterV3Id=1d3e0426cfaa&user=Michal+Lukac&userId=29aac4d477c&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}