{"url": "https://towardsdatascience.com/how-to-set-up-docker-for-deep-learning-on-aws-bce751eaf662", "time": 1683009046.1689868, "path": "towardsdatascience.com/how-to-set-up-docker-for-deep-learning-on-aws-bce751eaf662/", "webpage": {"metadata": {"title": "Docker For Deep Learning on AWS | Towards Data Science", "h1": "How to Set Up Docker for Deep Learning on AWS", "description": "This post will help you set up a GPU enabled Docker container on an AWS EC2 instance for Deep Learning. We'll also cover how to access the Dockerized Jupyter server from your local machine."}, "outgoing_paragraph_urls": [{"url": "https://towardsdatascience.com/how-docker-can-help-you-become-a-more-effective-data-scientist-7fc048ef91d5", "anchor_text": "this excellent post", "paragraph_index": 2}, {"url": "https://github.com/NVIDIA/nvidia-docker", "anchor_text": "nvidia/cuda", "paragraph_index": 6}, {"url": "https://hub.docker.com", "anchor_text": "docker hub", "paragraph_index": 17}], "all_paragraphs": ["This post will help you set up a GPU enabled Docker container on an AWS EC2 instance for Deep Learning. We\u2019ll also cover how to access a Jupyter server running inside the container from your local machine.", "Why? One of my favourite things about Docker is that it allows you to easily reproduce your local development environment on a remote machine. This comes in real handy whenever you need to train a model on a GPU.", "This post assumes some familiarity with building Docker images and launching EC2 instances on AWS. For a primer on Docker and how it can help improve your Data Science workflow, check out this excellent post.", "TL;DR: Use nvidia/cuda as your base image and pass the --gpus all flag when launching a container.", "The working directory for this post will be your project\u2019s local git repository. While not a strict prerequisite of our goal of setting up a GPU enabled Docker container on AWS, it will make your life much easier by allowing you to simply git clone your GitHub repo on your EC2 instance.", "The first step is to build the image we need to train a Deep Learning model. We\u2019ll do that by adding the following Dockerfile to our repository.", "The key component of this Dockerfile is the nvidia/cuda base image, which does all of the leg work needed for a container to access system GPUs.", "Your requirements file should contain all of the packages you need to train your model and will need to include Jupyter for the last CMD to work. If you have a script that trains your model, just replace the above CMD with the command that runs your script.", "Bonus \ud83d\udc7b: You can also enable your favourite Jupyter extensions by adding RUN jupyter contrib nbextension install after the requirements step.", "The next step is to launch an EC2 instance and ssh into it. Your instance needs to have Docker and nvidia-docker installed. The easiest option is to choose an ubuntu Deep Learning AMI, which comes with both installed.", "Once you\u2019ve chosen your instance\u2019s AMI, select an instance type with a GPU. Sadly, they\u2019re not cheap. At the time of writing this, a p2.xlarge instance in us-west-2 will cost you $0.90/hour \ud83d\ude2d.", "At the review page before you launch your instance, edit the security groups to open up port 8888 so that we can connect to the Jupyter server running inside the container from our local machine.", "Check that your review page looks like this and launch your instance.", "Once your instance is up and running, ssh into it by running this command on your local terminal:", "You can find your user and ec2-hostname by selecting your instance and clicking Connect on the AWS Console. If you chose an Ubuntu image, it will look something like ubuntu@ec2\u2013XXX.us-west-2.compute.amazonaws.com.", "Now that we\u2019ve connected to a running EC2 instance, it\u2019s time to build our Docker image. At your instance\u2019s command-line, clone your GitHub repo:", "Then cd into it and run this command to build your Docker image:", "Bonus \ud83d\udc7b: If you have a pre-built image stored in a container registry like docker hub you can pull your image with docker pull, which can save time if your image takes a while to build.", "With our image built, we\u2019re ready to launch our container \ud83d\ude80. At your instance\u2019s command-line, run:", "The key bit is the --gpus flag, which gives the container access to your instance\u2019s GPUs (thanks to nvidia-docker). As for the rest,", "The above command both starts a container and launches the Jupyter server inside of it (thanks to the last CMD in our Dockerfile). You\u2019ll see the ID of the container printed to the screen. Copy that and run the next command to get the access token for the Jupyter server:", "Copy the printed access token and head back to your local command-line.", "Congrats! You\u2019ve done all of the hard work to set up a running GPU enabled container on a remote AWS instance. The last step is to forward a local port on your machine to the Jupyter server running inside the container :", "The above command forwards port 8080 on your machine to localhost:8888 on your EC2 instance, where the Jupyter server is running.", "Since port 8888 is the default port for Jupyter, we forwarded port 8080 to avoid clashing with any notebooks running on our local machine.", "Now navigate to localhost:8080 in your browser and paste the Jupyter access token from the previous step.", "Ta-dah \ud83c\udf89! You\u2019re now talking to a Jupyter server running inside a GPU enabled Docker container on a remote EC2 instance.", "If you\u2019re working with PyTorch, you can check that cuda is available with:", "I hope this post will help ease your development workflow when it comes to training Deep Learning models. Incorporating Docker into your everyday workflow takes time, but it\u2019ll save future you lots of headaches and time spent trying to reproduce your local environment in a remote setting.", "P.S. Remember to shut down your p2.xlarge instance when you\u2019re done!", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fbce751eaf662&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-set-up-docker-for-deep-learning-on-aws-bce751eaf662&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-set-up-docker-for-deep-learning-on-aws-bce751eaf662&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-set-up-docker-for-deep-learning-on-aws-bce751eaf662&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-set-up-docker-for-deep-learning-on-aws-bce751eaf662&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----bce751eaf662--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----bce751eaf662--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@msarmi9?source=post_page-----bce751eaf662--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@msarmi9?source=post_page-----bce751eaf662--------------------------------", "anchor_text": "Matthew Sarmiento"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F79ad6523fbe&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-set-up-docker-for-deep-learning-on-aws-bce751eaf662&user=Matthew+Sarmiento&userId=79ad6523fbe&source=post_page-79ad6523fbe----bce751eaf662---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fbce751eaf662&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-set-up-docker-for-deep-learning-on-aws-bce751eaf662&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fbce751eaf662&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-set-up-docker-for-deep-learning-on-aws-bce751eaf662&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://blog.pridybailo.com/docker-and-nvidia-gpus/", "anchor_text": "https://blog.pridybailo.com/docker-and-nvidia-gpus/"}, {"url": "https://towardsdatascience.com/how-docker-can-help-you-become-a-more-effective-data-scientist-7fc048ef91d5", "anchor_text": "this excellent post"}, {"url": "https://github.com/NVIDIA/nvidia-docker", "anchor_text": "nvidia/cuda"}, {"url": "https://hub.docker.com", "anchor_text": "docker hub"}, {"url": "https://medium.com/tag/data-science?source=post_page-----bce751eaf662---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----bce751eaf662---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/docker?source=post_page-----bce751eaf662---------------docker-----------------", "anchor_text": "Docker"}, {"url": "https://medium.com/tag/aws?source=post_page-----bce751eaf662---------------aws-----------------", "anchor_text": "AWS"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----bce751eaf662---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fbce751eaf662&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-set-up-docker-for-deep-learning-on-aws-bce751eaf662&user=Matthew+Sarmiento&userId=79ad6523fbe&source=-----bce751eaf662---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fbce751eaf662&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-set-up-docker-for-deep-learning-on-aws-bce751eaf662&user=Matthew+Sarmiento&userId=79ad6523fbe&source=-----bce751eaf662---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fbce751eaf662&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-set-up-docker-for-deep-learning-on-aws-bce751eaf662&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----bce751eaf662--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fbce751eaf662&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-set-up-docker-for-deep-learning-on-aws-bce751eaf662&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----bce751eaf662---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----bce751eaf662--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----bce751eaf662--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----bce751eaf662--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----bce751eaf662--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----bce751eaf662--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----bce751eaf662--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----bce751eaf662--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----bce751eaf662--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@msarmi9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@msarmi9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Matthew Sarmiento"}, {"url": "https://medium.com/@msarmi9/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "311 Followers"}, {"url": "https://msarmi9.github.io", "anchor_text": "https://msarmi9.github.io"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F79ad6523fbe&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-set-up-docker-for-deep-learning-on-aws-bce751eaf662&user=Matthew+Sarmiento&userId=79ad6523fbe&source=post_page-79ad6523fbe--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F56c0d3c50de6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-set-up-docker-for-deep-learning-on-aws-bce751eaf662&newsletterV3=79ad6523fbe&newsletterV3Id=56c0d3c50de6&user=Matthew+Sarmiento&userId=79ad6523fbe&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}