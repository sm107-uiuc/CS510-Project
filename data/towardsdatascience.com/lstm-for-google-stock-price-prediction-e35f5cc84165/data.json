{"url": "https://towardsdatascience.com/lstm-for-google-stock-price-prediction-e35f5cc84165", "time": 1683005501.130188, "path": "towardsdatascience.com/lstm-for-google-stock-price-prediction-e35f5cc84165/", "webpage": {"metadata": {"title": "LSTM for stock price prediction | Towards Data Science", "h1": "LSTM for Stock Price Prediction", "description": "Technical Walk-through on LSTM-based Recurrent Neural Network Creation for Google Stock Price Prediction"}, "outgoing_paragraph_urls": [{"url": "https://github.com/luke4u/Time_Series_Forecasting", "anchor_text": "Github", "paragraph_index": 30}], "all_paragraphs": ["In this article, I will walk through how to build an LSTM-based Recurrent Neural Network (RNN) to predict Google stock price step by step. It is split into 7 parts as below.", "We are given Google stock price from 01/2012 to 12/2016. The task is to predict the trend of the stock price for 01/2017. Note that, based on Brownian Motion, the future variations of stock price are independent of the past. So, it is impossible to predict the exact stock price, but possible to predict and capture the upward and downward trends.", "The train/test data is saved in .csv files, respectively. We will use Open price for prediction. Figure 1 shows a snippet of the training set and its scatter plot.", "Note the index range in dataset_train.iloc[:, 1: 2].values because we need to make it NumPy array, not a single vector nor a dataframe for training.", "The next step is to scale the stock prices between (0, 1) to avoid intensive computation. Common methods include Standardization and Normalization as shown in Figure 2. It is recommended to take Normalization, particularly when working on RNN with a Sigmoid function in the output layer.", "Creating a sliding window is important!", "A special data structure is needed to cover 60-time stamps, based on which RNN will predict the 61st price. Here the number of past timestamps is set to 60 based on experimentation. Thus, X_train is a nested list, which contains lists of 60 time-stamp prices. y_train is a list of stock prices which is the next day stock price, corresponding to each list in X_train. Specifically,", "Figure 3 shows a snippet of X_train and y_train. Each row in X_train with 60 prices is used to predict the corresponding next-day stock price in y_train.", "As stated above, we use Open price for prediction. Namely, we only have one indicator or feature. But we can add more indicators following the same data processing methods. To do that, we need to add a new dimension for number of indicators. Specifically,", "newshape is in (batch size, number of timestamps, number of indicators). (batch size, number of timestamps) is the shape of X_train. Here we only have 1 indicator.", "Great. We got the training set ready \u270c\u270c.", "Fundamentally, we are building a NN regressor for continuous value prediction using LSTM. First, initialize the model.", "Then, add the 1st LSTM layer with the Dropout layer followed.", "Note for the LSTM layer, units is the number of LSTM neurons in the layer. 50 neurons will give the model high dimensionality, enough to capture the upwards and downward trends. return_sequences is True as we need to add another LSTM layer after the current one. input_shape corresponds to the number of time stamps and the number of indicators. For dropout, 20% of 50 neurons will be ignored randomly during each iteration of training.", "Following the above same method, add 2nd, 3rd, and 4th LSTM layer.", "Note the last LSTM layer, return_sequences is False as we will not add more LSTM layers.", "Finally, add the output layer. The output dimension is 1 since we are predicting 1 price each time.", "Great! We have created an LSTM based RNN model \ud83e\udde8\ud83e\udde8.", "Now, let\u2019s compile the RNN by choosing an SGD algorithm and a loss function. For optimizer, we use Adam, a safe choice to start with. The loss function is the mean of squared errors between actual values and predictions.", "RNN weights are updated every 32 stock prices with a batch size of 32. Feel free to try more batches and epochs if the loss of the model is not converging.", "Using the same method in Section 2.1, read in test data.", "First, we need to concatenate the train and test datasets for prediction, because we use the previous 60 days\u2019 stock prices to predict the next-day price. In another word, we need the 60 days\u2019 price before the 1st date in the test dataset.", "Then, create the input for prediction, index starting from the date 60 days before the first date in the test dataset.", "Third, reshape the inputs to have only 1 column.", "Fourth, using the scale set by the training set, scale the test inputs.", "Finally, create the test data structure as in Section 2.3.", "Now, X_test is ready for prediction.", "Don\u2019t forget, what we have predicted is the scaled values, so we need to reverse the prediction.", "In the last step, let\u2019s create a visualization plot to easily review the prediction.", "As Fig.4 and 5 shows, prediction lags behind the real values, because the model cannot react fast to non-linear changes. But on the other hand, the model reacts well to smooth changes. So, we conclude in the parts of prediction which contain spikes, the model lags behind the actual prices, but in the parts that contain smooth changes, the model manages to follow upwards and downward trends \u2728\u2728.", "Great! That\u2019s all of the journeys! If you need the source code, visit my Github page \ud83e\udd1e\ud83e\udd1e .", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "ML Enthusiast, Data Scientist, Python Developer. Love to share articles about technology."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fe35f5cc84165&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flstm-for-google-stock-price-prediction-e35f5cc84165&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flstm-for-google-stock-price-prediction-e35f5cc84165&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flstm-for-google-stock-price-prediction-e35f5cc84165&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flstm-for-google-stock-price-prediction-e35f5cc84165&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----e35f5cc84165--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----e35f5cc84165--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://lukesun.medium.com/?source=post_page-----e35f5cc84165--------------------------------", "anchor_text": ""}, {"url": "https://lukesun.medium.com/?source=post_page-----e35f5cc84165--------------------------------", "anchor_text": "Luke Sun"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F7b5b79d21508&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flstm-for-google-stock-price-prediction-e35f5cc84165&user=Luke+Sun&userId=7b5b79d21508&source=post_page-7b5b79d21508----e35f5cc84165---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe35f5cc84165&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flstm-for-google-stock-price-prediction-e35f5cc84165&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe35f5cc84165&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flstm-for-google-stock-price-prediction-e35f5cc84165&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/photos/69ppqHiG9Xo", "anchor_text": "link"}, {"url": "https://github.com/luke4u/Time_Series_Forecasting", "anchor_text": "Github"}, {"url": "https://medium.com/tag/lstm?source=post_page-----e35f5cc84165---------------lstm-----------------", "anchor_text": "Lstm"}, {"url": "https://medium.com/tag/keras?source=post_page-----e35f5cc84165---------------keras-----------------", "anchor_text": "Keras"}, {"url": "https://medium.com/tag/python3?source=post_page-----e35f5cc84165---------------python3-----------------", "anchor_text": "Python3"}, {"url": "https://medium.com/tag/rnn?source=post_page-----e35f5cc84165---------------rnn-----------------", "anchor_text": "Rnn"}, {"url": "https://medium.com/tag/stock-prediction?source=post_page-----e35f5cc84165---------------stock_prediction-----------------", "anchor_text": "Stock Prediction"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fe35f5cc84165&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flstm-for-google-stock-price-prediction-e35f5cc84165&user=Luke+Sun&userId=7b5b79d21508&source=-----e35f5cc84165---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fe35f5cc84165&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flstm-for-google-stock-price-prediction-e35f5cc84165&user=Luke+Sun&userId=7b5b79d21508&source=-----e35f5cc84165---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe35f5cc84165&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flstm-for-google-stock-price-prediction-e35f5cc84165&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----e35f5cc84165--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fe35f5cc84165&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flstm-for-google-stock-price-prediction-e35f5cc84165&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----e35f5cc84165---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----e35f5cc84165--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----e35f5cc84165--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----e35f5cc84165--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----e35f5cc84165--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----e35f5cc84165--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----e35f5cc84165--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----e35f5cc84165--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----e35f5cc84165--------------------------------", "anchor_text": ""}, {"url": "https://lukesun.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://lukesun.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Luke Sun"}, {"url": "https://lukesun.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "141 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F7b5b79d21508&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flstm-for-google-stock-price-prediction-e35f5cc84165&user=Luke+Sun&userId=7b5b79d21508&source=post_page-7b5b79d21508--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F38f46069f6d3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flstm-for-google-stock-price-prediction-e35f5cc84165&newsletterV3=7b5b79d21508&newsletterV3Id=38f46069f6d3&user=Luke+Sun&userId=7b5b79d21508&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}