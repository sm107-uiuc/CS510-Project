{"url": "https://towardsdatascience.com/analysis-of-contextual-embedding-similarity-for-similar-sentences-4801cf9d8283", "time": 1683018118.5042188, "path": "towardsdatascience.com/analysis-of-contextual-embedding-similarity-for-similar-sentences-4801cf9d8283/", "webpage": {"metadata": {"title": "Analysis of ELMo and BERT embedding similarity for similar sentences | by Ane Berasategi | Towards Data Science", "h1": "Analysis of ELMo and BERT embedding similarity for similar sentences", "description": "Contextual embeddings like ELMo and BERT encode words' meaning into vectors including the context. How similar are they for similar sentences?"}, "outgoing_paragraph_urls": [{"url": "https://github.com/flairNLP/flair/tree/master/resources/docs/embeddings", "anchor_text": "Flair repo", "paragraph_index": 6}, {"url": "https://share.streamlit.io/anebz/eu-sim/similarity.py", "anchor_text": "https://share.streamlit.io/anebz/eu-sim/similarity.py", "paragraph_index": 8}, {"url": "https://share.streamlit.io/anebz/eu-sim/emb_similarity.py/", "anchor_text": "https://share.streamlit.io/anebz/eu-sim/emb_similarity.py/", "paragraph_index": 9}, {"url": "https://github.com/anebz/eu-sim/", "anchor_text": "Github repo here.", "paragraph_index": 9}, {"url": "https://github.com/anebz/eu-sim/blob/master/prev_data/semantic_search.pdf", "anchor_text": "talk slides", "paragraph_index": 14}, {"url": "https://share.streamlit.io/anebz/eu-sim/emb_similarity.py", "anchor_text": "website", "paragraph_index": 14}, {"url": "https://github.com/anebz/eu-sim", "anchor_text": "Github", "paragraph_index": 15}, {"url": "https://twitter.com/aberasategi", "anchor_text": "Twitter", "paragraph_index": 15}], "all_paragraphs": ["Embeddings are a key part of modern NLP, they encode the meaning of words or other linguistic units into vectors of numbers. The embedding of a specific word might seem random, but the idea is that similar words have similar embeddings, and opposite words have opposite embeddings.", "For example, imagine this is king\u2019s embedding: [2, 3, 1, 0, 5]. Prince\u2019s embedding might be [1, 3, 1, 0, 4], the difference between the vectors is just 2, which means these 2 words are linguistically very close. Queen\u2019s embedding might be [2, 3, -1, -10, 0] where some similarity is mantained (king and queen are part of the monarchy group of words), but other parts are opposite. In this case the distance between the embeddings is much bigger.", "This is the classical way of embeddings, just with words. We can experiment with word embedding algorithms (word2vec, GloVe, FastText) and check how different the embeddings are for synonyms, antonyms and unrelated words.", "In this post I go a bit further and explore the same concept but for contextual embeddings. How do embeddings change for similar sentences?", "Contextual embeddings also assign embeddings to words, but they take into accout the context, the surrounding words. The word king has a different embedding in these 2 sentences:", "There are mainly three types of contextual embeddings. As a short description, this is how each of them form embeddings:", "To obtain a sentence or document embedding, a kind of average of all the contextual embeddings is done. You can read more about these embeddings and document embeddings in the Flair repo docs.", "So how do contextual embeddings change for different sentences? If I give two \u2018opposite\u2019 sentences, their embeddings should be opposite too, right? But what constitutes an opposite sentence?", "EDIT: due to problems with Streamlit deployment, the link is changed: https://share.streamlit.io/anebz/eu-sim/similarity.py", "I built a website to play around: https://share.streamlit.io/anebz/eu-sim/emb_similarity.py/ feel free to change the language and the sentences. You can find the code for the Python code and Streamlit frontend in the Github repo here. You can star the repository if you want to receive updates about new features.", "I set this sentence as the main sentence", "The doctor invited the patient for lunch", "In the sample sentences I tried to capture different events:", "I tried the classic word embeddings and the 3 contextual embeddings, and these are the similarities of each similar sentence with the main sentence:", "I did this research as part of a university assignment and I asked myself some questions, which now I write here as open questions for the readers. I made some experiments and wrote my findings in the talk slides. I recommend trying out the experiments in the website yourself before looking up my conclusions!", "The website is free to use, you can do as many experiments as you want and I added many languages, you can check how embeddings change and adapt to different languages. Feel free to check the source code on Github, start the repository and chat with me on Twitter if you have any questions, interesting findings or you just want to connect :)", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F4801cf9d8283&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fanalysis-of-contextual-embedding-similarity-for-similar-sentences-4801cf9d8283&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fanalysis-of-contextual-embedding-similarity-for-similar-sentences-4801cf9d8283&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fanalysis-of-contextual-embedding-similarity-for-similar-sentences-4801cf9d8283&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fanalysis-of-contextual-embedding-similarity-for-similar-sentences-4801cf9d8283&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----4801cf9d8283--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----4801cf9d8283--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://anebz.medium.com/?source=post_page-----4801cf9d8283--------------------------------", "anchor_text": ""}, {"url": "https://anebz.medium.com/?source=post_page-----4801cf9d8283--------------------------------", "anchor_text": "Ane Berasategi"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fb250300b3b8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fanalysis-of-contextual-embedding-similarity-for-similar-sentences-4801cf9d8283&user=Ane+Berasategi&userId=b250300b3b8&source=post_page-b250300b3b8----4801cf9d8283---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F4801cf9d8283&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fanalysis-of-contextual-embedding-similarity-for-similar-sentences-4801cf9d8283&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F4801cf9d8283&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fanalysis-of-contextual-embedding-similarity-for-similar-sentences-4801cf9d8283&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@mjessier?utm_source=medium&utm_medium=referral", "anchor_text": "Myriam Jessier"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://anebz.eu/contextual-embedding-similarity-for-similar-sentences", "anchor_text": "ORIGINAL POST"}, {"url": "https://github.com/flairNLP/flair/tree/master/resources/docs/embeddings", "anchor_text": "Flair repo"}, {"url": "https://share.streamlit.io/anebz/eu-sim/similarity.py", "anchor_text": "https://share.streamlit.io/anebz/eu-sim/similarity.py"}, {"url": "https://share.streamlit.io/anebz/eu-sim/emb_similarity.py/", "anchor_text": "https://share.streamlit.io/anebz/eu-sim/emb_similarity.py/"}, {"url": "https://github.com/anebz/eu-sim/", "anchor_text": "Github repo here."}, {"url": "https://github.com/anebz/eu-sim/blob/master/prev_data/semantic_search.pdf", "anchor_text": "talk slides"}, {"url": "https://share.streamlit.io/anebz/eu-sim/emb_similarity.py", "anchor_text": "website"}, {"url": "https://github.com/anebz/eu-sim", "anchor_text": "Github"}, {"url": "https://twitter.com/aberasategi", "anchor_text": "Twitter"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----4801cf9d8283---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----4801cf9d8283---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/nlp?source=post_page-----4801cf9d8283---------------nlp-----------------", "anchor_text": "NLP"}, {"url": "https://medium.com/tag/research?source=post_page-----4801cf9d8283---------------research-----------------", "anchor_text": "Research"}, {"url": "https://medium.com/tag/embedding?source=post_page-----4801cf9d8283---------------embedding-----------------", "anchor_text": "Embedding"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F4801cf9d8283&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fanalysis-of-contextual-embedding-similarity-for-similar-sentences-4801cf9d8283&user=Ane+Berasategi&userId=b250300b3b8&source=-----4801cf9d8283---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F4801cf9d8283&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fanalysis-of-contextual-embedding-similarity-for-similar-sentences-4801cf9d8283&user=Ane+Berasategi&userId=b250300b3b8&source=-----4801cf9d8283---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F4801cf9d8283&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fanalysis-of-contextual-embedding-similarity-for-similar-sentences-4801cf9d8283&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----4801cf9d8283--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F4801cf9d8283&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fanalysis-of-contextual-embedding-similarity-for-similar-sentences-4801cf9d8283&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----4801cf9d8283---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----4801cf9d8283--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----4801cf9d8283--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----4801cf9d8283--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----4801cf9d8283--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----4801cf9d8283--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----4801cf9d8283--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----4801cf9d8283--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----4801cf9d8283--------------------------------", "anchor_text": ""}, {"url": "https://anebz.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://anebz.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Ane Berasategi"}, {"url": "https://anebz.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "351 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fb250300b3b8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fanalysis-of-contextual-embedding-similarity-for-similar-sentences-4801cf9d8283&user=Ane+Berasategi&userId=b250300b3b8&source=post_page-b250300b3b8--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F14aee5609f7e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fanalysis-of-contextual-embedding-similarity-for-similar-sentences-4801cf9d8283&newsletterV3=b250300b3b8&newsletterV3Id=14aee5609f7e&user=Ane+Berasategi&userId=b250300b3b8&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}