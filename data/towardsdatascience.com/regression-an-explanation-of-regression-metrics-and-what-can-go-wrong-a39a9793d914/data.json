{"url": "https://towardsdatascience.com/regression-an-explanation-of-regression-metrics-and-what-can-go-wrong-a39a9793d914", "time": 1683001803.543357, "path": "towardsdatascience.com/regression-an-explanation-of-regression-metrics-and-what-can-go-wrong-a39a9793d914/", "webpage": {"metadata": {"title": "Regression: An Explanation of Regression Metrics And What Can Go Wrong | by Divyanshu Mishra | Towards Data Science", "h1": "Regression: An Explanation of Regression Metrics And What Can Go Wrong", "description": "Machine learning is continuously growing and is said to affect all domains and bring a radical change in the way the human race functions. Few advancements have already started having an impact on\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.linkedin.com/in/divyanshu-mishra-ai/", "anchor_text": "Linkedin", "paragraph_index": 23}, {"url": "https://twitter.com/Perceptron97", "anchor_text": "Twitter", "paragraph_index": 23}], "all_paragraphs": ["Machine learning is continuously growing and is said to affect all domains and bring a radical change in the way the human race functions. Few advancements have already started having an impact on society like fraud detection systems, online loan approval systems, self-driving cars, tumour detection etc. Machine learning algorithms have already become part of our daily routines, from news recommendations in the morning to optimized movie recommendations from Netflix in the evening, everything we use is directly or indirectly affected or will be affected soon by machine learning.", "Machine learning is basically of two types i.e Supervised Learning and Unsupervised Learning. Supervised Learning can be simply taken as learning with the help of a teacher. This means we have the data points along with labels for each data point. Unsupervised Learning, on the other hand, can be considered as learning without a teacher. In this, we are just given raw data without any labels and the algorithm is supposed to find patterns in the data and group it accordingly. Most of the progress in machine learning is achieved in the supervised learning world while the unsupervised world remains mysterious and not completely explored.", "Supervised Machine learning can perform two tasks i.e Classification and Regression. Classification in very high-level terms is the task of assigning labels to data samples belonging to different classes, for e.g training, a neural network to distinguish between cats and dogs is a classification problem with cats and dogs being the two classes.", "Regression, on the other hand, is the task of predicting continuous values by learning from various independent features. for e.g Predicting the price of a house based on features like the number of bedrooms, locality etc.", "The basic classification or regression pipeline works as follows:", "The constant performance standard is different for different tasks and efforts are taken to reach the optimal value of the standard. In the case of the classification task, the performance standard maybe accurate which means how many cases are correctly classified by our model concerning the total cases seen by our model. Other performance metrics include sensitivity(recall), specificity, precision, f1-score, AUC, mean-squared-error, mean-absolute error, R\u00b2, Adjusted R\u00b2 etc and are used according to the task and data used for the task.", "In this article, we would discuss metrics used in the Regression task and why R\u00b2 becomes negative.", "The regression task is the prediction of the state of an outcome variable at a particular timepoint with the help of other correlated independent variables. The regression task, unlike the classification task, outputs continuous values within a given range.", "The various metrics used to evaluate the results of the prediction are :", "Mean Squared Error: MSE or Mean Squared Error is one of the most preferred metrics for regression tasks. It is simply the average of the squared difference between the target value and the value predicted by the regression model. As it squares the differences, it penalizes even a small error which leads to over-estimation of how bad the model is. It is preferred more than other metrics because it is differentiable and hence can be optimized better.", "Root Mean Squared Error: RMSE is the most widely used metric for regression tasks and is the square root of the averaged squared difference between the target value and the value predicted by the model. It is preferred more in some cases because the errors are first squared before averaging which poses a high penalty on large errors. This implies that RMSE is useful when large errors are undesired.", "Mean Absolute Error: MAE is the absolute difference between the target value and the value predicted by the model. The MAE is more robust to outliers and does not penalize the errors as extremely as mse. MAE is a linear score which means all the individual differences are weighted equally. It is not suitable for applications where you want to pay more attention to the outliers.", "R\u00b2 Error: Coefficient of Determination or R\u00b2 is another metric used for evaluating the performance of a regression model. The metric helps us to compare our current model with a constant baseline and tells us how much our model is better. The constant baseline is chosen by taking the mean of the data and drawing a line at the mean. R\u00b2 is a scale-free score that implies it doesn't matter whether the values are too large or too small, the R\u00b2 will always be less than or equal to 1.", "Adjusted R\u00b2: Adjusted R\u00b2 depicts the same meaning as R\u00b2 but is an improvement of it. R\u00b2 suffers from the problem that the scores improve on increasing terms even though the model is not improving which may misguide the researcher. Adjusted R\u00b2 is always lower than R\u00b2 as it adjusts for the increasing predictors and only shows improvement if there is a real improvement.t", "After giving you a brief overview of the various regression metrics, let us finally talk about why R\u00b2 is negative.", "There is a misconception among people that the R\u00b2 score ranges from 0 to 1 but actually, it ranges from -\u221e to 1. Due to this misconception, they are sometimes scared why the R\u00b2 is negative which is not a possibility according to them.", "The main reasons for R\u00b2 to be negative are the following:", "2. Maybe there are a large number of outliers in the data that causes the mse of the model to be more than mse of the baseline causing the R\u00b2 to be negative(i.e the numerator is greater than the denominator).", "3. Sometimes while coding the regression algorithm, the researcher might forget to add the intercept to the regressor which will also lead to R\u00b2 being negative. This is because, without the benefit of an intercept, the regression could do worse than the sample mean(baseline) in terms of tracking the dependent variable (i.e., the numerator could be greater than the denominator). However, most of the standard machine learning libraries like scikit-learn include the intercept by default but if you are using the stats-model library then you have to add the intercept manually.", "Recently I was working on a regression problem where my model was trained on a data having a range of dependent variables between 17\u201335 but the range was disjoint in the middle. To clarify, the data had values from 17\u201322 then a break and then again from 29\u201333. If I plot the data, it would be something like in the figure below.", "The model had an r2_score of 0.95 on the validation set. After the model was trained, I was asked to test the model\u2019s performance on subsets of data that is between 17\u201322 and 29\u201333. The model\u2019s performance on each of the subsets has a negative r2_score and I was very confused and wondered where I was going wrong. I checked the performance of the model on the combined dataset and it was similar to that of the validation set but as I divided the testing data into subsets and tested, a negative r2_score was seen. Then after thinking for a long time and implementing the r2_score function by hand and printing output at each stage of the calculation, I realized the problem.", "So let us consider, the 17\u201322 case and figure out why the r2_score was negative. As discussed above, r2_score tells the performance of the model as compared to the mean estimator i.e. a model that takes the mean of the dependent variable and predicts it for all the entries. In normal cases, the mean estimator is a bad model and fails. But when we are subsetting our data into smaller subsets, the mean estimator is actually a good estimator. If for example, we consider that the mean of our dependent variable is 19 for the 17\u201322 subset. Now if we consider our model that is trained on data from the entire range and not just 17\u201322, it would make an error of say 1 on average which is very good if we consider the entire range from 17\u201333 but if we subset the data into 17\u201322, an average error of 1 might be worse than the mean estimator thereby leading to negative r2_score. A similar scenario would be observed when the data will be a subset in the 19\u201333 subset.", "In this post, we discovered the various metrics used in regression analysis and also tried to answer the question of why R\u00b2 is negative?", "I hope you liked the post and learned something new. If you have any queries or like to discuss then feel free to reach me on Linkedin, Twitter or in the response section below.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fa39a9793d914&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fregression-an-explanation-of-regression-metrics-and-what-can-go-wrong-a39a9793d914&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fregression-an-explanation-of-regression-metrics-and-what-can-go-wrong-a39a9793d914&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fregression-an-explanation-of-regression-metrics-and-what-can-go-wrong-a39a9793d914&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fregression-an-explanation-of-regression-metrics-and-what-can-go-wrong-a39a9793d914&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----a39a9793d914--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----a39a9793d914--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@mdivyanshu.ai?source=post_page-----a39a9793d914--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@mdivyanshu.ai?source=post_page-----a39a9793d914--------------------------------", "anchor_text": "Divyanshu Mishra"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F5e0df83bf2d2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fregression-an-explanation-of-regression-metrics-and-what-can-go-wrong-a39a9793d914&user=Divyanshu+Mishra&userId=5e0df83bf2d2&source=post_page-5e0df83bf2d2----a39a9793d914---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa39a9793d914&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fregression-an-explanation-of-regression-metrics-and-what-can-go-wrong-a39a9793d914&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa39a9793d914&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fregression-an-explanation-of-regression-metrics-and-what-can-go-wrong-a39a9793d914&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/photos/MoDcnVRN5JU", "anchor_text": "source"}, {"url": "https://www.linkedin.com/in/divyanshu-mishra-ai/", "anchor_text": "Linkedin"}, {"url": "https://twitter.com/Perceptron97", "anchor_text": "Twitter"}, {"url": "https://bit.ly/2WWHC2E", "anchor_text": "Performance Metrics in Machine Learning"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----a39a9793d914---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/metrics?source=post_page-----a39a9793d914---------------metrics-----------------", "anchor_text": "Metrics"}, {"url": "https://medium.com/tag/data-science?source=post_page-----a39a9793d914---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----a39a9793d914---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/regression?source=post_page-----a39a9793d914---------------regression-----------------", "anchor_text": "Regression"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fa39a9793d914&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fregression-an-explanation-of-regression-metrics-and-what-can-go-wrong-a39a9793d914&user=Divyanshu+Mishra&userId=5e0df83bf2d2&source=-----a39a9793d914---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fa39a9793d914&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fregression-an-explanation-of-regression-metrics-and-what-can-go-wrong-a39a9793d914&user=Divyanshu+Mishra&userId=5e0df83bf2d2&source=-----a39a9793d914---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa39a9793d914&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fregression-an-explanation-of-regression-metrics-and-what-can-go-wrong-a39a9793d914&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----a39a9793d914--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fa39a9793d914&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fregression-an-explanation-of-regression-metrics-and-what-can-go-wrong-a39a9793d914&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----a39a9793d914---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----a39a9793d914--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----a39a9793d914--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----a39a9793d914--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----a39a9793d914--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----a39a9793d914--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----a39a9793d914--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----a39a9793d914--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----a39a9793d914--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@mdivyanshu.ai?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@mdivyanshu.ai?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Divyanshu Mishra"}, {"url": "https://medium.com/@mdivyanshu.ai/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "383 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F5e0df83bf2d2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fregression-an-explanation-of-regression-metrics-and-what-can-go-wrong-a39a9793d914&user=Divyanshu+Mishra&userId=5e0df83bf2d2&source=post_page-5e0df83bf2d2--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F13a3afb68e99&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fregression-an-explanation-of-regression-metrics-and-what-can-go-wrong-a39a9793d914&newsletterV3=5e0df83bf2d2&newsletterV3Id=13a3afb68e99&user=Divyanshu+Mishra&userId=5e0df83bf2d2&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}