{"url": "https://towardsdatascience.com/if-you-cant-measure-it-you-can-t-improve-it-5c059014faad", "time": 1682994007.0878341, "path": "towardsdatascience.com/if-you-cant-measure-it-you-can-t-improve-it-5c059014faad/", "webpage": {"metadata": {"title": "If You Can\u2019t Measure It, You Can\u2019t Improve It !!! | by Nasir Safdari | Towards Data Science", "h1": "If You Can\u2019t Measure It, You Can\u2019t Improve It !!!", "description": "Online shopping has changed quite a lot in the past few years. Online stores like Amazon, treats their customers at a more personal level. They understand your interests in certain products based on\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.youtube.com/watch?v=9gBC9R-msAk", "anchor_text": "video", "paragraph_index": 1}, {"url": "https://medium.com/@chhavi.saluja1401/recommendation-systems-made-simple-b5a79cac8862", "anchor_text": "Chhavi Aluja", "paragraph_index": 1}, {"url": "https://github.com/lyst/lightfm", "anchor_text": "LightFM", "paragraph_index": 3}, {"url": "http://lyst.github.io/lightfm/docs/home.html", "anchor_text": "LightFm Documentation.", "paragraph_index": 5}, {"url": "http://www2.informatik.uni-freiburg.de/~cziegler/BX/", "anchor_text": "Book- Crossing", "paragraph_index": 6}, {"url": "https://towardsdatascience.com/my-journey-to-building-book-recommendation-system-5ec959c41847", "anchor_text": "post", "paragraph_index": 6}], "all_paragraphs": ["Online shopping has changed quite a lot in the past few years. Online stores like Amazon, treats their customers at a more personal level. They understand your interests in certain products based on your online shopping activities (viewing items, adding items to your cart, and eventually making a purchase). For instance, you go on Amazon and search for an item and then you click on some of the search results. The next time you visit Amazon, you can see that there is a specific section that recommends similar products for you based on what you searched for the last time. The story does not end here and as you interact more with the online store, you receive more personalized recommendations including \u201cCustomers who bought this item also bought\u201d and it shows you a list of items that are bought frequently together. Also some stores send promotional emails offering products that are targeting customers who are more likely to purchase those items.", "Recommender Systems are one of the mostly utilized application of Machine Learning. Since the goal here is to focus on how to build the Recommender system using LightFM package and provide clear metrics to measure model performance, I will only briefly mention different types of Recommender Systems. For more details about Recommender Systems, I suggest watch this short video by Siraj Raval and check this article by Chhavi Aluja. There are three types of Recommender Systems:", "My initial goal was to build a Hybrid model since it can incorporate content-based to collaborative filtering and is able tackle the cold-start problem with the pure collaborative filtering recommender systems. However, there are not many publicly available good datasets that have both metadata for items or users and the ratings interactions. So I decided to first work on a collaborative filtering model and understand different aspects of the Recommender Systems and in my next article, I am going to build a Hybrid model.", "while researching about Recommender Systems, I came across many relevant great projects, However one thing missing was the lack of a clear metric to evaluate the performance of the model. I believe that if you cannot evaluate the performance of your model by providing clear metrics, it might be hard to convince your readers that the model (Recommender System) is working well enough. Therefore, I chose LightFM because it provides clear metrics like the AUC score and Precision@K that can help evaluate the performance of the trained model. this can be very useful while working towards building better models and achieving higher accuracy.", "Depending on the use case or the type of the problem we are going to solve, choosing between Precision@K and AUC score could be tricky. we are going to use AUC score in this case since it measures the quality of the overall ranking and can be interpreted as the probability that a randomly chosen positive item is ranked higher than a randomly chosen negative item.", "\u201cLightFM is a Python implementation of a number of popular recommendation algorithms for both implicit and explicit feedback, including efficient implementation of BPR and WARP ranking losses. It\u2019s easy to use, fast (via multithreaded model estimation), and produces high quality results.\u201d LightFm Documentation.", "For this project, we are going to implement a pure collaborative filtering model based on Matrix Factorization approach using the Book- Crossing dataset. we are going to take advantage of an amazing data cleaning and preprocessing for this dataset by Chhavi Aluja in her post on towardsdatascience.com. Let\u2019s have a look at the data:", "The above block of code is regular data cleaning to make sure that the data is in the right format before use it for the input in our model. moreover, we need to make sure that all the rows in ratings dataframe represent the data from users and books dataframes. next, ratings must only include valid rating scores (1\u201310) and we should get rid off all rows that has zero as the rating value.", "and here is the distribution of rating values:", "one last thing we can do to complete our data preprocessing is to assign a threshold for the number of users that have rated books and also for the number of books that have been rated by users. in other words we must have a minimum rating count number for the users and books. I think it would be good to have only users who rated at least 20 books and books that have been rated at least by 20 users.", "At this step, we are going to train our model. but this problem is different. in a collaborative filtering model, we look for latent features that characterizes each item (book) based on the user-item interactions, and we look for the affinity of each user to each latent feature discovered. this process is done through Matrix Factorization. first we need to split our data (ratings_explicit) into training and testing sets. This is where things get tricky. it is clear that the pure collaborative filtering approach cannot tackle the cold-start problem. therefore, the train and test split must be done so instances of user or books in the testing set must have remaining instances in the training set:", "The function, informed_train_test(), returns the coo matrix for the training and testing set plus the raw training dataframe for later evaluation of the model. Let\u2019s have a look at how to fit our model and evaluate its performance:", "as expected the AUC score for the training set is close to 1 and we got AUC score of 0.853 in our testing set, not too bad. the parameters for training the LightFm model was tuned using random search. GridSearh was too expensive to run so I decided to use forest_minimize() in scikit-optimize package to tune the parameters. more details about the function for tuning parameters is in the github page of this article.", "I know I mentioned before that pure collaborative filtering is expected to do poorly for recommending items to the new users who have not had any interaction with the items (cold-start problem). in the examples presented in LightFM documentation page, they have also shown that pure collaborative approach cannot achieve satisfactory results to recommend movies to the new customers using the movielens dataset, however, I was curious to test it myself for book-crossing dataset. And surprisingly the results show this dataset responds well to the cold-start problem with a relatively good AUC score!!! to train the model in this case, the only difference is that we split the dataset into training and testing sets randomly. it means that the probability to have common user-item interactions in trainig and testing set are completely random:", "Now Let\u2019s have a look at how the AUC score is different in the random train-test split:", "It is expected that you get an AUC score around 0.5 for randomly splitting the data but we can see that we are doing much better than just flipping a coin to recommend items to the new users or new items to the current users since we are getting 0.649 for our AUC score. I leave further analysis of this behavior to the readers of this article.", "Let\u2019s assume that the books in out dataset are the items we are selling and the users in the dataset are actually the intended customers. one thing that we can change about the rating values in order to make the case closer to an e-commerce online store is to decrease the range of values from (1\u201310) to (7\u201310). the interactions of the customers can be summarized into: A- viewing items, B- clicking on items, C- adding items to their shopping cart, and D- making a transaction to purchase items. therefore, by reducing the rating values to the top 4 ratings (7,8,9,10) in this case, we can have a closer simulation to the mentioned item-customer interactions.", "There are three main scenarios this Recommender System can be utilized for an e-commerce application. I am not going to include the actual code for the functions that provide the result for the next sections here on the article but they will be in the main jupyter notebook in the github repo.", "we recommended 15 items (books) to the user with ID#: 254, based on similar User-Item interactions.", "we recommended 10 users (IDs) who are more likely to be interested in the item (book) with ISBN # : 0195153448. the next step might be sending promotional emails to these users to see if they are interested in the mentioned item.", "It is important to note that in general, Collaborative Filtering approach needs enough data (user-item interactions) in order to get a good result. your questions and comments are highly appreciated.", "here is the link of the github repo for this project:", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Open Source is the solution\u2026 Software Engineer, Data Scientist and Machine Learning Researcher"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F5c059014faad&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fif-you-cant-measure-it-you-can-t-improve-it-5c059014faad&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fif-you-cant-measure-it-you-can-t-improve-it-5c059014faad&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fif-you-cant-measure-it-you-can-t-improve-it-5c059014faad&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fif-you-cant-measure-it-you-can-t-improve-it-5c059014faad&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----5c059014faad--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----5c059014faad--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@nasir.ahmad.safdari?source=post_page-----5c059014faad--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@nasir.ahmad.safdari?source=post_page-----5c059014faad--------------------------------", "anchor_text": "Nasir Safdari"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fb875ac73beb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fif-you-cant-measure-it-you-can-t-improve-it-5c059014faad&user=Nasir+Safdari&userId=b875ac73beb&source=post_page-b875ac73beb----5c059014faad---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F5c059014faad&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fif-you-cant-measure-it-you-can-t-improve-it-5c059014faad&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F5c059014faad&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fif-you-cant-measure-it-you-can-t-improve-it-5c059014faad&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://www.youtube.com/watch?v=9gBC9R-msAk", "anchor_text": "video"}, {"url": "https://medium.com/@chhavi.saluja1401/recommendation-systems-made-simple-b5a79cac8862", "anchor_text": "Chhavi Aluja"}, {"url": "https://github.com/lyst/lightfm", "anchor_text": "LightFM"}, {"url": "http://lyst.github.io/lightfm/docs/home.html", "anchor_text": "LightFm Documentation."}, {"url": "http://www2.informatik.uni-freiburg.de/~cziegler/BX/", "anchor_text": "Book- Crossing"}, {"url": "https://towardsdatascience.com/my-journey-to-building-book-recommendation-system-5ec959c41847", "anchor_text": "post"}, {"url": "https://github.com/nxs5899/Recommender-System-LightFM", "anchor_text": "nxs5899/Recommender-System-LightFMscalable Recommeder System for e-commerece using LightFM package in python - nxs5899/Recommender-System-LightFMgithub.com"}, {"url": "https://github.com/aayushmnit/cookbook/blob/master/recsys.py", "anchor_text": "https://github.com/aayushmnit/cookbook/blob/master/recsys.py"}, {"url": "https://towardsdatascience.com/my-journey-to-building-book-recommendation-system-5ec959c41847", "anchor_text": "https://towardsdatascience.com/my-journey-to-building-book-recommendation-system-5ec959c41847"}, {"url": "https://towardsdatascience.com/challenges-solutions-for-production-recommendation-systems-d656024bbdca", "anchor_text": "https://towardsdatascience.com/challenges-solutions-for-production-recommendation-systems-d656024bbdca"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----5c059014faad---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----5c059014faad---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/recommendation-system?source=post_page-----5c059014faad---------------recommendation_system-----------------", "anchor_text": "Recommendation System"}, {"url": "https://medium.com/tag/e-commerce-solution?source=post_page-----5c059014faad---------------e_commerce_solution-----------------", "anchor_text": "E Commerce Solution"}, {"url": "https://medium.com/tag/python?source=post_page-----5c059014faad---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F5c059014faad&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fif-you-cant-measure-it-you-can-t-improve-it-5c059014faad&user=Nasir+Safdari&userId=b875ac73beb&source=-----5c059014faad---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F5c059014faad&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fif-you-cant-measure-it-you-can-t-improve-it-5c059014faad&user=Nasir+Safdari&userId=b875ac73beb&source=-----5c059014faad---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F5c059014faad&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fif-you-cant-measure-it-you-can-t-improve-it-5c059014faad&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----5c059014faad--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F5c059014faad&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fif-you-cant-measure-it-you-can-t-improve-it-5c059014faad&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----5c059014faad---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----5c059014faad--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----5c059014faad--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----5c059014faad--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----5c059014faad--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----5c059014faad--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----5c059014faad--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----5c059014faad--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----5c059014faad--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@nasir.ahmad.safdari?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@nasir.ahmad.safdari?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Nasir Safdari"}, {"url": "https://medium.com/@nasir.ahmad.safdari/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "305 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fb875ac73beb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fif-you-cant-measure-it-you-can-t-improve-it-5c059014faad&user=Nasir+Safdari&userId=b875ac73beb&source=post_page-b875ac73beb--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fdde46cf682&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fif-you-cant-measure-it-you-can-t-improve-it-5c059014faad&newsletterV3=b875ac73beb&newsletterV3Id=dde46cf682&user=Nasir+Safdari&userId=b875ac73beb&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}