{"url": "https://towardsdatascience.com/two-vba-tips-to-verify-excel-data-in-o-n-b640db9771a6", "time": 1683017747.266934, "path": "towardsdatascience.com/two-vba-tips-to-verify-excel-data-in-o-n-b640db9771a6/", "webpage": {"metadata": {"title": "Two VBA Tips to Verify Excel Data in O(n) | by GRD | Towards Data Science", "h1": "Two VBA Tips to Verify Excel Data in O(n)", "description": "We often automate data verification to increase efficiency and accuracy. This has been the case in my project at least, where, without more sophisticated options, I\u2019m left coding Excel macros to do\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.geeksforgeeks.org/linear-search/", "anchor_text": "linear search", "paragraph_index": 1}, {"url": "https://en.wikipedia.org/wiki/I/O_bound#:~:text=In%20computer%20science%2C%20I%2FO,a%20task%20being%20CPU%20bound.", "anchor_text": "I/O-bound", "paragraph_index": 8}, {"url": "https://en.wikipedia.org/wiki/Write_once,_run_anywhere", "anchor_text": "Java joke", "paragraph_index": 9}, {"url": "https://www.cs.yale.edu/homes/aspnes/pinewiki/C(2f)HashTables.html?highlight=%28CategoryAlgorithmNotes%29", "anchor_text": "hash function", "paragraph_index": 18}, {"url": "https://docs.microsoft.com/en-us/office/vba/language/how-to/check-or-add-an-object-library-reference", "anchor_text": "add a reference", "paragraph_index": 19}, {"url": "https://hackr.io/blog/dbms-normalization", "anchor_text": "Second Normal Form", "paragraph_index": 21}], "all_paragraphs": ["We often automate data verification to increase efficiency and accuracy. This has been the case in my project at least, where, without more sophisticated options, I\u2019m left coding Excel macros to do the job for me and my team, as we engage in system testing and data migration.", "If you\u2019re new to VBA, you might think linear search is the only way to get things done. But, if you\u2019re working with spreadsheets, that means you\u2019ll probably be linear searching (or iterating) through rows and columns \u2014 that\u2019s already O(n\u00b2)!", "Truth is: You have better options, fam.", "So, sit down, open up your Visual Basic Editor, and let\u2019s get bring down that Big O.", "At a high level, data verification consists of two sub-processes:", "In Excel VBA, the first of these might imply reading data from a spreadsheet or database, whereas the latter might comprise checking equality or membership in a set of expected data.", "When starting VBA, we learn the following syntax for accessing data:", "Of course, it\u2019s unlikely that our data retrieval stops here. My example uses only the first row, but we\u2019re likely going to have to loop through several rows in our wks object, and perhaps even columns besides \u201cA.\u201d", "Even if we can tolerate O(n\u00b2) and the sloppy code that probably comes with it, we should note that reading data from a file, such as an Excel spreadsheet, is an I/O-bound process. Every cell we iterate through, thus, slackens our runtime. In combination with a poor algorithm, we might as well eat a full-course meal (or two) while waiting for our macro to finish.", "Instead, it\u2019s better to read once (and run anywhere \u2014 sorry, Java joke). And, in fact, we can! We\u2019ll just need to know the dimensions of our tabular data and borrow the powers of the Variant data type.", "Assuming our table spans between Columns A and E and comprises 10 rows, all we need is the following:", "On Excel, that would look something like making the following selection:", "And that\u2019s it. We\u2019ve effectively loaded all the data into valMatrix , which behaves as a two-dimensional matrix. That is, we can index and iterate through its columns and rows as such:", "With this, we can seamlessly access our data without bogging down our runtime with costly I/O-bound spreadsheet reads.", "Alright, it\u2019s cool that we\u2019ve loaded our spreadsheet into memory, but, from a time complexity perspective, there\u2019s much to be desired.", "For verifying n number of data points against a spreadsheet, we have to go through a nested loop, which is O(n\u00b2). Thus, our runtime might be O(n\u00b3) in the worst case. Ew.", "However, in a realistic scenario, our columns likely represent distinct attributes, and we\u2019ll know the necessary columns in advance. We won\u2019t be iterating through columns, and for every data point we\u2019ll be able to index for the appropriate column. So, we eliminate one loop, and we\u2019re left with O(n\u00b2). Still ew.", "Despite the niftiness of Trick #1, the truth is we can achieve O(n) \u2014 or something close to it \u2014 when we don\u2019t compare matrix against matrix directly.", "Instead, what we can do is borrow the powers of the Dictionary data structure. Based on hash tables, dictionaries have a hash function that allows them to retrieve data at nearly O(1) in most practical situations.", "While dictionaries are readily accessible in languages like Python, for VBA, we\u2019ll have to first add a reference to the Microsoft Scripting Runtime library. Once this step is done, adding key-value pairs is a breeze.", "As hinted in the above snippet, the VBA Dictionary comes with a convenient Exists method, which returns a Boolean that we can use to verify whether our actual data exists in a particular set of expected data.", "Of course, this Tip won\u2019t work if our data isn\u2019t at least in Second Normal Form, where we have some key unique to identify each expected and actual data record. This highlights the merit of knowing the data before commencing with development.", "So, we can achieve an data verification algorithm that\u2019s close to O(n) by:", "When we\u2019re new to VBA, we tend to seek rudimentary techniques that seem innocuous until they spaghettify our code and make our runtime sky-high.", "With the Variant data type, we obtain a multi-dimensional array of cell values and reduce our costly worksheet reads to a single read.", "Assuming we have unique keys, all that\u2019s left is verifying membership of actual data points in a set of expected values.", "In unsorted data, where O(n\u22c5log(n)) from binary search is unachievable, we might resort to iterating through each column and row \u2014 a nested loop of O(n\u00b2). But we don\u2019t have to. The VBA Dictionary comes handy with an Exists method that verifies our data for us. All we have to do is understand our data and give it a shot.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fb640db9771a6&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftwo-vba-tips-to-verify-excel-data-in-o-n-b640db9771a6&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftwo-vba-tips-to-verify-excel-data-in-o-n-b640db9771a6&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftwo-vba-tips-to-verify-excel-data-in-o-n-b640db9771a6&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftwo-vba-tips-to-verify-excel-data-in-o-n-b640db9771a6&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----b640db9771a6--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----b640db9771a6--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://aneggma.medium.com/?source=post_page-----b640db9771a6--------------------------------", "anchor_text": ""}, {"url": "https://aneggma.medium.com/?source=post_page-----b640db9771a6--------------------------------", "anchor_text": "GRD"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fd64fd1f826db&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftwo-vba-tips-to-verify-excel-data-in-o-n-b640db9771a6&user=GRD&userId=d64fd1f826db&source=post_page-d64fd1f826db----b640db9771a6---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb640db9771a6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftwo-vba-tips-to-verify-excel-data-in-o-n-b640db9771a6&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb640db9771a6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftwo-vba-tips-to-verify-excel-data-in-o-n-b640db9771a6&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@pisitheng?utm_source=medium&utm_medium=referral", "anchor_text": "Pisit Heng"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://www.geeksforgeeks.org/linear-search/", "anchor_text": "linear search"}, {"url": "https://en.wikipedia.org/wiki/I/O_bound#:~:text=In%20computer%20science%2C%20I%2FO,a%20task%20being%20CPU%20bound.", "anchor_text": "I/O-bound"}, {"url": "https://en.wikipedia.org/wiki/Write_once,_run_anywhere", "anchor_text": "Java joke"}, {"url": "https://www.cs.yale.edu/homes/aspnes/pinewiki/C(2f)HashTables.html?highlight=%28CategoryAlgorithmNotes%29", "anchor_text": "hash function"}, {"url": "https://docs.microsoft.com/en-us/office/vba/language/how-to/check-or-add-an-object-library-reference", "anchor_text": "add a reference"}, {"url": "https://hackr.io/blog/dbms-normalization", "anchor_text": "Second Normal Form"}, {"url": "https://medium.com/tag/excel?source=post_page-----b640db9771a6---------------excel-----------------", "anchor_text": "Excel"}, {"url": "https://medium.com/tag/programming?source=post_page-----b640db9771a6---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/tag/coding?source=post_page-----b640db9771a6---------------coding-----------------", "anchor_text": "Coding"}, {"url": "https://medium.com/tag/testing?source=post_page-----b640db9771a6---------------testing-----------------", "anchor_text": "Testing"}, {"url": "https://medium.com/tag/automation?source=post_page-----b640db9771a6---------------automation-----------------", "anchor_text": "Automation"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fb640db9771a6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftwo-vba-tips-to-verify-excel-data-in-o-n-b640db9771a6&user=GRD&userId=d64fd1f826db&source=-----b640db9771a6---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fb640db9771a6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftwo-vba-tips-to-verify-excel-data-in-o-n-b640db9771a6&user=GRD&userId=d64fd1f826db&source=-----b640db9771a6---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb640db9771a6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftwo-vba-tips-to-verify-excel-data-in-o-n-b640db9771a6&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----b640db9771a6--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fb640db9771a6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftwo-vba-tips-to-verify-excel-data-in-o-n-b640db9771a6&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----b640db9771a6---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----b640db9771a6--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----b640db9771a6--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----b640db9771a6--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----b640db9771a6--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----b640db9771a6--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----b640db9771a6--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----b640db9771a6--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----b640db9771a6--------------------------------", "anchor_text": ""}, {"url": "https://aneggma.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://aneggma.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "GRD"}, {"url": "https://aneggma.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "45 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fd64fd1f826db&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftwo-vba-tips-to-verify-excel-data-in-o-n-b640db9771a6&user=GRD&userId=d64fd1f826db&source=post_page-d64fd1f826db--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fusers%2Fd64fd1f826db%2Flazily-enable-writer-subscription&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftwo-vba-tips-to-verify-excel-data-in-o-n-b640db9771a6&user=GRD&userId=d64fd1f826db&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}