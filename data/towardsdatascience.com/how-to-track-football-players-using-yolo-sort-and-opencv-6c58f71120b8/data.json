{"url": "https://towardsdatascience.com/how-to-track-football-players-using-yolo-sort-and-opencv-6c58f71120b8", "time": 1683012099.386585, "path": "towardsdatascience.com/how-to-track-football-players-using-yolo-sort-and-opencv-6c58f71120b8/", "webpage": {"metadata": {"title": "How to track football players using Yolo, SORT and Opencv. | by C K | Towards Data Science", "h1": "How to track football players using Yolo, SORT and Opencv.", "description": "In this post, I will show how I detect and track players using Yolov3, Opencv and SORT from video clip, and turn the detections to the bird\u2019s-eye view as shown above."}, "outgoing_paragraph_urls": [{"url": "http://ipl.ce.sharif.edu/ball_datasets.html", "anchor_text": "IPL Ball Detection Datasets.", "paragraph_index": 1}, {"url": "https://docs.opencv.org/2.4/modules/imgproc/doc/geometric_transformations.html#getperspectivetransform", "anchor_text": "getPerspectiveTransform", "paragraph_index": 8}, {"url": "https://docs.opencv.org/2.4/modules/imgproc/doc/geometric_transformations.html#getperspectivetransform", "anchor_text": "getPerspectiveTransform", "paragraph_index": 12}], "all_paragraphs": ["In this post, I will show how I detect and track players using Yolov3, Opencv and SORT from video clip, and turn the detections to the bird\u2019s-eye view as shown above.", "In order to have a stable tracking and perspective transform, I need a video clip without camera moving around. I downloaded the video from IPL Ball Detection Datasets. Please be noted that the ball is not tracked in this project, it was already tracked (green bounding box) from the source.", "The first step is to load the video and detect the players.", "I used the pre-trained Yolov3 weight and used Opencv\u2019s dnn module and only selected detections classified as \u2018person\u2019.", "I drew bounding boxes for detected players and their tails for previous ten frames.", "Looks like the pre-trained model is doing quite okay.", "Next I want to track the player and assign unique IDs to them. I used Alex Bewley\u2019s SORT algorithm(simple online and realtime tracking), which I applied to my previous work.", "Now each player has a unique ID assigned and displayed in the video.", "The video looks good now, but I still want to have players\u2019 motion in bird\u2019s-eye view. It can be done by doing perspective transform. There are a little bit math involved, fortunately Opencv\u2019s getPerspectiveTransform function make it a lot easier.", "I need to find 4 fixed points as reference and identify the coordinations from the video and also from the bird\u2019s-eye view image.", "First I identify 4 reference points from the video as show in in red spot and get the pixel coordinations.", "I did not really see very solid reference points from the video so I roughly identified 4 points and marked these locations on the bird\u2019s-eye view and got the corresponding pixel coordinations. It will be more precise if the reference points are more robust.", "Then by applying Opencv\u2019s getPerspectiveTransform using these reference points, we can transform the detections from video to bird\u2019s-eye view.", "With player\u2019s movement information, it is possible to do further analysis such as players\u2019 running distance and velocity.", "The speed for running this player tracking is around 0.3 second per frame on my 2016 Macbook Pro Intel i5 CPU. It is possible to do this real time by using GPU for some applications if necessary.", "Thanks for reading, comments and suggestions are welcome!", "In my next post, I used OpenCV to identify players\u2019s team based on their jersey color. Feel free to take a look!", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F6c58f71120b8&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-track-football-players-using-yolo-sort-and-opencv-6c58f71120b8&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-track-football-players-using-yolo-sort-and-opencv-6c58f71120b8&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-track-football-players-using-yolo-sort-and-opencv-6c58f71120b8&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-track-football-players-using-yolo-sort-and-opencv-6c58f71120b8&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----6c58f71120b8--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----6c58f71120b8--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@c.kuan?source=post_page-----6c58f71120b8--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@c.kuan?source=post_page-----6c58f71120b8--------------------------------", "anchor_text": "C K"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fd655d41bf524&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-track-football-players-using-yolo-sort-and-opencv-6c58f71120b8&user=C+K&userId=d655d41bf524&source=post_page-d655d41bf524----6c58f71120b8---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F6c58f71120b8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-track-football-players-using-yolo-sort-and-opencv-6c58f71120b8&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F6c58f71120b8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-track-football-players-using-yolo-sort-and-opencv-6c58f71120b8&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://commons.wikimedia.org/wiki/File:Soccer_field_-_empty.svg", "anchor_text": "https://commons.wikimedia.org/wiki/File:Soccer_field_-_empty.svg"}, {"url": "https://medium.com/@samuelfblake?source=post_page-----a64d9564ccb1----------------------", "anchor_text": "Sam Blake"}, {"url": "https://medium.com/hal24k-techblog/how-to-track-objects-in-the-real-world-with-tensorflow-sort-and-opencv-a64d9564ccb1", "anchor_text": "https://medium.com/hal24k-techblog/how-to-track-objects-in-the-real-world-with-tensorflow-sort-and-opencv-a64d9564ccb1"}, {"url": "http://ipl.ce.sharif.edu/ball_datasets.html", "anchor_text": "IPL Ball Detection Datasets."}, {"url": "http://ipl.ce.sharif.edu/ball_datasets.html", "anchor_text": "here"}, {"url": "https://towardsdatascience.com/detect-and-track-baseball-using-detectron2-and-sort-6dd92a46e6f2", "anchor_text": "Detect and track baseball using Detectron2 and SORTHow I track the baseballs when there are multiple baseballs in the video.towardsdatascience.com"}, {"url": "https://docs.opencv.org/2.4/modules/imgproc/doc/geometric_transformations.html#getperspectivetransform", "anchor_text": "getPerspectiveTransform"}, {"url": "https://docs.opencv.org/2.4/modules/imgproc/doc/geometric_transformations.html#getperspectivetransform", "anchor_text": "getPerspectiveTransform"}, {"url": "https://medium.com/@c.kuan/membership", "anchor_text": "https://medium.com/@c.kuan/membership"}, {"url": "https://towardsdatascience.com/football-players-tracking-identifying-players-team-based-on-their-jersey-colors-using-opencv-7eed1b8a1095", "anchor_text": "Football players tracking \u2014 identifying players\u2019 team based on their jersey colors using OpenCVDetect, track, determine players\u2019 team and convert it to bird\u2019s-eye view using Yolov3, SORT and OpenCV.towardsdatascience.com"}, {"url": "https://medium.com/tag/sports?source=post_page-----6c58f71120b8---------------sports-----------------", "anchor_text": "Sports"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----6c58f71120b8---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----6c58f71120b8---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----6c58f71120b8---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/soccer?source=post_page-----6c58f71120b8---------------soccer-----------------", "anchor_text": "Soccer"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F6c58f71120b8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-track-football-players-using-yolo-sort-and-opencv-6c58f71120b8&user=C+K&userId=d655d41bf524&source=-----6c58f71120b8---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F6c58f71120b8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-track-football-players-using-yolo-sort-and-opencv-6c58f71120b8&user=C+K&userId=d655d41bf524&source=-----6c58f71120b8---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F6c58f71120b8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-track-football-players-using-yolo-sort-and-opencv-6c58f71120b8&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----6c58f71120b8--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F6c58f71120b8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-track-football-players-using-yolo-sort-and-opencv-6c58f71120b8&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----6c58f71120b8---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----6c58f71120b8--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----6c58f71120b8--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----6c58f71120b8--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----6c58f71120b8--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----6c58f71120b8--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----6c58f71120b8--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----6c58f71120b8--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----6c58f71120b8--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@c.kuan?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@c.kuan?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "C K"}, {"url": "https://medium.com/@c.kuan/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "268 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fd655d41bf524&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-track-football-players-using-yolo-sort-and-opencv-6c58f71120b8&user=C+K&userId=d655d41bf524&source=post_page-d655d41bf524--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fe796e256f1d1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-track-football-players-using-yolo-sort-and-opencv-6c58f71120b8&newsletterV3=d655d41bf524&newsletterV3Id=e796e256f1d1&user=C+K&userId=d655d41bf524&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}