{"url": "https://towardsdatascience.com/how-i-created-the-workout-movement-counting-app-using-deep-learning-and-optical-flow-89f9d2e087ac", "time": 1683005632.460394, "path": "towardsdatascience.com/how-i-created-the-workout-movement-counting-app-using-deep-learning-and-optical-flow-89f9d2e087ac/", "webpage": {"metadata": {"title": "How I created the Workout Movement Counting App using Deep Learning and Optical Flow Algorithm | by Art Kulakov | Towards Data Science", "h1": "How I created the Workout Movement Counting App using Deep Learning and Optical Flow Algorithm", "description": "I like doing workouts and different types of trainings, like crossfit, but when the training is too intense or too long, I notice that I often make mistakes while counting how many movements I make\u2026"}, "outgoing_paragraph_urls": [{"url": "https://github.com/artkulak/workout-movement-counting", "anchor_text": "github repository", "paragraph_index": 0}, {"url": "http://artkulakov.com", "anchor_text": "website", "paragraph_index": 15}], "all_paragraphs": ["I like doing workouts and different types of trainings, like crossfit, but when the training is too intense or too long, I notice that I often make mistakes while counting how many movements I make on each exercise, this might be either due to lack of concentration on movement counting task during training or subconscious overestimation of the number of moves performed. As a third year Computer Sciense BSc student I decided to solve this problem during my course work and created the Web App to count the number of moves performed during workout. In this article I would like to share my approach to this problem. You can find the full code of the app in the github repository.", "In order to perform movement counting, you have to know if the body moves up or down on each frame. Usually, to perform such kind of task I would need to use some RNN architecture, because, obviously, you can\u2019t detect the direction of movement using one frame only. Is he moving up or down on this photo?", "But I didn\u2019t have enough training data for making a robust RNN model, as I had to prepare and label the data myself. I tried looking in the direction of PoseNet models, to get coordinates of each body part on each frame.", "This approach wasn\u2019t beneficial either, due to several reasons:", "All in all, I played a lot with different models, and they all gave a poor result in some way. This was until one day I learned about the Optical Flow algorithm and especially Dense Optical Flow implementation (the right part of the image below). In a nutshell, this algorithm tracks the movement of pixels along some number of consequent frames.", "The optical flow can be either estimated using some mathematical models, which are implemented, for example, in OpenCV library, or it can be directly predicted using Deep Learning, which gives far better results in the complex video scenes. In my implementation I decided to stick to the Dense Optical Flow algorithm, which was implemented in python-opencv package.", "Here is how one push-up can be color coded with Dense Optical Flow.", "As you see, Dense Optical Flow encodes movement down as the green color and movement up as the purple color. Thereby, knowing the color coded representation of each frame, I could easily build a simple CNN network to perform multiclass classification of the frames. I just stacked some Conv + Pooling layers in PyTorch, which resulted in the following simple architecture.", "To train this model, I loaded and labeled by frame a few YouTube videos, I also prepared some push-up videos myself. Finally, I had a training set of the color coded images, which consisted of 252 moving down frames, 202 non push-up frames and 206 moving up frames. I also prepared a small validation set consisting of 140 frames with different movements. After running a training loop for 10 epochs I got a pretty impressive graph of LogLoss for my model.", "Obviously, it wasn\u2019t too hard for the model, to predict for these 3 classes, because it can be easily done just by looking at the color coded images by eye.", "What was more important, is the fact, that the trained model was able to classify frames, not only for push-ups but for burpees, squats and pull-ups as well. In genereal, I guess this exact model can easily classify all movements with a high amplitude, that involve moving up and down.", "Though, to classify some exercises like sit-ups, or some low amplitude dumbbell moves, it is better to collect a new training set and to retrain the current model.", "To apply my model in real life I created a small Web App using Django, where I could create a new workout and try my model in the \u201cbattle\u201d environment. Here is how it looks like.", "In general, during training, I noticed an error around 2.5% for push-ups, squats and pull-ups. For burpee, the error was around 5%, due to the fact that the exercises involves more than one up-down movement. Here is how the model counts push ups during workout.", "To conclude, this work was a great experience for me, as I had to make a lot of research and to test different hypotheses for the problem of movement counting during workout. My time tracker shows that right now I have spent around 75 hours on this app development, but who knows, maybe I will spend even more if I decide to continue the project and make it something bigger. Thank you for your read!", "You may like to check other posts on my website", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F89f9d2e087ac&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-i-created-the-workout-movement-counting-app-using-deep-learning-and-optical-flow-89f9d2e087ac&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-i-created-the-workout-movement-counting-app-using-deep-learning-and-optical-flow-89f9d2e087ac&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-i-created-the-workout-movement-counting-app-using-deep-learning-and-optical-flow-89f9d2e087ac&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-i-created-the-workout-movement-counting-app-using-deep-learning-and-optical-flow-89f9d2e087ac&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----89f9d2e087ac--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----89f9d2e087ac--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://artkulakov.medium.com/?source=post_page-----89f9d2e087ac--------------------------------", "anchor_text": ""}, {"url": "https://artkulakov.medium.com/?source=post_page-----89f9d2e087ac--------------------------------", "anchor_text": "Art Kulakov"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F8c4b7f24d954&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-i-created-the-workout-movement-counting-app-using-deep-learning-and-optical-flow-89f9d2e087ac&user=Art+Kulakov&userId=8c4b7f24d954&source=post_page-8c4b7f24d954----89f9d2e087ac---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F89f9d2e087ac&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-i-created-the-workout-movement-counting-app-using-deep-learning-and-optical-flow-89f9d2e087ac&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F89f9d2e087ac&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-i-created-the-workout-movement-counting-app-using-deep-learning-and-optical-flow-89f9d2e087ac&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@aloragriffiths", "anchor_text": "Alora Griffiths"}, {"url": "https://unsplash.com/photos/ymBZhfHwEPM", "anchor_text": "unsplash"}, {"url": "https://github.com/artkulak/workout-movement-counting", "anchor_text": "github repository"}, {"url": "https://www.youtube.com/watch?v=7wblGkVQx3U", "anchor_text": "https://www.youtube.com/watch?v=7wblGkVQx3U"}, {"url": "https://medium.com/tensorflow/real-time-human-pose-estimation-in-the-browser-with-tensorflow-js-7dd0bc881cd5", "anchor_text": "https://medium.com/tensorflow/real-time-human-pose-estimation-in-the-browser-with-tensorflow-js-7dd0bc881cd5"}, {"url": "https://nanonets.com/blog/optical-flow/", "anchor_text": "https://nanonets.com/blog/optical-flow/"}, {"url": "https://www.youtube.com/watch?v=xoCKHx8Yyj4", "anchor_text": "https://www.youtube.com/watch?v=xoCKHx8Yyj4"}, {"url": "http://artkulakov.com", "anchor_text": "website"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----89f9d2e087ac---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/sports?source=post_page-----89f9d2e087ac---------------sports-----------------", "anchor_text": "Sports"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----89f9d2e087ac---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----89f9d2e087ac---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----89f9d2e087ac---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F89f9d2e087ac&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-i-created-the-workout-movement-counting-app-using-deep-learning-and-optical-flow-89f9d2e087ac&user=Art+Kulakov&userId=8c4b7f24d954&source=-----89f9d2e087ac---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F89f9d2e087ac&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-i-created-the-workout-movement-counting-app-using-deep-learning-and-optical-flow-89f9d2e087ac&user=Art+Kulakov&userId=8c4b7f24d954&source=-----89f9d2e087ac---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F89f9d2e087ac&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-i-created-the-workout-movement-counting-app-using-deep-learning-and-optical-flow-89f9d2e087ac&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----89f9d2e087ac--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F89f9d2e087ac&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-i-created-the-workout-movement-counting-app-using-deep-learning-and-optical-flow-89f9d2e087ac&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----89f9d2e087ac---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----89f9d2e087ac--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----89f9d2e087ac--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----89f9d2e087ac--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----89f9d2e087ac--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----89f9d2e087ac--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----89f9d2e087ac--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----89f9d2e087ac--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----89f9d2e087ac--------------------------------", "anchor_text": ""}, {"url": "https://artkulakov.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://artkulakov.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Art Kulakov"}, {"url": "https://artkulakov.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "626 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F8c4b7f24d954&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-i-created-the-workout-movement-counting-app-using-deep-learning-and-optical-flow-89f9d2e087ac&user=Art+Kulakov&userId=8c4b7f24d954&source=post_page-8c4b7f24d954--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Ffbb3f8dbd5f6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-i-created-the-workout-movement-counting-app-using-deep-learning-and-optical-flow-89f9d2e087ac&newsletterV3=8c4b7f24d954&newsletterV3Id=fbb3f8dbd5f6&user=Art+Kulakov&userId=8c4b7f24d954&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}