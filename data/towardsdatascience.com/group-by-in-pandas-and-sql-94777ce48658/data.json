{"url": "https://towardsdatascience.com/group-by-in-pandas-and-sql-94777ce48658", "time": 1683003808.1499252, "path": "towardsdatascience.com/group-by-in-pandas-and-sql-94777ce48658/", "webpage": {"metadata": {"title": "GROUP BY in Pandas and SQL. A Comparison of Aggregation Functions | by Freda Xin | Towards Data Science", "h1": "GROUP BY in Pandas and SQL", "description": "An essential component of data analysis is to generate summaries by computing aggregations such as sum, max, min, mean, median etc. This way, we can develop some understanding of the general shape of\u2026"}, "outgoing_paragraph_urls": [{"url": "https://pandas.pydata.org/pandas-docs/stable/user_guide/groupby.html", "anchor_text": "documentation for the GroupBy object", "paragraph_index": 2}, {"url": "https://www.kaggle.com/c/titanic/data", "anchor_text": "Titanic Kaggle Competition", "paragraph_index": 4}, {"url": "https://www.postgresql.org/docs/current/tutorial-window.html", "anchor_text": "WINDOW functions", "paragraph_index": 22}], "all_paragraphs": ["An essential component of data analysis is to generate summaries by computing aggregations such as sum, max, min, mean, median etc. This way, we can develop some understanding of the general shape of the data. This is especially important for large datasets, where looking at the raw data might not yield any meaningful insights.", "In this blog post, I will first describe the underlining mechanism of Group By, and then compare the implementations of the Group By concept in Python's pandas library and SQL.", "As the pandas Development Team stated elegantly on their documentation for the GroupBy object, Group By involves three steps:", "In the context of analyzing a data frame, Step 1 amounts to finding a column and using the unique values of that column to split the data frame into groups. Step 2 is to select a function, such as aggregate, transform, or filter. The selected function will operate on each individual group. The results of Step 2 will be merged and displayed as a new data structure in Step 3.", "All the above might still sound rather abstract; let\u2019s try it out using a real dataset from the Titanic Kaggle Competition. (Note that there are three datasets available and I will be using \u201ctrain.csv\u201d in this blog post.)", "The Python pandas library has an efficient operation called groupby to perform the Group By task.", "In the Titanic dataset, there is a columns called \u201cEmbarked\u201d that provides information about ports of embarkation for each passenger. There are three distinct values: C, Q, and S (C = Cherbourg, Q = Queenstown, S = Southampton). If we want to check out the number of passengers embarked on each port, we can use the following command:", "Let\u2019s break this down a little using the split-apply-combine steps.", "Step 1 is to select the column \u201cEmbarked\u201d, using its unique values \u2014 i.e. C, Q, S \u2014 to split our dataset into three categories.", "Note that at this stage, no operation has been performed on the groups. The command train.groupby('Embarked') merely outputs a GroupBy object:", "Step 2 is to select the count() method as our function, which yields the total number for each category.", "Step 3 is to combine and display the results. pandas GroupBy object supports column indexing, and we can specify which columns we want to see in the aggregated results. In our case, we only care about the column \"Embarked\". Without this specification, pandas will return aggregated results for all numerical columns as follows:", "The Group By concept is an essential component SQL\u2019s syntax. Despite some syntactic difference, SQL\u2019s GOURP BY statement works in a similar way as pandas'.", "The above pandas operation can be implemented in SQL as follows:", "In the GROUP BY statement, the column \"Embarked\" is selected to split the dataset. In the second part of the SELECT statement, COUNT() is chosen as the aggregation function. The SELECT statement also contains information of which columns we want to display in the output. The first occurrence of \"Embarked\" is equivalent to pandas' column indexing [Embarked]. One other minor difference is that SQL uses the FROM statement to specify which dataset we are working with, i.e. the \"train\" table from the \"titanic\" schema; whereas in pandas, we put the name of the data frame in the beginning of the groupby command.", "It is also worth noting that SQL shows missing values when using GROUP BY. From the SQL output we can see that two passengers were missing ports of embarkation.", "If we want to see the average fare amounts for passengers who survived vs. perished, we can use the following command in pandas:", "Which gives out the following output:", "Similarly, we can achieve this in SQL with:", "As we can see, the people who survived paid a much higher fare on average than those who perished.", "There were three passenger classes (\u201cPclass\u201d) on the Titanic, 1, 2, and 3. Suppose we want to inspect the percentage of people who survived vs. perished for each class, we can use the following groupby command in conjunction with the.apply() method in pandas:", "Note that in the .apply() method, we can pass a lambda function to calculate the percentage.", "This can also be achieved in SQL using WINDOW functions:", "We can conclude that the survival rates decreases as the passenger classes decreases.", "This will conclude my blog post. The implementations of Group By in pandas and SQL are very versatile and can be used in conjunction with many other functions, which deserves further exploration.", "Thank you for reading. As always, I\u2019d love to hear from you if you have any comments or feedback.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "I am a Data Engineer with a background in academic research. I am interested in developing automation tools for data science and machine learning models."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F94777ce48658&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgroup-by-in-pandas-and-sql-94777ce48658&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgroup-by-in-pandas-and-sql-94777ce48658&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgroup-by-in-pandas-and-sql-94777ce48658&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgroup-by-in-pandas-and-sql-94777ce48658&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----94777ce48658--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----94777ce48658--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@freda.xin?source=post_page-----94777ce48658--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@freda.xin?source=post_page-----94777ce48658--------------------------------", "anchor_text": "Freda Xin"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F68799d14abf&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgroup-by-in-pandas-and-sql-94777ce48658&user=Freda+Xin&userId=68799d14abf&source=post_page-68799d14abf----94777ce48658---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F94777ce48658&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgroup-by-in-pandas-and-sql-94777ce48658&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F94777ce48658&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgroup-by-in-pandas-and-sql-94777ce48658&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://pandas.pydata.org/pandas-docs/stable/user_guide/groupby.html", "anchor_text": "documentation for the GroupBy object"}, {"url": "https://www.kaggle.com/c/titanic/data", "anchor_text": "Titanic Kaggle Competition"}, {"url": "https://www.postgresql.org/docs/current/tutorial-window.html", "anchor_text": "WINDOW functions"}, {"url": "https://www.amazon.com/dp/1491912057/ref=cm_sw_em_r_mt_dp_U_E2gqEbTK340BE", "anchor_text": "Python Data Science Handbook"}, {"url": "https://www.postgresql.org/docs/current/tutorial-window.html", "anchor_text": "SQL Window Functions"}, {"url": "https://pandas.pydata.org/pandas-docs/stable/user_guide/groupby.html", "anchor_text": "Pandas Documentation for the GroupBy Object"}, {"url": "http://www.allrights-reserved.com/art-exhibition-detail.php?id=16", "anchor_text": "1600 PANDAS+ WORLD TOUR"}, {"url": "https://github.com/FredaXin/blog_posts/blob/master/group_by/group_by.md", "anchor_text": "https://github.com"}, {"url": "https://medium.com/tag/data-science?source=post_page-----94777ce48658---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/pandas?source=post_page-----94777ce48658---------------pandas-----------------", "anchor_text": "Pandas"}, {"url": "https://medium.com/tag/sql?source=post_page-----94777ce48658---------------sql-----------------", "anchor_text": "Sql"}, {"url": "https://medium.com/tag/data-analysis?source=post_page-----94777ce48658---------------data_analysis-----------------", "anchor_text": "Data Analysis"}, {"url": "https://medium.com/tag/tutorial?source=post_page-----94777ce48658---------------tutorial-----------------", "anchor_text": "Tutorial"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F94777ce48658&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgroup-by-in-pandas-and-sql-94777ce48658&user=Freda+Xin&userId=68799d14abf&source=-----94777ce48658---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F94777ce48658&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgroup-by-in-pandas-and-sql-94777ce48658&user=Freda+Xin&userId=68799d14abf&source=-----94777ce48658---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F94777ce48658&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgroup-by-in-pandas-and-sql-94777ce48658&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----94777ce48658--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F94777ce48658&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgroup-by-in-pandas-and-sql-94777ce48658&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----94777ce48658---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----94777ce48658--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----94777ce48658--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----94777ce48658--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----94777ce48658--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----94777ce48658--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----94777ce48658--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----94777ce48658--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----94777ce48658--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@freda.xin?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@freda.xin?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Freda Xin"}, {"url": "https://medium.com/@freda.xin/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "259 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F68799d14abf&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgroup-by-in-pandas-and-sql-94777ce48658&user=Freda+Xin&userId=68799d14abf&source=post_page-68799d14abf--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fusers%2F68799d14abf%2Flazily-enable-writer-subscription&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgroup-by-in-pandas-and-sql-94777ce48658&user=Freda+Xin&userId=68799d14abf&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}