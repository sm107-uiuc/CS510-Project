{"url": "https://towardsdatascience.com/predicting-snowmelt-patterns-with-deep-learning-and-satellite-imagery-86b7059a3914", "time": 1683001596.8466601, "path": "towardsdatascience.com/predicting-snowmelt-patterns-with-deep-learning-and-satellite-imagery-86b7059a3914/", "webpage": {"metadata": {"title": "Predicting Snowmelt Patterns with Deep Learning and Satellite Imagery | by YK Sugi | Towards Data Science", "h1": "Predicting Snowmelt Patterns with Deep Learning and Satellite Imagery", "description": "The other day, I interviewed Jessica Li, a data scientist at Kaggle, for the Towards Data Science podcast. In this article, I\u2019d like to present some of the highlights from the interview. As more and\u2026"}, "outgoing_paragraph_urls": [{"url": "https://towardsdatascience.com/podcast/home", "anchor_text": "Towards Data Science podcast", "paragraph_index": 0}, {"url": "https://twitter.com/jessicali9530", "anchor_text": "Twitter at @jessicali9530", "paragraph_index": 2}, {"url": "https://towardsdatascience.com/understanding-lstm-and-its-quick-implementation-in-keras-for-sentiment-analysis-af410fd85b47", "anchor_text": "There is a good TDS article that explains LSTM neural networks well down to the math.", "paragraph_index": 40}], "all_paragraphs": ["The other day, I interviewed Jessica Li, a data scientist at Kaggle, for the Towards Data Science podcast. In this article, I\u2019d like to present some of the highlights from the interview.", "Below, I\u2019m going to share some of the questions I asked her, as well as summaries of her responses.", "Note: You can follow Jessica on Twitter at @jessicali9530 for future updates from her.", "Geography used to be more about making maps, but not anymore.", "As more and more satellite/spatial imagery has become available, and as computing a large amount of data has become more efficient, it has become possible to run machine learning models on geo-spatial data. This is what I learned in school, too.", "When I started applying to data science jobs, I noticed that there\u2019s definitely some overlap there. These skills included Python, R, and obviously, data science and machine learning.", "Yes, but undergrad was an interesting time for me because I didn\u2019t have a single major for 4 years. I jumped around a lot, and I went from pre-med to accounting to geography, which I love. I only studied geography for the last 2 years for my undergrad.", "That\u2019s also why I say I\u2019m still learning. It\u2019s only been 1.5 years out of college, and like many others, I\u2019m very self-taught in data science. So, the learning journey continues for me.", "Like they say, networking is the key. I moved to New York, and I didn\u2019t have a job offer 2\u20133 months after finishing my degree. So, there was some uncertainty of not knowing what my job was going to be.", "My third month in, I went to a meetup which I found on meetup.com. I highly recommend checking out this site if you\u2019re looking for a job.", "The meetup I went to was called Geo NYC. There, people were sharing a lot of the geospatial analysis they had done for work or in their own time. I met somebody there who introduced me to the team, and the rest is history from there.", "Yes, I would say it was one of the riskiest moves I had ever made. I had moved a few times before. I\u2019m Australian, but I lived in China for a while, and I moved to LA for school. So, moving itself wasn\u2019t scary, but moving to a city where I didn\u2019t know a lot of people was definitely a risky move.", "When I think about the big moments that led me to where I am today, though, all of those were risky decisions. So, I feel like if I had played safe, I wouldn\u2019t be where I am today.", "Sure! This was a 10\u2013week, self-contained research project with NASA. This was in the summer of 2018. I worked with two other teammates.", "The scope of the project was to predict water availability in the Fremont River basin in Utah. The National Park Service there wanted a tool to assess the amount of water they are getting from the river basin every year after the snowmelt season. Streamflow assessments were terrible and they weren\u2019t getting good predictions on how much water they were going to get each year.", "This was an important project for them because the Fremont River basin provides about 16,000 acres of agriculture worth of irrigation. So, it was really important for NPS to know how much water they were going to get so they could make the right water management decisions. However, things weren\u2019t in good shape. That\u2019s why NASA wanted our team to build a model that can predict that a little better.", "Good question. It took some time to think about what the target variable is. In this case, we were interested in what happens after snowfalls. In other words, we decided that streamflow was going to be our target variable. Streamflow is just the amount of water flowing in the river at a given point.", "That\u2019s right. Now, in a typical machine learning project, you start off exploring your data to determine what kind of information is relevant to your project. Then, you will want to identify your target variable \u2014 in this case, the streamflow. The next part would be data collection and feature engineering. In this part, you will want to collect all the predictive variables you think will impact or help predict the target variable.", "I think what makes this project a bit more niche is that we had satellite imagery as predictive variables.", "So, NASA has a suite of earth observations and satellite imageries. In the end, we had a lot of computation to go through because these data consist of many pixels. It was a lot of data, but they turned out to be good predictive variables to predict streamflow.", "We had MODIS, which gave us two different kinds of information \u2014 that\u2019s two variables. PERSIANN-CDR \u2014 these are all satellite names \u2014 was for precipitations, so that\u2019s three. With a few more data sources, we had 8 or 9 variables in total. These were daily information, and we had them over a 2\u20133 year timeframe. So, that\u2019s a lot of data as you can imagine. Our final dataset was 13\u201314 columns of data, containing about 3 years worth of observations.", "Definitely into gigabytes. A satellite records information as an image of some part of Earth. The satellite might take, for example, the land surface temperature of the U.S. once a day. So, that would be an image, where every single pixel would represent the temperature of a particular location on Earth.", "Since this is a lot of data, we decided to average some of it. We wanted to get the rough surface temperatures of different areas, and in the end, we ended up dividing the river basin areas into three different regions, and we computed the daily average temperature for each reach region.", "We also did the same thing for the snow-covered area. For this one, instead of taking the average, we wanted to compute the total area. Just like we did for the temperature, we would add up all the pixels corresponding to snow and find the total area.", "Yeah, and I\u2019m going to geek out about how satellite imagery works here. This is really the part of geography that drew me to the major.", "Now, when we take a picture of anything, we are essentially recording some kind of information.", "What that means for satellite imagery and digital photography is that every pixel has some kind of electromagnetic spectrum information.", "So, every single thing on Earth reflects light in some way across the electromagnetic spectrum. One way you can digitally identify snow is by its unique reflection spectrum. Snow is white, and it has chemical components that result in it having a distinct signature.", "With that in mind, you go through each pixel, looking for a curve with a specific shape. With this type of computation, you\u2019ll be able to identify which pixels are snow and which ones are not.", "Here, it\u2019s important to keep in mind that it\u2019s not a binary thing. You\u2019ll have a continuous spectrum of how close each pixel resembles the electromagnetic signature. For example, a given area might have an 80% match with it. So, you\u2019ll end up with a confidence level, e.g., \u201cthis is more likely snow\u201d, and, \u201cthis is less likely snow.\u201d After reclassifying each pixel based on this, you\u2019ll be able to get a clearer sense of how much snow we actually have in a given picture.", "We had 10\u201311 predictor variables, and out of those, 4 of them were satellite imagery.", "That\u2019s right. Non-image like data were essentially tabular. An example would be daily snow water equivalent, which I believe has to do with the amount of water contained in snow \u2014 as in how much water can this snow make, essentially. That\u2019s given in tabular information.", "The target variable is also tabular \u2014daily streamflow.", "So, essentially, we had a bunch of image-like data and tabular data.", "Then, we would separate that into training data and test data.", "If we had, say, 2\u20133 years of data, only the last 6 months counted as test data. The rest was treated as training data.", "We ended up using the LSTM model, which stands for the Long Short-Term Memory model.", "Neural networks have many variables, and LSTM is one of them. It\u2019s a type of recurrent neural networks. I might not be the best person to explain it, but I\u2019ll try!", "From a very high level, recurrent networks are just like neural networks, but the catch is they have loops. They are good for time forecasting problems, where you have something that happened earlier that impacts your analysis later.", "For example, in our project, snowmelt definitely has a time lag factor to it. Just because our satellite imagery shows that we had this much snow that day, it doesn\u2019t mean that we\u2019ll get some streamflow that same day yet. So, there\u2019s some kind of time element that we need to take into account. Recurrent neural nets have that memory component that is good for capturing that. It enables us to relate yesterday\u2019s variables to tomorrow\u2019s streamflow.", "There is a good TDS article that explains LSTM neural networks well down to the math. I think the analogy used in the article was a human reading an essay. When you read a sentence, you understand it based on earlier words you read in the sentence. There\u2019s some continuity there and you have to look at the big picture to understand everything that\u2019s happening. Traditional neural nets wouldn\u2019t be able to capture this type of information. On the other hand, RNN\u2019s would be able to.", "With any kind of problem, what I like to do is try out all the standard models first. So, you might be able to think about the scope of your problem and start classifying your problem. For example, is it a binary classification problem? Is it a multi-classification problem? Is this time series, tabular, sentiment analysis, etc.? With this problem, it obviously looked like a time forecasting problem.", "Based on that, I just got on scikit-learn and tried some of the industry-standard models. It\u2019s always nice to try simple regression, and we tried that. Then, we fed it into SVM. And of course, we tried XGBoost.", "Before we tried LSTM, we tried an ARIMA model first. Before LSTM has become popular, ARIMA used to be more mainstream. It\u2019s known to be able to take into account some of that time relation I mentioned earlier. However, it did not yield very accurate results.", "What helped me pick LSTM as our predictive model here is talking to someone who had solved a similar problem. I found a similar paper online that that was also about using satellite imagery data over time to make predictions.", "I got in touch with this person, and he was able to listen to my problem and he suggested that I use LSTM. And it worked out, so big credits to him.", "Yes, LSTM outperformed everything else by far. We were experiencing either inaccurate predictions or too much overfitting with ARIMA. By the time we were testing on test data, the predictions were off \u2014 and it felt like the predictions were very static.", "Snowmelt has an ebb-and-flow look to it, and while all the models were able to understand it, they couldn\u2019t necessarily capture a difference in the rate of snowmelt through the years. The snowmelt had been happening earlier and earlier in this region in the past 17 years, and the streamflow was also decreasing. A lot of models couldn\u2019t capture this type of long-term trend even though they could capture basic up and down movements.", "Yes, it was great at that. I remember, in last year\u2019s data, there was definitely a decrease in streamflow, but it was subtle. LSTM was the only one that was able to capture it.", "There were many challenges here, and feature engineering was one of them. One thing that made this problem especially difficult in this aspect was the knowledge one needed to have to understand things like temperature trends. One particularly challenging aspect was understanding how snow worked.", "In school, my specialty was looking at water resources, and with this project, it was surprising how differently water and snow behaved. I had to learn a lot of random things about snow. For example, one might say that we should consider a parameter that captures the speed of snowmelt down the mountain. That is, snow might melt faster on some days and slower on some other days. We were trying to find a parameter that captured this, and that involved learning a lot of water science.", "Yes. Originally, the recommended scope of this project didn\u2019t suggest using machine learning anywhere. We came in, and the problem was to simply to predict streamflow. There were some suggested papers to read, and NASA also had some frameworks they thought we could base our work on.", "This was a challenge as a project lead because it looked like the suggested approach could work, but it wasn\u2019t really what we wanted to do. I think it speaks to this paradigm of going from traditional programming into data science \u2014 and the efforts to try to apply it to more things around us.", "This model was built in a traditional manner, meaning that many of the values and algorithms were hard-coded specifically for whatever it was built for.", "I remember the model was built for a Chilean water resources project, so we would\u2019ve had to recreate the model. All the weights and algorithms were suited for that specific project.", "All in all, this was a stressful point in this project. We were 3 weeks into our 10 weeks. I had learned MATLAB quickly to look at the models, and it felt like it was not the approach my team wanted to take. At that point, I had to escalate it to my manager and others to say that we wanted to try something else.", "Naturally, if you want to change the scope of the project, you\u2019re going to have to come up with a proposal. By the time we had spoken to these people, we had thought of using machine learning instead. So, we came up with a new scope specifying what kinds of data and models we wanted to try.", "It took some convincing because machine learning is still a relatively new field. Even though it\u2019s something everyone talks about in tech, when you extrapolate that to the government and things like NPS, many people are still not familiar with it. It\u2019s going to be a process that can take years or generations to get them to understand how it works.", "Machine learning advocacy is very important for me, and in this project, we were able to advocate for that. In the end, they let us do it, and I was happy about that, too.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F86b7059a3914&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-snowmelt-patterns-with-deep-learning-and-satellite-imagery-86b7059a3914&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-snowmelt-patterns-with-deep-learning-and-satellite-imagery-86b7059a3914&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-snowmelt-patterns-with-deep-learning-and-satellite-imagery-86b7059a3914&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-snowmelt-patterns-with-deep-learning-and-satellite-imagery-86b7059a3914&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----86b7059a3914--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----86b7059a3914--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@ykdojo?source=post_page-----86b7059a3914--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@ykdojo?source=post_page-----86b7059a3914--------------------------------", "anchor_text": "YK Sugi"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F539e9e1c30df&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-snowmelt-patterns-with-deep-learning-and-satellite-imagery-86b7059a3914&user=YK+Sugi&userId=539e9e1c30df&source=post_page-539e9e1c30df----86b7059a3914---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F86b7059a3914&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-snowmelt-patterns-with-deep-learning-and-satellite-imagery-86b7059a3914&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F86b7059a3914&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-snowmelt-patterns-with-deep-learning-and-satellite-imagery-86b7059a3914&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://podcasts.apple.com/ca/podcast/towards-data-science/id1470952338?mt=2", "anchor_text": "APPLE"}, {"url": "https://www.google.com/podcasts?feed=aHR0cHM6Ly9hbmNob3IuZm0vcy8zNmI0ODQ0L3BvZGNhc3QvcnNz", "anchor_text": "GOOGLE"}, {"url": "https://open.spotify.com/show/63diy2DtpHzQfeNVxAPZgU", "anchor_text": "SPOTIFY"}, {"url": "https://anchor.fm/towardsdatascience", "anchor_text": "OTHERS"}, {"url": "https://towardsdatascience.com/podcast/home", "anchor_text": "Towards Data Science podcast"}, {"url": "https://twitter.com/jessicali9530", "anchor_text": "Twitter at @jessicali9530"}, {"url": "https://towardsdatascience.com/understanding-lstm-and-its-quick-implementation-in-keras-for-sentiment-analysis-af410fd85b47", "anchor_text": "There is a good TDS article that explains LSTM neural networks well down to the math."}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----86b7059a3914---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----86b7059a3914---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/tds-podcast?source=post_page-----86b7059a3914---------------tds_podcast-----------------", "anchor_text": "Tds Podcast"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----86b7059a3914---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/towards-data-science?source=post_page-----86b7059a3914---------------towards_data_science-----------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F86b7059a3914&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-snowmelt-patterns-with-deep-learning-and-satellite-imagery-86b7059a3914&user=YK+Sugi&userId=539e9e1c30df&source=-----86b7059a3914---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F86b7059a3914&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-snowmelt-patterns-with-deep-learning-and-satellite-imagery-86b7059a3914&user=YK+Sugi&userId=539e9e1c30df&source=-----86b7059a3914---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F86b7059a3914&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-snowmelt-patterns-with-deep-learning-and-satellite-imagery-86b7059a3914&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----86b7059a3914--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F86b7059a3914&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-snowmelt-patterns-with-deep-learning-and-satellite-imagery-86b7059a3914&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----86b7059a3914---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----86b7059a3914--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----86b7059a3914--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----86b7059a3914--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----86b7059a3914--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----86b7059a3914--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----86b7059a3914--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----86b7059a3914--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----86b7059a3914--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@ykdojo?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@ykdojo?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "YK Sugi"}, {"url": "https://medium.com/@ykdojo/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "10.7K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F539e9e1c30df&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-snowmelt-patterns-with-deep-learning-and-satellite-imagery-86b7059a3914&user=YK+Sugi&userId=539e9e1c30df&source=post_page-539e9e1c30df--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fa16894d73d39&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-snowmelt-patterns-with-deep-learning-and-satellite-imagery-86b7059a3914&newsletterV3=539e9e1c30df&newsletterV3Id=a16894d73d39&user=YK+Sugi&userId=539e9e1c30df&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}