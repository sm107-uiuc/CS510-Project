{"url": "https://towardsdatascience.com/detection-free-human-instance-segmentation-using-pose2seg-and-pytorch-72f48dc4d23e", "time": 1682996317.909886, "path": "towardsdatascience.com/detection-free-human-instance-segmentation-using-pose2seg-and-pytorch-72f48dc4d23e/", "webpage": {"metadata": {"title": "Detection Free Human Instance Segmentation using Pose2Seg and PyTorch | by Erez Posner | Towards Data Science", "h1": "Detection Free Human Instance Segmentation using Pose2Seg and PyTorch", "description": "In recent years, research related to \u201chumans\u201d in the computer vision community has become increasingly active because of the high demand for real-life applications, among them is instance\u2026"}, "outgoing_paragraph_urls": [{"url": "https://engineering.matterport.com/splash-of-color-instance-segmentation-with-mask-r-cnn-and-tensorflow-7c761e238b46", "anchor_text": "Mask R-CNN", "paragraph_index": 1}, {"url": "https://arxiv.org/pdf/1803.10683.pdf", "anchor_text": "\u201cPose2Seg: Detection Free Human Instance Segmentation\u201d", "paragraph_index": 3}, {"url": "https://github.com/erezposner/Pose2Seg", "anchor_text": "here", "paragraph_index": 5}, {"url": "https://arxiv.org/pdf/1803.10683.pdf", "anchor_text": "paper", "paragraph_index": 17}, {"url": "https://arxiv.org/abs/1611.08050", "anchor_text": "part affinity fields (PAFs)", "paragraph_index": 18}, {"url": "https://github.com/erezposner/Pose2Seg", "anchor_text": "Pose2Seg GitHub repository", "paragraph_index": 26}, {"url": "http://www.linkedin.com/in/erezposner", "anchor_text": "LinkedIn", "paragraph_index": 27}], "all_paragraphs": ["In recent years, research related to \u201chumans\u201d in the computer vision community has become increasingly active because of the high demand for real-life applications, among them is instance segmentation.", "The standard approach to image instance segmentation is to perform the object detection first, and then segment the object from the detection bounding-box. More recently, deep learning methods like Mask R-CNN perform them jointly. However, as human associated tasks becoming more common like human recognition, tracking etc. one might wonder why does the uniqueness of the \u201chuman\u201d category does not taken into account.", "The uniqueness of the \u201chuman\u201d category, can be well defined by the pose skeleton. Moreover, the human pose skeleton can be used to better distinguish instances with heavy occlusion than using bounding-boxes.", "In this post, I am going to review \u201cPose2Seg: Detection Free Human Instance Segmentation\u201d, which presents a new pose-based instance segmentation framework for humans which separates instances based on human pose.", "In this post I\u2019ll cover two things: First, an overview of Instance Segmentation task. Second, an overview of \u201cPose2Seg\u201d.", "Code Tip:We\u2019re sharing the code here. Including the dataset and the trained model. Follow along!", "Instance segmentation a task where we want to identify each object at the pixel level. This means that labels are both class-aware and instance-aware. E.g. Figure 2(d) visualizes a separate labeling for sheep 1, sheep 2, etc.", "Instance segmentation is considered the most challenging among the common use-cases:", "The main idea behind Pose2Seg is that while General Object Instance Segmentation approaches work well, the majority are based on powerful object detection baseline. i.e. first generate a large number of proposal regions, then remove the redundant regions using Non-maximum Suppression (NMS) as shown in Figure 3.", "However, when two objects of the same category have a large overlap, NMS will treat one of them as a redundant proposal region and eliminates it. This means that almost all the object detection methods cannot deal with the situation of large overlaps.", "But, when dealing with mostly \u201chuman\u201d category, it can be well defined by the pose skeleton. As shown in Figure 1, Human pose skeletons are more suitable for distinguishing two heavily intertwined people, because they can provide more distinct information about a person than bounding-boxes, such as the location and visibility of different body parts.", "The main idea of the bottom-up methods is to first detect keypoints for each body part for all the people, and then group or connect those parts to form several instances of human pose, which makes it possible to separate two intertwined human instances with a large overlap", "A overall network structure is shown in Figure 4 below. The input for the network is both RGB image and human pose for all human instances exist. Firstly, a backbone network is used to extract the features of the image. Then, the module called Affine-Align is used to align RoIs to a uniform size (for consistency) based on the human pose. In addition, skeleton features are generated for each human instance.", "Now, both RoIs and skeleton features are fused and passed to the segmentation module called SegModule to yield instance segmentation per RoI. Finally, the estimated matrices in Affine-Align operation to reverse the alignment for each instance and get the final segmentation results.", "The networks sub-modules are describe in details the subsections below.", "The Affine-Align operation is mainly inspired by the RoI-Pooling presented in Faster R-CNN and RoI-Align in Mask R-CNN. But, while those align human according to their bounding-boxes, Affine-Align is used to align based on human pose.", "To do that, the most frequent human poses are stored offline, later to be compared with every input pose at training/inference (see Figure 5 below). The idea is to choose the best template for each estimated pose. This is accomplished by estimating an affine transformation matrix H between input pose and the templates and choosing the one yielding the best score.", "Here P_u represent a pose template and P represent a single person pose estimation. The matrix H* is the affine transform chosen for the best suited per pose template. Finally, The transformation H* that results with the best score is applied on the image or features and transform it to the desired resolution. There are a lot more details on Affine-Align Operation, please refer to the paper for more details.", "Figure 6 shows the skeleton features. For this task part affinity fields (PAFs) is adopted. The output from PAF is a 2-channel vector field map for each skeleton. PAF is used to represent the skeleton structure of a human pose along with a part confidence maps for body parts to emphasize the importance of those regions around the body part keypoints.", "The SegModule is a simple Encoder-Decoder architecture. One main consideration is its receptive field. As skeleton features were introduced after alignment the SegModule needs to have enough receptive fields to not only fully understand these artificial features, but also learn the connections between them and the image features extracted by the base network. There fore it is designed based on the resolution of the aligned RoIs.", "The networks starts with a 7 \u00d7 7, stride-2 convolution layer, and is followed by several standard residual units to achieve a large enough receptive field for the RoIs. After that, a bilinear up-sampling layer is used to restore the resolution, and another residual unit, along with a 1 \u00d7 1 convolution layer are used to predict the final result. Such a structure with 10 residual units can achieve about 50 pixels of receptive field, corresponding to the alignment size of 64 \u00d7 64. Fewer units will make the network less capable of learning, and more units enable little improvement on the learning ability.", "Pose2Seg was evaluated on two datasets: (1) OCHuman, which is the largest validation dataset that is focused on heavily occluded humans, and proposed in this paper; and (2) COCOPersons (the person category of COCO), which contains the most common scenarios in daily life.", "The algorithm was mainly compared to Mask-RCNN, the commonly used detection based instance segmentation framework.", "In the test on occluded data using OCHuman data set, as shown in Table 1 Pose2Seg framework achieved nearly 50% higher that the performance of Mask R-CNN.", "In the test on general cases , evaluated on COCOPerson validation set Pose2Seg got 0.582 AP (Avergare precision) on the instance segmentation task, while Mask R-CNN got 0.532. See Table 2.", "To get a better understanding on the advantages of Pose2Seg from bounding-box based frameworks see Figure 7 below. See how \u201cout-of-box\u201d organs are not segmented in Mask R-CNN.", "if you\u2019re interested in the source code it can be found in my Pose2Seg GitHub repository.", "As always, if you have any questions or comments feel free to leave your feedback below or you can always reach me on LinkedIn.", "Till then, see you in the next post! \ud83d\ude04", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F72f48dc4d23e&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdetection-free-human-instance-segmentation-using-pose2seg-and-pytorch-72f48dc4d23e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdetection-free-human-instance-segmentation-using-pose2seg-and-pytorch-72f48dc4d23e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdetection-free-human-instance-segmentation-using-pose2seg-and-pytorch-72f48dc4d23e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdetection-free-human-instance-segmentation-using-pose2seg-and-pytorch-72f48dc4d23e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----72f48dc4d23e--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----72f48dc4d23e--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@erezposner?source=post_page-----72f48dc4d23e--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@erezposner?source=post_page-----72f48dc4d23e--------------------------------", "anchor_text": "Erez Posner"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fb21945456dac&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdetection-free-human-instance-segmentation-using-pose2seg-and-pytorch-72f48dc4d23e&user=Erez+Posner&userId=b21945456dac&source=post_page-b21945456dac----72f48dc4d23e---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F72f48dc4d23e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdetection-free-human-instance-segmentation-using-pose2seg-and-pytorch-72f48dc4d23e&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F72f48dc4d23e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdetection-free-human-instance-segmentation-using-pose2seg-and-pytorch-72f48dc4d23e&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@jezael?utm_source=medium&utm_medium=referral", "anchor_text": "Jezael Melgoza"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://engineering.matterport.com/splash-of-color-instance-segmentation-with-mask-r-cnn-and-tensorflow-7c761e238b46", "anchor_text": "Mask R-CNN"}, {"url": "https://arxiv.org/pdf/1803.10683.pdf", "anchor_text": "\u201cPose2Seg: Detection Free Human Instance Segmentation\u201d"}, {"url": "https://github.com/erezposner/Pose2Seg", "anchor_text": "here"}, {"url": "https://arxiv.org/pdf/1803.10683.pdf", "anchor_text": "paper"}, {"url": "https://arxiv.org/abs/1611.08050", "anchor_text": "part affinity fields (PAFs)"}, {"url": "https://github.com/erezposner/Pose2Seg", "anchor_text": "Pose2Seg GitHub repository"}, {"url": "http://www.linkedin.com/in/erezposner", "anchor_text": "LinkedIn"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----72f48dc4d23e---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----72f48dc4d23e---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/ai?source=post_page-----72f48dc4d23e---------------ai-----------------", "anchor_text": "AI"}, {"url": "https://medium.com/tag/python?source=post_page-----72f48dc4d23e---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/towards-data-science?source=post_page-----72f48dc4d23e---------------towards_data_science-----------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F72f48dc4d23e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdetection-free-human-instance-segmentation-using-pose2seg-and-pytorch-72f48dc4d23e&user=Erez+Posner&userId=b21945456dac&source=-----72f48dc4d23e---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F72f48dc4d23e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdetection-free-human-instance-segmentation-using-pose2seg-and-pytorch-72f48dc4d23e&user=Erez+Posner&userId=b21945456dac&source=-----72f48dc4d23e---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F72f48dc4d23e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdetection-free-human-instance-segmentation-using-pose2seg-and-pytorch-72f48dc4d23e&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----72f48dc4d23e--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F72f48dc4d23e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdetection-free-human-instance-segmentation-using-pose2seg-and-pytorch-72f48dc4d23e&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----72f48dc4d23e---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----72f48dc4d23e--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----72f48dc4d23e--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----72f48dc4d23e--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----72f48dc4d23e--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----72f48dc4d23e--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----72f48dc4d23e--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----72f48dc4d23e--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----72f48dc4d23e--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@erezposner?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@erezposner?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Erez Posner"}, {"url": "https://medium.com/@erezposner/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "159 Followers"}, {"url": "https://www.linkedin.com/in/erezposner/", "anchor_text": "https://www.linkedin.com/in/erezposner/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fb21945456dac&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdetection-free-human-instance-segmentation-using-pose2seg-and-pytorch-72f48dc4d23e&user=Erez+Posner&userId=b21945456dac&source=post_page-b21945456dac--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fusers%2Fb21945456dac%2Flazily-enable-writer-subscription&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdetection-free-human-instance-segmentation-using-pose2seg-and-pytorch-72f48dc4d23e&user=Erez+Posner&userId=b21945456dac&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}