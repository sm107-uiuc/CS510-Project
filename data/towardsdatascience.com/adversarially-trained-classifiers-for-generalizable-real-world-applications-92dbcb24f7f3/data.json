{"url": "https://towardsdatascience.com/adversarially-trained-classifiers-for-generalizable-real-world-applications-92dbcb24f7f3", "time": 1683013260.7617002, "path": "towardsdatascience.com/adversarially-trained-classifiers-for-generalizable-real-world-applications-92dbcb24f7f3/", "webpage": {"metadata": {"title": "Adversarially-Trained Classifiers for Generalizable Real World Applications | by Alan Chen | Towards Data Science", "h1": "Adversarially-Trained Classifiers for Generalizable Real World Applications", "description": "The field of computer vision continuously calls for improved accuracy on classifiers. Researchers everywhere are trying to beat the previous benchmark by just some small margins on one particular\u2026"}, "outgoing_paragraph_urls": [{"url": "https://arxiv.org/abs/1901.08573", "anchor_text": "TRadeoff-inspired Adversarial DEfense via Surrogate-loss minimization (TRADES)", "paragraph_index": 8}, {"url": "https://arxiv.org/abs/1412.6572", "anchor_text": "Explaining and Harnessing Adversarial Example", "paragraph_index": 10}], "all_paragraphs": ["The field of computer vision continuously calls for improved accuracy on classifiers. Researchers everywhere are trying to beat the previous benchmark by just some small margins on one particular dataset. We think this trend is great for pushing the edge of human understanding, but we also believe that there is a larger problem that has been largely underexplored\u2014 building a generalizable classifier.", "So, what is a generalizable neural network? And why is generalizability important? Why can\u2019t we just finetune our neural networks every time to a particular dataset, since the specificity allows us to maintain higher overall accuracy for each of those tasks?", "Generalizability refers to a machine learning model\u2019s resistance to data perturbations that could occur in the real world (i.e random objects in the background, image distortions). The more sensitive it is to randomness, the less generalizable it is. Improving model generalizability allows for models to perform significantly better when we deploy them to solve problems with fully unknown data-distribution.", "This is incredibly important because, in real-world applications when end-users supply us with test-data in real-time, we never know when the underlying data distribution will change! For this reason, it is possible that a breakthrough in generalizing neural models can translate to improvements in performance benchmarks across multiple machine learning tasks such as autonomous driving and voice recognition.", "Therefore, our group\u2019s goal in this project is to create neural models capable of classifying unseen data with unknown perturbations.", "In this article, we will discuss methods of using adversarial examples as training data as well as how to generate them. As a bonus, we will also explore CAM Visualization as a way to explain the adversarial misclassification behaviour at the very end.", "Before we started the design process, we considered TensorFlow 2.0 with Keras and PyTorch. Ultimately, we went with TensorFlow with and Keras since it allows for simpler implementations and a wider variety of pre-trained models. We wanted our project to ultimately be more readable and concise.", "Major design choices in our projects include:", "We also considered implementing TRadeoff-inspired Adversarial DEfense via Surrogate-loss minimization (TRADES) [Zhang et al. 2019], but ultimately left that out for future consideration.", "Even though recent neural networks for computer vision tasks have reached remarkable accuracy, they are still extremely vulnerable to small, human-imperceptible perturbations.", "Previously researchers have speculated that this is due to the nonlinear components of the neural networks, polarizing those activations (think exploding gradients). However, in Explaining and Harnessing Adversarial Example, the authors argued that this vulnerability is actually due to the linear components of neural networks, namely in ReLU, LSTM. Even in the case of the nonlinear sigmoid function, the model will often have most values in the linear regime (i.e when x are close to 0), further supporting this finding.", "In this paper, the authors also described a fast way to generate adversarial examples along with an adversarial training method, which we used. The authors introduced the Fast Gradient Sign Method (FGSM) to efficiently generate adversarial examples: calculate the gradient with respect to the input, and then perturb the input such that:", "Below is an example of FGSM applied to a logistic regression model trained on MNIST threes and sevens in the original paper.", "Perturbation was applied directly on sevens and inverted on threes to make the model misclassify sevens. FGSM can be directly incorporated into the loss function, which indirectly results in additional regularization effect.", "The authors sited better final model accuracy and increased robustness. The error rate on adversarial example error rate was reduced to just 17.9% from 89.4% in the base model.", "For our model, we used an adversarial wrapper around our model during training time only. We won\u2019t include all the code here, but the general framework should look like this.", "There are some hyperparameters that are most important to the wrapper. They are multiplier and step size. Multiplier had a significant influence on regularization, and step size is used to find the adversarial example later on during validation.", "Training time procedure is basically the same as other Keras models, but make sure that datasets are converted dictionaries instead of tuples since you are feeding the data to the wrapper, not the actual classifier.", "During validation, be sure to also create a base reference model to make sure that your adversarial wrapper training working. You should see a significantly higher performance by your adversarial model on perturbed data, and only marginally lower performance on unperturbed data.", "Lastly, remember to use the base model defined in the beginning during test time and validation. The adversarial wrapped model should only be used in training time, and even if you save the adversarial wrapped model\u2019s weights using standard Keras API, it will only save the weight of the base model. So make sure you always load the weights into the base model, then add the wrapper or you will have mismatch issues.", "We used SGD in favour of ADAM due to previous experience and papers suggesting SGD is more suitable for CV tasks. For the same reason, instead of deciding the number of epochs to finetune different layers in advance, we move onto high layers as training loss plateaus.", "Since we were using Keras as our framework of choice, we also tested the same training method on other networks architectures:", "NASNet tends to overfit due to its high number of parameters, and we found that MobileNet V2 performed the best. EfficientNet was a close contender, but we were unable to use it due to its late addition to TensorFlow (it was only available in tf-nightly, so we had new technical issues almost every day).", "We will skip over the process of choosing batch sizes and learning rate since methods for optimizing those are ubiquitous in deep learning papers and other medium posts. We will simply note that they played a big role in training performance and varied across different models.", "Current methods of classification ask for inputs and produce classes without any decipherable explanation for contexts or results. Effectively, this makes deep learning algorithms a black-box for researchers and engineers. In this project, we tackled the Explainable AI Challenge by offering our own explanations for adversarial behaviour and general misclassification.", "For the next few sections, saliency refers to some unique features for a particular input in the context of visual processing. Basically, saliency visualization method allows for emphasis on visually alluring locations on an image that could have \u201ccontributed to\u201d neural work making a particular classification decision.", "There are many choices for which type of saliency we should visualize. Some examples include linear activations or noise generation using guided propagation, but we don\u2019t discuss them here. We simply changed the last layer to a linear activation to see which pixels had the biggest influence on classification decision. We used keras-vis module. The two saliency maps show the positive gradients and negative gradients respectively.", "We will note here that keras-vis is slightly outdated and might not work with some versions of TensorFlow 2.0 Keras.", "Our model was able to correctly predict the cockroach label. We can see the model was able to do this easily since linear activation maximizations in the last layer clearly show the shape of cockroach.", "Our model did not classify this object correctly. This can be explained by the fact that Tiny Image Net has generally lower resolution, resulting in similar activations from objects with similar shapes. The misclassification here was Broom (n02906734 in ImageNet). We can also attribute this to our random crops during training data augmentation, where we might have cropped out the broom handle during training.", "In the following syringe example, the activations from these images are very similar, so our model decided it was a toss between Oboe, Syringe, Broom, and Beer Bottle. These were amongst the top 5 predictions.", "We also visualized some of the adversarial training examples which we generated. The objects are recognizable to humans, but to a neural network, they are often masked with some type of activation nullifications. In the following examples, it is clear that the activations here do not resemble the original object shape in any way as seen earlier.", "Activation and inhibitions become random and distorted.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Software Engineer @ Google, UC Berkeley Graduate"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F92dbcb24f7f3&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fadversarially-trained-classifiers-for-generalizable-real-world-applications-92dbcb24f7f3&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fadversarially-trained-classifiers-for-generalizable-real-world-applications-92dbcb24f7f3&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fadversarially-trained-classifiers-for-generalizable-real-world-applications-92dbcb24f7f3&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fadversarially-trained-classifiers-for-generalizable-real-world-applications-92dbcb24f7f3&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----92dbcb24f7f3--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----92dbcb24f7f3--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://alan-s-chen.medium.com/?source=post_page-----92dbcb24f7f3--------------------------------", "anchor_text": ""}, {"url": "https://alan-s-chen.medium.com/?source=post_page-----92dbcb24f7f3--------------------------------", "anchor_text": "Alan Chen"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F38c2bb36de15&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fadversarially-trained-classifiers-for-generalizable-real-world-applications-92dbcb24f7f3&user=Alan+Chen&userId=38c2bb36de15&source=post_page-38c2bb36de15----92dbcb24f7f3---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F92dbcb24f7f3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fadversarially-trained-classifiers-for-generalizable-real-world-applications-92dbcb24f7f3&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F92dbcb24f7f3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fadversarially-trained-classifiers-for-generalizable-real-world-applications-92dbcb24f7f3&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://medium.com/@danielshin_57049", "anchor_text": "Daniel Shin"}, {"url": "https://github.com/klinime", "anchor_text": "Kevin Liwen Lin"}, {"url": "https://unsplash.com/@ikukevk?utm_source=medium&utm_medium=referral", "anchor_text": "Kevin Ku"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://arxiv.org/abs/1801.04381", "anchor_text": "MobileNet v2"}, {"url": "https://www.tensorflow.org/neural_structured_learning/api_docs/python/nsl/keras/AdversarialRegularization", "anchor_text": "Neural Structured Learning (NSL) Adversarial Regularization"}, {"url": "https://arxiv.org/abs/1901.08573", "anchor_text": "TRadeoff-inspired Adversarial DEfense via Surrogate-loss minimization (TRADES)"}, {"url": "https://arxiv.org/abs/1412.6572", "anchor_text": "Explaining and Harnessing Adversarial Example"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----92dbcb24f7f3---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/adversarial-attack?source=post_page-----92dbcb24f7f3---------------adversarial_attack-----------------", "anchor_text": "Adversarial Attack"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----92dbcb24f7f3---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----92dbcb24f7f3---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/editors-pick?source=post_page-----92dbcb24f7f3---------------editors_pick-----------------", "anchor_text": "Editors Pick"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F92dbcb24f7f3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fadversarially-trained-classifiers-for-generalizable-real-world-applications-92dbcb24f7f3&user=Alan+Chen&userId=38c2bb36de15&source=-----92dbcb24f7f3---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F92dbcb24f7f3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fadversarially-trained-classifiers-for-generalizable-real-world-applications-92dbcb24f7f3&user=Alan+Chen&userId=38c2bb36de15&source=-----92dbcb24f7f3---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F92dbcb24f7f3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fadversarially-trained-classifiers-for-generalizable-real-world-applications-92dbcb24f7f3&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----92dbcb24f7f3--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F92dbcb24f7f3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fadversarially-trained-classifiers-for-generalizable-real-world-applications-92dbcb24f7f3&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----92dbcb24f7f3---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----92dbcb24f7f3--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----92dbcb24f7f3--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----92dbcb24f7f3--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----92dbcb24f7f3--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----92dbcb24f7f3--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----92dbcb24f7f3--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----92dbcb24f7f3--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----92dbcb24f7f3--------------------------------", "anchor_text": ""}, {"url": "https://alan-s-chen.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://alan-s-chen.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Alan Chen"}, {"url": "https://alan-s-chen.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "20 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F38c2bb36de15&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fadversarially-trained-classifiers-for-generalizable-real-world-applications-92dbcb24f7f3&user=Alan+Chen&userId=38c2bb36de15&source=post_page-38c2bb36de15--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fusers%2F38c2bb36de15%2Flazily-enable-writer-subscription&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fadversarially-trained-classifiers-for-generalizable-real-world-applications-92dbcb24f7f3&user=Alan+Chen&userId=38c2bb36de15&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}