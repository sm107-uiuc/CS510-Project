{"url": "https://towardsdatascience.com/how-to-obtain-and-analyse-fitbit-sleep-scores-a739d7c8df85", "time": 1683012041.323103, "path": "towardsdatascience.com/how-to-obtain-and-analyse-fitbit-sleep-scores-a739d7c8df85/", "webpage": {"metadata": {"title": "How To Obtain And Analyse Fitbit Sleep Scores | by Jonas Benner | Aug, 2020 | Medium | Towards Data Science", "h1": "How to Obtain and Analyse Fitbit Sleep Scores", "description": "This article demonstrates how to obtain sleep data from Fitbit and run your own analysis of the data to find patterns and understand the Sleep Score better."}, "outgoing_paragraph_urls": [{"url": "https://medium.com/@bennerjonas10/using-machine-learning-to-predict-fitbit-sleep-scores-496a7d9ec48", "anchor_text": "Part 2", "paragraph_index": 3}, {"url": "https://medium.com/@bennerjonas10/cross-validation-and-hyperparameter-tuning-how-to-optimise-your-machine-learning-model-13f005af9d7d", "anchor_text": "Part 3", "paragraph_index": 3}, {"url": "https://github.com/JoBe10/Fitbit-Sleep-Score/blob/master/Sleep_Scores/Fitbit_Sleep_Score_Prediction.ipynb", "anchor_text": "full notebook", "paragraph_index": 16}], "all_paragraphs": ["Smartwatches and other wearable devices have gained popularity over the past couple of years and have given rise to the cultural phenomenon of the \u201cQuantified Self\u201d. Devices such as the Apple Watch or Fitbit have made it possible for anyone to easily self-track and thereby quantify their lives in some way. Popular self-quantifications include calories burnt, steps walked during the day or quality of sleep.", "In this article, I will focus on the latter, namely quality of sleep, using real life data from approximately one year of Fitbit usage. Fitbit provides users with a Sleep Score, which is supposed to be a measure of sleep quality. I will train and test different Machine Learning models using Python in an attempt to predict the Fitbit Sleep Score as accurately as possible while providing an explanation of how different metrics, such as minutes of REM sleep, affect the score.", "The article is structured as follows:", "Because there is a lot to cover, I split the article into three parts. Part 1 covers points 1 through 4 and focuses on getting the sleep data, preprocessing and visualising it. Part 2 covers points 5 through 10, i.e. actually building the Machine Learning models based on the preprocessed data from part 1. Part 3 covers the rest and is all about improving the models from part 2 to get the most accurate predictions possible.", "The Fitbit Sleep Score is best described through an example, so here are two screenshots of what the App provides to its users:", "In the Fitbit App, users are given a Sleep Score, which is 78 in this case, a graphical representation of the sleep stages across the sleep window, the concrete breakdown of these sleep stages in minutes as well as percent and an estimated oxygen variation.", "This in and of itself seems fairly straight forward. Fitbit just has some algorithm that they plug the relevant sleep statistics, such as minutes spent in REM sleep, into and it spits out the Sleep Score.", "To anyone with a Fitbit who has ever tried to understand patterns in their Sleep Score it is clear that this is far from straight forward. The below screenshots will make it clear where the confusion is coming from:", "Comparing these sleep statistics to the first ones tells us the following:", "Based on these observations one would expect the second sleep score to be higher than the first one but it is actually the same. What is going on here? What role do the different statistics play in the calculation of the Sleep Score? Is it possible to predict Sleep Scores yourself by only looking at the sleep statistics provided?", "This article answers all those questions and provides a detailed walk-through of a Machine Learning project. I hope you enjoy it!", "Fitbit allows users to export sleep data in CSV files through their online dashboards. This process turned out to involve a bit of manual labor because Fitbit only allows a maximum of 31 days of data to be exported at a time. A few minutes later I had all the data and quickly combined them into one CSV file.", "There was one problem. The manually exported CSV files included all of the sleep statistics (Minutes Asleep, Minutes Awake, Minutes REE Sleep, etc.) but did not include the actual sleep score. What the hell?!", "After some digging, I discovered that there was another export option called \u201cLifetime Export\u201d, which exports all the data Fitbit has collected on you ever since you started wearing their watch. You have to request this export from Fitbit before being able to download it and once approved you can download a zip folder with all sorts of different files. Included in that zip folder is a CSV file with additional sleep statistics, including the Sleep Score.", "I saved the CSV file containing the sleep statistics as sleep_stats.csv and the the CSV file containing the Sleep Scores as sleep_score.csv. Let\u2019s move on to Python.", "This section explains how to get from the CSV file to a DataFrame that is ready to be used in Machine Learning models. In the process, I encountered some common problems that can arise when importing data into Python and I explain how to deal with them in order to end up with a neatly preprocessed data set.", "After importing all the relevant libraries (see the full notebook for the libraries) the first step is to import the sleep data from the CSV files into Python using the pd.read_csv() function:", "I only import the first two columns of sleep_score.csv as they are the ones that contain the date and the actual sleep score, all other relevant data is found in sleep_stats.csv. Let\u2019s have a look at the first five rows in sleep_stats_data:", "This is the first common problem: because of the way the CSV file is structured, the column names are in the first row. Here is one way to fix this problem:", "Using the .info() function we can obtain a high-level summary of the data in the DataFrame, which in our case looks like this:", "Here, we encounter the second common problem: there are NaN values (missing data) in the last three columns. This is indicated by the fact that the above information summary tells us that there are 322 entries (rows) but for the last three rows the non-null count is 287. Let\u2019s have a look at the rows that contain missing data using the following code:", "If we look at the column Minutes Asleep or Start and End Time it becomes clear that these rows refer to afternoon naps that Fitbit recorded. Naps are too short for Fitbit to be able to reliably measure important sleep statistics and therefore we will drop all these rows from the data set:", "In the above data summary, we also encounter the third common problem, which is related to the first: all columns are of data type \u201cobject\u201d but columns with index 2 to 8 should clearly be numerical, i.e. either of data type \u201cint\u201d or \u201cfloat\u201d. The reason these columns are of data type \u201cobject\u201d is most likely because the column headers were initially placed in the first row, thereby causing the entire column to be classified as \u201cobject\u201d. Let\u2019s convert these columns to data type \u201cfloat\u201d:", "Let\u2019s now have a look at the first few rows and the summary of sleep_score_data:", "This DataFrame looks a lot better, the column headers were automatically recognised and there are no missing values.", "For the purpose of further analyses, I would like to combine the two DataFrames into one, meaning I want to merge them. To ensure that the Sleep Scores end up in the row with the corresponding sleep statistics I need a column that is identical in both DataFrames, which will be used as the column to merge on.", "In our case, both DataFrames have a column with some sort of timestamp. The sleep statistics DataFrame has a start and an end time and the Sleep Score DataFrame has a timestamp. Because a sleep score is always provided after awakening, the date that is relevant in the sleep statistics DataFrame is the end time and we can drop the start time. But there is one more issue: the format of the end time in the sleep statistics DataFrame is different from the format of the timestamp in the Sleep Score DataFrame. If we tried to merge the DataFrames on these columns, the rows would not be matched up. My solution was to create a \u201cDate\u201d column in both DataFrames that contains only the date, merge the DataFrames on those columns, drop the redundant columns and drop one row that contained a missing value after the merge. The following code accomplishes this:", "The resulting combined DataFrame looks like this:", "I dropped all columns related to dates because this is not a time series analysis and we do not need the dates going forward. The number of awakenings are not provided by the Fitbit app and because I want to predict Sleep Scores using only data that is provided in the app I dropped it as well.", "With the combined and preprocessed DataFrame we can move on to some Exploratory Data Analysis.", "In this section I will use visualisations to provide a better understanding of the underlying data. These initial insights will be the foundation for later analyses.", "First let\u2019s have a look at the distribution of the Sleep Scores:", "The distribution of sleep scores is skewed to the left, which makes sense because bad night sleeps are more likely to occur than exceptionally good night sleeps due to multiple reasons such as staying out late or having to get up extremely early. In addition, the average sleep score is already relatively high at 82 (out of 100) and therefore it is unlikely (basically impossible) to have many outliers that lie far above the mean.", "Let\u2019s also have a look at the relationship that each individual feature has with the Sleep Score to get a sense of which features might be important and what their relationships to the Sleep Score are. I have defined a function that takes as inputs a DataFrame that contains the target variable in the last column as well as the number of columns to be contained in the entire plot. The number of columns determines how many subplots there are in each row. Here is the function:", "Calling this function with the sleep_data DataFrame and num_cols=3 as inputs results in the following plots:", "Taken by themselves, Minutes Asleep and Minutes REM Sleep seem to have the strongest positive relationship with Sleep Score. Generally speaking this makes sense because more time asleep should be a positive thing when thinking about sleep quality and therefore Sleep Score. The same is true for more time spent in REM sleep.", "To complete the picture about the relationships between the different features and Sleep Score let\u2019s have a look at the correlation matrix:", "Indeed, Sleep Score has the highest correlation with Minutes REM Sleep, closely followed by Minutes Asleep. Another important thing to note is that many of the features are highly correlated. This makes sense because more time asleep should lead to more time spent in all stages of sleep and the features will tend to move together. While this may be an inevitable by-product of the nature of the features included here it could lead to multicollinearity issues down the road. More on this later.", "Part 2 builds on the preprocessed data and the insights from the Exploratory Data Analysis to build a couple of different Machine Learning models that predict Sleep Scores. Part 2 can be found here:", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "MSc in Finance from Bocconi University \u2022 Using Python and Machine Learning to explain the world around me"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fa739d7c8df85&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-obtain-and-analyse-fitbit-sleep-scores-a739d7c8df85&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-obtain-and-analyse-fitbit-sleep-scores-a739d7c8df85&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-obtain-and-analyse-fitbit-sleep-scores-a739d7c8df85&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-obtain-and-analyse-fitbit-sleep-scores-a739d7c8df85&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----a739d7c8df85--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----a739d7c8df85--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@bennerjonas10?source=post_page-----a739d7c8df85--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@bennerjonas10?source=post_page-----a739d7c8df85--------------------------------", "anchor_text": "Jonas Benner"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fdb70b21b73e5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-obtain-and-analyse-fitbit-sleep-scores-a739d7c8df85&user=Jonas+Benner&userId=db70b21b73e5&source=post_page-db70b21b73e5----a739d7c8df85---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa739d7c8df85&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-obtain-and-analyse-fitbit-sleep-scores-a739d7c8df85&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa739d7c8df85&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-obtain-and-analyse-fitbit-sleep-scores-a739d7c8df85&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@kellysikkema?utm_source=medium&utm_medium=referral", "anchor_text": "Kelly Sikkema"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://medium.com/@bennerjonas10/using-machine-learning-to-predict-fitbit-sleep-scores-496a7d9ec48", "anchor_text": "Part 2"}, {"url": "https://medium.com/@bennerjonas10/cross-validation-and-hyperparameter-tuning-how-to-optimise-your-machine-learning-model-13f005af9d7d", "anchor_text": "Part 3"}, {"url": "https://github.com/JoBe10/Fitbit-Sleep-Score/blob/master/Sleep_Scores/Fitbit_Sleep_Score_Prediction.ipynb", "anchor_text": "full notebook"}, {"url": "https://medium.com/@bennerjonas10/using-machine-learning-to-predict-fitbit-sleep-scores-496a7d9ec48", "anchor_text": "Using Machine Learning to Predict Fitbit Sleep ScoresRandom Forest, Extreme Gradient Boosting and how they perform when predicting Fitbit\u2019s Sleep Scoremedium.com"}, {"url": "https://medium.com/tag/data-science?source=post_page-----a739d7c8df85---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----a739d7c8df85---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/programming?source=post_page-----a739d7c8df85---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/tag/analytics?source=post_page-----a739d7c8df85---------------analytics-----------------", "anchor_text": "Analytics"}, {"url": "https://medium.com/tag/editors-pick?source=post_page-----a739d7c8df85---------------editors_pick-----------------", "anchor_text": "Editors Pick"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fa739d7c8df85&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-obtain-and-analyse-fitbit-sleep-scores-a739d7c8df85&user=Jonas+Benner&userId=db70b21b73e5&source=-----a739d7c8df85---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fa739d7c8df85&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-obtain-and-analyse-fitbit-sleep-scores-a739d7c8df85&user=Jonas+Benner&userId=db70b21b73e5&source=-----a739d7c8df85---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa739d7c8df85&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-obtain-and-analyse-fitbit-sleep-scores-a739d7c8df85&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----a739d7c8df85--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fa739d7c8df85&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-obtain-and-analyse-fitbit-sleep-scores-a739d7c8df85&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----a739d7c8df85---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----a739d7c8df85--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----a739d7c8df85--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----a739d7c8df85--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----a739d7c8df85--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----a739d7c8df85--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----a739d7c8df85--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----a739d7c8df85--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----a739d7c8df85--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@bennerjonas10?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@bennerjonas10?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Jonas Benner"}, {"url": "https://medium.com/@bennerjonas10/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "156 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fdb70b21b73e5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-obtain-and-analyse-fitbit-sleep-scores-a739d7c8df85&user=Jonas+Benner&userId=db70b21b73e5&source=post_page-db70b21b73e5--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F5345cb7dfe6f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-obtain-and-analyse-fitbit-sleep-scores-a739d7c8df85&newsletterV3=db70b21b73e5&newsletterV3Id=5345cb7dfe6f&user=Jonas+Benner&userId=db70b21b73e5&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}