{"url": "https://towardsdatascience.com/combining-pandas-dataframes-the-easy-way-41eb0f2c1ebf", "time": 1682997731.884183, "path": "towardsdatascience.com/combining-pandas-dataframes-the-easy-way-41eb0f2c1ebf/", "webpage": {"metadata": {"title": "Combining Pandas DataFrames: The easy way | by Benedikt Droste | Towards Data Science", "h1": "Combining Pandas DataFrames: The easy way", "description": "When I used Python for the first time for data analytics, I really did not realize when to use append, concat, merge or join. In the beginning, I ended up with googling every time I tried to combine\u2026"}, "outgoing_paragraph_urls": [{"url": "https://medium.com/@droste.benedikt/membership", "anchor_text": "If you enjoy Medium and Towards Data Science and didn\u2019t sign up yet, feel free to use my referral link to join the community.", "paragraph_index": 21}, {"url": "https://www.linkedin.com/in/benedikt-droste-893b1b189/", "anchor_text": "https://www.linkedin.com/in/benedikt-droste-893b1b189/", "paragraph_index": 23}], "all_paragraphs": ["When I used Python for the first time for data analytics, I really did not realize when to use append, concat, merge or join. In the beginning, I ended up with googling every time I tried to combine two DataFrames. Therefore, I would like to share my experiences here and give an easy introduction for combining DataFrames.", "You can do everything with concat and merge, so there is no need for append and join in the beginning. You are able to save some time by using append and join because of shorter codes in some cases. Basically, everything you can do with append and join, you are also able to do with concat and merge. That\u00b4s why we will focus on the two commands.", "If you try to combine two datasets, the first thing to do is to decide whether to use merge or concat. There is a simple rule to find the right answer. If the content of the dataframe is relevant to combine the dataframes, you must select merge, otherwise you can take concat:", "You can use the picture above as cheatsheet for the beginning. Let\u00b4s say you are working in the data science department of your company and the sales department sends you the new sales data every month. You have two columns in your DataFrames from the last and the current month:", "The first column contains the information about the dealer and the second column contains the amount of units which were sold in the last year. So the structure of the dataset is the same every month and you just have to combine both DataFrames among themselves. In this scenario you would need to use concat:", "Ignore_index=True is used to create a new index. If you leave it out, you would keep the original indices.", "In this case, we combined both dataframes along themselves. If you want to combine both DataFrames side by side, you have to specify the command with axis=1:", "In the first example, we received every month files with the same data structure from the sales department. Now imagine, the market research department sends you market data for comparison. For each dealer ID, you also receive the market data, which also includes the sales of competitors:", "But as you can see in the picture above, you do not have the needed market data for every dealer. Therefore, you have three options to merge the data above:", "1. You keep just the intersection of both DataFrames (which means the rows with indices from 0 to 9):", "2. You keep all information of the left or the right DataFrame and from the other DataFrame just the matching information:", "3. You keep every information of both DataFrames:", "The boss of your department is asking for the share of dealer sales from total share. Therefore, he only needs the dealer IDs for which dealer- and marketsales are available. In this case, you only need to keep the parts of the dataset with the same dealer IDs. You have to use an inner join to keep just the intersection of both dataframes:", "Note: If you do not specify the \u201ehow\u201c argument, the default option will be an inner-join.", "You receive the data sets from two different departments. A requirement of the sales department might be that they want their original dataframe back with the matched market data:", "In this case, you have to perform a left-join. You only need to add market data if the dealer ID from the sales data is found in the market dataset.", "And finally, there is the market department which wants a combination of both dataframes without losing any information:", "In the resulting DataFrame not a single value of the both basic DataFrames is missing. In the end, the outer join is like a combination of a left and a right join.", "I hope you enjoyed this introduction and it helped to clarify the logic behind concat and merge commands. With the cheatsheet from the beginning you should be able to decide which command you have to use. For further information, I can recommend the following sources:", "2. A discussion on stackoverflow about the differences between concat and merge", "3. A discussion on stackoverflow about the diffeences between merge and join", "If you enjoy Medium and Towards Data Science and didn\u2019t sign up yet, feel free to use my referral link to join the community.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Analyst in a management consultancy | Interested in data science, web scraping & storytelling | https://www.linkedin.com/in/benedikt-droste-893b1b189/"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F41eb0f2c1ebf&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcombining-pandas-dataframes-the-easy-way-41eb0f2c1ebf&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcombining-pandas-dataframes-the-easy-way-41eb0f2c1ebf&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcombining-pandas-dataframes-the-easy-way-41eb0f2c1ebf&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcombining-pandas-dataframes-the-easy-way-41eb0f2c1ebf&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----41eb0f2c1ebf--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----41eb0f2c1ebf--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@droste.benedikt?source=post_page-----41eb0f2c1ebf--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@droste.benedikt?source=post_page-----41eb0f2c1ebf--------------------------------", "anchor_text": "Benedikt Droste"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F93813b47e030&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcombining-pandas-dataframes-the-easy-way-41eb0f2c1ebf&user=Benedikt+Droste&userId=93813b47e030&source=post_page-93813b47e030----41eb0f2c1ebf---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F41eb0f2c1ebf&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcombining-pandas-dataframes-the-easy-way-41eb0f2c1ebf&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F41eb0f2c1ebf&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcombining-pandas-dataframes-the-easy-way-41eb0f2c1ebf&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.merge.html", "anchor_text": "pandas.DataFrame.merge - pandas 0.25.0 documentationMerge DataFrame or named Series objects with a database-style join. The join is done on columns or indexes. If joining\u2026pandas.pydata.org"}, {"url": "https://stackoverflow.com/questions/38256104/differences-between-merge-and-concat-in-pandas", "anchor_text": "Difference(s) between merge() and concat() in pandasThanks for contributing an answer to Stack Overflow! Please be sure to answer the question. Provide details and share\u2026stackoverflow.com"}, {"url": "https://stackoverflow.com/questions/22676081/what-is-the-difference-between-join-and-merge-in-pandas/37891437", "anchor_text": "What is the difference between join and merge in Pandas?Suppose I have two DataFrames like so: left = pd.DataFrame({'key1': ['foo', 'bar'], 'lval': [1, 2]}) right =\u2026stackoverflow.com"}, {"url": "https://medium.com/@droste.benedikt/membership", "anchor_text": "If you enjoy Medium and Towards Data Science and didn\u2019t sign up yet, feel free to use my referral link to join the community."}, {"url": "https://medium.com/tag/data-science?source=post_page-----41eb0f2c1ebf---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/pandas?source=post_page-----41eb0f2c1ebf---------------pandas-----------------", "anchor_text": "Pandas"}, {"url": "https://medium.com/tag/tutorial?source=post_page-----41eb0f2c1ebf---------------tutorial-----------------", "anchor_text": "Tutorial"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F41eb0f2c1ebf&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcombining-pandas-dataframes-the-easy-way-41eb0f2c1ebf&user=Benedikt+Droste&userId=93813b47e030&source=-----41eb0f2c1ebf---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F41eb0f2c1ebf&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcombining-pandas-dataframes-the-easy-way-41eb0f2c1ebf&user=Benedikt+Droste&userId=93813b47e030&source=-----41eb0f2c1ebf---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F41eb0f2c1ebf&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcombining-pandas-dataframes-the-easy-way-41eb0f2c1ebf&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----41eb0f2c1ebf--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F41eb0f2c1ebf&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcombining-pandas-dataframes-the-easy-way-41eb0f2c1ebf&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----41eb0f2c1ebf---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----41eb0f2c1ebf--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----41eb0f2c1ebf--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----41eb0f2c1ebf--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----41eb0f2c1ebf--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----41eb0f2c1ebf--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----41eb0f2c1ebf--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----41eb0f2c1ebf--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----41eb0f2c1ebf--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@droste.benedikt?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@droste.benedikt?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Benedikt Droste"}, {"url": "https://medium.com/@droste.benedikt/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "971 Followers"}, {"url": "https://www.linkedin.com/in/benedikt-droste-893b1b189/", "anchor_text": "https://www.linkedin.com/in/benedikt-droste-893b1b189/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F93813b47e030&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcombining-pandas-dataframes-the-easy-way-41eb0f2c1ebf&user=Benedikt+Droste&userId=93813b47e030&source=post_page-93813b47e030--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fe545585931c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcombining-pandas-dataframes-the-easy-way-41eb0f2c1ebf&newsletterV3=93813b47e030&newsletterV3Id=e545585931c&user=Benedikt+Droste&userId=93813b47e030&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}