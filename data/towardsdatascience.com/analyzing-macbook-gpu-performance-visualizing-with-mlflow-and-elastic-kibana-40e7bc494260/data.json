{"url": "https://towardsdatascience.com/analyzing-macbook-gpu-performance-visualizing-with-mlflow-and-elastic-kibana-40e7bc494260", "time": 1683010075.425774, "path": "towardsdatascience.com/analyzing-macbook-gpu-performance-visualizing-with-mlflow-and-elastic-kibana-40e7bc494260/", "webpage": {"metadata": {"title": "Analyzing MacBook GPU Performance; visualizing with MLflow and Elastic Kibana | by William Hill | Towards Data Science", "h1": "Analyzing MacBook GPU Performance; visualizing with MLflow and Elastic Kibana", "description": "AMD GPU accelerating Keras and Tensorflow on MacBook visualizing in Elastic Kibana and Databricks MLflow"}, "outgoing_paragraph_urls": [{"url": "https://www.youtube.com/watch?v=xwN5hQG5IRE", "anchor_text": "my YouTube video", "paragraph_index": 0}, {"url": "http://HTTP://locahost:5000", "anchor_text": "http://locahost:5000", "paragraph_index": 9}], "all_paragraphs": ["A viewer commented on my YouTube video demonstrating how to enable AMD GPU acceleration for Keras on a MacBook.", "The comment indicates that my chosen library of OpenCL was less performant than the Metal library. This provoked my curiosity. Is Metal ALWAYS faster than OpenCL? How much faster? How much faster is the AMD GPU than Intel UHD and the Intel CPU? The three compute devices in my MacBook are:", "DavidVilla147BVB knows his stuff! The Metal library is absolutely faster than the OpenCL library for accelerating Deep Learning on a MacBook. In the following plot, the Y-axis are network architectures, from bottom to top: IMDB_LSTM, MobileNet, NasNet Mobile, VGG16, VGG19. The X-axis, from left to right are the following compute configurations: Intel CPU, OpenCL-UHD, Metal-UHD, OpenCL-GPU, Metal-GPU.", "A coworker recently suggested MFflow and this little experiment seemed like the perfect excuse to check it out. During this experiment I discovered PlaidML has it\u2019s own suite of performance tests called Plaidbench. Plaidbench writes its results as JSON. Having a bunch of JSON documents that need analysis triggered me to think about Elastic and Kibana. What follows is an analysis and a visualization in MFLow and Elastic\u2019s Kibana. My setup follows.", "My first step was to install PlaidML with pip. Lately, I have been creating python virtual environments for new projects and putting them all in a single location over NFS for use from any computer. Prior, I would just run in my Conda environment, or default environment. If I\u2019m feeling froggy, I will use a Docker container\u2026which is what I should always be doing I guess.", "PlaidML has a simple setup script which creates a JSON file, ~/.plaidml.", "To experiment with all the possible configurations, not just AMD with Metal, you must copy the ~/.plaidml file to another location. Otherwise, you will just overwrite the previous ~/.plaidml file. I chose to copy the file to a more descriptive file name indicating the contents, and then rerun the \u2018plaidml-setup\u2019 script for each configuration I wanted to test. Here is what this looks like:", "Then for each trial, I copied the desired test configuration\u2019s file to ~/.plaidml. For example, to test Intel UHD with OpenCL, I would copy \u2018opencl_uhd.json\u2019 to \u2018~/.pladml\u2019 because this is the location Plaidbench expects this configuration file to be. I could have altered the code but I found swapping out the files easy enough.", "I have been looking for an excuse to test out MLflow and this seemed like the perfect use case. I am running numerous ML trials and this open-source software turned out to be easy to install, use, and explore its web UI.", "Once the UI is running, it is accessed via your browser at localhost on port 5000: http://locahost:5000", "I now have everything in place to start developing and running my benchmark code. Since the PlaidML library comes with a benchmarking system, it is just a matter of calling the benchmarking system with the correct computer hardware and library. The five hardware and software accelerator configurations used were:", "I chose five network architectures to test with so that the test would complete in a reasonable amount of time. The networks are:", "Being that each benchmark trial calls \u2018exit()\u2019 in PlaidML, I created a bash script to repeatedly call my Python script. The Python script verifies the trial has not been run and then runs the trial. These three basic functions are called in MLflow for a simple project like this.", "I inspected my raw data in MLflow and then dove into the network architectures. I found it easy to drill down in the data with the simple query syntax, but I found the plotting system a bit rudimentary. To drill down into the results for the IMDB LSTM networks, I simply queried with params.network = \u2018imdb_lstm\u2019 and then did basic plotting. Here is a quick view of a couple of plots indicating AMD GPU with Metal libraries is indeed the fastest setup.", "Here is an animated GIF demo of how to create the previous two plots.", "MLflow is a nice tool. I enjoy how easy it is to get started, the simple API, and a web UI is nice and easy. I think Databricks will eventually build this out into something more substantial. Mostly, I love that it is open source and not tied (or locked in) to a single technology like Spark. I also like it that is has a Python API.", "Here is a demonstration of my Kibana dashboard showing the various total execution times of the plaidbench setups.", "To get Kibana running quickly, you can run an ElasticSearch Docker image and then a Kibana Docker image. Once your containers are running, a few lines of Python code will index all the benchmark JSON files.", "To get data into ElasticSearch you require an \u2018index.\u2019 And then this index needs a \u2018mapping.\u2019 I think of the mapping as a schema for the indexed data. One nice feature of Elastic is you can simply start indexing data and Elastic will create a default index and mapping for you. This is all you need for searching. A little more work is required to do more than search. In my case, I wanted to do a visual analysis with Kibana, so I created a custom mapping for my data.", "Elastic has a clean API implemented in all the major languages, or you can use one of their various *Stash applications instead of coding. I did my custom mapping in Python. My code automatically creates my mapping (aka schema) based on whether or not the values can be converted to numbers or not. If not, I made the field type \u2018keyword\u2019 instead of \u2018text\u2019 so that I can perform aggregation in Kibana.", "After I indexed my code I built my Kibana dashboard.", "This part is always enjoyable. I have yet to get anything from Kibana \u2018lens\u2019 feature, but to be fair it is still in Beta. The individual visualizations are synchronized such that if you drill down in one widget, the entire dashboard is updated. You can also add a customer widget to allow the viewer the ability to perform drill-down analysis. Selecting your various ranges and filters and clicking the \u2018Apply changes\u2019 button will update the entire dashboard.", "MLflow has potential but I think a little more capability at the expense of simplicity is required. In one of my next posts, I will share how to create a dashboard in Kibana. It is not difficult, but like most things, it is not simple to fine-tune the details either. But mostly, if you are trying to accelerate your deep learning on a Mac or MacBook, always use the Metal library. Thank you DavidVilla147BVB.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "AI Engineer at Google: Finance, ML, Coding, Fantasy Football"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F40e7bc494260&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fanalyzing-macbook-gpu-performance-visualizing-with-mlflow-and-elastic-kibana-40e7bc494260&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fanalyzing-macbook-gpu-performance-visualizing-with-mlflow-and-elastic-kibana-40e7bc494260&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fanalyzing-macbook-gpu-performance-visualizing-with-mlflow-and-elastic-kibana-40e7bc494260&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fanalyzing-macbook-gpu-performance-visualizing-with-mlflow-and-elastic-kibana-40e7bc494260&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----40e7bc494260--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----40e7bc494260--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://william-c-hill.medium.com/?source=post_page-----40e7bc494260--------------------------------", "anchor_text": ""}, {"url": "https://william-c-hill.medium.com/?source=post_page-----40e7bc494260--------------------------------", "anchor_text": "William Hill"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fb94a1295a422&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fanalyzing-macbook-gpu-performance-visualizing-with-mlflow-and-elastic-kibana-40e7bc494260&user=William+Hill&userId=b94a1295a422&source=post_page-b94a1295a422----40e7bc494260---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F40e7bc494260&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fanalyzing-macbook-gpu-performance-visualizing-with-mlflow-and-elastic-kibana-40e7bc494260&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F40e7bc494260&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fanalyzing-macbook-gpu-performance-visualizing-with-mlflow-and-elastic-kibana-40e7bc494260&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://github.com/plaidml/plaidml", "anchor_text": "plaidml/plaidmlFirst off, we\u2019d like to thank you for choosing PlaidML. Whether you\u2019re a new user or a multi-year veteran, we greatly\u2026github.com"}, {"url": "https://www.youtube.com/watch?v=xwN5hQG5IRE", "anchor_text": "my YouTube video"}, {"url": "https://mlflow.org/", "anchor_text": "MLflow \u2014 A platform for the machine learning lifecycleAn open-source platform for the machine learning lifecycle MLflow is an open-source platform to manage the ML\u2026mlflow.org"}, {"url": "http://HTTP://locahost:5000", "anchor_text": "http://locahost:5000"}, {"url": "https://carbon.now.sh/", "anchor_text": "carbon.now.sh"}, {"url": "https://www.elastic.co/kibana", "anchor_text": "KibanaNew to Kibana? Here\u2019s all you need to get started. Watch video Learn the core concepts of data analysis using Kibana\u2026www.elastic.co"}, {"url": "https://medium.com/tag/ai?source=post_page-----40e7bc494260---------------ai-----------------", "anchor_text": "AI"}, {"url": "https://medium.com/tag/macbook?source=post_page-----40e7bc494260---------------macbook-----------------", "anchor_text": "MacBook"}, {"url": "https://medium.com/tag/gpu?source=post_page-----40e7bc494260---------------gpu-----------------", "anchor_text": "Gpu"}, {"url": "https://medium.com/tag/elastic?source=post_page-----40e7bc494260---------------elastic-----------------", "anchor_text": "Elastic"}, {"url": "https://medium.com/tag/mlflow?source=post_page-----40e7bc494260---------------mlflow-----------------", "anchor_text": "Mlflow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F40e7bc494260&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fanalyzing-macbook-gpu-performance-visualizing-with-mlflow-and-elastic-kibana-40e7bc494260&user=William+Hill&userId=b94a1295a422&source=-----40e7bc494260---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F40e7bc494260&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fanalyzing-macbook-gpu-performance-visualizing-with-mlflow-and-elastic-kibana-40e7bc494260&user=William+Hill&userId=b94a1295a422&source=-----40e7bc494260---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F40e7bc494260&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fanalyzing-macbook-gpu-performance-visualizing-with-mlflow-and-elastic-kibana-40e7bc494260&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----40e7bc494260--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F40e7bc494260&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fanalyzing-macbook-gpu-performance-visualizing-with-mlflow-and-elastic-kibana-40e7bc494260&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----40e7bc494260---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----40e7bc494260--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----40e7bc494260--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----40e7bc494260--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----40e7bc494260--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----40e7bc494260--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----40e7bc494260--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----40e7bc494260--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----40e7bc494260--------------------------------", "anchor_text": ""}, {"url": "https://william-c-hill.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://william-c-hill.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "William Hill"}, {"url": "https://william-c-hill.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "28 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fb94a1295a422&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fanalyzing-macbook-gpu-performance-visualizing-with-mlflow-and-elastic-kibana-40e7bc494260&user=William+Hill&userId=b94a1295a422&source=post_page-b94a1295a422--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F52a26c71835d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fanalyzing-macbook-gpu-performance-visualizing-with-mlflow-and-elastic-kibana-40e7bc494260&newsletterV3=b94a1295a422&newsletterV3Id=52a26c71835d&user=William+Hill&userId=b94a1295a422&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}