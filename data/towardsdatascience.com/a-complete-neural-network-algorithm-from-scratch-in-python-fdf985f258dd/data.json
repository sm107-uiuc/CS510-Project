{"url": "https://towardsdatascience.com/a-complete-neural-network-algorithm-from-scratch-in-python-fdf985f258dd", "time": 1683016858.8983521, "path": "towardsdatascience.com/a-complete-neural-network-algorithm-from-scratch-in-python-fdf985f258dd/", "webpage": {"metadata": {"title": "A Complete Neural Network Algorithm from Scratch in Python | by Rashida Nasrin Sucky | Towards Data Science", "h1": "A Complete Neural Network Algorithm from Scratch in Python", "description": "The Neural Network has been developed to mimic a human brain. Though we are not there yet, neural networks are very efficient in machine learning. It was popular in the 1980s and 1990s. Recently it\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.coursera.org/learn/machine-learning/home/welcome", "anchor_text": "Andrew Ng\u2019s Machine Learning course", "paragraph_index": 17}, {"url": "https://www.coursera.org/", "anchor_text": "Coursera", "paragraph_index": 17}, {"url": "https://twitter.com/rashida048", "anchor_text": "Twitter", "paragraph_index": 60}, {"url": "https://www.facebook.com/rashida.smith.161", "anchor_text": "Facebook", "paragraph_index": 60}, {"url": "https://regenerativetoday.com/", "anchor_text": "https://regenerativetoday.com/", "paragraph_index": 63}], "all_paragraphs": ["The Neural Network has been developed to mimic a human brain. Though we are not there yet, neural networks are very efficient in machine learning. It was popular in the 1980s and 1990s. Recently it has become more popular. Probably because computers are fast enough to run a large neural network in a reasonable time. In this article, I will discuss how to develop a neural network algorithm from scratch in python.", "I recommend that please read this \u2018Ideas of Neural Network\u2019 portion carefully. But if it is not too clear to you, do not worry. Move on to the implementation part. I broke it down into smaller pieces there. Also running all the codes by yourself will make it clearer for you.", "In a simple neural network, neurons are the basic computation units. They take the input features and channel them out as output. Here is what a basic neural network looks like:", "Here, \u2018layer1\u2019 is the input feature. \u2018Layer1\u2019 goes into another node layer2 and finally outputs the predicted class or hypothesis. Layer2 is the hidden layer. You can use more than 1 hidden layer.", "You have to design your neural network based on your dataset and accuracy requirements.", "The process of moving from layer1 to layer3 is called forward propagation. The steps in the forward-propagation:", "There are several activation functions available such as sigmoid, tanh, relu, softmax, swish", "I will use a sigmoid activation function for the demonstration of the neural network.", "Here, \u2018a\u2019 represents the hidden layer or layer2 and b is the bias.", "3. Initialize theta2 for the hidden layer. The size will be the length of the hidden layer by the number of output classes. In this example, the next layer is the output layer as we do not have any more hidden layers.", "4. Then we need to follow the same process as before. Multiply theta and the hidden layer and pass through the sigmoid activation layer to get the hypothesis or predicted output.", "Backpropagation is the process of moving from the output layer to layer2. In this process, we calculate the error.", "2. Now, calculate the gradient for theta2. Multiply delta3 to theta2. Multiply that to \u2018a2\u2019 times \u20181- a2\u2019. In the formula below superscript 2 on \u2018a\u2019 represents the layer2. Please do not misunderstand it as a square.", "3. Calculate the unregularized version of the gradient from the diving delta by the number of training examples m.", "Revise the theta. Multiply input features to the delta2 times a learning rate to get theta1. Please pay attention to the dimension of the theta.", "Repeat the process of forward-propagation and backpropagation and keep updating the parameters until you reach an optimum cost. Here is the formula for the cost function. Just a reminder, the cost function indicates, how far the prediction is from the original output variable.", "If you notice, this cost function formula is almost like a logistic regression cost function.", "I am going to use a dataset from Andrew Ng\u2019s Machine Learning course in Coursera. Feel free to download the dataset from the following link:", "Here is the implementation of a neural network step by step. I encourage you to run each line of code for yourself and print the output to understand it better.", "This is the top five rows of the dataset. These are the pixel values of the digits. Please feel free to download the dataset and follow along:", "In this dataset, input and output variables are organized in separate excel sheets. Let\u2019s import the output variables in the notebook:", "This is also the top five rows of the dataset only. Output variables are the digits from 1 to 10. The goal of this project is to predict the digits using the input variables stored in \u2018df\u2019.", "2. Find the dimension of input and output variables", "The shape of the input variables or df is 5000 x 400 and the shape of the output variables or y is 5000 x 1.", "For simplicity, we will use only one hidden layer of 25 neurons.", "As you can see above, there are 10 output classes.", "We will randomly initialize theta for layer1 and layer2. Because we have three layers, there will be theta1 and theta2.", "The shape of theta1: Size of layer1 x Size of layer2", "The shape of theta2: Size of layer2 x Size of layer3", "From step 2, the shape of \u2018df\u2019 is 5000 x 400. That means there are 400 input features. So, the size of layer1 is 400. As we specified the hidden layer size as 25, the size of the layer2 is 25. We have 10 output classes. So, the size of layer3 is 10.", "In the same way, there will be two randomly initialized bias terms b1 and b2.", "The shape of b1: the size of layer2 (in this case 25)", "The shape of b2: the size of layer3 (in this case 10)", "Define a function for randomly initializing theta:", "Use this function and initialize the theta", "Now, initialize the bias terms as we discussed above:", "Use the formulas in the forward propagation section.", "Define a function to multiply theta and X for convenience", "We will use the activation function a few times as well. It will be good to have a function for sigmoid activation as well", "I will demonstrate the forward propagation step by step now. First, calculate the z term:", "Now pass this z1 through the activation function to get our hidden layer", "a1 is the hidden layer. The shape of the a1 is 5000 x 25. Repeat the same process to calculate layer3 or the output layer", "The shape of the a2 is 5000 x 10. 10 columns are for 10 classes. a2 is our layer3 or final output or hypothesis. If there were more hidden layers in this example, there would be more repetition of the same process to transfer from one layer to another. This process of calculating the output layer using the input feature is called forward propagation. Putting it all together in a function, so we can perform forward propagation for any number of layers:", "This is the process of going backward to calculate the gradient and update the theta. Before that, we need to modify the \u2018y\u2019. We have 10 classes in \u2018y\u2019. But we need to segregate each class into its column. For example, the first column is for class 10. We will replace 1 for 10 and 0 for the rest of the classes. This way we will make an individual column for each class.", "Now the way I demonstrated forward propagation step by step first and then put all in a function, I will do the same for backpropagation. Using the formula for gradients in the backpropagation section above, calculate delta3 first. We will use z1, z2, a1, and a2 from the forward propagation implementation.", "Now use this formula to calculate delta2:", "Here we need to learn a new concept. That is a sigmoid gradient. The formula for the sigmoid gradient is:", "If you notice, this is exactly the same as a(1 \u2014 a) in the formula for delta. because a is sigmoid(z). Because this is a convention, I will replace this sigmoid gradient instead of a(1-a) term in the formula for delta2 when I will put them all together to write the function. They are exactly the same. I just wanted to demonstrate both. Let\u2019s write a function for the sigmoid gradient:", "Finally, this is the time to update the theta using this formula:", "We need to choose a learning rate. I chose 0.003. I encourage you to try with other learning rates to see how it performs:", "This is how theta needs to be updated. This process called backpropagation because it moves backward. Before writing the function for backpropagation, we need to define the cost function. Because I will include the calculation of cost in the backpropagation method as well. Though it could be added in the forward propagation or you can keep it separate while training the network. Here is the method for the cost function", "Here m is the number of training examples. Putting it all together:", "I will train the network for 20 epochs. I will initialize the theta again in this code snippet. Because I already used the theta and updated it. So, if I do not initialize it again, I will end up starting with the updated theta already. But I want to take a fresh start.", "I used the learning rate of 0.003 and ran it for 20 epochs. But please look at the GitHub link provided below. I tried with different learning rates and a different number of epochs to finally reach here.", "We got the list of costs that we calculated in each epoch and also the final updated theta. Use this final theta to predict the output.", "8. Predict the output and calculate the accuracy", "Simply use the hypothesis function to and pass this updated theta to predict the output:", "The accuracy is 100%. Perfect, right? But we do not get 100% accuracy all the time. Sometimes getting a 70% accuracy is great, depending on the dataset.", "Congrats! You just developed a complete neural network! This same problem is solved using a logistic regression algorithm in this article:", "For simpler classification problems, logistic regression still works just great! But for more complicated problems neural network gives better results. As you can see with forwarding and backward propagation, it just learns the training data better. In Natural Language Processing and Image Classification neural network have been performing really great in the AI industry.", "Feel free to follow me on Twitter and like my Facebook page.", "Here is the Github link for the full working code:", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "MS in Applied Data Analytics from Boston University. Read my blog: https://regenerativetoday.com/"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Ffdf985f258dd&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-complete-neural-network-algorithm-from-scratch-in-python-fdf985f258dd&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-complete-neural-network-algorithm-from-scratch-in-python-fdf985f258dd&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-complete-neural-network-algorithm-from-scratch-in-python-fdf985f258dd&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-complete-neural-network-algorithm-from-scratch-in-python-fdf985f258dd&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----fdf985f258dd--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----fdf985f258dd--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://rashida00.medium.com/?source=post_page-----fdf985f258dd--------------------------------", "anchor_text": ""}, {"url": "https://rashida00.medium.com/?source=post_page-----fdf985f258dd--------------------------------", "anchor_text": "Rashida Nasrin Sucky"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F8a36b941a136&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-complete-neural-network-algorithm-from-scratch-in-python-fdf985f258dd&user=Rashida+Nasrin+Sucky&userId=8a36b941a136&source=post_page-8a36b941a136----fdf985f258dd---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ffdf985f258dd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-complete-neural-network-algorithm-from-scratch-in-python-fdf985f258dd&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ffdf985f258dd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-complete-neural-network-algorithm-from-scratch-in-python-fdf985f258dd&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@leahhuyghe?utm_source=medium&utm_medium=referral", "anchor_text": "Leah Huyghe"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://www.coursera.org/learn/machine-learning/home/welcome", "anchor_text": "Andrew Ng\u2019s Machine Learning course"}, {"url": "https://www.coursera.org/", "anchor_text": "Coursera"}, {"url": "https://github.com/rashida048/Machine-Learning-With-Python/blob/master/ex3d1.xlsx", "anchor_text": "rashida048/Machine-Learning-With-PythonPermalink GitHub is home to over 50 million developers working together to host and review code, manage projects, and\u2026github.com"}, {"url": "https://towardsdatascience.com/multiclass-classification-algorithm-from-scratch-with-a-project-in-python-step-by-step-guide-485a83c79992", "anchor_text": "Multiclass Classification Algorithm from Scratch with a Project in Python: Step by Step GuideThis article explains two methods: The gradient descent method and the optimization function methodtowardsdatascience.com"}, {"url": "https://twitter.com/rashida048", "anchor_text": "Twitter"}, {"url": "https://www.facebook.com/rashida.smith.161", "anchor_text": "Facebook"}, {"url": "https://github.com/rashida048/Machine-Learning-With-Python/blob/master/NeuralNetworkFinal.ipynb", "anchor_text": "rashida048/Machine-Learning-With-PythonPermalink GitHub is home to over 50 million developers working together to host and review code, manage projects, and\u2026github.com"}, {"url": "https://towardsdatascience.com/a-complete-anomaly-detection-algorithm-from-scratch-in-python-step-by-step-guide-e1daf870336e", "anchor_text": "A Complete Anomaly Detection Algorithm From Scratch in Python: Step by Step GuideAnomaly Detection Algorithm Using the Probabilitiestowardsdatascience.com"}, {"url": "https://towardsdatascience.com/a-complete-k-mean-clustering-algorithm-from-scratch-in-python-step-by-step-guide-1eb05cdcd461", "anchor_text": "A Complete K Mean Clustering Algorithm From Scratch in Python: Step by Step GuideAlso, How to Use K Mean Clustering Algorithm for Dimensionality Reduction of an Imagetowardsdatascience.com"}, {"url": "https://towardsdatascience.com/a-complete-recommender-system-from-scratch-in-python-step-by-step-6fc17a4da054", "anchor_text": "A Complete Recommender System From Scratch in Python: Step by StepMovie recommendation system based on the user ratings using the linear regression ideatowardsdatascience.com"}, {"url": "https://towardsdatascience.com/a-complete-guide-to-time-series-data-visualization-in-python-da0ddd2cfb01", "anchor_text": "A Complete Guide to Time Series Data Visualization in PythonThis Should Give You Enough Resources to Make Great Visuals with Time Series Datatowardsdatascience.com"}, {"url": "https://towardsdatascience.com/a-complete-guide-to-hypothesis-testing-for-data-scientists-using-python-69f670e6779e", "anchor_text": "A Complete Guide to Hypothesis Testing for Data Scientists Using PythonExplained Clearly with Sample Research Questions, Solution Steps, and Complete Codestowardsdatascience.com"}, {"url": "https://towardsdatascience.com/your-ml-algorithm-is-not-performing-well-613dd2b07fc", "anchor_text": "If Your ML Algorithm Is Not Performing WellHow to Detect the Problemtowardsdatascience.com"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----fdf985f258dd---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----fdf985f258dd---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----fdf985f258dd---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/programming?source=post_page-----fdf985f258dd---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/tag/technology?source=post_page-----fdf985f258dd---------------technology-----------------", "anchor_text": "Technology"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Ffdf985f258dd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-complete-neural-network-algorithm-from-scratch-in-python-fdf985f258dd&user=Rashida+Nasrin+Sucky&userId=8a36b941a136&source=-----fdf985f258dd---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Ffdf985f258dd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-complete-neural-network-algorithm-from-scratch-in-python-fdf985f258dd&user=Rashida+Nasrin+Sucky&userId=8a36b941a136&source=-----fdf985f258dd---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ffdf985f258dd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-complete-neural-network-algorithm-from-scratch-in-python-fdf985f258dd&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----fdf985f258dd--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Ffdf985f258dd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-complete-neural-network-algorithm-from-scratch-in-python-fdf985f258dd&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----fdf985f258dd---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----fdf985f258dd--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----fdf985f258dd--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----fdf985f258dd--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----fdf985f258dd--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----fdf985f258dd--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----fdf985f258dd--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----fdf985f258dd--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----fdf985f258dd--------------------------------", "anchor_text": ""}, {"url": "https://rashida00.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://rashida00.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Rashida Nasrin Sucky"}, {"url": "https://rashida00.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "5.8K Followers"}, {"url": "https://regenerativetoday.com/", "anchor_text": "https://regenerativetoday.com/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F8a36b941a136&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-complete-neural-network-algorithm-from-scratch-in-python-fdf985f258dd&user=Rashida+Nasrin+Sucky&userId=8a36b941a136&source=post_page-8a36b941a136--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fb3691be13a18&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-complete-neural-network-algorithm-from-scratch-in-python-fdf985f258dd&newsletterV3=8a36b941a136&newsletterV3Id=b3691be13a18&user=Rashida+Nasrin+Sucky&userId=8a36b941a136&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}