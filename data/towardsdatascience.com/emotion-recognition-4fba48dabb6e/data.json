{"url": "https://towardsdatascience.com/emotion-recognition-4fba48dabb6e", "time": 1683018218.693843, "path": "towardsdatascience.com/emotion-recognition-4fba48dabb6e/", "webpage": {"metadata": {"title": "Emotion Recognition. It\u2019s fascinating how much progress deep\u2026 | by Ketan Vaidya | Towards Data Science", "h1": "1. Dataset", "description": "It\u2019s fascinating how much progress deep learning has made in just a few years that we can use Convolutional Neural Networks for such a large variety of tasks. Today I\u2019m going to show you one such\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.kaggle.com/c/challenges-in-representation-learning-facial-expression-recognition-challenge/data", "anchor_text": "FER 2013", "paragraph_index": 3}], "all_paragraphs": ["It\u2019s fascinating how much progress deep learning has made in just a few years that we can use Convolutional Neural Networks for such a large variety of tasks.", "Today I\u2019m going to show you one such exciting task to perform with CNNs which is Emotion Recognition. You have to just say hi to your camera and it will predict the emotion on your face. Just like that!", "So let\u2019s get started with importing the libraries required to perform this task.", "For this project, I used the FER 2013 dataset available on Kaggle. This was the only easily available dataset I could find for this task. The dataset contains CSV files that map the emotion labels to the respective pixel values of the image at hand.", "It has 7 emotions/classes (0=Angry, 1=Disgust, 2=Fear, 3=Happy, 4=Sad, 5=Surprise, 6=Neutral) and as visible in the overview below, the classes are a little skewed.", "The dataset looks something like :", "Given the look of the dataset, we will need to preprocess these pixel values to convert them into meaningful images.", "We will need to load the pixel values into Google Colab and convert them into their image form. For this purpose, I have written the function preprocess_pixels to tackle this task.", "The function takes to input the pixel_data( pixels column of the dataset) and converts each of the entry to from a string to an array of integers which is reshaped into the images which we will train on.", "As I had mentioned earlier that, or dataset is a little bit skewed i.e. some classes have a lot more examples than some others.", "One way to overcome this is by using RandomOverSampler which oversamples the classes which are in lesser numbers in a dataset. It basically randomly duplicates examples in the minority classes, which helps in reducing the imbalance in the dataset.", "The sampling_strategy \u2018auto\u2019 means that all the classes will end up with the same number of instances.", "Now let's convert this into the image form, using the function defined earlier, and split the data into train and test.", "Let\u2019s see how an image looks from our dataset!", "Now the time to define our model which will train our images.", "I have defined a CNN model here, but you can use the many available pre-trained models like VGG-16, Inception V3, or ResNet for this task. You can use transfer learning which will be useful to use here.", "Before training, the image emotion labels need to be one-hot encoded, we do that using to_categorical.", "Now we will fit the training set to the model using 30 epochs", "At the end of 30 epochs, the training accuracy is 95.6% while the validation accuracy is 82.81% which is a good value obtained as the model used wasn't the most complex and we had also used oversampling to account or skewness of the data.", "After we have trained the model, the model weights were saved and model.predict was used on the validation set. It returns the \u2018preds\u2019 vectors for each image in the dataset.", "A function get_class is defined which converts the preds into a vector of only image labels. It uses np.argmax which returns the index of the maximum value in the vector preds[i].", "A label dictionary mapping the integer labels to their emotions is defined.", "And now an image out of the dataset is taken to check the model\u2019s accuracy.", "The following was the output after running the cell above", "We can tell that the image above depicts \u2018happiness\u2019, and the model correctly predicted the emotion to be \u2018happiness\u2019 which is a good thing!", "Now we will implement this model in real-time to predict emotions using the webcam.", "This is a simple extension or task which can be easily implemented using OpenCV which is a library focused on real-time applications\u00a0for\u00a0Computer\u00a0Vision. OpenCV stands for Open Source Computer Vision Library.", "For this task, we will use haar cascade classifiers which is an effective object-detection method, and here will be used to detect the face in the real-time setting.", "First, we will download the file \u2018haarcascade_frontalface_default.xml\u2019, which is a file containing the features required to detect the frontal face. This file can be downloaded from Kaggle and also available on GitHub.", "cv2.VideoCapture(0) starts the webcam and captures images from the webcam which are passed into the cascade classifier to detect the face in the image.", "The detected face is then converted to a grayscale image and resized into a shape that is compatible with our model. Then it is passed to the model for predicting the emotion.", "The emotion label is displayed on the screen along with a square box encapsulating the face.", "Below are the images I obtained by testing the model in real-time using a webcam.", "The black font might not be visible at first, but if you look closely the emotions are displayed :D.", "The model showed pretty good results for real-time implementation too except for emotions like fear and disgust which had the least amount of training examples.", "So in this article, we implemented an emotion recognition model using CNN and the FER 2013 dataset. After training the model, the model was validated, and also a real-time implementation of the model was done successfully using OpenCV and HaarCascade classifiers.", "Hope you enjoy reading this article!", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Just started getting into Deep Learning, excited to learn a lot more new things as we go."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F4fba48dabb6e&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Femotion-recognition-4fba48dabb6e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Femotion-recognition-4fba48dabb6e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Femotion-recognition-4fba48dabb6e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Femotion-recognition-4fba48dabb6e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----4fba48dabb6e--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----4fba48dabb6e--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://ketan-vaidya25.medium.com/?source=post_page-----4fba48dabb6e--------------------------------", "anchor_text": ""}, {"url": "https://ketan-vaidya25.medium.com/?source=post_page-----4fba48dabb6e--------------------------------", "anchor_text": "Ketan Vaidya"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F1c630c55ac45&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Femotion-recognition-4fba48dabb6e&user=Ketan+Vaidya&userId=1c630c55ac45&source=post_page-1c630c55ac45----4fba48dabb6e---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F4fba48dabb6e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Femotion-recognition-4fba48dabb6e&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F4fba48dabb6e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Femotion-recognition-4fba48dabb6e&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@tengyart?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Tengyart"}, {"url": "https://unsplash.com/s/photos/emotions?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://www.kaggle.com/c/challenges-in-representation-learning-facial-expression-recognition-challenge/data", "anchor_text": "FER 2013"}, {"url": "https://github.com/ketanvaidya25/Emotion-Recognition", "anchor_text": "ketanvaidya25/Emotion-RecognitionUsing the FER 2013 Dataset available on Kaggle, identify the emotion exuded in the images. The dataset can be found\u2026github.com"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----4fba48dabb6e---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/emotion-recognition?source=post_page-----4fba48dabb6e---------------emotion_recognition-----------------", "anchor_text": "Emotion Recognition"}, {"url": "https://medium.com/tag/convolutional-network?source=post_page-----4fba48dabb6e---------------convolutional_network-----------------", "anchor_text": "Convolutional Network"}, {"url": "https://medium.com/tag/opencv?source=post_page-----4fba48dabb6e---------------opencv-----------------", "anchor_text": "Opencv"}, {"url": "https://medium.com/tag/realtime?source=post_page-----4fba48dabb6e---------------realtime-----------------", "anchor_text": "Realtime"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F4fba48dabb6e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Femotion-recognition-4fba48dabb6e&user=Ketan+Vaidya&userId=1c630c55ac45&source=-----4fba48dabb6e---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F4fba48dabb6e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Femotion-recognition-4fba48dabb6e&user=Ketan+Vaidya&userId=1c630c55ac45&source=-----4fba48dabb6e---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F4fba48dabb6e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Femotion-recognition-4fba48dabb6e&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----4fba48dabb6e--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F4fba48dabb6e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Femotion-recognition-4fba48dabb6e&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----4fba48dabb6e---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----4fba48dabb6e--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----4fba48dabb6e--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----4fba48dabb6e--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----4fba48dabb6e--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----4fba48dabb6e--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----4fba48dabb6e--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----4fba48dabb6e--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----4fba48dabb6e--------------------------------", "anchor_text": ""}, {"url": "https://ketan-vaidya25.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://ketan-vaidya25.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Ketan Vaidya"}, {"url": "https://ketan-vaidya25.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "105 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F1c630c55ac45&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Femotion-recognition-4fba48dabb6e&user=Ketan+Vaidya&userId=1c630c55ac45&source=post_page-1c630c55ac45--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fa2844426e33f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Femotion-recognition-4fba48dabb6e&newsletterV3=1c630c55ac45&newsletterV3Id=a2844426e33f&user=Ketan+Vaidya&userId=1c630c55ac45&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}