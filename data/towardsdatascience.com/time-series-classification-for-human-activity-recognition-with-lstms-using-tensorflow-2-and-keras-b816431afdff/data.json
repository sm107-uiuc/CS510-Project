{"url": "https://towardsdatascience.com/time-series-classification-for-human-activity-recognition-with-lstms-using-tensorflow-2-and-keras-b816431afdff", "time": 1683006303.2218602, "path": "towardsdatascience.com/time-series-classification-for-human-activity-recognition-with-lstms-using-tensorflow-2-and-keras-b816431afdff/", "webpage": {"metadata": {"title": "Time Series Classification for Human Activity Recognition with LSTMs using TensorFlow 2 and Keras | by Venelin Valkov | Towards Data Science", "h1": "Time Series Classification for Human Activity Recognition with LSTMs using TensorFlow 2 and Keras", "description": "Can you use Time Series data to recognize user activity from accelerometer data? Your phone/wristband/watch is already doing it. How well can you do it? We\u2019ll use accelerometer data, collected from\u2026"}, "outgoing_paragraph_urls": [{"url": "https://colab.research.google.com/drive/1hxq4-A4SZYfKqmqfwP5Y0c01uElmnpq6", "anchor_text": "Run the complete notebook in your browser", "paragraph_index": 3}, {"url": "http://www.cis.fordham.edu/wisdm/dataset.php", "anchor_text": "WISDM: WIreless Sensor Data Mining", "paragraph_index": 4}, {"url": "http://www.cis.fordham.edu/wisdm/includes/files/sensorKDD-2010.pdf", "anchor_text": "Activity Recognition using Cell Phone Accelerometers", "paragraph_index": 5}, {"url": "https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.mode.html", "anchor_text": "mode", "paragraph_index": 20}, {"url": "https://colab.research.google.com/drive/1hxq4-A4SZYfKqmqfwP5Y0c01uElmnpq6", "anchor_text": "Run the complete notebook in your browser", "paragraph_index": 34}], "all_paragraphs": ["TL;DR Learn how to classify Time Series data from accelerometer sensors using LSTMs in Keras", "Can you use Time Series data to recognize user activity from accelerometer data? Your phone/wristband/watch is already doing it. How well can you do it?", "We\u2019ll use accelerometer data, collected from multiple users, to build a Bidirectional LSTM model and try to classify the user activity. You can deploy/reuse the trained model on any device that has an accelerometer (which is pretty much every smart device).", "Run the complete notebook in your browser", "Our data is collected through controlled laboratory conditions. It is provided by the WISDM: WIreless Sensor Data Mining lab.", "The data is used in the paper: Activity Recognition using Cell Phone Accelerometers. Take a look at the paper to get a feel of how well some baseline models are performing.", "The raw file is missing column names. Also, one of the columns is having an extra \u201c;\u201d after each value. Let\u2019s fix that:", "The data has the following features:", "What can we learn from the data?", "We have six different categories. Let\u2019s look at their distribution:", "Walking and jogging are severely overrepresented. You might apply some techniques to balance the dataset.", "We have multiple users. How much data do we have per user?", "Most users (except the last 3) have a decent amount of records.", "How do different types of activities look like? Let\u2019s take the first 200 records and have a look:", "Sitting is well, pretty relaxed. How about jogging?", "This looks much bouncier. Good, the type of activities can be separated/classified by observing the data (at least for that sample of those 2 activities).", "We need to figure out a way to turn the data into sequences along with the category for each one.", "The first thing we need to do is to split the data into training and test datasets. We\u2019ll use the data from users with id below or equal to 30. The rest will be for training:", "Next, we\u2019ll scale the accelerometer data values:", "Note that we fit the scaler only on the training data. How can we create the sequences? We\u2019ll just modify the create_dataset function a bit:", "We choose the label (category) by using the mode of all categories in the sequence. That is, given a sequence of length time_steps, we're are classifying it as the category that occurs most often.", "Here\u2019s how to create the sequences:", "Let\u2019s have a look at the shape of the new sequences:", "We have significantly reduced the amount of training and test data. Let\u2019s hope that our model will still learn something useful.", "The last preprocessing step is the encoding of the categories:", "Done with the preprocessing! How good our model is going to be at recognizing user activities?", "We\u2019ll start with a simple Bidirectional LSTM model. You can try and increase the complexity. Note that the model is relatively slow to train:", "The actual training progress is straightforward (remember to not shuffle):", "Here\u2019s how the training process went:", "You can surely come up with a better model/hyperparameters and improve it. How well can it predict the test data?", "~88% accuracy. Not bad for a quick and dirty model. Let\u2019s have a look at the confusion matrix:", "Our model is confusing the Upstairs and Downstairs activities. That\u2019s somewhat expected. Additionally, when developing a real-world application, you might merge those two and consider them a single class/category. Recall that there is a significant imbalance in our dataset, too.", "You did it! You\u2019ve built a model that recognizes activity from 200 records of accelerometer data. Your model achieves ~88% accuracy on the test data. Here are the steps you took:", "You learned how to build a Bidirectional LSTM model and classify Time Series data. There is even more fun with LSTMs and Time Series coming next :)", "Run the complete notebook in your browser", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fb816431afdff&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftime-series-classification-for-human-activity-recognition-with-lstms-using-tensorflow-2-and-keras-b816431afdff&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftime-series-classification-for-human-activity-recognition-with-lstms-using-tensorflow-2-and-keras-b816431afdff&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftime-series-classification-for-human-activity-recognition-with-lstms-using-tensorflow-2-and-keras-b816431afdff&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftime-series-classification-for-human-activity-recognition-with-lstms-using-tensorflow-2-and-keras-b816431afdff&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----b816431afdff--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----b816431afdff--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://venelinvalkov.medium.com/?source=post_page-----b816431afdff--------------------------------", "anchor_text": ""}, {"url": "https://venelinvalkov.medium.com/?source=post_page-----b816431afdff--------------------------------", "anchor_text": "Venelin Valkov"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F102e34a0beb1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftime-series-classification-for-human-activity-recognition-with-lstms-using-tensorflow-2-and-keras-b816431afdff&user=Venelin+Valkov&userId=102e34a0beb1&source=post_page-102e34a0beb1----b816431afdff---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb816431afdff&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftime-series-classification-for-human-activity-recognition-with-lstms-using-tensorflow-2-and-keras-b816431afdff&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb816431afdff&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftime-series-classification-for-human-activity-recognition-with-lstms-using-tensorflow-2-and-keras-b816431afdff&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@fitmasu", "anchor_text": "Fitsum Admasu"}, {"url": "https://colab.research.google.com/drive/1hxq4-A4SZYfKqmqfwP5Y0c01uElmnpq6", "anchor_text": "Run the complete notebook in your browser"}, {"url": "https://github.com/curiousily/Deep-Learning-For-Hackers", "anchor_text": "The complete project on GitHub"}, {"url": "https://leanpub.com/Hackers-Guide-to-Machine-Learning-with-Python", "anchor_text": "Hacker's Guide to Machine Learning with PythonThis book brings the fundamentals of Machine Learning to you, using tools and techniques used to solve real-world\u2026leanpub.com"}, {"url": "http://www.cis.fordham.edu/wisdm/dataset.php", "anchor_text": "WISDM: WIreless Sensor Data Mining"}, {"url": "http://www.cis.fordham.edu/wisdm/includes/files/sensorKDD-2010.pdf", "anchor_text": "Activity Recognition using Cell Phone Accelerometers"}, {"url": "https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.mode.html", "anchor_text": "mode"}, {"url": "https://colab.research.google.com/drive/1hxq4-A4SZYfKqmqfwP5Y0c01uElmnpq6", "anchor_text": "Run the complete notebook in your browser"}, {"url": "https://github.com/curiousily/Deep-Learning-For-Hackers", "anchor_text": "The complete project on GitHub"}, {"url": "https://www.tensorflow.org/tutorials/structured_data/time_series", "anchor_text": "TensorFlow \u2014 Time series forecasting"}, {"url": "https://colah.github.io/posts/2015-08-Understanding-LSTMs/", "anchor_text": "Understanding LSTM Networks"}, {"url": "http://www.cis.fordham.edu/wisdm/dataset.php", "anchor_text": "WISDM: WIreless Sensor Data Mining"}, {"url": "https://leanpub.com/Hackers-Guide-to-Machine-Learning-with-Python", "anchor_text": "Hacker's Guide to Machine Learning with PythonThis book brings the fundamentals of Machine Learning to you, using tools and techniques used to solve real-world\u2026leanpub.com"}, {"url": "https://www.curiousily.com/posts/time-series-classification-for-human-activity-recognition-with-lstms-in-keras/", "anchor_text": "https://www.curiousily.com"}, {"url": "https://medium.com/tag/keras?source=post_page-----b816431afdff---------------keras-----------------", "anchor_text": "Keras"}, {"url": "https://medium.com/tag/tensorflow?source=post_page-----b816431afdff---------------tensorflow-----------------", "anchor_text": "TensorFlow"}, {"url": "https://medium.com/tag/timeseries?source=post_page-----b816431afdff---------------timeseries-----------------", "anchor_text": "Timeseries"}, {"url": "https://medium.com/tag/python?source=post_page-----b816431afdff---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----b816431afdff---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fb816431afdff&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftime-series-classification-for-human-activity-recognition-with-lstms-using-tensorflow-2-and-keras-b816431afdff&user=Venelin+Valkov&userId=102e34a0beb1&source=-----b816431afdff---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fb816431afdff&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftime-series-classification-for-human-activity-recognition-with-lstms-using-tensorflow-2-and-keras-b816431afdff&user=Venelin+Valkov&userId=102e34a0beb1&source=-----b816431afdff---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb816431afdff&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftime-series-classification-for-human-activity-recognition-with-lstms-using-tensorflow-2-and-keras-b816431afdff&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----b816431afdff--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fb816431afdff&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftime-series-classification-for-human-activity-recognition-with-lstms-using-tensorflow-2-and-keras-b816431afdff&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----b816431afdff---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----b816431afdff--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----b816431afdff--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----b816431afdff--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----b816431afdff--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----b816431afdff--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----b816431afdff--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----b816431afdff--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----b816431afdff--------------------------------", "anchor_text": ""}, {"url": "https://venelinvalkov.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://venelinvalkov.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Venelin Valkov"}, {"url": "https://venelinvalkov.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "2.5K Followers"}, {"url": "https://mlexpert.io", "anchor_text": "https://mlexpert.io"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F102e34a0beb1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftime-series-classification-for-human-activity-recognition-with-lstms-using-tensorflow-2-and-keras-b816431afdff&user=Venelin+Valkov&userId=102e34a0beb1&source=post_page-102e34a0beb1--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F5323954064aa&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftime-series-classification-for-human-activity-recognition-with-lstms-using-tensorflow-2-and-keras-b816431afdff&newsletterV3=102e34a0beb1&newsletterV3Id=5323954064aa&user=Venelin+Valkov&userId=102e34a0beb1&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}