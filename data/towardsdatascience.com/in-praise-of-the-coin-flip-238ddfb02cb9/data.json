{"url": "https://towardsdatascience.com/in-praise-of-the-coin-flip-238ddfb02cb9", "time": 1683003061.696331, "path": "towardsdatascience.com/in-praise-of-the-coin-flip-238ddfb02cb9/", "webpage": {"metadata": {"title": "In Praise of the Coin Flip. How the humble coin-flip can help with\u2026 | by Paul Tune | Towards Data Science", "h1": "In Praise of the Coin Flip", "description": "The coin flip and its modelling is a basic staple in statistics. Here are three applications of coin flips to data and computer science."}, "outgoing_paragraph_urls": [{"url": "https://scrooge-mcduck.fandom.com/wiki/Flip_Decision", "anchor_text": "\u201cFlip Decision\u201d", "paragraph_index": 0}, {"url": "https://en.wikipedia.org/wiki/False_positive_rate", "anchor_text": "false positive rate", "paragraph_index": 9}, {"url": "https://en.wikipedia.org/wiki/Precision_and_recall", "anchor_text": "precision and recall", "paragraph_index": 9}, {"url": "https://en.wikipedia.org/wiki/Static_random-access_memory", "anchor_text": "Static random-access memory (SRAM)", "paragraph_index": 12}, {"url": "https://en.wikipedia.org/wiki/HyperLogLog", "anchor_text": "HyperLogLog", "paragraph_index": 23}, {"url": "https://prestodb.io/docs/current/functions/hyperloglog.html", "anchor_text": "Presto", "paragraph_index": 23}, {"url": "https://docs.snowflake.net/manuals/user-guide/querying-approximate-cardinality.html", "anchor_text": "Snowflake", "paragraph_index": 23}, {"url": "https://medium.com/convoy-tech/the-power-of-bayesian-a-b-testing-f859d2219d5", "anchor_text": "Bayesian A/B testing", "paragraph_index": 29}, {"url": "https://en.wikipedia.org/wiki/Multi-armed_bandit", "anchor_text": "research", "paragraph_index": 30}, {"url": "https://github.com/lilianweng/multi-armed-bandit", "anchor_text": "here", "paragraph_index": 30}, {"url": "https://netflixtechblog.com/artwork-personalization-c589f074ad76", "anchor_text": "Netflix", "paragraph_index": 31}, {"url": "https://www.canva.com/", "anchor_text": "Canva", "paragraph_index": 32}], "all_paragraphs": ["In 1953, a Donald Duck comic strip entitled \u201cFlip Decision\u201d, written by Carl Barks, proposed a pseudo-philosophy called flipism. The premise is simple: for every crossroad in life requiring a decision, choose a face of a coin (heads or tails), toss the coin, and then make a decision based on the outcome of the coin flip. As the inventor of the philosophy, Professor Batty proclaimed:", "\u201cLife is but a gamble! Let flipism chart your ramble!\u201d", "Now, in the comic, unfortunately, flipism didn\u2019t work out well for Donald. A coin flip for each decision resulted in a series of mishaps for poor Donald. Ironically though, in order to deal out some comeuppance, Donald did manage to chase down the charlatan Professor Batty by finding the fraud behind the right door based on a coin flip, so perhaps the philosophy does hold some merit (or more likely, merely demonstrating the power of the author).", "Though I don\u2019t necessarily advocate living a life based on coin flips, as it turns out, coin flips and the underlying statistical principles that govern coin flips are particularly effective when applied to some problems regularly faced in data.", "Imagine now that you have trained your machine learning model, say, for predicting click-through rates of an ad on a webpage, given some user context information. You use some information about your user, for instance, which country they came from, their demographic information, the landing page they came from and a set of other features. If they were engaged on your platform, you could use features based on what they did when they used the platform to improve the performance of your model.", "You then train your model. Now then,", "What is the simplest benchmark could you use to know if your model is performant?", "Remarkably, any trained model in this scenario would have to be benchmarked against a simple coin flip.", "If we assign heads and tails for a click and non-click on an ad respectively with a probability of 50%, then randomly assigning heads and tails to predict ad clicks by tossing a coin, we get a random classifier. Now the objective of any trained model is simple: it has to at least beat the random predictor. This is why it\u2019s important to measure accuracy of the model, and then compare it to the accuracy of the random predictor (which would be, on average, at 50% accuracy).", "We can go even further: suppose we know the historical base click-through rate of the ad is, say 30%. Then, using the coin method above, we now simulate a biased coin with a 30% probability of heads, tails otherwise. Any prediction model would have to beat this new random predictor benchmark. Note that accuracy is not the only measure of performance; others such as the false positive rate, and precision and recall can be used too.", "We can see how this can be applied to any sort of binary class prediction scenario, and the randomized predictor serves as a simple sanity check: if a model cannot beat the benchmark then it is time to go back to the drawing board. Conversely, if it did beat that benchmark, then we would like to quantify by how much. We can do this easily by this simple comparison, assured that our model is performing not out of random chance, but is better than that.", "Counting has always been a standard focus of computer science since the early days of computing. One notable and important problem is the counting of large numbers, and the related problem of determining the size (cardinality) of a large set of items, a problem faced by every modern day database system.", "Suppose you have a limited amount of memory to work with, but have to count really large numbers. More concretely, consider the scenario where you are limited to a 32 bit register and need to count to numbers larger than 2\u00b3\u00b2 -1= 65,535. Such a scenario is prevalent in high-speed network routers where counting needs to be performant in a very short time window on the fast but expensive Static random-access memory (SRAM).", "One trick is to count approximately, that is, loosen the requirement of having to count exactly, instead counting with some small margin of error. The rationale here is that once you\u2019re dealing with large numbers, a small error of being off by a couple of hundred compared to a value of 100 million is not a big deal to some applications, especially applications where a ballpark figure is good enough to be actionable.", "A simple algorithm for counting large numbers is as follows:", "To increment the counter, flip a fair coin equal to the number times the current value of the counter. If the coin comes up heads each time, add 1 to the counter, otherwise do nothing.", "This is known as the Morris algorithm, and it was invented by Robert Morris at Bell Labs in 1977.", "Seems simple enough, but how does it work?", "Suppose the counter is currently at the number 2. Now, to increment we toss a fair, unbiased coin twice in a row, so the permutations we could get are", "where H is for heads and T is for tails. As per the instruction above, we only increment on HH, effectively only incrementing with probability 0.25. Since the next counter state would be 3, the range of numbers represented by the counter are between 4 and 8 (with 8 inclusive).", "As the counter value gets larger, we can see that the algorithm is just storing the base 2 logarithm of number ranges, i.e., 1, 2, 4, 8, \u2026 ad infinitum. Since any number N can be expressed in terms of logarithms, that is, log\u2082 N, then that the Morris counter is doing is to only keep the first number of log\u2082 N, in other words, the exponent of the number N.", "A more thorough analysis of the Morris algorithm, done by modelling its increments over time as a discrete time birth-death process, was made by Phillipe Flajolet (who also coined the term approximate counting in the paper)\u00b9. We can extend the Morris algorithm further (if we wish to) by keeping the exponent of the exponent for even larger numbers!", "Another interesting tidbit comes from an information theoretic analysis. If we wanted exact counts for a number N, we would need log\u2082 N bits. Morris is proposing a counter that uses log\u2082 log\u2082 N bits, thus only keeping the exponent of the number. We can now see that the scale in memory growth would be much (much) slower than if we wanted an exact number.", "These days the Morris algorithm has been superseded by improved algorithms such as the HyperLogLog algorithm, which is used in modern database systems, and is available in approximate distinct count functions in SQL dialects such as Presto and Snowflake. However, the Morris algorithm remains a precursor of modern probabilistic counting algorithms, and is one of the simplest to implement practically.", "The multi-arm bandit problem relates to the problem of maximizing the expected reward amongst a set of competing options, when the reward of each option is initially unknown, but is discoverable over time. A term alludes to the rows of slot machines at a casino, also known as one-armed bandits.", "In the multi-arm bandit scenario, a gambler has to play over a set of slot machines to figure out which machine would provide the highest expected reward over time. When the gambler first starts out, the gambler has no idea which machine would provide the highest expected reward over time; if the gambler did, then it becomes a matter of exploiting the right slot machine by solely playing on it. Since the gambler has no advance knowledge, then the gambler would have to explore the set of machines to, over time, determine the machine that produces the highest expected reward.", "Thus, we have a common case of exploration versus exploitation in an environment where the rewards are initially unknown. What kind of strategy should you adopt, and how much exploration versus exploitation would you need to do? Exploit too soon and you risk being stuck in a local maximum; explore too much and you\u2019ll never be able to maximize your expected reward, as you\u2019ll be bouncing from one option to another.", "Such a scenario occurs for a multitude of problems in the real world: portfolio allocation, recommender systems, optimizing ads shown to users, ranking search results, and dating. Though one may take offence at the last application.", "Interestingly, many of these problems fit within the coin flip framework. Let us consider two variants of an advertisement we want to show a user, with the objective of maximizing the click-through rate. We deploy both variants of the advertisement on our platform, with 50% of the user base seeing variant A, while the rest seeing variant B. We, then, over time want to allocate more proportion of users to see the best performing variant.", "We can model the scenario as follows: when each user sees an ad, a click-through, let\u2019s say heads, on the ad is a reward. Both ads A and B can be modelled as coins with different flip probabilities. Our task then is to infer the probability of click-throughs on each ad, which is essentially inferring the coin flip\u2019s probabilities for ad A and B. We would also like to know which is the best performing variant based on these probabilities (which can be used as the basis of Bayesian A/B testing).", "Once we can do that, we can then figure out how to allocate the proportion of users to the best performing ad. The subject of allocation strategies is still an area of active research, with a few well-known proposals of a solution such as the Upper-Confidence Bound algorithm\u00b2 and Thompson Sampling\u00b3. Check out Lilian Weng\u2019s implementation of these algorithms here.", "We can extend this framework to multiple ads. The multi-arm bandit formulation has been used as a replacement for classic A/B testing in various companies, such as Netflix.", "The best part is that it can be applied to other things beside ads! You can certainly extend it to recommending items, and ranking a set of search results; the caveat for both cases is that you would have to account for positional bias when displaying items to users in your UI. A version of this was used for ranking image search results at Canva, and it has been in production for some time. It has since been replaced by more powerful algorithms, but was a surprisingly difficult benchmark to unseat!", "While Donald Duck may not have had much luck in flipping a coin to decide the course of his life, flipping coins to solve problems in data science are indeed very useful.", "The humble coin flip is such a versatile framework, it can be used as a helpful mental model of binary choice situations. Next time you face a problem, think about how you can use the coin flip! Just\u2026 don\u2019t do what Donald did.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Machine learning engineer at Canva. I work on computer vision and churn modelling. My interests are data science, information theory, finance and investing."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F238ddfb02cb9&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fin-praise-of-the-coin-flip-238ddfb02cb9&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fin-praise-of-the-coin-flip-238ddfb02cb9&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fin-praise-of-the-coin-flip-238ddfb02cb9&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fin-praise-of-the-coin-flip-238ddfb02cb9&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----238ddfb02cb9--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----238ddfb02cb9--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@anamolous.behaviour?source=post_page-----238ddfb02cb9--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@anamolous.behaviour?source=post_page-----238ddfb02cb9--------------------------------", "anchor_text": "Paul Tune"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F3f15d28c014e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fin-praise-of-the-coin-flip-238ddfb02cb9&user=Paul+Tune&userId=3f15d28c014e&source=post_page-3f15d28c014e----238ddfb02cb9---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F238ddfb02cb9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fin-praise-of-the-coin-flip-238ddfb02cb9&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F238ddfb02cb9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fin-praise-of-the-coin-flip-238ddfb02cb9&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://www.pexels.com/photo/close-up-of-coins-on-table-332304/", "anchor_text": "Pexels"}, {"url": "https://scrooge-mcduck.fandom.com/wiki/Flip_Decision", "anchor_text": "\u201cFlip Decision\u201d"}, {"url": "https://en.wikipedia.org/wiki/False_positive_rate", "anchor_text": "false positive rate"}, {"url": "https://en.wikipedia.org/wiki/Precision_and_recall", "anchor_text": "precision and recall"}, {"url": "https://en.wikipedia.org/wiki/Static_random-access_memory", "anchor_text": "Static random-access memory (SRAM)"}, {"url": "https://en.wikipedia.org/wiki/HyperLogLog", "anchor_text": "HyperLogLog"}, {"url": "https://prestodb.io/docs/current/functions/hyperloglog.html", "anchor_text": "Presto"}, {"url": "https://docs.snowflake.net/manuals/user-guide/querying-approximate-cardinality.html", "anchor_text": "Snowflake"}, {"url": "https://www.pexels.com/photo/slot-machines-3021120/", "anchor_text": "Pexels"}, {"url": "https://medium.com/convoy-tech/the-power-of-bayesian-a-b-testing-f859d2219d5", "anchor_text": "Bayesian A/B testing"}, {"url": "https://en.wikipedia.org/wiki/Multi-armed_bandit", "anchor_text": "research"}, {"url": "https://github.com/lilianweng/multi-armed-bandit", "anchor_text": "here"}, {"url": "https://netflixtechblog.com/artwork-personalization-c589f074ad76", "anchor_text": "Netflix"}, {"url": "https://www.canva.com/", "anchor_text": "Canva"}, {"url": "http://algo.inria.fr/flajolet/Publications/Flajolet85c.pdf", "anchor_text": "http://algo.inria.fr/flajolet/Publications/Flajolet85c.pdf"}, {"url": "http://www.jmlr.org/papers/volume3/auer02a/auer02a.pdf", "anchor_text": "http://www.jmlr.org/papers/volume3/auer02a/auer02a.pdf"}, {"url": "https://www.dropbox.com/s/yhn9prnr5bz0156/1933-thompson.pdf", "anchor_text": "https://www.dropbox.com/s/yhn9prnr5bz0156/1933-thompson.pdf"}, {"url": "https://medium.com/tag/data?source=post_page-----238ddfb02cb9---------------data-----------------", "anchor_text": "Data"}, {"url": "https://medium.com/tag/data-science?source=post_page-----238ddfb02cb9---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/statistics?source=post_page-----238ddfb02cb9---------------statistics-----------------", "anchor_text": "Statistics"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----238ddfb02cb9---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/computer-science?source=post_page-----238ddfb02cb9---------------computer_science-----------------", "anchor_text": "Computer Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F238ddfb02cb9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fin-praise-of-the-coin-flip-238ddfb02cb9&user=Paul+Tune&userId=3f15d28c014e&source=-----238ddfb02cb9---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F238ddfb02cb9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fin-praise-of-the-coin-flip-238ddfb02cb9&user=Paul+Tune&userId=3f15d28c014e&source=-----238ddfb02cb9---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F238ddfb02cb9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fin-praise-of-the-coin-flip-238ddfb02cb9&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----238ddfb02cb9--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F238ddfb02cb9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fin-praise-of-the-coin-flip-238ddfb02cb9&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----238ddfb02cb9---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----238ddfb02cb9--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----238ddfb02cb9--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----238ddfb02cb9--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----238ddfb02cb9--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----238ddfb02cb9--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----238ddfb02cb9--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----238ddfb02cb9--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----238ddfb02cb9--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@anamolous.behaviour?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@anamolous.behaviour?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Paul Tune"}, {"url": "https://medium.com/@anamolous.behaviour/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "491 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F3f15d28c014e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fin-praise-of-the-coin-flip-238ddfb02cb9&user=Paul+Tune&userId=3f15d28c014e&source=post_page-3f15d28c014e--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F1d01df761956&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fin-praise-of-the-coin-flip-238ddfb02cb9&newsletterV3=3f15d28c014e&newsletterV3Id=1d01df761956&user=Paul+Tune&userId=3f15d28c014e&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}