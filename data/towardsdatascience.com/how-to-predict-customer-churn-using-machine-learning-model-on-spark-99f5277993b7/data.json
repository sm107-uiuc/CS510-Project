{"url": "https://towardsdatascience.com/how-to-predict-customer-churn-using-machine-learning-model-on-spark-99f5277993b7", "time": 1683005298.811025, "path": "towardsdatascience.com/how-to-predict-customer-churn-using-machine-learning-model-on-spark-99f5277993b7/", "webpage": {"metadata": {"title": "How to predict customer churn using Machine Learning model on Spark? | by Monika Bagyal | Towards Data Science", "h1": "How to predict customer churn using Machine Learning model on Spark?", "description": "If you have worked with Machine Learning models before, you know the feeling when you are dealing with huge datasets. At some point, we all realize this barrier and choose to work with a smaller\u2026"}, "outgoing_paragraph_urls": [{"url": "https://towardsdatascience.com/why-and-how-to-use-pandas-with-large-data-9594dda2ea4c", "anchor_text": "pandas", "paragraph_index": 1}, {"url": "https://machinelearningmastery.com/data-leakage-machine-learning/", "anchor_text": "data leakage", "paragraph_index": 16}, {"url": "https://stats.stackexchange.com/questions/90779/area-under-the-roc-curve-or-area-under-the-pr-curve-for-imbalanced-data", "anchor_text": "Area under the ROC curve and Area under the Precision-Recall.", "paragraph_index": 18}, {"url": "https://datascience.stackexchange.com/questions/30881/when-is-precision-more-important-over-recall", "anchor_text": "higher recall score", "paragraph_index": 21}, {"url": "https://github.com/Minsifye/Sparkify/blob/master/Sparkify.ipynb", "anchor_text": "here", "paragraph_index": 25}], "all_paragraphs": ["If you have worked with Machine Learning models before, you know the feeling when you are dealing with huge datasets. At some point, we all realize this barrier and choose to work with a smaller portion of data to start with data analysis and training models.", "Big data is very vague, but we all can agree that whenever we feel the restriction of computational power on our laptops or Machines, due to the huge size of a dataset, we see it as Big data problem. And, let\u2019s face it, python data analysis libraries like pandas have their own limitations to manipulate huge datasets due to its local-memory constraints and performance issues.", "Sparkify is a fictional music streaming service like Spotify or Pandora and I will be using Sparkify Churn Prediction as a problem statement to explain this article in detail. I will be using PySpark for this project.", "Note: Sparkify dataset was provided by Udacity Data Scientist Nanodegree program and this article is part of my Capstone project.", "I began with Exploratory Data Analysis on my local machine with a small Sparkify dataset provided by Udacity.", "During data preparation, I dealt with data challenges like missing values, data cleaning, imputing categorical variables and identifying a target variable to predict churned customers.", "To accurately predict churned customers, we need their userId information, therefore cleaning data by removing all rows where userId is either null or empty.", "Adding, a target variable as Churn. If a user has visited the \u201cCancellation Confirmation\u201d page, then the Churn column has a value 1 else 0.", "Let\u2019s have a deeper understanding of Sparkify customers, using visualizations.", "Sparkify has two types of services, one is free with ads, and another is paid premium service. Our goal is to identify paid customers before they stop using the app.", "Below events represent a very important set of features to predict churned customers.", "Time to select importantly features to train our Machine Learning models.", "The page column will further get divided into its events.", "After distributing page events into its own category as a Column, dataframe looks like this.", "Note: Dataframe might look different from full-dataset, running on AWS Spark.", "After changing all columns string values to numeric form, dataframe is ready for modeling.", "Note: Dropping \u201ccancel\u201d and \u201cCancellation Confirmation\u201d columns to prevent data leakage during modeling.", "AWS Spark MLlib library supports many supervised and unsupervised machine learning algorithms. I have used the Decision Tree Classifier, Random Forest Classifier and Gradient Boosting Classifier to train three models and comparing the outcomes before choosing the winning model.", "In pySpark, we can not print the confusion matrix, instead, we have to use MulticlassClassificationEvaluator to evaluate accuracy and f1_score. We can also use BinaryClassificationEvaluator to calculate Area under the ROC curve and Area under the Precision-Recall.", "Predicting and preventing customer churn signifies a large additional potential benefits source for every company. Our goal from the start was to identify those Sparkify customers.", "After comparing all models on different evaluation metrics, Gradient Boosting performs better than the other two. You can see that f1-score for the Gradient boosting algorithm is 0.90, while Random Forest f1-score is 0.79.", "I am resting my belief on a model with a higher recall score for positive churn class. In Lehman terms, choosing a model that can predict less False Negatives (cases where a class is 1 but predicted as 0) rather than False positives(cases where a class is 0 but predicted as 1), to successfully identifying churn customers.", "I will choose Gradient Boosting Classifier as my final model for now.", "I will run this code on AWS Spark Cluster as my future work. But, I am not deploying this model anywhere right now.", "P.S. I always try to follow a CRISP-DM approach in my Data Science projects.", "This article is part of Udacity Data Scientist Nanodegree Project. To see more about this analysis, see the link to my Github available here.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F99f5277993b7&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-predict-customer-churn-using-machine-learning-model-on-spark-99f5277993b7&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-predict-customer-churn-using-machine-learning-model-on-spark-99f5277993b7&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-predict-customer-churn-using-machine-learning-model-on-spark-99f5277993b7&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-predict-customer-churn-using-machine-learning-model-on-spark-99f5277993b7&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----99f5277993b7--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----99f5277993b7--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@monika.bagyal?source=post_page-----99f5277993b7--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@monika.bagyal?source=post_page-----99f5277993b7--------------------------------", "anchor_text": "Monika Bagyal"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Ff07501d4b93f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-predict-customer-churn-using-machine-learning-model-on-spark-99f5277993b7&user=Monika+Bagyal&userId=f07501d4b93f&source=post_page-f07501d4b93f----99f5277993b7---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F99f5277993b7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-predict-customer-churn-using-machine-learning-model-on-spark-99f5277993b7&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F99f5277993b7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-predict-customer-churn-using-machine-learning-model-on-spark-99f5277993b7&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@gratilo?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Oleg Gratilo"}, {"url": "https://unsplash.com/s/photos/spark-in-nature?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://towardsdatascience.com/why-and-how-to-use-pandas-with-large-data-9594dda2ea4c", "anchor_text": "pandas"}, {"url": "https://machinelearningmastery.com/data-leakage-machine-learning/", "anchor_text": "data leakage"}, {"url": "https://stats.stackexchange.com/questions/90779/area-under-the-roc-curve-or-area-under-the-pr-curve-for-imbalanced-data", "anchor_text": "Area under the ROC curve and Area under the Precision-Recall."}, {"url": "https://datascience.stackexchange.com/questions/30881/when-is-precision-more-important-over-recall", "anchor_text": "higher recall score"}, {"url": "https://github.com/Minsifye/Sparkify/blob/master/Sparkify.ipynb", "anchor_text": "here"}, {"url": "https://medium.com/tag/data-science?source=post_page-----99f5277993b7---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----99f5277993b7---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/pyspark?source=post_page-----99f5277993b7---------------pyspark-----------------", "anchor_text": "Pyspark"}, {"url": "https://medium.com/tag/churn-prediction?source=post_page-----99f5277993b7---------------churn_prediction-----------------", "anchor_text": "Churn Prediction"}, {"url": "https://medium.com/tag/spark?source=post_page-----99f5277993b7---------------spark-----------------", "anchor_text": "Spark"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F99f5277993b7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-predict-customer-churn-using-machine-learning-model-on-spark-99f5277993b7&user=Monika+Bagyal&userId=f07501d4b93f&source=-----99f5277993b7---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F99f5277993b7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-predict-customer-churn-using-machine-learning-model-on-spark-99f5277993b7&user=Monika+Bagyal&userId=f07501d4b93f&source=-----99f5277993b7---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F99f5277993b7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-predict-customer-churn-using-machine-learning-model-on-spark-99f5277993b7&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----99f5277993b7--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F99f5277993b7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-predict-customer-churn-using-machine-learning-model-on-spark-99f5277993b7&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----99f5277993b7---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----99f5277993b7--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----99f5277993b7--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----99f5277993b7--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----99f5277993b7--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----99f5277993b7--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----99f5277993b7--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----99f5277993b7--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----99f5277993b7--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@monika.bagyal?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@monika.bagyal?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Monika Bagyal"}, {"url": "https://medium.com/@monika.bagyal/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "28 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Ff07501d4b93f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-predict-customer-churn-using-machine-learning-model-on-spark-99f5277993b7&user=Monika+Bagyal&userId=f07501d4b93f&source=post_page-f07501d4b93f--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F324dd813a4fb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-predict-customer-churn-using-machine-learning-model-on-spark-99f5277993b7&newsletterV3=f07501d4b93f&newsletterV3Id=324dd813a4fb&user=Monika+Bagyal&userId=f07501d4b93f&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}