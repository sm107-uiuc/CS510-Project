{"url": "https://towardsdatascience.com/is-stockholm-getting-hotter-c7ce8a9008ee", "time": 1682996233.2893262, "path": "towardsdatascience.com/is-stockholm-getting-hotter-c7ce8a9008ee/", "webpage": {"metadata": {"title": "Is Stockholm Getting Hotter?. Hypothesis Test in Python | by Maykon Schots | Towards Data Science", "h1": "Is Stockholm Getting Hotter?", "description": "In this article I show that the average Stockholm temperature since the 50\u2019s is significantly higher than the years back to 1756. The data set used contains 262 years of daily temperature averages in\u2026"}, "outgoing_paragraph_urls": [{"url": "https://bolin.su.se/data/stockholm/files/stockholm-historical-weather-observations-2017/temperature/monthly/stockholm_monthly_mean_temperature_1756_2017_hom.txt", "anchor_text": "data set used", "paragraph_index": 1}, {"url": "https://medium.com/@maykonschots/making-sense-of-stockholm-historical-temperatures-data-some-hacker-statistics-in-python-part-1-e8a97c2cd7da", "anchor_text": "my first article", "paragraph_index": 4}, {"url": "https://climate.nasa.gov/evidence/", "anchor_text": "website", "paragraph_index": 5}, {"url": "https://bolin.su.se/data/stockholm/files/stockholm-historical-weather-observations-2017/temperature/monthly/stockholm_monthly_mean_temperature_1756_2017_hom.txt", "anchor_text": "URL", "paragraph_index": 8}, {"url": "https://en.wikipedia.org/wiki/Bootstrapping_(statistics)", "anchor_text": "bootstraping", "paragraph_index": 29}, {"url": "https://github.com/Schots/Stockholm-Temperatures", "anchor_text": "GitHub", "paragraph_index": 47}, {"url": "https://www.linkedin.com/in/maykon-schots-a543b49/", "anchor_text": "LinkedIn", "paragraph_index": 48}], "all_paragraphs": ["In this article I show that the average Stockholm temperature since the 50\u2019s is significantly higher than the years back to 1756.", "The data set used contains 262 years of daily temperature averages in Stockholm back to 1756. Looking at this data (transformed to years) we can see that 5 of the 10 warmest years since 1756 occurs after year 2000.", "The average temperature rose by 0.74 C since the 50\u2019s.", "By making a hypothesis test, based on the historical data and using bootstrap, I have been able to show that the weather in Stockholm has really changed.", "In my first article on Medium I wrote some code based on the same temperature data to derive Cumulative Distribution Functions in order have a visual tool to compare the empirical distributions to theoretical ones, like the normal distribution. In this article you can learn how I used this further and came up with the result described above showing that Stockholm actually is getting hotter.", "This website hosted on NASA gave me the insight to define a threshold of comparison to be the year of 1950.", "For centuries the greenhouse gas carbon dioxide level in parts per million (ppm) fluctuated below the level of 300. Higher Earth surface temperatures and green house gases concentration on atmosphere are strong correlated.", "Importing the packages with the usual aliases.", "Reading the URL which contains the raw data set.", "Our question of interest is :", "In order to answer it we will make a transformation on the data to have categorical variables indicating the century and whether the average temperature is from a year after or before the 50's.", "With this transformed data set we can start to explore and have a first understanding of how the average temperatures look like.", "Let\u2019s make a ranking of the top 10 temperatures? Be prepared.", "Looks like something is happen, no? Definitely is worth a deep investigation on these numbers.", "The plot above really suggests that the average temperature in the years after the 50\u2019s shifted towards higher values. A boxplot always comes at rescue to have a better intuition on these numbers.", "The boxplot shows that the median temperature after 50\u2019s is greater than 75% of the all the year average temperatures from before 50's.", "A rise of about 1 C is linked to huge consequences.", "Have you heard about the swarmplot? It\u2019s from the same family as the boxplot, but you can effectively see the data points. I always like to take a look at it when the number of points are not too high to get a real feeling about the distribution. In our case we have 262 average temperatures. Good!", "What do you think about the blue and red distributions? Are they coming from the same source?", "I think the problem now is well stated. Time to stop speculations and to use a statistical tool.", "Do you remember your intro to stats class? I don\u2019t. \ud83d\ude38", "The first thing in a hypothesis test, pardon me, is the hypothesis. And what is ours? Let\u2019s call it the Null Hypothesis.", "Our work is to challenge this hypothesis, by calculating the probability of observing such a difference or higher if nothing has changed in the Stockholm\u2019s weather.", "If it is small enough we have evidence that Stockholm is really getting hotter and we proudly reject the Null Hypothesis. If such a probability is high we can\u2019t claim any change based on this data.", "We have to simulate a null world and to calculate probabilities. But how?", "First, the null world. In this world, nothing has changed since the 50\u2019s, so any of the temperatures of the two groups are possible during the whole period anytime.", "What about to shuffle the temperatures between the two groups and relabel them? Definitely no problem as the weather process were always the same for the last 262 years. Below we have the code to do so.", "A concrete example. We have two groups, a and b. The permutation function shuffle the data and relabel. Clear now?", "The average difference between a and b before the permutation is 0.8.", "After the permutation the average difference becomes -1.8. In a null world this difference is a normal fluctuation that occurs randomly. If we repeat this process again and again, several times, we can build a distribution of the average difference among the two groups. The name of this technique is bootstraping.", "Are you curious to apply this stuff to the Stockholm\u2019s temperatures?", "Below the code to do the task.", "We will make permutations and relabeling our data 10000 times to plot the probability distribution of average temperature differences among our two groups (before and after 50\u2019s) in the so called null world.", "As we can see above, in the null world it would be extremely rare to observe a difference like 0.74 C.", "How rare? The probability of observing values equal or higher than our statistic of interest in a null world has a name, p-value.", "Let\u2019s calculate then the probability of observing a temperature difference as extreme as 0.74 C or higher under the null hypothesis we simulated.", "As expected by inspecting the plot, the p-value is zero. Zero with 3 decimal digits.", "With such a low p-value, we can confidently reject the null hypothesis and say that the weather processes generating the Stockholm temperatures changed.", "I personally like to visually see what is happening. In the plot below we can see all the 10000 realizations of the null world and our empirical difference (0. 74 C) as a lonely red point.", "Shall we have the sleep of the just?", "Not yet. In our simulation of the null world we used the bootstrap in a way that considers that all temperatures are independent of each other, i.e., the temperature of one year does not have relation with the previous ones. If so, our hypothesis test is likely to have failed, since it could have ruined the time-series dependency on temperatures of subsequent years.", "We must check this assumption. As a former boss of mine in the aerospace business used to say : \u2018Everything not checked is wrong\u2019.", "The next figure contains the temperature of a given year in the x-axis and the year after in the y-axis. If our independence hypothesis holds in the data set, we shall not see any defined pattern.", "Another and last check. Let\u2019s calculate the average correlation between a given year temperature and the subsequent 20 years.", "Great! One can see weak correlations among a year and the subsequent ones.", "My colleagues from Sweden knows it from a long time, since they are always saying that the last hot summer does not tell anything about the coming one this year.", "Our null world withstood and our claim that something has changed on Stockholm\u2019s weather stood.", "All the code is available in my GitHub.", "Feel free to also reach out to me on LinkedIn. Thanks for reading!", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Sports, indie rock and analytics enthusiast. Data Scientist @ Explipro Group AB, Sweden."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fc7ce8a9008ee&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fis-stockholm-getting-hotter-c7ce8a9008ee&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fis-stockholm-getting-hotter-c7ce8a9008ee&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fis-stockholm-getting-hotter-c7ce8a9008ee&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fis-stockholm-getting-hotter-c7ce8a9008ee&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----c7ce8a9008ee--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----c7ce8a9008ee--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@maykonschots?source=post_page-----c7ce8a9008ee--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@maykonschots?source=post_page-----c7ce8a9008ee--------------------------------", "anchor_text": "Maykon Schots"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F1c7684aafbc9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fis-stockholm-getting-hotter-c7ce8a9008ee&user=Maykon+Schots&userId=1c7684aafbc9&source=post_page-1c7684aafbc9----c7ce8a9008ee---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc7ce8a9008ee&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fis-stockholm-getting-hotter-c7ce8a9008ee&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc7ce8a9008ee&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fis-stockholm-getting-hotter-c7ce8a9008ee&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://bolin.su.se/data/stockholm/files/stockholm-historical-weather-observations-2017/temperature/monthly/stockholm_monthly_mean_temperature_1756_2017_hom.txt", "anchor_text": "data set used"}, {"url": "https://medium.com/@maykonschots/making-sense-of-stockholm-historical-temperatures-data-some-hacker-statistics-in-python-part-1-e8a97c2cd7da", "anchor_text": "my first article"}, {"url": "https://climate.nasa.gov/evidence/", "anchor_text": "website"}, {"url": "https://bolin.su.se/data/stockholm/files/stockholm-historical-weather-observations-2017/temperature/monthly/stockholm_monthly_mean_temperature_1756_2017_hom.txt", "anchor_text": "URL"}, {"url": "https://en.wikipedia.org/wiki/Bootstrapping_(statistics)", "anchor_text": "bootstraping"}, {"url": "https://github.com/Schots/Stockholm-Temperatures", "anchor_text": "GitHub"}, {"url": "https://www.linkedin.com/in/maykon-schots-a543b49/", "anchor_text": "LinkedIn"}, {"url": "https://medium.com/tag/environment?source=post_page-----c7ce8a9008ee---------------environment-----------------", "anchor_text": "Environment"}, {"url": "https://medium.com/tag/hypothesis-testing?source=post_page-----c7ce8a9008ee---------------hypothesis_testing-----------------", "anchor_text": "Hypothesis Testing"}, {"url": "https://medium.com/tag/python?source=post_page-----c7ce8a9008ee---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/p-value?source=post_page-----c7ce8a9008ee---------------p_value-----------------", "anchor_text": "P Value"}, {"url": "https://medium.com/tag/data-visualization?source=post_page-----c7ce8a9008ee---------------data_visualization-----------------", "anchor_text": "Data Visualization"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fc7ce8a9008ee&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fis-stockholm-getting-hotter-c7ce8a9008ee&user=Maykon+Schots&userId=1c7684aafbc9&source=-----c7ce8a9008ee---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fc7ce8a9008ee&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fis-stockholm-getting-hotter-c7ce8a9008ee&user=Maykon+Schots&userId=1c7684aafbc9&source=-----c7ce8a9008ee---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc7ce8a9008ee&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fis-stockholm-getting-hotter-c7ce8a9008ee&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----c7ce8a9008ee--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fc7ce8a9008ee&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fis-stockholm-getting-hotter-c7ce8a9008ee&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----c7ce8a9008ee---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----c7ce8a9008ee--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----c7ce8a9008ee--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----c7ce8a9008ee--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----c7ce8a9008ee--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----c7ce8a9008ee--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----c7ce8a9008ee--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----c7ce8a9008ee--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----c7ce8a9008ee--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@maykonschots?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@maykonschots?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Maykon Schots"}, {"url": "https://medium.com/@maykonschots/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "57 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F1c7684aafbc9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fis-stockholm-getting-hotter-c7ce8a9008ee&user=Maykon+Schots&userId=1c7684aafbc9&source=post_page-1c7684aafbc9--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fusers%2F1c7684aafbc9%2Flazily-enable-writer-subscription&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fis-stockholm-getting-hotter-c7ce8a9008ee&user=Maykon+Schots&userId=1c7684aafbc9&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}