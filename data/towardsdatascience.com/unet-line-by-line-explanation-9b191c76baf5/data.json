{"url": "https://towardsdatascience.com/unet-line-by-line-explanation-9b191c76baf5", "time": 1683000950.606306, "path": "towardsdatascience.com/unet-line-by-line-explanation-9b191c76baf5/", "webpage": {"metadata": {"title": "UNet \u2014 Line by Line Explanation. Example UNet Implementation | by Jeremy Zhang | Towards Data Science", "h1": "UNet \u2014 Line by Line Explanation", "description": "UNet, evolved from the traditional convolutional neural network, was first designed and applied in 2015 to process biomedical images. As a general convolutional neural network focuses its task on\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.kaggle.com/phoenigs/u-net-dropout-augmentation-stratification", "anchor_text": "kernel", "paragraph_index": 7}, {"url": "https://towardsdatascience.com/types-of-convolutions-in-deep-learning-717013397f4d", "anchor_text": "here", "paragraph_index": 17}, {"url": "https://medium.com/activating-robotic-minds/up-sampling-with-transposed-convolution-9ae4f2df52d0", "anchor_text": "here", "paragraph_index": 17}, {"url": "https://arxiv.org/abs/1505.04597", "anchor_text": "paper", "paragraph_index": 23}], "all_paragraphs": ["UNet, evolved from the traditional convolutional neural network, was first designed and applied in 2015 to process biomedical images. As a general convolutional neural network focuses its task on image classification, where input is an image and output is one label, but in biomedical cases, it requires us not only to distinguish whether there is a disease, but also to localise the area of abnormality.", "UNet is dedicated to solving this problem. The reason it is able to localise and distinguish borders is by doing classification on every pixel, so the input and output share the same size. For example, for an input image of size 2x2:", "the output will have the same size of 2x2:", "Now let\u2019s get to the detail implementation of UNet. I will:", "The network has basic foundation looks like:", "First sight, it has a \u201cU\u201d shape. The architecture is symmetric and consists of two major parts \u2014 the left part is called contracting path, which is constituted by the general convolutional process; the right part is expansive path, which is constituted by transposed 2d convolutional layers(you can think it as an upsampling technic for now).", "Now let\u2019s have a quick look at the implementation:", "The code is referred from a kernel of Kaggle competition, in general, most UNet follows the same structure.", "Now let\u2019s break down the implementation line by line and maps to the corresponding parts on the image of UNet architecture.", "The contracting path follows the formula:", "So the first part of our code is:", "Notice that each process constitutes two convolutional layers, and the number of channel changes from 1 \u2192 64, as convolution process will increase the depth of the image. The red arrow pointing down is the max pooling process which halves down size of image(the size reduced from 572x572 \u2192 568x568 is due to padding issues, but the implementation here uses padding= \u201csame\u201d).", "The process is repeated 3 more times:", "and now we reaches at the bottommost:", "still 2 convolutional layers are built, but with no max pooling:", "The image at this moment has been resized to 28x28x1024. Now let\u2019s get to the expansive path.", "In the expansive path, the image is going to be upsized to its original size. The formula follows:", "Transposed convolution is an upsampling technic that expands the size of images. There is a visualised demo here and an explanation here. Basically, it does some padding on the original image followed by a convolution operation.", "After the transposed convolution, the image is upsized from 28x28x1024 \u2192 56x56x512, and then, this image is concatenated with the corresponding image from the contracting path and together makes an image of size 56x56x1024. The reason here is to combine the information from the previous layers in order to get a more precise prediction.", "In line 4 and line 5, 2 other convolution layers are added.", "Same as before, this process is repeated 3 more times:", "Now we\u2019ve reached the uppermost of the architecture, the last step is to reshape the image to satisfy our prediction requirements.", "The last layer is a convolution layer with 1 filter of size 1x1(notice that there is no dense layer in the whole network). And the rest left is the same for neural network training.", "UNet is able to do image localisation by predicting the image pixel by pixel and the author of UNet claims in his paper that the network is strong enough to do good prediction based on even few data sets by using excessive data augmentation techniques. There are many applications of image segmentation using UNet and it also occurs in lots of competitions. One should try out on yourself and I hope this post could be a good starting point for you.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Hmm\u2026I am a data scientist looking to catch up the tide\u2026"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F9b191c76baf5&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funet-line-by-line-explanation-9b191c76baf5&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funet-line-by-line-explanation-9b191c76baf5&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funet-line-by-line-explanation-9b191c76baf5&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funet-line-by-line-explanation-9b191c76baf5&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----9b191c76baf5--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----9b191c76baf5--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://meatba11.medium.com/?source=post_page-----9b191c76baf5--------------------------------", "anchor_text": ""}, {"url": "https://meatba11.medium.com/?source=post_page-----9b191c76baf5--------------------------------", "anchor_text": "Jeremy Zhang"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Ff37783fc8c26&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funet-line-by-line-explanation-9b191c76baf5&user=Jeremy+Zhang&userId=f37783fc8c26&source=post_page-f37783fc8c26----9b191c76baf5---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F9b191c76baf5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funet-line-by-line-explanation-9b191c76baf5&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F9b191c76baf5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funet-line-by-line-explanation-9b191c76baf5&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://www.kaggle.com/phoenigs/u-net-dropout-augmentation-stratification", "anchor_text": "kernel"}, {"url": "https://towardsdatascience.com/types-of-convolutions-in-deep-learning-717013397f4d", "anchor_text": "here"}, {"url": "https://medium.com/activating-robotic-minds/up-sampling-with-transposed-convolution-9ae4f2df52d0", "anchor_text": "here"}, {"url": "https://arxiv.org/abs/1505.04597", "anchor_text": "paper"}, {"url": "https://github.com/hlamba28/UNET-TGS/blob/master/TGS%20UNET.ipynb", "anchor_text": "https://github.com/hlamba28/UNET-TGS/blob/master/TGS%20UNET.ipynb"}, {"url": "https://towardsdatascience.com/understanding-semantic-segmentation-with-unet-6be4f42d4b47", "anchor_text": "https://towardsdatascience.com/understanding-semantic-segmentation-with-unet-6be4f42d4b47"}, {"url": "https://towardsdatascience.com/types-of-convolutions-in-deep-learning-717013397f4d", "anchor_text": "https://towardsdatascience.com/types-of-convolutions-in-deep-learning-717013397f4d"}, {"url": "https://medium.com/activating-robotic-minds/up-sampling-with-transposed-convolution-9ae4f2df52d0", "anchor_text": "https://medium.com/activating-robotic-minds/up-sampling-with-transposed-convolution-9ae4f2df52d0"}, {"url": "https://www.kaggle.com/phoenigs/u-net-dropout-augmentation-stratification", "anchor_text": "https://www.kaggle.com/phoenigs/u-net-dropout-augmentation-stratification"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----9b191c76baf5---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/neural-networks?source=post_page-----9b191c76baf5---------------neural_networks-----------------", "anchor_text": "Neural Networks"}, {"url": "https://medium.com/tag/data-science?source=post_page-----9b191c76baf5---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F9b191c76baf5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funet-line-by-line-explanation-9b191c76baf5&user=Jeremy+Zhang&userId=f37783fc8c26&source=-----9b191c76baf5---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F9b191c76baf5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funet-line-by-line-explanation-9b191c76baf5&user=Jeremy+Zhang&userId=f37783fc8c26&source=-----9b191c76baf5---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F9b191c76baf5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funet-line-by-line-explanation-9b191c76baf5&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----9b191c76baf5--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F9b191c76baf5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funet-line-by-line-explanation-9b191c76baf5&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----9b191c76baf5---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----9b191c76baf5--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----9b191c76baf5--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----9b191c76baf5--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----9b191c76baf5--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----9b191c76baf5--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----9b191c76baf5--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----9b191c76baf5--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----9b191c76baf5--------------------------------", "anchor_text": ""}, {"url": "https://meatba11.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://meatba11.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Jeremy Zhang"}, {"url": "https://meatba11.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "1.1K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Ff37783fc8c26&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funet-line-by-line-explanation-9b191c76baf5&user=Jeremy+Zhang&userId=f37783fc8c26&source=post_page-f37783fc8c26--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fcdbd8b83c584&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funet-line-by-line-explanation-9b191c76baf5&newsletterV3=f37783fc8c26&newsletterV3Id=cdbd8b83c584&user=Jeremy+Zhang&userId=f37783fc8c26&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}