{"url": "https://towardsdatascience.com/intro-to-probabilistic-programming-b47c4e926ec5", "time": 1683010473.469594, "path": "towardsdatascience.com/intro-to-probabilistic-programming-b47c4e926ec5/", "webpage": {"metadata": {"title": "Intro to probabilistic programming | by Fabiana Clemente | Towards Data Science", "h1": "Intro to probabilistic programming", "description": "The idea behind Probabilistic programming to bring the inference algorithms and theory from statistics combined with formal semantics, compilers, and other tools from programming languages to build\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.tensorflow.org/probability/api_docs/python/tfp/distributions/Distribution", "anchor_text": "tfp.distributions.Distribution", "paragraph_index": 7}, {"url": "https://www.tensorflow.org/probability/api_docs/python/tfp/bijectors", "anchor_text": "tfp.bijectors", "paragraph_index": 12}, {"url": "https://www.linkedin.com/in/fabiana-clemente/", "anchor_text": "Fabiana Clemente", "paragraph_index": 33}, {"url": "https://ydata.ai/?utm_source=medium&utm_medium=signature&utm_campaign=blog", "anchor_text": "YData", "paragraph_index": 33}, {"url": "https://ydata.ai/?utm_source=medium&utm_medium=signature&utm_campaign=blog", "anchor_text": "YData", "paragraph_index": 35}], "all_paragraphs": ["The idea behind Probabilistic programming to bring the inference algorithms and theory from statistics combined with formal semantics, compilers, and other tools from programming languages to build efficient inference evaluators for models and applications from Machine Learning. In other words, probabilistic programming is a tool for statistical modeling. The idea is to borrow lessons from the world of programming languages and apply them to the problems of designing and using statistical models.", "Probabilistic programming is about doing statistics using the tools of computer science.", "In the above figure you can see a typical computer science programming pipeline: Write a program, specify the values of its arguments then evaluate the program to produce an output. The right-hand side illustrates the approach taken to modeling in statistics: Start with the output, the observations or data Y, then specify an abstract generative model p(X,Y), often denoted mathematically, and finally use algebra and inference techniques to characterize the posterior distribution, p(X | Y ), of the unknown quantities in the model given the observed quantities. Whereas in Probabilistic programming: a programming language for model definitions and statistical inference algorithms for computing the conditional distribution of the program inputs that could have given rise to the observed program output.", "Note: Probabilistic programming is not about writing software that behaves probabilistically.", "To implement such Ensemble Architecture Tensorflow introduces Tensorflow-probability.", "TensorFlow Probability is a library for probabilistic reasoning and statistical analysis in TensorFlow. As part of the TensorFlow ecosystem, TensorFlow Probability provides integration of probabilistic methods with deep networks, gradient-based inference via automatic differentiation, and scalability to large datasets and models via hardware acceleration (e.g., GPUs) and distributed computation.Probabilistic Machine Learning tools in TensorFlow-probability are structured in different levels. In this blog, we\u2019ll discuss Statistical building blocks and Model Building using TensorFlow-probability.", "Let\u2019s start with importing necessary modules:", "A tfp.distributions.Distribution is a class with two core methods: sample and log_prob. This class contains many distributions which can be seen by writing:", "Let\u2019s see how to sample a Normal Distribution which is a good starter in stat101 using tf-probability:", "Now in order to calculate other statistical parameters like cumulative distribution function and multiple distributions we can still utilize tf-probabilities native classes.", "Using the above code you can calculate CDFs and Multiple Normal Distributions on-the-fly.While using statistical-tools in your project you might also require declaring Multivariate Distributions, tf-probability has got you covered here as well!", "There are tons of distributions like these inside the tfp module, LogNormal, Logistic, LogitNormal Mixture, Multinomial, MultivariateNormalDiag, to name a few. Every distribution comes with a plethora of statistical inferences and functions.", "Bijectors represent invertible, smooth functions. They can be used to transform distributions, preserving the ability to take samples and compute log_probs. They can be accessed from the tfp.bijectors module.", "Each bijector implements at least 3 methods:", "With these ingredients, we can transform a distribution and still get samples and log probs from the result!", "Using the code snippet above we can list all the bijector functions available in tf-probability.", "Now let\u2019s see how to declare a NormalCDF using bijectors and calculate the log of the determinant of the Jacobian in forward propagation.", "Bijectors are mainly used for transforming Distributions. Here\u2019s a quick example where transformation is applied:", "After running the above snippet you\u2019ll see a transformed distribution(bins in blue) and probability density estimation plot (curve in black)", "We successfully implemented the building blocks of statistical inference in Tensorflow-probability, now let\u2019s see how we can use the same framework with tabular time-series data.", "TensorFlow-Probability (TFP) features built-in support for fitting and forecasting using structural time series models. This support includes the Bayesian inference of the model. Because they\u2019re built-in TensorFlow, these methods naturally take advantage of vectorized hardware (GPUs and TPUs), can efficiently process many time series in parallel, and can be integrated with deep neural networks.", "Let\u2019s solve a time-series problem using TensorFlow-probability:", "Now let\u2019s define a time-series problem of Co2 concentration over the years (sampled by month):", "We\u2019ll model this series with a local linear trend, plus a month-of-year seasonal effect, and fit the model using variational inference. This involves running an optimizer to minimize a variational loss function, the negative evidence lower bound (ELBO). This fits a set of approximate posterior distributions for the parameters (in practice we assume these to be independent Normals transformed to the support space of each parameter).", "The tfp.sts forecasting methods require posterior samples as inputs, so we'll finish by drawing a set of samples from the variational posterior.", "After running the above script you\u2019ll see a plot like this:", "Now let\u2019s use the fitted model to construct a forecast. We just call tfp.sts.forecast, which returns a TensorFlow Distribution instance representing the predictive distribution over future timesteps.", "In particular, the mean and stddev of the forecast distribution give us a prediction with marginal uncertainty at each timestep, and we can also draw samples of possible futures.", "Lets now visualize the forecast of the Co2 Concentration.", "We can observe here that the forecast made by our model turned out pretty good. It was able to capture seasonal changes and the overall trend of the time-series and able to predict the Co2 concentrations as it happened.", "Let\u2019s now see the Trend and Seasonality of the Co2 concentration:", "As we already discussed how statistical inferences and tools can be easily implemented through TFP. In the above plot, we can identify trends and seasonality from the data just as efficiently as other core stats modules.", "Congratulations! we just learned about the use and importance of Probabilistic-programming and discussed statistical tools in TensorFlow-probability. Not to mention we just solved a structured time-series problem using models from Tensorflow-probability!", "Fabiana Clemente is Chief Data Officer at YData.", "Making data available with privacy by design.", "YData helps data science teams deliver ML models, simplifying data acquisition, so data scientists can focus their time on things that matter.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Passionate for data. Thriving for the development of data privacy solutions while unlocking new data sources for data scientists at @YData"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fb47c4e926ec5&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintro-to-probabilistic-programming-b47c4e926ec5&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintro-to-probabilistic-programming-b47c4e926ec5&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintro-to-probabilistic-programming-b47c4e926ec5&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintro-to-probabilistic-programming-b47c4e926ec5&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----b47c4e926ec5--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----b47c4e926ec5--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@fabiana_clemente?source=post_page-----b47c4e926ec5--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@fabiana_clemente?source=post_page-----b47c4e926ec5--------------------------------", "anchor_text": "Fabiana Clemente"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Ff957353899a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintro-to-probabilistic-programming-b47c4e926ec5&user=Fabiana+Clemente&userId=f957353899a&source=post_page-f957353899a----b47c4e926ec5---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb47c4e926ec5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintro-to-probabilistic-programming-b47c4e926ec5&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb47c4e926ec5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintro-to-probabilistic-programming-b47c4e926ec5&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://www.tensorflow.org/probability", "anchor_text": "Tensorflow probability"}, {"url": "https://www.tensorflow.org/probability/api_docs/python/tfp/distributions/Distribution", "anchor_text": "tfp.distributions.Distribution"}, {"url": "https://www.tensorflow.org/probability/api_docs/python/tfp/bijectors", "anchor_text": "tfp.bijectors"}, {"url": "https://www.linkedin.com/in/fabiana-clemente/", "anchor_text": "Fabiana Clemente"}, {"url": "https://ydata.ai/?utm_source=medium&utm_medium=signature&utm_campaign=blog", "anchor_text": "YData"}, {"url": "https://ydata.ai/?utm_source=medium&utm_medium=signature&utm_campaign=blog", "anchor_text": "YData"}, {"url": "https://medium.com/tag/tensorflow?source=post_page-----b47c4e926ec5---------------tensorflow-----------------", "anchor_text": "TensorFlow"}, {"url": "https://medium.com/tag/data-science?source=post_page-----b47c4e926ec5---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----b47c4e926ec5---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/probabilistic-programming?source=post_page-----b47c4e926ec5---------------probabilistic_programming-----------------", "anchor_text": "Probabilistic Programming"}, {"url": "https://medium.com/tag/editors-pick?source=post_page-----b47c4e926ec5---------------editors_pick-----------------", "anchor_text": "Editors Pick"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fb47c4e926ec5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintro-to-probabilistic-programming-b47c4e926ec5&user=Fabiana+Clemente&userId=f957353899a&source=-----b47c4e926ec5---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fb47c4e926ec5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintro-to-probabilistic-programming-b47c4e926ec5&user=Fabiana+Clemente&userId=f957353899a&source=-----b47c4e926ec5---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb47c4e926ec5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintro-to-probabilistic-programming-b47c4e926ec5&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----b47c4e926ec5--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fb47c4e926ec5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintro-to-probabilistic-programming-b47c4e926ec5&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----b47c4e926ec5---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----b47c4e926ec5--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----b47c4e926ec5--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----b47c4e926ec5--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----b47c4e926ec5--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----b47c4e926ec5--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----b47c4e926ec5--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----b47c4e926ec5--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----b47c4e926ec5--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@fabiana_clemente?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@fabiana_clemente?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Fabiana Clemente"}, {"url": "https://medium.com/@fabiana_clemente/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "777 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Ff957353899a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintro-to-probabilistic-programming-b47c4e926ec5&user=Fabiana+Clemente&userId=f957353899a&source=post_page-f957353899a--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fd7ddbab12422&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintro-to-probabilistic-programming-b47c4e926ec5&newsletterV3=f957353899a&newsletterV3Id=d7ddbab12422&user=Fabiana+Clemente&userId=f957353899a&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}