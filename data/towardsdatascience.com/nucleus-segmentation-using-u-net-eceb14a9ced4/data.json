{"url": "https://towardsdatascience.com/nucleus-segmentation-using-u-net-eceb14a9ced4", "time": 1682996733.6893718, "path": "towardsdatascience.com/nucleus-segmentation-using-u-net-eceb14a9ced4/", "webpage": {"metadata": {"title": "Nucleus Segmentation using U-Net. How deep learning can be used for\u2026 | by Abhinav Sagar | Towards Data Science", "h1": "Nucleus Segmentation using U-Net", "description": "Automatic segmentation of microscopy images is an important task in medical image processing and analysis. Nucleus detection is an important example of this task. Imagine speeding up research for\u2026"}, "outgoing_paragraph_urls": [{"url": "https://medium.com/p/nucleus-segmentation-using-u-net-eceb14a9ced4?source=email-c3f5233f3441--writer.postDistributed&sk=881ef594402fb347d56e1c12f077732d", "anchor_text": "here", "paragraph_index": 0}, {"url": "https://www.kaggle.com/c/data-science-bowl-2018", "anchor_text": "2018 Data Science Bowl", "paragraph_index": 1}, {"url": "https://www.kaggle.com/c/data-science-bowl-2018/data", "anchor_text": "here", "paragraph_index": 3}, {"url": "https://github.com/abhinavsagar/Kaggle-tutorial", "anchor_text": "here", "paragraph_index": 5}, {"url": "https://en.wikipedia.org/wiki/Jaccard_index", "anchor_text": "Intersection over Union", "paragraph_index": 14}, {"url": "https://medium.com/@abhinav.sagar", "anchor_text": "follow me on Medium", "paragraph_index": 20}, {"url": "https://abhinavsagar.github.io", "anchor_text": "https://abhinavsagar.github.io", "paragraph_index": 23}], "all_paragraphs": ["Stuck behind the paywall? Click here to read the full story with my Friend Link!", "Automatic segmentation of microscopy images is an important task in medical image processing and analysis. Nucleus detection is an important example of this task. Imagine speeding up research for almost every disease, from lung cancer and heart disease to rare disorders. The 2018 Data Science Bowl offers our most ambitious mission yet: create an algorithm to automate nucleus detection. We\u2019ve all seen people suffer from diseases like cancer, heart disease, chronic obstructive pulmonary disease, Alzheimer\u2019s, and diabetes. Think how many lives would be transformed if cures came faster. By automating nucleus detection, you could help unlock cures faster from rare disorders to the common cold.", "This project is a part of the Data Science Bowl 2018 held on Kaggle.", "The data can be downloaded from the kaggle website which can be found here.", "This is a typical instance segmentation problem. Two architectures which have been highly successful at this are U-Net and Mask-R-CNN. I have used U-Net in this project.", "Without much ado, let\u2019s get started with the code. The complete project on github can be found here.", "Let\u2019s start with loading all the libraries and dependencies.", "We should also set some of the parameter values and load the training and test set images.", "Next we should prepare the data in the form we want. To reduce the computational complexity we need to resize all the images.", "The next step is probably the most important part of the project yet neglected most of the times. Yes, that is data augmentation. I have used shearing of images to overcome overfitting. Since the dataset size is small in this case, overfitting is not a major problem here.", "Let\u2019s display some microscopic images with and without segmentation.", "Let\u2019s also create a generator that generates masks and images.", "The architecture looks like a \u2018U\u2019 which justifies its name. This architecture consists of three sections: The contraction, The bottleneck, and the expansion section. The contraction section is made of many contraction blocks. Each block takes an input and applies two 3X3 convolution layers followed by a 2X2 max pooling. The number of kernels or feature maps after each block doubles so that architecture can learn the complex structures effectively. The bottom-most layer lies between the contraction layer and the expansion layer.", "But the heart of this architecture lies in the expansion section. Similar to contraction layer, it also consists of several expansion blocks. Each block passes the input to two 3X3 CNN layers followed by a 2X2 up-sampling layer. Also after each block number of feature maps used by convolutional layer get half to maintain symmetry. The number of expansion blocks is as same as the number of contraction block. After that the resultant mapping passes through another 3X3 CNN layer with the number of feature maps equal to the number of segments desired.", "Let\u2019s continue with defining the Intersection over Union (IOU) metric.", "Then we should build the U-Net model as shown in the above picture using keras layers.", "I have trained the model for three iterations using early-stopping criterion as a parameter and it gives fairly good results with a mean IOU of 0.416. Feel free to play with the hyper-parameters here.", "Finally I wrote a bunch of lines for the final predictions.", "This was one of the most challenging projects that I have worked on and at the same time was quite fun too. Although this was not one of the typical computer vision projects where computational complexity was a challenge, but it was more about finding small features in relatively larger sized images. Honestly to the naked eye, segmenting nucleus in an image is a challenge. Sometimes even an expert might make a mistake in this so automating the full pipeline, looks like the future of nucleus segmentation.", "The corresponding source code can be found here.", "If you want to keep updated with my latest articles and projects follow me on Medium. These are some of my contacts details:", "Happy reading, happy learning and happy coding.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Graduate Student at University of Maryland, College Park. https://abhinavsagar.github.io"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Feceb14a9ced4&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnucleus-segmentation-using-u-net-eceb14a9ced4&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnucleus-segmentation-using-u-net-eceb14a9ced4&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnucleus-segmentation-using-u-net-eceb14a9ced4&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnucleus-segmentation-using-u-net-eceb14a9ced4&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----eceb14a9ced4--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----eceb14a9ced4--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://abhinav-sagar.medium.com/?source=post_page-----eceb14a9ced4--------------------------------", "anchor_text": ""}, {"url": "https://abhinav-sagar.medium.com/?source=post_page-----eceb14a9ced4--------------------------------", "anchor_text": "Abhinav Sagar"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fc3f5233f3441&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnucleus-segmentation-using-u-net-eceb14a9ced4&user=Abhinav+Sagar&userId=c3f5233f3441&source=post_page-c3f5233f3441----eceb14a9ced4---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Feceb14a9ced4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnucleus-segmentation-using-u-net-eceb14a9ced4&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Feceb14a9ced4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnucleus-segmentation-using-u-net-eceb14a9ced4&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://medium.com/p/nucleus-segmentation-using-u-net-eceb14a9ced4?source=email-c3f5233f3441--writer.postDistributed&sk=881ef594402fb347d56e1c12f077732d", "anchor_text": "here"}, {"url": "https://www.kaggle.com/c/data-science-bowl-2018", "anchor_text": "2018 Data Science Bowl"}, {"url": "https://www.kaggle.com/c/data-science-bowl-2018/data", "anchor_text": "here"}, {"url": "https://github.com/abhinavsagar/Kaggle-tutorial", "anchor_text": "here"}, {"url": "https://en.wikipedia.org/wiki/Jaccard_index", "anchor_text": "Intersection over Union"}, {"url": "https://arxiv.org/abs/1505.04597", "anchor_text": "U-Net: Convolutional Networks for Biomedical Image SegmentationThere is large consent that successful training of deep networks requires many thousand annotated training samples. In\u2026arxiv.org"}, {"url": "https://www.kaggle.com/c/data-science-bowl-2018", "anchor_text": "2018 Data Science BowlFind the nuclei in divergent images to advance medical discoverywww.kaggle.com"}, {"url": "https://towardsdatascience.com/review-u-net-biomedical-image-segmentation-d02bf06ca760", "anchor_text": "Review: U-Net (Biomedical Image Segmentation)In this story, U-Net is reviewed. U-Net is one of the famous Fully Convolutional Networks (FCN) in biomedical image\u2026towardsdatascience.com"}, {"url": "https://github.com/abhinavsagar/Kaggle-tutorial", "anchor_text": "abhinavsagar/Kaggle-tutorialSample notebooks for Kaggle competitions. Automatic segmentation of microscopy images is an important task in medical\u2026github.com"}, {"url": "https://medium.com/@abhinav.sagar", "anchor_text": "follow me on Medium"}, {"url": "https://abhinavsagar.github.io", "anchor_text": "Personal Website"}, {"url": "https://in.linkedin.com/in/abhinavsagar4", "anchor_text": "Linkedin"}, {"url": "https://medium.com/@abhinav.sagar", "anchor_text": "Medium Profile"}, {"url": "https://github.com/abhinavsagar", "anchor_text": "GitHub"}, {"url": "https://www.kaggle.com/abhinavsagar", "anchor_text": "Kaggle"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----eceb14a9ced4---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/neural-networks?source=post_page-----eceb14a9ced4---------------neural_networks-----------------", "anchor_text": "Neural Networks"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----eceb14a9ced4---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/unet?source=post_page-----eceb14a9ced4---------------unet-----------------", "anchor_text": "Unet"}, {"url": "https://medium.com/tag/nucleus-segmentation?source=post_page-----eceb14a9ced4---------------nucleus_segmentation-----------------", "anchor_text": "Nucleus Segmentation"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Feceb14a9ced4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnucleus-segmentation-using-u-net-eceb14a9ced4&user=Abhinav+Sagar&userId=c3f5233f3441&source=-----eceb14a9ced4---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Feceb14a9ced4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnucleus-segmentation-using-u-net-eceb14a9ced4&user=Abhinav+Sagar&userId=c3f5233f3441&source=-----eceb14a9ced4---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Feceb14a9ced4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnucleus-segmentation-using-u-net-eceb14a9ced4&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----eceb14a9ced4--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Feceb14a9ced4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnucleus-segmentation-using-u-net-eceb14a9ced4&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----eceb14a9ced4---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----eceb14a9ced4--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----eceb14a9ced4--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----eceb14a9ced4--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----eceb14a9ced4--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----eceb14a9ced4--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----eceb14a9ced4--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----eceb14a9ced4--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----eceb14a9ced4--------------------------------", "anchor_text": ""}, {"url": "https://abhinav-sagar.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://abhinav-sagar.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Abhinav Sagar"}, {"url": "https://abhinav-sagar.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "2.3K Followers"}, {"url": "https://abhinavsagar.github.io", "anchor_text": "https://abhinavsagar.github.io"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fc3f5233f3441&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnucleus-segmentation-using-u-net-eceb14a9ced4&user=Abhinav+Sagar&userId=c3f5233f3441&source=post_page-c3f5233f3441--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F34161df55869&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnucleus-segmentation-using-u-net-eceb14a9ced4&newsletterV3=c3f5233f3441&newsletterV3Id=34161df55869&user=Abhinav+Sagar&userId=c3f5233f3441&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}