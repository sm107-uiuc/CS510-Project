{"url": "https://towardsdatascience.com/viewing-text-through-the-eyes-of-a-machine-db30c744ee17", "time": 1682996426.007251, "path": "towardsdatascience.com/viewing-text-through-the-eyes-of-a-machine-db30c744ee17/", "webpage": {"metadata": {"title": "Viewing text through the eyes of a machine | by Josh Taylor | Towards Data Science", "h1": "Viewing text through the eyes of a machine", "description": "We have been able to lift the lid on Convolutional Neural Networks (CNN) in computer vision tasks for a number of years now. This has brought with it significant improvements to the field through\u2026"}, "outgoing_paragraph_urls": [{"url": "https://keras.io/getting-started/functional-api-guide/", "anchor_text": "more detail here", "paragraph_index": 7}, {"url": "https://www.linkedin.com/in/josh-taylor-24806975/", "anchor_text": "https://www.linkedin.com/in/josh-taylor-24806975/", "paragraph_index": 19}], "all_paragraphs": ["We have been able to lift the lid on Convolutional Neural Networks (CNN) in computer vision tasks for a number of years now. This has brought with it significant improvements to the field through:", "With such clear benefits attributed to better model understanding, why do we not seem to have the same level of focus on model interpretability in the field of Natural Language Processing (NLP)?", "In this post we will see how we can apply the same techniques used to understand where vision-based CNNs are looking and apply this to text. We will then create a heatmap to show where a CNN is \u2018focusing-in\u2019 on particular areas of the input text in order to make a classification.", "Yes, I know, CNNs are considered a bit \u2018old fashioned\u2019 these days in the age of GPT-2, BERT, ELMo etc\u2026 however they still offer great real-world performance without the large model sizes, long inference times and large memory usage which come with some of these cutting-edge models.", "In order to walk through an example, we will first set up a simple classifier to predict whether a coffee is a light or dark roast based on its description.", "Our dataset is a series of coffee reviews. In this table we will be using blind tasting notes to try to predict whether the roast is light or dark.", "The code to build a CNN in Keras and train it on this data is below:", "If the model in Keras looks a bit different, this is because it is using the functional API (more detail here). This code trains and fits the model with a validation accuracy of around 75\u201380%. There are plenty of other posts out there on building CNN text classifiers so I will not go into any further detail here. Instead we will focus in how to interpret predictions made by this classifier.", "Using Keras this is quick and easy and requires only a few lines of code:", "The following code then gets both the prediction class and also the last CNN layer:", "2. From this we can then compute the gradient of the class output with respect to the feature map and then pool all of the gradients. This sounds complicated but can be done in just a few lines of code using Keras back-end functions:", "3. We then average this feature map and normalise it between 0 and 1:", "We now have a heatmap of activations for the predicted class over the length of the output shape of the last CNN layer. All we now need to do is to resize (stretch) this against the length of the original input (number of words) to get an understanding of which words have triggered the network.", "Adding some basic HTML to the final prediction can create a very impactful user interface whilst adding the ability to understand how the model has reached its prediction:", "This HTML snippet creates the following output in Google Colab:", "In summary, in this article we have seen how we can easily highlight areas of text which a model is \u2018reading\u2019 to make its predictions. This information is essential in order to:", "Thanks for reading. If you have any questions, let me know in the comments.", "The full code can be found in the Colab notebook below:", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "I am a specialist in producing insights through advanced analytics, machine learning and visualisation. https://www.linkedin.com/in/josh-taylor-24806975/"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fdb30c744ee17&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fviewing-text-through-the-eyes-of-a-machine-db30c744ee17&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fviewing-text-through-the-eyes-of-a-machine-db30c744ee17&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fviewing-text-through-the-eyes-of-a-machine-db30c744ee17&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fviewing-text-through-the-eyes-of-a-machine-db30c744ee17&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----db30c744ee17--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----db30c744ee17--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@thejoshtaylor?source=post_page-----db30c744ee17--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@thejoshtaylor?source=post_page-----db30c744ee17--------------------------------", "anchor_text": "Josh Taylor"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fb5b5ec923fa3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fviewing-text-through-the-eyes-of-a-machine-db30c744ee17&user=Josh+Taylor&userId=b5b5ec923fa3&source=post_page-b5b5ec923fa3----db30c744ee17---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fdb30c744ee17&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fviewing-text-through-the-eyes-of-a-machine-db30c744ee17&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fdb30c744ee17&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fviewing-text-through-the-eyes-of-a-machine-db30c744ee17&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://ai.googleblog.com/2015/06/inceptionism-going-deeper-into-neural.html", "anchor_text": "Google AI Blog"}, {"url": "https://keras.io/getting-started/functional-api-guide/", "anchor_text": "more detail here"}, {"url": "https://colab.research.google.com/drive/1taIt9A9tsENJTYh3eK0ZuUyRIdrHeNty", "anchor_text": "CNN text heatmapText interpretabilitycolab.research.google.com"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----db30c744ee17---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/nlp?source=post_page-----db30c744ee17---------------nlp-----------------", "anchor_text": "NLP"}, {"url": "https://medium.com/tag/ai-bias?source=post_page-----db30c744ee17---------------ai_bias-----------------", "anchor_text": "Ai Bias"}, {"url": "https://medium.com/tag/ai?source=post_page-----db30c744ee17---------------ai-----------------", "anchor_text": "AI"}, {"url": "https://medium.com/tag/convolution-neural-net?source=post_page-----db30c744ee17---------------convolution_neural_net-----------------", "anchor_text": "Convolution Neural Net"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fdb30c744ee17&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fviewing-text-through-the-eyes-of-a-machine-db30c744ee17&user=Josh+Taylor&userId=b5b5ec923fa3&source=-----db30c744ee17---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fdb30c744ee17&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fviewing-text-through-the-eyes-of-a-machine-db30c744ee17&user=Josh+Taylor&userId=b5b5ec923fa3&source=-----db30c744ee17---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fdb30c744ee17&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fviewing-text-through-the-eyes-of-a-machine-db30c744ee17&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----db30c744ee17--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fdb30c744ee17&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fviewing-text-through-the-eyes-of-a-machine-db30c744ee17&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----db30c744ee17---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----db30c744ee17--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----db30c744ee17--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----db30c744ee17--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----db30c744ee17--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----db30c744ee17--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----db30c744ee17--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----db30c744ee17--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----db30c744ee17--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@thejoshtaylor?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@thejoshtaylor?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Josh Taylor"}, {"url": "https://medium.com/@thejoshtaylor/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "851 Followers"}, {"url": "https://www.linkedin.com/in/josh-taylor-24806975/", "anchor_text": "https://www.linkedin.com/in/josh-taylor-24806975/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fb5b5ec923fa3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fviewing-text-through-the-eyes-of-a-machine-db30c744ee17&user=Josh+Taylor&userId=b5b5ec923fa3&source=post_page-b5b5ec923fa3--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F826db04da2c9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fviewing-text-through-the-eyes-of-a-machine-db30c744ee17&newsletterV3=b5b5ec923fa3&newsletterV3Id=826db04da2c9&user=Josh+Taylor&userId=b5b5ec923fa3&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}