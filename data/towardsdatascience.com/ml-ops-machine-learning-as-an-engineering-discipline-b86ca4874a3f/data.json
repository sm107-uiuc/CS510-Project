{"url": "https://towardsdatascience.com/ml-ops-machine-learning-as-an-engineering-discipline-b86ca4874a3f", "time": 1683002545.630431, "path": "towardsdatascience.com/ml-ops-machine-learning-as-an-engineering-discipline-b86ca4874a3f/", "webpage": {"metadata": {"title": "MLOps: Machine Learning Engineering | Towards Data Science", "h1": "ML Ops: Machine Learning as an Engineering Discipline", "description": "ML Ops (or MLOps) is a set of practices uniting Machine Learning, DevOps and Data Engineering, aiming to deploy and maintain ML systems reliably and efficiently."}, "outgoing_paragraph_urls": [{"url": "https://info.deeplearning.ai/the-batch-companies-slipping-on-ai-goals-self-training-for-better-vision-muppets-and-models-china-vs-us-only-the-best-examples-proliferating-patents", "anchor_text": "Deeplearning.ai reports", "paragraph_index": 2}, {"url": "https://en.wikipedia.org/wiki/DevOps", "anchor_text": "DevOps", "paragraph_index": 4}, {"url": "https://landing.google.com/sre/sre-book/chapters/monitoring-distributed-systems/", "anchor_text": "standard metrics like latency, traffic, errors and saturation", "paragraph_index": 30}], "all_paragraphs": ["So, your company decided to invest in machine learning. You have a talented team of Data Scientists churning out models to solve important problems that were out of reach just a few years ago. All performance metrics are looking great, the demos cause jaws to drop and executives to ask how soon you can have a model in production.", "It should be pretty quick, you think. After all, you already solved all the advanced scienc-y, math-y problems, so all that\u2019s left is routine IT work. How hard can it be?", "Pretty hard, it turns out. Deeplearning.ai reports that \u201conly 22 percent of companies using machine learning have successfully deployed a model\u201d. What makes it so hard? And what do we need to do to improve the situation?", "Let\u2019s start by looking at the root causes.", "In the world of traditional software development, a set of practices known as DevOps have made it possible to ship software to production in minutes and to keep it running reliably. DevOps relies on tools, automation and workflows to abstract away the accidental complexity and let developers focus on the actual problems that need to be solved. This approach has been so successful that many companies are already adept at it, so why can\u2019t we simply keep doing the same thing for ML?", "The root cause is that there\u2019s a fundamental difference between ML and traditional software: ML is not just code, it\u2019s code plus data. An ML model, the artifact that you end up putting in production, is created by applying an algorithm to a mass of training data, which will affect the behavior of the model in production. Crucially, the model\u2019s behavior also depends on the input data that it will receive at prediction time, which you can\u2019t know in advance.", "While code is carefully crafted in a controlled development environment, data comes from that unending entropy source known as \u201cthe real world\u201d. It never stops changing, and you can\u2019t control how it will change. A useful way to think of their relationship is as if code and data live in separate planes, which share the time dimension but are independent in all others. The challenge of an ML process is to create a bridge between these two planes in a controlled way.", "This fundamental disconnect causes several important challenges that need to be solved by anyone trying to put an ML model in production successfully, for example:", "Since the word \u201cdata\u201d has been already used several times in this article, you may be thinking of another discipline that could come to our rescue: Data Engineering. And you would be right: Data Engineering does provide important tools and concepts that are indispensable to solving the puzzle of ML in production. In order to crack it, we need to combine practices from DevOps and Data Engineering, adding some that are unique to ML.", "Thus, ML Ops can be defined by this intersection:", "Thus, we could define ML Ops as follows:", "ML Ops is a set of practices that combines Machine Learning, DevOps and Data Engineering, which aims to\u00a0deploy\u00a0and\u00a0maintain\u00a0ML\u00a0systems\u00a0in\u00a0production\u00a0reliably\u00a0and\u00a0efficiently.", "Let\u2019s now see what this actually means in\u00a0more\u00a0detail, by examining the individual practices that can be used to achieve ML Ops' goals.", "Since we\u2019ve already established that productionizing an ML model requires a set of skills that so far were considered separate, in order to be successful we need a hybrid team that, together, covers that range\u00a0of\u00a0skills. It is of course possible that a single person might be good enough at all of them, and in that case we could call that person a full ML Ops Engineer. But the most likely scenario right now is that a successful team would include a Data Scientist or ML Engineer, a DevOps Engineer and a Data Engineer.", "The exact composition, organization and titles of the team could vary, but the essential part is realizing that a Data Scientist alone cannot achieve the goals of ML Ops. Even if an organization includes all necessary skills, it won\u2019t be successful if they don\u2019t work closely together.", "Another important change is that Data Scientists must be proficient in basic software engineering skills like code modularization, reuse, testing and versioning; getting a model to work great in a messy notebook is not enough. This is why many companies are adopting the title of ML Engineer, which emphasizes these skills. In many cases, ML Engineers are, in practice, performing many of the activities required for ML Ops.", "One of the core concepts of Data Engineering is the data pipeline. A data pipeline is a series of transformations that are applied to data between its source and a destination. They are usually defined as a graph in which each node is a transformation and edges represent dependencies or execution order. There are many specialized tools that help create, manage and run these pipelines. Data pipelines can also be called ETL (extract, transform and load) pipelines.", "ML models always require some type of data transformation, which is usually achieved though scripts or even cells in a notebook, making them hard to manage and run reliably. Switching to proper data pipelines provides many advantages in code reuse, run time visibility, management and scalability.", "Since ML training can also be thought of as a data transformation, it is natural to include the specific ML steps in the data pipeline itself, turning it into an ML Pipeline. Most models will need 2 versions of the pipeline: one for training and one for serving. This is because, usually, the data formats and way to access them are very different between each moment, especially for models that are served in real-time requests (as opposed to batch prediction\u00a0runs).", "The ML Pipeline is a pure code artifact, independent from specific data instances. This means that it\u2019s possible to track its versions in source control and automate its deployment with a regular CI/CD pipeline, a core practice from DevOps. This lets us connect the code and data planes in a structured and automated way:", "Note that there are two distinct ML pipelines: the training pipeline and the serving pipeline. What they have in common is that the data transformations that they perform need to produce data in the same format, but their implementations can be very different. For example, the training pipeline usually runs over batch files that contain all features, while the serving pipeline often runs online and receives only part of the features in the requests, retrieving the rest from a database.", "It is important, however, to ensure that these two pipelines are consistent, so one should try to reuse code and data whenever possible. Some tools can help with that\u00a0goal, for example:", "In order to have reproducibility, consistent version tracking is essential. In a traditional software world, versioning code is enough, because all behavior is defined by it. In ML, we also need to track model versions, along with the data used to train it, and some meta-information like training hyperparameters.", "Models and metadata can be tracked in a standard version control system like Git, but data is often too large and mutable for that to be efficient and practical. It\u2019s also important to avoid tying the model lifecycle to the code lifecycle, since model training often happens on a different schedule. It\u2019s also necessary to version data and tie each trained model to the exact versions of code, data and hyperparameters that were used. The ideal solution would be a purpose-built tool, but so far there is no clear consensus in the market and many schemes are used, most based on file/object storage conventions and metadata databases.", "Another standard DevOps practice is test automation, usually in the form of unit tests and integration tests. Passing these tests is a prerequisite for a new version to be deployed. Having comprehensive automated tests can give great confidence to a team, accelerating the pace of production deployments dramatically.", "ML models are harder to test, because no model gives 100% correct results. This means that model validation tests need to be necessarily statistical in nature, rather than having a binary pass/fail status. In order to decide whether a model is good enough for deployment, one needs to decide on the right metrics to track and the threshold of their acceptable values, usually empirically, and often by comparison with previous models or benchmarks.", "It\u2019s also not enough to track a single metric for the entirety of the validation set. Just as good unit tests must test several cases, model validation needs to be done individually for relevant segments of the data, known as slices. For example, if gender could be a relevant feature of a model, directly or indirectly, tracking separate metrics for male, female and other genders. Otherwise, the model could have fairness issues or under-perform in important segments.", "If you manage to get models validated in an automated and reliable way, along with the rest of the ML pipeline, you could even close the loop and implement online model training, if it makes sense for the use case.", "A good data pipeline usually starts by validating the input data. Common validations include file format and size, column types, null or empty values and invalid values. These are all necessary for ML training and prediction, otherwise you might end up with a misbehaving model and scratching your head looking for the reason. Data validation is analogous to unit testing in the code domain.", "In addition to basic validations that any data pipeline performs, ML pipelines should also validate higher level statistical properties of the input. For example, if the average or standard deviation of a feature change considerably from one training dataset to another, it will likely affect the trained model and its predictions. This could be a reflection of actual change in the data or it could be an anomaly caused by how the data is processed, so it\u2019s important to check and rule out systemic errors as causes that could contaminate the model, and fix them if necessary", "Monitoring production systems is essential to keeping them running well. For ML systems, monitoring becomes even more important, because their performance depends not just on factors that we have some control over, like infrastructure and our own software, but also on data, which we have much less control over. Therefore, in addition to monitoring standard metrics like latency, traffic, errors and saturation, we also need to monitor model prediction performance.", "An obvious challenge with monitoring model performance is that we usually don\u2019t have a verified label to compare our model\u2019s predictions to, since the model works on new data. In some cases we might have some indirect way of assessing the model\u2019s effectiveness, for example by measuring click rate for a recommendation model. In other cases, we might have to rely on comparisons between time periods, for example by calculating a percentage of positive classifications hourly and alerting if it deviates by more than a few percent from the average for that time.", "Just like when validating the model, it\u2019s also important to monitor metrics across slices, and not just globally, to be able to detect problems affecting specific segments.", "As ML matures from research to applied business solutions, so do we need to improve the maturity of its operation processes. Luckily, we can extend many practices from disciplines that came before\u00a0ML.", "The following table summarizes ML Ops\u2019 main practices and how they relate to DevOps and Data Engineering practices:", "This is a brand new and exciting discipline, with tools and practices that are likely to keep evolving very quickly. There\u2019s certainly a lot of opportunity in developing and applying production techniques to ML.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fb86ca4874a3f&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fml-ops-machine-learning-as-an-engineering-discipline-b86ca4874a3f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fml-ops-machine-learning-as-an-engineering-discipline-b86ca4874a3f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fml-ops-machine-learning-as-an-engineering-discipline-b86ca4874a3f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fml-ops-machine-learning-as-an-engineering-discipline-b86ca4874a3f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----b86ca4874a3f--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----b86ca4874a3f--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@cbreuel?source=post_page-----b86ca4874a3f--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@cbreuel?source=post_page-----b86ca4874a3f--------------------------------", "anchor_text": "Cristiano Breuel"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F41041a054f5a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fml-ops-machine-learning-as-an-engineering-discipline-b86ca4874a3f&user=Cristiano+Breuel&userId=41041a054f5a&source=post_page-41041a054f5a----b86ca4874a3f---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb86ca4874a3f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fml-ops-machine-learning-as-an-engineering-discipline-b86ca4874a3f&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb86ca4874a3f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fml-ops-machine-learning-as-an-engineering-discipline-b86ca4874a3f&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://info.deeplearning.ai/the-batch-companies-slipping-on-ai-goals-self-training-for-better-vision-muppets-and-models-china-vs-us-only-the-best-examples-proliferating-patents", "anchor_text": "Deeplearning.ai reports"}, {"url": "https://en.wikipedia.org/wiki/DevOps", "anchor_text": "DevOps"}, {"url": "https://www.kubeflow.org/docs/pipelines/overview/pipelines-overview/", "anchor_text": "Kubeflow Pipelines"}, {"url": "https://www.tensorflow.org/tfx/transform/get_started", "anchor_text": "TensorFlow Transform"}, {"url": "https://www.tensorflow.org/tfx/data_validation/get_started", "anchor_text": "TensorFlow Data Validation"}, {"url": "https://landing.google.com/sre/sre-book/chapters/monitoring-distributed-systems/", "anchor_text": "standard metrics like latency, traffic, errors and saturation"}, {"url": "https://www.youtube.com/watch?v=20h_RTHEtZI", "anchor_text": "Kaz Sato \u2014 ML Ops Best Practices on Google Cloud (Cloud Next \u201819)"}, {"url": "https://www.youtube.com/watch?v=_jnhXzY1HCw", "anchor_text": "Kaz Sato \u2014 What is ML Ops? Best Practices for DevOps for ML (Cloud Next \u201818)"}, {"url": "https://www.kubeflow.org/", "anchor_text": "Kubeflow \u2014 The Machine Learning Toolkit for Kubernetes"}, {"url": "https://www.tensorflow.org/tfx/", "anchor_text": "TensorFlow Extended (TFX) \u2014 an end-to-end platform for deploying production ML pipelines"}, {"url": "https://developers.google.com/machine-learning/guides/rules-of-ml", "anchor_text": "Rules of Machine Learning: Best Practices for ML Engineering"}, {"url": "https://medium.com/tag/data-science?source=post_page-----b86ca4874a3f---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----b86ca4874a3f---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/data-engineering?source=post_page-----b86ca4874a3f---------------data_engineering-----------------", "anchor_text": "Data Engineering"}, {"url": "https://medium.com/tag/devops?source=post_page-----b86ca4874a3f---------------devops-----------------", "anchor_text": "DevOps"}, {"url": "https://medium.com/tag/towards-data-science?source=post_page-----b86ca4874a3f---------------towards_data_science-----------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fb86ca4874a3f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fml-ops-machine-learning-as-an-engineering-discipline-b86ca4874a3f&user=Cristiano+Breuel&userId=41041a054f5a&source=-----b86ca4874a3f---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fb86ca4874a3f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fml-ops-machine-learning-as-an-engineering-discipline-b86ca4874a3f&user=Cristiano+Breuel&userId=41041a054f5a&source=-----b86ca4874a3f---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb86ca4874a3f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fml-ops-machine-learning-as-an-engineering-discipline-b86ca4874a3f&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----b86ca4874a3f--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fb86ca4874a3f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fml-ops-machine-learning-as-an-engineering-discipline-b86ca4874a3f&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----b86ca4874a3f---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----b86ca4874a3f--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----b86ca4874a3f--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----b86ca4874a3f--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----b86ca4874a3f--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----b86ca4874a3f--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----b86ca4874a3f--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----b86ca4874a3f--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----b86ca4874a3f--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@cbreuel?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@cbreuel?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Cristiano Breuel"}, {"url": "https://medium.com/@cbreuel/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "438 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F41041a054f5a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fml-ops-machine-learning-as-an-engineering-discipline-b86ca4874a3f&user=Cristiano+Breuel&userId=41041a054f5a&source=post_page-41041a054f5a--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F3ed4833db5a3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fml-ops-machine-learning-as-an-engineering-discipline-b86ca4874a3f&newsletterV3=41041a054f5a&newsletterV3Id=3ed4833db5a3&user=Cristiano+Breuel&userId=41041a054f5a&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}