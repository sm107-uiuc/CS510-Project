{"url": "https://towardsdatascience.com/kickstarter-with-mlops-cc672d65731f", "time": 1683014787.0405278, "path": "towardsdatascience.com/kickstarter-with-mlops-cc672d65731f/", "webpage": {"metadata": {"title": "Kickstarter with MLOps. Classifying success of kickstarter\u2026 | by Petter Hultin Gustafsson | Towards Data Science", "h1": "Kickstarter with MLOps", "description": "Backing inventors on Kickstarter has for me, in 99 % of the cases, lead to years of waiting for a product that just never shows up at my doorstep. So, let\u2019s once and for all remedy this with an\u2026"}, "outgoing_paragraph_urls": [{"url": "https://mlops.cloud", "anchor_text": "MLOps platform", "paragraph_index": 0}, {"url": "https://www.kaggle.com/kemical/kickstarter-projects", "anchor_text": "Kaggle", "paragraph_index": 0}, {"url": "https://docs.mlops.cloud/sdk/preprocessing/", "anchor_text": "MLOps SDK", "paragraph_index": 5}, {"url": "https://docs.mlops.cloud/getting_started/local_mode/", "anchor_text": "local testing environment", "paragraph_index": 13}, {"url": "https://join.slack.com/t/mlops-communitygroup/shared_invite/zt-f27d828w-XuVpXs0NIA9jJTOIYHdk1g", "anchor_text": "Slack community", "paragraph_index": 20}], "all_paragraphs": ["Backing inventors on Kickstarter has for me, in 99 % of the cases, lead to years of waiting for a product that just never shows up at my doorstep. So, let\u2019s once and for all remedy this with an amazing kickstarter success classifier. We will use the MLOps platform to our ingest our datasource (you can find it here on Kaggle), then develop our preprocessing and model scripts locally using the SDK, to finally submit the whole package to our AWS account to get it versioned and ready for production. After all, this could be a real money maker.", "Some might argue that using Spark for a 50 MB dataset might be a bit overkill. But I like consistency and improvement. After all, it works just as good for MB as TB.", "Let\u2019s start with defining our main function:", "As usual, I generate the script template using the MLOps platform, reading the datasource from S3. The MLOps SDK gives me a nice wrapper for all the things we don\u2019t want to think about \u2014 like reading, writing and version controlling the transformations, so that I can focus on what happens in my_transformations .", "Next up, let\u2019s define the PySpark classes I\u2019m going to use:", "Nothing fancy going on here, the normal Spark preprocessing classes as well as importing the MLOps SDK.", "We are also going to need my favourite PySpark helper function that transform PySpark vectors into columns:", "So once we are done with that, we can move on to the main function, that takes the raw input DataFrame, does all transformations and then returns it to main for disk writing. We start off by just cleaning up the DataFrame a bit, asserting that all values has the right types:", "We also calculate the total \u201conline\u201d time of the campaign by subtracting the start and end time of the project, as well as filter out some small subclasses like currencies that are not USD (~10 % of the data) and states that are not success or fail (~6 % of the data).", "Once we are done with that, we can move on to transforming all categorical string columns to integers:", "Once we are done with that, we can move on to scaling all columns. This is an important step for deep learning, since we don\u2019t want our weights to go haywire. I will use the StandardScaler , and once I\u2019m done I will also use the OneHotEncoder to transform my project state column (success/fail) into a one hot encoding representation, since that\u2019s the format TensorFlow desires:", "One important thing to notice, which you will only learn by painful experience is the dropLast=False argument for the OneHotEncoder . I know they have a reason for defaulting this one to True , but I honestly think someone decided that while being drunk.", "Finally, we can explode the one hot encoded vector into columns and return to main:", "While I develop this script, I\u2019m using the MLOps local testing environment available inside the platform by doing pip install mlops-local , so that I can quickly iterate on a subset of the data until I\u2019m happy with my transformations:", "The final result, with calculated metrics I can then inspect inside the Datasets view:", "As always, training is about the same setup as for preprocessing. As with preprocessing, I have a little bit of template generated code in the main function that handles reading, writing and sending data back to the console.", "Besides that, I have a my_network function where I define my architecture. In the console, I provide the script with my hyperparameters, which in this case are batch_size , learning_rate and epochs that are then available under mlops.hyperparameters along with the data matrices for training, validation and test. I will run this for 20 epochs, which might be a bit over the top for the amount of data:", "As expected, we see a quick run up to almost 96 % accuracy and then a stagnation and the loss going crazy. Seriously overtrained. But then again, it got a solid 96 % on the test set, and this is just me playing around.", "Since we are SO happy with our model, it\u2019s time to make some money on it, exposing it to the world (not really, it\u2019s hidden in a VPC that\u2019s accessible from your cloud services). I will create a Live endpoint, meaning a hosted API that is up and running 24/7 scaling the instances horizontally based on the CPU utilisation of the inference machine.", "I will also set a data sampling percentage of 10 %, meaning that for every tenth request the MLOps platform will save the input and output from the inference and run analysis on data drift, schema correctness etc. On this I can later set an alarm to notify my DevOps team if shit hits the fan:", "So, that\u2019s some end to end magic for you. Hope to see you soon in the Slack community where we discuss machine learning and operations from the aspects of data engineering, data science and DevOps, and how they all can come together!", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Petter is the founder and CEO of MLOps, a plug and play solution for end to end machine learning. He has previously co-founded Growbotics and Tracy Trackers."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fcc672d65731f&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fkickstarter-with-mlops-cc672d65731f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fkickstarter-with-mlops-cc672d65731f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fkickstarter-with-mlops-cc672d65731f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fkickstarter-with-mlops-cc672d65731f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----cc672d65731f--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----cc672d65731f--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@petter_28583?source=post_page-----cc672d65731f--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@petter_28583?source=post_page-----cc672d65731f--------------------------------", "anchor_text": "Petter Hultin Gustafsson"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F52536d6e7d35&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fkickstarter-with-mlops-cc672d65731f&user=Petter+Hultin+Gustafsson&userId=52536d6e7d35&source=post_page-52536d6e7d35----cc672d65731f---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fcc672d65731f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fkickstarter-with-mlops-cc672d65731f&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fcc672d65731f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fkickstarter-with-mlops-cc672d65731f&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://mlops.cloud", "anchor_text": "MLOps platform"}, {"url": "https://www.kaggle.com/kemical/kickstarter-projects", "anchor_text": "Kaggle"}, {"url": "https://docs.mlops.cloud/sdk/preprocessing/", "anchor_text": "MLOps SDK"}, {"url": "https://docs.mlops.cloud/getting_started/local_mode/", "anchor_text": "local testing environment"}, {"url": "https://join.slack.com/t/mlops-communitygroup/shared_invite/zt-f27d828w-XuVpXs0NIA9jJTOIYHdk1g", "anchor_text": "Slack community"}, {"url": "https://medium.com/tag/data-science?source=post_page-----cc672d65731f---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/devops?source=post_page-----cc672d65731f---------------devops-----------------", "anchor_text": "DevOps"}, {"url": "https://medium.com/tag/project-management?source=post_page-----cc672d65731f---------------project_management-----------------", "anchor_text": "Project Management"}, {"url": "https://medium.com/tag/ai?source=post_page-----cc672d65731f---------------ai-----------------", "anchor_text": "AI"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----cc672d65731f---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fcc672d65731f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fkickstarter-with-mlops-cc672d65731f&user=Petter+Hultin+Gustafsson&userId=52536d6e7d35&source=-----cc672d65731f---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fcc672d65731f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fkickstarter-with-mlops-cc672d65731f&user=Petter+Hultin+Gustafsson&userId=52536d6e7d35&source=-----cc672d65731f---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fcc672d65731f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fkickstarter-with-mlops-cc672d65731f&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----cc672d65731f--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fcc672d65731f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fkickstarter-with-mlops-cc672d65731f&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----cc672d65731f---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----cc672d65731f--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----cc672d65731f--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----cc672d65731f--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----cc672d65731f--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----cc672d65731f--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----cc672d65731f--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----cc672d65731f--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----cc672d65731f--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@petter_28583?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@petter_28583?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Petter Hultin Gustafsson"}, {"url": "https://medium.com/@petter_28583/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "15 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F52536d6e7d35&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fkickstarter-with-mlops-cc672d65731f&user=Petter+Hultin+Gustafsson&userId=52536d6e7d35&source=post_page-52536d6e7d35--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fusers%2F52536d6e7d35%2Flazily-enable-writer-subscription&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fkickstarter-with-mlops-cc672d65731f&user=Petter+Hultin+Gustafsson&userId=52536d6e7d35&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}