{"url": "https://towardsdatascience.com/lime-explaining-predictions-of-machine-learning-models-1-2-1802d56addf9", "time": 1682997121.023264, "path": "towardsdatascience.com/lime-explaining-predictions-of-machine-learning-models-1-2-1802d56addf9/", "webpage": {"metadata": {"title": "LIME: Explaining predictions of machine learning models (1/2) | by Sharayu Rane | Towards Data Science", "h1": "LIME: Explaining predictions of machine learning models (1/2)", "description": "I would like to begin by asking the following question: \u201cCan we trust the model predictions just because the model performance is convincingly high on the test data?\u201d Many people might answer this\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.kaggle.com/uciml/default-of-credit-card-clients-dataset", "anchor_text": "Kaggle", "paragraph_index": 6}, {"url": "http://datascienceninja.com/", "anchor_text": "http://datascienceninja.com/", "paragraph_index": 23}, {"url": "http://datascienceninja.com/2019/07/10/lime-explaining-predictions-of-machine-learning-models-1-2/", "anchor_text": "here", "paragraph_index": 23}, {"url": "http://www.datascienceninja.com", "anchor_text": "www.datascienceninja.com", "paragraph_index": 25}], "all_paragraphs": ["I would like to begin by asking the following question: \u201cCan we trust the model predictions just because the model performance is convincingly high on the test data?\u201d Many people might answer this question as \u2018Yes\u2019. But this is not always true. High model performance should not be considered an indicator to trust the model predictions, as the signals being picked up by the model can be random and might not make business sense.", "In this blog I am going to talk about LIME , a method that helps in understanding the reasons behind predictions at an instance level. This is a model agnostic technique i.e. you can use this with any model be it Neural Networks, Tree based models, SVMs etc.", "LIME stands for Local Interpretable Model-Agnostic Explanations. The word Local seems to be most confounding for many people. So let me start by explaining why the word Local.", "The relation between the target and the independent variable can get very complex at a global level, for example refer to the image below. Looking at this global view does not provide much insight on the relationship between the independent feature and the target, so LIME zooms in goes at a very very local level.", "Let\u2019s assume that the instance being explained is marked by green star. The principal intuition behind LIME is that after zooming in and analyzing the relationship between target and the independent feature locally, we can approximate this relation using linear models.", "Now let\u2019s understand what are the steps of how LIME works:", "Now let\u2019s get into the example to explain the LIME results. I have used the data set from Kaggle. The objective is to identify the strongest predictors of default credit card payment. I have fitted a Scikit-learn implementation of Gradient Boosted Trees.", "Orange color indicates that the contribution is towards a \u2018Default Payment\u2019, and Blue color indicates that the contribution is towards \u2018Non Default Payment\u2019 . The global model\u2019s prediction for this instance is 0.072 where as for the local model the prediction is 0.066. So, for this particular instance the prediction of the global model and local model is very close.", "The above example shows that the top contributor for this particular instance to be tagged as \u2018Non Default Payment\u2019 is the repayment status in the previous month (PAY_0 = 1). This means that in the previous month the payment was done on time. The interpretation of the other variables is also similar (PAY_2, PAY_3 etc.). This indicates that if the payments for previous months was done on time then there is high likelihood for the person to not default in the next month.", "High amount of LIMIT_BAL also contributes towards \u2018Non Default Payment\u2019. This makes sense too because high LIMIT_BAL means that the supplementary credit left is low. So, there is a chance that the next month\u2019s bill will potentially be low, and hence less chance to default. Now, for continuous features LIME\u2019s output provides more detail as it specifies a range of feature values that are causing that feature to have its influence. E.g. \u2018LIMIT_BAL > 240,000\u2019", "I personally find analyzing the incorrectly predicted instances to be very insightful. This helps in understanding what features actually drove the prediction to be incorrect.", "The above instance is incorrectly predicted as Non Default Payment owing to the features that denote previous payment history (PAY_0, PAY_2, PAY_3). For this instance the previous payments were done duly on time. This might have swayed the prediction to be incorrect.", "With the above example, the general idea of LIME sounds reasonable, but there are some potential drawbacks that LIME is susceptible to.", "LIME currently implements linear models locally to get the explanations. While this assumption is valid for a small region around the instance being explained. But for more complex data sets, as we increase the area of the local region this assumption might not be true. Thus, the explanations from the local interpretable models might not explain the behavior of the global linear model.", "The number of features to be selected for the explanation needs to be optimally selected. The number of features should be selected such that the complexity of the model is maintained along with the simplicity of the explanation. In python implementation of LIME, it provides the following options: \u2018forward_selection\u2019, \u2018lasso_path\u2019, \u2018none\u2019 or \u2018auto\u2019.", "LIME currently doesn\u2019t support classifier models without probability scores.", "LIME implementation doesn\u2019t provide an aggregated view of the feature explanation. The user has to in turn analyze the individual instances.", "For tabular data, LIME creates new samples by perturbing each feature individually, drawing from a normal distribution with mean and standard deviation taken from the feature. For continuous features LIME provides an option to perturb samples from the normal centered on the instance being explained or from the normal centered on the mean of the feature data set. LIME weighs higher the samples close to the instance of interest. Now in high dimensional space with each feature having a different range of values, calculating similarity index is challenging and might not result in clean results.", "Defining a correct neighborhood to run the locally interpretable models is a difficult problem. So why do we need to define a local neighborhood along the instance being explained? The accuracy of the of the explanation model to the original model is enforced through the loss function over a set of samples in the simplified input space weighted by the local kernel. Currently LIME uses an exponential smoothing kernel. The width of this kernel determines the influence on the local model of the instance being explained, and again there is no best way to determine the width of the kernel.", "LIME explanations can sometimes lack consistency due to the sampling bias, calculation of the similarity score and definition of the neighborhood.", "LIME provides very simple interpretable explanations and is a quick way to analyze the contribution of each feature. LIME can also be used on text and image data, and the execution time of LIME is less as compared to other explainable techniques such as SHAP. Another feature I like about LIME is that the local surrogate models can actually use independent features other than the ones used in the global model.", "In the next blog, I will explain another popular technique: SHAP that is used for explaining model predictions.", "This field of Explainable AI is evolving rapidly, and there are lot of new developments in terms of tools and frameworks. In the comments section please write your feedback on the blog, and the latest tools you have used in this field. Also, comment if you would like me to write about any particular topic.", "This content was originally published on my personal blogging website: http://datascienceninja.com/. Click here to view it and subscribe to receive updates on latest blogs instantly.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Follow www.datascienceninja.com to get access to my latest blogs! Data Science Consultant @ ZS Associates"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F1802d56addf9&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flime-explaining-predictions-of-machine-learning-models-1-2-1802d56addf9&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flime-explaining-predictions-of-machine-learning-models-1-2-1802d56addf9&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flime-explaining-predictions-of-machine-learning-models-1-2-1802d56addf9&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flime-explaining-predictions-of-machine-learning-models-1-2-1802d56addf9&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----1802d56addf9--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----1802d56addf9--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@ranesharayu?source=post_page-----1802d56addf9--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@ranesharayu?source=post_page-----1802d56addf9--------------------------------", "anchor_text": "Sharayu Rane"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F8da9315e57a8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flime-explaining-predictions-of-machine-learning-models-1-2-1802d56addf9&user=Sharayu+Rane&userId=8da9315e57a8&source=post_page-8da9315e57a8----1802d56addf9---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F1802d56addf9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flime-explaining-predictions-of-machine-learning-models-1-2-1802d56addf9&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F1802d56addf9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flime-explaining-predictions-of-machine-learning-models-1-2-1802d56addf9&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "http://datascienceninja.com/2019/07/10/how-to-interpret-machine-learning-models/", "anchor_text": "blog"}, {"url": "https://unsplash.com/@alexbertha?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Alex Bertha"}, {"url": "https://unsplash.com/search/photos/ariel-view?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://www.kaggle.com/uciml/default-of-credit-card-clients-dataset", "anchor_text": "Kaggle"}, {"url": "https://www.kdd.org/kdd2016/papers/files/rfp0573-ribeiroA.pdf", "anchor_text": "https://www.kdd.org/kdd2016/papers/files/rfp0573-ribeiroA.pdf"}, {"url": "https://github.com/marcotcr/lime", "anchor_text": "https://github.com/marcotcr/lime"}, {"url": "https://christophm.github.io/interpretable-ml-book/lime.html", "anchor_text": "https://christophm.github.io/interpretable-ml-book/lime.html"}, {"url": "http://datascienceninja.com/", "anchor_text": "http://datascienceninja.com/"}, {"url": "http://datascienceninja.com/2019/07/10/lime-explaining-predictions-of-machine-learning-models-1-2/", "anchor_text": "here"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----1802d56addf9---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----1802d56addf9---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/xai?source=post_page-----1802d56addf9---------------xai-----------------", "anchor_text": "Xai"}, {"url": "https://medium.com/tag/model-interpretation?source=post_page-----1802d56addf9---------------model_interpretation-----------------", "anchor_text": "Model Interpretation"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F1802d56addf9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flime-explaining-predictions-of-machine-learning-models-1-2-1802d56addf9&user=Sharayu+Rane&userId=8da9315e57a8&source=-----1802d56addf9---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F1802d56addf9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flime-explaining-predictions-of-machine-learning-models-1-2-1802d56addf9&user=Sharayu+Rane&userId=8da9315e57a8&source=-----1802d56addf9---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F1802d56addf9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flime-explaining-predictions-of-machine-learning-models-1-2-1802d56addf9&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----1802d56addf9--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F1802d56addf9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flime-explaining-predictions-of-machine-learning-models-1-2-1802d56addf9&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----1802d56addf9---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----1802d56addf9--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----1802d56addf9--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----1802d56addf9--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----1802d56addf9--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----1802d56addf9--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----1802d56addf9--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----1802d56addf9--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----1802d56addf9--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@ranesharayu?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@ranesharayu?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Sharayu Rane"}, {"url": "https://medium.com/@ranesharayu/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "119 Followers"}, {"url": "http://www.datascienceninja.com", "anchor_text": "www.datascienceninja.com"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F8da9315e57a8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flime-explaining-predictions-of-machine-learning-models-1-2-1802d56addf9&user=Sharayu+Rane&userId=8da9315e57a8&source=post_page-8da9315e57a8--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F89c17fa5670b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flime-explaining-predictions-of-machine-learning-models-1-2-1802d56addf9&newsletterV3=8da9315e57a8&newsletterV3Id=89c17fa5670b&user=Sharayu+Rane&userId=8da9315e57a8&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}