{"url": "https://towardsdatascience.com/ml-infrastructure-tools-for-production-part-2-model-deployment-and-serving-fcfc75c4a362", "time": 1683014008.52393, "path": "towardsdatascience.com/ml-infrastructure-tools-for-production-part-2-model-deployment-and-serving-fcfc75c4a362/", "webpage": {"metadata": {"title": "ML Infrastructure Tools for Production | by Aparna Dhinakaran | Towards Data Science", "h1": "ML Infrastructure Tools for Production", "description": "Businesses in almost every industry are adopting Machine Learning (ML) technology. Businesses look towards ML Infrastructure platforms to help them best leverage artificial intelligence (AI)\u2026"}, "outgoing_paragraph_urls": [{"url": "https://arize.com/blog/feature-store/", "anchor_text": "feature store system", "paragraph_index": 32}, {"url": "https://arize.com/platform-overview/", "anchor_text": "Machine Learning Observability", "paragraph_index": 43}, {"url": "https://arize.com/model-monitoring/", "anchor_text": "Model Monitoring", "paragraph_index": 43}, {"url": "https://arize.com/blog/", "anchor_text": "blogs", "paragraph_index": 43}, {"url": "https://arize.com/ml-monitoring/", "anchor_text": "ML Monitoring", "paragraph_index": 43}, {"url": "https://arize.com/contact/", "anchor_text": "reach out", "paragraph_index": 43}, {"url": "https://arize.com/careers/", "anchor_text": "here", "paragraph_index": 43}], "all_paragraphs": ["Businesses in almost every industry are adopting Machine Learning (ML) technology. Businesses look towards ML Infrastructure platforms to help them best leverage artificial intelligence (AI).", "Understanding the various platforms and offerings can be a challenge. The ML Infrastructure space is crowded, confusing, and complex. There are a number of platforms and tools, which each have a variety of functions across the model building workflow.", "To understand the ML infrastructure ecosystem, we can broadly segment the machine learning workflow into three stages \u2014 data preparation, model building, and production. Data preparation refers to the processing and augmentation of data for use by models, while model building refers to a model built based on the data, and production integrates model predictions into the business.", "Understanding the goals and challenges of each stage of the workflow can help you make the most informed decision on what ML Infrastructure platforms out there are best suited for your business\u2019 needs.", "Each of these stages of the Machine Learning workflow (Data Preparation, Model Building, and Production) have a number of vertical functions. Some platforms cover all three functions across the ML workflow, while other platforms focus on single functions (for example, experiment tracking or hyperparameter tuning).", "In our previous posts, we examined the Data Preparation and Model Building parts of the ML workflow. We began diving into Production ML and discussed model validation at length. In this post, we will dive deeper into Production and focus on model deployment and serving.", "Once the model has been trained, built, and validated, it is finally time to deploy and serve the model! In this last step of ML, all of the work of the previous steps are finally put to use by a data-driven model.", "The first decision that teams need to make is whether they should even build a model server at all. Most models deployed in the last five years were home-built serving approaches. In recent years, however, companies working with ML models have moved away from building everything from scratch. In fact, we predict that the approach of building everything from scratch will change drastically going forward, given the number of model servers coming to market.", "Model serving options for models typically fit into a couple different types:", "Which of these is the right choice for a given team? There are a number of considerations in the decision of model serving options. Here are a few questions teams ask themselves to determine which is the best ML option for them:", "On-premise ML solutions may be required for organizations with strict data security requirements. Some good choices are Algorithmia, Seldon, Tensorflow, Kubeflow, or home- built proprietary solutions. Some providers such as Algorithmia have security specific feature sets detailed below. Cloud solutions may be a better choice for those organizations needing less security but more remote access/virtualization.", "2. Does the team want managed or unmanaged solutions for model serving?", "A managed solution such as Algorithmia, SageMaker, Google ML, Azure, and Paperspace are a good idea for companies with a low IT presence. An un-managed solution such as Kubeflow, Seldon, Tensorflow Serving, or Anyscale may be better for more technical organizations.", "3. Is every team in the organization going to use the same deployment option?", "Even if one team chooses a serving option, rarely is the whole organization using the same serving approach. Having common model management platform like ML-Flow can still help bridge the gap.", "4. What does the final model look like? Is there an already established interface?", "If a model is already deployed, it might not make sense to rip out the model serving system and replace it with a new model server. How easy it would be to replace the already-deployed model might depend on the model server that was chosen and its integrations with other systems, APIs, and Feature Pipelines.", "5. Where does the model executable live? (for example, ML Flow or S3 Bucket)", "Easy integration to ML-Flow or model storage systems is an important consideration.", "Predictions using GPU servers based on performance requirements will likely drive you to either cloud providers or Algorithmia for on-premises.", "7. Are there separate feature generation pipelines or are they integrated into the model server?", "Depending on where your feature pipelines are deployed, say, Amazon Web Services (AWS), that might direct you toward using SageMaker. This is probably one of more common reasons to use SageMaker as data is already deployed in AWS.", "The format of the model can vary, based on the frameworks used to build the model, across organizations and projects. Some example formats include a pickle image of weights/parameters for the classifier, a Tensorflow SavedModel object, a Pytorch model, Keras model, XGBoost model, Apache TVM, MXNet, ONNX Runtime, etc.", "There are many ways that ML models can be implemented. These models can be integrated into a larger system\u2019s codebase, deployed as a microservice, or even live on a device. If the model is code that is integrated into a larger system, the interface into the model is simply a function call. If the model is in its own service/executable or server, it can be seen as a service. These services have well defined APIs or interfaces to pass inputs to the models and get responses.The model servers described above take the trained model artifact generated in the above formats and allow you to deploy it to a containerized model server that generates well defined APIs.", "A modern server approach is to containerize the model executable so there is a common interface into models and a common way of standing them up. The model is pulled from the model management system (such as ML-Flow) into a container when it is deployed. There are many ways to accomplish this, either building a custom container for your company, using open source solutions like KubeFlow or Seldon AI, or using the common cloud provider tools such as Algorithmia, SageMaker, Azure or Google AI.", "Another important deployment consideration to make is whether to have a real-time/online model or a batch model. Online models are used when predictions need to be immediate and take in real-time application input. If this isn\u2019t a requirement, batch inferences can be appropriate.", "A number of serving platforms allow you to build a single model and have different deployment options (Batch or Real Time) to support both types of serving regimes.", "As the prediction volume grows of an application, the initial approach of having a single server supporting predictions can get easily overwhelmed. The ability to simply add servers to a prediction service, without the need to re-architect or generate a large amount of additional model operations work, is one of the more useful features of a model server.", "A canary A/B framework allows developers to roll out software to a small subset of users to perform A/B testing to figure out which aspects of the software are most useful and provide the best functionality for users. Once deployed, some teams run a A/B (canary) model side-by-side with the production model, initially predicting on only a small subset of traffic for the new model. This is done as a simple test before deploying the new model across the full volume of predictions. A lot of teams we talk to have home-built their own A/B testing framework. That said, some of the model server solutions also support easy A/B deployments out of the box, for example, to choose the % of traffic to the B model with the click of a button.", "The ability to co-locate multiple models in the same server or easily connect the prediction (inference) flow between models might be an important consideration. Most of the time, the model response will be consumed by the end application, but as systems get more complex, some models\u2019 outputs are inputs to another model. In cases of fast prediction response, co-locating models can be desired.", "As you deploy a new model into production, you might find that performance drops drastically. The ability to have a different model, maybe a previous version or a very simple model during periods of degraded performance, can be very helpful in situations like this.", "If security is extremely important to the organization, some platforms have very well thought out security feature sets. These span a set of security requirements focused on: access rights, application security, network security, and memory security. The model in production needs to grab data/inputs from somewhere in the system, and it needs to generate predictions/outputs used by other systems. The application who has access to the predictions might not have rights to the input data. Also, if the application is using Python packages in a Kubernetes-hosted model, many companies want to make certain that those packages are not public packages. Lastly, if you are running in a shared memory environment like a GPU, you will need to take stock of what data protections you have in place around memory encryption and access. Some platforms, such as Algorithmia, have more developed security feature sets that provide solutions for a myriad of situations.", "In containerized solutions, input-to-feature transformations may reside in the container itself, or may have separate feature transformation pipelines. The larger the infrastructure, the more likely the input-to-feature transformation is a pipeline or feature store system with inputs to the container being pre-processed.", "In the serving layer, there are also some new platforms such as Tecton AI which are focused on feature serving. A global feature store allows teams to easily deploy the feature pipeline directly into production environments \u2014 minimizing feature pipeline mistakes, and allowing teams to take advantage of cross-company feature builds.", "Some model servers support basic monitoring solutions. Some servers support monitoring for serving infrastructure, memory usage, and other operational aspects. Our view is that this type of raw model ops monitoring and visualization is important to model scale out, but is not observability. We are obviously biased, but have an opinion that true model observability is really a separate platform.", "Example ML Infrastructure Platforms for Deployment and Serving include Datarobot, H2O.ai, Sagemaker, Azure, Google Kubeflow, and Tecton AI.", "It may seem like anyone can do monitoring \u2014 green lights are good, and red lights are bad. You can set alerts, and if a value falls below a certain level, this triggers sending an email to the staff.", "Yet, if that were the case, Amazon Cloud Watch would have killed Datadog.", "The issue here is \u2014 what do you do when you get that alert?", "Our opinion is that the difference between a monitoring solution and an Observability platform is the ability to troubleshoot and bottom out issues seamlessly. In the ML ecosystem, these problems surface as issues linking AI research to engineering. Is the platform designed from the bottom up to troubleshoot problems, or was an alerting system tacked on to some pre-existing graphs? Troubleshooting models + data in the real world is a large and complex space. That\u2019s why Observability platforms are designed from the ground up to help research and engineering teams jointly tackle these problems.", "The model server does not have the right data points to link the complex layers needed to analyze models. The model server is missing essential data such as training data, test runs, pre-one hot encoded feature data, truth/label events, and much more. In the case of feature data, for a number of larger models we have worked on, the insertion point into the data pipeline for troubleshooting is a very different technology than the model server. Lastly, many organizations have as many model serving approaches as they have models in production, and it is very unlikely they will move to a single server to rule them all. What happens when you have a mix of models served that feed each other data but you want a cohesive picture?", "It\u2019s the same in software infrastructure; your infrastructure observability solutions are not tied to the infrastructure itself.", "We hope you enjoyed the ML Infrastructure series! Up next, we will be diving deeper into Production AI. There are so many under-discussed and extremely important topics on operationalizing AI that we will be diving into!", "If this blog caught your attention and you\u2019re eager to learn more about Machine Learning Observability and Model Monitoring, check out our other blogs and resources on ML Monitoring! Feel free to reach out to us with any questions or comments, and find our open positions here if you\u2019re interested in joining a fun, rockstar engineering crew to help make models successful in production!", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Co-Founder and CPO of Arize AI. Formerly Computer Vision PhD at Cornell, Uber Machine Learning, UC Berkeley AI Research."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Ffcfc75c4a362&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fml-infrastructure-tools-for-production-part-2-model-deployment-and-serving-fcfc75c4a362&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fml-infrastructure-tools-for-production-part-2-model-deployment-and-serving-fcfc75c4a362&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fml-infrastructure-tools-for-production-part-2-model-deployment-and-serving-fcfc75c4a362&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fml-infrastructure-tools-for-production-part-2-model-deployment-and-serving-fcfc75c4a362&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----fcfc75c4a362--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----fcfc75c4a362--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://aparnadhinak.medium.com/?source=post_page-----fcfc75c4a362--------------------------------", "anchor_text": ""}, {"url": "https://aparnadhinak.medium.com/?source=post_page-----fcfc75c4a362--------------------------------", "anchor_text": "Aparna Dhinakaran"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Ff32f85889f3a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fml-infrastructure-tools-for-production-part-2-model-deployment-and-serving-fcfc75c4a362&user=Aparna+Dhinakaran&userId=f32f85889f3a&source=post_page-f32f85889f3a----fcfc75c4a362---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ffcfc75c4a362&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fml-infrastructure-tools-for-production-part-2-model-deployment-and-serving-fcfc75c4a362&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ffcfc75c4a362&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fml-infrastructure-tools-for-production-part-2-model-deployment-and-serving-fcfc75c4a362&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://arize.com/blog/feature-store/", "anchor_text": "feature store system"}, {"url": "https://arize.com/platform-overview/", "anchor_text": "Machine Learning Observability"}, {"url": "https://arize.com/model-monitoring/", "anchor_text": "Model Monitoring"}, {"url": "https://arize.com/blog/", "anchor_text": "blogs"}, {"url": "https://arize.com/ml-monitoring/", "anchor_text": "ML Monitoring"}, {"url": "https://arize.com/contact/", "anchor_text": "reach out"}, {"url": "https://arize.com/careers/", "anchor_text": "here"}, {"url": "https://medium.com/tag/data-science?source=post_page-----fcfc75c4a362---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----fcfc75c4a362---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----fcfc75c4a362---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/mlops?source=post_page-----fcfc75c4a362---------------mlops-----------------", "anchor_text": "Mlops"}, {"url": "https://medium.com/tag/arizer?source=post_page-----fcfc75c4a362---------------arizer-----------------", "anchor_text": "Arizer"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Ffcfc75c4a362&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fml-infrastructure-tools-for-production-part-2-model-deployment-and-serving-fcfc75c4a362&user=Aparna+Dhinakaran&userId=f32f85889f3a&source=-----fcfc75c4a362---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Ffcfc75c4a362&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fml-infrastructure-tools-for-production-part-2-model-deployment-and-serving-fcfc75c4a362&user=Aparna+Dhinakaran&userId=f32f85889f3a&source=-----fcfc75c4a362---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ffcfc75c4a362&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fml-infrastructure-tools-for-production-part-2-model-deployment-and-serving-fcfc75c4a362&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----fcfc75c4a362--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Ffcfc75c4a362&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fml-infrastructure-tools-for-production-part-2-model-deployment-and-serving-fcfc75c4a362&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----fcfc75c4a362---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----fcfc75c4a362--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----fcfc75c4a362--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----fcfc75c4a362--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----fcfc75c4a362--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----fcfc75c4a362--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----fcfc75c4a362--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----fcfc75c4a362--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----fcfc75c4a362--------------------------------", "anchor_text": ""}, {"url": "https://aparnadhinak.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://aparnadhinak.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Aparna Dhinakaran"}, {"url": "https://aparnadhinak.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "1.8K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Ff32f85889f3a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fml-infrastructure-tools-for-production-part-2-model-deployment-and-serving-fcfc75c4a362&user=Aparna+Dhinakaran&userId=f32f85889f3a&source=post_page-f32f85889f3a--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F29a5b20a3556&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fml-infrastructure-tools-for-production-part-2-model-deployment-and-serving-fcfc75c4a362&newsletterV3=f32f85889f3a&newsletterV3Id=29a5b20a3556&user=Aparna+Dhinakaran&userId=f32f85889f3a&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}