{"url": "https://towardsdatascience.com/predicting-apple-stock-in-times-of-coronavirus-ca434bd2f788", "time": 1683005322.552644, "path": "towardsdatascience.com/predicting-apple-stock-in-times-of-coronavirus-ca434bd2f788/", "webpage": {"metadata": {"title": "Predicting Apple Stock in times of COVID-19 | by Federico Riveroll | Towards Data Science", "h1": "Predicting Apple Stock in times of COVID-19", "description": "On February 13th I posted an article about \u201cOutstanding Results Predicting Apple Stock through time using Continual ML\u201d. It was suggested to try it in a \u201cdisfavorable\u201d scenario, so I re-run an\u2026"}, "outgoing_paragraph_urls": [{"url": "https://towardsdatascience.com/making-a-continual-ml-pipeline-to-predict-apple-stock-with-global-news-python-90e5d6610b21", "anchor_text": "Outstanding Results Predicting Apple Stock through time using Continual ML", "paragraph_index": 0}, {"url": "https://www.openblender.io/#/dataset/explore/5d4c39d09516290b01c8307b/or/38", "anchor_text": "Apple Stock dataset", "paragraph_index": 14}, {"url": "https://www.openblender.io/#/dataset/explore/5d4c39d09516290b01c8307b/or/38", "anchor_text": "openblender.io", "paragraph_index": 18}, {"url": "https://www.openblender.io/#/dataset/explore/5e2ef74e9516294390e810a9/or/38", "anchor_text": "Wall Street Journal News", "paragraph_index": 20}, {"url": "https://www.openblender.io/#/dataset/explore/5e32fd289516291e346c1726/or/38", "anchor_text": "USA Today", "paragraph_index": 21}], "all_paragraphs": ["On February 13th I posted an article about \u201cOutstanding Results Predicting Apple Stock through time using Continual ML\u201d.", "It was suggested to try it in a \u201cdisfavorable\u201d scenario, so I re-run an improved the exercise including the last few weeks to see how it performed during these harsh times.", "*Disclaimer: There are costs such as trading and shorting commissions that are not taken into account in this exercise. The writer doesn\u2019t share the risk or benefit to be taken using this article.", "The Apple price has been increasing in time, but it has also fallen, like in recent weeks.", "What we want is to detect if the price is going to increase or decrease on the next day so we can buy or short on the previous day.", "We also want the change to be higher than 0.5% so that it is worth the trade.", "The above is the change through time, the green dots are the days the price went up higher than 0.5% and the red dots the inverse.", "Positive POC: \u2018change\u2019 increased more than 0.5%", "Negative POC: \u2018change\u2019 decreased more than 0.5%", "On the last article an ML model was created to predict, using News, the uprise of the next day with the following performance:", "This means that from all the observations this model predicted that the following day the price would increase 0.5% or more (82 times), it was correct 72% of the times (62 times).", "This ratio (which is the precision: TP / TP&FP) is an important metric because for this experiment we will \u2018invest\u2019 every time the prediction is \u2018will rise\u2019 (or short when it predicts drop), so we prioritize being right more often than not, even if we lose some opportunities.", "Now let\u2019s now make a model to predict both uprise and decline in times of \u2018bullish market\u2019 as well as \u2018bearish\u2019.", "Note: This step replicates what was done on the first article, so if you already did it you can skip through it.", "Let\u2019s pull from this daily Apple Stock dataset", "It has the percentual change during that day.", "So let\u2019s pull the data through the OpenBlender API.", "On Python run the following code:", "Note: To get a token you need to create an account on openblender.io (free), you\u2019ll find it in the \u2018Account\u2019 tab on your profile icon.", "To blend business news we need:", "So let\u2019s look at this Wall Street Journal News dataset:", "And the USA Today Twitter news.", "Now let\u2019s create a text vectorizer, which is a model on OpenBlender that enables to pull tokens (vectorized texts) as features as if it were another dataset:", "From above, we specified the following:", "Now, if we go to our dashboard at OpenBlender, we can see the vectorizer:", "It generated 4999 n-grams which are binary features of tokens of max 2 words which are \u201c1\u201d if the n-gram was mentioned and \u201c0\u201d if else.", "Now we want the vectorized data compressed in 24 hour time lags and aligned with the Apple stock price from the next day.", "You need to add your vectorizer\u2019s id (it was returned by the API or you can get it in OpenBlender.", "*Note: To download all the vectorized data you\u2019ll need to pay about $6 USD upgrading to \u2018Pay as you go\u2019 in OpenBlender. You can still continue with a smaller part of the data reducing the date interval.", "This is the same service call as before but with some new parameters:", "Let\u2019s take a look at the top of the data:", "We have 1122 observations and 4908 features. Most of them are n-grams from the vectorizer, and we also have our original Apple Stock dataset.", "The \u2018lag-1_change\u2019 simply aligns \u2018change\u2019 values with the \u201cprevious day data\u201d which is exactly what we need. The last observation is NaN because that\u2019s what will happen \u2018tomorrow\u2019.", "Now let\u2019s create our target features as defined previously:", "We want 2 models, one that will predict if the price will rise (higher than 0.5%), and one that will predict the equivalent drop and then combine both into the trading strategy.", "Also, we want to train and test through time so that the models learn with relevant information.", "Finally, we want to simulate if we started out with $1,000 USD, what we would end up with.", "This next function will return, given a dataframe and a target, the results of applying ML and a dataframe with predictions vs. results.", "We want to iterate in time learning with 300 observations and predicting on the following 50, jumping days by 50 so we retrain on every jump.", "While we do this, we want to gather recommendations from both our models (negative / positive).", "Let\u2019s take a look at the result.", "real_values = the real % change on the price", "F_p = Prediction in the range (0,1) for rise", "F_n = Prediction in the range (0,1) for drop", "Our combinated model will be simple, if one model recommends and the other one doesn\u2019t oppose, we buy/short:", "Let\u2019s first run the model only with the \u201cpositive\u201d prediction.", "It absolutely plummets and loses almost half it\u2019s gain through the years with the current COVID/oil/recession situation.", "Let\u2019s now try it using only the negative prediction.", "So, it performs worse than the positive overall, but it really performs well now on covid times.", "This is by far the best performing model , ending the 3-year period with a return of 574.4% , but still very volatile these days.", "To this point, it lost almost 25% since the end of Jan 20, whereas the Apple price only plummeted 20%.", "What needs to be done is priorize the positive or negative recommendations depending on the situation.", "In a couple of days I\u2019ll publish a follow-up article with results for a model that switches between positive/negative recommendations depending on how long it\u2019s been increasing or decreasing to maximize return.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "An attempt to separate signal from noise. | MSDS"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fca434bd2f788&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-apple-stock-in-times-of-coronavirus-ca434bd2f788&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-apple-stock-in-times-of-coronavirus-ca434bd2f788&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-apple-stock-in-times-of-coronavirus-ca434bd2f788&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-apple-stock-in-times-of-coronavirus-ca434bd2f788&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----ca434bd2f788--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----ca434bd2f788--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://federicoriveroll.medium.com/?source=post_page-----ca434bd2f788--------------------------------", "anchor_text": ""}, {"url": "https://federicoriveroll.medium.com/?source=post_page-----ca434bd2f788--------------------------------", "anchor_text": "Federico Riveroll"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fb6be3377832b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-apple-stock-in-times-of-coronavirus-ca434bd2f788&user=Federico+Riveroll&userId=b6be3377832b&source=post_page-b6be3377832b----ca434bd2f788---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fca434bd2f788&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-apple-stock-in-times-of-coronavirus-ca434bd2f788&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fca434bd2f788&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-apple-stock-in-times-of-coronavirus-ca434bd2f788&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://towardsdatascience.com/making-a-continual-ml-pipeline-to-predict-apple-stock-with-global-news-python-90e5d6610b21", "anchor_text": "Outstanding Results Predicting Apple Stock through time using Continual ML"}, {"url": "https://www.openblender.io/#/dataset/explore/5d4c39d09516290b01c8307b/or/38", "anchor_text": "Apple Stock dataset"}, {"url": "https://www.openblender.io/#/dataset/explore/5d4c39d09516290b01c8307b/or/38", "anchor_text": "openblender.io"}, {"url": "https://www.openblender.io/#/dataset/explore/5e2ef74e9516294390e810a9/or/38", "anchor_text": "Wall Street Journal News"}, {"url": "https://www.openblender.io/#/dataset/explore/5e32fd289516291e346c1726/or/38", "anchor_text": "USA Today"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----ca434bd2f788---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/health?source=post_page-----ca434bd2f788---------------health-----------------", "anchor_text": "Health"}, {"url": "https://medium.com/tag/nlp?source=post_page-----ca434bd2f788---------------nlp-----------------", "anchor_text": "NLP"}, {"url": "https://medium.com/tag/ai?source=post_page-----ca434bd2f788---------------ai-----------------", "anchor_text": "AI"}, {"url": "https://medium.com/tag/python?source=post_page-----ca434bd2f788---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fca434bd2f788&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-apple-stock-in-times-of-coronavirus-ca434bd2f788&user=Federico+Riveroll&userId=b6be3377832b&source=-----ca434bd2f788---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fca434bd2f788&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-apple-stock-in-times-of-coronavirus-ca434bd2f788&user=Federico+Riveroll&userId=b6be3377832b&source=-----ca434bd2f788---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fca434bd2f788&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-apple-stock-in-times-of-coronavirus-ca434bd2f788&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----ca434bd2f788--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fca434bd2f788&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-apple-stock-in-times-of-coronavirus-ca434bd2f788&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----ca434bd2f788---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----ca434bd2f788--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----ca434bd2f788--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----ca434bd2f788--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----ca434bd2f788--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----ca434bd2f788--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----ca434bd2f788--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----ca434bd2f788--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----ca434bd2f788--------------------------------", "anchor_text": ""}, {"url": "https://federicoriveroll.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://federicoriveroll.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Federico Riveroll"}, {"url": "https://federicoriveroll.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "1.1K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fb6be3377832b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-apple-stock-in-times-of-coronavirus-ca434bd2f788&user=Federico+Riveroll&userId=b6be3377832b&source=post_page-b6be3377832b--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fb9c3878e20f9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-apple-stock-in-times-of-coronavirus-ca434bd2f788&newsletterV3=b6be3377832b&newsletterV3Id=b9c3878e20f9&user=Federico+Riveroll&userId=b6be3377832b&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}