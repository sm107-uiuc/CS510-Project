{"url": "https://towardsdatascience.com/churn-prediction-770d6cb582a5", "time": 1682994788.560975, "path": "towardsdatascience.com/churn-prediction-770d6cb582a5/", "webpage": {"metadata": {"title": "Churn prediction. Learn how to train a decision tree\u2026 | by Roman Orac | Towards Data Science", "h1": "Churn prediction", "description": "Customer churn, also known as customer attrition, occurs when customers stop doing business with a company. The companies are interested in identifying segments of these customers because the price\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.kaggle.com/blastchar/telco-customer-churn", "anchor_text": "Telco Customer Churn dataset", "paragraph_index": 1}, {"url": "https://pandas.pydata.org/", "anchor_text": "pandas", "paragraph_index": 1}, {"url": "https://matplotlib.org/", "anchor_text": "matplotlib", "paragraph_index": 1}, {"url": "https://romanorac.github.io/assets/notebooks/2019-01-25-churn-prediction.ipynb", "anchor_text": "Jupyter notebook", "paragraph_index": 2}, {"url": "https://www.purplemath.com/modules/boxwhisk3.htm", "anchor_text": "interquartile range (IQR)", "paragraph_index": 10}, {"url": "https://imbalanced-learn.readthedocs.io/en/stable/", "anchor_text": "imbalanced-learn", "paragraph_index": 16}, {"url": "https://machinelearningmastery.com/why-one-hot-encode-data-in-machine-learning/", "anchor_text": "onehot encoding", "paragraph_index": 19}, {"url": "https://twitter.com/romanorac", "anchor_text": "Twitter", "paragraph_index": 29}, {"url": "https://twitter.com/romanorac/status/1328952374447267843", "anchor_text": "tweet", "paragraph_index": 29}], "all_paragraphs": ["Customer churn, also known as customer attrition, occurs when customers stop doing business with a company. The companies are interested in identifying segments of these customers because the price for acquiring a new customer is usually higher than retaining the old one. For example, if Netflix knew a segment of customers who were at risk of churning they could proactively engage them with special offers instead of simply losing them.", "In this post, we will create a simple customer churn prediction model using Telco Customer Churn dataset. We chose a decision tree to model churned customers, pandas for data crunching and matplotlib for visualizations. We will do all of that above in Python.The code can be used with another dataset with a few minor adjustments to train the baseline model. We also provide a few references and give ideas for new features and improvements.", "You can run this code by downloading this Jupyter notebook.", "Here are few links that might interest you:", "Would you like to read more such articles? If so, you can support me by clicking on any links above. Some of them are affiliate links, but you don\u2019t need to buy anything.", "We use pandas to read the dataset and preprocess it. Telco dataset has one customer per line with many columns (features). There aren\u2019t any rows with all missing values or duplicates (this rarely happens with real-world datasets). There are 11 samples that have TotalCharges set to \u201c \u201c, which seems like a mistake in the data. We remove those samples and set the type to numeric (float).", "We have 2 types of features in the dataset: categorical (two or more values and without any order) and numerical. Most of the feature names are self-explanatory, except for:", "There are 7032 customers in the dataset and 19 features without customerID (non-informative) and Churn column (target variable). Most of the categorical features have 4 or less unique values.", "We combine features into two lists so that we can analyze them jointly.", "Numeric summarizing techniques (mean, standard deviation, etc.) don\u2019t show us spikes, shapes of distributions and it is hard to observe outliers with it. That is the reason we use histograms.", "At first glance, there aren\u2019t any outliers in the data. No data point is disconnected from distribution or too far from the mean value. To confirm that we would need to calculate interquartile range (IQR) and show that values of each numerical feature are within the 1.5 IQR from first and third quartile.", "We could convert numerical features to ordinal intervals. For example, tenure is numerical, but often we don\u2019t care about small numeric differences and instead group tenure to customers with short, medium and long term tenure. One reason to convert it would be to reduce the noise, often small fluctuates are just noise.", "We look at distributions of numerical features in relation to the target variable. We can observe that the greater TotalCharges and tenure are the less is the probability of churn.", "To analyze categorical features, we use bar charts. We observe that Senior citizens and customers without phone service are less represented in the data.", "The next step is to look at categorical features in relation to the target variable. We do this only for contract feature. Users who have a month-to-month contract are more likely to churn than users with long term contracts.", "Target variable distribution shows that we are dealing with an imbalanced problem as there are many more non-churned as churned users. The model would achieve high accuracy as it would mostly predict majority class \u2014 users who didn\u2019t churn in our example.", "Few things we can do to minimize the influence of imbalanced dataset:- resample data (imbalanced-learn),- collect more samples,- use precision and recall as accuracy metrics.", "Telco dataset is already grouped by customerID so it is difficult to add new features. When working on the churn prediction we usually get a dataset that has one entry per customer session (customer activity in a certain time). Then we could add features like:", "Sometimes we even have customer event data, which enables us to find patterns of customer behavior in relation to the outcome (churn).", "To prepare the dataset for modeling churn, we need to encode categorical features to numbers. This means encoding \u201cYes\u201d, \u201cNo\u201d to 0 and 1 so that algorithm can work with the data. This process is called onehot encoding.", "We use sklearn, a Machine Learning library in Python, to create a classifier.The sklearn way is to use pipelines that define feature processing and the classifier. In our example, the pipeline takes a dataset in the input, it preprocesses features and trains the classifier.When trained, it takes the same input and returns predictions in the output.", "In the pipeline, we separately process categorical and numerical features. We onehot encode categorical features and scale numerical features by removing the mean and scaling them to unit variance.We chose a decision tree model because of its interpretability and set max depth to 3 (arbitrarily).", "We split the dataset to train (75% samples) and test (25% samples). We train (fit) the pipeline and make predictions. With classification_report we calculate precision and recall with actual and predicted values.", "With classification_report we calculate precision and recall with actual and predicted values.", "For class 1 (churned users) model achieves 0.67 precision and 0.37 recall. Precision tells us how many churned users did our classifier predicted correctly. On the other side, recall tell us how many churned users it missed.", "In layman terms, the classifier is not very accurate for churned users.", "Decision Tree model uses Contract, MonthlyCharges, InternetService, TotalCharges, and tenure features to make a decision if a customer will churn or not. These features separate churned customers from others well based on the split criteria in the decision tree.", "Each customer sample traverses the tree and final node gives the prediction. For example, if Contract_Month-to-month is:", "This is a great approach to see how the model is making a decision or if any features sneaked in our model that shouldn\u2019t be there.", "Follow me on Twitter, where I regularly tweet about Data Science and Machine Learning.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F770d6cb582a5&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fchurn-prediction-770d6cb582a5&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fchurn-prediction-770d6cb582a5&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fchurn-prediction-770d6cb582a5&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fchurn-prediction-770d6cb582a5&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----770d6cb582a5--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----770d6cb582a5--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://romanorac.medium.com/?source=post_page-----770d6cb582a5--------------------------------", "anchor_text": ""}, {"url": "https://romanorac.medium.com/?source=post_page-----770d6cb582a5--------------------------------", "anchor_text": "Roman Orac"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F68bf0657a0cd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fchurn-prediction-770d6cb582a5&user=Roman+Orac&userId=68bf0657a0cd&source=post_page-68bf0657a0cd----770d6cb582a5---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F770d6cb582a5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fchurn-prediction-770d6cb582a5&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F770d6cb582a5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fchurn-prediction-770d6cb582a5&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/photos/_g1WdcKcV3w?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Mantas Hesthaven"}, {"url": "https://unsplash.com/search/photos/leaving?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://www.kaggle.com/blastchar/telco-customer-churn", "anchor_text": "Telco Customer Churn dataset"}, {"url": "https://pandas.pydata.org/", "anchor_text": "pandas"}, {"url": "https://matplotlib.org/", "anchor_text": "matplotlib"}, {"url": "https://romanorac.github.io/assets/notebooks/2019-01-25-churn-prediction.ipynb", "anchor_text": "Jupyter notebook"}, {"url": "https://trymito.io/", "anchor_text": "Complete your Python analyses 10x faster with Mito"}, {"url": "https://aigents.co/skills", "anchor_text": "Free skill tests for Data Scientists & ML Engineers"}, {"url": "https://imp.i115008.net/c/2402645/1116216/11298", "anchor_text": "All New Self-Driving Car Engineer Nanodegree"}, {"url": "https://www.purplemath.com/modules/boxwhisk3.htm", "anchor_text": "interquartile range (IQR)"}, {"url": "https://imbalanced-learn.readthedocs.io/en/stable/", "anchor_text": "imbalanced-learn"}, {"url": "https://machinelearningmastery.com/why-one-hot-encode-data-in-machine-learning/", "anchor_text": "onehot encoding"}, {"url": "https://www.sciencedirect.com/science/article/pii/S0957417408002121", "anchor_text": "Handling class imbalance in customer churn prediction"}, {"url": "https://www.researchgate.net/publication/310757545_A_Survey_on_Customer_Churn_Prediction_using_Machine_Learning_Techniques", "anchor_text": "A Survey on Customer Churn Prediction using Machine Learning Techniques"}, {"url": "https://www.kaggle.com/blastchar/telco-customer-churn", "anchor_text": "Telco customer churn on Kaggle"}, {"url": "https://ragulpr.github.io/2016/12/22/WTTE-RNN-Hackless-churn-modeling", "anchor_text": "WTTE-RNN-Hackless-churn-modeling"}, {"url": "https://twitter.com/romanorac", "anchor_text": "Twitter"}, {"url": "https://twitter.com/romanorac/status/1328952374447267843", "anchor_text": "tweet"}, {"url": "https://unsplash.com/@cmhedger?utm_source=medium&utm_medium=referral", "anchor_text": "Courtney Hedger"}, {"url": "https://unsplash.com/?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://medium.com/tag/data-science?source=post_page-----770d6cb582a5---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/churn?source=post_page-----770d6cb582a5---------------churn-----------------", "anchor_text": "Churn"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----770d6cb582a5---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/decision-tree?source=post_page-----770d6cb582a5---------------decision_tree-----------------", "anchor_text": "Decision Tree"}, {"url": "https://medium.com/tag/sklearn?source=post_page-----770d6cb582a5---------------sklearn-----------------", "anchor_text": "Sklearn"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F770d6cb582a5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fchurn-prediction-770d6cb582a5&user=Roman+Orac&userId=68bf0657a0cd&source=-----770d6cb582a5---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F770d6cb582a5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fchurn-prediction-770d6cb582a5&user=Roman+Orac&userId=68bf0657a0cd&source=-----770d6cb582a5---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F770d6cb582a5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fchurn-prediction-770d6cb582a5&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----770d6cb582a5--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F770d6cb582a5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fchurn-prediction-770d6cb582a5&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----770d6cb582a5---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----770d6cb582a5--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----770d6cb582a5--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----770d6cb582a5--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----770d6cb582a5--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----770d6cb582a5--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----770d6cb582a5--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----770d6cb582a5--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----770d6cb582a5--------------------------------", "anchor_text": ""}, {"url": "https://romanorac.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://romanorac.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Roman Orac"}, {"url": "https://romanorac.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "7.7K Followers"}, {"url": "https://romanorac.medium.com/membership", "anchor_text": "https://romanorac.medium.com/membership"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F68bf0657a0cd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fchurn-prediction-770d6cb582a5&user=Roman+Orac&userId=68bf0657a0cd&source=post_page-68bf0657a0cd--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fa69c18dd3c04&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fchurn-prediction-770d6cb582a5&newsletterV3=68bf0657a0cd&newsletterV3Id=a69c18dd3c04&user=Roman+Orac&userId=68bf0657a0cd&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}