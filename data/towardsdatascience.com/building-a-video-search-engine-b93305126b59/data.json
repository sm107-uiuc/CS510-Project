{"url": "https://towardsdatascience.com/building-a-video-search-engine-b93305126b59", "time": 1683002253.9787571, "path": "towardsdatascience.com/building-a-video-search-engine-b93305126b59/", "webpage": {"metadata": {"title": "Building a Video Search Engine using Computer Vision | Towards Data Science", "h1": "Building a Video Search Engine using Computer Vision", "description": "A natural progression in the field of computer vision following unprecedented progress in image classification tasks is towards video and video understanding, especially how it relates to identifying\u2026"}, "outgoing_paragraph_urls": [], "all_paragraphs": ["A natural progression in the field of computer vision following unprecedented progress in image classification tasks is towards video and video understanding, especially how it relates to identifying human subjects and activities. A number of datasets and benchmarks are being established in this area\u00b9.", "In parallel, further progress is being made in 2D image related computer vision tasks such as fine-grained classification, image segmentation, 3D image construction, robot vision, scene flow estimation and human pose estimation.", "As part of my final Data Science project at Metis bootcamp, I\u2019ve decided to marry these two parallel tracks \u2014 video and human pose estimation in specific \u2014 to create a content-based video search engine. Since applying 2D human pose estimation for video search is a novel idea with \u201cno proof of concept\u201d, I have simplified my approach by selecting a single performer, fixed location single camera video footage of Salsa dance videos.", "Users on YouTube, the second largest search engine after Google, watch over 1 billion hours of video every single day. Users on Facebook, the most popular social networking site in the world, watch about 100 million hours of video every single day!! These platforms are interested in providing tools to their users in searching and discovering interesting and relevant content.", "The tools these platforms provide for searching primarily use a video\u2019s metadata (location, time, content creator etc.), titles, descriptions, transcripts (either user created or machine generated from audio), user ratings, user comments etc. in retrieving \u2018similar\u2019 results. These search tools do not skim the actual content of the video itself. Video is not skimmable or indexable for searches.", "The visual features in the videos are too many and they are computationally expensive to index and too slow to retrieve. As a example, if one were to search for the steps of the Salsa dancer in exhibit 1, currently there are no tools available for the user on platforms like YoutTube. The salsa steps do not have textual context to perform a search.", "The video search engine I built as part of my Metis Project 5, has indexed about 70 minutes of Salsa dance videos from YouTube and will return a match as shown in the exhibit below. The Salsa steps performed by Yeifren (in the middle) and Adriano (on the right) are similar to Valentino\u2019s (on the left). In these clips, the performers walk back to the center of the stage and perform a number of turns as they face towards left of the stage.", "Upate One very subtle movement between Valentino (left) and the retrieved clip of Yiefren (center), is they both touch/hit their knees/legs!! The timing of it in the clips is off, but the model picks up on this!! I\u2019ve watched these clips for many days before I even noticed it! I think its a fascinating result.", "There are two steps in building the video search engine. First step is to download & process the video footage and run it through OpenPose for feature extraction. OpenPose is a human pose estimation algorithm developed by Carnegie Mellon University researchers (Zhe Cao et al). More on OpenPose is presented in the later sections. Second step is model building and testing query metrics. Models were built using matrix decomposition methods (PCA, LSA, NMF). Euclidean distance and cosine similarity were tested as query metrics. A feature engineering/feature representation exercise was also performed as part of this second step \u2014 flattened features and Hu moments of the features for each frame were tested.", "The best combination of \u201cfeature representation/dimensionality reduction/query metric\u201d obtained was by using plain flattened pose estimates with LSA and cosine similarity.", "The data for this project came from processing YouTube salsa videos (links below).", "Besides being a challenging dance form that involves subtle and quick movements, a number of channels on YouTube provides easy access to videos with solo dancers. The Zhe Cao et al\u2019s pose estimation used for feature extraction for my project is fast and accurate with multi-person video frames, but those algorithms do not track a person from frame to frame. This poses a problem when persons in a video switch places \u2014 read couples performing turns/lifts etc. To avoid this and simplify my problem, I\u2019ve selected solo dance videos.", "The other dance form that I have considered is ballet. However, the female dancers clothing (read tutus!) in ballet results in false positives as knees for certain dance poses that are common in ballet.", "Salsa dance footage I have collected is from the following four videos with total run time of 160 minutes. This footage is processed down to 70 minutes and formatted into 3 second clips. The processed video consists of about 58 performances by about 30 artists.", "To summarize, the videos used consists of:", "OpenPose: Realtime 2D Multi-person Pose Estimation Algorithm", "Human pose estimation is a computer vision problem of identifying anatomical \u201ckey points\u201d of people in images or videos. In the last few years, a number of researchers have made incredible progress and demonstrated real-time performance\u00b2 \u2074. Zhe Cao et al, from The Robotics Institute of Carnegie Mellon University have won inaugural COCO 2016 keypoint challenge using a \u201cbottom-up\u201d approach. They have achieved real-time speeds using GPU installed laptops.", "Pose estimates are used in classifying human activity in images/video clips. They are primarily applied to 2D images, but never been used for video search objective. Below is an example of how OpenPose identifies 18 keypoints on a person in 2D images (for simplicity only 14 keypoints are shown).", "When keypoints are identified for each frame in a video, the result will look as shown in exhibits 5 &6 below.", "A few results from indexing the salsa videos and performing a search using cosine-similarity are shown below. The top right video is the search clip, and the search results should be read from left to right, and then top to bottom.", "Note that the search engine indexing is sufficient and effective in retrieving video clips where the dancers are just walking to their spots (exhibit 7). This is an interesting result in itself, and demonstrates how this indexing method can be used for video editing. Manual editing of these clips will take hours even for \u201csmall\u201d unprocessed footage of 2.5 hours, while the search engine takes less than a second to run (post-indexing) and is capable of finding the timestamps of all such clips in the footage. This makes the video editing more automated and fast.", "A video search engine like this has a number of applications. A few are listed below:", "I have a few more ideas on how platforms like YouTube and Facebook can use video search on their current websites. A few conceptual ideas are shown below:", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fb93305126b59&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-a-video-search-engine-b93305126b59&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-a-video-search-engine-b93305126b59&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-a-video-search-engine-b93305126b59&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-a-video-search-engine-b93305126b59&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----b93305126b59--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----b93305126b59--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@bhanuyerra?source=post_page-----b93305126b59--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@bhanuyerra?source=post_page-----b93305126b59--------------------------------", "anchor_text": "Bhanu Yerra"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fede6d4d21ce3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-a-video-search-engine-b93305126b59&user=Bhanu+Yerra&userId=ede6d4d21ce3&source=post_page-ede6d4d21ce3----b93305126b59---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb93305126b59&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-a-video-search-engine-b93305126b59&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb93305126b59&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-a-video-search-engine-b93305126b59&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://artofdance.ca/wp-content/uploads/2015/06/flam_dance_slide1.jpg", "anchor_text": "Source"}, {"url": "https://www.youtube.com/watch?v=4nHElVbT3HY", "anchor_text": "https://www.youtube.com/watch?v=4nHElVbT3HY"}, {"url": "https://www.youtube.com/watch?v=ITNiqNcl6Mw", "anchor_text": "https://www.youtube.com/watch?v=ITNiqNcl6Mw"}, {"url": "https://www.youtube.com/watch?v=L5mqL7ADEsY", "anchor_text": "https://www.youtube.com/watch?v=L5mqL7ADEsY"}, {"url": "https://www.youtube.com/watch?v=M_rPhEjym1o", "anchor_text": "https://www.youtube.com/watch?v=M_rPhEjym1o"}, {"url": "https://arxiv.org/pdf/1609.08675.pdf", "anchor_text": "YouTube-8M: A Large-Scale Video Classification Benchmark"}, {"url": "https://arxiv.org/pdf/1611.08050.pdf", "anchor_text": "Realtime Multi-person 2D Pose Estimation using Part Affinity Fields (2017)"}, {"url": "https://github.com/ZheC/Realtime_Multi-Person_Pose_Estimation", "anchor_text": "Github to OpenPose"}, {"url": "https://heartbeat.fritz.ai/a-2019-guide-to-human-pose-estimation-c10b79b64b73", "anchor_text": "A 2019 Guide to Human Pose Estimation"}, {"url": "https://mlbhanuyerra.github.io/2019-12-09-Video-Search-Engine-Salsa/", "anchor_text": "https://mlbhanuyerra.github.io"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----b93305126b59---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/computer-vision?source=post_page-----b93305126b59---------------computer_vision-----------------", "anchor_text": "Computer Vision"}, {"url": "https://medium.com/tag/video-search?source=post_page-----b93305126b59---------------video_search-----------------", "anchor_text": "Video Search"}, {"url": "https://medium.com/tag/data-science?source=post_page-----b93305126b59---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/towards-data-science?source=post_page-----b93305126b59---------------towards_data_science-----------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fb93305126b59&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-a-video-search-engine-b93305126b59&user=Bhanu+Yerra&userId=ede6d4d21ce3&source=-----b93305126b59---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fb93305126b59&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-a-video-search-engine-b93305126b59&user=Bhanu+Yerra&userId=ede6d4d21ce3&source=-----b93305126b59---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb93305126b59&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-a-video-search-engine-b93305126b59&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----b93305126b59--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fb93305126b59&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-a-video-search-engine-b93305126b59&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----b93305126b59---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----b93305126b59--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----b93305126b59--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----b93305126b59--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----b93305126b59--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----b93305126b59--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----b93305126b59--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----b93305126b59--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----b93305126b59--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@bhanuyerra?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@bhanuyerra?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Bhanu Yerra"}, {"url": "https://medium.com/@bhanuyerra/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "64 Followers"}, {"url": "https://www.linkedin.com/in/bhanuyerra/", "anchor_text": "https://www.linkedin.com/in/bhanuyerra/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fede6d4d21ce3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-a-video-search-engine-b93305126b59&user=Bhanu+Yerra&userId=ede6d4d21ce3&source=post_page-ede6d4d21ce3--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fusers%2Fede6d4d21ce3%2Flazily-enable-writer-subscription&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-a-video-search-engine-b93305126b59&user=Bhanu+Yerra&userId=ede6d4d21ce3&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}