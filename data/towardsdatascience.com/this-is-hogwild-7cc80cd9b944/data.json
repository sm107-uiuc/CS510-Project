{"url": "https://towardsdatascience.com/this-is-hogwild-7cc80cd9b944", "time": 1683003523.986688, "path": "towardsdatascience.com/this-is-hogwild-7cc80cd9b944/", "webpage": {"metadata": {"title": "This is Hogwild!. Speeding up your Neural Network\u2026 | by Phillip Wenig | Towards Data Science", "h1": "This is Hogwild!", "description": "I am currently working on my Ph.D. in the field of distributed machine learning. I\u2019ve noticed that parallel processes aren\u2019t used very often in day-to-day machine learning. Thus, I want to give\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.technologyreview.com/s/613630/training-a-single-ai-model-can-emit-as-much-carbon-as-five-cars-in-their-lifetimes/", "anchor_text": "link to article", "paragraph_index": 1}, {"url": "https://pytorch.org/docs/stable/notes/multiprocessing.html", "anchor_text": "this link", "paragraph_index": 6}, {"url": "https://github.com/wenig/hogwild", "anchor_text": "GitHub repository", "paragraph_index": 12}], "all_paragraphs": ["I am currently working on my Ph.D. in the field of distributed machine learning. I\u2019ve noticed that parallel processes aren\u2019t used very often in day-to-day machine learning. Thus, I want to give insights into multiprocessing with PyTorch. In this blog post, you will learn about the Hogwild! algorithm, which is used to run stochastic gradient descent (SGD) in a parallel way. I won\u2019t go into detail as the listed papers cover all the necessary mathematics. Rather, I will explain the general idea and give a very simple example in PyTorch.", "If you\u2019ve ever trained a neural network by yourself on your machine, you\u2019ve probably noticed the time and computing power consumed while doing so. Especially, when using big data sets for computer vision or other high dimensional training data. A recent article by MIT has shown, that training an AI algorithm can produce a huge amount of carbon (link to article). This illustrates the necessary power needed for AI model training. Hence, parallel processes for reducing the overall training time should be used if it takes too long.", "One possible algorithm is Hogwild! which leverages parallel processes on computers to run SGD simultaneously and asynchronously. Asynchronicity is important for reducing unnecessary idle time in which no calculations are done but energy is still consumed.", "Using Hogwild!, each participating process in a parallel training session is responsible for one partition of the data, e.g. having 8 parallel processes would split the data set in 8 equal parts whereas each process is assigned to one part. Moreover, on shared memory or a separate server, an initial model is created which can be accessed by all processes.", "Once the training starts, each process loads the current state of the model from shared memory and starts reading the first batch of their data partition. As in standard SGD, each process is calculating the gradients for that batch. The gradients are now directly written to the shared model without blocking the other processes. Once written, the new model parameters are loaded and the next batch is used. Due to the missing blocking, the shared model will sometimes receive old gradients which, one may think, could be a disadvantage. The researchers of Hogwild!, however, could show that the training even benefits from the non-blocking fashion.", "Using Hogwild! on a distributed computer cluster has a huge communication overhead because, after each batch, the gradients need to be sent over the network. Thus, Hogwild++ was developed which decreases the amount of overhead by organizing the processes (i.e. each computer) in a ring. While training, a token is sent through that ring. The token bears the global model. Every time a token arrives at a node, the difference between the model weights are calculated and used to update the model in a non-trivial fashion. For more details, the paper is linked in the end.", "This code example is inspired by this link and gives an example of how to implement the standard Hogwild! algorithm in PyTorch.", "First, we implement a simple image classification model with convolutional layers. The model gives back the LogSoftmax which is useful when using NLLLoss during the training.", "Moreover, we define a training function, which is taking a model and a data loader as input parameters. Inside of this function, the Adam optimizer is used and the already mentioned NLLLoss. This training function is a standard implementation of a PyTorch program. Each process participating in Hogwild! will call it at the same time.", "The parallel setup happens in the next code section. Here, we define the number of parallel processes, instantiate the model and push it to shared memory with the single method call share_memory. The dataset used is the CIFAR10 dataset, available in the torchvision package.", "We loop over the processes and define a data loader for each process. The data loaders hold a distributed sampler which knows the rank of the process and handles the distribution of the data. Hence, each process has its data partition. The multiprocessing package calls the training function within each process and waits, with the join command, for the processes to finish.", "During training, all the processes have access to the shared model but train only on their very own data partition. Thus, we decrease the training time by approximately 4 which is the number of total training processes.", "The whole code can be found on my GitHub repository.", "Distributing the training of machine learning becomes more important. Especially, with the increase in training data and data complexity. In general, distributed training saves a lot of time and may also reduce the amount of consumed energy using intelligent distribution techniques. The code example shows, that it is surprisingly easy to apply parallel machine learning training with PyTorch.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "I am a Data Scientist and PhD student drinking coffee and philosophizing about AI, algorithms, concepts, etc. and their effects on our world and society."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F7cc80cd9b944&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthis-is-hogwild-7cc80cd9b944&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthis-is-hogwild-7cc80cd9b944&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthis-is-hogwild-7cc80cd9b944&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthis-is-hogwild-7cc80cd9b944&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----7cc80cd9b944--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----7cc80cd9b944--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@pw33392?source=post_page-----7cc80cd9b944--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@pw33392?source=post_page-----7cc80cd9b944--------------------------------", "anchor_text": "Phillip Wenig"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F9dbc010b40c6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthis-is-hogwild-7cc80cd9b944&user=Phillip+Wenig&userId=9dbc010b40c6&source=post_page-9dbc010b40c6----7cc80cd9b944---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F7cc80cd9b944&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthis-is-hogwild-7cc80cd9b944&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F7cc80cd9b944&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthis-is-hogwild-7cc80cd9b944&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@tumbao1949?utm_source=medium&utm_medium=referral", "anchor_text": "James Wainscoat"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://www.technologyreview.com/s/613630/training-a-single-ai-model-can-emit-as-much-carbon-as-five-cars-in-their-lifetimes/", "anchor_text": "link to article"}, {"url": "https://pytorch.org/docs/stable/notes/multiprocessing.html", "anchor_text": "this link"}, {"url": "https://github.com/wenig/hogwild", "anchor_text": "GitHub repository"}, {"url": "https://papers.nips.cc/paper/4390-hogwild-a-lock-free-approach-to-parallelizing-stochastic-gradient-descent.pdf", "anchor_text": "https://papers.nips.cc/paper/4390-hogwild-a-lock-free-approach-to-parallelizing-stochastic-gradient-descent.pdf"}, {"url": "http://www.stat.ucdavis.edu/~chohsieh/wildSGD.pdf", "anchor_text": "http://www.stat.ucdavis.edu/~chohsieh/wildSGD.pdf"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----7cc80cd9b944---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/parallel-computing?source=post_page-----7cc80cd9b944---------------parallel_computing-----------------", "anchor_text": "Parallel Computing"}, {"url": "https://medium.com/tag/distributed-systems?source=post_page-----7cc80cd9b944---------------distributed_systems-----------------", "anchor_text": "Distributed Systems"}, {"url": "https://medium.com/tag/data-science?source=post_page-----7cc80cd9b944---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/pytorch?source=post_page-----7cc80cd9b944---------------pytorch-----------------", "anchor_text": "Pytorch"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F7cc80cd9b944&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthis-is-hogwild-7cc80cd9b944&user=Phillip+Wenig&userId=9dbc010b40c6&source=-----7cc80cd9b944---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F7cc80cd9b944&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthis-is-hogwild-7cc80cd9b944&user=Phillip+Wenig&userId=9dbc010b40c6&source=-----7cc80cd9b944---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F7cc80cd9b944&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthis-is-hogwild-7cc80cd9b944&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----7cc80cd9b944--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F7cc80cd9b944&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthis-is-hogwild-7cc80cd9b944&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----7cc80cd9b944---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----7cc80cd9b944--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----7cc80cd9b944--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----7cc80cd9b944--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----7cc80cd9b944--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----7cc80cd9b944--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----7cc80cd9b944--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----7cc80cd9b944--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----7cc80cd9b944--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@pw33392?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@pw33392?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Phillip Wenig"}, {"url": "https://medium.com/@pw33392/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "306 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F9dbc010b40c6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthis-is-hogwild-7cc80cd9b944&user=Phillip+Wenig&userId=9dbc010b40c6&source=post_page-9dbc010b40c6--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fc0c7c976a038&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthis-is-hogwild-7cc80cd9b944&newsletterV3=9dbc010b40c6&newsletterV3Id=c0c7c976a038&user=Phillip+Wenig&userId=9dbc010b40c6&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}