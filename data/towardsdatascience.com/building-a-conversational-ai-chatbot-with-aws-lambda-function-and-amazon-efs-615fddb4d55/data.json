{"url": "https://towardsdatascience.com/building-a-conversational-ai-chatbot-with-aws-lambda-function-and-amazon-efs-615fddb4d55", "time": 1683009835.8288798, "path": "towardsdatascience.com/building-a-conversational-ai-chatbot-with-aws-lambda-function-and-amazon-efs-615fddb4d55/", "webpage": {"metadata": {"title": "Building a Conversational AI Chatbot With AWS Lambda Function and Amazon EFS | by Yi Ai | Towards Data Science", "h1": "Building a Conversational AI Chatbot With AWS Lambda Function and Amazon EFS", "description": "Amazon announced the general availability of AWS Lambda support for Amazon Elastic File System. Amazon EFS is a fully managed, elastic, shared file system and designed to be consumed by other AWS\u2026"}, "outgoing_paragraph_urls": [{"url": "https://github.com/ThilinaRajapakse/simpletransformers", "anchor_text": "simpletransformers", "paragraph_index": 7}, {"url": "https://s3.amazonaws.com/models.huggingface.co/transfer-learning-chatbot/gpt_personachat_cache.tar.gz", "anchor_text": "pre-trained model", "paragraph_index": 8}, {"url": "https://s3.amazonaws.com/models.huggingface.co/transfer-learning-chatbot/gpt_personachat_cache.tar.gz", "anchor_text": "pre-trained model", "paragraph_index": 10}, {"url": "http:#", "anchor_text": "sample CloudFormation templates", "paragraph_index": 12}, {"url": "https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/vpc-endpoints-dynamodb.html", "anchor_text": "VPC endpoint for DynamoDB", "paragraph_index": 13}, {"url": "https://github.com/ThilinaRajapakse/simpletransformers", "anchor_text": "simpletransformers", "paragraph_index": 18}, {"url": "https://docs.aws.amazon.com/lambda/latest/dg/configuration-concurrency.html", "anchor_text": "Provisioned Concurrency", "paragraph_index": 25}, {"url": "https://github.com/yai333/ConversationalAIChatbot", "anchor_text": "GitHub repo", "paragraph_index": 27}], "all_paragraphs": ["Amazon announced the general availability of AWS Lambda support for Amazon Elastic File System. Amazon EFS is a fully managed, elastic, shared file system and designed to be consumed by other AWS services.", "With the release of Amazon EFS for Lambda, we can now easily share data across function invocations. It also opens new capabilities, such as building/importing large libraries and machine learning models directly into Lambda functions. Let\u2019s go over how to build a serverless conversational AI chatbot using Lambda function and EFS.", "In this example we will use CloudFormation to create EFS and EFS access point, the configuration is defined as follows:", "Note that we will use EFS General Purpose performance mode since it has lower latency than Max I/O.", "We will mount EFS on Amazon SageMaker on a SageMaker notebook and Install PyTorch and ConvAI model on EFS.", "The notebook instance must have access to the same security group and reside in the same VPC as the EFS file system.", "Let\u2019s mount EFS path /py-libs to /home/ec2-user/SageMaker/libs directory:", "Then, install PyTorch and simpletransformers to lib/py-libs directory:", "Once we have all packages installed, download pre-trained model provided by Hugging Face, then extract the archive to convai-model directory on EFS.", "We are now ready to talk to the pre-trained model, simply call model.interact().", "The pre-trained model provided by Hugging Face performs well out-of-the-box and will likely require less fine-tuning when creating chatbot.", "We can see that python packages and model consumed from EFS correctly and we are able to start the conversation with pre-trained model.", "Create a DialogHistory table to store dialog history with at least the last utterance from user. We can use sample CloudFormation templates to configure the DynamoDB table.", "Please note that We have to create a VPC endpoint for DynamoDB even though the Lambda function is running inside a public subnet of a VPC.", "We will use AWS SAM to create Lambda functions and mount EFS access points to Lambda function.", "First, create a Lambda function resource, then setup EFS File System for Lambda. Make sure that EFS and Lambda are in the same VPC:", "In this section, we will create a Lambda function for communication between users and conversation AI model.", "We will contain the following source code in src/api.py :", "Note that simpletransformers library allows us to interact with the models locally with input(). To build our chat engine, we need to override the default method interact and sample_sequenc in conv_ai :", "We are almost there! Now we have to deploy our bot. Run the following command to deploy:", "From the output above, we can see the chatbot is now deployed.", "Now it\u2019s time to test our bot. Go to CloudFormation Resources list in the AWS Management Console to find the Lambda function name and Invoke lambda function using following command:", "The output will look like below:", "Here is an example of dialog:", "It works! As we can see from above screenshot, a chatbot returns response based on input from a user.", "However, I am aware of the impact of cold starts on response times. The first request took ~30 secs for cold starts to complete. To prevent cold start in our Lambda functions, we can use Provisioned Concurrency to keep functions warm:", "As a result, the latency of warmed-up function is reduced to ~3 seconds:", "That\u2019s it! I hope you have found this article useful, The source code for this post can be found in my GitHub repo.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "AWS Community Builder | AWS AZURE GCP Certified Engineer | A Cloud Technology Enthusiast | AWS Certified Security/Machine Learning/Database Analytics Specialty"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F615fddb4d55&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-a-conversational-ai-chatbot-with-aws-lambda-function-and-amazon-efs-615fddb4d55&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-a-conversational-ai-chatbot-with-aws-lambda-function-and-amazon-efs-615fddb4d55&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-a-conversational-ai-chatbot-with-aws-lambda-function-and-amazon-efs-615fddb4d55&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-a-conversational-ai-chatbot-with-aws-lambda-function-and-amazon-efs-615fddb4d55&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----615fddb4d55--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----615fddb4d55--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://yia333.medium.com/?source=post_page-----615fddb4d55--------------------------------", "anchor_text": ""}, {"url": "https://yia333.medium.com/?source=post_page-----615fddb4d55--------------------------------", "anchor_text": "Yi Ai"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F22047a0ec61b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-a-conversational-ai-chatbot-with-aws-lambda-function-and-amazon-efs-615fddb4d55&user=Yi+Ai&userId=22047a0ec61b&source=post_page-22047a0ec61b----615fddb4d55---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F615fddb4d55&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-a-conversational-ai-chatbot-with-aws-lambda-function-and-amazon-efs-615fddb4d55&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F615fddb4d55&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-a-conversational-ai-chatbot-with-aws-lambda-function-and-amazon-efs-615fddb4d55&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@exxteban", "anchor_text": "@exxteban"}, {"url": "https://unsplash.com/", "anchor_text": "unsplash"}, {"url": "https://github.com/ThilinaRajapakse/simpletransformers", "anchor_text": "simpletransformers"}, {"url": "https://s3.amazonaws.com/models.huggingface.co/transfer-learning-chatbot/gpt_personachat_cache.tar.gz", "anchor_text": "pre-trained model"}, {"url": "https://s3.amazonaws.com/models.huggingface.co/transfer-learning-chatbot/gpt_personachat_cache.tar.gz", "anchor_text": "https://s3.amazonaws.com/models.huggingface.co/transfer-learning-chatbot/gpt_personachat_cache.tar.gz"}, {"url": "https://s3.amazonaws.com/models.huggingface.co/transfer-learning-chatbot/gpt_personachat_cache.tar.gz", "anchor_text": "pre-trained model"}, {"url": "http:#", "anchor_text": "sample CloudFormation templates"}, {"url": "https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/vpc-endpoints-dynamodb.html", "anchor_text": "VPC endpoint for DynamoDB"}, {"url": "https://github.com/ThilinaRajapakse/simpletransformers", "anchor_text": "simpletransformers"}, {"url": "https://ap-southeast-2.console.aws.amazon.com/lambda/home?region=ap-southeast-2#/functions/chat-efs-api-HelloFunction-KQSNKF5K0IY8", "anchor_text": "chat-efs-api-HelloFunction-KQSNKF5K0IY8"}, {"url": "https://docs.aws.amazon.com/lambda/latest/dg/configuration-concurrency.html", "anchor_text": "Provisioned Concurrency"}, {"url": "https://github.com/yai333/ConversationalAIChatbot", "anchor_text": "GitHub repo"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----615fddb4d55---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/serverless?source=post_page-----615fddb4d55---------------serverless-----------------", "anchor_text": "Serverless"}, {"url": "https://medium.com/tag/aws-lambda?source=post_page-----615fddb4d55---------------aws_lambda-----------------", "anchor_text": "AWS Lambda"}, {"url": "https://medium.com/tag/efs?source=post_page-----615fddb4d55---------------efs-----------------", "anchor_text": "Efs"}, {"url": "https://medium.com/tag/chatbots?source=post_page-----615fddb4d55---------------chatbots-----------------", "anchor_text": "Chatbots"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F615fddb4d55&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-a-conversational-ai-chatbot-with-aws-lambda-function-and-amazon-efs-615fddb4d55&user=Yi+Ai&userId=22047a0ec61b&source=-----615fddb4d55---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F615fddb4d55&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-a-conversational-ai-chatbot-with-aws-lambda-function-and-amazon-efs-615fddb4d55&user=Yi+Ai&userId=22047a0ec61b&source=-----615fddb4d55---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F615fddb4d55&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-a-conversational-ai-chatbot-with-aws-lambda-function-and-amazon-efs-615fddb4d55&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----615fddb4d55--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F615fddb4d55&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-a-conversational-ai-chatbot-with-aws-lambda-function-and-amazon-efs-615fddb4d55&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----615fddb4d55---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----615fddb4d55--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----615fddb4d55--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----615fddb4d55--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----615fddb4d55--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----615fddb4d55--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----615fddb4d55--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----615fddb4d55--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----615fddb4d55--------------------------------", "anchor_text": ""}, {"url": "https://yia333.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://yia333.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Yi Ai"}, {"url": "https://yia333.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "318 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F22047a0ec61b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-a-conversational-ai-chatbot-with-aws-lambda-function-and-amazon-efs-615fddb4d55&user=Yi+Ai&userId=22047a0ec61b&source=post_page-22047a0ec61b--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Feb2bd512dbe0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-a-conversational-ai-chatbot-with-aws-lambda-function-and-amazon-efs-615fddb4d55&newsletterV3=22047a0ec61b&newsletterV3Id=eb2bd512dbe0&user=Yi+Ai&userId=22047a0ec61b&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}