{"url": "https://towardsdatascience.com/ml-ml-who-is-the-champion-of-them-all-1a4d253e86ad", "time": 1683011966.652231, "path": "towardsdatascience.com/ml-ml-who-is-the-champion-of-them-all-1a4d253e86ad/", "webpage": {"metadata": {"title": "ML, ML, who is the Champion of them all? | by Memphis Meng | Towards Data Science", "h1": "ML, ML, who is the Champion of them all?", "description": "2019/2020 UEFA champion league champion prediction using Machine Learning techniques, data source from fbref.com, major tools: python, sklearn and seaborn. Have fun reading and hope you enjoy sports analytics!"}, "outgoing_paragraph_urls": [{"url": "https://www.uefa.com/uefachampionsleague/news/025f-0fda67108b5a-ab24bdc017b7-1000--champions-league-finals-schedule/", "anchor_text": "released all the fixture draws", "paragraph_index": 0}, {"url": "https://fbref.com/en/comps/8/schedule/Champions-League-Scores-and-Fixtures", "anchor_text": "fbref.com", "paragraph_index": 3}, {"url": "https://www.kaggle.com/anzhemeng/19-20-ucl-champion-prediction", "anchor_text": "https://www.kaggle.com/anzhemeng/19-20-ucl-champion-prediction", "paragraph_index": 22}], "all_paragraphs": ["The past few months must be not easy for millions of soccer fans including me. As a die-hard fan of Real Madrid, I have already watched the highlights of Ronaldo, Ra\u00fal over and over again, trying to fulfill the excitement brought my favorite side but taken by COVID-19. But the good news is, soccer is back: three weeks ago, UEFA announced that from quarter-finals, UEFA Champion League (UCL) will be back in early August, and all fixtures will be single-elimination and released all the fixture draws. It is a piece of good news for me because I have been thinking about how Real will make a comeback in Manchester for months and here is the time to witness.", "However, the question is, how much is the comeback possible?", "So in the last week, I with the question in mind started a machine learning project to research how the UCL matches will go on when they return. In this project, I researched who would be the potential champion in the end, who can be named \u201cwinning underdog\u201d, and most importantly, how far Real Madrid might reach. In the rest of the article, I am going to show how I carried this project entirely from the start to the end all on my own, while sharing any interesting discoveries.", "The data I needed is all the information that was generated during the games before the long suspension. Hence, I collected all the data of 2019/2020 UCL using Scrapy in fbref.com. This covered the qualification rounds, group stage, and several knockouts that had taken place in February and March.", "Generally speaking, the data is categorized into two kinds: the side names and their final scores in a match (shown in the caption above), and the detailed data about the squads which are separated in several aspects such as goalkeeping, shooting, possession, etc. To be honest, I had no idea at that time if all the data I collected would be in use, but I just kept them all to avoid web-scraping again. I would tell about how I decide what features are supposed to be used in the next section.", "So my next step is to configure the pandas DataFrame using the collected data. As mentioned above, it wasn\u2019t certain whether all the features of the dataset should be utilized. Some of them are just one property but described into aggregate form and average form. For example, Gls and Gls/90 respectively stand for goals in total and goals on average. Therefore, I just extracted the features that reflect the average performance of the squad and the following image illustrates what I kept:", "Such kind of feature selection cannot 100% eliminate multilinearity though. Perhaps between some remaining features, they are highly interdependent with each other even if they have a different name. This can be unveiled by plotting the correlation heatmap among the features:", "Obviously, there exist some strong correlations. My solution to it is the dimensionality reduction by Prior Component Analysis. Before carrying out PCA, I needed to merge the fixture table with the feature set because I assumed the data of both sides of a match was the input of my model.", "As for the number of prior components, I also carried out a little test and it turned out that the first 14 prior components are already able to explain more than 95% of the information. That is impressive given that previously we had more than 80 input variables in total.", "I chose four models for comparison: Logistics Regression, XGBoosting, Decision Tree, and Gaussian Mixture Model. I cross-validated them each in 5 folds, using Rooted Mean Square Error (RMSE) as the measure, and found that XGBoosting outperformed any other counterpart.", "And now I need to obtain the optimal prediction result. To do this, I tuned the parameters of the best performer XGBoosting using Bayesian Optimization.", "The optimization increased the performance from about 2.84 to 2.74, and what is left now is to predict the results of future games.", "In the above figure, the four teams on the right half have been through to the quarter-finals while the teams on the left still have the second leg to play this month. So the numbers in the brackets mean the aggregate scores of the sides in the round of 16, while the numbers outside of the brackets represent their scores in the second leg. Noteworthily, it is extremely weird that all the results of the remaining matches are Home 2: 1 Away, which would hardly happen in reality. It would not be an accurate prediction and there must be something that I missed and needs fixing.", "It took me a while to think through the entire process all over again and notice that the problem comes from the imbalance of data. Soccer is a type of sport that there will not be likely to have many goals in a match. In other words, a game with more goals less tends to happen frequently. According to my observation, regardless of home/away difference, 1:1, 2:1, 2:0 are the mostly seen scores on the result table in this season\u2019s UCL up to now. That is to say, a team just score 2 goals at most in most of their games.", "However, there also exist some matches such as 4:4 and 7:2, though they just happened once. That makes my prediction biased because the model got cheated and tended to label a game with one of the most frequent samples.", "There are two solutions to this issue: downsizing the dataset or over-sampling. Cutting off the dataset would also take away part of the information from the dataset, and considering the small scale of my dataset, this absolutely is not an ideal option. And then it just left me only one choice.", "I tried the python package called \u201cimlearn\u201d, and because imlearn has not enabled over-sampling towards multi-label classification, my alternative is to apply RandomOverSampling to the Scores of one game (one column) instead of how many goals two sides scored (two columns). In this way, I viewed the result of each game as a label and equally populated each of them.", "And now all I need to do is just repeat the following steps.", "One last factor that I need to control is the parameters of the classifying model. Based on my observation, the parameters tuned by Bayesian Optimization are not stable, which means that they might probably be different in different optimization and consequently so are the prediction generated by the model. To have a relatively reliable value, I simulated the tournament by running the entire prediction over 300 times to calculate how big the possibility of each side to win the trophy.", "And the result of the simulation above is illustrated as the following figure:", "To sum up, now I can answer the questions that I had in mind when I started the project:", "It is a project that is carried entirely on my own when I had nothing else to kill my time, so I guess there must be something that I failed to take into better consideration. As far as I am concerned, there are 3 aspects that I should have done better in this project:", "That\u2019s all of my first ever data science project towards UCL champion prediction. What a fantastic experience! If you love reading story, please give me a clap and click the follow button, this is your biggest encouragement to me. And if you are interested in my implementation, feel free to visit my Kaggle kernel at https://www.kaggle.com/anzhemeng/19-20-ucl-champion-prediction.", "And finally, \u00a1hala Madrid y nada m\u00e1s!", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "I write data, sports and more."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F1a4d253e86ad&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fml-ml-who-is-the-champion-of-them-all-1a4d253e86ad&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fml-ml-who-is-the-champion-of-them-all-1a4d253e86ad&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fml-ml-who-is-the-champion-of-them-all-1a4d253e86ad&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fml-ml-who-is-the-champion-of-them-all-1a4d253e86ad&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----1a4d253e86ad--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----1a4d253e86ad--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://anzhemeng.medium.com/?source=post_page-----1a4d253e86ad--------------------------------", "anchor_text": ""}, {"url": "https://anzhemeng.medium.com/?source=post_page-----1a4d253e86ad--------------------------------", "anchor_text": "Memphis Meng"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F85370dce2b14&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fml-ml-who-is-the-champion-of-them-all-1a4d253e86ad&user=Memphis+Meng&userId=85370dce2b14&source=post_page-85370dce2b14----1a4d253e86ad---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F1a4d253e86ad&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fml-ml-who-is-the-champion-of-them-all-1a4d253e86ad&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F1a4d253e86ad&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fml-ml-who-is-the-champion-of-them-all-1a4d253e86ad&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@alexmotoc?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Alex Motoc"}, {"url": "https://unsplash.com/s/photos/champion-league?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://www.uefa.com/uefachampionsleague/news/025f-0fda67108b5a-ab24bdc017b7-1000--champions-league-finals-schedule/", "anchor_text": "released all the fixture draws"}, {"url": "https://fbref.com/en/comps/8/schedule/Champions-League-Scores-and-Fixtures", "anchor_text": "fbref.com"}, {"url": "https://en.as.com/en/2020/07/16/football/1594921115_294909.html#:~:text=Real%20Madrid%20sealed%20their%2034th,in%20the%20suburbs%20of%20Madrid.", "anchor_text": "won the domestic champion"}, {"url": "https://talksport.com/football/731702/premier-league-done-deals-2020-summer-transfer-window-manchester-united-arsenal-chelsea-liverpool-tottenham-leeds/", "anchor_text": "his transfer to Chelsea"}, {"url": "https://www.kaggle.com/anzhemeng/19-20-ucl-champion-prediction", "anchor_text": "https://www.kaggle.com/anzhemeng/19-20-ucl-champion-prediction"}, {"url": "https://unsplash.com/@mmanusoo?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Manuel N\u00f6bauer"}, {"url": "https://unsplash.com/s/photos/real-madrid?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://medium.com/tag/data-science?source=post_page-----1a4d253e86ad---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/soccer-prediction?source=post_page-----1a4d253e86ad---------------soccer_prediction-----------------", "anchor_text": "Soccer Prediction"}, {"url": "https://medium.com/tag/champions-league?source=post_page-----1a4d253e86ad---------------champions_league-----------------", "anchor_text": "Champions League"}, {"url": "https://medium.com/tag/xgboost?source=post_page-----1a4d253e86ad---------------xgboost-----------------", "anchor_text": "Xgboost"}, {"url": "https://medium.com/tag/python?source=post_page-----1a4d253e86ad---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F1a4d253e86ad&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fml-ml-who-is-the-champion-of-them-all-1a4d253e86ad&user=Memphis+Meng&userId=85370dce2b14&source=-----1a4d253e86ad---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F1a4d253e86ad&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fml-ml-who-is-the-champion-of-them-all-1a4d253e86ad&user=Memphis+Meng&userId=85370dce2b14&source=-----1a4d253e86ad---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F1a4d253e86ad&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fml-ml-who-is-the-champion-of-them-all-1a4d253e86ad&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----1a4d253e86ad--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F1a4d253e86ad&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fml-ml-who-is-the-champion-of-them-all-1a4d253e86ad&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----1a4d253e86ad---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----1a4d253e86ad--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----1a4d253e86ad--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----1a4d253e86ad--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----1a4d253e86ad--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----1a4d253e86ad--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----1a4d253e86ad--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----1a4d253e86ad--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----1a4d253e86ad--------------------------------", "anchor_text": ""}, {"url": "https://anzhemeng.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://anzhemeng.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Memphis Meng"}, {"url": "https://anzhemeng.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "125 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F85370dce2b14&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fml-ml-who-is-the-champion-of-them-all-1a4d253e86ad&user=Memphis+Meng&userId=85370dce2b14&source=post_page-85370dce2b14--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F2f0fc3e14c3d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fml-ml-who-is-the-champion-of-them-all-1a4d253e86ad&newsletterV3=85370dce2b14&newsletterV3Id=2f0fc3e14c3d&user=Memphis+Meng&userId=85370dce2b14&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}