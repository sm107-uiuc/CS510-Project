{"url": "https://towardsdatascience.com/data-leakage-with-hyper-parameter-tuning-c57ba2006046", "time": 1683013824.079251, "path": "towardsdatascience.com/data-leakage-with-hyper-parameter-tuning-c57ba2006046/", "webpage": {"metadata": {"title": "Data Leakage in Hyperparameter Tuning | Towards Data Science", "h1": "Data Leakage with Hyper-Parameter Tuning", "description": "Data Leakage in Hyperparameter Tuning is a unware by Data Scientist. It should be prevented. It can be avoided with Pipeline in scikit-learn."}, "outgoing_paragraph_urls": [{"url": "https://www.linkedin.com/in/sivasai-mudugandla-89a156104/", "anchor_text": "https://www.linkedin.com/in/sivasai-mudugandla-89a156104/", "paragraph_index": 20}], "all_paragraphs": ["Data Leakage is when the model somehow knows the patterns in the test data during its training phase. In other words, the data that you are using to train your ML algorithm happens to have the information you are trying to predict.", "Data leakage prevents the model to generalize well. It\u2019s very difficult for a data scientist to identify data leakage. Some of the reasons for data leakage are", "Hyper-Parameter Tuning is the process of finding the best set of hyper-parameters of the ML algorithm that delivers best performance.", "For more on Hyper-Parameters and Tuning Techniques refer my previous article.", "Most of the Hyper-Parameter Tuning Techniques uses cross-validation to select best set of Hyper-Parameters. Cross-validation splits the data into train test set and builds different models with different sets of hyper-parameters on train set and validates the performance on the test set. Eventually, it selects the best combination of parameters that gives highest performance.", "But when we perform preprocessing steps like scaling, imputing etc, with Tuning Techniques that uses cross-validation like Grid Search, Random Search etc, will cause Data Leakage.", "Let's understand this in more detail with code.", "In the above code, I first performed Scaling (StandardScaler) on train data and then trained my GridSearchCV with Support Vector Classifier as an estimator and cv = 3 i.e, 3-fold cross validation. With 3-fold cross validation, the train data would split into 3-groups, in each group it further split into 2 groups as train sets and 1 group as test set. For each model with unique set of parameters will be trained on train set and evaluated on the test set, later on the scores will be evaluated and model would be discarded. This process continues for all 3-groups.", "Here the model has influenced by the data in the test set (Data Leakage) while training, The data has leaked with StandardScaler operation. StandardScaler / z-score is calculated with mean and standard deviation.", "The train data has scaled (mean and S.D of StandardScaler are calculated on train data) before Grid Search and then with cross validation the train data split into train & test groups. The train groups that are using to train/fit the algorithm have already had the information about test group(i.e. mean and S.D of train data which is combination of train & test groups). This is how data leaks happens with Hyper-Parameter Tuning.", "The solution for data leakage in such cases is Pipeline.", "A pipeline is used to help automate machine learning workflows such as scaling, dimensionality reduction, model fitting, and validation etc. It basically takes multiple steps in a machine learning process and combine it into a single object which makes it easier to both develop and use as well as save and reuse later.", "Let's understand how pipeline solves data leakage with code.", "In the above code, I used StandardScaler and SVC with pipeline and then passed pipeline object to Grid Search with cv = 3.", "In this situation, data is first split into 3 groups (cv=3) i.e. 2-train groups & 1 test group. On each group, scaling would be performed. So, there is no data leakage here.", "In that way we can avoid data leakage successfully.", "When performing hyper-parameter tuning with techniques that uses cross-validation one should aware of data leakage. In such situations, using pipelines will help to avoid data leaks.", "Any feedback and comments are, greatly appreciated!", "You may like my other articles,", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Analyst at CITI Bank| London | Ex \u2014 Data scientist | Post Graduate in AI & ML | Pythonista | https://www.linkedin.com/in/sivasai-mudugandla-89a156104/"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fc57ba2006046&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-leakage-with-hyper-parameter-tuning-c57ba2006046&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-leakage-with-hyper-parameter-tuning-c57ba2006046&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-leakage-with-hyper-parameter-tuning-c57ba2006046&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-leakage-with-hyper-parameter-tuning-c57ba2006046&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----c57ba2006046--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----c57ba2006046--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://sivasai-yadav.medium.com/?source=post_page-----c57ba2006046--------------------------------", "anchor_text": ""}, {"url": "https://sivasai-yadav.medium.com/?source=post_page-----c57ba2006046--------------------------------", "anchor_text": "Sivasai Yadav Mudugandla"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fc615257004ff&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-leakage-with-hyper-parameter-tuning-c57ba2006046&user=Sivasai+Yadav+Mudugandla&userId=c615257004ff&source=post_page-c615257004ff----c57ba2006046---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc57ba2006046&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-leakage-with-hyper-parameter-tuning-c57ba2006046&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc57ba2006046&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-leakage-with-hyper-parameter-tuning-c57ba2006046&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://medium.com/swlh/4-hyper-parameter-tuning-techniques-924cb188d199", "anchor_text": "4 Hyper-Parameter Tuning TechniquesPopular hyper-parameter tuning techniques that every Data Scientist should knowmedium.com"}, {"url": "https://towardsdatascience.com/data-leakage-with-hyper-parameter-tuning-c57ba2006046", "anchor_text": "Data Leakage with Hyper-Parameter TuningHyper-Parameter Tuning sometimes messes up your model and leads to unpredictable results on unseen data.towardsdatascience.com"}, {"url": "https://medium.com/swlh/is-and-in-python-f084f36cbc0e", "anchor_text": "\u201cis\u201d and \u201c==\u201d in PythonSpeed up your string comparisonsmedium.com"}, {"url": "https://medium.com/swlh/4-hyper-parameter-tuning-techniques-924cb188d199", "anchor_text": "4 Hyper-Parameter Tuning TechniquesPopular hyper-parameter tuning techniques that every Data Scientist should knowmedium.com"}, {"url": "https://medium.com/tag/data-science?source=post_page-----c57ba2006046---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----c57ba2006046---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/ai?source=post_page-----c57ba2006046---------------ai-----------------", "anchor_text": "AI"}, {"url": "https://medium.com/tag/python?source=post_page-----c57ba2006046---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----c57ba2006046---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fc57ba2006046&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-leakage-with-hyper-parameter-tuning-c57ba2006046&user=Sivasai+Yadav+Mudugandla&userId=c615257004ff&source=-----c57ba2006046---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fc57ba2006046&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-leakage-with-hyper-parameter-tuning-c57ba2006046&user=Sivasai+Yadav+Mudugandla&userId=c615257004ff&source=-----c57ba2006046---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc57ba2006046&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-leakage-with-hyper-parameter-tuning-c57ba2006046&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----c57ba2006046--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fc57ba2006046&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-leakage-with-hyper-parameter-tuning-c57ba2006046&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----c57ba2006046---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----c57ba2006046--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----c57ba2006046--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----c57ba2006046--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----c57ba2006046--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----c57ba2006046--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----c57ba2006046--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----c57ba2006046--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----c57ba2006046--------------------------------", "anchor_text": ""}, {"url": "https://sivasai-yadav.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://sivasai-yadav.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Sivasai Yadav Mudugandla"}, {"url": "https://sivasai-yadav.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "311 Followers"}, {"url": "https://www.linkedin.com/in/sivasai-mudugandla-89a156104/", "anchor_text": "https://www.linkedin.com/in/sivasai-mudugandla-89a156104/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fc615257004ff&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-leakage-with-hyper-parameter-tuning-c57ba2006046&user=Sivasai+Yadav+Mudugandla&userId=c615257004ff&source=post_page-c615257004ff--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fe653db942c44&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-leakage-with-hyper-parameter-tuning-c57ba2006046&newsletterV3=c615257004ff&newsletterV3Id=e653db942c44&user=Sivasai+Yadav+Mudugandla&userId=c615257004ff&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}