{"url": "https://towardsdatascience.com/explore-the-potential-of-products-through-customers-purchase-behaviour-in-power-bi-basket-a1f77e8a2bf6", "time": 1683008609.064944, "path": "towardsdatascience.com/explore-the-potential-of-products-through-customers-purchase-behaviour-in-power-bi-basket-a1f77e8a2bf6/", "webpage": {"metadata": {"title": "Advance DAX Tutorial: Basket Analysis 2.0 | by Davis Zhang | Towards Data Science", "h1": "Advance DAX Tutorial: Basket Analysis 2.0", "description": "This article aims to use DAX to analyze customer purchase behavior in Power BI and to gain insight into product potential. Marco Russo and Alberto Ferrari have published a blog a few years ago called\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.sqlbi.com/author/marco-russo/", "anchor_text": "Marco Russo", "paragraph_index": 1}, {"url": "https://www.sqlbi.com/author/alberto-ferrari/", "anchor_text": "Alberto Ferrari", "paragraph_index": 1}, {"url": "https://www.daxpatterns.com/basket-analysis/", "anchor_text": "Basket Analysis", "paragraph_index": 1}, {"url": "https://blog.gbrueckl.at/about/", "anchor_text": "Gerhard", "paragraph_index": 17}, {"url": "https://1drv.ms/u/s!AjpQa2fseaxaoDLeh4yBlBSaa-qx", "anchor_text": "here", "paragraph_index": 17}, {"url": "https://www.linkedin.com/in/davis-zhang/", "anchor_text": "https://www.linkedin.com/in/davis-zhang/", "paragraph_index": 19}], "all_paragraphs": ["This article aims to use DAX to analyze customer purchase behavior in Power BI and to gain insight into product potential.", "Marco Russo and Alberto Ferrari have published a blog a few years ago called \u201cBasket Analysis\u201d, this interesting article describes in detail how to use DAX to calculate very useful measures such as the number of orders and the number of customers under any product portfolio. This article can be seen as an extension of \u201cBasket Analysis\u201d, which takes into account the chronological order in which customers purchase different products.", "Assuming that A and B represent two different products, then \u201cBasket Analysis\u201d calculates P(AB), while this paper calculates P(A|B) and P(B|A), as you can compare the two figures shown below:", "The figure above is the measure of \u201cCustomers with Both Products\u201d in \u201cBasket Analysis\u201d, which shows that 72 customers have purchase records for both \u201cBottles and Cages\u201d and \u201cBike Racks\u201d. However, the data shown in the figure below takes into account the chronological order in which customers purchase products. You can find that 8 of the customers who bought Bike Racks first and then purchased Bottles and Cages later, and 14 of the customers who bought Bottles and Cages first but bought Bike Racks later.(Note: We temporarily ignore the situation of buying A and B at the same time)", "The customer\u2019s order record reflects some very useful facts that give direction to the correlation between products. In other words, \u201cbasket analysis\u201d is very useful when analyzing supermarket data because customers often choose multiple products at the time of shopping and then go to the cashier to place an order together. In this case, all products are treated as simultaneous orders. But in fact, you can\u2019t trace the record of different products selected by customers during the shopping process in the supermarket. But if it is in other scenarios, such as customers ordering on the e-commerce platform or the official website, if you as the store manager, you may want to know that A and B are the best-selling models, which one can bring more return customers, which one is easier to lose customers. Therefore, we need to know the repurchase % of each product. For example, all customers who purchase products A first, how many people will come back to buy products again in the future, further analysis, in these people, the purchase is still product A or other products? What is the proportion of each, this is a question worth studying.", "Following the calculation process, we will finally achieve the calculation results shown in the figure below (Note: I use the same data set as \u201cbasket analysis\u201d):", "As mentioned earlier, it shows which customers who purchased the product A first and have subsequent purchase records, how much of them purchased the product B, or product C, etc.", "Therefore, in order to achieve this calculation result, there are five steps here:", "1. First, classify all orders for the sales table, in all orders of the customer, one or more orders with the earliest order date are classified as the first order, the rest are \u201cnon-first\u201d:", "2. Filter the order data of all products A in Sales, and then further filter which orders are marked as the customer\u2019s first order, and we extract the customer list in this filtered table, and add a virtual column named \u201cROWS\u201d to it, as shown in the following code \u2014 virtual table \u201cVT1\u201d.", "3. Use Sales as the main table and use NATURALLEFTOUTERJOIN() to associate with the virtual table \u201cVT1\u201d, then use filter() to exclude those rows whose [ROWS] value is not equal to 1 so that the rest of the data (VT2) is all orders for all customers returned by \u201cVT1\u201d. Finally, the data is further filtered for all orders except \u201cfirst-order\u201d, and the result is named \u201cCustDistinctValue\u201d:", "4. After that, we need to make sure this data can be filtered by the product (in this case we just use sub-category). Here is basically the same as Macro\u2019s calculation method, using the copy of the product table (Filter Product) and the main table to establish a non- Active relationship, then create a measure so that its context ignores all fields of the product table, and accepts the context from its copy (Filter Product).", "Note: \u201cSameSubCategorySelection\u201d is used to exclude the data of choosing the same Sub-Category. This formula also uses Macro\u2019s method to complete:", "5. Now, we have figured out how many of the customers who purchased Product A first purchased each of the other products, and now we need to calculate the proportion of these customers who accounted for the total number of customers who purchased Product A first and then had a purchase record. The following is the code for calculating the denominator of this proportion.", "Now we get the final result: CustPurchaseOthersSubCategoryAfter %, the name of this measure is very long, because its logic is complex, just like the calculation process above.", "In the end, we will succeed in getting the final result as below and choose to visualize it using a custom-visuals called \u201cCHORD\u201d.", "As you can see, the customers who bought road bikes first, 1853 of them bought mountain bikes later, while the interesting thing is only 200 customers bought road bikes after they have bought the mountain bikes.", "I am very grateful to Gerhard\u2019s advice before, this time I have attached the PBIX file in the article, you can download it here if you are interested in it.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Full Stack BI Developer, Data Analyst, MCSE; LinkedIn: https://www.linkedin.com/in/davis-zhang/"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fa1f77e8a2bf6&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fexplore-the-potential-of-products-through-customers-purchase-behaviour-in-power-bi-basket-a1f77e8a2bf6&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fexplore-the-potential-of-products-through-customers-purchase-behaviour-in-power-bi-basket-a1f77e8a2bf6&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fexplore-the-potential-of-products-through-customers-purchase-behaviour-in-power-bi-basket-a1f77e8a2bf6&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fexplore-the-potential-of-products-through-customers-purchase-behaviour-in-power-bi-basket-a1f77e8a2bf6&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----a1f77e8a2bf6--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----a1f77e8a2bf6--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@zhaaaaaaang?source=post_page-----a1f77e8a2bf6--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@zhaaaaaaang?source=post_page-----a1f77e8a2bf6--------------------------------", "anchor_text": "Davis Zhang"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F26f63d2d57d4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fexplore-the-potential-of-products-through-customers-purchase-behaviour-in-power-bi-basket-a1f77e8a2bf6&user=Davis+Zhang&userId=26f63d2d57d4&source=post_page-26f63d2d57d4----a1f77e8a2bf6---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa1f77e8a2bf6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fexplore-the-potential-of-products-through-customers-purchase-behaviour-in-power-bi-basket-a1f77e8a2bf6&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa1f77e8a2bf6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fexplore-the-potential-of-products-through-customers-purchase-behaviour-in-power-bi-basket-a1f77e8a2bf6&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://www.sqlbi.com/author/marco-russo/", "anchor_text": "Marco Russo"}, {"url": "https://www.sqlbi.com/author/alberto-ferrari/", "anchor_text": "Alberto Ferrari"}, {"url": "https://www.daxpatterns.com/basket-analysis/", "anchor_text": "Basket Analysis"}, {"url": "https://blog.gbrueckl.at/about/", "anchor_text": "Gerhard"}, {"url": "https://1drv.ms/u/s!AjpQa2fseaxaoDLeh4yBlBSaa-qx", "anchor_text": "here"}, {"url": "https://medium.com/tag/power-bi?source=post_page-----a1f77e8a2bf6---------------power_bi-----------------", "anchor_text": "Power Bi"}, {"url": "https://medium.com/tag/power-bi-tutorials?source=post_page-----a1f77e8a2bf6---------------power_bi_tutorials-----------------", "anchor_text": "Power Bi Tutorials"}, {"url": "https://medium.com/tag/dax?source=post_page-----a1f77e8a2bf6---------------dax-----------------", "anchor_text": "Dax"}, {"url": "https://medium.com/tag/data-analytics?source=post_page-----a1f77e8a2bf6---------------data_analytics-----------------", "anchor_text": "Data Analytics"}, {"url": "https://medium.com/tag/towards-data-science?source=post_page-----a1f77e8a2bf6---------------towards_data_science-----------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fa1f77e8a2bf6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fexplore-the-potential-of-products-through-customers-purchase-behaviour-in-power-bi-basket-a1f77e8a2bf6&user=Davis+Zhang&userId=26f63d2d57d4&source=-----a1f77e8a2bf6---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fa1f77e8a2bf6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fexplore-the-potential-of-products-through-customers-purchase-behaviour-in-power-bi-basket-a1f77e8a2bf6&user=Davis+Zhang&userId=26f63d2d57d4&source=-----a1f77e8a2bf6---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa1f77e8a2bf6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fexplore-the-potential-of-products-through-customers-purchase-behaviour-in-power-bi-basket-a1f77e8a2bf6&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----a1f77e8a2bf6--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fa1f77e8a2bf6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fexplore-the-potential-of-products-through-customers-purchase-behaviour-in-power-bi-basket-a1f77e8a2bf6&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----a1f77e8a2bf6---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----a1f77e8a2bf6--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----a1f77e8a2bf6--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----a1f77e8a2bf6--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----a1f77e8a2bf6--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----a1f77e8a2bf6--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----a1f77e8a2bf6--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----a1f77e8a2bf6--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----a1f77e8a2bf6--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@zhaaaaaaang?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@zhaaaaaaang?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Davis Zhang"}, {"url": "https://medium.com/@zhaaaaaaang/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "35 Followers"}, {"url": "https://www.linkedin.com/in/davis-zhang/", "anchor_text": "https://www.linkedin.com/in/davis-zhang/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F26f63d2d57d4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fexplore-the-potential-of-products-through-customers-purchase-behaviour-in-power-bi-basket-a1f77e8a2bf6&user=Davis+Zhang&userId=26f63d2d57d4&source=post_page-26f63d2d57d4--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F70dabbc82b19&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fexplore-the-potential-of-products-through-customers-purchase-behaviour-in-power-bi-basket-a1f77e8a2bf6&newsletterV3=26f63d2d57d4&newsletterV3Id=70dabbc82b19&user=Davis+Zhang&userId=26f63d2d57d4&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}