{"url": "https://towardsdatascience.com/emotion-detection-a-machine-learning-project-f7431f652b1f", "time": 1683002453.58279, "path": "towardsdatascience.com/emotion-detection-a-machine-learning-project-f7431f652b1f/", "webpage": {"metadata": {"title": "Emotion Detection: a Machine Learning Project | by Aarohi Gupta | Towards Data Science", "h1": "Emotion Detection: a Machine Learning Project", "description": "If someone showed you a picture of a person and asked you to guess what they\u2019re feeling, chances are you\u2019d have a pretty good idea about it. What if your computer could do the same? What if it could\u2026"}, "outgoing_paragraph_urls": [{"url": "https://medium.com/@aarohigupta2211/demystify-artificial-intelligence-4d5310ea1294", "anchor_text": "Demystifying Artificial Intelligence", "paragraph_index": 2}, {"url": "https://medium.com/@aarohigupta2211/demystify-artificial-intelligence-4d5310ea1294", "anchor_text": "this link", "paragraph_index": 29}, {"url": "https://www.facebook.com/inspiritAI/", "anchor_text": "InspiritAI", "paragraph_index": 30}], "all_paragraphs": ["The process of identifying human emotion", "If someone showed you a picture of a person and asked you to guess what they\u2019re feeling, chances are you\u2019d have a pretty good idea about it. What if your computer could do the same? What if it could become even better than you are? It seems like an absurd thought, right?", "In my last blog (read: Demystifying Artificial Intelligence), I had said that I would explain a project that would show how the concepts discussed are applied.", "The following blog contains a recollection of all of the series of things that we did during the project with InspiritAI, while it does show a lot of the code required to do Emotion Detection, this is by no means the fastest way to train a model. Multiple ML and AI models were used to see the difference between them.", "The three main components of Emotion Detection are as follows:", "Facial detection is an important step in emotion detection. It removes the parts of the image that aren\u2019t relevant. Here\u2019s one way of detecting faces in images.", "Another way to do this is by using dlib\u2019s pre-trained face detector model which is used in the next point as well.", "Facial landmarks are a set of key points on human face images. The points are defined by their (x,y) coordinates on the image. These points are used to locate and represent salient regions of the face, such as eyes, eyebrows, nose, mouth and jawline.", "The facial landmark model we used was the Dlib\u2019s pre-trained Facial Landmark Detection Model which detects 68 2-Dimensional points on the human face.", "You can load the model like this:", "After using the model, your output should look like this:", "In this model, the specific landmarks for facial features are:", "One way to differentiate between two emotions is to see whether the persons mouth and eyes are open or not. We can find the euclidian distance between the points specifically on the mouth, if a person is surprised, the distance would be more than it would be if they\u2019re not.", "Before using the data, it is important to go through a series of steps called pre-processing. This makes the data easier to handle.", "We will use a modified version of the fer2013 dataset consisting of five emotion labels.", "The dataset is stored in a csvfile. Each row in the csvfile denotes an instance. Every instance has two column attributes :", "There is a total of 20,000 images distributed equally across the five emotions. The images are 48*48 grayscale cropped images. The csvfile consists of a flattened array of the image stored in the form of a string", "This dataset contains the raw pixel values of the images.", "As discussed last time, the data needs to be split into two different sets:", "Standardization is the process of putting different variables on the same scale. It rescales data to have a mean of 0 and a standard deviation of 1. This transformation centres the data.", "KNN is a non-parametric learning algorithm, meaning it does not make any assumptions about the distribution of data. We used the euclidean distances between the points as the data.", "To find the accuracy of the model:", "Our accuracy was about 50% so we tried some non-linear models.", "You can try to input the raw pixel values into the model and see how it affects the accuracy of the model.", "MLPs are a subcategory of neural networks. They are made of one or more layers of neurons. The input layers are where the data is fed, after which there may be one or more hidden layers. The predictions come from the output layer.", "Our accuracy using pixels was about 50%, this increased when instead of using pixel values, we used the distances between the facial landmarks. However we wanted models that would be even more accurate, so we decided to use CNNs.", "To improve performance you can very the dropout, number of dense layers and activation functions. We also used transfer learning with a CNN called VGG which is a pre-trained convolutional neural network for image classification.", "The best results came by using the VGG which were right about 68\u201370% of the time, but even the linear models did a very good job. Although 50% accuracy does not seem like a lot, it is still more than if you would pick up a picture and a label at random. There, you would be right about 20% of the time.", "The VGG, however, performs even better than humans do in this particular dataset. The difference between the CNNs and the MLPs was that the CNNs were extracting features that they deemed important by themselves, while we were feeding either pixels or landmarks as features to the MLPs.", "For more information on KNNs, CNNs, MLPs and other basic machine learning topics click on this link.", "Special thanks to Adeesh Goel for organising this amazing workshop, check out the facebook page of InspiritAI, Tyler Bonnen for being such a wonderful mentor and guiding us through the program, and my team members Khushi and Harsh.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Ff7431f652b1f&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Femotion-detection-a-machine-learning-project-f7431f652b1f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Femotion-detection-a-machine-learning-project-f7431f652b1f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Femotion-detection-a-machine-learning-project-f7431f652b1f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Femotion-detection-a-machine-learning-project-f7431f652b1f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----f7431f652b1f--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----f7431f652b1f--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://aarohigupta.medium.com/?source=post_page-----f7431f652b1f--------------------------------", "anchor_text": ""}, {"url": "https://aarohigupta.medium.com/?source=post_page-----f7431f652b1f--------------------------------", "anchor_text": "Aarohi Gupta"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fdbf4a7a921c7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Femotion-detection-a-machine-learning-project-f7431f652b1f&user=Aarohi+Gupta&userId=dbf4a7a921c7&source=post_page-dbf4a7a921c7----f7431f652b1f---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ff7431f652b1f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Femotion-detection-a-machine-learning-project-f7431f652b1f&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ff7431f652b1f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Femotion-detection-a-machine-learning-project-f7431f652b1f&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://medium.com/@aarohigupta2211/demystify-artificial-intelligence-4d5310ea1294", "anchor_text": "Demystifying Artificial Intelligence"}, {"url": "https://medium.com/@aarohigupta2211/demystify-artificial-intelligence-4d5310ea1294", "anchor_text": "this link"}, {"url": "https://www.facebook.com/inspiritAI/", "anchor_text": "InspiritAI"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----f7431f652b1f---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/emotion-detection?source=post_page-----f7431f652b1f---------------emotion_detection-----------------", "anchor_text": "Emotion Detection"}, {"url": "https://medium.com/tag/computer-vision?source=post_page-----f7431f652b1f---------------computer_vision-----------------", "anchor_text": "Computer Vision"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----f7431f652b1f---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/computer-science?source=post_page-----f7431f652b1f---------------computer_science-----------------", "anchor_text": "Computer Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Ff7431f652b1f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Femotion-detection-a-machine-learning-project-f7431f652b1f&user=Aarohi+Gupta&userId=dbf4a7a921c7&source=-----f7431f652b1f---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Ff7431f652b1f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Femotion-detection-a-machine-learning-project-f7431f652b1f&user=Aarohi+Gupta&userId=dbf4a7a921c7&source=-----f7431f652b1f---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ff7431f652b1f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Femotion-detection-a-machine-learning-project-f7431f652b1f&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----f7431f652b1f--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Ff7431f652b1f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Femotion-detection-a-machine-learning-project-f7431f652b1f&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----f7431f652b1f---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----f7431f652b1f--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----f7431f652b1f--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----f7431f652b1f--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----f7431f652b1f--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----f7431f652b1f--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----f7431f652b1f--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----f7431f652b1f--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----f7431f652b1f--------------------------------", "anchor_text": ""}, {"url": "https://aarohigupta.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://aarohigupta.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Aarohi Gupta"}, {"url": "https://aarohigupta.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "73 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fdbf4a7a921c7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Femotion-detection-a-machine-learning-project-f7431f652b1f&user=Aarohi+Gupta&userId=dbf4a7a921c7&source=post_page-dbf4a7a921c7--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fb28b45d6139d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Femotion-detection-a-machine-learning-project-f7431f652b1f&newsletterV3=dbf4a7a921c7&newsletterV3Id=b28b45d6139d&user=Aarohi+Gupta&userId=dbf4a7a921c7&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}