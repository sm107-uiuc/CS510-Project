{"url": "https://towardsdatascience.com/molecular-properties-a-journey-through-multiple-linear-regression-1a1043c7de25", "time": 1683002196.3709152, "path": "towardsdatascience.com/molecular-properties-a-journey-through-multiple-linear-regression-1a1043c7de25/", "webpage": {"metadata": {"title": "Molecular Properties: A Journey through Multiple Linear Regression | by Iftekher Mamun | Towards Data Science", "h1": "Molecular Properties: A Journey through Multiple Linear Regression", "description": "Since finishing my data science bootcamp, I had not worked on a solo project that encompassed what I learned. After seeing the Kaggle competition and my love for biology, I decided to try it out\u2026"}, "outgoing_paragraph_urls": [{"url": "https://towardsdatascience.com/picking-the-proper-mla-for-linear-regression-4221ea5a8f2e", "anchor_text": "Picking the Proper MLA for Linear Regression", "paragraph_index": 1}, {"url": "https://github.com/imamun93/Molecular_Properties/blob/master/KaggleSet.ipynb", "anchor_text": "final notebook", "paragraph_index": 2}, {"url": "https://www.kaggle.com/artgor", "anchor_text": "Andrew", "paragraph_index": 5}, {"url": "https://keras.io/optimizers/", "anchor_text": "Keras documents", "paragraph_index": 21}], "all_paragraphs": ["Since finishing my data science bootcamp, I had not worked on a solo project that encompassed what I learned. After seeing the Kaggle competition and my love for biology, I decided to try it out. Unfortunately, I was not confident at that time on my ability to finish the competition within the time limit so I just downloaded and started working on it bit by bit to try to understand the process better. I have published multiple articles here on those process. The articles can be found below:", "Picking the Proper MLA for Linear Regression", "The above four articles generally compassed each different approach I took to approach the problem. After the last article I decided to take a little break and then come back to look at this project from a new perspective. There were few more different approaches I used but I will only focus on the final notebook and go through the process here. To understand this process I recommend you read through the articles posted above. They are short articles and should not take more than half hour to read through them all.", "Now let\u2019s start to load up all the libraries that I will use:", "And then let\u2019s load the library and look at some basic statistics:", "Now to look at some visuals. This was thanks to Kaggle Competitor Andrew:", "This helps create a network graph of all categorical variables in relation to the scalar coupling constant. I have also went ahead and created more of this relational graph for the fc, muliken_charge, pso, sd and dso as they were also determined to be important features from my previous work.", "This can be a bit difficult to interpret. However, we see that some types are more clustered together while others like 2JHH forms rather unique relation to scalar. There is a slightly better way to visualize the impact of each type has on the target atom using Tableau Visual:", "Combining the above two pictures, we can understand why 2JHH has such and unique schema and while atoms like 1JHC and 3JHC are similar and more clustered together. Now let\u2019s create a scalar constant bin and a violin plot using type and scalar constant:", "After this, I converted all categorical variables into dummy variables using LabelEncoder, create a training and testing set and finally ran the train-test-split from sci-kit learn.", "In my previous models, I did not use any categorical variables. So I decided to run the LGBM model again, but include the dummy variables:", "I did one more visual that focused on accuracy instead of mean absolute error and it gave a slightly different importance in features but it only affected the order of the top 5 features. Then I realized that since the target variable contains mostly rather small number but not all features do, it was creating some form of bias for features with bigger numbers. I then decided to normalize the data:", "Now to create a new train-test-split as these are new variables essentially.", "With that done, I decided to move into actual machine modeling. I did not do another LGBM model as I did not think it would change the features much more even after normalizing but you can try it out and let me know. I started with the basic linear regression model and measure using negative mean squared error. This means the smaller the number the better the result:", "I created a new dataframe just for the target test variable for future comparison between the ridge and lasso models:", "Now to create a new ridge model and to test it against the normalized feature array. I choose GridSearchCV for both ridge and lasso as it was the most optimal based on my research. It used cross validation instead of creating a new train test split case. This minimized the possibility of data leak as this algorithm will not see the actual test set.", "Now to run some prediction against the unknown test case:", "This made me worry about overfitting and I did not understand why there was a gap between the data. So I saved the ridge scores into a dataframe and moved onto lasso.", "The Lasso was computed using the same method as Ridge:", "At this point, I saved the lasso scores into a dataframe and decided to directly compare the results to the actual test score using Tableau as the visual medium:", "This shows the accuracy of my ridge and lasso models. Since it is a bit tricky to check for accuracy among three continuous columns, using tableau, I used the COUNT function for all columns as a form of filter and then created a SUM linear graph with the Actual Test Scalar being the main component. The size shows concentration of most of the numbers and it does not really play any role in the bigger scheme of the project. However, a clear line of best fit can easily be drawn showing that the algorithms I used can be used to predict molecular scalar constant charge. This also helps explain the gaps a little bit. Majority of the scalar were rather small numbers to begin with and the few thousands that were outside the boundary probably caused the gap within the linear graph. However, we can clearly see a line of best fit.", "There was one more algorithm I wanted to try out. A neural network. After trying out few different ones on a different notebook, I settles on working with Relu with adadelta as an optimizer. I chose adadelta because of the explanation from Keras documents:", "learning rates based on a moving window of gradient updates, instead of accumulating all past gradients. This way, Adadelta continues learning even when many updates have been done.", "After setting up the basic perimeters, I created a model with early stop and terminate on. Their descriptions and usage can be found in the keras documents.", "Because of early callback and terminate, the model ends rather quickly. It shows high mae and low accuracy as convergence occurs relatively early. But I know this is a mistake because of the graph below.", "Then I ran a new model but this time I did not use early-callback or terminate. I wanted to run through all epoch:", "Now I see that both accuracy and loss are converged. However, accuracy appears to converge at a very low point and is just not a proper metric for this model. Since adadelta uses decay as a mean point, I also decided to look into mean absolute error instead of accuracy. With accuracy being such a small number and not having a proper gradient, it cannot be used.", "This shows much better convergence and gradient descent. If I ran for a higher count of Epoch, the mae would have most likely decreased more. But at this point, the mae was at 0.6403 with a loss at 0.6871. Although it was not as small as the Ridge model mae, it was still a descent model. However, in terms of quantitative analysis the ridge model is still the best model to use for linear regression problems that contains multiple features with millions of datasets for each features. In addition, each features\u2019 values were sparse and some features may not even play any roles. There is also the chance that some features are causing the same effect on the target variables leading to multicolinearity and a difference in weight importance that can cause bias and overfitting in your model. Taking all these factors into consideration, I believe that using a ridge model to calculate mean error rather than accuracy is perfect for this challenge. My github url for this project will be linked below so you can take a look and perhaps improve my model.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Machine learning is where it\u2019s at"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F1a1043c7de25&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmolecular-properties-a-journey-through-multiple-linear-regression-1a1043c7de25&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmolecular-properties-a-journey-through-multiple-linear-regression-1a1043c7de25&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmolecular-properties-a-journey-through-multiple-linear-regression-1a1043c7de25&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmolecular-properties-a-journey-through-multiple-linear-regression-1a1043c7de25&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----1a1043c7de25--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----1a1043c7de25--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@imamun?source=post_page-----1a1043c7de25--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@imamun?source=post_page-----1a1043c7de25--------------------------------", "anchor_text": "Iftekher Mamun"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F41404f6cc939&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmolecular-properties-a-journey-through-multiple-linear-regression-1a1043c7de25&user=Iftekher+Mamun&userId=41404f6cc939&source=post_page-41404f6cc939----1a1043c7de25---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F1a1043c7de25&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmolecular-properties-a-journey-through-multiple-linear-regression-1a1043c7de25&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F1a1043c7de25&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmolecular-properties-a-journey-through-multiple-linear-regression-1a1043c7de25&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://www.kaggle.com/c/champs-scalar-coupling", "anchor_text": "Kaggle competition of Molecular Properties"}, {"url": "https://www.kaggle.com/c/champs-scalar-coupling", "anchor_text": "Source"}, {"url": "https://medium.com/@imamun/steps-before-machine-learning-417a2812a1cc", "anchor_text": "Steps Before Machine Learning"}, {"url": "https://medium.com/@imamun/lgbm-and-feature-extraction-ae87fe83ea77", "anchor_text": "LGBM and Feature Extraction"}, {"url": "https://medium.com/@imamun/linear-regression-of-selected-features-132cc6c4b600", "anchor_text": "Linear Regression of Selected Features"}, {"url": "https://towardsdatascience.com/picking-the-proper-mla-for-linear-regression-4221ea5a8f2e", "anchor_text": "Picking the Proper MLA for Linear Regression"}, {"url": "https://github.com/imamun93/Molecular_Properties/blob/master/KaggleSet.ipynb", "anchor_text": "final notebook"}, {"url": "https://www.kaggle.com/artgor", "anchor_text": "Andrew"}, {"url": "https://keras.io/optimizers/", "anchor_text": "Keras documents"}, {"url": "https://github.com/imamun93/Molecular_Properties", "anchor_text": "imamun93/Molecular_PropertiesData from Kaggle competition Predicting Molecular Properties. All data can be found there. Due to git size limitation\u2026github.com"}, {"url": "https://www.kaggle.com/c/champs-scalar-coupling", "anchor_text": "Predicting Molecular PropertiesCan you measure the magnetic interactions between a pair of atoms?www.kaggle.com"}, {"url": "https://keras.io/optimizers/", "anchor_text": "Optimizers - Keras DocumentationAn optimizer is one of the two arguments required for compiling a Keras model: from keras import optimizers model =\u2026keras.io"}, {"url": "https://medium.com/tag/kaggle?source=post_page-----1a1043c7de25---------------kaggle-----------------", "anchor_text": "Kaggle"}, {"url": "https://medium.com/tag/tableau?source=post_page-----1a1043c7de25---------------tableau-----------------", "anchor_text": "Tableau"}, {"url": "https://medium.com/tag/molecular-biology?source=post_page-----1a1043c7de25---------------molecular_biology-----------------", "anchor_text": "Molecular Biology"}, {"url": "https://medium.com/tag/linear-regression?source=post_page-----1a1043c7de25---------------linear_regression-----------------", "anchor_text": "Linear Regression"}, {"url": "https://medium.com/tag/towards-data-science?source=post_page-----1a1043c7de25---------------towards_data_science-----------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F1a1043c7de25&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmolecular-properties-a-journey-through-multiple-linear-regression-1a1043c7de25&user=Iftekher+Mamun&userId=41404f6cc939&source=-----1a1043c7de25---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F1a1043c7de25&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmolecular-properties-a-journey-through-multiple-linear-regression-1a1043c7de25&user=Iftekher+Mamun&userId=41404f6cc939&source=-----1a1043c7de25---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F1a1043c7de25&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmolecular-properties-a-journey-through-multiple-linear-regression-1a1043c7de25&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----1a1043c7de25--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F1a1043c7de25&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmolecular-properties-a-journey-through-multiple-linear-regression-1a1043c7de25&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----1a1043c7de25---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----1a1043c7de25--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----1a1043c7de25--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----1a1043c7de25--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----1a1043c7de25--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----1a1043c7de25--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----1a1043c7de25--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----1a1043c7de25--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----1a1043c7de25--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@imamun?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@imamun?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Iftekher Mamun"}, {"url": "https://medium.com/@imamun/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "158 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F41404f6cc939&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmolecular-properties-a-journey-through-multiple-linear-regression-1a1043c7de25&user=Iftekher+Mamun&userId=41404f6cc939&source=post_page-41404f6cc939--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fusers%2F41404f6cc939%2Flazily-enable-writer-subscription&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmolecular-properties-a-journey-through-multiple-linear-regression-1a1043c7de25&user=Iftekher+Mamun&userId=41404f6cc939&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}