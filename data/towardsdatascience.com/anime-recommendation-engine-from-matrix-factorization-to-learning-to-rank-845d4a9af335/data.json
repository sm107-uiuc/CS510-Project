{"url": "https://towardsdatascience.com/anime-recommendation-engine-from-matrix-factorization-to-learning-to-rank-845d4a9af335", "time": 1682994215.625238, "path": "towardsdatascience.com/anime-recommendation-engine-from-matrix-factorization-to-learning-to-rank-845d4a9af335/", "webpage": {"metadata": {"title": "Anime Recommendation engine: From Matrix Factorization to Learning-to-rank | by Preetika Srivastava | Towards Data Science", "h1": "Anime Recommendation engine: From Matrix Factorization to Learning-to-rank", "description": "The vast amount of data that is hosted on the internet today has led to the information overflow and thus there is a constant need to improve the user experience. A recommendation engine is a system\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.kaggle.com/azathoth42/myanimelist", "anchor_text": "Kaggle", "paragraph_index": 2}, {"url": "http://surpriselib.com/", "anchor_text": "surprise", "paragraph_index": 5}, {"url": "http://www.ece.utexas.edu/people/faculty/joydeep-ghosh", "anchor_text": "Dr. Ghosh", "paragraph_index": 8}, {"url": "https://www.microsoft.com/en-us/research/publication/from-ranknet-to-lambdarank-to-lambdamart-an-overview/", "anchor_text": "paper by Microsoft", "paragraph_index": 10}, {"url": "https://en.wikipedia.org/wiki/Kendall_rank_correlation_coefficient", "anchor_text": "Kendall Tau rank correlation coefficient", "paragraph_index": 11}, {"url": "https://github.com/Preetikasri/Anime-Recommendation-Engine", "anchor_text": "https://github.com/Preetikasri/Anime-Recommendation-Engine", "paragraph_index": 24}], "all_paragraphs": ["OtakusHenry Chang, Joey Chen, Guanhua Zhang, Preetika Srivastava and Cherry Agarwal", "The vast amount of data that is hosted on the internet today has led to the information overflow and thus there is a constant need to improve the user experience. A recommendation engine is a system that helps support user\u2019s decision making by providing appropriate predicted suggestions for them. They have become a part and parcel of our everyday life. From shopping to food to entertainment, they play a role everywhere.Anime is the new cult and becoming popular everyday, especially in the non-Asian countries. However, there is no recommendation engine which helps both newbies and seasoned Otakus to progress smartly in the field. Hence, we, a bunch of Otakus decided to develop one as a part of our academic project.", "This data is taken from Kaggle. It contains the information of Anime and the Users who have watched it and rated it. There are over 30M observations, 100K users and 6K animation movies in this data set. Heuristically we decided to get rid of the users who have rated very few anime and anime with no rating for training our recommendation engine. Exploring the data we found that most of our users were from US followed by Brazil and Poland. The most popular genres were Comedy, Musical and Adventure. Also, the majority of our users were from 20 to 30 years of age.", "There has been recommendation engines out there to serve a variety of needs, and they all have different underlying algorithms to solve the problems. The most traditional ones are using collaborative filtering where you tend to split the Ratings matrix (R) into User-Embedding (U) and Anime-Embedding (P). These embedding are quintessentially what we call the latent features (in Supervised Machine Learning). To explore this approach, we tried three algorithms, viz. a viz. Alternating Least Squares(ALS), Singular Value Decomposition and Neural Networks.", "ALS: It is a two-step iterative optimization process. In each iteration, it tries to optimize the Rating matrix (U*P) by solving for U first keeping P constant followed by P keeping U constant. We used PySpark to run this algorithm using MLlib.", "SVD: To estimate all the unknown and get embeddings, we minimize the regularized squared error by stochastic gradient descent. We stumbled upon great \u201csurprise\u201d and used its SVD\u2019s implementation to train our algorithm.", "Neural Networks: Here we use the two embedding layers to represent the users and the anime as our input. The interactions (rating matrix) is the target variable. For each user-anime pair, we compute a score taking the dot product of their latent representation. We then try to minimize the loss via back-propagation and optimize the embedding layers (schematic shown below).", "We ran this model for 10 epochs, and since it was expensive computationally, we ran this with Keras(Tensorflow backend) on Google Cloud platform. This model turned out better than the previous ones but didn\u2019t outperform them extensively. And we got another model for absolutely free! Guess what? ENSEMBLE!!. This model simply averaged the results predicted from the above three models.", "As it can be seen that Ensemble exceptionally outperforms all the three algorithms, and give great results with NDCG and MAP(more on this later). Initially, we evaluated our models based on RMSE. However, our professor Dr. Ghosh recommended us to look into learning-to-rank (LTR) algorithms.", "The question arises that why do we need to move to LTR algorithms? Think about it like this: Suppose we have two items i and j for which the true ratings are known to be 3 and 4 respectively and two different methods have predicted the ratings on i and j to be {2, 5} and {4, 3} respectively. In terms of rating prediction accuracy as measured by the absolute deviation from the true rating, there is no difference between the two sets of predictions. However, using the predictions {4, 3}, item i and j will be incorrectly ordered while the predictions {2, 5} ensures the correct order.", "Learning to rank predicts the ranking of list of the items instead of rating. Based on status quo of LTR algorithms there aren\u2019t many open source resources available in python to implement them. With this project, we had a chance to extensively go through paper by Microsoft on the LTR and code them in python from scratch. This is our two cents to the open source community working on reco-engines and if they wish to experiment with these algorithms. Since, this was an academic project, these proved utterly beneficial for our conceptual learning as well. And we were able to successfully go through two of them, namely, EigenRank and LambdaMART. EigenRank is ranking-oriented version of collaborative filtering, whereas LambdaMART is a typical of supervised Machine Learning weds Information Retrieval.", "Eigen Rank: It is the first ranking based Collaborative Filtering algorithm. For each user u, it tries to find it\u2019s neighborhood (Nu) using Kendall Tau rank correlation coefficient and then calculates the preference function shown below.", "The more often the users in Nu assign i a higher rating than j, the stronger the evidence is for \u03a8 (i,j) > 0 and \u03a8 (j,i) < 0. The preference function assigns a score to every pair of anime i,j of the anime list of the neighbors. Finally to rank these anime, we use a Greedy algorithm approach.", "LambdaMART: It uses Gradient boosted trees to directly optimized rank specific cost functions(e.g. NDCG). Unfortunately, Costs functions are not differentiable at all points. Thus, we need proxy for gradients which is called Lambda here. It can be thought of as a force which moves the anime up and down the ranking list(schematic below). The best part is, it also utilizes the features of both Anime and user like popularity, duration, genres, number of times particular user has watched, release year etc. Exploiting this quality of LambdaMART, we can make recommendations for a fresh user.", "We again use evaluation measures like NDCG(Normalized cumulative discounted gain) and MAP(Mean average Precision) for these LTR models.", "As mentioned before, since we wrote the code for fore mentioned two algorithms it wasn\u2019t super-scalable. While we put efforts to make our code gold standard, we tested its utility on smaller data (~0.5M) , and it performed greatly, by achieving NDCG as: 0.72 (Eigen rank) and 0.60 (LambdaMART); MAP as 0.63 (EigenRank) and 0.56(LambdaMART).", "So let\u2019s break the suspense on NDCG and MAP..", "NDCG-Normalized Discounted Cumulative Gain: It quantifies the deviation of predicted ranking list from the ideal ranking list(which will be simply sorted order of items based on rating). It is also cognizant of the fact that highly relevant documents are more useful than marginally relevant documents.", "NDCG@K is just the NDCG calculated for the top K recommendations from our engine.", "MAP- Mean Average Precision: It captures the percentage of anime that are relevant(user in test data has seen them and rated them highly) out of all the anime recommended.", "MAP@K is just the MAP calculated for the top K recommendations from our engine.", "So far, our recommendation are based on a user\u2019s watching history . What do we do if there is a new users that come to us for animation recommendation? To help new users join the world of animation, we used K-means clustering to group the users in different clusters who share a common liking for different genres. Altogether, we came up with 5 different groups: Sci-Fi Junkies, No Preference, Haters, Lively Youth and Hot Blood Fighters.", "Here\u2019s a cool video which demonstrates the relative superiority of our tried algorithms:", "Way Forward(i) Scalability enhancement for learning to rank algorithms, probably by coding them in Cython. (ii) Better feature engineering for LambdaMART. (iii) Build a front-end to host our recommendation engine(iv) Finish (i), (ii) and (iii) and then may be try approaching a venture capitalist to fund our reco-engine website !!", "Full project and code can be viewed at https://github.com/Preetikasri/Anime-Recommendation-Engine", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Machine Learning Practitioner || Ethical AI || Math Lover"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F845d4a9af335&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fanime-recommendation-engine-from-matrix-factorization-to-learning-to-rank-845d4a9af335&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fanime-recommendation-engine-from-matrix-factorization-to-learning-to-rank-845d4a9af335&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fanime-recommendation-engine-from-matrix-factorization-to-learning-to-rank-845d4a9af335&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fanime-recommendation-engine-from-matrix-factorization-to-learning-to-rank-845d4a9af335&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----845d4a9af335--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----845d4a9af335--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@preetikasrivastava30?source=post_page-----845d4a9af335--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@preetikasrivastava30?source=post_page-----845d4a9af335--------------------------------", "anchor_text": "Preetika Srivastava"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F6a0384fae9fa&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fanime-recommendation-engine-from-matrix-factorization-to-learning-to-rank-845d4a9af335&user=Preetika+Srivastava&userId=6a0384fae9fa&source=post_page-6a0384fae9fa----845d4a9af335---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F845d4a9af335&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fanime-recommendation-engine-from-matrix-factorization-to-learning-to-rank-845d4a9af335&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F845d4a9af335&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fanime-recommendation-engine-from-matrix-factorization-to-learning-to-rank-845d4a9af335&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://www.kaggle.com/azathoth42/myanimelist", "anchor_text": "Kaggle"}, {"url": "http://surpriselib.com/", "anchor_text": "surprise"}, {"url": "http://www.ece.utexas.edu/people/faculty/joydeep-ghosh", "anchor_text": "Dr. Ghosh"}, {"url": "https://www.microsoft.com/en-us/research/publication/from-ranknet-to-lambdarank-to-lambdamart-an-overview/", "anchor_text": "paper by Microsoft"}, {"url": "https://en.wikipedia.org/wiki/Kendall_rank_correlation_coefficient", "anchor_text": "Kendall Tau rank correlation coefficient"}, {"url": "https://github.com/Preetikasri/Anime-Recommendation-Engine", "anchor_text": "https://github.com/Preetikasri/Anime-Recommendation-Engine"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----845d4a9af335---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/recommendation-system?source=post_page-----845d4a9af335---------------recommendation_system-----------------", "anchor_text": "Recommendation System"}, {"url": "https://medium.com/tag/anime?source=post_page-----845d4a9af335---------------anime-----------------", "anchor_text": "Anime"}, {"url": "https://medium.com/tag/collaborative-filtering?source=post_page-----845d4a9af335---------------collaborative_filtering-----------------", "anchor_text": "Collaborative Filtering"}, {"url": "https://medium.com/tag/towards-data-science?source=post_page-----845d4a9af335---------------towards_data_science-----------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F845d4a9af335&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fanime-recommendation-engine-from-matrix-factorization-to-learning-to-rank-845d4a9af335&user=Preetika+Srivastava&userId=6a0384fae9fa&source=-----845d4a9af335---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F845d4a9af335&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fanime-recommendation-engine-from-matrix-factorization-to-learning-to-rank-845d4a9af335&user=Preetika+Srivastava&userId=6a0384fae9fa&source=-----845d4a9af335---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F845d4a9af335&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fanime-recommendation-engine-from-matrix-factorization-to-learning-to-rank-845d4a9af335&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----845d4a9af335--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F845d4a9af335&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fanime-recommendation-engine-from-matrix-factorization-to-learning-to-rank-845d4a9af335&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----845d4a9af335---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----845d4a9af335--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----845d4a9af335--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----845d4a9af335--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----845d4a9af335--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----845d4a9af335--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----845d4a9af335--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----845d4a9af335--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----845d4a9af335--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@preetikasrivastava30?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@preetikasrivastava30?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Preetika Srivastava"}, {"url": "https://medium.com/@preetikasrivastava30/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "121 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F6a0384fae9fa&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fanime-recommendation-engine-from-matrix-factorization-to-learning-to-rank-845d4a9af335&user=Preetika+Srivastava&userId=6a0384fae9fa&source=post_page-6a0384fae9fa--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fdf4fa45c9c04&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fanime-recommendation-engine-from-matrix-factorization-to-learning-to-rank-845d4a9af335&newsletterV3=6a0384fae9fa&newsletterV3Id=df4fa45c9c04&user=Preetika+Srivastava&userId=6a0384fae9fa&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}