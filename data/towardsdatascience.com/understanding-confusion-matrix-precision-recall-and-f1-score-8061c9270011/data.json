{"url": "https://towardsdatascience.com/understanding-confusion-matrix-precision-recall-and-f1-score-8061c9270011", "time": 1683015378.384779, "path": "towardsdatascience.com/understanding-confusion-matrix-precision-recall-and-f1-score-8061c9270011/", "webpage": {"metadata": {"title": "Understanding Confusion Matrix, Precision-Recall, and F1-Score | by Pratheesh Shivaprasad | Towards Data Science", "h1": "Understanding Confusion Matrix, Precision-Recall, and F1-Score", "description": "As I was going over several notebooks in Kaggle the past few days, I couldn\u2019t help but notice some notebooks titled \u201cAchieving 100% accuracy on dataset_name\u201d, \u201cPerfect 100% accuracy using\u2026"}, "outgoing_paragraph_urls": [{"url": "https://en.wikipedia.org/wiki/Overfitting", "anchor_text": "Wikipedia", "paragraph_index": 1}, {"url": "https://en.wikipedia.org/wiki/Confusion_matrix", "anchor_text": "Wikipedia", "paragraph_index": 3}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.metrics.confusion_matrix.html", "anchor_text": "here", "paragraph_index": 18}, {"url": "https://en.wikipedia.org/wiki/Positive_predictive_value", "anchor_text": "positive predictive value", "paragraph_index": 21}, {"url": "https://en.wikipedia.org/wiki/Sensitivity_and_specificity", "anchor_text": "sensitivity", "paragraph_index": 21}, {"url": "https://en.wikipedia.org/wiki/Relevance_(information_retrieval)", "anchor_text": "relevance", "paragraph_index": 21}, {"url": "https://en.wikipedia.org/wiki/Precision_and_recall", "anchor_text": "Wikipedia", "paragraph_index": 21}, {"url": "https://scikit-learn.org/stable/auto_examples/model_selection/plot_precision_recall.html", "anchor_text": "here", "paragraph_index": 29}, {"url": "https://en.wikipedia.org/wiki/Precision_(information_retrieval)", "anchor_text": "precision", "paragraph_index": 38}, {"url": "https://en.wikipedia.org/wiki/Recall_(information_retrieval)", "anchor_text": "recall", "paragraph_index": 38}, {"url": "https://en.wikipedia.org/wiki/F1_score", "anchor_text": "Wikipedia", "paragraph_index": 38}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.metrics.f1_score.html", "anchor_text": "here", "paragraph_index": 41}, {"url": "http://linkedin.com/in/pratheesh-s", "anchor_text": "linkedin.com/in/pratheesh-s", "paragraph_index": 44}], "all_paragraphs": ["As I was going over several notebooks in Kaggle the past few days, I couldn\u2019t help but notice some notebooks titled \u201cAchieving 100% accuracy on dataset_name\u201d, \u201cPerfect 100% accuracy using algorithm_name\u201d, along with various other guides on how to achieve a 100% accuracy on every dataset you would come across. While some of these notebooks did a great job at building a generalized model for the dataset and delivering pretty good results, a majority of them were just overfitting on the data.", "Overfitting is the production of an analysis that corresponds too closely or exactly to a particular set of data, and may therefore fail to fit additional data or predict future observations reliably \u2014 Wikipedia", "And the saddest part about all this? They weren\u2019t even realizing that they were overfitting on the dataset while trying to achieve that golden number. Most of these notebooks were found on beginner-friendly datasets like the \u201cIris dataset\u201d or \u201cTitanic dataset\u201d and it makes sense, right? Most of us while starting on the Machine Learning trajectory was only taught one thing: \u201cAccuracy matters\u201d. And while this is true, it matters only up to a certain extent. This is why I\u2019ll be discussing some other performance metrics like Confusion Matrix, Precision-Recall, and F1-Score that you should consider using along with Accuracy while evaluating a Machine Learning model. Let\u2019s get started.", "In the field of machine learning and specifically the problem of statistical classification, a confusion matrix, also known as an error matrix, is a specific table layout that allows visualization of the performance of an algorithm, typically a supervised learning one. \u2014 Wikipedia", "To understand the confusion matrix let us consider a two-class classification problem with the two outcomes being \u201cPositive\u201d and \u201cNegative\u201d. Given a data point to predict, the model\u2019s outcome will be any one of these two.", "If we plot the predicted values against the ground truth (actual) values, we get a matrix with the following representative elements:", "True Positives (TP): These are the data points whose actual outcomes were positive and the algorithm correctly identified it as positive.", "True Negatives (TN): These are the data points whose actual outcomes were negative and the algorithm correctly identified it as negative.", "False Positives (FP): These are the data points whose actual outcomes were negative but the algorithm incorrectly identified it as positive.", "False Negatives (FN): These are the data points whose actual outcomes were positive but the algorithm incorrectly identified it as negative.", "As you can guess, the goal of evaluating a model using the confusion matrix is to maximize the values of TP and TN and minimize the values of FP and FN.", "To understand this concept better, let us take a real-life example: Prediction of heart disease. In this case, the outcomes would be a patient having heart disease or not. The confusion matrix would look something like this:", "Here, TP means that the patient actually has heart disease and the algorithm predicted it correctly. TN means the patient doesn\u2019t have heart disease and the algorithm predicted it correctly. So the goal should be to keep these values as high as possible.", "To understand this, let\u2019s consider the heart disease example. Most of the time when we\u2019re dealing with medical use cases, there is a high chance of having a skewed dataset i.e one of the target variables will be having more data points than the other. In this case, most of the people undergoing the test will not be diagnosed with any heart disease. Due to this, there is an imbalance (skewness) in the dataset.", "If we train a model on the dataset shown in the image above, since the number of data points of patients not having a heart disease is far more than patients having heart disease, the model will be biased towards the target having more data points (especially if we\u2019re evaluating a model solely based on its accuracy).", "Now, after training, if we test the model on the test set (which has 8000 data points for patients not having heart disease and only 2000 data points for patients having heart disease), even if the model predicts that all the 10000 data points don\u2019t have any heart disease, the accuracy still gets up to a whopping 80%. This can be misleading especially in a field where the risk of False Negatives should be negligible (A model predicting a patient having heart disease as a patient not having heart disease will prove really fatal).", "This is where the confusion matrix comes into play. For the above scenario, the confusion matrix would look something like this:", "Now, if you look at the confusion matrix along with the accuracy the model got, we could clearly identify that the model is overfitting on the training dataset as it is predicting every unknown data point as a patient not having heart disease. If it wasn\u2019t for the confusion matrix, we would have never known the underlying issue.", "The scikit learn package includes the Confusion Matrix. You can look up the official documentation here.", "Now that you have understood what Confusion Matrix does, it\u2019ll be easier to understand Precision-Recall.", "We have already seen how accuracy can be misleading in some cases. Precision and Recall helps us further understand how strong the accuracy shown holds true for a particular problem.", "Precision (also called positive predictive value) is the fraction of relevant instances among the retrieved instances, while Recall (also known as sensitivity) is the fraction of the total amount of relevant instances that were actually retrieved. Both precision and recall are therefore based on an understanding and measure of relevance. \u2014 Wikipedia", "In simple terms, precision means what percentage of the positive predictions made were actually correct.", "In our example of heart disease, it\u2019d look something like this:", "It could be translated into simple language as, of all patients classified as having heart disease, how many of them actually had heart disease?", "Recall in simple terms means, what percentage of actual positive predictions were correctly classified by the classifier.", "In our example, it\u2019d look something like this:", "It basically asks, of all the patients that have heart disease, how many were classified as having heart disease?", "The formula may seem kinda identical at first, but once you get the gist, it\u2019ll be harder to get confused between the two.", "Precision-Recall is also available in the scikit learn package. You can look up the official documentation here.", "Suppose we train a Logistic Regression Classifier to identify whether the patient has heart disease or not. It will predict that the patient has heart disease if the probability (threshold) is greater than or equal to 0.5 and the patient doesn\u2019t have heart disease if the probability is less than 0.5.", "Now, if we want to build a model in such a way that it predicts if the patient has heart disease only if it is very confident in the hypothesis, we might have to increase the threshold to 0.7 or 0.8.", "In this scenario, we end up with a classifier having high precision and low recall. Higher precision because now the classifier is more confident that the patient has heart disease. Lower recall because now that the classifier\u2019s threshold is set so high, there will be fewer patients classified as having heart disease.", "The alternative to this is we build a model in such a way that it won\u2019t miss any possible cases of a patient having heart disease (to avoid false negatives). If a patient having heart disease goes unnoticed by the model, it could prove fatal. In this case, we decrease the threshold to 0.2 or 0.3 so that even if there is a slight chance that the patient may have heart disease, it raises an alarm and further diagnosis can be done to prove the hypothesis.", "What we have here is an example of high recall and low precision. Higher recall because we will be classifying a larger number of patients having heart disease. Lower precision because out of a large number of patients predicted having heart disease some of them won\u2019t actually have heart disease upon further diagnosis.", "Generally speaking, the precision-recall values keep changing as you increase or decrease the threshold. Building a model with higher precision or recall depends on the problem statement you\u2019re dealing with and its requirements.", "Precision-Recall values can be very useful to understand the performance of a specific algorithm and also helps in producing results based on the requirements. But when it comes to comparing several algorithms trained on the same data, it becomes difficult to understand which algorithm suits the data better solely based on the Precision-Recall values.", "Hence there is a need for a metric that takes the precision-recall values and provides a standardized representation of those values.", "In statistical analysis of binary classification, the F1 score (also F-score or F-measure) is a measure of a test\u2019s accuracy. It is calculated from the precision and recall of the test, where the precision is the number of correctly identified positive results divided by the number of all positive results, including those not identified correctly, and the recall is the number of correctly identified positive results divided by the number of all samples that should have been identified as positive. \u2014 Wikipedia", "F1 score can also be described as the harmonic mean or weighted average of precision and recall.", "Having a precision or recall value as 0 is not desirable and hence it will give us the F1 score of 0 (lowest). On the other hand, if both the precision and recall value is 1, it\u2019ll give us the F1 score of 1 indicating perfect precision-recall values. All the other intermediate values of the F1 score ranges between 0 and 1.", "F1 Score is also available in the scikit learn package. You can look up the official documentation here.", "I hope this article helped you understand the terms Confusion Matrix, Precision-Recall, and F1 Score. Using these metrics will definitely help you in getting a better idea about your model\u2019s performance. Once you have completely understood these concepts, you could also look into some other evaluation metrics like Log loss, ROC-AUC curve, Categorical Crossentropy, and more.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Python Developer. Machine Learning and Deep Learning Enthusiast. LinkedIn: linkedin.com/in/pratheesh-s"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F8061c9270011&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-confusion-matrix-precision-recall-and-f1-score-8061c9270011&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-confusion-matrix-precision-recall-and-f1-score-8061c9270011&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-confusion-matrix-precision-recall-and-f1-score-8061c9270011&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-confusion-matrix-precision-recall-and-f1-score-8061c9270011&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----8061c9270011--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----8061c9270011--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@Pratheesh_S?source=post_page-----8061c9270011--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@Pratheesh_S?source=post_page-----8061c9270011--------------------------------", "anchor_text": "Pratheesh Shivaprasad"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fd04fc11ce21&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-confusion-matrix-precision-recall-and-f1-score-8061c9270011&user=Pratheesh+Shivaprasad&userId=d04fc11ce21&source=post_page-d04fc11ce21----8061c9270011---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F8061c9270011&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-confusion-matrix-precision-recall-and-f1-score-8061c9270011&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F8061c9270011&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-confusion-matrix-precision-recall-and-f1-score-8061c9270011&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://www.canva.com/", "anchor_text": "Canva"}, {"url": "https://en.wikipedia.org/wiki/Overfitting", "anchor_text": "Wikipedia"}, {"url": "https://en.wikipedia.org/wiki/Confusion_matrix", "anchor_text": "Wikipedia"}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.metrics.confusion_matrix.html", "anchor_text": "here"}, {"url": "https://en.wikipedia.org/wiki/Positive_predictive_value", "anchor_text": "positive predictive value"}, {"url": "https://en.wikipedia.org/wiki/Sensitivity_and_specificity", "anchor_text": "sensitivity"}, {"url": "https://en.wikipedia.org/wiki/Relevance_(information_retrieval)", "anchor_text": "relevance"}, {"url": "https://en.wikipedia.org/wiki/Precision_and_recall", "anchor_text": "Wikipedia"}, {"url": "https://scikit-learn.org/stable/auto_examples/model_selection/plot_precision_recall.html", "anchor_text": "here"}, {"url": "https://en.wikipedia.org/wiki/Precision_(information_retrieval)", "anchor_text": "precision"}, {"url": "https://en.wikipedia.org/wiki/Recall_(information_retrieval)", "anchor_text": "recall"}, {"url": "https://en.wikipedia.org/wiki/F1_score", "anchor_text": "Wikipedia"}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.metrics.f1_score.html", "anchor_text": "here"}, {"url": "https://www.amazon.com/Hands-Machine-Learning-Scikit-Learn-TensorFlow/dp/1492032646", "anchor_text": "Hands-On Machine Learning with Scikit-Learn, Keras, and TensorFlow: Concepts, Tools, and Techniques to Build Intelligent Systems"}, {"url": "https://www.youtube.com/watch?v=W5meQnGACGo&list=PLsas0wB8kXTF8tduPtwvM6MtB163ELjuP&index=11", "anchor_text": "Trading Off Precision And Recall \u2014 [Andrew Ng]"}, {"url": "https://en.wikipedia.org/wiki/Confusion_matrix", "anchor_text": "Confusion Matrix \u2014 Wikipedia"}, {"url": "https://en.wikipedia.org/wiki/Precision_and_recall", "anchor_text": "Precision-Recall \u2014 Wikipedia"}, {"url": "https://en.wikipedia.org/wiki/F1_score", "anchor_text": "F1 Score \u2014 Wikipedia"}, {"url": "https://medium.com/tag/confusion-matrix?source=post_page-----8061c9270011---------------confusion_matrix-----------------", "anchor_text": "Confusion Matrix"}, {"url": "https://medium.com/tag/precision-recall?source=post_page-----8061c9270011---------------precision_recall-----------------", "anchor_text": "Precision Recall"}, {"url": "https://medium.com/tag/f1-score?source=post_page-----8061c9270011---------------f1_score-----------------", "anchor_text": "F1 Score"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----8061c9270011---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/evaluation-metric?source=post_page-----8061c9270011---------------evaluation_metric-----------------", "anchor_text": "Evaluation Metric"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F8061c9270011&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-confusion-matrix-precision-recall-and-f1-score-8061c9270011&user=Pratheesh+Shivaprasad&userId=d04fc11ce21&source=-----8061c9270011---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F8061c9270011&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-confusion-matrix-precision-recall-and-f1-score-8061c9270011&user=Pratheesh+Shivaprasad&userId=d04fc11ce21&source=-----8061c9270011---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F8061c9270011&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-confusion-matrix-precision-recall-and-f1-score-8061c9270011&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----8061c9270011--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F8061c9270011&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-confusion-matrix-precision-recall-and-f1-score-8061c9270011&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----8061c9270011---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----8061c9270011--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----8061c9270011--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----8061c9270011--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----8061c9270011--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----8061c9270011--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----8061c9270011--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----8061c9270011--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----8061c9270011--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@Pratheesh_S?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@Pratheesh_S?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Pratheesh Shivaprasad"}, {"url": "https://medium.com/@Pratheesh_S/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "87 Followers"}, {"url": "http://linkedin.com/in/pratheesh-s", "anchor_text": "linkedin.com/in/pratheesh-s"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fd04fc11ce21&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-confusion-matrix-precision-recall-and-f1-score-8061c9270011&user=Pratheesh+Shivaprasad&userId=d04fc11ce21&source=post_page-d04fc11ce21--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F6d65ea666fc8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-confusion-matrix-precision-recall-and-f1-score-8061c9270011&newsletterV3=d04fc11ce21&newsletterV3Id=6d65ea666fc8&user=Pratheesh+Shivaprasad&userId=d04fc11ce21&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}