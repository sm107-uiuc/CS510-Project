{"url": "https://towardsdatascience.com/learn-opencv-by-implementing-a-face-mask-detector-9eb2c8f2624f", "time": 1683016606.808518, "path": "towardsdatascience.com/learn-opencv-by-implementing-a-face-mask-detector-9eb2c8f2624f/", "webpage": {"metadata": {"title": "Learn OpenCV by implementing a face mask detector. | by Brendan Ferris | Towards Data Science", "h1": "Learn OpenCV by implementing a face mask detector.", "description": "First, make a new directory for the project files. Inside of the directory, let\u2019s make a virtual environment to download the necessary packages. If you do not have virtualenv you should run the first\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.mygreatlearning.com/blog/author/hussain/", "anchor_text": "Hussain Mujtaba", "paragraph_index": 0}, {"url": "https://www.mygreatlearning.com/blog/real-time-face-detection/", "anchor_text": "here", "paragraph_index": 0}, {"url": "https://virtualenv.pypa.io/en/latest/", "anchor_text": "virtualenv", "paragraph_index": 2}, {"url": "https://www.cs.cmu.edu/~efros/courses/LBMV07/Papers/viola-cvpr-01.pdf", "anchor_text": "this paper", "paragraph_index": 6}, {"url": "https://lh3.googleusercontent.com/proxy/smD9UsMjhOgk5A_o2qyTTVhgHSfwPC5QD4SqiFurDPq2QJTivLAdrrZdN5NxiRIlbqQLr5P_nJNNhfwd9VK23Plq-Iave-bB3X8PR_4yGMMGAbHpCBRXQ6vO1n-Y2C81CBSpLP0URjXON1eJZuMUMIkBGvIOyqkCAmJ3H5Hk8Pd_m3jrUG26Wu8", "anchor_text": "digital camera that drew bounding boxes around faces in the viewfinder", "paragraph_index": 6}, {"url": "https://en.wikipedia.org/wiki/Haar_wavelet", "anchor_text": "Haar Features", "paragraph_index": 7}, {"url": "https://computersciencesource.wordpress.com/2010/09/03/computer-vision-the-integral-image/", "anchor_text": "integral images was introduced", "paragraph_index": 10}, {"url": "https://fileinfo.com/extension/mjpg", "anchor_text": ".mjpg", "paragraph_index": 12}, {"url": "http://184.153.36.118:82/mjpg/video.mjpg", "anchor_text": "Here", "paragraph_index": 13}, {"url": "https://github.com/opencv/opencv/tree/master/data/haarcascades", "anchor_text": "Haar Classifier", "paragraph_index": 14}, {"url": "https://www.mygreatlearning.com/blog/real-time-face-detection/", "anchor_text": "here", "paragraph_index": 14}, {"url": "https://github.com/opencv/opencv/blob/master/data/haarcascades/haarcascade_profileface.xml", "anchor_text": "haarcascade_profileface.xml", "paragraph_index": 17}, {"url": "https://docs.opencv.org/3.4/dc/d88/tutorial_traincascade.html", "anchor_text": "train a custom Haar Classifier", "paragraph_index": 18}, {"url": "https://github.com/brenfrrs/face_mask_detection", "anchor_text": "here", "paragraph_index": 19}, {"url": "https://brendanferris.com", "anchor_text": "website", "paragraph_index": 20}], "all_paragraphs": ["In this article, we are going to implement a pre-trained TensorFlow face mask detection model originally developed by Hussain Mujtaba. Some of the code and TensorFlow model training information can be found in his article here.", "To begin, let\u2019s go through some of the basics of OpenCV.", "First, make a new directory for the project files. Inside of the directory, let\u2019s make a virtual environment to download the necessary packages. If you do not have virtualenv you should run the first line of code, otherwise, skip the first line.", "Now that our environment is created we can activate it by typing:", "Inside of our virtual environment, lets download the necessary packages:", "Now that we have all of our packages installed, let\u2019s add some files and folders to our directory.", "First introduced as an object detection method in 2001 by Paul Viola and Michael Jones in this paper, the Viola Jones Algorithm is one of the most efficient and computationally inexpensive facial recognition algorithms. Despite being almost 20 years old, it is still widely used. In fact, if you have ever used a digital camera that drew bounding boxes around faces in the viewfinder, chances are it was utilizing this algorithm.", "The algorithm is trained on thousands of positive (with a face) and negative images (without a face), and uses Haar Features to calculate the difference between different regions of an image. These calculations are made by subtracting pixel values from different regions within a specified area.", "Let\u2019s say we have an image. In order to reduce computation time we convert that image to grayscale:", "Let\u2019s look at how our computer is \u2018seeing\u2019 the corner of Obama\u2019s mouth:", "Adding and subtracting all of these regions would be too computationally expensive to do in real time, and in order to solve this problem the concept of integral images was introduced. Each pixel in an integral image is calculated by adding all pixels up and to the left of a specific point in the original image. The integral image can the be used to quickly calculate the specific areas of the input image, as opposed to having to make repeated sweeps over all pixels every pass over the image.", "In order to make detections, the each feature is tested against and input image. In the beginning, the decision thresholds for the features a low, meaning that some faces will be detected, and some other things will be detected as well. A typical Haar classifier will have around 6,000 features, and as goes further and further through the features, it gets more and more picky. So it may let noise through when checking the first 10 features, but if the 11th feature rejects the image, then the classifier also rejects the image. This allows the algorithm to be fast and efficient.", "To see this in action we are going to implement a face mask detector on a public IP camera stream. These are older security/surveillance cameras hooked up to the internet either without passwords, or without changing the default passwords on devices with known security issues. You can implement computer vision on some of these streams, because they transfer data in the form of a .mjpg, which can be loaded into OpenCV with the following method:", "Here is the stream we are going to use. It appears to be a doorbell camera facing towards the street. We are going to write some functions that place screenshots from this video feed into the folders with_mask and without_mask. When our program detects a person, it will take a screenshot and place the resulting screenshot.jpg in the proper folder. It will also compile a .csv with the relevant classification, time, prediction confidence (of the TensorFlow mask detection model), and file path to the image of the observation.", "In your \u2018models\u2019 folder, you will need two things: the Haar Classifier (which is an XML document that you then load into OpenCV), and the trained TensorFlow model, which can be found here.", "We will then add an infinite while loop, that will repeatedly grab the images from the .mjpg stream, and search for faces with the Haar Cascade Classifier. If the Haar Cascade matches a face, the pre-trained TensorFlow model will predict whether the person is or isn\u2019t wearing a mask, and the cycle repeats.", "If you run the code from this article, you will see that it does an ok job of properly classifying people with and without masks. But, the model often captures random areas of the screen as either \u2018mask\u2019 or \u2018no mask\u2019 predictions, leading to a high number of false observations.", "This is because the default Haar Cascade we are using was trained for frontal face positions. There are other trained classifiers, including haarcascade_profileface.xml, which may offer marginal improvements on performance. Note: the profileface.xml classifier linked above was trained on left-side profiles.", "To improve classification performance, it would be interesting to train a custom Haar Classifier to detect some combination of profile and frontal facial positions. Stay tuned!", "The GitHub repo can be found here.", "\ud83d\udcbb Feel free to check out my website.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Turning over rocks and seeing what crawls out."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F9eb2c8f2624f&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flearn-opencv-by-implementing-a-face-mask-detector-9eb2c8f2624f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flearn-opencv-by-implementing-a-face-mask-detector-9eb2c8f2624f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flearn-opencv-by-implementing-a-face-mask-detector-9eb2c8f2624f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flearn-opencv-by-implementing-a-face-mask-detector-9eb2c8f2624f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----9eb2c8f2624f--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----9eb2c8f2624f--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://brendanfrrs.medium.com/?source=post_page-----9eb2c8f2624f--------------------------------", "anchor_text": ""}, {"url": "https://brendanfrrs.medium.com/?source=post_page-----9eb2c8f2624f--------------------------------", "anchor_text": "Brendan Ferris"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F1375306f0dd2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flearn-opencv-by-implementing-a-face-mask-detector-9eb2c8f2624f&user=Brendan+Ferris&userId=1375306f0dd2&source=post_page-1375306f0dd2----9eb2c8f2624f---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F9eb2c8f2624f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flearn-opencv-by-implementing-a-face-mask-detector-9eb2c8f2624f&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F9eb2c8f2624f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flearn-opencv-by-implementing-a-face-mask-detector-9eb2c8f2624f&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@visuals?utm_source=medium&utm_medium=referral", "anchor_text": "visuals"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://www.mygreatlearning.com/blog/author/hussain/", "anchor_text": "Hussain Mujtaba"}, {"url": "https://www.mygreatlearning.com/blog/real-time-face-detection/", "anchor_text": "here"}, {"url": "https://virtualenv.pypa.io/en/latest/", "anchor_text": "virtualenv"}, {"url": "https://www.cs.cmu.edu/~efros/courses/LBMV07/Papers/viola-cvpr-01.pdf", "anchor_text": "this paper"}, {"url": "https://lh3.googleusercontent.com/proxy/smD9UsMjhOgk5A_o2qyTTVhgHSfwPC5QD4SqiFurDPq2QJTivLAdrrZdN5NxiRIlbqQLr5P_nJNNhfwd9VK23Plq-Iave-bB3X8PR_4yGMMGAbHpCBRXQ6vO1n-Y2C81CBSpLP0URjXON1eJZuMUMIkBGvIOyqkCAmJ3H5Hk8Pd_m3jrUG26Wu8", "anchor_text": "digital camera that drew bounding boxes around faces in the viewfinder"}, {"url": "https://en.wikipedia.org/wiki/Haar_wavelet", "anchor_text": "Haar Features"}, {"url": "https://www.loc.gov/item/2017645540/.", "anchor_text": "https://www.loc.gov/item/2017645540/."}, {"url": "https://computersciencesource.wordpress.com/2010/09/03/computer-vision-the-integral-image/", "anchor_text": "integral images was introduced"}, {"url": "https://fileinfo.com/extension/mjpg", "anchor_text": ".mjpg"}, {"url": "http://184.153.36.118:82/mjpg/video.mjpg", "anchor_text": "http://184.153.36.118:82/mjpg/video.mjpg"}, {"url": "http://184.153.36.118:82/mjpg/video.mjpg", "anchor_text": "Here"}, {"url": "https://github.com/opencv/opencv/tree/master/data/haarcascades", "anchor_text": "Haar Classifier"}, {"url": "https://www.mygreatlearning.com/blog/real-time-face-detection/", "anchor_text": "here"}, {"url": "https://github.com/opencv/opencv/blob/master/data/haarcascades/haarcascade_profileface.xml", "anchor_text": "haarcascade_profileface.xml"}, {"url": "https://docs.opencv.org/3.4/dc/d88/tutorial_traincascade.html", "anchor_text": "train a custom Haar Classifier"}, {"url": "https://github.com/brenfrrs/face_mask_detection", "anchor_text": "here"}, {"url": "https://brendanferris.com", "anchor_text": "website"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F9eb2c8f2624f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flearn-opencv-by-implementing-a-face-mask-detector-9eb2c8f2624f&user=Brendan+Ferris&userId=1375306f0dd2&source=-----9eb2c8f2624f---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F9eb2c8f2624f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flearn-opencv-by-implementing-a-face-mask-detector-9eb2c8f2624f&user=Brendan+Ferris&userId=1375306f0dd2&source=-----9eb2c8f2624f---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F9eb2c8f2624f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flearn-opencv-by-implementing-a-face-mask-detector-9eb2c8f2624f&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----9eb2c8f2624f--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F9eb2c8f2624f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flearn-opencv-by-implementing-a-face-mask-detector-9eb2c8f2624f&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----9eb2c8f2624f---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----9eb2c8f2624f--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----9eb2c8f2624f--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----9eb2c8f2624f--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----9eb2c8f2624f--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----9eb2c8f2624f--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----9eb2c8f2624f--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----9eb2c8f2624f--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----9eb2c8f2624f--------------------------------", "anchor_text": ""}, {"url": "https://brendanfrrs.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://brendanfrrs.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Brendan Ferris"}, {"url": "https://brendanfrrs.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "180 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F1375306f0dd2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flearn-opencv-by-implementing-a-face-mask-detector-9eb2c8f2624f&user=Brendan+Ferris&userId=1375306f0dd2&source=post_page-1375306f0dd2--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F10f30125013d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flearn-opencv-by-implementing-a-face-mask-detector-9eb2c8f2624f&newsletterV3=1375306f0dd2&newsletterV3Id=10f30125013d&user=Brendan+Ferris&userId=1375306f0dd2&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}