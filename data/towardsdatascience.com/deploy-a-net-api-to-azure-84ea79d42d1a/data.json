{"url": "https://towardsdatascience.com/deploy-a-net-api-to-azure-84ea79d42d1a", "time": 1683005026.430633, "path": "towardsdatascience.com/deploy-a-net-api-to-azure-84ea79d42d1a/", "webpage": {"metadata": {"title": "Deploy a .NET API to Azure. Create a SQL database and Serve your\u2026 | by Richard Peterson | Towards Data Science", "h1": "Deploy a .NET API to Azure", "description": "This article is the fourth in a series dedicated to building a .NET API for the Angular Tour Of Heroes tutorial. You can pull a working local development version of the Angular App, .NET API, and a\u2026"}, "outgoing_paragraph_urls": [{"url": "https://github.com/rchardptrsn/MSSQL-Docker-Container", "anchor_text": "Docker MSSQL", "paragraph_index": 1}, {"url": "https://github.com/rchardptrsn/TourOfHeroes-dotNETCore", "anchor_text": "my GitHub repo", "paragraph_index": 1}, {"url": "https://towardsdatascience.com/net-core-api-dive-into-c-27dcd4170066", "anchor_text": "build it yourself", "paragraph_index": 1}, {"url": "https://docs.microsoft.com/en-us/azure/app-service/containers/quickstart-dotnetcore", "anchor_text": "this awesome Microsoft tutorial", "paragraph_index": 2}, {"url": "https://github.com/rchardptrsn/TourOfHeroes-dotNETCore", "anchor_text": "my GitHub repo.", "paragraph_index": 4}, {"url": "https://docs.microsoft.com/en-us/cli/azure/group?view=azure-cli-latest", "anchor_text": "az group", "paragraph_index": 9}, {"url": "https://docs.microsoft.com/en-us/azure/app-service/app-service-web-tutorial-dotnetcore-sqldb", "anchor_text": "the Azure docs", "paragraph_index": 24}, {"url": "https://docs.microsoft.com/en-us/cli/azure/webapp?view=azure-cli-latest#az-webapp-create", "anchor_text": "az webapp create", "paragraph_index": 28}, {"url": "https://heroes-api.azurewebsites.net/api/Heroes", "anchor_text": "https://heroes-api.azurewebsites.net/api/Heroes", "paragraph_index": 39}, {"url": "https://medium.com/swlh/deploy-an-angular-app-to-azure-955f0c750686?source=friends_link&sk=170255924d9bc3f99a9e5ab13878a4ba", "anchor_text": "Tour of Heroes app", "paragraph_index": 40}, {"url": "https://medium.com/swlh/deploy-an-angular-app-to-azure-955f0c750686", "anchor_text": "my article!", "paragraph_index": 44}, {"url": "https://docs.microsoft.com/en-us/azure/app-service/app-service-web-tutorial-dotnetcore-sqldb", "anchor_text": "this Azure tutorial", "paragraph_index": 46}], "all_paragraphs": ["This article is the fourth in a series dedicated to building a .NET API for the Angular Tour Of Heroes tutorial.", "You can pull a working local development version of the Angular App, .NET API, and a Docker MSSQL database from my GitHub repo, or build it yourself by following the previous article in this series.", "Now, let\u2019s deploy our .NET API to Azure! I must give credit to this awesome Microsoft tutorial that goes into great detail about this process.", "You will need two crucial pieces of software:", "When these have been installed, pull the local version of the .NET API from my GitHub repo. Navigate to the Heroes.API directory from the command line and run the .NET Core program by running dotnet run. Once you confirm it runs on your system, stop the program.", "Since you downloaded the project from GitHub, it came with a .git hidden folder, which we will need to remove. Go up one level from Heroes.API so that you can see all 3 folders that comprise the total app. Show the hidden folder .git folder and delete or run sudo rm -r .git from a linux or mac system.", "Then, navigate back to the Heroes.API directory by typing cd Heroes.API. Run ls to make sure you see all the folders you expected.", "We need to initialize a new git repository that we will push to an Azure remote repository. Run this from the Heroes.API directory:", "Login to the Azure CLI by running az login.", "Create a Resource Group named HeroesAPIgroup to house your resources with az group command.", "Create a SQL server in your resource group name heroesSQLdb by running", "You will get a JSON output of the deployment details when complete.", "Configure a firewall for your server by running:", "Create a heroes database on your newly created SQL server.", "To add a table to your heroes database, we will need to login to the Azure portal and find your HeroesAPIgroup Resource Group, and click on your heroes SQL database.", "Go to the Query Editor and attempt to enter your SQL database using the username and password from when you created the SQL server. It should fail as your local IP address has not been given access to the server, per your firewall rule.", "Go back to your heroes database overview. Click on Set server firewall.", "From the firewall settings, click on Add Client IP. Now, you should be able to access the SQL server from your home or office IP address location.", "Now, enter the SQL database using your username and password from the Query Editor.", "When you are logged into the SQL Server, run the below query to add a table and insert sample data into the database.", "We have a database! Let\u2019s copy out the connection string for use later. From Overview, click on Connection Strings, and copy the .NET connection string provided. Mine looked like this:", "Replace {your_password} with the password you chose for the admin.", "We are not going to insert this connection string into our app. Once we have deployed the app, we are going to configure a connection for the app using az webapp config, which will take precedence over the connection string in appsettings.json. We will create this app-level connection string after we create the web app, so hang on to that connection string.", "We will need to configure a deployment user with authorization to push git repositories to Azure. Create a user now:", "You will get JSON output if this is successful. If you get errors, the Azure docs say: If you get a 'Conflict'. Details: 409 error, change the username. If you get a 'Bad Request'. Details: 400 error, use a stronger password.", "The app service plan will determine the size of the virtual machine that is created to run your app. We will use the free linux tier of the app service plan.", "Create a web app that will operate within the terms of your app service plan.", "First, we need to check what runtimes are available. Run:", "Choose the DOTNET| runtime that will work for your code. We are going with \u201cDOTNETCORE|3.0\u201d. Create the web app with the az webapp create command. I highly recommend reading the Azure docs on this versatile command.", "The first thing you will see when the app has been created is the URL for the git remote. It is very important you save this! We will need this URL to push your local git repository to Azure.", "My git repo URL. (Don\u2019t worry this project will be deleted before publishing the article).", "Remember that connection string from we saved after setting up the SQL server? We will now use it to set a connection string at the app level. This will take precedence over the current connection string which points to a local docker mssql database. Don\u2019t forget to replace {your_strong_password} with the password for your Admin.", "We need to set an environment variable so that our .NET API knows to connect to an Azure SQL database when it is in a Production environment, rather than the local docker database used for development.", "Now, we need to make some changes to our code in the .NET API to read the environment variable, and choose the Azure database or the Docker database accordingly.", "Modify ConfigureServices in Startup.cs to first look for the environment variable ASPNETCORE_ENVIRONMENT, and lacking that variable, choose the local Docker database.", "Save your changes, and don\u2019t forget to commit the git repo.", "Your app is ready for production deployment. Let\u2019s push our git repository to the remote Azure repository that our web app is looking at for providing code. Add the git repo URL that we saved after we created the web app.", "Push your git repo to the Azure remote repo to deploy your app. When you run the below command, it will ask you for credentials. Enter the password for the deployment user we created, not your Azure login!", "You did it! You deployed your app! Now let\u2019s test it out. Browse to the heroes-api App Service Overview and copy the API URL endpoint. It should look something like this:", "Send a GET request to https://heroes-api.azurewebsites.net/api/Heroes, and observe the JSON output of all the pre-loaded heroes! Success!", "Open the Tour of Heroes app and go to src/app/hero.service.ts.", "Under the HeroService class, comment out the URL to the local .NET API, and replace localhost:5000 with the API URL endpoint from Azure. Your connection string will look like this:", "Launch your angular app by running:", "You did it! You have a Frontend, Backend, and a database!", "To deploy your Angular app to Azure, you can jump to my article!", "Make sure you remember to swap out the connection string in HeroService.", "Thank you for reading this far! I hope this article makes it easy for you to deploy to Azure, and if you need more explanation, this Azure tutorial really goes into detail!", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "SQL CSI by day and Northwestern University Master\u2019s in Public Policy Student by night"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F84ea79d42d1a&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeploy-a-net-api-to-azure-84ea79d42d1a&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeploy-a-net-api-to-azure-84ea79d42d1a&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeploy-a-net-api-to-azure-84ea79d42d1a&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeploy-a-net-api-to-azure-84ea79d42d1a&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----84ea79d42d1a--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----84ea79d42d1a--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://desertdata.medium.com/?source=post_page-----84ea79d42d1a--------------------------------", "anchor_text": ""}, {"url": "https://desertdata.medium.com/?source=post_page-----84ea79d42d1a--------------------------------", "anchor_text": "Richard Peterson"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F11303b53d014&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeploy-a-net-api-to-azure-84ea79d42d1a&user=Richard+Peterson&userId=11303b53d014&source=post_page-11303b53d014----84ea79d42d1a---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F84ea79d42d1a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeploy-a-net-api-to-azure-84ea79d42d1a&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F84ea79d42d1a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeploy-a-net-api-to-azure-84ea79d42d1a&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@rollnik?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Rollnik"}, {"url": "https://unsplash.com/s/photos/cloud?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://towardsdatascience.com/net-core-api-for-the-angular-tour-of-heroes-app-5895a36d2129", "anchor_text": "Set up our environment."}, {"url": "https://towardsdatascience.com/build-a-mssql-docker-container-800166ecca21", "anchor_text": "Built a MSSQL Docker container database"}, {"url": "https://towardsdatascience.com/net-core-api-dive-into-c-27dcd4170066", "anchor_text": "Wrote a .NET API"}, {"url": "https://github.com/rchardptrsn/MSSQL-Docker-Container", "anchor_text": "Docker MSSQL"}, {"url": "https://github.com/rchardptrsn/TourOfHeroes-dotNETCore", "anchor_text": "my GitHub repo"}, {"url": "https://towardsdatascience.com/net-core-api-dive-into-c-27dcd4170066", "anchor_text": "build it yourself"}, {"url": "https://docs.microsoft.com/en-us/azure/app-service/containers/quickstart-dotnetcore", "anchor_text": "this awesome Microsoft tutorial"}, {"url": "https://unsplash.com/@cassiesmart19?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Cassie Smart"}, {"url": "https://unsplash.com/s/photos/sahara?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://docs.microsoft.com/bs-latn-ba/cli/azure/install-azure-cli?view=azure-cli-latest", "anchor_text": "Azure Command Line Interface"}, {"url": "https://dotnet.microsoft.com/download/dotnet-core", "anchor_text": ".NET Core"}, {"url": "https://github.com/rchardptrsn/TourOfHeroes-dotNETCore", "anchor_text": "my GitHub repo."}, {"url": "https://docs.microsoft.com/en-us/cli/azure/group?view=azure-cli-latest", "anchor_text": "az group"}, {"url": "https://docs.microsoft.com/en-us/azure/app-service/app-service-web-tutorial-dotnetcore-sqldb", "anchor_text": "the Azure docs"}, {"url": "https://docs.microsoft.com/en-us/cli/azure/webapp?view=azure-cli-latest#az-webapp-create", "anchor_text": "az webapp create"}, {"url": "https://DeploymentUser420@heroes-api.scm.azurewebsites.net/heroes-api.git'", "anchor_text": "https://DeploymentUser420@heroes-api.scm.azurewebsites.net/heroes-api.git'"}, {"url": "https://heroes-api.azurewebsites.net/api/Heroes", "anchor_text": "https://heroes-api.azurewebsites.net/api/Heroes"}, {"url": "https://medium.com/swlh/deploy-an-angular-app-to-azure-955f0c750686?source=friends_link&sk=170255924d9bc3f99a9e5ab13878a4ba", "anchor_text": "Tour of Heroes app"}, {"url": "https://medium.com/swlh/deploy-an-angular-app-to-azure-955f0c750686", "anchor_text": "my article!"}, {"url": "https://docs.microsoft.com/en-us/azure/app-service/app-service-web-tutorial-dotnetcore-sqldb", "anchor_text": "this Azure tutorial"}, {"url": "https://medium.com/tag/dotnet?source=post_page-----84ea79d42d1a---------------dotnet-----------------", "anchor_text": "Dotnet"}, {"url": "https://medium.com/tag/azure?source=post_page-----84ea79d42d1a---------------azure-----------------", "anchor_text": "Azure"}, {"url": "https://medium.com/tag/cloud?source=post_page-----84ea79d42d1a---------------cloud-----------------", "anchor_text": "Cloud"}, {"url": "https://medium.com/tag/api?source=post_page-----84ea79d42d1a---------------api-----------------", "anchor_text": "API"}, {"url": "https://medium.com/tag/sql?source=post_page-----84ea79d42d1a---------------sql-----------------", "anchor_text": "Sql"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F84ea79d42d1a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeploy-a-net-api-to-azure-84ea79d42d1a&user=Richard+Peterson&userId=11303b53d014&source=-----84ea79d42d1a---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F84ea79d42d1a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeploy-a-net-api-to-azure-84ea79d42d1a&user=Richard+Peterson&userId=11303b53d014&source=-----84ea79d42d1a---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F84ea79d42d1a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeploy-a-net-api-to-azure-84ea79d42d1a&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----84ea79d42d1a--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F84ea79d42d1a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeploy-a-net-api-to-azure-84ea79d42d1a&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----84ea79d42d1a---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----84ea79d42d1a--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----84ea79d42d1a--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----84ea79d42d1a--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----84ea79d42d1a--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----84ea79d42d1a--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----84ea79d42d1a--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----84ea79d42d1a--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----84ea79d42d1a--------------------------------", "anchor_text": ""}, {"url": "https://desertdata.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://desertdata.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Richard Peterson"}, {"url": "https://desertdata.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "557 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F11303b53d014&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeploy-a-net-api-to-azure-84ea79d42d1a&user=Richard+Peterson&userId=11303b53d014&source=post_page-11303b53d014--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F28110602750b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeploy-a-net-api-to-azure-84ea79d42d1a&newsletterV3=11303b53d014&newsletterV3Id=28110602750b&user=Richard+Peterson&userId=11303b53d014&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}