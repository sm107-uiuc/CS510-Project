{"url": "https://towardsdatascience.com/optimising-a-fasttext-model-for-better-accuracy-739ca134100a", "time": 1683001767.935761, "path": "towardsdatascience.com/optimising-a-fasttext-model-for-better-accuracy-739ca134100a/", "webpage": {"metadata": {"title": "Optimising a fastText model for better accuracy | by Sunny Srinidhi | Towards Data Science", "h1": "Optimising a fastText model for better accuracy", "description": "In our previous post, we saw what n-grams are and how they are useful. Before that post, we built a simple text classifier using Facebook\u2019s fastText library. In this post, we\u2019ll see how we can\u2026"}, "outgoing_paragraph_urls": [{"url": "https://blog.contactsunny.com/data-science/understanding-word-n-grams-and-n-gram-probability-in-natural-language-processing", "anchor_text": "what n-grams are and how they are useful", "paragraph_index": 0}, {"url": "https://blog.contactsunny.com/data-science/an-intro-to-text-classification-with-facebooks-fasttext-natural-language-processing", "anchor_text": "simple text classifier using Facebook\u2019s fastText library", "paragraph_index": 0}, {"url": "https://blog.contactsunny.com/data-science/an-intro-to-text-classification-with-facebooks-fasttext-natural-language-processing", "anchor_text": "intro to fastText post", "paragraph_index": 3}, {"url": "https://blog.contactsunny.com/data-science/how-to-split-your-dataset-to-train-and-test-datasets", "anchor_text": "split this to test and train datasets", "paragraph_index": 8}, {"url": "https://blog.contactsunny.com/data-science/understanding-word-n-grams-and-n-gram-probability-in-natural-language-processing", "anchor_text": "n-grams", "paragraph_index": 20}, {"url": "https://twitter.com/contactsunny", "anchor_text": "Twitter", "paragraph_index": 21}, {"url": "https://blog.contactsunny.com/tag/data-science", "anchor_text": "Data Science", "paragraph_index": 21}, {"url": "https://blog.contactsunny.com/tag/machine-learning", "anchor_text": "Machine Learning", "paragraph_index": 21}, {"url": "https://blog.contactsunny.com/category/tech", "anchor_text": "tech updates", "paragraph_index": 21}, {"url": "https://blog.contactsunny.com/", "anchor_text": "follow my personal blog", "paragraph_index": 21}], "all_paragraphs": ["In our previous post, we saw what n-grams are and how they are useful. Before that post, we built a simple text classifier using Facebook\u2019s fastText library. In this post, we\u2019ll see how we can optimise that model for better accuracy.", "Precision and recall are two things we need to know to better understand the accuracy of our models. And these two things are not very difficult to understand. Precision is the number of correct labels that were predicted by the fastText model, and recall is the number of labels, out of the correct labels, that were successfully predicted. That might be a bit confusing, so let\u2019s look at an example to understand it better.", "Suppose for a sentence that we gave the model for classification, from our Stack Exchange cooking sample, of course, the model predicted the labels food-safety, baking, equipment, substitutions, and bread. And the actual labels in Stack Exchange are equipment, cleaning, and knives. Here, out of the top five labels that the model predicted, only one is correct. So the precision becomes 1 / 5, or 0.20. Also, out of the three correct labels, the model correctly predicted only one label (equipment), so the recall is 1 / 3 or 0.33. That is what precision and recall mean.", "There\u2019s a way for us to test the precision and recall of our model using a simple command in fastText. At this point, make sure you have gone through the intro to fastText post I\u2019ve written earlier because I\u2019ll be using the same example from that post here. Assuming that you\u2019ve done that, and hoping that you have the data from that post, we\u2019ll run the following command in the root directory to get our precision and recall data:", "Once you run this command, you should get an output similar to the following:", "As you can see from the output, we have the P@1 and R@1 results, which is nothing but precision at 1 and recall at 1. We\u2019ll see how we can improve these in this post.", "If you look at the data file we have, you can see that there are some uppercase alphabets. These are not significant for our model, and we can get rid of those to improve the performance to some extent. But we can\u2019t go through the entire data and clean it. So we\u2019ll use a simple command to convert all uppercase letters to lowercase letters. Run the following command to do that:", "In this command, we are cat-ing the file to print the data to the standard output, using a pipe to redirect that data to the sed command to run the regular expression on the input data, and then using another pipe to run this new output to the translate command to convert all uppercase alphabets to lowercase alphabets. We\u2019re redirecting this final output to a file called \u2018cooking.preprocessed.txt.\u2019 This is again a simple example provided on the official fastText website. In a real life production scenario, this might not be so simple of a task. Anyway, once we have this new pre-processed file, let\u2019s see what it has.", "As you can see, the data is much cleaner now. Now, we have to again split this to test and train datasets. We\u2019ll run the following two commands to do that:", "We have to again train our model on this new data because we have changed the data. To do that, we\u2019ll run the following command and the output should be something similar to what you see here:", "To check the precision and recall, we\u2019ll test this model on the new test data:", "As you can see, both the precision and the recall have improved a bit. One more thing to observe here is that when we trained the model with the new data, we saw only 8921 words, whereas the last time, we saw 14492 words. So the model had multiple variations of the same words due to uppercase and lowercase variations, which could decrease the precision to some extent.", "If you have a software development background, you know epoch has something to do with time. You\u2019d be right. In this context, epoch is the number of times a model sees a phrase or an example input. By default, the model sees an example five times, i.e., epoch = 5. Because our dataset only has around 12k samples, 5 epochs are less. We can increase that to 25 using the -ecpoch option to make the model \u2018see\u2019 an example sentence 25 times, which can help the model in learning better. Let\u2019s try that now:", "You might have noticed that it took a bit longer for the process to finish now, which is expected as we increased the epoch. Anyway, let\u2019s now test our model for precision:", "As you see, we have some significant improvement in the precision and recall. That\u2019s good.", "Learning rate of an algorithm indicates how much the model changes after each example sentence is processed. We can both increase and decrease the learning rate of an algorithm. A learning rate of 0 means that there is no change in learning, or the rate of change is just 0, so the model doesn\u2019t change at all. A usual learning rate is 0.1 to 1. For our example here, we\u2019ll keep the learning rate at 1 and re-train our model. We\u2019ll use the -lr option for this:", "We\u2019ll test the model again to see if there\u2019s any improvement after changing the learning rate:", "There definitely is an improvement. But what would happen if we increase the epochs and the learning rate together?", "Now, we\u2019ll keep the epoch at 25 and the learning rate at 1. Let\u2019s see what happens to the precision and the recall:", "We can easily see the improvement here.", "So, we learned a lot in this post (I hope). There\u2019s more to do though (such as n-grams). We\u2019ll see this in future posts. If you have anything to add to this, please leave a comment below.", "Follow me on Twitter for more Data Science, Machine Learning, and general tech updates. Also, you can follow my personal blog.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F739ca134100a&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Foptimising-a-fasttext-model-for-better-accuracy-739ca134100a&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Foptimising-a-fasttext-model-for-better-accuracy-739ca134100a&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Foptimising-a-fasttext-model-for-better-accuracy-739ca134100a&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Foptimising-a-fasttext-model-for-better-accuracy-739ca134100a&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----739ca134100a--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----739ca134100a--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://contactsunny.medium.com/?source=post_page-----739ca134100a--------------------------------", "anchor_text": ""}, {"url": "https://contactsunny.medium.com/?source=post_page-----739ca134100a--------------------------------", "anchor_text": "Sunny Srinidhi"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F6691923bb149&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Foptimising-a-fasttext-model-for-better-accuracy-739ca134100a&user=Sunny+Srinidhi&userId=6691923bb149&source=post_page-6691923bb149----739ca134100a---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F739ca134100a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Foptimising-a-fasttext-model-for-better-accuracy-739ca134100a&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F739ca134100a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Foptimising-a-fasttext-model-for-better-accuracy-739ca134100a&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://towardsdatascience.com/tagged/the-fasttext-series", "anchor_text": "The fastText Series"}, {"url": "https://blog.contactsunny.com/data-science/optimising-a-fasttext-model-for-better-accuracy", "anchor_text": "my blog"}, {"url": "https://blog.contactsunny.com/data-science/understanding-word-n-grams-and-n-gram-probability-in-natural-language-processing", "anchor_text": "what n-grams are and how they are useful"}, {"url": "https://blog.contactsunny.com/data-science/an-intro-to-text-classification-with-facebooks-fasttext-natural-language-processing", "anchor_text": "simple text classifier using Facebook\u2019s fastText library"}, {"url": "https://blog.contactsunny.com/data-science/an-intro-to-text-classification-with-facebooks-fasttext-natural-language-processing", "anchor_text": "intro to fastText post"}, {"url": "https://blog.contactsunny.com/data-science/how-to-split-your-dataset-to-train-and-test-datasets", "anchor_text": "split this to test and train datasets"}, {"url": "https://blog.contactsunny.com/data-science/understanding-word-n-grams-and-n-gram-probability-in-natural-language-processing", "anchor_text": "n-grams"}, {"url": "https://twitter.com/contactsunny", "anchor_text": "Twitter"}, {"url": "https://blog.contactsunny.com/tag/data-science", "anchor_text": "Data Science"}, {"url": "https://blog.contactsunny.com/tag/machine-learning", "anchor_text": "Machine Learning"}, {"url": "https://blog.contactsunny.com/category/tech", "anchor_text": "tech updates"}, {"url": "https://blog.contactsunny.com/", "anchor_text": "follow my personal blog"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----739ca134100a---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----739ca134100a---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----739ca134100a---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/technology?source=post_page-----739ca134100a---------------technology-----------------", "anchor_text": "Technology"}, {"url": "https://medium.com/tag/the-fasttext-series?source=post_page-----739ca134100a---------------the_fasttext_series-----------------", "anchor_text": "The Fasttext Series"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F739ca134100a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Foptimising-a-fasttext-model-for-better-accuracy-739ca134100a&user=Sunny+Srinidhi&userId=6691923bb149&source=-----739ca134100a---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F739ca134100a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Foptimising-a-fasttext-model-for-better-accuracy-739ca134100a&user=Sunny+Srinidhi&userId=6691923bb149&source=-----739ca134100a---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F739ca134100a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Foptimising-a-fasttext-model-for-better-accuracy-739ca134100a&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----739ca134100a--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F739ca134100a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Foptimising-a-fasttext-model-for-better-accuracy-739ca134100a&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----739ca134100a---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----739ca134100a--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----739ca134100a--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----739ca134100a--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----739ca134100a--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----739ca134100a--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----739ca134100a--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----739ca134100a--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----739ca134100a--------------------------------", "anchor_text": ""}, {"url": "https://contactsunny.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://contactsunny.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Sunny Srinidhi"}, {"url": "https://contactsunny.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "2.6K Followers"}, {"url": "http://blog.contactsunny.com", "anchor_text": "blog.contactsunny.com"}, {"url": "http://linkedin.com/in/sunnysrinidhi/", "anchor_text": "linkedin.com/in/sunnysrinidhi/"}, {"url": "http://twitter.com/contactsunny", "anchor_text": "twitter.com/contactsunny"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F6691923bb149&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Foptimising-a-fasttext-model-for-better-accuracy-739ca134100a&user=Sunny+Srinidhi&userId=6691923bb149&source=post_page-6691923bb149--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F1d9e5a16cecd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Foptimising-a-fasttext-model-for-better-accuracy-739ca134100a&newsletterV3=6691923bb149&newsletterV3Id=1d9e5a16cecd&user=Sunny+Srinidhi&userId=6691923bb149&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}