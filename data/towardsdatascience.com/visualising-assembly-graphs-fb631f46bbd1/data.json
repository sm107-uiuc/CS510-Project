{"url": "https://towardsdatascience.com/visualising-assembly-graphs-fb631f46bbd1", "time": 1683005171.624199, "path": "towardsdatascience.com/visualising-assembly-graphs-fb631f46bbd1/", "webpage": {"metadata": {"title": "Visualising Assembly Graphs. Visualising Assembly Graphs for\u2026 | by Vijini Mallawaarachchi | Towards Data Science", "h1": "Visualising Assembly Graphs", "description": "I have been working with assembly graphs of metagenomes for a while and I have come across many fascinating things. In this article, I will share with you some of my observations related to\u2026"}, "outgoing_paragraph_urls": [{"url": "https://towardsdatascience.com/genome-assembly-the-holy-grail-of-genome-analysis-fae8fc9ef09c", "anchor_text": "Genome Assembly \u2014 The Holy Grail of Genome Analysis", "paragraph_index": 0}, {"url": "https://rrwick.github.io/Bandage/", "anchor_text": "Bandage", "paragraph_index": 2}, {"url": "http://gfa-spec.github.io/GFA-spec/GFA1.html", "anchor_text": "GFA (Graph Fragment Assembly)", "paragraph_index": 3}, {"url": "http://gfa-spec.github.io/GFA-spec/GFA1.html", "anchor_text": "http://gfa-spec.github.io/GFA-spec/GFA1.html", "paragraph_index": 3}, {"url": "https://towardsdatascience.com/visualising-graph-data-with-python-igraph-b3cc81a495cf", "anchor_text": "previous article", "paragraph_index": 6}, {"url": "https://genome.cshlp.org/content/27/5/824", "anchor_text": "metaSPAdes", "paragraph_index": 7}, {"url": "https://github.com/Vini2/GraphBin/tree/master/test_data/ES_metaSPAdes", "anchor_text": "here", "paragraph_index": 7}, {"url": "https://github.com/Vini2/GraphBin/blob/master/test_data/ES_metaSPAdes/contigs.fasta", "anchor_text": "contigs.fasta", "paragraph_index": 7}, {"url": "https://github.com/Vini2/GraphBin/blob/master/test_data/ES_metaSPAdes/assembly_graph_with_scaffolds.gfa", "anchor_text": "assembly_graph_with_scaffolds.gfa", "paragraph_index": 7}, {"url": "https://github.com/Vini2/GraphBin/blob/master/test_data/ES_metaSPAdes/contigs.paths", "anchor_text": "contigs.paths", "paragraph_index": 8}, {"url": "https://github.com/Vini2/GraphBin/blob/master/test_data/ES_metaSPAdes/assembly_graph_with_scaffolds.gfa", "anchor_text": "assembly_graph_with_scaffolds.gfa", "paragraph_index": 8}, {"url": "https://github.com/lh3/bwa", "anchor_text": "BWA-MEM", "paragraph_index": 10}, {"url": "https://github.com/Vini2/GraphBin", "anchor_text": "here", "paragraph_index": 16}, {"url": "http://dx.doi.org/10.1093/bioinformatics/btaa180", "anchor_text": "10.1093/bioinformatics/btaa180", "paragraph_index": 17}, {"url": "http://vijinimallawaarachchi.com", "anchor_text": "vijinimallawaarachchi.com", "paragraph_index": 21}], "all_paragraphs": ["I have been working with assembly graphs of metagenomes for a while and I have come across many fascinating things. In this article, I will share with you some of my observations related to metagenomic assembly graphs and binning contigs obtained from those graphs. Assuming that you have a basic understanding about genome assembly (if not you can read my previous article Genome Assembly \u2014 The Holy Grail of Genome Analysis), let\u2019s get started.", "An assembly graph is used to represent the final assembly of a genome (or metagenomes). In simple terms, the assembler builds this assembly graph based on reads and their overlap information. Finally, the assembler resolves paths across the assembly graph and outputs non-branching paths as contigs.", "Given below is part of the visualisation of an assembly graph obtained from the tool named Bandage.", "The most common file format used to represent assembly graphs is the GFA (Graph Fragment Assembly) format. A GFA file consists of a set of sequences and tab-delimited pairs of sequences with their overlaps. You can read more about this format from http://gfa-spec.github.io/GFA-spec/GFA1.html.", "As shown in Figure 2, sequences are denoted starting from \u201cS\u201d and overlaps (or links) between sequences are denoted starting from \u201cL\u201d. The plus (+) and minus (-) signs denote whether the original sequence or its reverse complement is considered in the overlap. The value denoted with the letter \u201cM\u201d in a link refers to the overlap length. In this sample file, the overlap length is 55 base pairs.", "Since the assembly graph we are talking about is already a \u201cgraph\u201d, we can model sequences to be vertices and overlaps/links to be edges.", "Now let us visualise a sample assembly graph using python-igraph. You can read more about visualising graph data using python-igraph from my previous article. For the ease of explanation, I will not consider the plus and minus signs in the link information. In simple terms, I will be visualising an undirected graph.", "We will consider a dataset consisting of reads from two bacterial species; E. faecalis and S. aureus. We will refer to this as the ES dataset. I have already assembled this dataset using metaSPAdes assembler to obtain contigs. This contig dataset known as ES+metaSPAdes, can be found from the link here as contigs.fasta. The assembly graph file can be found as assembly_graph_with_scaffolds.gfa.", "Note: metaSPAdes represents each contig as a set of segments and the assembly graph file contains details about these segments and links between these segments. Hence, when obtaining the links between the contigs, you will have to scan the prefix and suffix for each contig in the contigs.paths file and the assembly_graph_with_scaffolds.gfa file to determine the prefix or suffix of the overlapping contig.", "The visualisation of the ES+metaSPAdes dataset will look as follows.", "We can align the contigs to reference genomes to determine to which genome each contig belong to. For this, we can use BWA-MEM. Given below is a sample command to run BWA-MEM.", "For each contig, the reference genome resulting in the longest alignment length can be considered as the contig\u2019s source.", "After determining the ground truth of the contigs, we can label the vertices (contigs) and visualise this data as shown in Figure 4.", "As illustrated in Figure 5, we can see that the contigs from the two species tend to form two separate regions in the assembly graph.", "Moreover, it is highly likely that contigs belonging to the same species tend to have overlaps among each other, apart from the boundary cases. We can make use of these data during binning analysis.", "Here are some code snippets used to produce the images I have presented in this article.", "My lab and I have developed a tool named GraphBin to refine binned contigs by making use of assembly graphs and the connectivity information between contigs. You can find the GitHub repo from here.", "GraphBin is published in the OUP Bioinformatics journal. You can have a look at the publication for more information about the tool from DOI: 10.1093/bioinformatics/btaa180.", "You can also read more on genome assembly and metagenomics from my previous articles listed below.", "Hope you found my findings interesting. I would love to hear your thoughts.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Bioinformatician | Computational Genomics \ud83e\uddec | Data Science \ud83d\udc69\ud83c\udffb\u200d\ud83d\udcbb | Music \ud83c\udfb5 | Astronomy \ud83d\udd2d | Travel \ud83c\udf92 | vijinimallawaarachchi.com"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Ffb631f46bbd1&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvisualising-assembly-graphs-fb631f46bbd1&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvisualising-assembly-graphs-fb631f46bbd1&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvisualising-assembly-graphs-fb631f46bbd1&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvisualising-assembly-graphs-fb631f46bbd1&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----fb631f46bbd1--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----fb631f46bbd1--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://vijini.medium.com/?source=post_page-----fb631f46bbd1--------------------------------", "anchor_text": ""}, {"url": "https://vijini.medium.com/?source=post_page-----fb631f46bbd1--------------------------------", "anchor_text": "Vijini Mallawaarachchi"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F8002c1aed6e7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvisualising-assembly-graphs-fb631f46bbd1&user=Vijini+Mallawaarachchi&userId=8002c1aed6e7&source=post_page-8002c1aed6e7----fb631f46bbd1---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ffb631f46bbd1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvisualising-assembly-graphs-fb631f46bbd1&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ffb631f46bbd1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvisualising-assembly-graphs-fb631f46bbd1&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://towardsdatascience.com/genome-assembly-the-holy-grail-of-genome-analysis-fae8fc9ef09c", "anchor_text": "Genome Assembly \u2014 The Holy Grail of Genome Analysis"}, {"url": "https://rrwick.github.io/Bandage/", "anchor_text": "Bandage"}, {"url": "https://github.com/Vini2/GraphBin/tree/master/test_data/ES_metaSPAdes", "anchor_text": "ES+metaSPAdes"}, {"url": "http://gfa-spec.github.io/GFA-spec/GFA1.html", "anchor_text": "GFA (Graph Fragment Assembly)"}, {"url": "http://gfa-spec.github.io/GFA-spec/GFA1.html", "anchor_text": "http://gfa-spec.github.io/GFA-spec/GFA1.html"}, {"url": "https://towardsdatascience.com/visualising-graph-data-with-python-igraph-b3cc81a495cf", "anchor_text": "previous article"}, {"url": "https://genome.cshlp.org/content/27/5/824", "anchor_text": "metaSPAdes"}, {"url": "https://github.com/Vini2/GraphBin/tree/master/test_data/ES_metaSPAdes", "anchor_text": "here"}, {"url": "https://github.com/Vini2/GraphBin/blob/master/test_data/ES_metaSPAdes/contigs.fasta", "anchor_text": "contigs.fasta"}, {"url": "https://github.com/Vini2/GraphBin/blob/master/test_data/ES_metaSPAdes/assembly_graph_with_scaffolds.gfa", "anchor_text": "assembly_graph_with_scaffolds.gfa"}, {"url": "https://github.com/Vini2/GraphBin/blob/master/test_data/ES_metaSPAdes/contigs.paths", "anchor_text": "contigs.paths"}, {"url": "https://github.com/Vini2/GraphBin/blob/master/test_data/ES_metaSPAdes/assembly_graph_with_scaffolds.gfa", "anchor_text": "assembly_graph_with_scaffolds.gfa"}, {"url": "https://github.com/lh3/bwa", "anchor_text": "BWA-MEM"}, {"url": "https://github.com/Vini2/GraphBin", "anchor_text": "here"}, {"url": "https://github.com/Vini2/GraphBin", "anchor_text": "Vini2/GraphBinGraphBin is a metagenomic contig binning tool that makes use of the contig connectivity information from the assembly\u2026github.com"}, {"url": "http://dx.doi.org/10.1093/bioinformatics/btaa180", "anchor_text": "10.1093/bioinformatics/btaa180"}, {"url": "http://dx.doi.org/10.1093/bioinformatics/btaa180", "anchor_text": "GraphBin: Refined binning of metagenomic contigs using assembly graphsAbstractMotivation. The field of metagenomics has provided valuable insights into the structure, diversity and ecology\u2026dx.doi.org"}, {"url": "https://towardsdatascience.com/genome-assembly-the-holy-grail-of-genome-analysis-fae8fc9ef09c", "anchor_text": "Genome Assembly \u2014 The Holy Grail of Genome AnalysisAssembling the 2019 novel coronavirus genometowardsdatascience.com"}, {"url": "https://towardsdatascience.com/metagenomics-who-is-there-and-what-are-they-doing-9f204342eed9", "anchor_text": "Metagenomics \u2014 Who is there and what are they doing?Gaining insights into data from microbial communitiestowardsdatascience.com"}, {"url": "https://medium.com/tag/data-science?source=post_page-----fb631f46bbd1---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/bioinformatics?source=post_page-----fb631f46bbd1---------------bioinformatics-----------------", "anchor_text": "Bioinformatics"}, {"url": "https://medium.com/tag/data-analysis?source=post_page-----fb631f46bbd1---------------data_analysis-----------------", "anchor_text": "Data Analysis"}, {"url": "https://medium.com/tag/programming?source=post_page-----fb631f46bbd1---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/tag/python?source=post_page-----fb631f46bbd1---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Ffb631f46bbd1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvisualising-assembly-graphs-fb631f46bbd1&user=Vijini+Mallawaarachchi&userId=8002c1aed6e7&source=-----fb631f46bbd1---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Ffb631f46bbd1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvisualising-assembly-graphs-fb631f46bbd1&user=Vijini+Mallawaarachchi&userId=8002c1aed6e7&source=-----fb631f46bbd1---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ffb631f46bbd1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvisualising-assembly-graphs-fb631f46bbd1&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----fb631f46bbd1--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Ffb631f46bbd1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvisualising-assembly-graphs-fb631f46bbd1&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----fb631f46bbd1---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----fb631f46bbd1--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----fb631f46bbd1--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----fb631f46bbd1--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----fb631f46bbd1--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----fb631f46bbd1--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----fb631f46bbd1--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----fb631f46bbd1--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----fb631f46bbd1--------------------------------", "anchor_text": ""}, {"url": "https://vijini.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://vijini.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Vijini Mallawaarachchi"}, {"url": "https://vijini.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "8.7K Followers"}, {"url": "http://vijinimallawaarachchi.com", "anchor_text": "vijinimallawaarachchi.com"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F8002c1aed6e7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvisualising-assembly-graphs-fb631f46bbd1&user=Vijini+Mallawaarachchi&userId=8002c1aed6e7&source=post_page-8002c1aed6e7--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F6560232ae7dd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvisualising-assembly-graphs-fb631f46bbd1&newsletterV3=8002c1aed6e7&newsletterV3Id=6560232ae7dd&user=Vijini+Mallawaarachchi&userId=8002c1aed6e7&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}