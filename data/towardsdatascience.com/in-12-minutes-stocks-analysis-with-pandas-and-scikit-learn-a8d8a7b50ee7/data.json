{"url": "https://towardsdatascience.com/in-12-minutes-stocks-analysis-with-pandas-and-scikit-learn-a8d8a7b50ee7", "time": 1682996402.440382, "path": "towardsdatascience.com/in-12-minutes-stocks-analysis-with-pandas-and-scikit-learn-a8d8a7b50ee7/", "webpage": {"metadata": {"title": "In 12 minutes: Stocks Analysis with Pandas and Scikit-Learn | by Vincent Tatan | Towards Data Science", "h1": "In 12 minutes: Stocks Analysis with Pandas and Scikit-Learn", "description": "One day, a friend of mine told me that the key to financial freedom is investing in stocks. While it is greatly true during the market boom, it still remains an attractive options today to trade\u2026"}, "outgoing_paragraph_urls": [{"url": "https://pandas-datareader.readthedocs.io/en/latest/", "anchor_text": "Pandas web data reader", "paragraph_index": 4}, {"url": "https://www.investopedia.com/terms/a/averageprice.asp", "anchor_text": "average price", "paragraph_index": 8}, {"url": "https://www.investopedia.com/university/stockpicking/stockpicking3.asp", "anchor_text": "Value Investing methodology", "paragraph_index": 48}, {"url": "https://towardsdatascience.com/questions-96667b06af5", "anchor_text": "rules and guidelines", "paragraph_index": 49}, {"url": "https://towardsdatascience.com/readers-terms-b5d780a700a4", "anchor_text": "Reader Terms", "paragraph_index": 49}, {"url": "http://www.linkedin.com/in/vincenttatan/", "anchor_text": "LinkedIn", "paragraph_index": 52}, {"url": "https://www.youtube.com/user/vincelance1/videos", "anchor_text": "Youtube Channel", "paragraph_index": 52}], "all_paragraphs": ["One day, a friend of mine told me that the key to financial freedom is investing in stocks. While it is greatly true during the market boom, it still remains an attractive options today to trade stocks part time. Given the easy access to online trading platform, there are many self made value investors or housewife traders. There are even success stories and advertisements which boast \u201cGet Rich Quick Scheme\u201d to learn how to invest in stocks with a staggering return of 40% and even more. Investing has become the boon for the working professionals today.", "The question now are: Which stocks? How do you analyse stocks? What are the returns and risks of this stocks compared to its competitors?", "The objective for this publication is for you to understand one way on analyzing stocks using quick and dirty Python Code. Just spend 12 minutes to read this article \u2014 or even better, contribute. Then you could get a quick glimpse to code your first financial analysis.", "To start learning and analyzing stocks, we will start off by taking a quick look at the historical stocks prices. This will be done by extracting latest stocks data from pandas web-data reader and Yahoo Finance. Then we will try to view the data through exploratory analysis such as correlation heatmap, matplotlib visualization, and prediction analysis using Linear Analysis and K Nearest Neighbor (KNN).", "Pandas web data reader is an extension of pandas library to communicate with most updated financial data. This will include sources as: Yahoo Finance, Google Finance, Enigma, etc.", "We will extract Apple Stocks Price using the following codes:", "This piece of code will pull 7 years data from January 2010 until January 2017. Feel free to tweak the start and end date as you see necessary. For the rest of analysis, we will use the Closing Price which remarks the final price in which the stocks are traded by the end of the day.", "In this analysis, we analyse stocks using two key measurements: Rolling Mean and Return Rate.", "Rolling mean/Moving Average (MA) smooths out price data by creating a constantly updated average price. This is useful to cut down \u201cnoise\u201d in our price chart. Furthermore, this Moving Average could act as \u201cResistance\u201d meaning from the downtrend and uptrend of stocks you could expect it will follow the trend and less likely to deviate outside its resistance point.", "Let\u2019s start code out the Rolling Mean:", "This will calculate the Moving Average for the last 100 windows (100 days) of stocks closing price and take the average for each of the window\u2019s moving average. As you could see, The Moving Average steadily rises over the window and does not follow the jagged line of stocks price chart.", "For better understanding, let\u2019s plot it out with Matplotlib. We will overlay the Moving Average with our Stocks Price Chart.", "The Moving Average makes the line smooth and showcase the increasing or decreasing trend of stocks price.", "In this chart, the Moving Average showcases increasing trend the upturn or downturn of stocks price. Logically, you should buy when the stocks are experiencing downturn and sell when the stocks are experiencing upturn.", "Expected Return measures the mean, or expected value, of the probability distribution of investment returns. The expected return of a portfolio is calculated by multiplying the weight of each asset by its expected return and adding the values for each investment \u2014 Investopedia.", "Following is the formula you could refer to:", "Based on the formula, we could plot our returns as following.", "Logically, our ideal stocks should return as high and stable as possible. If you are risk averse(like me), you might want to avoid this stocks as you saw the 10% drop in 2013. This decision is heavily subjected to your general sentiment of the stocks and competitor analysis.", "In this segment, we are going to analyse on how one company performs in relative with its competitor. Let\u2019s assume we are interested in technology companies and want to compare the big guns: Apple, GE, Google, IBM, and Microsoft.", "This will return you a slick table of closing prices among the stocks prices from Yahoo Finance. Neat!!", "We can analyse the competition by running the percentage change and correlation function in pandas. Percentage change will find how much the price changes compared to the previous day which defines returns. Knowing the correlation will help us see whether the returns are affected by other stocks\u2019 returns", "Let\u2019s plot Apple and GE with ScatterPlot to view their return distributions.", "We can see here that there are slight positive correlations among GE returns and Apple returns. It seems like that the higher the Apple returns, the higher GE returns as well for most cases.", "Let us further improve our analysis by plotting the scatter_matrix to visualize possible correlations among competing stocks. At the diagonal point, we will run Kernel Density Estimate (KDE). KDE is a fundamental data smoothing problem where inferences about the population are made, based on a finite data sample. It helps generate estimations of the overall distributions.", "From here we could see most of the distributions among stocks which approximately positive correlations.", "To prove the positive correlations, we will use heat maps to visualize the correlation ranges among the competing stocks. Notice that the lighter the color, the more correlated the two stocks are.", "From the Scatter Matrix and Heatmap, we can find great correlations among the competing stocks. However, this might not show causality, and could just show the trend in the technology industry rather than show how competing stocks affect each other.", "Apart from correlation, we also analyse each stock\u2019s risks and returns. In this case we are extracting the average of returns (Return Rate) and the standard deviation of returns (Risk).", "Now you could view this neat chart of risk and return comparisons for competing stocks. Logically, you would like to minimize the risk and maximize returns. Therefore, you would want to draw the line for your risk-return tolerance (The red line). You would then create the rules to buy those stocks under the red line (MSFT, GE, and IBM) and sell those stocks above the red line (AAPL and GOOG). This red line showcases your expected value threshold and your baseline for buy/sell decision.", "We will use these three machine learning models to predict our stocks: Simple Linear Analysis, Quadratic Discriminant Analysis (QDA), and K Nearest Neighbor (KNN). But first, let us engineer some features: High Low Percentage and Percentage Change.", "We will clean up and process the data using the following steps before putting them into the prediction models:", "Please refer the preparation codes below.", "But first, let\u2019s insert the following imports for our Scikit-Learn:", "Simple Linear Analysis shows a linear relationship between two or more variables. When we draw this relationship within two variables, we get a straight line. Quadratic Discriminant Analysis would be similar to Simple Linear Analysis, except that the model allowed polynomial (e.g: x squared) and would produce curves.", "Linear Regression predicts dependent variables (y) as the outputs given independent variables (x) as the inputs. During the plotting, this will give us a straight line as shown below:", "This is an amazing publication which showed a very comprehensive review of Linear Regression. Please refer to the link below for the view.", "We will plug and play the existing Scikit-Learn library and train the model by selecting our X and y train sets. The code will be as following.", "This KNN uses feature similarity to predict values of data points. This ensures that the new point assigned is similar to the points in the data set. To find out similarity, we will extract the points to release the minimum distance (e.g: Euclidean Distance).", "Please refer to this link for further details on the model. This is really useful to improve your understanding.", "A simple quick and dirty way to evaluate is to use the score method in each trained model. The score method finds the mean accuracy of self.predict(X) with y of the test data set.", "This shows an enormous accuracy score (>0.95) for most of the models. However this does not mean we can blindly place our stocks. There are still many issues to consider, especially with different companies that have different price trajectories over time.", "For sanity testing, let us print some of the stocks forecast.", "Based on the forecast, we will visualize the plot with our existing historical data. This will help us visualize how the model fares to predict future stocks pricing.", "As we can see the blue color showcased the forecast on the stocks price based on regression. The forecast predicted that there would be a downturn for not too long, then it will recover. Therefore, we could buy the stocks during downturn and sell during upturn.", "To further analyse the stocks, here are some ideas on how you could contribute. These ideas would be useful to get a more comprehensive analysis on stocks. Feel free to let me know should there be more clarifications needed.", "The purpose for this Proof Of Concepts (POC) was created as a part of investments side project that the I am currently managing. The goal of this application is to help you retrieve and display the right financial insights quickly about a certain company stocks price and predicting its value.", "In the POC, I used Pandas- Web Datareader to find the stocks prices , Scikit-Learn to predict and generate machine learning models, and finally Python as the scripting language. The Github Python Notebook Code is located below.", "Feel free to clone the repository and contribute whenever you have time.", "In lieu with today\u2019s topics about stocks analysis. You could also visit my Value Investing Publication where I talked about scraping stocks financial information and displaying it in an easy to read dashboard which processes stocks valuation based on Value Investing methodology. Please visit it and contribute :).", "Note from Towards Data Science\u2019s editors: While we allow independent authors to publish articles in accordance with our rules and guidelines, we do not endorse each author\u2019s contribution. You should not rely on an author\u2019s works without seeking professional advice. See our Reader Terms for details.", "I would like to thank you my fellow Accountancy and Finance friends who gave me constructive feedback on this publication. I really enjoyed learning that you gained much values from this publication of mine.", "Whew\u2026 That\u2019s it, about my idea which I formulated into writings. I really hope this has been a great read for you guys. With that, I hope my idea could be a source of inspiration for you to develop and innovate.", "Please reach out to me via my LinkedIn and subscribe to my Youtube Channel", "If you like it, please give me Claps.", "Comment out below to suggest and feedback.", "Disclaimer: This disclaimer informs readers that the views, thoughts, and opinions expressed in the text belong solely to the author, and not necessarily to the author\u2019s employer, organization, committee or other group or individual. References are picked up from the list and any similarities with other works are purely coincidental", "This article was made purely as the author\u2019s side project and in no way driven by any other hidden agenda.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "I fight phishing with ML @ Google. I use advanced ML algorithms and MLOps to protect Chrome, Gmail and Android users. Please reach out to me on Linkedin."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fa8d8a7b50ee7&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fin-12-minutes-stocks-analysis-with-pandas-and-scikit-learn-a8d8a7b50ee7&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fin-12-minutes-stocks-analysis-with-pandas-and-scikit-learn-a8d8a7b50ee7&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fin-12-minutes-stocks-analysis-with-pandas-and-scikit-learn-a8d8a7b50ee7&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fin-12-minutes-stocks-analysis-with-pandas-and-scikit-learn-a8d8a7b50ee7&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----a8d8a7b50ee7--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----a8d8a7b50ee7--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@vincentkernn?source=post_page-----a8d8a7b50ee7--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@vincentkernn?source=post_page-----a8d8a7b50ee7--------------------------------", "anchor_text": "Vincent Tatan"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F9848578f8495&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fin-12-minutes-stocks-analysis-with-pandas-and-scikit-learn-a8d8a7b50ee7&user=Vincent+Tatan&userId=9848578f8495&source=post_page-9848578f8495----a8d8a7b50ee7---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa8d8a7b50ee7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fin-12-minutes-stocks-analysis-with-pandas-and-scikit-learn-a8d8a7b50ee7&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa8d8a7b50ee7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fin-12-minutes-stocks-analysis-with-pandas-and-scikit-learn-a8d8a7b50ee7&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://pandas-datareader.readthedocs.io/en/latest/", "anchor_text": "Pandas web data reader"}, {"url": "https://www.investopedia.com/terms/a/averageprice.asp", "anchor_text": "average price"}, {"url": "https://www.investopedia.com/articles/active-trading/052014/how-use-moving-average-buy-stocks.asp", "anchor_text": "How to Use a Moving Average to Buy StocksThe moving average (MA) is a simple technical analysis tool that smooths out price data by creating a constantly\u2026www.investopedia.com"}, {"url": "https://en.wikipedia.org/wiki/Kernel_density_estimation", "anchor_text": "Kernel density estimation - WikipediaIn statistics, kernel density estimation ( KDE) is a non-parametric way to estimate the probability density function of\u2026en.wikipedia.org"}, {"url": "https://towardsdatascience.com/a-beginners-guide-to-linear-regression-in-python-with-scikit-learn-83a8f7ae2b4f", "anchor_text": "A beginner\u2019s guide to Linear Regression in Python with Scikit-LearnThere are two types of supervised machine learning algorithms: Regression and classification. The former predicts\u2026towardsdatascience.com"}, {"url": "https://www.analyticsvidhya.com/blog/2018/03/introduction-k-neighbours-algorithm-clustering/", "anchor_text": "Introduction to k-Nearest Neighbors: Simplified (with implementation in Python)Note: This article was originally published on Oct 10, 2014 and updated on Mar 27th, 2018 Introduction In the four\u2026www.analyticsvidhya.com"}, {"url": "https://github.com/VincentTatan/PythonAnalytics/blob/master/Youtube/Lesson%203%20%20Basic%20Python%20for%20Data%20Analytics%20%28Stocks%20Prediction%29.ipynb", "anchor_text": "PythonAnalytics/Lesson 3 Basic Python for Data Analytics (Stocks Prediction).ipynb at master \u00b7\u2026This is as a repository for me to keep my Kaggle and Practice with iPython Notebook - PythonAnalytics/Lesson 3 Basic\u2026github.com"}, {"url": "https://www.investopedia.com/university/stockpicking/stockpicking3.asp", "anchor_text": "Value Investing methodology"}, {"url": "https://towardsdatascience.com/value-investing-dashboard-with-python-beautiful-soup-and-dash-python-43002f6a97ca", "anchor_text": "Value Investing Dashboard with Python Beautiful Soup and Dash PythonAn Overview of Web Scraping with a Quick Dash Visualization for Value Investingtowardsdatascience.com"}, {"url": "https://towardsdatascience.com/questions-96667b06af5", "anchor_text": "rules and guidelines"}, {"url": "https://towardsdatascience.com/readers-terms-b5d780a700a4", "anchor_text": "Reader Terms"}, {"url": "http://www.linkedin.com/in/vincenttatan/", "anchor_text": "LinkedIn"}, {"url": "https://www.youtube.com/user/vincelance1/videos", "anchor_text": "Youtube Channel"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----a8d8a7b50ee7---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/money?source=post_page-----a8d8a7b50ee7---------------money-----------------", "anchor_text": "Money"}, {"url": "https://medium.com/tag/economy?source=post_page-----a8d8a7b50ee7---------------economy-----------------", "anchor_text": "Economy"}, {"url": "https://medium.com/tag/investment?source=post_page-----a8d8a7b50ee7---------------investment-----------------", "anchor_text": "Investment"}, {"url": "https://medium.com/tag/pandas?source=post_page-----a8d8a7b50ee7---------------pandas-----------------", "anchor_text": "Pandas"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fa8d8a7b50ee7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fin-12-minutes-stocks-analysis-with-pandas-and-scikit-learn-a8d8a7b50ee7&user=Vincent+Tatan&userId=9848578f8495&source=-----a8d8a7b50ee7---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fa8d8a7b50ee7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fin-12-minutes-stocks-analysis-with-pandas-and-scikit-learn-a8d8a7b50ee7&user=Vincent+Tatan&userId=9848578f8495&source=-----a8d8a7b50ee7---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa8d8a7b50ee7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fin-12-minutes-stocks-analysis-with-pandas-and-scikit-learn-a8d8a7b50ee7&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----a8d8a7b50ee7--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fa8d8a7b50ee7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fin-12-minutes-stocks-analysis-with-pandas-and-scikit-learn-a8d8a7b50ee7&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----a8d8a7b50ee7---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----a8d8a7b50ee7--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----a8d8a7b50ee7--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----a8d8a7b50ee7--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----a8d8a7b50ee7--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----a8d8a7b50ee7--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----a8d8a7b50ee7--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----a8d8a7b50ee7--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----a8d8a7b50ee7--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@vincentkernn?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@vincentkernn?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Vincent Tatan"}, {"url": "https://medium.com/@vincentkernn/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "3.9K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F9848578f8495&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fin-12-minutes-stocks-analysis-with-pandas-and-scikit-learn-a8d8a7b50ee7&user=Vincent+Tatan&userId=9848578f8495&source=post_page-9848578f8495--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fba9496ed2fd5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fin-12-minutes-stocks-analysis-with-pandas-and-scikit-learn-a8d8a7b50ee7&newsletterV3=9848578f8495&newsletterV3Id=ba9496ed2fd5&user=Vincent+Tatan&userId=9848578f8495&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}