{"url": "https://towardsdatascience.com/time-series-forecasting-with-tensorflow-js-1efd48ff2201", "time": 1682996261.218176, "path": "towardsdatascience.com/time-series-forecasting-with-tensorflow-js-1efd48ff2201/", "webpage": {"metadata": {"title": "Time Series Forecasting with TensorFlow.js | by Jingles (Hong Jing) | Towards Data Science", "h1": "Time Series Forecasting with TensorFlow.js", "description": "Pull stock prices from online API and perform predictions using RNN & LSTM with TensorFlow.js (include demo and codes)"}, "outgoing_paragraph_urls": [{"url": "https://www.alphavantage.co/", "anchor_text": "alphavantage.co", "paragraph_index": 3}, {"url": "https://en.wikipedia.org/wiki/Supervised_learning", "anchor_text": "supervised learning", "paragraph_index": 6}, {"url": "https://www.investopedia.com/terms/s/sma.asp", "anchor_text": "Simple Moving Average (SMA)", "paragraph_index": 7}, {"url": "https://www.tensorflow.org/js", "anchor_text": "TensorFlow.js", "paragraph_index": 13}, {"url": "https://js.tensorflow.org/api/latest/#sequential", "anchor_text": "Sequential model", "paragraph_index": 14}, {"url": "https://js.tensorflow.org/api/latest/#layers.rnn", "anchor_text": "recurrent neural network", "paragraph_index": 14}, {"url": "https://js.tensorflow.org/api/latest/#layers.lstmCell", "anchor_text": "LSTM cells", "paragraph_index": 14}, {"url": "https://js.tensorflow.org/api/latest/#train.adam", "anchor_text": "Adam", "paragraph_index": 15}, {"url": "https://arxiv.org/abs/1412.6980", "anchor_text": "research paper", "paragraph_index": 15}, {"url": "https://js.tensorflow.org/api/latest/#losses.meanSquaredError", "anchor_text": "Root mean square error", "paragraph_index": 15}, {"url": "https://github.com/jinglescode/time-series-forecasting-tensorflowjs", "anchor_text": "full code on Github", "paragraph_index": 16}, {"url": "https://en.wikipedia.org/wiki/Hyperparameter_(machine_learning)", "anchor_text": "hyper-parameters", "paragraph_index": 17}, {"url": "https://jinglescode.github.io/time-series-forecasting-tensorflowjs", "anchor_text": "frontend", "paragraph_index": 17}, {"url": "https://www.statisticshowto.datasciencecentral.com/rmse/", "anchor_text": "Root Mean Square Error", "paragraph_index": 24}, {"url": "https://www.alphavantage.co/documentation/#fundamentals", "anchor_text": "Alpha Vantage API", "paragraph_index": 28}, {"url": "https://jinglescode.github.io/time-series-forecasting-tensorflowjs", "anchor_text": "Explore the demo on Github", "paragraph_index": 32}, {"url": "http://linkedin.com/in/jingles", "anchor_text": "linkedin.com/in/jingles", "paragraph_index": 34}], "all_paragraphs": ["Machine learning is becoming increasingly popular these days and a growing number of the world\u2019s population see it is as a magic crystal ball: predicting when and what will happen in the future. This experiment uses artificial neural networks to reveal stock market trends and demonstrates the ability of time series forecasting to predict future stock prices based on past historical data.", "Disclaimer: As stock markets fluctuation are dynamic and unpredictable owing to multiple factors, this experiment is 100% educational and by no means a trading prediction tool.", "There are 4 parts to this project walkthrough:", "Before we can train the neural network and make any predictions, we will first require data. The type of data we are looking for is time series: a sequence of numbers in chronological order. A good place to fetch these data are from alphavantage.co. This API allows us to retrieve chronological data on specific company stocks prices from the last 20 years.", "The API yields the following fields:", "To prepare training dataset for our neural network, we will be using closing stocks price. This also means that we will be aiming to predict the future closing price. Below graph shows 20 years of Microsoft Corporation weekly closing prices.", "For this experiment, we are using supervised learning, which means feeding data to the neural network and it learns by mapping input data to the output label. One way to prepare the training dataset is to extract the moving average from that time-series data.", "Simple Moving Average (SMA) is a method to identify trends direction for a certain period of time, by looking at the average of all the values within that time window. The number of prices in a time window is selected experimentally.", "For example, let\u2019s assume the closing prices for the past 5 days were 13, 15, 14, 16, 17, the SMA would be (13+15+14+16+17)/5 = 15. So the input for our training dataset is the set of prices within a single time window, and its label is the computed moving average of those prices.", "Let\u2019s compute the SMA of Microsoft Corporation weekly closing prices data, with a window size of 50.", "And this is what we get, weekly stock closing price in blue, and SMA in orange. Because SMA is the moving average of 50 weeks, it is smoother than the weekly price, which can fluctuate.", "We can prepare the training data with weekly stock prices and the computed SMA. Given the window size is 50, this means that we will use the closing price of every 50 consecutive weeks as our training features (X), and the SMA of those 50 weeks as our training label (Y). Which looks like that\u2026", "Next, we split our data into 2 sets, training and validation set. If 70% of the data is used for training, then 30% for validation. The API returns us approximate 1000 weeks of data, so 700 for training, and 300 for validation.", "Now that the training data is ready, it is time to create a model for time series prediction, to achieve this we will use TensorFlow.js framework. TensorFlow.js is a library for developing and training machine learning models in JavaScript, and we can deploy these machine learning capabilities in a web browser.", "Sequential model is selected which simply connects each layer and pass the data from input to the output during the training process. In order for the model to learn time series data which are sequential, recurrent neural network (RNN) layer is created and a number of LSTM cells are added to the RNN.", "The model will be trained using Adam (research paper), a popular optimisation algorithm for machine learning. Root mean square error which will determine the difference between predicted values and the actual values, so the model is able to learn by minimising the error during the training process.", "Here is a code snippet of the model described above, full code on Github.", "These are the hyper-parameters (parameters used in the training process) available for tweaking in the frontend:", "Click the Begin Training Model button\u2026", "The model seems to converge at around 15 epoch.", "Now that the model is trained, it is time to use it for predicting future values, for our case, it is the moving average. We will use the model.predict function from TFJS.", "The data has been split into 2 sets, training and validation set. The training set has been used for training the model, thus will be using the validation set to validate the model. Since the model has not seen the validation dataset, it will be good if the model is able to predict values that are close to the true values.", "So let us use the remaining data for prediction which allow us to see how closely our predicted values are compared to the actual values.", "Looks like the model predicted (green line) does a good job plotting closely to the actual price (blue line). This means that the model is able to predict the last 30% of the data which was unseen by the model.", "Other algorithms can be applied and uses the Root Mean Square Error to compare 2 or more models performance.", "Finally, the model has been validated and the predicted values map closely to its true values, we shall use it to predict the future. We will apply the same model.predict function and use the last 50 data points as the input, because our window size is 50. Since our training data is increment daily, we will use the past 50 days as input, to predict the 51st day.", "The model has never seen similar data in the past. In March 2020, where the market dipped and recovered within a month or two, this has never happened in history. The model is likely to fail to predict drastic changes in stock prices during those periods.", "We can add more features. In a general sense, more features tend to make the model perform better. We can include trading indicators such as Moving average convergence divergence (MACD), Relative strength index (RSI), or Bollinger bands.", "Add more features. Another amazing API that Alpha Vantage API provides is Fundamental Data. This means that you can also include annual and quarterly income statements and cash flows for the company of interest. Who knows, those features might be useful.", "There could have many other reasons why the model fails to learn and predict. This is the challenge of machine learning; it is both an art and science to build good performing models.", "There are many ways to do time series prediction other than using a simple moving average. Possible future work is to implement this with more data from various sources.", "With TensorFlow.js, machine learning on a web browser is possible, and it is actually pretty cool.", "Explore the demo on Github, this experiment is 100% educational and by no means a trading prediction tool.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Alibaba PhD in machine learning | write about machine learning, neuroscience, healthcare & blockchain | reach me at linkedin.com/in/jingles"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F1efd48ff2201&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftime-series-forecasting-with-tensorflow-js-1efd48ff2201&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftime-series-forecasting-with-tensorflow-js-1efd48ff2201&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftime-series-forecasting-with-tensorflow-js-1efd48ff2201&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftime-series-forecasting-with-tensorflow-js-1efd48ff2201&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----1efd48ff2201--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----1efd48ff2201--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://jinglesnote.medium.com/?source=post_page-----1efd48ff2201--------------------------------", "anchor_text": ""}, {"url": "https://jinglesnote.medium.com/?source=post_page-----1efd48ff2201--------------------------------", "anchor_text": "Jingles (Hong Jing)"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F641197e9ee36&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftime-series-forecasting-with-tensorflow-js-1efd48ff2201&user=Jingles+%28Hong+Jing%29&userId=641197e9ee36&source=post_page-641197e9ee36----1efd48ff2201---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F1efd48ff2201&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftime-series-forecasting-with-tensorflow-js-1efd48ff2201&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F1efd48ff2201&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftime-series-forecasting-with-tensorflow-js-1efd48ff2201&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://jinglescode.github.io/time-series-forecasting-tensorflowjs", "anchor_text": "Explore the demo"}, {"url": "https://www.alphavantage.co/", "anchor_text": "alphavantage.co"}, {"url": "https://en.wikipedia.org/wiki/Supervised_learning", "anchor_text": "supervised learning"}, {"url": "https://www.investopedia.com/terms/s/sma.asp", "anchor_text": "Simple Moving Average (SMA)"}, {"url": "https://www.tensorflow.org/js", "anchor_text": "TensorFlow.js"}, {"url": "https://js.tensorflow.org/api/latest/#sequential", "anchor_text": "Sequential model"}, {"url": "https://js.tensorflow.org/api/latest/#layers.rnn", "anchor_text": "recurrent neural network"}, {"url": "https://js.tensorflow.org/api/latest/#layers.lstmCell", "anchor_text": "LSTM cells"}, {"url": "https://js.tensorflow.org/api/latest/#train.adam", "anchor_text": "Adam"}, {"url": "https://arxiv.org/abs/1412.6980", "anchor_text": "research paper"}, {"url": "https://js.tensorflow.org/api/latest/#losses.meanSquaredError", "anchor_text": "Root mean square error"}, {"url": "https://github.com/jinglescode/time-series-forecasting-tensorflowjs", "anchor_text": "full code on Github"}, {"url": "https://en.wikipedia.org/wiki/Hyperparameter_(machine_learning)", "anchor_text": "hyper-parameters"}, {"url": "https://jinglescode.github.io/time-series-forecasting-tensorflowjs", "anchor_text": "frontend"}, {"url": "https://machinelearningmastery.com/difference-between-a-batch-and-an-epoch/", "anchor_text": "learn more"}, {"url": "https://machinelearningmastery.com/learning-rate-for-deep-learning-neural-networks/", "anchor_text": "learn more"}, {"url": "https://machinelearningmastery.com/how-to-configure-the-number-of-layers-and-nodes-in-a-neural-network/", "anchor_text": "learn more"}, {"url": "https://jinglescode.github.io/time-series-forecasting-tensorflowjs", "anchor_text": "Web frontend"}, {"url": "https://jinglescode.github.io/demos/tfjs-timeseries-stocks", "anchor_text": "User interface"}, {"url": "https://jinglescode.github.io/time-series-forecasting-tensorflowjs", "anchor_text": "web demo"}, {"url": "https://www.statisticshowto.datasciencecentral.com/rmse/", "anchor_text": "Root Mean Square Error"}, {"url": "https://www.alphavantage.co/documentation/#fundamentals", "anchor_text": "Alpha Vantage API"}, {"url": "https://jinglescode.github.io/time-series-forecasting-tensorflowjs", "anchor_text": "Explore the demo on Github"}, {"url": "https://github.com/jinglescode/time-series-forecasting-tensorflowjs", "anchor_text": "View source code on Github"}, {"url": "https://towardsdatascience.com/data-scientist-the-dirtiest-job-of-the-21st-century-7f0c8215e845", "anchor_text": "Data Scientist: The Dirtiest Job of the 21st Century40% vacuum, 40% janitor, 20% fortune-teller.towardsdatascience.com"}, {"url": "https://www.linkedin.com/in/jingles/", "anchor_text": ""}, {"url": "https://towardsdatascience.com/@jinglesnote", "anchor_text": ""}, {"url": "https://jingles.substack.com/subscribe", "anchor_text": ""}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----1efd48ff2201---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----1efd48ff2201---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----1efd48ff2201---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/technology?source=post_page-----1efd48ff2201---------------technology-----------------", "anchor_text": "Technology"}, {"url": "https://medium.com/tag/programming?source=post_page-----1efd48ff2201---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F1efd48ff2201&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftime-series-forecasting-with-tensorflow-js-1efd48ff2201&user=Jingles+%28Hong+Jing%29&userId=641197e9ee36&source=-----1efd48ff2201---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F1efd48ff2201&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftime-series-forecasting-with-tensorflow-js-1efd48ff2201&user=Jingles+%28Hong+Jing%29&userId=641197e9ee36&source=-----1efd48ff2201---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F1efd48ff2201&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftime-series-forecasting-with-tensorflow-js-1efd48ff2201&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----1efd48ff2201--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F1efd48ff2201&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftime-series-forecasting-with-tensorflow-js-1efd48ff2201&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----1efd48ff2201---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----1efd48ff2201--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----1efd48ff2201--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----1efd48ff2201--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----1efd48ff2201--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----1efd48ff2201--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----1efd48ff2201--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----1efd48ff2201--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----1efd48ff2201--------------------------------", "anchor_text": ""}, {"url": "https://jinglesnote.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://jinglesnote.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Jingles (Hong Jing)"}, {"url": "https://jinglesnote.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "1.7K Followers"}, {"url": "http://linkedin.com/in/jingles", "anchor_text": "linkedin.com/in/jingles"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F641197e9ee36&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftime-series-forecasting-with-tensorflow-js-1efd48ff2201&user=Jingles+%28Hong+Jing%29&userId=641197e9ee36&source=post_page-641197e9ee36--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fb9c0df6b9368&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftime-series-forecasting-with-tensorflow-js-1efd48ff2201&newsletterV3=641197e9ee36&newsletterV3Id=b9c0df6b9368&user=Jingles+%28Hong+Jing%29&userId=641197e9ee36&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}