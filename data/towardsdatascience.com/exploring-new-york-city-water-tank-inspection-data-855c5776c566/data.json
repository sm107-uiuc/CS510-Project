{"url": "https://towardsdatascience.com/exploring-new-york-city-water-tank-inspection-data-855c5776c566", "time": 1682996839.4901462, "path": "towardsdatascience.com/exploring-new-york-city-water-tank-inspection-data-855c5776c566/", "webpage": {"metadata": {"title": "Exploring New York City water tank inspection data. | by Lonnie Halpern | Towards Data Science", "h1": "Exploring New York City water tank inspection data.", "description": "My approach to exploring, analyzing and visualizing New York City water tank inspection data using Python and Plotly."}, "outgoing_paragraph_urls": [{"url": "https://cooperator.com/article/roof-tanks-101/full", "anchor_text": "last century", "paragraph_index": 1}, {"url": "https://www.nytimes.com/2018/05/26/realestate/how-new-york-water-tanks-work.html", "anchor_text": "buildings over 6 stories", "paragraph_index": 1}, {"url": "http://rules.cityofnewyork.us/sites/default/files/adopted_rules_pdf/f-dohmh_04-03-15_a_ch_31.pdf", "anchor_text": "Chapter 31 of New York City\u2019s Administrative Code", "paragraph_index": 3}, {"url": "https://www1.nyc.gov/site/doh/business/permits-and-licenses/rooftop-drinking-water-tank-inspection-results.page", "anchor_text": "online tool to look up the inspection results of any building", "paragraph_index": 3}, {"url": "https://www1.nyc.gov/assets/home/downloads/pdf/reports/2015/NYC-Open-Data-Plan-2015.pdf", "anchor_text": "data is valuable and should be made accessible to everyone", "paragraph_index": 4}, {"url": "https://opendata.cityofnewyork.us/", "anchor_text": "https://opendata.cityofnewyork.us/", "paragraph_index": 4}, {"url": "https://stackoverflow.com/questions/tagged/pandas?sort=votes&pageSize=15", "anchor_text": "StackOverflow", "paragraph_index": 7}, {"url": "https://nbviewer.jupyter.org/github/LHalpern/nyc_water_tanks_jupyter_medium/blob/master/NYC_Watertower%20-%20June5data.ipynb", "anchor_text": "via nbviewer here", "paragraph_index": 8}, {"url": "https://github.com/LHalpern/nyc_water_tanks_jupyter_medium", "anchor_text": "GitHub", "paragraph_index": 8}, {"url": "https://www1.nyc.gov/site/planning/data-maps/open-data/dwn-pluto-mappluto.page", "anchor_text": "PLUTO dataset", "paragraph_index": 19}, {"url": "https://www1.nyc.gov/site/doh/business/permits-and-licenses/rooftop-drinking-water-tank-inspection-results.page", "anchor_text": "NYC Health building tank search tool", "paragraph_index": 24}, {"url": "https://twitter.com/LonnieHalpern", "anchor_text": "@LonnieHalpern", "paragraph_index": 25}], "all_paragraphs": ["I have been exploring New York City real estate data and experimenting with various methods of data analysis and visualization for the last few years. Along the way I have learned much about New York City real estate data, in particular how to obtain, clean, analyze, and visualize / map it. I have spent a good amount of time learning about data and various programming languages and techniques, searching Q&A\u2019s on Stackoverflow, articles on Medium and various data tutorials. I hope that by summarizing a project that I have been working on and outlining my process for exploring a data driven real estate question, sources of real estate data and tools for data analysis, I will illustrate that insight can be gained through data analytics and be helpful to those exploring their own data driven questions.", "I have always been interested in building water tanks. Despite all the advances in science, these wooden barrels which hold a building\u2019s water supply have remained largely unchanged for the last century. In New York City they are necessary to maintain water pressure for buildings over 6 stories.", "Step 1 \u2014 Identify your question and data sources", "I am curious about how clean the water tanks are and whether there are any identifiable patterns to this. Through some research, I learned that in May 2015 Chapter 31 of New York City\u2019s Administrative Code went into affect which requires building owners to conduct annual inspections of their water tanks and report the results to the NYC Health Department. Chapter 31 requires that each building accomplish this by January 15th of the following year and that all results are to be made publicly available. The NYC Health Department maintains an online tool to look up the inspection results of any building in New York City.", "When city data is available in an online based tool, there is a good chance that the underlying data is also available via the NYC open data portal (and if not, it should be). This is because New York City recognized that data is valuable and should be made accessible to everyone and in 2012 passed Local Law 11 which called for the identification and aggregation of city wide data by 2018. The on-ramp for searching this expansive data resource is https://opendata.cityofnewyork.us/", "A simple search for water tanks quickly leads you to the data we are looking for which can be downloaded as a .csv file.", "Step 2 \u2014 Clean and explore the data", "I generally use Python to analyze data. The reasons I like Python (and why it is enormously popular) is that its constantly being developed and new libraries added, there is enormous amount of resources for learning and chances are that for anything you are trying to accomplish there are multiple discussions on StackOverflow to guide you.", "If you are going to follow along, I suggest that you install Anaconda, its a very popular Python package which includes many of the must-have Python libraries preinstalled. One such library is Jupyter which allows you to run Python commands in your browser via a notebook, which makes it easy to experiment and share your notebooks with others. The Jupyter notebook corresponding to this article can be viewed via nbviewer here and all files (including underlying data) can be found in this GitHub repository.", "Another popular library (also part of the Jupyter package) is Pandas which simplifies how you can organize, search and modify tabular data. After the libraries are loaded the data (which was previously downloaded) can be read into a Panda\u2019s dataframe.", "The command shape tells us that the data consists of 19,752 rows with 48 columns, we can get a sense of the data (and the type of data) that it contains below.", "One of the advantages of Python is that you can quickly summarize the data, the code below loops through certain columns of data to determine the number of results in each category. From this we learn that there were 17,002 inspections in Manhattan during the history of the inspection program, 5,461 inspection in 2018, and more observations of biological growth and bird/insect debris than I would like to see (although on a percentage basis its extremely low).", "It is also fairly simple to visualize data using Python. When we do, a few observations stand out such as an increase in inspections in the last four years (with the biggest increase being between 2017 and 2018, the majority of inspections taking place in Manhattan and the dominance of a few firms in conducting inspection.", "When I originally started this analysis in May of 2019, the data was last updated on October 2018 and consequently didn\u2019t include the last three months of reporting in 2018. I was hopefully that the reports were done and filed and reached out to NYC Open Data to request that that data be updated (NYC Open Data has a procedure for requesting additional information on its data sets). In early June the data was updated (as of June 5th) and it appears that it is now being updated weekly!", "In addition to identifying missing data while exploring the data you often come across aspects of the data that need to be cleaned. For instance, when I was working with the October 2018 data I noticed that there was no data for the Latitude column, and this led me to realize that the Latitude data was incorrectly labeled as Longitude and each of the columns to the right were skewed by one column. This was subsequently corrected in the June 2019 data release.", "In addition, the names of inspecting firms vary, \u201cISSEKS BROS INC\u201d is also referred to as \u201cIsseks Bros Inc\u201d and \u201cIsseks\u201d. If analyzing this is important to your research, you will want to make the data consistent.", "Step 3 \u2014 Analyze and visualize the data", "As a result of my initial exploration of the data, I decided to change the focus of my analysis from the results of the inspections to which water tanks were not in compliance with the annual reporting obligations.", "Group Data \u2014 Python has a powerful function GROUPBY which allows you to efficiently group data by certain attributes and run various calculations on the results (such as sum, average and count). Since we are limiting our inquiry to whether a building has had its annual inspection, we will first select the data we need. Since there is one row of data for each report, we will filter out multiple reports for the same year with the same BBL (keeping the last one).", "Combine Data \u2014 Data analysis usually gets more interesting when you combine multiple data sets to look for patterns. To illustrate this, I am going to introduce the PLUTO dataset which combines geographical data with information on each building. For this analysis, I am going to focus on residential cooperative and condominium buildings in Manhattan. I have created a .csv file which contains all 6,065 cooperative and condominium buildings in Manhattan geocoded with Latitude and Longitude information. Based on our understanding of the situation in which water tanks are necessary, I filtered this data set to only include buildings that are over six stories \u2014 there are 2,919 of them.", "My plan is to combine the dataframe on water tank inspections with the dataframe on coop/condo buildings to create one dataframe. In order to do this we need a key or unique identifier in each dataframe to match the data. In our case we have BBL which is a unique identifier for each building (based on the borough / block / lot of each building). We can then use Pandas to merge the df_cc dataframe with the df_summary dataframe.", "We can then determine how many coop/condo buildings in Manhattan which should have water towers were not inspected in the last 5 years \u2014 1,232 of them!", "Finally, using Plotly express we can create an interactive map (in one line of code!) which identifies Manhattan coops and condo buildings and color codes those which have not been inspected in the last 5 years in red. px.scatter_mapbox(dfnew, lat=\u201dLatitude\u201d, lon=\u201dLongitude\u201d, color=\u201dReported\u201d, hover_name=\u201dAddress\u201d, hover_data=a, color_discrete_map = {\u201cNever\u201d: \u201cred\u201d, \u201cYes\u201d: \u201cgreen\u201d}, zoom=14)", "Based on our preliminary analysis, there are 2,919 coop / condo buildings with water tanks in Manhattan and 1,232 never had a tank inspection \u2014 42.2% . This is a very significant number and hopefully an overstatement!", "My next step is to test a sampling of the buildings to (i) confirm the existence of a water tank (google map\u2019s satellite view or similar service can be used), I suspect that the premise that buildings greater than six stories require a water tank was an over simplification, and (ii) compare my results against the information provided via the NYC Health building tank search tool to confirm the findings.", "I welcome feedback, suggestions and am particularly interested to see how others build on this. I can be reached on Twitter @LonnieHalpern", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Real estate executive, attorney & angel investor. Passionate about innovation & technology in real estate, design thinking & data analytics."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F855c5776c566&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fexploring-new-york-city-water-tank-inspection-data-855c5776c566&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fexploring-new-york-city-water-tank-inspection-data-855c5776c566&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fexploring-new-york-city-water-tank-inspection-data-855c5776c566&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fexploring-new-york-city-water-tank-inspection-data-855c5776c566&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----855c5776c566--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----855c5776c566--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@lonniehalpern?source=post_page-----855c5776c566--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@lonniehalpern?source=post_page-----855c5776c566--------------------------------", "anchor_text": "Lonnie Halpern"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F43823e24dbce&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fexploring-new-york-city-water-tank-inspection-data-855c5776c566&user=Lonnie+Halpern&userId=43823e24dbce&source=post_page-43823e24dbce----855c5776c566---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F855c5776c566&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fexploring-new-york-city-water-tank-inspection-data-855c5776c566&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F855c5776c566&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fexploring-new-york-city-water-tank-inspection-data-855c5776c566&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://cooperator.com/article/roof-tanks-101/full", "anchor_text": "last century"}, {"url": "https://www.nytimes.com/2018/05/26/realestate/how-new-york-water-tanks-work.html", "anchor_text": "buildings over 6 stories"}, {"url": "http://rules.cityofnewyork.us/sites/default/files/adopted_rules_pdf/f-dohmh_04-03-15_a_ch_31.pdf", "anchor_text": "Chapter 31 of New York City\u2019s Administrative Code"}, {"url": "https://www1.nyc.gov/site/doh/business/permits-and-licenses/rooftop-drinking-water-tank-inspection-results.page", "anchor_text": "online tool to look up the inspection results of any building"}, {"url": "https://www1.nyc.gov/assets/home/downloads/pdf/reports/2015/NYC-Open-Data-Plan-2015.pdf", "anchor_text": "data is valuable and should be made accessible to everyone"}, {"url": "https://opendata.cityofnewyork.us/", "anchor_text": "https://opendata.cityofnewyork.us/"}, {"url": "https://stackoverflow.com/questions/tagged/pandas?sort=votes&pageSize=15", "anchor_text": "StackOverflow"}, {"url": "https://nbviewer.jupyter.org/github/LHalpern/nyc_water_tanks_jupyter_medium/blob/master/NYC_Watertower%20-%20June5data.ipynb", "anchor_text": "via nbviewer here"}, {"url": "https://github.com/LHalpern/nyc_water_tanks_jupyter_medium", "anchor_text": "GitHub"}, {"url": "https://www1.nyc.gov/site/planning/data-maps/open-data/dwn-pluto-mappluto.page", "anchor_text": "PLUTO dataset"}, {"url": "https://www1.nyc.gov/site/doh/business/permits-and-licenses/rooftop-drinking-water-tank-inspection-results.page", "anchor_text": "NYC Health building tank search tool"}, {"url": "https://twitter.com/LonnieHalpern", "anchor_text": "@LonnieHalpern"}, {"url": "https://medium.com/tag/data-science?source=post_page-----855c5776c566---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/real-estate?source=post_page-----855c5776c566---------------real_estate-----------------", "anchor_text": "Real Estate"}, {"url": "https://medium.com/tag/python?source=post_page-----855c5776c566---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/plotly?source=post_page-----855c5776c566---------------plotly-----------------", "anchor_text": "Plotly"}, {"url": "https://medium.com/tag/new-york?source=post_page-----855c5776c566---------------new_york-----------------", "anchor_text": "New York"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F855c5776c566&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fexploring-new-york-city-water-tank-inspection-data-855c5776c566&user=Lonnie+Halpern&userId=43823e24dbce&source=-----855c5776c566---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F855c5776c566&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fexploring-new-york-city-water-tank-inspection-data-855c5776c566&user=Lonnie+Halpern&userId=43823e24dbce&source=-----855c5776c566---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F855c5776c566&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fexploring-new-york-city-water-tank-inspection-data-855c5776c566&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----855c5776c566--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F855c5776c566&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fexploring-new-york-city-water-tank-inspection-data-855c5776c566&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----855c5776c566---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----855c5776c566--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----855c5776c566--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----855c5776c566--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----855c5776c566--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----855c5776c566--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----855c5776c566--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----855c5776c566--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----855c5776c566--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@lonniehalpern?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@lonniehalpern?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Lonnie Halpern"}, {"url": "https://medium.com/@lonniehalpern/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "8 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F43823e24dbce&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fexploring-new-york-city-water-tank-inspection-data-855c5776c566&user=Lonnie+Halpern&userId=43823e24dbce&source=post_page-43823e24dbce--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fusers%2F43823e24dbce%2Flazily-enable-writer-subscription&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fexploring-new-york-city-water-tank-inspection-data-855c5776c566&user=Lonnie+Halpern&userId=43823e24dbce&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}