{"url": "https://towardsdatascience.com/classifying-parkinsons-disease-through-image-analysis-2e7a152fafc9", "time": 1683013588.432699, "path": "towardsdatascience.com/classifying-parkinsons-disease-through-image-analysis-2e7a152fafc9/", "webpage": {"metadata": {"title": "Classifying Parkinson\u2019s disease through image analysis: Part 1 | by Robin T. White, PhD | Towards Data Science", "h1": "Classifying Parkinson\u2019s disease through image analysis: Part 1", "description": "Parkinson\u2019s disease is often associated with movement disorder symptoms such as tremors and rigidity. These can have a noticeable effect on the handwriting and sketching (drawing)of a person\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.ncbi.nlm.nih.gov/pmc/articles/PMC5592741/", "anchor_text": "original paper", "paragraph_index": 2}, {"url": "https://github.com/robintwhite", "anchor_text": "github", "paragraph_index": 22}], "all_paragraphs": ["Parkinson\u2019s disease is often associated with movement disorder symptoms such as tremors and rigidity. These can have a noticeable effect on the handwriting and sketching (drawing)of a person suffering from early stages of the disease [1]. Micrographia, are abnormally small undulations in a persons handwriting, however, have claimed to be difficult to interpret due to the variability in one\u2019s developed handwriting, language, proficiency and education etc [1]. As such, a study conducted in 2017 aimed to improve the diagnosis through a standardized analysis using spirals and waves. In this series of posts, we will analyze the raw images collected in that study and see if we can create a classifier for a patient having Parkinson\u2019s, and draw some conclusions along the way. The data we will be using is hosted on Kaggle [2] with special thanks to Kevin Mader for sharing the dataset upload.", "In this part 1, we will be conducting some exploratory data analysis and pre-processing the images to create some features that will hopefully be helpful in classification. I am choosing to NOT use a convolutional neural network (CNN) to simply classify the images as this will be black box \u2014 without any metric into the underlying differences between the curves/sketches. Instead, we are not simply performing a task of classifying but trying to use image processing to understand and quantify the differences. In a subsequent post, I will compare with a CNN.", "Before we begin, disclaimer that this is not meant to be any kind of medical study or test. Please refer to the original paper for details on the actual experiment, which I was not a part of.Zham P, Kumar DK, Dabnichki P, Poosapadi Arjunan S, Raghav S. Distinguishing Different Stages of Parkinson\u2019s Disease Using Composite Index of Speed and Pen-Pressure of Sketching a Spiral. Front Neurol. 2017;8:435. Published 2017 Sep 6. doi:10.3389/fneur.2017.00435", "First, let us take a look at the images, perform some basic segmentation and start poking around with some potential features of interest. We will be using pandas throughout to store the images and information. For those of you questioning whether you will read this section here is what we will get into: - Thresholding and cleaning- Thickness quantification through nearest neighbors- Skeletonization- Intersections and edge points", "We use a modified read and threshold function, mostly obtained from the original notebook by Kevin Mader on Kaggle [2]. Here, we have the option to perform a resizing when wanting to view the montage style images, like above and below. We first read in and invert the image so the drawings are white on black background, as well as resize if necessary. We also apply a small median filter.", "This project has quite a fair bit of code, I won\u2019t be posting it all here so please see the github link if you want to view the notebook or python script for more details.", "Lastly, for the read in, we also clean up the images by removing any small objects disconnected from the main sketch.", "This works by keeping only large enough components that are >1% of activated pixels; defined by cutoff. First label each separate object in the image and sum the areas for each label identified (that isn\u2019t 0). Keep the index if the count is more than 1% of the total. Perform negative sort to have the largest objects with label 1. Replace the old label number with the new ordered id.", "As an initial view of how different the drawings are, we can create a skeleton image and form a new data frame where each row is a single pixel coordinate of non-zero pixels in each image. We can then plot each of these curves on a single graph \u2014 after normalizing the positions. We won\u2019t be using this format of the data frame, this is just for visualization.", "As we can see there is strong consistency between healthy sketches. This makes sense considering the random motion that Parkinson\u2019s symptoms can cause.", "Next, we will try to quantify the thickness. For this, we will be using a distance map to give an approximation of the width of the drawings. The medial axis also returns a distance map, but skeletonize is cleaner as it does some pruning.", "Plotting the mean and standard deviation we see some correlation between the drawings. Mostly in the standard deviation which again makes sense considering the random impact, also the fact it is great and not less than healthy also makes sense.", "Due to the way that skeletonizing an image works, depending on the \u2018smoothness\u2019 of the line, there will be a higher number of end-points for more undulating curves. These are therefore some measure of the random movement compared with a smooth line. In addition, we can calculate the number of intersection points; a perfect curve would have no intersections and only two end-points. These are also useful in other image processing applications such as with road mapping.", "I won\u2019t go into the code too much here as there is a fair bit of cleaning required, however, I will try to explain what I did using some images. First, we calculate a nearest neighbors image of the skeleton of the curve. This gives us values of 2 everywhere, except a value of 1 at edge-points, and a value of 3 at intersections; this is when using a connectivity of 2 (the 8 nearest neighbors). Here is an image of the result, zoomed in.", "As you can see this works as expected, except we run into some issues if we want to get only one pixel intersection to properly quantify the number of intersections. The image on the right has three pixels with value 3, although this is only one intersection. We can clean this up with the following pseudo algorithm by isolating for these regions as the sum of these intersections is greater than the \u2018correct\u2019 intersection. We can sum the nearest neighbors (NN) image and threshold to isolate these. Connectivity 1 has direct neighbors, connected 2 includes diagonals.", "As you can see we now have a single pixel with value 3 at the intersection location. We can now simply sum these locations to quantify the number of intersection points. If we draw these on a curve we can see the result, below yellow are intersections and green are edge-points.", "If we plot the number of these for each drawing type we can see the fairly strong correlation:", "We can also see our initial estimate of a healthy curve having approximately 2 edge-points is also correct. There is a very high number of edge-points for Parkinson\u2019s wave drawings because these are usually quite \u2018sharp\u2019 instead of curved smoothly, this creates a high number of edge-points at the tips of these waves.", "Lastly, we can also check the correlation with the overall number of pixels in the skeleton image. This is related to the \u2018indirect\u2019 nature of the drawings. This quantification is very simple, we just sum the pixels greater than zero in a skeleton image.", "Not as strong as a relationship but still something.", "So far we have now read in, cleaned and obtained some potentially useful metrics, that help us not only understand the degree of micrographia but also can be used as inputs into a classifier such as Logistic Regression or Random Forest. In part 2 of this series we will perform classification using these metrics and also compare to a more powerful, but black-box, neural network. The advantage of using Random Forest is we will also be able to see which features provide the strongest impact to the model. Based on the above observations, do you have an intuition already about which features may be the most important?", "If you felt that any part of this post provided some useful information or just a bit of inspiration please follow me for more.", "You can find the source code on my github. This project is currently still under construction.", "Not used here, but for fun, we can also create a graph for the representation of each image since we have nodes and edges, where the nodes are the intersections or edge-points and the edges are the sections of the drawings connecting these.", "We used Networkx library for this, where each number is either a node or intersection with the colors corresponding to the length of the section of drawing connecting the nodes.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Computer Vision and Machine Learning. Applications Development Scientist"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F2e7a152fafc9&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fclassifying-parkinsons-disease-through-image-analysis-2e7a152fafc9&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fclassifying-parkinsons-disease-through-image-analysis-2e7a152fafc9&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fclassifying-parkinsons-disease-through-image-analysis-2e7a152fafc9&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fclassifying-parkinsons-disease-through-image-analysis-2e7a152fafc9&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----2e7a152fafc9--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----2e7a152fafc9--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@robint.white90?source=post_page-----2e7a152fafc9--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@robint.white90?source=post_page-----2e7a152fafc9--------------------------------", "anchor_text": "Robin T. White, PhD"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fc5eb85d3a614&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fclassifying-parkinsons-disease-through-image-analysis-2e7a152fafc9&user=Robin+T.+White%2C+PhD&userId=c5eb85d3a614&source=post_page-c5eb85d3a614----2e7a152fafc9---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F2e7a152fafc9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fclassifying-parkinsons-disease-through-image-analysis-2e7a152fafc9&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F2e7a152fafc9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fclassifying-parkinsons-disease-through-image-analysis-2e7a152fafc9&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@halacious?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Halacious"}, {"url": "https://unsplash.com/s/photos/science?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://www.ncbi.nlm.nih.gov/pmc/articles/PMC5592741/", "anchor_text": "original paper"}, {"url": "https://github.com/robintwhite", "anchor_text": "github"}, {"url": "https://towardsdatascience.com/computer-vision-and-the-ultimate-pong-ai-e6d70153fc45", "anchor_text": "Computer Vision and the Ultimate Pong AI"}, {"url": "https://medium.com/analytics-vidhya/minecraft-mapper-ab4478e98297", "anchor_text": "Minecraft Mapper"}, {"url": "https://www.kaggle.com/kmader/parkinsons-drawings", "anchor_text": "https://www.kaggle.com/kmader/parkinsons-drawings"}, {"url": "https://medium.com/tag/computer-vision?source=post_page-----2e7a152fafc9---------------computer_vision-----------------", "anchor_text": "Computer Vision"}, {"url": "https://medium.com/tag/data-science?source=post_page-----2e7a152fafc9---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/image-processing?source=post_page-----2e7a152fafc9---------------image_processing-----------------", "anchor_text": "Image Processing"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----2e7a152fafc9---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/health?source=post_page-----2e7a152fafc9---------------health-----------------", "anchor_text": "Health"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F2e7a152fafc9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fclassifying-parkinsons-disease-through-image-analysis-2e7a152fafc9&user=Robin+T.+White%2C+PhD&userId=c5eb85d3a614&source=-----2e7a152fafc9---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F2e7a152fafc9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fclassifying-parkinsons-disease-through-image-analysis-2e7a152fafc9&user=Robin+T.+White%2C+PhD&userId=c5eb85d3a614&source=-----2e7a152fafc9---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F2e7a152fafc9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fclassifying-parkinsons-disease-through-image-analysis-2e7a152fafc9&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----2e7a152fafc9--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F2e7a152fafc9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fclassifying-parkinsons-disease-through-image-analysis-2e7a152fafc9&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----2e7a152fafc9---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----2e7a152fafc9--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----2e7a152fafc9--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----2e7a152fafc9--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----2e7a152fafc9--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----2e7a152fafc9--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----2e7a152fafc9--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----2e7a152fafc9--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----2e7a152fafc9--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@robint.white90?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@robint.white90?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Robin T. White, PhD"}, {"url": "https://medium.com/@robint.white90/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "93 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fc5eb85d3a614&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fclassifying-parkinsons-disease-through-image-analysis-2e7a152fafc9&user=Robin+T.+White%2C+PhD&userId=c5eb85d3a614&source=post_page-c5eb85d3a614--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F3f1d8826832f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fclassifying-parkinsons-disease-through-image-analysis-2e7a152fafc9&newsletterV3=c5eb85d3a614&newsletterV3Id=3f1d8826832f&user=Robin+T.+White%2C+PhD&userId=c5eb85d3a614&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}