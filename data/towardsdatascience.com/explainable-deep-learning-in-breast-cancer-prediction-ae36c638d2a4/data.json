{"url": "https://towardsdatascience.com/explainable-deep-learning-in-breast-cancer-prediction-ae36c638d2a4", "time": 1683003480.723723, "path": "towardsdatascience.com/explainable-deep-learning-in-breast-cancer-prediction-ae36c638d2a4/", "webpage": {"metadata": {"title": "Explainable Deep Learning in Breast Cancer Prediction | by Yu Huang, M.D., M.S. in CS | Towards Data Science", "h1": "Explainable Deep Learning in Breast Cancer Prediction", "description": "Advanced machine learning models (e.g., Random Forest, deep learning models, etc.) are generally considered not explainable [1][2]. As described in [1][2][3][4], those models largely remain black\u2026"}, "outgoing_paragraph_urls": [{"url": "https://en.wikipedia.org/wiki/Convolutional_neural_network", "anchor_text": "Convolutional Neural Network (ConvNet)", "paragraph_index": 1}, {"url": "https://www.kaggle.com/kernels/scriptcontent/2064134/data", "anchor_text": "Kaggle", "paragraph_index": 2}, {"url": "https://scikit-image.org/docs/stable/auto_examples/segmentation/plot_segmentations.html", "anchor_text": "Quickshift", "paragraph_index": 15}, {"url": "https://en.wikipedia.org/wiki/Convolutional_neural_network", "anchor_text": "ConvNet", "paragraph_index": 31}, {"url": "https://arxiv.org/pdf/1602.04938.pdf", "anchor_text": "\u201cWhy Should I Trust You?\u201d Explaining the Predictions of Any Classifier", "paragraph_index": 34}, {"url": "https://towardsdatascience.com/explainable-machine-learning-for-healthcare-7e408f8e5130", "anchor_text": "Explainable Machine Learning for Healthcare", "paragraph_index": 35}, {"url": "https://github.com/marcotcr/lime/blob/master/doc/notebooks/Tutorial%20-%20Image%20Classification%20Keras.ipynb", "anchor_text": "LIME tutorial on image classification", "paragraph_index": 36}, {"url": "https://christophm.github.io/interpretable-ml-book/", "anchor_text": "Interpretable Machine Learning, A Guide for Making Black Box Models Explainable", "paragraph_index": 37}, {"url": "https://www.kaggle.com/paultimothymooney/predicting-idc-in-breast-cancer-histology-images/data", "anchor_text": "Predicting IDC in Breast Cancer Histology Images", "paragraph_index": 38}], "all_paragraphs": ["Advanced machine learning models (e.g., Random Forest, deep learning models, etc.) are generally considered not explainable [1][2]. As described in [1][2][3][4], those models largely remain black boxes, and understanding the reasons behind their prediction results for healthcare is very important in assessing trust if a doctor plans to take actions to treat a disease (e.g., cancer) based on a prediction result. In [2], I used the Wisconsin Breast Cancer Diagnosis (WBCD) tabular dataset to present how to use the Local Interpretable Model-agnostic Explanations (LIME) method to explain the prediction results of a Random Forest model in breast cancer diagnosis.", "In this article, I use the Kaggle Breast Cancer Histology Images (BCHI) dataset [5] to demonstrate how to use LIME to explain the image prediction results of a 2D Convolutional Neural Network (ConvNet) for the Invasive Ductal Carcinoma (IDC) breast cancer diagnosis.", "The BCHI dataset [5] can be downloaded from Kaggle. As described in [5], the dataset consists of 5,547 50x50 pixel RGB digital images of H&E-stained breast histopathology samples. These images are labeled as either IDC or non-IDC. There are 2,788 IDC images and 2,759 non-IDC images. Those images have already been transformed into Numpy arrays and stored in the file X.npy. Similarly the corresponding labels are stored in the file Y.npy in Numpy array format.", "Once the X.npy and Y.npy files have been downloaded into a local computer, they can be loaded into memory as Numpy arrays as follows:", "The following are two of the data samples, the image on the left is labeled as 0 (non-IDC) and the image on the right is labeled as 1 (IDC).", "In the original dataset files, all the data samples labeled as 0 (non-IDC) are put before the data samples labeled as 1 (IDC). To avoid artificial data patterns, the dataset is randomly shuffled as follows:", "The pixel value in an IDC image is in the range of [0, 255], while a typical deep learning model works the best when the value of input data is in the range of [0, 1] or [-1, 1]. The class Scale below is to transform the pixel value of IDC images into the range of [0, 1].", "The dataset is divided into three parts, 80% for model training and validation (1,000 for validation and the rest of 80% for training) , and 20% for model testing.", "The BCHI dataset [5] consists of images and thus a 2D ConvNet model is selected for IDC prediction.", "Similarly to [5], the function getKerasCNNModel() below creates a 2D ConvNet for the IDC image classification.", "The class KerasCNN is to wrapper the 2D ConvNet model as a sklearn pipeline component so that it can be combined with other data preprocessing components such as Scale into a pipeline.", "As described before, I use LIME to explain the ConvNet model prediction results in this article.", "Similarly to [1][2], I make a pipeline to wrap the ConvNet model for the integration with LIME API.", "The ConvNet model is trained as follows so that it can be called by LIME for model prediction later on.", "As described in [1][2], the LIME method supports different types of machine learning model explainers for different types of datasets such as image, text, tabular data, etc. The LIME image explainer is selected in this article because the dataset consists of images.", "The 2D image segmentation algorithm Quickshift is used for generating LIME super pixels (i.e., segments) [1].", "Once the ConvNet model has been trained, given a new IDC image, the explain_instance() method of the LIME image explainer can be called to generate an explanation of the model prediction.", "An explanation of an image prediction consists of a template image and a corresponding mask image. These images can be used to explain a ConvNet model prediction result in different ways.", "Explanation 1: Prediction of Positive IDC (IDC: 1)", "Figure 3 shows a positive IDC image for explaining model prediction via LIME.", "The code below is to generate an explanation object explanation_1 of the model prediction for the image IDC_1_sample (IDC: 1) in Figure 3.", "In this explanation, white color is used to indicate the portion of image that supports the model prediction (IDC: 1).", "Once the explanation of the model prediction is obtained, its method get_image_and_mask() can be called to obtain the template image and the corresponding mask image (super pixels):", "Figure 4 shows the hidden portion of given IDC image in gray color. The white portion of the image indicates the area of the given IDC image that supports the model prediction of positive IDC.", "The code below is to show the boundary of the area of the IDC image in yellow that supports the model prediction of positive IDC (see Figure 5).", "Explanation 2: Prediction of non-IDC (IDC: 0)", "Figure 6 shows a non-IDC image for explaining model prediction via LIME.", "The code below is to generate an explanation object explanation_2 of the model prediction for the image IDC_0_sample in Figure 6. In this explanation, white color is used to indicate the portion of image that supports the model prediction of non-IDC.", "Once the explanation of the model prediction is obtained, its method get_image_and_mask() can be called to obtain the template image and the corresponding mask image (super pixels):", "Figure 7 shows the hidden area of the non-IDC image in gray. The white portion of the image indicates the area of the given non-IDC image that supports the model prediction of non-IDC.", "The code below is to show the boundary of the area of the IDC image in yellow that supports the model prediction of non-IDC (see Figure 8).", "In this article, I used the Kaggle BCHI dataset [5] to show how to use the LIME image explainer [3] to explain the IDC image prediction results of a 2D ConvNet model in IDC breast cancer diagnosis. Explanations of model prediction of both IDC and non-IDC were provided by setting the number of super-pixels/features (i.e., the num_features parameter in the method get_image_and_mask()) to 20.", "I observed that the explanation results are sensitive to the choice of the number of super pixels/features. Domain knowledge is required to adjust this parameter to achieve appropriate model prediction explanation. Quality of the input data (images in this case) is also very important for a reasonable result. Accuracy can be improved by adding more samples.", "A Jupyter notebook with all the source code used in this article is available in Github [6].", "[1] M. T. Ribeiro, S. Singh, and C. Guestrin, \u201cWhy Should I Trust You?\u201d Explaining the Predictions of Any Classifier", "[2] Y. Huang, Explainable Machine Learning for Healthcare", "[3] LIME tutorial on image classification", "[4] Interpretable Machine Learning, A Guide for Making Black Box Models Explainable", "[5] Predicting IDC in Breast Cancer Histology Images", "DISCLOSURE STATEMENT: \u00a9 2020. Opinions expressed in this article are those of the author and do not necessarily represent those of Argonne National Laboratory.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Was Principal Software Engineer at Argonne with a demonstrated history of working in research, the biomedical field, and industry, with special interests in AI"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fae36c638d2a4&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fexplainable-deep-learning-in-breast-cancer-prediction-ae36c638d2a4&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fexplainable-deep-learning-in-breast-cancer-prediction-ae36c638d2a4&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fexplainable-deep-learning-in-breast-cancer-prediction-ae36c638d2a4&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fexplainable-deep-learning-in-breast-cancer-prediction-ae36c638d2a4&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----ae36c638d2a4--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----ae36c638d2a4--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@jadezhang244?source=post_page-----ae36c638d2a4--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@jadezhang244?source=post_page-----ae36c638d2a4--------------------------------", "anchor_text": "Yu Huang, M.D., M.S. in CS"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F759013c23ad5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fexplainable-deep-learning-in-breast-cancer-prediction-ae36c638d2a4&user=Yu+Huang%2C+M.D.%2C+M.S.+in+CS&userId=759013c23ad5&source=post_page-759013c23ad5----ae36c638d2a4---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fae36c638d2a4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fexplainable-deep-learning-in-breast-cancer-prediction-ae36c638d2a4&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fae36c638d2a4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fexplainable-deep-learning-in-breast-cancer-prediction-ae36c638d2a4&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://en.wikipedia.org/wiki/Convolutional_neural_network", "anchor_text": "Convolutional Neural Network (ConvNet)"}, {"url": "https://www.kaggle.com/kernels/scriptcontent/2064134/data", "anchor_text": "Kaggle"}, {"url": "https://scikit-image.org/docs/stable/auto_examples/segmentation/plot_segmentations.html", "anchor_text": "Quickshift"}, {"url": "https://en.wikipedia.org/wiki/Convolutional_neural_network", "anchor_text": "ConvNet"}, {"url": "https://arxiv.org/pdf/1602.04938.pdf", "anchor_text": "\u201cWhy Should I Trust You?\u201d Explaining the Predictions of Any Classifier"}, {"url": "https://towardsdatascience.com/explainable-machine-learning-for-healthcare-7e408f8e5130", "anchor_text": "Explainable Machine Learning for Healthcare"}, {"url": "https://github.com/marcotcr/lime/blob/master/doc/notebooks/Tutorial%20-%20Image%20Classification%20Keras.ipynb", "anchor_text": "LIME tutorial on image classification"}, {"url": "https://christophm.github.io/interpretable-ml-book/", "anchor_text": "Interpretable Machine Learning, A Guide for Making Black Box Models Explainable"}, {"url": "https://www.kaggle.com/paultimothymooney/predicting-idc-in-breast-cancer-histology-images/data", "anchor_text": "Predicting IDC in Breast Cancer Histology Images"}, {"url": "https://github.com/yuhuang3/machine-learning/tree/master/lime/image_explainer", "anchor_text": "Jupyter notebook"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----ae36c638d2a4---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/explainable-ai?source=post_page-----ae36c638d2a4---------------explainable_ai-----------------", "anchor_text": "Explainable Ai"}, {"url": "https://medium.com/tag/healthcare?source=post_page-----ae36c638d2a4---------------healthcare-----------------", "anchor_text": "Healthcare"}, {"url": "https://medium.com/tag/cnn?source=post_page-----ae36c638d2a4---------------cnn-----------------", "anchor_text": "Cnn"}, {"url": "https://medium.com/tag/towards-data-science?source=post_page-----ae36c638d2a4---------------towards_data_science-----------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fae36c638d2a4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fexplainable-deep-learning-in-breast-cancer-prediction-ae36c638d2a4&user=Yu+Huang%2C+M.D.%2C+M.S.+in+CS&userId=759013c23ad5&source=-----ae36c638d2a4---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fae36c638d2a4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fexplainable-deep-learning-in-breast-cancer-prediction-ae36c638d2a4&user=Yu+Huang%2C+M.D.%2C+M.S.+in+CS&userId=759013c23ad5&source=-----ae36c638d2a4---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fae36c638d2a4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fexplainable-deep-learning-in-breast-cancer-prediction-ae36c638d2a4&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----ae36c638d2a4--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fae36c638d2a4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fexplainable-deep-learning-in-breast-cancer-prediction-ae36c638d2a4&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----ae36c638d2a4---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----ae36c638d2a4--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----ae36c638d2a4--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----ae36c638d2a4--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----ae36c638d2a4--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----ae36c638d2a4--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----ae36c638d2a4--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----ae36c638d2a4--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----ae36c638d2a4--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@jadezhang244?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@jadezhang244?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Yu Huang, M.D., M.S. in CS"}, {"url": "https://medium.com/@jadezhang244/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "165 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F759013c23ad5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fexplainable-deep-learning-in-breast-cancer-prediction-ae36c638d2a4&user=Yu+Huang%2C+M.D.%2C+M.S.+in+CS&userId=759013c23ad5&source=post_page-759013c23ad5--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F509d77902f1f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fexplainable-deep-learning-in-breast-cancer-prediction-ae36c638d2a4&newsletterV3=759013c23ad5&newsletterV3Id=509d77902f1f&user=Yu+Huang%2C+M.D.%2C+M.S.+in+CS&userId=759013c23ad5&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}