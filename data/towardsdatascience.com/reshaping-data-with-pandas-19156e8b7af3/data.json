{"url": "https://towardsdatascience.com/reshaping-data-with-pandas-19156e8b7af3", "time": 1683004154.8786812, "path": "towardsdatascience.com/reshaping-data-with-pandas-19156e8b7af3/", "webpage": {"metadata": {"title": "Reshaping Data with Pandas. It\u2019s Datafied! \u2014 Python Playbook | by Pavneet Singh | Towards Data Science", "h1": "Reshaping Data with Pandas", "description": "Hey, fellow #Pythonistas! Here I am with a column of write-ups to share some super cool techniques in Python to play around with your data. For your reference, I\u2019ll be sharing the complete step by\u2026"}, "outgoing_paragraph_urls": [{"url": "https://link.medium.com/R4o2U6Fok4", "anchor_text": "https://link.medium.com/R4o2U6Fok4", "paragraph_index": 44}, {"url": "https://link.medium.com/zcBzu2Jok4", "anchor_text": "https://link.medium.com/zcBzu2Jok4", "paragraph_index": 45}, {"url": "http://linkedin.com/in/pavneets", "anchor_text": "linkedin.com/in/pavneets", "paragraph_index": 47}], "all_paragraphs": ["Hey, fellow #Pythonistas! Here I am with a column of write-ups to share some super cool techniques in Python to play around with your data. For your reference, I\u2019ll be sharing the complete step by step code through an Azure Notebook at the end of each write-up.", "So without further ado let\u2019s dive into the Data Reshaping functions available in the Pandas library!", "The data source we will be playing around in this write up is the Sample Superstore data-set. Most of you might be already familiar with it as it is the default data source provided in Tableau. You can download it from my Azure Notebook as well.", "To begin with, you might be thinking: what exactly am I referring to as the shape of a data-set?", "The way a data-set is arranged into rows and columns is referred to as the shape of data.", "First, let\u2019s import the data into a Pandas data-frame using Python.", "It is a good practice to check whether the complete data-set has been imported successfully into the Pandas data frame from our data source i.e. an excel file in our case. This can be done by checking the number of rows and columns i.e. the shape property of the data frame.", "So we have successfully imported 9994 rows and 21 columns as per the excel sheet into our Pandas data frame.", "Data Shape - Long Data or Wide Data?", "Each row in a Vertical or Long data represents one observation belonging to a particular category/instance so it is easier to work with for analytical purposes as it is granular in nature. So we can infer that our data is of Vertical or Long shape.", "Each column is considered a variable with multiple distinct values across which we can derive certain insights and prepare reports from our data set.", "To understand Horizontal or Wide data, let\u2019s get onto analyzing the data across various variables and change the shape of our data.", "Let\u2019s first shorten our data frame for further analysis by only keeping a few columns across which we want to analyze the data by creating a pivot table.", "I created a list of columns and created another smaller data frame on which we can reshape our data and do further analysis. This is a handy technique to stay focused on the columns we have to do further analysis on and prevent unnecessary processing load.", "Use Case: Consider a use case that we have to prepare report across all Regions and Segments aggregating the Sales, Discount, Profit and Quantity for each.", "We can prepare it easily by using a pivot table as we would do in excel. Pandas library provides a pivot_table() function which operates on an existing data-frame and accepts certain parameters across which the aggregation is to be done. Let\u2019s try it out!", "Note: By default, Pivot Table calculates the mean for all the numeric columns.", "Here we have a neat Pivot Table just as required for our use case. Now let's check its shape.", "Hmm, that\u2019s weird why is it showing up only 4 columns whereas we can see 6 of them ?! This is because we chose the two columns Region and Segment as Index of our Pivot Table and now we have a multi-level index. To reset the index we can use the reset_index() function.", "Note: inplace=True means that we will be updating the data frame itself instead of just checking the output of the transformation we want. So, only use it once your are sure you want to update the data frame itself as per the transformation you are doing.", "Now we have a data set which no longer has individual observations in each row but rather aggregations across different variables. This is the Horizontal or wide data shape which is suitable for reporting or presentation purposes.", "Use Case: What if I want to see the Region and Segment which has the highest mean profit?", "The sort_values() function can be used in such a scenario.", "Note: I\u2019ve used reset_index(). It will restart the index values from 0 till 11 for the sorted values so we can clearly recognize the rankings by mean profit. Since I\u2019ve not used inplace=True, this change will not affect the actual data frame.", "We can also perform other mathematical aggregations like sum or size(frequency of occurrence) by passing them individually or as a list, if required, to the aggfunc option. Let\u2019s try it out.", "We can now see that it resulted in a multi-index data frame with mean and sum calculations for each numeric column.", "Use Case: Now what if we have the data in the form of a Pivot Table but we want to reshape it to a long data shape so we can perform some analytics in it?", "Pandas Melt function is at your rescue!", "Let's reshape the pivot table we had created earlier, back into the long data shape with each row representing an observation.", "In the Melt function we pass a list as identifier variables i.e. id_vars and all other columns are considered as the measure variables which get listed under the variable and value columns. The custom column name for variable and value can also be passed as desired.", "Viola! We un-pivoted or melted the data into the long form from our Pivot Table we had.", "Let\u2019s consider the Pivot Table again with the Region and Segment multi level index we had created.", "Use Case: What if I wanted to see each of the measures i.e. Discount, Sales, Profit and Quantity across each Segment at the columns level.", "Unstack helps us achieve this by placing the row values from the innermost index level i.e. Segment to the columns. Let\u2019s see it in action.", "This is just another way to reshape the data as per our requirement to present it in a wide format.", "Let\u2019s play around a bit more and use the alter ego of Unstack i.e. the Stack function! Just as Unstack moved the innermost index row values to the columns, Stack does the opposite by moving the innermost column values to the rows. Let\u2019s try it out on our Unstacked dataframe.", "Note: Stack and Unstack are meant for multi level index data frames only.", "Lastly, we\u2019ll play around with the Pivot function which is another handy tool to reshape our data from long to wide shape. It is capable of working with non-numeric columns as well as what it basically does is pivoting without aggregation.", "Before calling pivot we need to ensure that our data does not have rows with duplicate values for the specified columns i.e. one index/column pair. On the other hand Pivot Table function is capable of handling duplicate values as numeric values are aggregated by default.", "Since Pivot function cannot handle duplicate values for the specified columns, I\u2019ll be referring to the Pivot Table \u2014 pivot_table_df we had created earlier to demonstrate its use.", "Use case: Consider a use case where I want to see Sales across Region and Segment in report and Profit across Region and Segment in another. Let\u2019s use the Pivot function to derive them from this pivot table we had created earlier.", "Here we have both the reports in wide shape using the Pivot function as desired!", "To explore more, here is the official link to the Pandas documentation page for reshaping data functions.", "That\u2019s all for now! Feel free to play around with the functions and Happy Reshaping till next time!", "\u201cLet\u2019s POP those filters in Tableau!\u201d by Pavneet Singh https://link.medium.com/R4o2U6Fok4", "\u201cStacked legend filter, Dual-axis Density Marks Map & Dual-axis Scatter Plot in Tableau\u201d by Pavneet Singh https://link.medium.com/zcBzu2Jok4", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Analytics Enthusiast | Python | SQL | Tableau | Alteryx | PowerBI | Azure Data Factory | linkedin.com/in/pavneets"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F19156e8b7af3&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Freshaping-data-with-pandas-19156e8b7af3&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Freshaping-data-with-pandas-19156e8b7af3&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Freshaping-data-with-pandas-19156e8b7af3&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Freshaping-data-with-pandas-19156e8b7af3&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----19156e8b7af3--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----19156e8b7af3--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@Datafied?source=post_page-----19156e8b7af3--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@Datafied?source=post_page-----19156e8b7af3--------------------------------", "anchor_text": "Pavneet Singh"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fb045b53e0b22&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Freshaping-data-with-pandas-19156e8b7af3&user=Pavneet+Singh&userId=b045b53e0b22&source=post_page-b045b53e0b22----19156e8b7af3---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F19156e8b7af3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Freshaping-data-with-pandas-19156e8b7af3&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F19156e8b7af3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Freshaping-data-with-pandas-19156e8b7af3&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://pandas.pydata.org/pandas-docs/stable/user_guide/reshaping.html", "anchor_text": "Reshaping and pivot tables - pandas 1.0.1 documentationData is often stored in so-called \"stacked\" or \"record\" format: For the curious here is how the above was created: To\u2026pandas.pydata.org"}, {"url": "https://notebooks.azure.com/pavneet-singh/projects/reshaping-data-with-python", "anchor_text": "https://notebooks.azure.com/pavneet-singh/projects/reshaping-data-with-python"}, {"url": "https://towardsdatascience.com/3p-strategy-to-be-successful-for-entry-level-programmers-bbf5dbbcb981", "anchor_text": "https://towardsdatascience.com/3p-strategy-to-be-successful-for-entry-level-programmers-bbf5dbbcb981"}, {"url": "https://link.medium.com/R4o2U6Fok4", "anchor_text": "https://link.medium.com/R4o2U6Fok4"}, {"url": "https://link.medium.com/zcBzu2Jok4", "anchor_text": "https://link.medium.com/zcBzu2Jok4"}, {"url": "https://medium.com/tag/programming?source=post_page-----19156e8b7af3---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/tag/data-science?source=post_page-----19156e8b7af3---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/python?source=post_page-----19156e8b7af3---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/pandas?source=post_page-----19156e8b7af3---------------pandas-----------------", "anchor_text": "Pandas"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F19156e8b7af3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Freshaping-data-with-pandas-19156e8b7af3&user=Pavneet+Singh&userId=b045b53e0b22&source=-----19156e8b7af3---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F19156e8b7af3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Freshaping-data-with-pandas-19156e8b7af3&user=Pavneet+Singh&userId=b045b53e0b22&source=-----19156e8b7af3---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F19156e8b7af3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Freshaping-data-with-pandas-19156e8b7af3&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----19156e8b7af3--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F19156e8b7af3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Freshaping-data-with-pandas-19156e8b7af3&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----19156e8b7af3---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----19156e8b7af3--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----19156e8b7af3--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----19156e8b7af3--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----19156e8b7af3--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----19156e8b7af3--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----19156e8b7af3--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----19156e8b7af3--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----19156e8b7af3--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@Datafied?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@Datafied?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Pavneet Singh"}, {"url": "https://medium.com/@Datafied/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "67 Followers"}, {"url": "http://linkedin.com/in/pavneets", "anchor_text": "linkedin.com/in/pavneets"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fb045b53e0b22&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Freshaping-data-with-pandas-19156e8b7af3&user=Pavneet+Singh&userId=b045b53e0b22&source=post_page-b045b53e0b22--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fe1de5f9bef34&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Freshaping-data-with-pandas-19156e8b7af3&newsletterV3=b045b53e0b22&newsletterV3Id=e1de5f9bef34&user=Pavneet+Singh&userId=b045b53e0b22&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}