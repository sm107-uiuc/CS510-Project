{"url": "https://towardsdatascience.com/grid-search-for-parameter-tunning-3c6ff94e7a25", "time": 1683015053.074543, "path": "towardsdatascience.com/grid-search-for-parameter-tunning-3c6ff94e7a25/", "webpage": {"metadata": {"title": "Grid search for parameter tuning. Learn this easy and simple technique to\u2026 | by Magdalena Konkiewicz | Towards Data Science", "h1": "Grid search for parameter tuning", "description": "Once you have built a machine learning model you would like to tune its parameters for optimal performance. The best parameters would be different for each data set therefore they need adjusting so\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.aboutdatablog.com/post/learn-how-to-use-grid-search-for-parameter-tunning", "anchor_text": "Learn how to use grid search for parameter tunning", "paragraph_index": 27}, {"url": "https://www.aboutdatablog.com/", "anchor_text": "aboutdatablog.com", "paragraph_index": 28}, {"url": "https://medium.com/subscribe/@konkiewicz.m", "anchor_text": "email list", "paragraph_index": 28}, {"url": "https://medium.com/@konkiewicz.m/membership", "anchor_text": "here", "paragraph_index": 28}, {"url": "http://aboutdatablog.com", "anchor_text": "aboutdatablog.com", "paragraph_index": 31}, {"url": "https://medium.com/@konkiewicz.m/membership", "anchor_text": "https://medium.com/@konkiewicz.m/membership", "paragraph_index": 31}], "all_paragraphs": ["Once you have built a machine learning model you would like to tune its parameters for optimal performance. The best parameters would be different for each data set therefore they need adjusting so the algorithm can gain its maximum potential.", "I have seen many beginner data scientists doing parameter tuning by hand. This means running the model, then changing one or multiple parameters within the notebook, waiting for the model to run, gathering results, and then repeating the process again and again. Usually, people forget on the way which parameters were the best and they need to do it again.", "In general, the above strategy is not the most efficient. Luckily this process could be easily was automated thanks to the authors of the sci-kit learn library who added GridSeachCV.", "GridSearchCV is an alternative to the naive method I have described above. Instead of manually tweaking the parameters and rerunning the algorithm several times you can list all parameter values that you would like the algorithm try and pass it to GridSeachCV.", "GridSearchCV will try all combinations of those parameters, evaluate the results using cross-validation, and the scoring metric you provide. In the end, it will spit the best parameters for your data set.", "GridSearchCV can be used with any supervised learning Machine Learning algorithm that is in the sci-kit learn library. It will work both for regression and classification if you provide an appropriate metric.", "Let\u2019s see how it works with a real example.", "In order to illustrate let\u2019s load the Iris data set. This data set has 150 examples of three different Iris species. The data set has no missing values so there will be no data cleaning needed.", "Now let\u2019s divide our data set to train and test.", "Once we have divided the data set we can set up the grid-search with the algorithm of our choice. In our case, we will use it to tune the random forest classifier.", "In the code above we first set up the Random Forest Classifier by using a constructor with no parameters. Then we define parameters and the values to try for each parameter in the grid_values variable. \u2018grid_values\u2019 variable is then passed to the GridSearchCV together with the random forest object (that we have created before) and the name of the scoring function (in our case \u2018accuracy\u2019). Last, by not least we fit it all by calling the fit function on the grid search object.", "Now in order to find the best parameters, you can use the best_params_ attribute:", "We are getting the highest accuracy with the trees that are six levels deep, using 75 % of the features for max_features parameter and using 10 estimators.", "This has been much easier than trying all parameters by hand.", "Now you can use a grid search object to make new predictions using the best parameters.", "And run a classification report on the test set to see how well the model is doing on the new data.", "You can see detailed results for accuracy, recall, precision, and f-score for all of the classes.", "Note that we have used accuracy for tuning the model. This may not be the best choice. We can actually use other metrics such as precision, recall, and, f-score. So let\u2019s do that.", "In the code above we set up four scoring metrics: accuracy, precision, recall, and f-score and we store them in the list that is later on passed to grid search as a scoring parameter. We also set the refit parameter to be equal to one of the scoring functions. This is f-score is our case.", "Once we run it we can get the best parameters for f-score:", "Additionally, we can use the cv_results_ attribute to learn more about the set up of the grid_search.", "If you want to see results for other metrics you can use cv_results[\u2018mean_test_<metric_name>\u2019]. So in order to get results for the recall that we have set up before as one of the scoring functions you can use:", "Above we can see all recall values for grid search param combinations.", "Have you noticed that the list of all recall results was quite long? It actually had 100 elements. This means there were 100 different parameter combinations that the grid have has tried. This is a lot and can be very time-consuming especially on large data sets.", "In our example, grid search did five-fold cross-validation for 100 different Random forest setups. Imagine if we had more parameters to tune!", "There is an alternative to GridSearchCV called RandomizedSearchCV. Instead of trying all parameters it only samples a subset of parameters from a given distribution therefore could be faster and more effective.", "In this article, you have learned how to use a grid search to optimize your parameter tuning. It is time to try your newly acquired skill on a different data set and using a different model than random forest. Happy coding!", "Originally published at aboutdatablog.com: Learn how to use grid search for parameter tunning, on October 8, 2020.", "PS: I am writing articles that explain basic Data Science concepts in a simple and comprehensible manner on Medium and aboutdatablog.com. You can subscribe to my email list to get notified every time I write a new article. And if you are not a Medium member yet you can join here.", "Below there are some other posts you may enjoy:", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Scientist, NLP, ML practitioner, and educator. Blogging from Medium and aboutdatablog.com. Support my writing: https://medium.com/@konkiewicz.m/membership"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F3c6ff94e7a25&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgrid-search-for-parameter-tunning-3c6ff94e7a25&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgrid-search-for-parameter-tunning-3c6ff94e7a25&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgrid-search-for-parameter-tunning-3c6ff94e7a25&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgrid-search-for-parameter-tunning-3c6ff94e7a25&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----3c6ff94e7a25--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----3c6ff94e7a25--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@konkiewicz.m?source=post_page-----3c6ff94e7a25--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@konkiewicz.m?source=post_page-----3c6ff94e7a25--------------------------------", "anchor_text": "Magdalena Konkiewicz"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F6ba7ed0ad871&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgrid-search-for-parameter-tunning-3c6ff94e7a25&user=Magdalena+Konkiewicz&userId=6ba7ed0ad871&source=post_page-6ba7ed0ad871----3c6ff94e7a25---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F3c6ff94e7a25&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgrid-search-for-parameter-tunning-3c6ff94e7a25&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F3c6ff94e7a25&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgrid-search-for-parameter-tunning-3c6ff94e7a25&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://pixabay.com/users/pollydot-160618/?utm_source=link-attribution&utm_medium=referral&utm_campaign=image&utm_content=337695", "anchor_text": "PollyDot"}, {"url": "https://pixabay.com/?utm_source=link-attribution&utm_medium=referral&utm_campaign=image&utm_content=337695", "anchor_text": "Pixabay"}, {"url": "https://pixabay.com/users/ndv-2997446/?utm_source=link-attribution&utm_medium=referral&utm_campaign=image&utm_content=1548260", "anchor_text": "Nicol\u00e1s Dami\u00e1n Visceglio"}, {"url": "https://pixabay.com/?utm_source=link-attribution&utm_medium=referral&utm_campaign=image&utm_content=1548260", "anchor_text": "Pixabay"}, {"url": "https://www.aboutdatablog.com/post/learn-how-to-use-grid-search-for-parameter-tunning", "anchor_text": "Learn how to use grid search for parameter tunning"}, {"url": "https://www.aboutdatablog.com/", "anchor_text": "aboutdatablog.com"}, {"url": "https://medium.com/subscribe/@konkiewicz.m", "anchor_text": "email list"}, {"url": "https://medium.com/@konkiewicz.m/membership", "anchor_text": "here"}, {"url": "https://towardsdatascience.com/9-things-you-did-not-know-about-jupyter-notebook-d0d995a8efb3", "anchor_text": "9 things you did not know about jupyter notebookBoost your productivity with these tipstowardsdatascience.com"}, {"url": "https://towardsdatascience.com/best-data-science-books-be1ab472876d", "anchor_text": "Best Data Science BooksTop 3 books that will help you learn Data Sciencetowardsdatascience.com"}, {"url": "https://towardsdatascience.com/medium-writers-you-should-follow-as-an-aspiring-data-scientist-13d5a7e6c5dc", "anchor_text": "Medium writers you should follow as an aspiring Data ScientistMy top 10 favorite Data Science Bloggers that will make your learning journey easier.towardsdatascience.com"}, {"url": "https://medium.com/tag/data-science?source=post_page-----3c6ff94e7a25---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----3c6ff94e7a25---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/technology?source=post_page-----3c6ff94e7a25---------------technology-----------------", "anchor_text": "Technology"}, {"url": "https://medium.com/tag/programming?source=post_page-----3c6ff94e7a25---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----3c6ff94e7a25---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F3c6ff94e7a25&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgrid-search-for-parameter-tunning-3c6ff94e7a25&user=Magdalena+Konkiewicz&userId=6ba7ed0ad871&source=-----3c6ff94e7a25---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F3c6ff94e7a25&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgrid-search-for-parameter-tunning-3c6ff94e7a25&user=Magdalena+Konkiewicz&userId=6ba7ed0ad871&source=-----3c6ff94e7a25---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F3c6ff94e7a25&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgrid-search-for-parameter-tunning-3c6ff94e7a25&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----3c6ff94e7a25--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F3c6ff94e7a25&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgrid-search-for-parameter-tunning-3c6ff94e7a25&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----3c6ff94e7a25---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----3c6ff94e7a25--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----3c6ff94e7a25--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----3c6ff94e7a25--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----3c6ff94e7a25--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----3c6ff94e7a25--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----3c6ff94e7a25--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----3c6ff94e7a25--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----3c6ff94e7a25--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@konkiewicz.m?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@konkiewicz.m?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Magdalena Konkiewicz"}, {"url": "https://medium.com/@konkiewicz.m/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "2.5K Followers"}, {"url": "http://aboutdatablog.com", "anchor_text": "aboutdatablog.com"}, {"url": "https://medium.com/@konkiewicz.m/membership", "anchor_text": "https://medium.com/@konkiewicz.m/membership"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F6ba7ed0ad871&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgrid-search-for-parameter-tunning-3c6ff94e7a25&user=Magdalena+Konkiewicz&userId=6ba7ed0ad871&source=post_page-6ba7ed0ad871--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F9d790b04b3c0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgrid-search-for-parameter-tunning-3c6ff94e7a25&newsletterV3=6ba7ed0ad871&newsletterV3Id=9d790b04b3c0&user=Magdalena+Konkiewicz&userId=6ba7ed0ad871&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}