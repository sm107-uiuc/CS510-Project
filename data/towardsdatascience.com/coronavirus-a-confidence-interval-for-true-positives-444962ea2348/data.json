{"url": "https://towardsdatascience.com/coronavirus-a-confidence-interval-for-true-positives-444962ea2348", "time": 1683011324.769419, "path": "towardsdatascience.com/coronavirus-a-confidence-interval-for-true-positives-444962ea2348/", "webpage": {"metadata": {"title": "Coronavirus: A Confidence Interval for True Positives | by Jonathan Ashbrock | Towards Data Science", "h1": "Coronavirus: A Confidence Interval for True Positives", "description": "Note from the editors: Towards Data Science is a Medium publication primarily based on the study of data science and machine learning. We are not health professionals or epidemiologists, and the\u2026"}, "outgoing_paragraph_urls": [{"url": "http://towardsdatascience.com/", "anchor_text": "Towards Data Science", "paragraph_index": 0}, {"url": "https://www.who.int/emergencies/diseases/novel-coronavirus-2019/situation-reports", "anchor_text": "here", "paragraph_index": 0}, {"url": "https://en.wikipedia.org/wiki/Convex_combination#:~:text=In%20convex%20geometry%2C%20a%20convex,negative%20and%20sum%20to%201.", "anchor_text": "convex combination", "paragraph_index": 12}, {"url": "https://floridahealthcovid19.gov/", "anchor_text": "this source", "paragraph_index": 26}, {"url": "http://thedatajocks.com", "anchor_text": "thedatajocks.com", "paragraph_index": 36}], "all_paragraphs": ["Note from the editors: Towards Data Science is a Medium publication primarily based on the study of data science and machine learning. We are not health professionals or epidemiologists, and the opinions of this article should not be interpreted as professional advice. To learn more about the coronavirus pandemic, you can click here.", "Coronavirus data is extremely messy. There is no uniformity in how different areas report their data. Because of this, and other reasons including day-of-the-week effects, it can be hard to infer trends.", "Moreover, because of the nature of false positives and false negatives, the number of positive tests does not tell us the number of people tested who have the virus.", "In this article I\u2019ll develop a confidence interval for the true number of positive tests given four pieces of information. First, we need both the true positive and false positive rates. These are properties of the tests themselves. Then, we need the total number of tests given along with total number of positives. These give us information about the population studied.", "Whenever you take an intro stats course, invariably the section on Baye\u2019s theorem has the following example. If you have a test that returns positive 99% of the time you have the disease, negative 99% of the time you don\u2019t, and the disease only affects 1% of the population, then a positive test only means you have a 50/50 shot at being sick.", "This is one of the classic \u2018Gotcha!\u2019 moments intro stats teachers love to use and can feel non-intuitive at first. However, its really easily understood. Because there are 99 times as many healthy people as sick people, even though the false positive rate is so low, it gets inflated by a factor of 99 because of all the healthy people. Thus, false positives are very prevalent.", "The 99% numbers I\u2019ve given above are known as the sensitivity and the specificity of a test. The sensitivity of a test is the ability for a test to identify those who have the test: it is the probability of a positive test conditioned on the event \u2018you have the disease\u2019. The specificity of a test is the ability to detect when the disease is not present. Similarly, it is the probability of negative conditioned on \u2018you don\u2019t have the disease\u2019. In the above example, the test I described had both 99% sensitivity and specificity.", "Now, our derivation involves only a few things. First, we use the law of total probability. Then, later we\u2019ll use properties of variance of random variables. Let\u2019s begin with the standard law of total probability. Recall that the positivity rate (or, percentage of tests coming back positive) can be broken down like:", "Well, we want to solve for P(Corona), the percentage of people tested who actually have the virus. Doing so we get the expression", "Notice: the positivity rate is the ratio of positive tests to total tests. We know this number. Second, the true positive rate and false positive rate are known by virtue of knowing the sensitivity and specificity! So, we can estimate the quantity we desire.", "Now, if we consider the quantities on the left and the right to be random variables which are observed, then the quantity on the right is an unbiased estimator for the proportion of the people tested who have Coronavirus. That means that if we compute the right hand side via sampling, on average we\u2019ll get the correct answer. The answer we get is not biased in one direction or the other.", "Why should these three pieces of information be enough to compute P(Corona)? Let\u2019s think logically with a little bit of algebra.", "If the false positive rate is 5% and the true positive rate is 95%, then the positivity rate, which is a convex combination of the two, must lie between 5 and 95%. If the positivity rate is closer to 95, then we know that most of the people tested actually had the disease. If the rate is closer to 5%, then we know that most of the people tested didn\u2019t have the disease. Knowing exactly how far between the two the positivity rate is tells us the exact mixture of true positives and false positives!", "A second point you may have noticed with a keen eye: this only works if the true positive and the false positive rates are different! Otherwise, there is no \u2018in between\u2019 the two rates. If the sensitivity and (1-specificity) are identical, we can\u2019t do this analysis at all. Later we\u2019ll show its even worse: as sensitivity and (1-specificity) get closer and closer, the quality of our confidence interval will degrade. (Luckily, most tests have sensitivity and specificity close to 1 so that sensitivity and 1-specificity are very far away from each other).", "Here is something that might be surprising. As long as the sensitivity and specificity are distinct numbers, we will get exactly the same estimate for actual proportion of people who have the disease. That is, when it comes to estimating the proportion of sick people from the test population, the accuracy of the tests doesn\u2019t matter. Let\u2019s work through an example below to see what I mean (this will also validate that our method gives the right value for P(Corona)!)", "In both cases, we\u2019ll assume for the sake of argument that we test 1000 people and 300 are sick. Lets first suppose a 95% true positive rate and a 5% false positive rate. Then, we expect to see 285 true positives and 35 false positives for a total of 320 positive tests. If you substitute this 32% in for the positivity rate in our formula above, we get", "Now repeat the above experiment with a 60% true positive and 40% false positive rate. This, on the outside, is a very poor Coronavirus test. We expect in this setting to see 180 true positives along with 280 false positives for a total of 460 positive tests. If you use the same formula above, we\u2019ll see again that we compute P(Corona)=0.3. The sensitivity and specificity don\u2019t matter in this case!", "So why, then, is it desirable to have accurate tests? The only conclusion I made above is that, for the entire population, we will compute the same proportion of sick people. Accuracy matters on an individual basis, though.", "If you test positive, then the probability that you actually have it depends highly on the accuracy of the tests and the prevalence of the disease. This is the classic Baye\u2019s Theorem problem I talked about above. Tests that have low sensitivity and specificity are bad on an individual basis.", "A second reason that sensitivity and specificity are quite important is that they greatly impact the variance of our estimator. Remember: the goal of this article was to develop a method to generate a confidence interval for the actual number of sick. In order to do this, we first need an unbiased estimator, which we have. Second, though, and quite crucially: we need to be able to compute the variance of our estimator.", "Remember, the variance of an estimator tells us how much our guess for the parameter-to-estimate changes from sample to sample. A low variance, unbiased estimator will produce consistent, accurate results for the quantity in question. (Note: this is why in an undergrad stats class we study the concept of minimum variance unbiased estimators.)", "In the next section we\u2019ll develop the variance of our specific estimator and show how it depends crucially on the distance between sensitivity and 1-specificity.", "Here is where we need to remember a bit more of our intro stats material. Looking at the formula for our estimate of the positivity rate, we have to ask ourselves: which things are random (depend on observed data) and which are known values (constants). Well, in fact the only thing which depends on the observed data is the parameter \u2018Positivity Rate\u2019. The others are known facts about the test we are performing. So, with a bit of re-writing, our estimator for P(Corona) is a scaled and shifted version of the positivity rate. Letting the bold-faced X denote our estimator of the positivity rate and using basic properties of variance we get:", "Moreover, the positivity rate is estimated through a binomial process, so we know its variance! This is the standard technique you use in constructing confidence intervals for proportions. Substituting this in the variance of our estimator for P(Corona) is given by:", "Her is the justification for our observation above: the closer and closer the true positive and false positive rates are, the larger this variance gets. In fact, if the true and false positive rates are extremely close, then our estimate will be no better than saying P(Corona) is somewhere between 0 and 1!", "However, for reasonable sensitive and specific tests, we can derive meaningful intervals.", "Lets look at the data from Florida as of the date of writing this article (evening on July 20th, 2020). I\u2019ll repeat this section using the values 95% and 99% for the specificity and sensitivity. Using this source, we see that Florida has 360,394 positive tests with an 11.8% positivity rate. Lets compute a 95% confidence interval for the proportion of those Floridians who were tested that actually have the disease. First, our estimates for proportion.", "In the case where we have a 95% sensitivity and specificity, we estimate that 7.57% of those who were tested actually had the disease. In the case of 99% accuracy, we get 11.03% of those tested had the disease. Pretty big difference.", "Now the variances. Because our sample sizes are actually huge, our variance in the 95% accuracy case is 4.21e-8. In the 99% accuracy case the variance is 3.55e-8.", "Assuming that those tested were a true random sample of Floridians (NO!), then using the Gaussian approximation our estimate for the proportion of the proportion of tested having the disease is 2.1e-4, or roughly 2 hundreths of a percent. This makes our confidence interval [7.53%,7.61%] in the case of 95% sensitivity and specificity.", "In the 99% case, the same calculation tells us that the proportion of those tested is about [10.99%,11.07%]. In either case, we get a very tight interval!", "The interval expands a bit when we pass from percentages to total number of illnesses. The range 7.53% to 7.61% represents a difference of about 24 thousand cases. This is much larger number and a much larger effect.", "To make things less concrete and more visual, I drew a graph of the estimate for P(Corona) for a given positivity rate. For this experiment I assumed 100 people were tested (a much smaller, more reasonable sample size in general), the coronavirus test had 95% specificity and sensitivity and we constructed a 95% confidence interval. Here are the results:", "My main takeaway here is not necessarily just \u2018how to make confidence intervals for medical tests\u2019. Rather, I wanted to show the process of deriving new mathematics in order to answer a question. A good data scientist shouldn\u2019t just be one who memorizes the syntax of hundreds of Python libraries. A good data scientist has a good understanding of the fundamentals and should be able to alter the techniques they already know how to use in order to fit a situation where you might not be able to find anything on stack exchange.", "Specifically regarding Coronavirus, the main takeaway is how hugely important it is to report the positive test rate along with the number of new cases. Otherwise, you only tell half the story.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "I am a Mathematics PhD Student at Vanderbilt with a passion for applying what I\u2019ve learned to sports modelling. For more analysis, visit thedatajocks.com"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F444962ea2348&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcoronavirus-a-confidence-interval-for-true-positives-444962ea2348&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcoronavirus-a-confidence-interval-for-true-positives-444962ea2348&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcoronavirus-a-confidence-interval-for-true-positives-444962ea2348&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcoronavirus-a-confidence-interval-for-true-positives-444962ea2348&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----444962ea2348--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----444962ea2348--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@jdashbrock?source=post_page-----444962ea2348--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@jdashbrock?source=post_page-----444962ea2348--------------------------------", "anchor_text": "Jonathan Ashbrock"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fc37688c1606&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcoronavirus-a-confidence-interval-for-true-positives-444962ea2348&user=Jonathan+Ashbrock&userId=c37688c1606&source=post_page-c37688c1606----444962ea2348---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F444962ea2348&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcoronavirus-a-confidence-interval-for-true-positives-444962ea2348&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F444962ea2348&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcoronavirus-a-confidence-interval-for-true-positives-444962ea2348&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://towardsdatascience.com/data-science-in-the-real-world/home", "anchor_text": "Data Science in the Real World"}, {"url": "http://towardsdatascience.com/", "anchor_text": "Towards Data Science"}, {"url": "https://www.who.int/emergencies/diseases/novel-coronavirus-2019/situation-reports", "anchor_text": "here"}, {"url": "https://en.wikipedia.org/wiki/Convex_combination#:~:text=In%20convex%20geometry%2C%20a%20convex,negative%20and%20sum%20to%201.", "anchor_text": "convex combination"}, {"url": "https://floridahealthcovid19.gov/", "anchor_text": "this source"}, {"url": "https://medium.com/tag/ds-in-the-real-world?source=post_page-----444962ea2348---------------ds_in_the_real_world-----------------", "anchor_text": "Ds In The Real World"}, {"url": "https://medium.com/tag/coronavirus?source=post_page-----444962ea2348---------------coronavirus-----------------", "anchor_text": "Coronavirus"}, {"url": "https://medium.com/tag/mathematics?source=post_page-----444962ea2348---------------mathematics-----------------", "anchor_text": "Mathematics"}, {"url": "https://medium.com/tag/data-science?source=post_page-----444962ea2348---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/confidence-interval?source=post_page-----444962ea2348---------------confidence_interval-----------------", "anchor_text": "Confidence Interval"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F444962ea2348&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcoronavirus-a-confidence-interval-for-true-positives-444962ea2348&user=Jonathan+Ashbrock&userId=c37688c1606&source=-----444962ea2348---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F444962ea2348&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcoronavirus-a-confidence-interval-for-true-positives-444962ea2348&user=Jonathan+Ashbrock&userId=c37688c1606&source=-----444962ea2348---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F444962ea2348&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcoronavirus-a-confidence-interval-for-true-positives-444962ea2348&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----444962ea2348--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F444962ea2348&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcoronavirus-a-confidence-interval-for-true-positives-444962ea2348&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----444962ea2348---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----444962ea2348--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----444962ea2348--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----444962ea2348--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----444962ea2348--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----444962ea2348--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----444962ea2348--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----444962ea2348--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----444962ea2348--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@jdashbrock?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@jdashbrock?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Jonathan Ashbrock"}, {"url": "https://medium.com/@jdashbrock/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "3 Followers"}, {"url": "http://thedatajocks.com", "anchor_text": "thedatajocks.com"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fc37688c1606&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcoronavirus-a-confidence-interval-for-true-positives-444962ea2348&user=Jonathan+Ashbrock&userId=c37688c1606&source=post_page-c37688c1606--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fusers%2Fc37688c1606%2Flazily-enable-writer-subscription&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcoronavirus-a-confidence-interval-for-true-positives-444962ea2348&user=Jonathan+Ashbrock&userId=c37688c1606&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}