{"url": "https://towardsdatascience.com/dice-diverse-counterfactual-explanations-for-hotel-cancellations-762c311b2c64", "time": 1683010859.1173959, "path": "towardsdatascience.com/dice-diverse-counterfactual-explanations-for-hotel-cancellations-762c311b2c64/", "webpage": {"metadata": {"title": "DiCE: Diverse Counterfactual Explanations for Hotel Cancellations | by Michael Grogan | Towards Data Science", "h1": "DiCE: Diverse Counterfactual Explanations for Hotel Cancellations", "description": "By \u201cDiverse Counterfactual Explanations\u201d, we mean decisions made by a model that would be influential enough to change the outcome variable. Let\u2019s take an example. Suppose that a hotel manager is\u2026"}, "outgoing_paragraph_urls": [{"url": "https://github.com/interpretml/DiCE", "anchor_text": "DiCE GitHub README", "paragraph_index": 28}, {"url": "https://github.com/MGCodesandStats/hotel-cancellations", "anchor_text": "here", "paragraph_index": 32}, {"url": "http://michael-grogan.com", "anchor_text": "michael-grogan.com", "paragraph_index": 35}], "all_paragraphs": ["By \u201cDiverse Counterfactual Explanations\u201d, we mean decisions made by a model that would be influential enough to change the outcome variable.", "Let\u2019s take an example. Suppose that a hotel manager is analysing customer bookings, and wishes to analyse which types of customers are more likely to cancel their booking.", "Here is an instance where a customer did not cancel their hotel booking.", "According to this particular case, the customer belongs to the market segment Offline TA/TO, the customer type is Contract, the Distribution Channel is TA/TO and Required Car Parking Spaces is 0.", "However, a hotel manager who is looking to minimise cancellation bookings would ideally like to identify the types of customers who would be likely to cancel their bookings. This is where DiCE comes in.", "When looking at the counterfactual explanations above \u2014 instances where a customer did cancel their bookings, it is observed that:", "The big difference between non-cancellations and cancellations (at least in this instance), appears to be lead time. The longer the period from when a customer makes a booking to when they are actually due to stay at the hotel, the more likely that such a customer will cancel their booking.", "In order to generate the DiCE explanations above:", "On point 3, a handy feature of DiCE is the ability to discard old data while retaining the model training parameters. Such a practice is consistent with FAIR data principles, which stipulates that data should be Findable, Accessible, Interoperable and Reusable.", "However, other laws can stipulate that customers have the right for their personal data to be removed, or indeed require that customer data is deleted after a certain period.", "The advantage of DiCE in this instance is that it allows for retention of the model training on the relevant data, without having to retain the data itself.", "Note that TensorFlow 1.15 is used with Python 3.6.9 in this instance to run DiCE and the associated models.", "Here is a sample of the dataset:", "The continuous features in the dataset are defined:", "The neural network model is trained across 30 epochs using the binary_crossentropy loss and the adam optimiser.", "Here is a plot of the model loss:", "This is a plot of the training and validation accuracy:", "The model is now stored as a DiCE model for explanation purposes:", "As previously mentioned, the features are now stored in a special format compatible with DiCE in order to generate a DiCE explanation instance:", "A DiCE explanation instance is formed:", "Now that the explanation instance has been formed, this can be used in order to generate counterfactual explanations.", "Let\u2019s take an example of a customer with the following attributes, included in what is called a query instance:", "Counterfactual examples are generated as follows:", "Here, a case with an original outcome of 1, i.e. a cancellation, is generated. It is also observed that counterexamples where a customer does not cancel their hotel booking are also generated.", "Conversely, here is a query instance where the customer did cancel their hotel booking.", "These are just some examples of how counterfactual explanations can be generated.", "In these instances, four counterfactual examples were produced (total_CFs=4), with the \u201copposite\u201d class being of interest.", "It is possible to use DiCE to generate deeper insights as regards counterfactual explanations.", "For instance, consideration may be given to the proximity of the explanations to the original input as well as the diversity of those explanations, i.e. the range of suggested changes to the explanations in question. The DiCE GitHub README provides more explanation on these.", "Here are the counterfactual explanations when the proximity_weight is increased to 1.5.", "Now, let\u2019s set the diversity_weight to 2.5, with proximity_weight at 0.", "In this article, you have seen:", "Many thanks for your time, and the associated GitHub repository for this example can be found here.", "Disclaimer: This article is written on an \u201cas is\u201d basis and without warranty. It was written with the intention of providing an overview of data science concepts, and should not be interpreted as professional advice in any way.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Science Consultant with expertise in economics, time series analysis, and Bayesian methods | michael-grogan.com"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F762c311b2c64&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdice-diverse-counterfactual-explanations-for-hotel-cancellations-762c311b2c64&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdice-diverse-counterfactual-explanations-for-hotel-cancellations-762c311b2c64&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdice-diverse-counterfactual-explanations-for-hotel-cancellations-762c311b2c64&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdice-diverse-counterfactual-explanations-for-hotel-cancellations-762c311b2c64&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----762c311b2c64--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----762c311b2c64--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://mgcodesandstats.medium.com/?source=post_page-----762c311b2c64--------------------------------", "anchor_text": ""}, {"url": "https://mgcodesandstats.medium.com/?source=post_page-----762c311b2c64--------------------------------", "anchor_text": "Michael Grogan"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Feec017a8b178&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdice-diverse-counterfactual-explanations-for-hotel-cancellations-762c311b2c64&user=Michael+Grogan&userId=eec017a8b178&source=post_page-eec017a8b178----762c311b2c64---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F762c311b2c64&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdice-diverse-counterfactual-explanations-for-hotel-cancellations-762c311b2c64&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F762c311b2c64&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdice-diverse-counterfactual-explanations-for-hotel-cancellations-762c311b2c64&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://github.com/interpretml/DiCE", "anchor_text": "DiCE GitHub README"}, {"url": "https://github.com/MGCodesandStats/hotel-cancellations", "anchor_text": "here"}, {"url": "https://www.sciencedirect.com/science/article/pii/S2352340918315191", "anchor_text": "Antonio, Almedia and Nunes (2019). Hotel Booking Demand Datasets"}, {"url": "https://github.com/interpretml/DiCE", "anchor_text": "Diverse Counterfactual Explanations (DiCE) for ML"}, {"url": "https://medium.com/tag/data-science?source=post_page-----762c311b2c64---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----762c311b2c64---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/interpretml?source=post_page-----762c311b2c64---------------interpretml-----------------", "anchor_text": "Interpretml"}, {"url": "https://medium.com/tag/tensorflow?source=post_page-----762c311b2c64---------------tensorflow-----------------", "anchor_text": "TensorFlow"}, {"url": "https://medium.com/tag/fair?source=post_page-----762c311b2c64---------------fair-----------------", "anchor_text": "Fair"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F762c311b2c64&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdice-diverse-counterfactual-explanations-for-hotel-cancellations-762c311b2c64&user=Michael+Grogan&userId=eec017a8b178&source=-----762c311b2c64---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F762c311b2c64&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdice-diverse-counterfactual-explanations-for-hotel-cancellations-762c311b2c64&user=Michael+Grogan&userId=eec017a8b178&source=-----762c311b2c64---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F762c311b2c64&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdice-diverse-counterfactual-explanations-for-hotel-cancellations-762c311b2c64&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----762c311b2c64--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F762c311b2c64&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdice-diverse-counterfactual-explanations-for-hotel-cancellations-762c311b2c64&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----762c311b2c64---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----762c311b2c64--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----762c311b2c64--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----762c311b2c64--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----762c311b2c64--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----762c311b2c64--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----762c311b2c64--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----762c311b2c64--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----762c311b2c64--------------------------------", "anchor_text": ""}, {"url": "https://mgcodesandstats.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://mgcodesandstats.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Michael Grogan"}, {"url": "https://mgcodesandstats.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "1.5K Followers"}, {"url": "http://michael-grogan.com", "anchor_text": "michael-grogan.com"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Feec017a8b178&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdice-diverse-counterfactual-explanations-for-hotel-cancellations-762c311b2c64&user=Michael+Grogan&userId=eec017a8b178&source=post_page-eec017a8b178--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F3c6e2607915&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdice-diverse-counterfactual-explanations-for-hotel-cancellations-762c311b2c64&newsletterV3=eec017a8b178&newsletterV3Id=3c6e2607915&user=Michael+Grogan&userId=eec017a8b178&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}