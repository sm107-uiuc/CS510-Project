{"url": "https://towardsdatascience.com/you-should-understand-sub-sampling-layers-within-deep-learning-b51016acd551", "time": 1683009498.86583, "path": "towardsdatascience.com/you-should-understand-sub-sampling-layers-within-deep-learning-b51016acd551/", "webpage": {"metadata": {"title": "(You Should) Understanding Sub-Sampling Layers Within Deep Learning | by Richmond Alake | Towards Data Science", "h1": "(You Should) Understanding Sub-Sampling Layers Within Deep Learning", "description": "Convolutional Neural Networks (CNN) have characteristics that enable invariance to the affine transformations of images that are fed through the network. This provides the ability to recognize\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.tensorflow.org/", "anchor_text": "TensorFlow", "paragraph_index": 15}, {"url": "http://yann.lecun.com/exdb/publis/pdf/lecun-01a.pdf", "anchor_text": "LeNet-5", "paragraph_index": 19}], "all_paragraphs": ["Convolutional Neural Networks (CNN) have characteristics that enable invariance to the affine transformations of images that are fed through the network. This provides the ability to recognize patterns that are shifted, tilted or slightly warped within images.", "These characteristics of affine invariance are introduced due to three main properties of the CNN architecture.", "In this article, we\u2019ll be exploring spatial sub-sampling and understanding their purpose and the advantages they serve within CNN architectures.", "This article is aimed at all levels of individuals that practice machine learning or more specifically deep learning.", "Sub-sampling is a technique that has been devised to reduce the reliance of precise positioning within feature maps that are produced by convolutional layers within a CNN.", "CNN internals contains kernels/filters of fixed dimensions, and these are referred to as feature detectors. Once features from an image are detected, the information in regards to the position of the feature within the image can actually be disregarded, and there are benefits to this.", "It turns out that specific feature positioning reliance is a disadvantage to building and developing a network that can perform relatively well on input data that have undergone some form of an affine transformation. We mostly don\u2019t want the weights within the networks learning patterns that are too specific to the training data.", "So, the information that matters in terms of positioning of features is the relative position of a feature to other features within the feature map, as opposed to the exact location of the feature within the feature map.", "To reduce the reliance on the exact positioning of features within networks, the reduction of spatial resolution is undertaken.", "Spatial resolution reduction is merely reducing the number of pixels within the feature map, and in this case, this is achieved through sub-sampling.", "Sub-sampling is incorporated within CNN by adding a sub-sampling layer where each unit within the layer has a receptive field of a fixed size that is imposed on the input (feature maps from previous layer), where an operation is performed on the pixels that are in the scope of the receptive field of the unit, the result of the operations becomes the new value of the output from the subsampling layer.", "Sub-sampling is a method to downsample feature maps as we move along the network", "Average pooling is a variant of sub-sampling where the average of pixels that fall within the receptive field of a unit within a sub-sampling layer is taken as the output.", "Below is a depiction of average pooling.", "The average pooling operation above has a window of 2x2 and slides across the input data, outputting an average of the pixels within the receptive field of the kernel.", "Below is a snippet of code that utilizes TensorFlow deep learning library to implement an average pooling layer.", "I won\u2019t dive into too many details of the code snippet above, as it\u2019s outside the scope of this article. But below are some necessary information:", "Max pooling is a variant of sub-sampling where the maximum pixel value of pixels that fall within the receptive field of a unit within a sub-sampling layer is taken as the output.", "The max-pooling operation below has a window of 2x2 and slides across the input data, outputting the maximum of the pixels within the receptive field of the kernel.", "Let\u2019s get more information on the internal operations that occurs within a sub-sampling layer by observing the first sub-sampling layer included in the LeNet-5 architecture.", "The first sub-sampling layer is identified in the image above by the label \u2018S2\u2019, and it\u2019s the layer just after the first conv layer (C1).", "From the diagram, we can observe that the sub-sampling layer produces six feature map output with the dimensions 14x14, each feature map produced by the \u2018S2\u2019 sub-sampling layer corresponds to a feature map produced by the \u2018C1\u2019 layer.", "This is a pattern that we observe through the architecture of the LeNet-5 as other sub-sampling layers produce feature maps equal to the number of feature maps produced by the previous conv layer.", "The sub-sampling variant that the layer \u2018S2\u2019 utilizes is an average pooling. As described earlier, the units within the sub-sampling layer all have a receptive field of 2x2, which subsequently corresponds to the pool size, in the implementation example given above. When values fall within the 2x2 pooling kernel, an average of the four numbers within the kernel is used as an output.", "As we proceed through the layers within LeNet-5, we reach a second sub-sampling layer \u2018S4, and this layer has more feature maps than \u2018S2\u2019, a total of 16 feature maps is outputted by the \u2018S4\u2019 sub-sampling layer.", "Noticeably the dimensions(5x5) of the feature maps are much smaller than features maps from the previous conv layers(10x10), this is due to the fact that as the input data is fed-foward through the network, sub-sampling layer averaging (2x2) pool size halves the dimensions of the feature maps it receives as input. This is known as downsampling.", "A reduction of the feature maps sizes(downsampling) as we move through the network enables the possibility of reducing the spatial resolution of the feature map. You might be thinking this technique is counterintuitive to ensuring the features within the feature maps contain enough detailed patterns to learn.", "But learning intrinsic patterns from images within a training set can be detrimental. Although we enforce and promote the learning of patterns from input images, actually having a network that learns the intrinsic patterns of images as they pass through the network will reduce the generalization capability of the network to data it hasn\u2019t seen during its training phase.", "Images have a large variety of artistic style. For example, there are several different ways individuals can write the number \u20188\u2019; having a network focus on the detailed patterns from images within the training set will affect it\u2019s generalization capability negatively.", "Finally, as a result of subsampling, there is the added benefit of an increase of feature maps generated within the network.", "To connect with me or find more content similar to this article, do the following:", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Machine Learning Content Creator with 1M+ views\u2014 Computer Vision Engineer. Interested in gaining and sharing knowledge on Technology and Finance"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fb51016acd551&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fyou-should-understand-sub-sampling-layers-within-deep-learning-b51016acd551&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fyou-should-understand-sub-sampling-layers-within-deep-learning-b51016acd551&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fyou-should-understand-sub-sampling-layers-within-deep-learning-b51016acd551&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fyou-should-understand-sub-sampling-layers-within-deep-learning-b51016acd551&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----b51016acd551--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----b51016acd551--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://richmondalake.medium.com/?source=post_page-----b51016acd551--------------------------------", "anchor_text": ""}, {"url": "https://richmondalake.medium.com/?source=post_page-----b51016acd551--------------------------------", "anchor_text": "Richmond Alake"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F88797ba3f2f6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fyou-should-understand-sub-sampling-layers-within-deep-learning-b51016acd551&user=Richmond+Alake&userId=88797ba3f2f6&source=post_page-88797ba3f2f6----b51016acd551---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb51016acd551&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fyou-should-understand-sub-sampling-layers-within-deep-learning-b51016acd551&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb51016acd551&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fyou-should-understand-sub-sampling-layers-within-deep-learning-b51016acd551&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://towardsdatascience.com/understand-local-receptive-fields-in-convolutional-neural-networks-f26d700be16c", "anchor_text": "Local Receptive Fields"}, {"url": "https://towardsdatascience.com/understanding-parameter-sharing-or-weights-replication-within-convolutional-neural-networks-cc26db7b645a", "anchor_text": "Shared Weights (parameter sharing)"}, {"url": "https://www.researchgate.net/publication/333593451_Application_of_Transfer_Learning_Using_Convolutional_Neural_Network_Method_for_Early_Detection_of_Terry's_Nail", "anchor_text": "Depiction of Average-Pooling from \u201cApplication of Transfer Learning Using Convolutional Neural Network\u2026\u201d"}, {"url": "https://www.tensorflow.org/", "anchor_text": "TensorFlow"}, {"url": "https://www.researchgate.net/publication/333593451_Application_of_Transfer_Learning_Using_Convolutional_Neural_Network_Method_for_Early_Detection_of_Terry's_Nail", "anchor_text": "Depiction of Max-Pooling from \u201cApplication of Transfer Learning Using Convolutional Neural Network\u2026\u201d"}, {"url": "http://yann.lecun.com/exdb/publis/pdf/lecun-01a.pdf", "anchor_text": "LeNet-5"}, {"url": "http://yann.lecun.com/exdb/publis/pdf/lecun-01a.pdf", "anchor_text": "LeNet-5 CNN Architecture"}, {"url": "https://www.youtube.com/channel/UCNNYpuGCrihz_YsEpZjo8TA", "anchor_text": "YouTube channel"}, {"url": "https://www.youtube.com/channel/UCNNYpuGCrihz_YsEpZjo8TA", "anchor_text": "here"}, {"url": "https://medium.com/@richmond.alake", "anchor_text": "Medium"}, {"url": "https://www.linkedin.com/in/richmondalake/", "anchor_text": "LinkedIn"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----b51016acd551---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----b51016acd551---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----b51016acd551---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/computer-vision?source=post_page-----b51016acd551---------------computer_vision-----------------", "anchor_text": "Computer Vision"}, {"url": "https://medium.com/tag/data-science?source=post_page-----b51016acd551---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fb51016acd551&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fyou-should-understand-sub-sampling-layers-within-deep-learning-b51016acd551&user=Richmond+Alake&userId=88797ba3f2f6&source=-----b51016acd551---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fb51016acd551&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fyou-should-understand-sub-sampling-layers-within-deep-learning-b51016acd551&user=Richmond+Alake&userId=88797ba3f2f6&source=-----b51016acd551---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb51016acd551&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fyou-should-understand-sub-sampling-layers-within-deep-learning-b51016acd551&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----b51016acd551--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fb51016acd551&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fyou-should-understand-sub-sampling-layers-within-deep-learning-b51016acd551&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----b51016acd551---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----b51016acd551--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----b51016acd551--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----b51016acd551--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----b51016acd551--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----b51016acd551--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----b51016acd551--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----b51016acd551--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----b51016acd551--------------------------------", "anchor_text": ""}, {"url": "https://richmondalake.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://richmondalake.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Richmond Alake"}, {"url": "https://richmondalake.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "7.3K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F88797ba3f2f6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fyou-should-understand-sub-sampling-layers-within-deep-learning-b51016acd551&user=Richmond+Alake&userId=88797ba3f2f6&source=post_page-88797ba3f2f6--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F366f35b0b39b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fyou-should-understand-sub-sampling-layers-within-deep-learning-b51016acd551&newsletterV3=88797ba3f2f6&newsletterV3Id=366f35b0b39b&user=Richmond+Alake&userId=88797ba3f2f6&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}