{"url": "https://towardsdatascience.com/object-detection-with-voice-feedback-yolo-v3-gtts-6ec732dca91", "time": 1682994147.038888, "path": "towardsdatascience.com/object-detection-with-voice-feedback-yolo-v3-gtts-6ec732dca91/", "webpage": {"metadata": {"title": "Object Detection with Voice Feedback \u2014 YOLO v3 + gTTS | by Jason Yip | Towards Data Science", "h1": "Object Detection with Voice Feedback \u2014 YOLO v3 + gTTS", "description": "An intuitive explanation of how the YOLO algorithm works and the usage of gTTS"}, "outgoing_paragraph_urls": [{"url": "http://linkedin.com/in/jasonyip184", "anchor_text": "LinkedIn", "paragraph_index": 34}, {"url": "http://www.linkedin.com/in/jasonyip184", "anchor_text": "www.linkedin.com/in/jasonyip184", "paragraph_index": 36}], "all_paragraphs": ["Final exams are finally over!!! I was fascinated by the idea of object detection in Computer Vision and wanted to start a project on it. I realized that we could probably help the blind \u201csee\u201d better using Image-to-Text and Text-to-Voice, without any complex hardware.", "Having a complete understanding of every single piece in the whole pipeline is extremely difficult but I have attempted to understand as much as I need to know for this task.", "is a field of Computer Vision that detects instances of semantic objects in images/videos (by creating bounding boxes around them in our case). We can then convert the annotated text into voice responses and give the basic positions of the objects in the person/camera\u2019s view.", "I am more interested in getting something to work as soon as possible this time round so I will be using a pre-trained model. This means that COCO has already been trained on YOLO v3 by others and we have already obtained the weights stored in a 200+mb file.", "If you are not sure what weights are, think of it as trying to find the Best Fit Line in Linear Regression. We need to find the right values of m and c in y=mx+c such that our line minimizes the error between all points. Now in our more complex prediction task, we have millions of Xs when we feed images into the complex network. These Xs will each have an m and these are the predicted weights stored in our yolov3.weights file. The ms have been constantly readjusted to minimize some loss function.", "3. Input Data: We will be using our webcam to feed images at 30 frames-per-second to this trained model and we can set it to only process every other frame to speed things up.", "4. API: The class prediction of the objects detected in every frame will be a string e.g. \u201ccat\u201d. We will also obtain the coordinates of the objects in the image and append the position \u201ctop\u201d/\u201cmid\u201d/\u201cbottom\u201d & \u201cleft\u201d/\u201ccenter\u201d/\u201cright\u201d to the class prediction \u201ccat\u201d. We can then send the text description to the Google Text-to-Speech API using the gTTS package.", "5. Output: We will also obtain the coordinates of the bounding box of every object detected in our frames, overlay the boxes on the objects detected and return the stream of frames as a video playback. We will also schedule to get a voice feedback on the 1st frame of each second (instead of 30 fps) e.g. \u201cbottom left cat\u201d \u2014 meaning a cat was detected on the bottom-left of my camera view.", "Previously, classification-based models were used to detect objects using localization, region-based classification or things such as the sliding window. Only high scoring regions of the image are considered as a detection and they could be very time-consuming.", "Instead, YOLO is regression-based. We\u2019re predicting classes and bounding boxes for the whole image quickly in one run of the algorithm (just one look of the image\u2019s pixels), so that the predictions are informed by the global context in the image.", "C represents the class index of the object we are trying to label. A sports ball would mean C=33. The training has already been done on COCO.", "During training time, we have to manually label the following 5 values for each object in the image in this format C bx by bw bh. We will also normalize each of the 4 b values to lie between 0\u20131 by representing them as a proportion of W & H (1280 x 720 px).", "Suppose we have 2 objects labeled in the frame \u2014 The sports ball and myself. This is represented by tensors: a general form of a vector, which will be fed into the model during training.", "Now we are feeding 1280 x 720 frames from our camera into YOLO at Prediction time. YOLO will automatically resize it to 416 x 234 and fit it into a popular standard-sized 416 x 416 network by padding the excess with 0s. YOLO divides each image into S x S cells each with a size of 32 x 32 (reduction factor=32). This creates 416/32 = 13 x 13 cells.", "There are 5 values in a bounding box \u2014 (bx, by, bw, bh, BC)", "If the center of an object (red dot) falls into a grid cell, only that grid cell (dark green cell) is responsible for detecting that object. Each bounding box has 5 values. The first 4 values bx, by, bw, bh represent the position of the box.", "The 5th value is BC: the box confidence score.", "BC = Pr(Object existing in box) * IOU (Intersection Over Union).", "This measures how likely the box contains an object of any class and how accurate it is in predicting. BC=0 if no object exists in that box and we want BC=1 in predicting the ground truth.", "There are B bounding boxes predicted in each grid cell", "There are also C conditional class probabilities in each grid cell", "There are 80 conditional class probabilities \u2014 Pr(Class i | Object) per cell when we use COCO. It is the probability that the predicted object is of Class i given that there is an object in the cell.", "In our example above, Class 33 has the highest probability and it will be used as our prediction of the object to be a sports ball.", "There are S x S cells and in each of these cells there are 2 things: 1) B bounding boxes each with 5 values (bx, by, bw, bh, BC), 2) C conditional class probabilities. The predictions are encoded as a S x S x (5 * B + C) tensor.", "There are actually B duplicate detections for the grid cell that is the only one used to predict the object (dark green box). NMS suppresses detections with low box confidence scores: BC, so that we don\u2019t end up predicting 3 sports balls when there is only just one. An implementation of NMS could be:", "While we already have our predictions, we want to understand how the weights were being adjusted such that our loss function for this model was minimized during Training Time. The function looks complex but it is actually very intuitive when broken down.", "The parameter \u03bbcoord is usually =5 to increase the weight of the localization loss to give it more importance.", "The parameter \u03bbnoobj is usually =0.5 to decrease the weight of the confidence loss since boxes that do not contain objects have confidence scores BC=0. This makes the model more stable and easier to converge.", "We can use bx & by relative to W & H to determine the position of the objects detected and send it as a text string to gTTS with this simple command.", "I also used pydub and ffmpeg to manipulate the audio files generated.", "I am unable to return the frames in real-time because it will make the video playback seem very jerky when it processes every 30th frame. I also explored multi-threading, which in theory should create 1 process for processing every 30th frame and another process for the video playback.", "However, I am only able to produce the verbal description of objects detected in real-time on my webcam which is more important since the blind can\u2019t see bounding boxes anyway. For the video below, I recorded myself before passing it to create the bounding boxes and generate the verbal responses.", "There it is, YOLO v3 on COCO along with gTTS, doing its magic!", "I\u2019m enjoying this process of learning, doing and then sharing. I think \u201clearning by applying\u201d is taken to the next level when it comes to sharing. Breaking complex problems into simpler ones and understanding & explaining difficult concepts in layman terms is a skill I\u2019d love to hone further. More to come!", "Discuss further with me on LinkedIn or via jasonyip184@gmail.com!", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Commodities Trader at J.P. Morgan | Financial Analytics Major, Math & Economics Minor from NUS | www.linkedin.com/in/jasonyip184"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F6ec732dca91&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fobject-detection-with-voice-feedback-yolo-v3-gtts-6ec732dca91&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fobject-detection-with-voice-feedback-yolo-v3-gtts-6ec732dca91&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fobject-detection-with-voice-feedback-yolo-v3-gtts-6ec732dca91&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fobject-detection-with-voice-feedback-yolo-v3-gtts-6ec732dca91&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----6ec732dca91--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----6ec732dca91--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@jasonyip184?source=post_page-----6ec732dca91--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@jasonyip184?source=post_page-----6ec732dca91--------------------------------", "anchor_text": "Jason Yip"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fd2f66e48b4d5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fobject-detection-with-voice-feedback-yolo-v3-gtts-6ec732dca91&user=Jason+Yip&userId=d2f66e48b4d5&source=post_page-d2f66e48b4d5----6ec732dca91---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F6ec732dca91&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fobject-detection-with-voice-feedback-yolo-v3-gtts-6ec732dca91&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F6ec732dca91&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fobject-detection-with-voice-feedback-yolo-v3-gtts-6ec732dca91&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "http://cocodataset.org/#explore", "anchor_text": "Common Objects In Context"}, {"url": "https://pjreddie.com/darknet/", "anchor_text": "Darknet"}, {"url": "https://github.com/jasonyip184/yolo", "anchor_text": "Link to project repo"}, {"url": "http://linkedin.com/in/jasonyip184", "anchor_text": "LinkedIn"}, {"url": "https://www.pyimagesearch.com/2018/11/12/yolo-object-detection-with-opencv/", "anchor_text": "YOLO object detection with OpenCV - PyImageSearchIn this tutorial, you'll learn how to use the YOLO object detector to detect objects in both images and video streams\u2026www.pyimagesearch.com"}, {"url": "https://hackernoon.com/understanding-yolo-f5a74bbc7967", "anchor_text": "Understanding YOLOThis article explains the YOLO object detection architecture, from the point of view of someone who wants to implement\u2026hackernoon.com"}, {"url": "https://medium.com/@jonathan_hui/real-time-object-detection-with-yolo-yolov2-28b1b93e2088", "anchor_text": "Real-time Object Detection with YOLO, YOLOv2 and now YOLOv3You only look once (YOLO) is an object detection system targeted for real-time processing. We will introduce YOLO\u2026medium.com"}, {"url": "https://medium.com/tag/data-science?source=post_page-----6ec732dca91---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/object-detection?source=post_page-----6ec732dca91---------------object_detection-----------------", "anchor_text": "Object Detection"}, {"url": "https://medium.com/tag/yolo?source=post_page-----6ec732dca91---------------yolo-----------------", "anchor_text": "Yolo"}, {"url": "https://medium.com/tag/computer-vision?source=post_page-----6ec732dca91---------------computer_vision-----------------", "anchor_text": "Computer Vision"}, {"url": "https://medium.com/tag/cnn?source=post_page-----6ec732dca91---------------cnn-----------------", "anchor_text": "Cnn"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F6ec732dca91&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fobject-detection-with-voice-feedback-yolo-v3-gtts-6ec732dca91&user=Jason+Yip&userId=d2f66e48b4d5&source=-----6ec732dca91---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F6ec732dca91&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fobject-detection-with-voice-feedback-yolo-v3-gtts-6ec732dca91&user=Jason+Yip&userId=d2f66e48b4d5&source=-----6ec732dca91---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F6ec732dca91&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fobject-detection-with-voice-feedback-yolo-v3-gtts-6ec732dca91&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----6ec732dca91--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F6ec732dca91&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fobject-detection-with-voice-feedback-yolo-v3-gtts-6ec732dca91&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----6ec732dca91---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----6ec732dca91--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----6ec732dca91--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----6ec732dca91--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----6ec732dca91--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----6ec732dca91--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----6ec732dca91--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----6ec732dca91--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----6ec732dca91--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@jasonyip184?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@jasonyip184?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Jason Yip"}, {"url": "https://medium.com/@jasonyip184/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "599 Followers"}, {"url": "http://www.linkedin.com/in/jasonyip184", "anchor_text": "www.linkedin.com/in/jasonyip184"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fd2f66e48b4d5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fobject-detection-with-voice-feedback-yolo-v3-gtts-6ec732dca91&user=Jason+Yip&userId=d2f66e48b4d5&source=post_page-d2f66e48b4d5--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F5dd55ba2910e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fobject-detection-with-voice-feedback-yolo-v3-gtts-6ec732dca91&newsletterV3=d2f66e48b4d5&newsletterV3Id=5dd55ba2910e&user=Jason+Yip&userId=d2f66e48b4d5&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}