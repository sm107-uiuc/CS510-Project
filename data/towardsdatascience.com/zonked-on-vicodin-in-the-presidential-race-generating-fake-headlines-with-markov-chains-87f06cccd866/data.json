{"url": "https://towardsdatascience.com/zonked-on-vicodin-in-the-presidential-race-generating-fake-headlines-with-markov-chains-87f06cccd866", "time": 1683008112.329115, "path": "towardsdatascience.com/zonked-on-vicodin-in-the-presidential-race-generating-fake-headlines-with-markov-chains-87f06cccd866/", "webpage": {"metadata": {"title": "Zonked on Vicodin in the Presidential Race: Generating Fake Headlines with Markov Chains | by Brienna Herold | Towards Data Science", "h1": "Zonked on Vicodin in the Presidential Race: Generating Fake Headlines with Markov Chains", "description": "In this post, we write Python code to generate fake news headlines, using a Markov chain model trained on a corpus of real headlines from The New York Times over the past year. Even though these\u2026"}, "outgoing_paragraph_urls": [{"url": "https://en.wikipedia.org/wiki/Parody_generator", "anchor_text": "parody generators", "paragraph_index": 10}, {"url": "https://setosa.io/ev/markov-chains/", "anchor_text": "this", "paragraph_index": 12}, {"url": "https://github.com/jsvine/markovify", "anchor_text": "markovify", "paragraph_index": 12}, {"url": "https://towardsdatascience.com/collecting-data-from-the-new-york-times-over-any-period-of-time-3e365504004", "anchor_text": "here", "paragraph_index": 27}, {"url": "https://github.com/jsvine/markovify/blob/master/README.md", "anchor_text": "formatting rules", "paragraph_index": 28}, {"url": "https://www.jsvine.com/", "anchor_text": "jsvine", "paragraph_index": 55}, {"url": "https://twitter.com/horse_ebooks?lang=en", "anchor_text": "@horse_ebooks", "paragraph_index": 59}, {"url": "https://www.theatlantic.com/technology/archive/2013/09/-horse-ebooks-is-the-most-successful-piece-of-cyber-fiction-ever/279946/", "anchor_text": "highbrow art", "paragraph_index": 59}, {"url": "https://www.theguardian.com/media/2013/sep/24/10-reasons-buzzfeed-ruins-everything", "anchor_text": "it was all just someone pretending to be probability", "paragraph_index": 59}, {"url": "https://www.vice.com/en_us/article/j5kmzy/headlinetron-comedy-twitter-bot", "anchor_text": "An article", "paragraph_index": 60}, {"url": "https://twitter.com/HEADLINERTRON?ref_src=twsrc%5Etfw%7Ctwcamp%5Etweetembed%7Ctwterm%5E996767577396465666&ref_url=https%3A%2F%2Ftwitter.com%2FHEADLINERTRON%2Fstatus%2F996767577396465666", "anchor_text": "@headlinertron", "paragraph_index": 60}], "all_paragraphs": ["In this post, we write Python code to generate fake news headlines, using a Markov chain model trained on a corpus of real headlines from The New York Times over the past year.", "Zonked on Vicodin in the Presidential Race", "Mike Pence Makes Clear There Is a New Constitution", "Who Knew How to Clean Your Child\u2019s DNA Information?", "A.I. Is Learning That Liberals Eat Their Own Lawyers, Too", "How New Yorkers Want Cheap Wine, and Lots of Life-Size Dolls.", "One Thing That Happened to Carole Baskin\u2019s Husband, Don Lewis?", "With Help, She Found Carson McCullers\u2019s Love Letters. They Taught Her How to Rule Until 2036", "Even though these headlines are [hopefully] clearly fake and were never published by The New York Times, it\u2019s uncanny how much reality they hold in the context of current events.", "You can extend the code in this post to generate any text you want, given that you have a corpus of the text that you want to emulate.", "You might not realize it, but you use Markov chains every day. These mathematical systems decide which pages show up at the top of your Google search. They help your phone predict what you\u2019re going to type next. They also power a variety of Twitter and Reddit bots and other parody generators.", "The Markov chains in all of these applications work the same way, fundamentally. A Markov chain describes a sequence of possible states, where the probability of each state depends on the state immediately preceding it.", "There are many good resources out there on Markov chains, like this visual one, so this post only describes how they work in the Python package markovify, a convenient little package that lets us delegate the work of writing our model ourselves.", "When given a corpus like our headlines, markovify breaks down every sentence (or in our case, headline) into n-gram states of a user-specified size using an overlapping sliding window. For example, if we tell it we want our corpus to be modeled with a Markov chain of bigram states, this headline from April 30, 2020", "Who Should Wear Masks on Planes? More Airlines Say Everyone", "gets broken down into this list of bigram states:", "As it breaks down this headline into n-grams, markovify also records in a dictionary the frequency of all words that follow a particular bigram. This dictionary forms the Markov chain.", "So far, our Markov chain looks like this:", "Who Should Be Saved First? Experts Offer Ethical Guidance", "After markovify breaks down this headline and updates the chain, our chain looks like this (updates are in bold):", "We can see the model knows that the word \u201cWho\u201d appears as the first word in a headline twice. The model also knows that two different words may come after \u201cWho Should\u201d, as well as that a headline can end after either \u201cSay Everyone\u201d or \u201cEthical Guidance\u201d.", "A glimpse of the final [and large] chain:", "Markovify then begins chaining from this start state, randomly adding a word given that it follows the preceding bigram. It stops when the chain encounters an end state. And we now have our fake headline.", "Some common problems can arise when generating text using Markov chains, but markovify handles them under the hood. These problems have to do with generating sentence fragments rather than complete sentences. This can happen if we start with a random word, drop punctuation, or try to arbitrarily end the sentence after a certain number of words. Markovify deals with these problems by recording all possible first words, retaining all punctuation, and recording all end states. Markovify also ensures that we do not generate a sentence that already exists in the corpus.", "While Markov chain text generators can be fine-tuned or combined with other models to create powerful applications such as Google search or the predictive text on your phone, they are also just a fun way to mimic intelligence using a very simple shortcut.", "Some examples of Markov chain text generators in the wild:", "To create our own Markov chain text generator that generates fake headlines emulating The New York Times, we first need to get a corpus of real headlines, and then we train our model on these headlines using markovify.", "We will use all the headlines from The New York Times over the past year. I describe how to get them here.", "Alternatively, you could also do this with any other corpus of text. The more text, the better. You would just need to follow formatting rules specified by the markovify package to turn it into a usable corpus.", "We\u2019ve got 46,135 headlines to feed into our model.", "To train our model, we give markovify our corpus of headlines and the size that we want the n-grams to be.", "I tested unigrams, bigrams, trigrams, and found that bigrams gave the best probabilistic coherence in this case, so that\u2019s why we\u2019re going with state_size=2.", "Telling the model to generate a fake headline is simple, too.", "We can also generate headlines that talk about a specific topic, like the current pandemic. As there is no built-in method to do this, I continually generate headlines one by one, keeping them if they contain at least one word from a prespecified list of words associated with the topic, until I\u2019ve reached my desired number of headlines.", "A Presidential Pardon for the Coronavirus Itself", "Your Visitors Deserve to Know About Coronavirus", "Murder Rates Were Staggering. The Virus Comes for You?", "The Coronavirus Has Become a Saint. But First, His Body Must Be Freed", "Halfhearted Millennial Coronavirus Prep in a Gun-Filled Manga World", "When a Coronavirus Recession Would Be \u2018Appropriate\u2019 to Have Abortion", "Poland and Hungary Use Coronavirus to Sow Discord Among Americans?", "Coronavirus Leads N.C.A.A. to Stop Selling Sham Anti-Coronavirus Toothpaste", "Epstein Accuser Urges Prince Andrew to \u2018Come Clean\u2019 on Sex Dolls, Mary Shelley Created \u2018Frankenstein,\u2019 and Then the Virus", "For fun, let\u2019s try a different topic\u2014cats!", "Much Ado About a Cat During Zoom Meeting", "Mastering the Art of Herding Digital Cats", "We\u2019re in a Recession? Keep Your Cat Forever", "His 22-Pound Cat Was Too Big Not to Stay Safe", "The Year In Real Estate With Puppies and Kittens", "These Places Could Run Out of Exploding Kittens", "Two Cats Are First U.S. Pets to Test Its Security Teams", "In Austria, a Tawdry Tale of Ghosts, Dark Magic and Murder Cat", "A Black Cat Takes Some Blame for an Unsettling Warning on the Planet", "Their Romance Took Off After He Threw a Cat During Zoom Meeting", "We can target any word as part of a topic, given that The New York Times has used it in at least one headline. The more often the word appears, the more creative our model can get.", "Thanks, jsvine, for making this process so easy!", "All of the headlines in this post were hand-curated. While our Markov chain text generator does impressively well for such a simple algorithm, it only does what it is told. We didn\u2019t tell it how to be funny. We didn\u2019t tell it how English works. Our model has no way of knowing whether or not it was amusing or even grammatically correct. We\u2019ve got to help it out a little.", "Some of these headlines make sense, but some of them do not.", "This is a debate within the bot community \u2014 How much human interference should we allow with bots that generate natural language?", "Have you heard of @horse_ebooks? It was a very popular Twitter bot, because people saw highbrow art in what they thought was probability. But when it was revealed that it was all just someone pretending to be probability, Twitter was outraged.", "It\u2019s a conundrum. An article about a Twitter bot called @headlinertron describes it well:", "\u201cIf it was purely robotic, it wouldn\u2019t be funny. But if it was too human, it wouldn\u2019t be interesting. No one wants to see a random mishmash word salad that a pure markov chain generator\u2019s putting out, but no one wants to see some dude pretending to be a robot either,\u201d Hernandez said.", "Often the answer is to generate lots of sentences and pick out the best ones afterward, with minimal human interference. In addition to hand-curation, there are other things we can do to improve our model (until it becomes too good to be funny):", "On the Hunt for a Hairy Situation", "The Work Diary of China\u2019s Censors", "The Doctor Came to Save Summer 2020", "What We\u2019ve Learned From New York Times", "Underwear Ads Lose the Art of Skating on Thin Ice", "How Facebook Is Just Trying to Trademark \u2018Taco Tuesday\u2019", "The Unspeakable Cost of Tweeting About My Bigoted Landlady", "For Some Horror Writers, Nothing Is Scarier Than Student Loans", "Broadway Is Shuttered but Its \u2018Dominatrix\u2019 Pianist Still Takes Requests", "Weekly Health Quiz: We\u2019re All Learning More About Your Wife\u2019s Garbage", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F87f06cccd866&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fzonked-on-vicodin-in-the-presidential-race-generating-fake-headlines-with-markov-chains-87f06cccd866&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fzonked-on-vicodin-in-the-presidential-race-generating-fake-headlines-with-markov-chains-87f06cccd866&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fzonked-on-vicodin-in-the-presidential-race-generating-fake-headlines-with-markov-chains-87f06cccd866&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fzonked-on-vicodin-in-the-presidential-race-generating-fake-headlines-with-markov-chains-87f06cccd866&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----87f06cccd866--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----87f06cccd866--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://brienna.medium.com/?source=post_page-----87f06cccd866--------------------------------", "anchor_text": ""}, {"url": "https://brienna.medium.com/?source=post_page-----87f06cccd866--------------------------------", "anchor_text": "Brienna Herold"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F99827063cb38&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fzonked-on-vicodin-in-the-presidential-race-generating-fake-headlines-with-markov-chains-87f06cccd866&user=Brienna+Herold&userId=99827063cb38&source=post_page-99827063cb38----87f06cccd866---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F87f06cccd866&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fzonked-on-vicodin-in-the-presidential-race-generating-fake-headlines-with-markov-chains-87f06cccd866&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F87f06cccd866&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fzonked-on-vicodin-in-the-presidential-race-generating-fake-headlines-with-markov-chains-87f06cccd866&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://stock.adobe.com/contributor/17182/charles-taylor?load_type=author&prev_url=detail", "anchor_text": "charles taylor"}, {"url": "https://stock.adobe.com/images/the-word-satire-made-up-of-lots-of-cut-up-newspaper/222594173?prev_url=detail", "anchor_text": "Adobe Stock"}, {"url": "https://en.wikipedia.org/wiki/Parody_generator", "anchor_text": "parody generators"}, {"url": "https://setosa.io/ev/markov-chains/", "anchor_text": "this"}, {"url": "https://github.com/jsvine/markovify", "anchor_text": "markovify"}, {"url": "http://chainsinventinsanity.com", "anchor_text": "Chains Invent Insanity"}, {"url": "https://www.reddit.com/user/user_simulator", "anchor_text": "/u/user_simulator"}, {"url": "http://trump.frost.works/", "anchor_text": "Insta-Trump!"}, {"url": "https://en.wikipedia.org/wiki/Tay_(bot)", "anchor_text": "Tay"}, {"url": "https://www.forbes.com/sites/erikkain/2016/03/24/microsofts-teenage-nazi-loving-ai-is-the-perfect-social-commentary-for-our-times/#b91dbb4235a0", "anchor_text": "a Hitler-loving sex robot in less than 24 hours"}, {"url": "http://www.shartificialintelligence.com/", "anchor_text": "shartificialintelligence.com"}, {"url": "https://towardsdatascience.com/collecting-data-from-the-new-york-times-over-any-period-of-time-3e365504004", "anchor_text": "here"}, {"url": "https://towardsdatascience.com/collecting-data-from-the-new-york-times-over-any-period-of-time-3e365504004", "anchor_text": "Collecting data from The New York Times over any period of timeA simple guide in Pythontowardsdatascience.com"}, {"url": "https://github.com/jsvine/markovify/blob/master/README.md", "anchor_text": "formatting rules"}, {"url": "https://www.jsvine.com/", "anchor_text": "jsvine"}, {"url": "https://twitter.com/horse_ebooks?lang=en", "anchor_text": "@horse_ebooks"}, {"url": "https://www.theatlantic.com/technology/archive/2013/09/-horse-ebooks-is-the-most-successful-piece-of-cyber-fiction-ever/279946/", "anchor_text": "highbrow art"}, {"url": "https://www.theguardian.com/media/2013/sep/24/10-reasons-buzzfeed-ruins-everything", "anchor_text": "it was all just someone pretending to be probability"}, {"url": "https://www.vice.com/en_us/article/j5kmzy/headlinetron-comedy-twitter-bot", "anchor_text": "An article"}, {"url": "https://twitter.com/HEADLINERTRON?ref_src=twsrc%5Etfw%7Ctwcamp%5Etweetembed%7Ctwterm%5E996767577396465666&ref_url=https%3A%2F%2Ftwitter.com%2FHEADLINERTRON%2Fstatus%2F996767577396465666", "anchor_text": "@headlinertron"}, {"url": "https://github.com/minimaxir/textgenrnn", "anchor_text": "textgrnn"}, {"url": "https://medium.com/tag/markov-chains?source=post_page-----87f06cccd866---------------markov_chains-----------------", "anchor_text": "Markov Chains"}, {"url": "https://medium.com/tag/python?source=post_page-----87f06cccd866---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/satire?source=post_page-----87f06cccd866---------------satire-----------------", "anchor_text": "Satire"}, {"url": "https://medium.com/tag/new-york-times?source=post_page-----87f06cccd866---------------new_york_times-----------------", "anchor_text": "New York Times"}, {"url": "https://medium.com/tag/nlp?source=post_page-----87f06cccd866---------------nlp-----------------", "anchor_text": "NLP"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F87f06cccd866&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fzonked-on-vicodin-in-the-presidential-race-generating-fake-headlines-with-markov-chains-87f06cccd866&user=Brienna+Herold&userId=99827063cb38&source=-----87f06cccd866---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F87f06cccd866&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fzonked-on-vicodin-in-the-presidential-race-generating-fake-headlines-with-markov-chains-87f06cccd866&user=Brienna+Herold&userId=99827063cb38&source=-----87f06cccd866---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F87f06cccd866&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fzonked-on-vicodin-in-the-presidential-race-generating-fake-headlines-with-markov-chains-87f06cccd866&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----87f06cccd866--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F87f06cccd866&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fzonked-on-vicodin-in-the-presidential-race-generating-fake-headlines-with-markov-chains-87f06cccd866&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----87f06cccd866---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----87f06cccd866--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----87f06cccd866--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----87f06cccd866--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----87f06cccd866--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----87f06cccd866--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----87f06cccd866--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----87f06cccd866--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----87f06cccd866--------------------------------", "anchor_text": ""}, {"url": "https://brienna.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://brienna.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Brienna Herold"}, {"url": "https://brienna.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "118 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F99827063cb38&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fzonked-on-vicodin-in-the-presidential-race-generating-fake-headlines-with-markov-chains-87f06cccd866&user=Brienna+Herold&userId=99827063cb38&source=post_page-99827063cb38--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F993f8e299c4c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fzonked-on-vicodin-in-the-presidential-race-generating-fake-headlines-with-markov-chains-87f06cccd866&newsletterV3=99827063cb38&newsletterV3Id=993f8e299c4c&user=Brienna+Herold&userId=99827063cb38&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}