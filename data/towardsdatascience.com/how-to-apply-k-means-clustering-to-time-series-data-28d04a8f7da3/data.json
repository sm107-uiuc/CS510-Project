{"url": "https://towardsdatascience.com/how-to-apply-k-means-clustering-to-time-series-data-28d04a8f7da3", "time": 1683011054.0706172, "path": "towardsdatascience.com/how-to-apply-k-means-clustering-to-time-series-data-28d04a8f7da3/", "webpage": {"metadata": {"title": "How to Apply K-means Clustering to Time Series Data | by Alexandra Amidon | Towards Data Science", "h1": "How to Apply K-means Clustering to Time Series Data", "description": "Clustering is an unsupervised learning task where an algorithm groups similar data points without any \u201cground truth\u201d labels. Similarity between data points is measured with a distance metric\u2026"}, "outgoing_paragraph_urls": [{"url": "https://en.wikipedia.org/wiki/Euclidean_distance", "anchor_text": "Euclidean distance", "paragraph_index": 0}, {"url": "https://scikit-learn.org/stable/modules/clustering.html#k-means", "anchor_text": "k-means", "paragraph_index": 2}, {"url": "https://en.wikipedia.org/wiki/Dynamic_time_warping", "anchor_text": "Dynamic Time Warping", "paragraph_index": 4}, {"url": "https://scikit-learn.org/stable/modules/clustering.html#k-means", "anchor_text": "k-means clustering", "paragraph_index": 5}, {"url": "https://github.com/tslearn-team/tslearn", "anchor_text": "tslearn", "paragraph_index": 5}, {"url": "https://en.wikipedia.org/wiki/Euclidean_distance", "anchor_text": "Euclidean distance", "paragraph_index": 6}, {"url": "http://alexminnaar.com/2014/04/16/Time-Series-Classification-and-Clustering-with-Python.html", "anchor_text": "unsuitable", "paragraph_index": 6}, {"url": "http://alexminnaar.com/2014/04/16/Time-Series-Classification-and-Clustering-with-Python.html", "anchor_text": "here", "paragraph_index": 6}, {"url": "https://en.wikipedia.org/wiki/Dynamic_time_warping", "anchor_text": "here", "paragraph_index": 13}, {"url": "http://alexminnaar.com/2014/04/16/Time-Series-Classification-and-Clustering-with-Python.html", "anchor_text": "here", "paragraph_index": 13}, {"url": "https://arxiv.org/abs/1703.01541", "anchor_text": "soft-DTW", "paragraph_index": 15}, {"url": "https://tslearn.readthedocs.io/en/stable/user_guide/clustering.html", "anchor_text": "tslearn", "paragraph_index": 20}, {"url": "https://tslearn.readthedocs.io/en/stable/gettingstarted.html#time-series-format", "anchor_text": "tslearn", "paragraph_index": 22}, {"url": "https://tslearn.readthedocs.io/en/stable/gettingstarted.html#time-series-format", "anchor_text": "utility functions", "paragraph_index": 22}, {"url": "https://tslearn.readthedocs.io/en/stable/integration_other_software.html", "anchor_text": "integrates easily with other time series packages and data formats", "paragraph_index": 22}], "all_paragraphs": ["Clustering is an unsupervised learning task where an algorithm groups similar data points without any \u201cground truth\u201d labels. Similarity between data points is measured with a distance metric, commonly Euclidean distance.", "Clustering different time series into similar groups is a challenging clustering task because each data point is an ordered sequence.", "The most common approach to time series clustering is to flatten the time series into a table, with a column for each time index (or aggregation of the series) and directly apply standard clustering algorithms like k-means. (K-means is a common clustering algorithm that constructs clusters of data by splitting samples into k groups and minimizing the sum-of-squares in each cluster).", "As shown below, this doesn\u2019t always work well. Each subfigure in the chart plots a cluster generated by k-means clustering with Euclidian distance. The cluster centroids in red do not capture the shape of the series.", "Intuitively, the distance measures used in standard clustering algorithms, such as Euclidean distance, are often not appropriate to time series. A better approach is to replace the default distance measure with a metric for comparing time series, such as Dynamic Time Warping.", "In this article, I will explain how to adapt the k-means clustering to time series using dynamic time warping. I will provide easy code examples from the tslearn package.", "But first, why is the common Euclidean distance metric is unsuitable for time series? In short, it is invariant to time shifts, ignoring the time dimension of the data. If two time series are highly correlated, but one is shifted by even one time step, Euclidean distance would erroneously measure them as further apart. Click here for a detailed example.", "Instead, it is better to use dynamic time warping (DTW) to compare series. DTW is a technique to measure similarity between two temporal sequences that do not align exactly in time, speed, or length.", "Given series X=(x\u2080, \u2026, x\u2099) and series Y=(y\u2080, \u2026, y\u2098), the DTW distance from X to Y is formulated as the following optimization problem:", "To summarize the DTW equation: DTW is calculated as the squared root of the sum of squared distances between each element in X and its nearest point in Y. Note that DTW(X, Y) \u2260 DTW(Y, X).", "DTW compares each element in series X with each element in series Y (n x m comparisons). The comparison, d(x\u1d62, y\u2c7c), is just the simple subtraction x\u1d62 \u2014 y\u2c7c.", "Then for each x\u1d62 in X, DTW selects the nearest point in Y for distance calculation.", "This creates a warped \u201cpath\u201d between X and Y that aligns each point in X to the nearest point in Y. The path is a temporal alignment of time series that minimizes the Euclidean distance between aligned series.", "Dynamic Time Warping is computed using dynamic programming with complexity O(MN). Click here or here for more details about the specific algorithm.", "It is easy to compare two time series with DTW in python:", "soft-DTW is a differentiable variant of DTW that replaces the non-differentiable min operation with a differentiable soft-min operation:", "Per the function, soft-DTW depends on a hyper-parameter \u03b3 that controls the smoothing of the resulting metric. like DTW, soft-DTW can be computed in quadratic time using dynamic programming.", "Footnote: The main advantage of soft-DTW stems from the fact that it is differentiable everywhere. This allows soft-DTW to be used as a neural networks loss function, comparing a ground-truth series and a predicted series.", "The k-means clustering algorithm can be applied to time series with dynamic time warping with the following modifications.", "As a result, the centroids have an average shape that mimics the shape of the members of the cluster, regardless of where temporal shifts occur amongst the members.", "Using the tslearn Python package, clustering a time series dataset with k-means and DTW simple:", "To use soft-DTW instead of DTW, simply set metric=\"softdtw\".", "Note that tslearn expects a single time series to be formatted as two-dimensional array. A set of time series should be formatted as a three-dimensional array with shape (num_series, max_length, 1). If series in the set are not of equal length, the shorter series are augmented with NaN values. tslearn has easy-to-use utility functions for properly formatting data and integrates easily with other time series packages and data formats.", "I hope you enjoyed reading this piece. To learn about time series machine learning, please check out my other articles:", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data scientist working in the financial services industry"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F28d04a8f7da3&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-apply-k-means-clustering-to-time-series-data-28d04a8f7da3&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-apply-k-means-clustering-to-time-series-data-28d04a8f7da3&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-apply-k-means-clustering-to-time-series-data-28d04a8f7da3&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-apply-k-means-clustering-to-time-series-data-28d04a8f7da3&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----28d04a8f7da3--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----28d04a8f7da3--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://alexandra-amidon.medium.com/?source=post_page-----28d04a8f7da3--------------------------------", "anchor_text": ""}, {"url": "https://alexandra-amidon.medium.com/?source=post_page-----28d04a8f7da3--------------------------------", "anchor_text": "Alexandra Amidon"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F4ae76d513ea6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-apply-k-means-clustering-to-time-series-data-28d04a8f7da3&user=Alexandra+Amidon&userId=4ae76d513ea6&source=post_page-4ae76d513ea6----28d04a8f7da3---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F28d04a8f7da3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-apply-k-means-clustering-to-time-series-data-28d04a8f7da3&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F28d04a8f7da3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-apply-k-means-clustering-to-time-series-data-28d04a8f7da3&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://www.piqsels.com/en/public-domain-photo-zzzsy", "anchor_text": "Piqsels"}, {"url": "https://en.wikipedia.org/wiki/Euclidean_distance", "anchor_text": "Euclidean distance"}, {"url": "https://scikit-learn.org/stable/modules/clustering.html#k-means", "anchor_text": "k-means"}, {"url": "https://tslearn.readthedocs.io/en/stable/user_guide/clustering.html", "anchor_text": "Source"}, {"url": "https://en.wikipedia.org/wiki/Dynamic_time_warping", "anchor_text": "Dynamic Time Warping"}, {"url": "https://scikit-learn.org/stable/modules/clustering.html#k-means", "anchor_text": "k-means clustering"}, {"url": "https://github.com/tslearn-team/tslearn", "anchor_text": "tslearn"}, {"url": "https://en.wikipedia.org/wiki/Euclidean_distance", "anchor_text": "Euclidean distance"}, {"url": "http://alexminnaar.com/2014/04/16/Time-Series-Classification-and-Clustering-with-Python.html", "anchor_text": "unsuitable"}, {"url": "http://alexminnaar.com/2014/04/16/Time-Series-Classification-and-Clustering-with-Python.html", "anchor_text": "here"}, {"url": "https://tslearn.readthedocs.io/en/stable/user_guide/dtw.html", "anchor_text": "tslearn documentation"}, {"url": "https://commons.wikimedia.org/wiki/File:Euclidean_vs_DTW.jpg", "anchor_text": "wikicommons"}, {"url": "https://tslearn.readthedocs.io/en/stable/user_guide/dtw.html#dtw-softdtw", "anchor_text": "Source"}, {"url": "https://en.wikipedia.org/wiki/Dynamic_time_warping", "anchor_text": "here"}, {"url": "http://alexminnaar.com/2014/04/16/Time-Series-Classification-and-Clustering-with-Python.html", "anchor_text": "here"}, {"url": "https://arxiv.org/abs/1703.01541", "anchor_text": "soft-DTW"}, {"url": "https://tslearn.readthedocs.io/en/stable/user_guide/dtw.html#dtw-softdtw", "anchor_text": "Source"}, {"url": "http://lig-membres.imag.fr/bisson/cours/M2INFO-AIW-ML/papers/PetitJean11.pdf", "anchor_text": "DTW Barycenter Averaging (DBA)"}, {"url": "https://arxiv.org/abs/1703.01541", "anchor_text": "soft-DTW algorithm"}, {"url": "https://tslearn.readthedocs.io/en/stable/auto_examples/clustering/plot_kmeans.html#sphx-glr-auto-examples-clustering-plot-kmeans-py", "anchor_text": "Source + code"}, {"url": "https://tslearn.readthedocs.io/en/stable/user_guide/clustering.html", "anchor_text": "tslearn"}, {"url": "https://tslearn.readthedocs.io/en/stable/gettingstarted.html#time-series-format", "anchor_text": "tslearn"}, {"url": "https://tslearn.readthedocs.io/en/stable/gettingstarted.html#time-series-format", "anchor_text": "utility functions"}, {"url": "https://tslearn.readthedocs.io/en/stable/integration_other_software.html", "anchor_text": "integrates easily with other time series packages and data formats"}, {"url": "https://link.medium.com/1nJUjkUg4bb", "anchor_text": "How to Apply Hierarchical Clustering to Time SeriesClustering is an unsupervised learning task where an algorithm groups similar data points without any \"ground truth\"\u2026link.medium.com"}, {"url": "https://towardsdatascience.com/a-brief-introduction-to-time-series-classification-algorithms-7b4284d31b97", "anchor_text": "A Brief Introduction to Time Series Classification AlgorithmsDedicated algorithms specifically designed for classifying time seriestowardsdatascience.com"}, {"url": "https://medium.com/towards-artificial-intelligence/highly-comparative-time-series-analysis-a-paper-review-5b51d14a291c", "anchor_text": "Highly Comparative Time Series Analysis \u2014 a paper reviewAnalysis of time series feature extraction for comparison, clustering, classification, and annotationmedium.com"}, {"url": "https://databricks.com/blog/2019/04/30/understanding-dynamic-time-warping.html", "anchor_text": "Understanding Dynamic Time Warping"}, {"url": "http://www1.cs.columbia.edu/~jopa/Papers/PaparrizosSIGMOD2015.pdf", "anchor_text": "k-Shape: Efficient and Accurate Clustering of Time Series"}, {"url": "http://alexminnaar.com/2014/04/16/Time-Series-Classification-and-Clustering-with-Python.html", "anchor_text": "Time Series Classification and Clustering"}, {"url": "https://tslearn.readthedocs.io/en/stable/user_guide/clustering.html", "anchor_text": "Clustering"}, {"url": "https://en.wikipedia.org/wiki/Dynamic_time_warping", "anchor_text": "Dynamic Time Warping Wikipedia"}, {"url": "http://www.lumenai.fr/blog/time-series-aggregation", "anchor_text": "Time Series Aggregation"}, {"url": "https://alexandra-amidon.medium.com/membership", "anchor_text": "Read every story from Alexandra Amidon (and thousands of other writers on Medium)As a Medium member, a portion of your membership fee goes to writers you read, and you get full access to every story\u2026alexandra-amidon.medium.com"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----28d04a8f7da3---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/data-mining?source=post_page-----28d04a8f7da3---------------data_mining-----------------", "anchor_text": "Data Mining"}, {"url": "https://medium.com/tag/time-series-analysis?source=post_page-----28d04a8f7da3---------------time_series_analysis-----------------", "anchor_text": "Time Series Analysis"}, {"url": "https://medium.com/tag/clustering?source=post_page-----28d04a8f7da3---------------clustering-----------------", "anchor_text": "Clustering"}, {"url": "https://medium.com/tag/data-science?source=post_page-----28d04a8f7da3---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F28d04a8f7da3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-apply-k-means-clustering-to-time-series-data-28d04a8f7da3&user=Alexandra+Amidon&userId=4ae76d513ea6&source=-----28d04a8f7da3---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F28d04a8f7da3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-apply-k-means-clustering-to-time-series-data-28d04a8f7da3&user=Alexandra+Amidon&userId=4ae76d513ea6&source=-----28d04a8f7da3---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F28d04a8f7da3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-apply-k-means-clustering-to-time-series-data-28d04a8f7da3&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----28d04a8f7da3--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F28d04a8f7da3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-apply-k-means-clustering-to-time-series-data-28d04a8f7da3&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----28d04a8f7da3---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----28d04a8f7da3--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----28d04a8f7da3--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----28d04a8f7da3--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----28d04a8f7da3--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----28d04a8f7da3--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----28d04a8f7da3--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----28d04a8f7da3--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----28d04a8f7da3--------------------------------", "anchor_text": ""}, {"url": "https://alexandra-amidon.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://alexandra-amidon.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Alexandra Amidon"}, {"url": "https://alexandra-amidon.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "2K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F4ae76d513ea6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-apply-k-means-clustering-to-time-series-data-28d04a8f7da3&user=Alexandra+Amidon&userId=4ae76d513ea6&source=post_page-4ae76d513ea6--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F815b5bd6802e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-apply-k-means-clustering-to-time-series-data-28d04a8f7da3&newsletterV3=4ae76d513ea6&newsletterV3Id=815b5bd6802e&user=Alexandra+Amidon&userId=4ae76d513ea6&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}