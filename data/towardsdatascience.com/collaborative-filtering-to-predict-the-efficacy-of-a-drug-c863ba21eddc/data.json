{"url": "https://towardsdatascience.com/collaborative-filtering-to-predict-the-efficacy-of-a-drug-c863ba21eddc", "time": 1682996825.3732858, "path": "towardsdatascience.com/collaborative-filtering-to-predict-the-efficacy-of-a-drug-c863ba21eddc/", "webpage": {"metadata": {"title": "Collaborative filtering to \u201cpredict\u201d the efficacy of a drug (1) | by Yu Liu | Towards Data Science", "h1": "Collaborative filtering to \u201cpredict\u201d the efficacy of a drug (1)", "description": "In drug development, screening is a significant part of the early discovery process. The purpose of this screening is to find molecules that bind the target strong and specific enough to have\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.synapse.org/#!Synapse:syn15667962/wiki/", "anchor_text": "IDG-DREAM Drug-Kinase Binding Prediction Challenge", "paragraph_index": 2}, {"url": "https://en.wikipedia.org/wiki/Netflix_Prize", "anchor_text": "million-dollar prize", "paragraph_index": 5}, {"url": "http://fast.ai", "anchor_text": "Fastai", "paragraph_index": 6}, {"url": "https://drugtargetcommons.fimm.fi/static/Excell_files/DTC_data.csv", "anchor_text": "here", "paragraph_index": 7}, {"url": "http://www.ebi.ac.uk/interpro/protein/P00519", "anchor_text": "P00519", "paragraph_index": 22}, {"url": "http://www.ebi.ac.uk/interpro/protein/P51451", "anchor_text": "P51451", "paragraph_index": 22}, {"url": "http://www.ebi.ac.uk/interpro/protein/P00533", "anchor_text": "P00533", "paragraph_index": 22}, {"url": "http://www.ebi.ac.uk/interpro/protein/P47747", "anchor_text": "P47747", "paragraph_index": 22}, {"url": "http://www.ebi.ac.uk/interpro/protein/P00918", "anchor_text": "P00918", "paragraph_index": 22}, {"url": "http://www.ebi.ac.uk/interpro/protein/P10276", "anchor_text": "P10276", "paragraph_index": 22}, {"url": "https://github.com/ohliumliu/fastai_v3/blob/master/nbs/dl1/kinase/kinase.ipynb", "anchor_text": "here", "paragraph_index": 25}, {"url": "https://towardsdatascience.com/collaborative-filtering-to-predict-the-efficacy-of-a-drug-2-f151956315b7", "anchor_text": "part 2", "paragraph_index": 26}, {"url": "https://towardsdatascience.com/questions-96667b06af5", "anchor_text": "rules and guidelines", "paragraph_index": 27}, {"url": "https://towardsdatascience.com/readers-terms-b5d780a700a4", "anchor_text": "Reader Terms", "paragraph_index": 27}], "all_paragraphs": ["In drug development, screening is a significant part of the early discovery process. The purpose of this screening is to find molecules that bind the target strong and specific enough to have clinical benefit. Scientists have tolled in the lab to synthesize all kinds of molecules, hoping to improve their binding strength. This process is oftentimes guided by an empirical understanding of the drug-target interaction. It is thus natural to ask whether it is possible to \u201cdesign\u201d a drug judiciously just as how a smartphone is designed to achieve a predefined set of performance goals.", "With the advent of quantum mechanics and molecular dynamics, scientists have been able to predict the interaction between molecules in silico. However, it requires advanced domain knowledge and expensive computational resources. Advancement of high-throughput screening also contributed to the accumulation of a large repertoire of experimentally determined binding strengths over the past few decades. Still people wish to have a quicker and more accurate way of obtaining binding strengths.", "Can we harness the cumulative effect of all the previous effort and leverage tools from another domain to push forward? This is the purpose of a recent machine learning challenges called IDG-DREAM Drug-Kinase Binding Prediction Challenge. This project is concerned with the interaction between drugs and kinases. Kinase is a class of proteins critical to the uncontrolled proliferation of malignant cells, a.k.a cancer. Scientists have successfully developed drugs that stick to certain kinases and thus stop the progression of this dreadful disease. More drugs with strong binding properties is greatly needed to combat various kinds of cancers.", "The prediction of drug-kinase binding is essentially a cross-word puzzle with no hints, as illustrated very nicely in the following figure:", "The challenge is to predict the missing binding strengths (crosses) based on known data (yellow). There are four different scenarios as shown above based on whether the binding pair to be predicted involves zero, one or two drug or kinase that has never been covered by known data.", "Presenting the problem this way resembles a well-known task in machine learning \u2014 collaborative filtering. It was first put under the spot light by Netflix in its million-dollar prize. We can think of the binding strength of a drug and a kinase as how much a drug likes a kinase. The Netflix prize asks the exact same questions: predict how a user would rate a movie based on how the user rates other movies and how the move is rated by other users. This is the first scenario in the figure above.", "Fastai, striving to make neural nets uncool again, allows people with relatively less training in software engineering to implement state-of-the-art neural networks, including collaborative filtering models. The lead author of this library believes that neural networks have evolved to a point where a decent model could be developed for a wide array of datasets by following a very small set of best practices. Therefore, what is limiting its application is no longer how well a person can code and how experienced one can fine-tune a model. Instead, how to properly cast a model based on one\u2019s unique understanding of the domain knowledge is the key. In the drug-kinase binding problem, casting it to collaboratively filtering is not challenging at least at the face value.", "The data for drug-kinase binding can be downloaded here. It provides a large set of affinity measurements between drugs and kinases. For simplicity, I started with Kd, or dissociation constant. The stronger the binding, the lower the Kd. There are 32536 measurements available. A small set is shown below:", "Note that the logarithm of Kd will be used for modeling.", "The training process involves the following few steps:", "Thanks to the fastai library, each step involves literally one (1) line of code . Of course, this is a vanilla model. Advanced users can make more sophisticated models by modifying the inner mechanism of the library.", "Here is a snapshot of the code implementing the steps above:", "Let\u2019s first check how well we can \u201cguess\u201d without collaborative filtering? If we \u201cguess\u201d the unknown Kd by generating a Gaussian random number whose mean and standard deviation is calculated from the known Kd\u2019s, there would be no apparent correlation between the prediction and the actual Kd as shown below. The distribution of prediction error looks like a very broad Gaussian distribution.", "With the model we trained, the results are much better.", "Recall the four scenarios shown in the first figure, this model only works with the first one. In fact, if we examine the prediction of the model, some mysterious compound_ids show up as #na#. These compounds were those not covered by the training dataset. The same applies to the kinases (column \u201ctarget_id\u201d).", "If we simply ignore these items, the quality of the prediction is improved as expected.", "For this model, fine tuning involves adjusting the following three parameters:", "People used to believe that it takes experience to optimize a model by adjusting these parameters. Indeed, it determines whether the model works or not. The contribution of fastai is that it provides easy access to those importantly parameters. The lead author, Jeremy, further contends that there exists a set of \u201cgood\u201d parameters that works decently well for different datasets. In our particular drug-kinase mode, a grid search of the parameters revealed learning rate is the most important hyperparameter. The optimal value of learning rate is about the same found by Jeremy for the MovieLens model \u2014 predict user rating of a movie.", "For wd or n_factors, there are always good parameter combinations, but for a bad lr, it would be hard to get a good result.", "As discussed above, only the first scenario is covered here. The other three are often referred to as \u201ccold-start\u201d problem. Since our latent factors were obtained by an empirical model fitting process, it is conceptually very difficult to come up with a set of latent factors for those without any empirical data in the first place. If the prediction is based on the innate features of the molecules or their combination, the cold-start problem is no longer an issue. This approach, based on meta data, involves non-trivial feature engineering and extensive domain knowledge. Still, collaborative filtering may help with feature engineering as illustrated by Jeremy in the Rossman data set. In the drug-kinase problem, if we believe the set of latent factors from the collaborative model is reasonable, it may be possible to come up with an other model that can predict the latent factors well using the structural properties of the molecules. This model can then be used for the cold-start problem. The model relating meta data and latent factors might benefit from a transfer learning approach.", "Just to illustrate the significance of latent factors, we can perform principal component analysis to lump the latent factors into three \u201cprincipal\u201d factors. The following plot shows where some of the kinase stand in the 2D space defined by two of the principal factors. Those neighboring kinases should have similar properties.", "A more stringent approach is to find the neighbors of each kinase in their principal component space or even the latent factor space. Scikit-learn implements various neighbor finding approaches. The result may be checked by a biochemist to see if it makes sense", "For example, P00519 (line 0) and its closest neighbor P51451 are both tyrosine protein kinase. It shouldn\u2019t be surprising since it\u2019s a very common drug target and this dataset has a lot of kinase anyway. As another example, P00533 (line 1) is Epidermal growth factor receptor, and its closest neighbor P47747 is Histamine H2 receptor. As a final example, P00918 (line 4) is Retinoic acid receptor alpha and its nearest neighbor P10276 is Carbonic anhydrase II. Are these pairs indeed functionally related? Remember, you don\u2019t need to understand the biochemistry at all to reach this point.", "Fundamentally we want to know if this method is helpful for drug discovery. There are a lot of work left to be done to make the model accurate enough to save scientists from laboring at the bench.", "As such further collaboration between experimentalists and modelers is critical to make collaborative filtering as well as other machine learning approach more intelligent.", "For those interested, the Jupyter Notebook can be found here. Please note that this work is preliminary.", "See part 2 for further discussion of domain knowledge and another dataset.", "Note from Towards Data Science\u2019s editors: While we allow independent authors to publish articles in accordance with our rules and guidelines, we do not endorse each author\u2019s contribution. You should not rely on an author\u2019s works without seeking professional advice. See our Reader Terms for details.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fc863ba21eddc&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcollaborative-filtering-to-predict-the-efficacy-of-a-drug-c863ba21eddc&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcollaborative-filtering-to-predict-the-efficacy-of-a-drug-c863ba21eddc&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcollaborative-filtering-to-predict-the-efficacy-of-a-drug-c863ba21eddc&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcollaborative-filtering-to-predict-the-efficacy-of-a-drug-c863ba21eddc&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----c863ba21eddc--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----c863ba21eddc--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@yul.liuyu?source=post_page-----c863ba21eddc--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@yul.liuyu?source=post_page-----c863ba21eddc--------------------------------", "anchor_text": "Yu Liu"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F2603c96b40f1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcollaborative-filtering-to-predict-the-efficacy-of-a-drug-c863ba21eddc&user=Yu+Liu&userId=2603c96b40f1&source=post_page-2603c96b40f1----c863ba21eddc---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc863ba21eddc&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcollaborative-filtering-to-predict-the-efficacy-of-a-drug-c863ba21eddc&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc863ba21eddc&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcollaborative-filtering-to-predict-the-efficacy-of-a-drug-c863ba21eddc&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://www.synapse.org/#!Synapse:syn15667962/wiki/", "anchor_text": "IDG-DREAM Drug-Kinase Binding Prediction Challenge"}, {"url": "https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005678#sec009", "anchor_text": "reference"}, {"url": "https://en.wikipedia.org/wiki/Netflix_Prize", "anchor_text": "million-dollar prize"}, {"url": "http://fast.ai", "anchor_text": "Fastai"}, {"url": "https://drugtargetcommons.fimm.fi/static/Excell_files/DTC_data.csv", "anchor_text": "here"}, {"url": "http://www.ebi.ac.uk/interpro/protein/P00519", "anchor_text": "P00519"}, {"url": "http://www.ebi.ac.uk/interpro/protein/P51451", "anchor_text": "P51451"}, {"url": "http://www.ebi.ac.uk/interpro/protein/P00533", "anchor_text": "P00533"}, {"url": "http://www.ebi.ac.uk/interpro/protein/P47747", "anchor_text": "P47747"}, {"url": "http://www.ebi.ac.uk/interpro/protein/P00918", "anchor_text": "P00918"}, {"url": "http://www.ebi.ac.uk/interpro/protein/P10276", "anchor_text": "P10276"}, {"url": "https://github.com/ohliumliu/fastai_v3/blob/master/nbs/dl1/kinase/kinase.ipynb", "anchor_text": "here"}, {"url": "https://towardsdatascience.com/collaborative-filtering-to-predict-the-efficacy-of-a-drug-2-f151956315b7", "anchor_text": "part 2"}, {"url": "https://towardsdatascience.com/questions-96667b06af5", "anchor_text": "rules and guidelines"}, {"url": "https://towardsdatascience.com/readers-terms-b5d780a700a4", "anchor_text": "Reader Terms"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----c863ba21eddc---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/collaborative-filtering?source=post_page-----c863ba21eddc---------------collaborative_filtering-----------------", "anchor_text": "Collaborative Filtering"}, {"url": "https://medium.com/tag/drug-development?source=post_page-----c863ba21eddc---------------drug_development-----------------", "anchor_text": "Drug Development"}, {"url": "https://medium.com/tag/fastai?source=post_page-----c863ba21eddc---------------fastai-----------------", "anchor_text": "Fastai"}, {"url": "https://medium.com/tag/neural-networks?source=post_page-----c863ba21eddc---------------neural_networks-----------------", "anchor_text": "Neural Networks"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fc863ba21eddc&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcollaborative-filtering-to-predict-the-efficacy-of-a-drug-c863ba21eddc&user=Yu+Liu&userId=2603c96b40f1&source=-----c863ba21eddc---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fc863ba21eddc&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcollaborative-filtering-to-predict-the-efficacy-of-a-drug-c863ba21eddc&user=Yu+Liu&userId=2603c96b40f1&source=-----c863ba21eddc---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc863ba21eddc&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcollaborative-filtering-to-predict-the-efficacy-of-a-drug-c863ba21eddc&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----c863ba21eddc--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fc863ba21eddc&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcollaborative-filtering-to-predict-the-efficacy-of-a-drug-c863ba21eddc&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----c863ba21eddc---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----c863ba21eddc--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----c863ba21eddc--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----c863ba21eddc--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----c863ba21eddc--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----c863ba21eddc--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----c863ba21eddc--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----c863ba21eddc--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----c863ba21eddc--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@yul.liuyu?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@yul.liuyu?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Yu Liu"}, {"url": "https://medium.com/@yul.liuyu/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "32 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F2603c96b40f1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcollaborative-filtering-to-predict-the-efficacy-of-a-drug-c863ba21eddc&user=Yu+Liu&userId=2603c96b40f1&source=post_page-2603c96b40f1--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F815f1d4805ea&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcollaborative-filtering-to-predict-the-efficacy-of-a-drug-c863ba21eddc&newsletterV3=2603c96b40f1&newsletterV3Id=815f1d4805ea&user=Yu+Liu&userId=2603c96b40f1&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}