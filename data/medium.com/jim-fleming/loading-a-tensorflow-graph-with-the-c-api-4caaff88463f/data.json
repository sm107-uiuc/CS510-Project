{"url": "https://medium.com/jim-fleming/loading-a-tensorflow-graph-with-the-c-api-4caaff88463f", "time": 1682988274.7946649, "path": "medium.com/jim-fleming/loading-a-tensorflow-graph-with-the-c-api-4caaff88463f/", "webpage": {"metadata": {"title": "Loading a TensorFlow graph with the C++ API | by Jim Fleming | Jim Fleming | Medium", "h1": "Loading a TensorFlow graph with the C++ API", "description": "The current documentation around loading a graph with C++ is pretty sparse so I spent some time setting up a barebones example. In the TensorFlow repo there are more involved examples, such as\u2026"}, "outgoing_paragraph_urls": [{"url": "https://medium.com/jim-fleming/loading-tensorflow-graphs-via-host-languages-be10fd81876f#.wbjr0rbnh", "anchor_text": "Loading TensorFlow graphs from Node.js", "paragraph_index": 0}, {"url": "http://tensorflow.org/api_docs/cc/index.html", "anchor_text": "pretty", "paragraph_index": 1}, {"url": "https://github.com/tensorflow/tensorflow/tree/master/tensorflow/core/public#c-api-example", "anchor_text": "sparse", "paragraph_index": 1}, {"url": "https://github.com/tensorflow/tensorflow/blob/master/tensorflow/cc/tutorials/example_trainer.cc", "anchor_text": "building a graph in C++", "paragraph_index": 1}, {"url": "https://github.com/tensorflow/tensorflow/tree/master/tensorflow/cc/ops", "anchor_text": "defining your own operations", "paragraph_index": 1}, {"url": "http://bazel.io/docs/build-ref.html#BUILD_files", "anchor_text": "BUILD", "paragraph_index": 7}, {"url": "http://bazel.io/docs/be/c-cpp.html#cc_binary", "anchor_text": "cc_binary", "paragraph_index": 7}, {"url": "http://bazel.io/docs/be/c-cpp.html#cc_binary.linkshared", "anchor_text": "linkshared", "paragraph_index": 7}, {"url": "http://bazel.io/docs/be/c-cpp.html#cc_library", "anchor_text": "cc_library", "paragraph_index": 7}, {"url": "https://twitter.com/jimmfleming", "anchor_text": "Twitter", "paragraph_index": 11}, {"url": "https://fomoro.com", "anchor_text": "applied research", "paragraph_index": 11}], "all_paragraphs": ["Check out the related post: Loading TensorFlow graphs from Node.js (using the C API).", "The current documentation around loading a graph with C++ is pretty sparse so I spent some time setting up a barebones example. In the TensorFlow repo there are more involved examples, such as building a graph in C++. However, the C++ API for constructing graphs is not as complete as the Python API. Many features (including automatic gradient computation) are not available from C++ yet. Another example in the repo demonstrates defining your own operations but most users will never need this. I imagine the most common use case for the C++ API is for loading pre-trained graphs to be standalone or embedded in other applications.", "Be aware, there are some caveats to this approach that I\u2019ll cover at the end.", "Let\u2019s start by creating a minimal TensorFlow graph and write it out as a protobuf file. Make sure to assign names to your inputs and operations so they\u2019re easier to assign when we execute the graph later. The node\u2019s do have default names but they aren\u2019t very useful: Variable_1 or Mul_3. Here\u2019s an example created with Jupyter:", "Let\u2019s create a new folder like tensorflow/tensorflow/<my project name> for your binary or library to live. I\u2019m going to call the project loader since it will be loading a graph.", "Inside this project folder we\u2019ll create a new file called <my project name>.cc (e.g. loader.cc). If you\u2019re curious, the .cc extension is essentially the same as .cpp but is preferred by Google\u2019s code guidelines.", "Inside loader.cc we\u2019re going to do a few things:", "Now we create a BUILD file for our project. This tells Bazel what to compile. Inside we want to define a cc_binary for our program. You can also use the linkshared option on the binary to produce a shared library or the cc_library rule if you\u2019re going to link it using Bazel.", "You could also call bazel run :loader to run the executable directly, however the working directory for bazel run is buried in a temporary folder and ReadBinaryProto looks in the current working directory for relative paths.", "And that should be all we need to do to compile and run C++ code for TensorFlow.", "The last thing to cover are the caveats I mentioned:", "Hopefully someone can shed some light on these last points so we can begin to embed TensorFlow graphs in applications. If you are that person, message me on Twitter or email. We also do applied research to solve machine learning challenges.", "CTO // ML Research @ Fomoro"], "all_outgoing_urls": [{"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/jim-fleming?source=post_page-----4caaff88463f--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/jim-fleming?source=post_page-----4caaff88463f--------------------------------", "anchor_text": "Jim Fleming"}, {"url": "https://medium.com/@jimfleming?source=post_page-----4caaff88463f--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@jimfleming?source=post_page-----4caaff88463f--------------------------------", "anchor_text": "Jim Fleming"}, {"url": "https://medium.com/jim-fleming/loading-tensorflow-graphs-via-host-languages-be10fd81876f#.wbjr0rbnh", "anchor_text": "Loading TensorFlow graphs from Node.js"}, {"url": "http://tensorflow.org/api_docs/cc/index.html", "anchor_text": "pretty"}, {"url": "https://github.com/tensorflow/tensorflow/tree/master/tensorflow/core/public#c-api-example", "anchor_text": "sparse"}, {"url": "https://github.com/tensorflow/tensorflow/blob/master/tensorflow/cc/tutorials/example_trainer.cc", "anchor_text": "building a graph in C++"}, {"url": "https://github.com/tensorflow/tensorflow/tree/master/tensorflow/cc/ops", "anchor_text": "defining your own operations"}, {"url": "http://bazel.io/docs/install.html", "anchor_text": "Install Bazel"}, {"url": "https://github.com/tensorflow/tensorflow.git", "anchor_text": "TensorFlow repo"}, {"url": "http://twitter.com/kristophergiesing", "anchor_text": "@kristophergiesing"}, {"url": "https://github.com/tensorflow/tensorflow", "anchor_text": "https://github.com/tensorflow/tensorflow"}, {"url": "http://bazel.io/docs/build-ref.html#BUILD_files", "anchor_text": "BUILD"}, {"url": "http://bazel.io/docs/be/c-cpp.html#cc_binary", "anchor_text": "cc_binary"}, {"url": "http://bazel.io/docs/be/c-cpp.html#cc_binary.linkshared", "anchor_text": "linkshared"}, {"url": "http://bazel.io/docs/be/c-cpp.html#cc_library", "anchor_text": "cc_library"}, {"url": "https://twitter.com/jimmfleming", "anchor_text": "Twitter"}, {"url": "https://fomoro.com", "anchor_text": "applied research"}, {"url": "https://medium.com/tag/programming?source=post_page-----4caaff88463f---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/tag/tensorflow?source=post_page-----4caaff88463f---------------tensorflow-----------------", "anchor_text": "TensorFlow"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----4caaff88463f---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/jim-fleming?source=post_page-----4caaff88463f--------------------------------", "anchor_text": "More from Jim Fleming"}, {"url": "https://medium.com/jim-fleming?source=post_page-----4caaff88463f--------------------------------", "anchor_text": "Read more from Jim Fleming"}, {"url": "https://medium.com/?source=post_page-----4caaff88463f--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----4caaff88463f--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----4caaff88463f--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----4caaff88463f--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----4caaff88463f--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----4caaff88463f--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----4caaff88463f--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/plans?source=upgrade_membership---two_column_layout_sidebar----------------------------------", "anchor_text": "Get unlimited access"}, {"url": "https://medium.com/@jimfleming?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@jimfleming?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Jim Fleming"}, {"url": "https://medium.com/@jimfleming/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "1.2K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F2b9a1bea0da4&operation=register&redirect=https%3A%2F%2Fmedium.com%2Fjim-fleming%2Floading-a-tensorflow-graph-with-the-c-api-4caaff88463f&newsletterV3=9795f21a51db&newsletterV3Id=2b9a1bea0da4&user=Jim+Fleming&userId=9795f21a51db&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}