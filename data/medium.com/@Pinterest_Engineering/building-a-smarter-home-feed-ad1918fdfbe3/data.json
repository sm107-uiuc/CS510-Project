{"url": "https://medium.com/@Pinterest_Engineering/building-a-smarter-home-feed-ad1918fdfbe3", "time": 1683019469.022829, "path": "medium.com/@Pinterest_Engineering/building-a-smarter-home-feed-ad1918fdfbe3/", "webpage": {"metadata": {"title": "Building a smarter home feed | by Pinterest Engineering | Pinterest Engineering Blog | Medium", "h1": "Building a smarter home feed", "description": "The home feed should be a reflection of what each user cares about. Content is sourced from inputs such as people and boards the user follows, interests, and recommendations. To ensure we maintain\u2026"}, "outgoing_paragraph_urls": [{"url": "https://about.pinterest.com/en/careers/engineering-product", "anchor_text": "join our team", "paragraph_index": 19}], "all_paragraphs": ["Chris Pinchak | Pinterest engineer, Discovery", "The home feed should be a reflection of what each user cares about. Content is sourced from inputs such as people and boards the user follows, interests, and recommendations. To ensure we maintain fast, reliable and personalized home feeds, we built the smart feed with the following design values in mind:", "1. Different sources of Pins should be mixed together at different rates.", "2. Some Pins should be selectively dropped or deferred until a later time. Some sources may produce Pins of poor quality for a user, so instead of showing everything available immediately, we can be selective about what to show and what to hold back for a future session.", "3. Pins should be arranged in the order of best-first rather than newest-first. For some sources, newer Pins are intuitively better, while for others, newness is less important.", "We shifted away from our previously time-ordered home feed system and onto a more flexible one. The core feature of the smart feed architecture is its separation of available, but unseen, content and content that\u2019s already been presented to the user. We leverage knowledge of what the user hasn\u2019t yet seen to our advantage when deciding how the feed evolves over time.", "Smart feed is a composition of three independent services, each of which has a specific role in the construction of a home feed.", "The smart feed worker is the first to process Pins and has two primary responsibilities \u2014 to accept incoming Pins and assign some score proportional to their quality or value to the receiving user, and to remember these scored Pins in some storage for later consumption.", "Essentially, the worker manages Pins as they become newly available, such as those from the repins of the people the user follows. Pins have varying value to the receiving user, so the worker is tasked with deciding the magnitude of their subjective quality.", "Incoming Pins are currently obtained from three separate sources: repins made by followed users, related Pins, and Pins from followed interests. Each is scored by the worker and then inserted into a pool for that particular type of pin. Each pool is a priority queue sorted on score and belongs to a single user. Newly added Pins mix with those added before, allowing the highest quality Pins to be accessible over time at the front of the queue.", "Pools can be implemented in a variety of ways so long as the priority queue requirement is met. We choose to do this by exploiting the key-based sorting of HBase. Each key is a combination of user, score and Pin such that, for any user, we may scan a list of available Pins according to their score. Newly added triples will be inserted at their appropriate location to maintain the score order. This combination of user, score, and Pin into a key value can be used to create a priority queue in other storage systems aside from HBase, a property we may use in the future depending on evolving storage requirements.", "Distinct from the smart feed worker, the smart feed content generator is concerned primarily with defining what \u201cnew\u201d means in the context of a home feed. When a user accesses the home feed, we ask the content generator for new Pins since their last visit. The generator decides the quantity, composition, and arrangement of new Pins to return in response to this request.", "The content generator assembles available Pins into chunks for consumption by the user as part of their home feed. The generator is free to choose any arrangement based on a variety of input signals, and may elect to use some or all of the Pins available in the pools. Pins that are selected for inclusion in a chunk are thereafter removed from from the pools so they cannot be returned as part of subsequent chunks.", "The content generator is generally free to perform any rearrangements it likes, but is bound to the priority queue nature of the pools. When the generator asks for n pins from a pool, it\u2019ll get the n highest scoring (i.e., best) Pins available. Therefore, the generator doesn\u2019t need to concern itself with finding the best available content, but instead with how the best available content should be presented.", "In addition to providing high availability of the home feed, the smart feed service is responsible for combining new Pins returned by the content generator with those that previously appeared in the home feed. We can separate these into the chunk returned by the content generator and the materialized feed managed by the smart feed service.", "The materialized feed represents a frozen view of the feed as it was the last time the user viewed it. To the materialized Pins we add the Pins from the content generator in the chunk. The service makes no decisions about order, instead it adds the Pins in exactly the order given by the chunk. Because it has a fairly low rate of reading and writing, the materialized feed is likely to suffer from fewer availability events. In addition, feeds can be trimmed to restrict them to a maximum size. The need for less storage means we can easily increase the availability and reliability of the materialized feed through replication and the use of faster storage hardware.", "The smart feed service relies on the content generator to provide new Pins. If the generator experiences a degradation in performance, the service can gracefully handle the loss of its availability. In the event the content generator encounters an exception while generating a chunk, or if it simply takes too long to produce one, the smart feed service will return the content contained in the materialized feed. In this instance, the feed will appear to the end user as unchanged from last time. Future feed views will produce chunks as large as, or larger than, the last so that eventually the user will see new Pins.", "By moving to smart feed, we achieved the goals of a highly flexible architecture and better control over the composition of home feeds. The home feed is now powered by three separate services, each with a well-defined role in its production and distribution. The individual services can be altered or replaced with components that serve the same general purpose. The use of pools to buffer Pins according to their quality allows us a greater amount of control over the composition of home feeds.", "Continuing with this project, we intend to better model users\u2019 preferences with respect to Pins in their home feeds. Our accuracy of recommendation quality varies considerably over our user base, and we would benefit from using preference information gathered from recent interactions with the home feed. Knowledge of personal preference will also help us order home feeds so the Pins of most value can be discovered with the least amount of effort.", "If you\u2019re interested in tackling challenges and making improvements like this, join our team!", "Chris Pinchak is a software engineer at Pinterest.", "Acknowledgements: This technology was built in collaboration with Dan Feng, Dmitry Chechik, Raghavendra Prabhu, Jeremy Carroll, Xun Liu, Varun Sharma, Joe Lau, Yuchen Liu, Tian-Ying Chang, and Yun Park. This team, as well as people from across the company, helped make this project a reality with their technical insights and invaluable feedback.", "Inventive engineers building the first visual discovery engine, 300 billion ideas and counting."], "all_outgoing_urls": [{"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/pinterest-engineering?source=post_page-----ad1918fdfbe3--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/pinterest-engineering?source=post_page-----ad1918fdfbe3--------------------------------", "anchor_text": "Pinterest Engineering Blog"}, {"url": "https://medium.com/@Pinterest_Engineering?source=post_page-----ad1918fdfbe3--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@Pinterest_Engineering?source=post_page-----ad1918fdfbe3--------------------------------", "anchor_text": "Pinterest Engineering"}, {"url": "https://about.pinterest.com/en/careers/engineering-product", "anchor_text": "join our team"}, {"url": "https://medium.com/tag/pinterest?source=post_page-----ad1918fdfbe3---------------pinterest-----------------", "anchor_text": "Pinterest"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----ad1918fdfbe3---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/engineering?source=post_page-----ad1918fdfbe3---------------engineering-----------------", "anchor_text": "Engineering"}, {"url": "https://medium.com/tag/hbase?source=post_page-----ad1918fdfbe3---------------hbase-----------------", "anchor_text": "Hbase"}, {"url": "https://medium.com/pinterest-engineering?source=post_page-----ad1918fdfbe3--------------------------------", "anchor_text": "More from Pinterest Engineering Blog"}, {"url": "https://medium.com/pinterest-engineering?source=post_page-----ad1918fdfbe3--------------------------------", "anchor_text": "Read more from Pinterest Engineering Blog"}, {"url": "https://medium.com/?source=post_page-----ad1918fdfbe3--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----ad1918fdfbe3--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----ad1918fdfbe3--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----ad1918fdfbe3--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----ad1918fdfbe3--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----ad1918fdfbe3--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----ad1918fdfbe3--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/plans?source=upgrade_membership---two_column_layout_sidebar----------------------------------", "anchor_text": "Get unlimited access"}, {"url": "https://medium.com/@Pinterest_Engineering?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@Pinterest_Engineering?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Pinterest Engineering"}, {"url": "https://medium.com/@Pinterest_Engineering/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "46K Followers"}, {"url": "https://medium.com/pinterest-engineering", "anchor_text": "https://medium.com/pinterest-engineering"}, {"url": "https://careers.pinterest.com/", "anchor_text": "https://careers.pinterest.com/"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F340379419410&operation=register&redirect=https%3A%2F%2Fmedium.com%2Fpinterest-engineering%2Fbuilding-a-smarter-home-feed-ad1918fdfbe3&newsletterV3=ef81ef829bcb&newsletterV3Id=340379419410&user=Pinterest+Engineering&userId=ef81ef829bcb&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}