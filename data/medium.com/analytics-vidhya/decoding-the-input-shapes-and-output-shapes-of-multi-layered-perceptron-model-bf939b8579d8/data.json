{"url": "https://medium.com/analytics-vidhya/decoding-the-input-shapes-and-output-shapes-of-multi-layered-perceptron-model-bf939b8579d8", "time": 1682992930.696948, "path": "medium.com/analytics-vidhya/decoding-the-input-shapes-and-output-shapes-of-multi-layered-perceptron-model-bf939b8579d8/", "webpage": {"metadata": {"title": "Input and output shapes of MLP | Medium", "h1": "Decoding the input shapes and output shapes of Multi-Layered Perceptron model.", "description": "Understanding number of trainable parameters of MLP model, after a model is built. What is input shape of the data and What will output shape of data of MLP"}, "outgoing_paragraph_urls": [{"url": "https://medium.com/analytics-vidhya/activation-functions-why-tanh-outperforms-logistic-sigmoid-3f26469ac0d1", "anchor_text": "activation functions to introduce non-linearity to the model", "paragraph_index": 23}, {"url": "https://medium.com/analytics-vidhya/activation-functions-why-tanh-outperforms-logistic-sigmoid-3f26469ac0d1", "anchor_text": "activation functions to introduce non-linearity to the model", "paragraph_index": 25}], "all_paragraphs": ["I assume that people who are reading this blog already have some idea about deep learning concepts and Multi-Layered Perceptrons. If you are completely new to these concepts, you may not understand this blog. kindly, revisit after you learn the basics of deep learning.", "In very simple terms, an important task in training a neural network model is to find the best weights (weight matrix), which helps in reducing the error and minimizing the loss to achieve the objective of the given problem (classification or regression).", "So, understanding the model summary in detail (output shapes, input shapes, and a number of parameters) is very important while training a neural network model, because these will help you to understand, what is happening within the model, which you defined.", "This is a very short blog and will try to explain these topics using examples with help of (the toy dataset).", "Note: Everything discussed in this blog is only with respect to fully connected multi-layered perceptron.", "The Iris flower data set is a multivariate data set introduced by the British statistician and biologist Ronald Fisher in his 1936 paper. Iris is a type of flower plant.", "The data set consists of 50 samples for each of three species of Iris (Iris setosa, Iris virginica, and Iris versicolor). Altogether this dataset consists of 150 samples.", "Four features were measured from each sample: the length and the width of the sepals and petals (Petal Length, Petal Width, Sepal Length, and Sepal Width) in centimeters.", "target column represents three values 0,1,2, which represent \u2018setosa\u2019, \u2018versicolor\u2019, \u2018virginica\u2019 respectively.", "While training a neural network, we separate the target variable from the dataset and train the model with data and target variable separately. So, now our data appears as shown in Fig -2.", "Before discussing these topics, I wanted to make clear about architecture I am using to explain these parameters.", "The simplest function for such models can be defined as f(x) = W^t * X, where W is the Weight matrix and X is the data.", "The simplest function for such models can be defined as f(x) = W^t * X + b , where W is the Weight matrix and X is the data and b is the Bias term.", "\u2018dense\u2019, and \u2018dense_1\u2019 are the hidden layers \u2014 with 5 and 4 neurons respectively.", "dense_2 is the output layer (softmax layer)with 3 units, as we are solving multi-class classification problems (3 classes).", "As said earlier, in the training phase, data and target are passed separately, when data is passed through the network.", "As each data point has 4 features (refer to Fig-2),", "input shape and output shape of the input layer will be the same (you can think of it as identity). It is the first step when you pass your data to the network. So, it will output (which has an output shape).", "As we are passing through the network with the data, which has 4 features (refer to Fig-2). So, the output from input_layer would be (?,4).", "batch size is nothing but, how many data points will be passed through the neural network (Fig-6) in one batch at a time.", "So, if you define batch size as 16, the output shape will be (16,4), which specifies 16 data points each with 4 dimensions (or 4 features).", "This layer is receiving input from Input_layer. So, the output_shape of Input_layer becomes the input_shape of hidden layer-1. As per our example, output_shape of input_layer is (?,4), which became input_shape to hidden layer-1.", "\u201cOutput_shape of the preceding layer becomes Input_shape of next layer in Multi-Layered Perceptron networks\u201d.", "Hidden layer -1 has 5 neurons or units (Fig-6), which contain some activation functions to introduce non-linearity to the model, after the input is passed through these 5 neurons, all 5 neurons generate output. So, the output_shape of hidden layer -1 is (?,5), where \u201c?\u201d specifies batch size.", "As said above, where the output_shape of hidden layer-1 becomes the input_shape of hidden layer-2. So, the input_shape of hidden layer-2 is (?,5), in other terms (hidden layer-2 is receiving input from 5 neuron units).", "Hidden layer -2 has 4 neurons or units (Fig-6), which contain some activation functions to introduce non-linearity to the model, after the input is passed through these 4 neurons, all 4 neurons generate output. So, the output_shape of hidden layer -2 is (?,4), where \u201c?\u201d specifies batch size.", "As said above, where the output_shape of hidden layer-2 becomes the input_shape of the output layer. So, the input_shape of the output layer is (?,4), in other terms (the output layer is receiving input from 4 neuron units (from hidden layer-2 )).", "The output layer has 3 units (Fig-6), as we are dealing with a 3-class classification problem (we need to predict whether the given data point belongs to any of these 3 types of flower classes). If we have 10 classes to classify (then the output layer contains 10 units). It changes, according to the problem statement. So, in our example, the output_shape of the output layer is (?,3), where \u201c?\u201d specifies batch size.", "Let\u2019s not consider any layers (such as Dropouts or Batch Normalization, etc..), which can be considered as both trainable and non-trainable parameters. To make it simple, consider only basic architecture which can be seen in the above image.", "Trainable parameters are nothing but parameters, which should be updated using backpropagation in order to reduce the error and minimize the loss (based on the defined loss function)", "The number of parameters between the input layer and hidden layer-1 is 20 Weights and 5 bias terms(refer to right side Fig-8) i.e., it has a Weight matrix of shape (4x5), as data has 4 features, which are connected to 5 neurons in hidden layer-1 and bias term is connected to each and every neuron in hidden layer-1, which is of size (1x5). So, 20 weights and 5 bias terms (20+5=25) are trainable parameters between these two layers.", "In a similar way, we can compute the number of trainable parameters between hidden layer-1 and hidden layer-2 and also between hidden layer-2 and the output layer.", "the number of parameters between the two layers without bias term= \u201cnumber of units(or neurons) in preceding layer * the number of units(or neurons) in next layer\u201d.", "the number of parameters between the two layers with bias term = \u201cnumber of units(or neurons) in preceding layer * number of units(or neurons) in next layer+number of units(or neurons) in next layer(for bias term)\u201d.", "number of parameters between hidden layer-1 and hidden layer-2 with bias term is = (5x4+4) = 24.", "number of parameters between hidden layer-2 and output layer with bias term is = (4x3+3) = 15.", "Please refer to Fig-8 (right side) and count the connections (to get more convinced and understand the number of parameters practically).", "This is a simple blog to understand the number of parameters(trainable) in the multi-layered neural network (which is very important to understand, to have some idea about what\u2019s happening behind). Even though this analysis is done on a toy example, this can be generalized to any layered and any number of the dimensional network (considering dropouts or batch normalization or any other layers as non-trainable parameters).", "Data Science and ML practitioner | Love to write on Deep Learning and Technological Innovations", "Data Science and ML practitioner | Love to write on Deep Learning and Technological Innovations"], "all_outgoing_urls": [{"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://me.dm/@mvschamanth", "anchor_text": "Mastodon"}, {"url": "https://medium.com/?source=post_page-----bf939b8579d8--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/?source=post_page-----bf939b8579d8--------------------------------", "anchor_text": "Chamanth mvs"}, {"url": "https://medium.com/analytics-vidhya/activation-functions-why-tanh-outperforms-logistic-sigmoid-3f26469ac0d1", "anchor_text": "activation functions to introduce non-linearity to the model"}, {"url": "https://medium.com/analytics-vidhya/activation-functions-why-tanh-outperforms-logistic-sigmoid-3f26469ac0d1", "anchor_text": "activation functions to introduce non-linearity to the model"}, {"url": "https://medium.com/tag/data-science?source=post_page-----bf939b8579d8---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----bf939b8579d8---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/neural-networks?source=post_page-----bf939b8579d8---------------neural_networks-----------------", "anchor_text": "Neural Networks"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----bf939b8579d8---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/?source=post_page-----bf939b8579d8--------------------------------", "anchor_text": "More from Chamanth mvs"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Ff3b70d9e7432&operation=register&redirect=https%3A%2F%2Fmvschamanth.medium.com%2Fdecoding-the-input-shapes-and-output-shapes-of-multi-layered-perceptron-model-bf939b8579d8&newsletterV3=8c18fb74e690&newsletterV3Id=f3b70d9e7432&user=Chamanth+mvs&userId=8c18fb74e690&source=-----bf939b8579d8---------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://medium.com/?source=post_page-----bf939b8579d8--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----bf939b8579d8--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----bf939b8579d8--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----bf939b8579d8--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----bf939b8579d8--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----bf939b8579d8--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----bf939b8579d8--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/plans?source=upgrade_membership---two_column_layout_sidebar----------------------------------", "anchor_text": "Get unlimited access"}, {"url": "https://medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Chamanth mvs"}, {"url": "https://medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "75 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Ff3b70d9e7432&operation=register&redirect=https%3A%2F%2Fmvschamanth.medium.com%2Fdecoding-the-input-shapes-and-output-shapes-of-multi-layered-perceptron-model-bf939b8579d8&newsletterV3=8c18fb74e690&newsletterV3Id=f3b70d9e7432&user=Chamanth+mvs&userId=8c18fb74e690&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}